#ifdef __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#endif
#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#endif
// Headers

#define _GNU_SOURCE
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#define CL_TARGET_OPENCL_VERSION 120
#define CL_USE_DEPRECATED_OPENCL_1_2_APIS
#ifdef __APPLE__
#define CL_SILENCE_DEPRECATION
#include <OpenCL/cl.h>
#else
#include <CL/cl.h>
#endif


// Initialisation

int futhark_get_num_sizes(void);
const char *futhark_get_size_name(int);
const char *futhark_get_size_class(int);
struct futhark_context_config ;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
void futhark_context_config_add_build_option(struct futhark_context_config *cfg,
                                             const char *opt);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int flag);
void futhark_context_config_set_device(struct futhark_context_config *cfg, const
                                       char *s);
void futhark_context_config_set_platform(struct futhark_context_config *cfg,
                                         const char *s);
void
futhark_context_config_select_device_interactively(struct futhark_context_config *cfg);
void futhark_context_config_list_devices(struct futhark_context_config *cfg);
void futhark_context_config_dump_program_to(struct futhark_context_config *cfg,
                                            const char *path);
void
futhark_context_config_load_program_from(struct futhark_context_config *cfg,
                                         const char *path);
void futhark_context_config_dump_binary_to(struct futhark_context_config *cfg,
                                           const char *path);
void futhark_context_config_load_binary_from(struct futhark_context_config *cfg,
                                             const char *path);
void
futhark_context_config_set_default_group_size(struct futhark_context_config *cfg,
                                              int size);
void
futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg,
                                              int num);
void
futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg,
                                             int num);
void
futhark_context_config_set_default_threshold(struct futhark_context_config *cfg,
                                             int num);
int futhark_context_config_set_size(struct futhark_context_config *cfg, const
                                    char *size_name, size_t size_value);
struct futhark_context ;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
struct futhark_context
*futhark_context_new_with_command_queue(struct futhark_context_config *cfg,
                                        cl_command_queue queue);
void futhark_context_free(struct futhark_context *ctx);
cl_command_queue futhark_context_get_command_queue(struct futhark_context *ctx);

// Arrays

struct futhark_f32_1d ;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const
                                          float *data, int64_t dim0);
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0);
int futhark_free_f32_1d(struct futhark_context *ctx,
                        struct futhark_f32_1d *arr);
int futhark_values_f32_1d(struct futhark_context *ctx,
                          struct futhark_f32_1d *arr, float *data);
cl_mem futhark_values_raw_f32_1d(struct futhark_context *ctx,
                                 struct futhark_f32_1d *arr);
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx,
                                    struct futhark_f32_1d *arr);
struct futhark_i64_1d ;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const
                                          int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx,
                        struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx,
                          struct futhark_i64_1d *arr, int64_t *data);
cl_mem futhark_values_raw_i64_1d(struct futhark_context *ctx,
                                 struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx,
                                    struct futhark_i64_1d *arr);

// Opaque values


// Entry points

int futhark_entry_main(struct futhark_context *ctx, float *out0,
                       struct futhark_f32_1d **out1, const int64_t in0, const
                       int64_t in1, const struct futhark_f32_1d *in2, const
                       struct futhark_i64_1d *in3, const
                       struct futhark_f32_1d *in4, const float in5, const
                       float in6, const float in7, const float in8);
int futhark_entry_test(struct futhark_context *ctx, float *out0, const
                       int64_t in0, const int64_t in1);

// Miscellaneous

int futhark_context_sync(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
#define FUTHARK_BACKEND_opencl
#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}


static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                            const char *msg, ...)
{
  if (errval) {
    char str[256];
    char errnum[10];
    sprintf(errnum, "%d", errval);
    sprintf(str, "ERROR: %s in %s() at line %d with error code %s\n", msg, fun, line,
            sets_errno ? strerror(errno) : errnum);
    fprintf(stderr, "%s", str);
    exit(errval);
  }
}

#define CHECK_ERR(err, msg...) check_err(err, 0, __func__, __LINE__, msg)
#define CHECK_ERRNO(err, msg...) check_err(err, 1, __func__, __LINE__, msg)

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  unsigned char *s;
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  fseek(f, 0, SEEK_END);
  size_t src_size = ftell(f);
  fseek(f, 0, SEEK_SET);
  s = (unsigned char*) malloc(src_size + 1);
  if (fread(s, 1, src_size, f) != src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }
  fclose(f);

  if (size) {
    *size = src_size;
  }

  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

// End of util.h.

// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}


static inline uint64_t rdtsc() {
  unsigned int hi, lo;
  __asm__ __volatile__("rdtsc" : "=a"(lo), "=d"(hi));
  return  ((uint64_t) lo) | (((uint64_t) hi) << 32);
}

static inline void rdtsc_wait(uint64_t n) {
  const uint64_t start = rdtsc();
  while (rdtsc() < (start + n)) {
    __asm__("PAUSE");
  }
}
static inline void spin_for(uint64_t nb_cycles) {
  rdtsc_wait(nb_cycles);
}


#endif

// End of timing.h.

#include <string.h>
#include <inttypes.h>
#include <errno.h>
#include <ctype.h>
#include <errno.h>
#include <getopt.h>
// Start of values.h.

//// Text I/O

typedef int (*writer)(FILE*, const void*);
typedef int (*bin_reader)(void*);
typedef int (*str_reader)(const char *, void*);

struct array_reader {
  char* elems;
  int64_t n_elems_space;
  int64_t elem_size;
  int64_t n_elems_used;
  int64_t *shape;
  str_reader elem_reader;
};

static void skipspaces() {
  int c;
  do {
    c = getchar();
  } while (isspace(c));

  if (c != EOF) {
    ungetc(c, stdin);
  }
}

static int constituent(char c) {
  return isalnum(c) || c == '.' || c == '-' || c == '+' || c == '_';
}

// Produces an empty token only on EOF.
static void next_token(char *buf, int bufsize) {
 start:
  skipspaces();

  int i = 0;
  while (i < bufsize) {
    int c = getchar();
    buf[i] = (char)c;

    if (c == EOF) {
      buf[i] = 0;
      return;
    } else if (c == '-' && i == 1 && buf[0] == '-') {
      // Line comment, so skip to end of line and start over.
      for (; c != '\n' && c != EOF; c = getchar());
      goto start;
    } else if (!constituent((char)c)) {
      if (i == 0) {
        // We permit single-character tokens that are not
        // constituents; this lets things like ']' and ',' be
        // tokens.
        buf[i+1] = 0;
        return;
      } else {
        ungetc(c, stdin);
        buf[i] = 0;
        return;
      }
    }

    i++;
  }

  buf[bufsize-1] = 0;
}

static int next_token_is(char *buf, int bufsize, const char* expected) {
  next_token(buf, bufsize);
  return strcmp(buf, expected) == 0;
}

static void remove_underscores(char *buf) {
  char *w = buf;

  for (char *r = buf; *r; r++) {
    if (*r != '_') {
      *w++ = *r;
    }
  }

  *w++ = 0;
}

static int read_str_elem(char *buf, struct array_reader *reader) {
  int ret;
  if (reader->n_elems_used == reader->n_elems_space) {
    reader->n_elems_space *= 2;
    reader->elems = (char*) realloc(reader->elems,
                                    (size_t)(reader->n_elems_space * reader->elem_size));
  }

  ret = reader->elem_reader(buf, reader->elems + reader->n_elems_used * reader->elem_size);

  if (ret == 0) {
    reader->n_elems_used++;
  }

  return ret;
}

static int read_str_array_elems(char *buf, int bufsize,
                                struct array_reader *reader, int64_t dims) {
  int ret;
  int first = 1;
  char *knows_dimsize = (char*) calloc((size_t)dims, sizeof(char));
  int cur_dim = dims-1;
  int64_t *elems_read_in_dim = (int64_t*) calloc((size_t)dims, sizeof(int64_t));

  while (1) {
    next_token(buf, bufsize);

    if (strcmp(buf, "]") == 0) {
      if (knows_dimsize[cur_dim]) {
        if (reader->shape[cur_dim] != elems_read_in_dim[cur_dim]) {
          ret = 1;
          break;
        }
      } else {
        knows_dimsize[cur_dim] = 1;
        reader->shape[cur_dim] = elems_read_in_dim[cur_dim];
      }
      if (cur_dim == 0) {
        ret = 0;
        break;
      } else {
        cur_dim--;
        elems_read_in_dim[cur_dim]++;
      }
    } else if (strcmp(buf, ",") == 0) {
      next_token(buf, bufsize);
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        first = 1;
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else if (cur_dim == dims - 1) {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
      } else {
        ret = 1;
        break;
      }
    } else if (strlen(buf) == 0) {
      // EOF
      ret = 1;
      break;
    } else if (first) {
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
        first = 0;
      }
    } else {
      ret = 1;
      break;
    }
  }

  free(knows_dimsize);
  free(elems_read_in_dim);
  return ret;
}

static int read_str_empty_array(char *buf, int bufsize,
                                const char *type_name, int64_t *shape, int64_t dims) {
  if (strlen(buf) == 0) {
    // EOF
    return 1;
  }

  if (strcmp(buf, "empty") != 0) {
    return 1;
  }

  if (!next_token_is(buf, bufsize, "(")) {
    return 1;
  }

  for (int i = 0; i < dims; i++) {
    if (!next_token_is(buf, bufsize, "[")) {
      return 1;
    }

    next_token(buf, bufsize);

    if (sscanf(buf, "%"SCNu64, (uint64_t*)&shape[i]) != 1) {
      return 1;
    }

    if (!next_token_is(buf, bufsize, "]")) {
      return 1;
    }
  }

  if (!next_token_is(buf, bufsize, type_name)) {
    return 1;
  }


  if (!next_token_is(buf, bufsize, ")")) {
    return 1;
  }

  // Check whether the array really is empty.
  for (int i = 0; i < dims; i++) {
    if (shape[i] == 0) {
      return 0;
    }
  }

  // Not an empty array!
  return 1;
}

static int read_str_array(int64_t elem_size, str_reader elem_reader,
                          const char *type_name,
                          void **data, int64_t *shape, int64_t dims) {
  int ret;
  struct array_reader reader;
  char buf[100];

  int dims_seen;
  for (dims_seen = 0; dims_seen < dims; dims_seen++) {
    if (!next_token_is(buf, sizeof(buf), "[")) {
      break;
    }
  }

  if (dims_seen == 0) {
    return read_str_empty_array(buf, sizeof(buf), type_name, shape, dims);
  }

  if (dims_seen != dims) {
    return 1;
  }

  reader.shape = shape;
  reader.n_elems_used = 0;
  reader.elem_size = elem_size;
  reader.n_elems_space = 16;
  reader.elems = (char*) realloc(*data, (size_t)(elem_size*reader.n_elems_space));
  reader.elem_reader = elem_reader;

  ret = read_str_array_elems(buf, sizeof(buf), &reader, dims);

  *data = reader.elems;

  return ret;
}

#define READ_STR(MACRO, PTR, SUFFIX)                                   \
  remove_underscores(buf);                                              \
  int j;                                                                \
  if (sscanf(buf, "%"MACRO"%n", (PTR*)dest, &j) == 1) {                 \
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, SUFFIX) == 0);     \
  } else {                                                              \
    return 1;                                                           \
  }

static int read_str_i8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNi8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(int8_t*)dest = (int8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "i8") == 0);
  } else {
    return 1;
  }
}

static int read_str_u8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNu8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(uint8_t*)dest = (uint8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "u8") == 0);
  } else {
    return 1;
  }
}

static int read_str_i16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "i16");
}

static int read_str_u16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "u16");
}

static int read_str_i32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "i32");
}

static int read_str_u32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "u32");
}

static int read_str_i64(char *buf, void* dest) {
  READ_STR(SCNi64, int64_t, "i64");
}

static int read_str_u64(char *buf, void* dest) {
  // FIXME: This is not correct, as SCNu64 only permits decimal
  // literals.  However, SCNi64 does not handle very large numbers
  // correctly (it's really for signed numbers, so that's fair).
  READ_STR(SCNu64, uint64_t, "u64");
}

static int read_str_f32(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f32.nan") == 0) {
    *(float*)dest = NAN;
    return 0;
  } else if (strcmp(buf, "f32.inf") == 0) {
    *(float*)dest = INFINITY;
    return 0;
  } else if (strcmp(buf, "-f32.inf") == 0) {
    *(float*)dest = -INFINITY;
    return 0;
  } else {
    READ_STR("f", float, "f32");
  }
}

static int read_str_f64(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f64.nan") == 0) {
    *(double*)dest = NAN;
    return 0;
  } else if (strcmp(buf, "f64.inf") == 0) {
    *(double*)dest = INFINITY;
    return 0;
  } else if (strcmp(buf, "-f64.inf") == 0) {
    *(double*)dest = -INFINITY;
    return 0;
  } else {
    READ_STR("lf", double, "f64");
  }
}

static int read_str_bool(char *buf, void* dest) {
  if (strcmp(buf, "true") == 0) {
    *(char*)dest = 1;
    return 0;
  } else if (strcmp(buf, "false") == 0) {
    *(char*)dest = 0;
    return 0;
  } else {
    return 1;
  }
}

static int write_str_i8(FILE *out, int8_t *src) {
  return fprintf(out, "%hhdi8", *src);
}

static int write_str_u8(FILE *out, uint8_t *src) {
  return fprintf(out, "%hhuu8", *src);
}

static int write_str_i16(FILE *out, int16_t *src) {
  return fprintf(out, "%hdi16", *src);
}

static int write_str_u16(FILE *out, uint16_t *src) {
  return fprintf(out, "%huu16", *src);
}

static int write_str_i32(FILE *out, int32_t *src) {
  return fprintf(out, "%di32", *src);
}

static int write_str_u32(FILE *out, uint32_t *src) {
  return fprintf(out, "%uu32", *src);
}

static int write_str_i64(FILE *out, int64_t *src) {
  return fprintf(out, "%"PRIi64"i64", *src);
}

static int write_str_u64(FILE *out, uint64_t *src) {
  return fprintf(out, "%"PRIu64"u64", *src);
}

static int write_str_f32(FILE *out, float *src) {
  float x = *src;
  if (isnan(x)) {
    return fprintf(out, "f32.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f32.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f32.inf");
  } else {
    return fprintf(out, "%.6ff32", x);
  }
}

static int write_str_f64(FILE *out, double *src) {
  double x = *src;
  if (isnan(x)) {
    return fprintf(out, "f64.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f64.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f64.inf");
  } else {
    return fprintf(out, "%.6ff64", *src);
  }
}

static int write_str_bool(FILE *out, void *src) {
  return fprintf(out, *(char*)src ? "true" : "false");
}

//// Binary I/O

#define BINARY_FORMAT_VERSION 2
#define IS_BIG_ENDIAN (!*(unsigned char *)&(uint16_t){1})

static void flip_bytes(int elem_size, unsigned char *elem) {
  for (int j=0; j<elem_size/2; j++) {
    unsigned char head = elem[j];
    int tail_index = elem_size-1-j;
    elem[j] = elem[tail_index];
    elem[tail_index] = head;
  }
}

// On Windows we need to explicitly set the file mode to not mangle
// newline characters.  On *nix there is no difference.
#ifdef _WIN32
#include <io.h>
#include <fcntl.h>
static void set_binary_mode(FILE *f) {
  setmode(fileno(f), O_BINARY);
}
#else
static void set_binary_mode(FILE *f) {
  (void)f;
}
#endif

static int read_byte(void* dest) {
  int num_elems_read = fread(dest, 1, 1, stdin);
  return num_elems_read == 1 ? 0 : 1;
}

//// Types

struct primtype_info_t {
  const char binname[4]; // Used for parsing binary data.
  const char* type_name; // Same name as in Futhark.
  const int64_t size; // in bytes
  const writer write_str; // Write in text format.
  const str_reader read_str; // Read in text format.
};

static const struct primtype_info_t i8_info =
  {.binname = "  i8", .type_name = "i8",   .size = 1,
   .write_str = (writer)write_str_i8, .read_str = (str_reader)read_str_i8};
static const struct primtype_info_t i16_info =
  {.binname = " i16", .type_name = "i16",  .size = 2,
   .write_str = (writer)write_str_i16, .read_str = (str_reader)read_str_i16};
static const struct primtype_info_t i32_info =
  {.binname = " i32", .type_name = "i32",  .size = 4,
   .write_str = (writer)write_str_i32, .read_str = (str_reader)read_str_i32};
static const struct primtype_info_t i64_info =
  {.binname = " i64", .type_name = "i64",  .size = 8,
   .write_str = (writer)write_str_i64, .read_str = (str_reader)read_str_i64};
static const struct primtype_info_t u8_info =
  {.binname = "  u8", .type_name = "u8",   .size = 1,
   .write_str = (writer)write_str_u8, .read_str = (str_reader)read_str_u8};
static const struct primtype_info_t u16_info =
  {.binname = " u16", .type_name = "u16",  .size = 2,
   .write_str = (writer)write_str_u16, .read_str = (str_reader)read_str_u16};
static const struct primtype_info_t u32_info =
  {.binname = " u32", .type_name = "u32",  .size = 4,
   .write_str = (writer)write_str_u32, .read_str = (str_reader)read_str_u32};
static const struct primtype_info_t u64_info =
  {.binname = " u64", .type_name = "u64",  .size = 8,
   .write_str = (writer)write_str_u64, .read_str = (str_reader)read_str_u64};
static const struct primtype_info_t f32_info =
  {.binname = " f32", .type_name = "f32",  .size = 4,
   .write_str = (writer)write_str_f32, .read_str = (str_reader)read_str_f32};
static const struct primtype_info_t f64_info =
  {.binname = " f64", .type_name = "f64",  .size = 8,
   .write_str = (writer)write_str_f64, .read_str = (str_reader)read_str_f64};
static const struct primtype_info_t bool_info =
  {.binname = "bool", .type_name = "bool", .size = 1,
   .write_str = (writer)write_str_bool, .read_str = (str_reader)read_str_bool};

static const struct primtype_info_t* primtypes[] = {
  &i8_info, &i16_info, &i32_info, &i64_info,
  &u8_info, &u16_info, &u32_info, &u64_info,
  &f32_info, &f64_info,
  &bool_info,
  NULL // NULL-terminated
};

// General value interface.  All endian business taken care of at
// lower layers.

static int read_is_binary() {
  skipspaces();
  int c = getchar();
  if (c == 'b') {
    int8_t bin_version;
    int ret = read_byte(&bin_version);

    if (ret != 0) { futhark_panic(1, "binary-input: could not read version.\n"); }

    if (bin_version != BINARY_FORMAT_VERSION) {
      futhark_panic(1, "binary-input: File uses version %i, but I only understand version %i.\n",
            bin_version, BINARY_FORMAT_VERSION);
    }

    return 1;
  }
  ungetc(c, stdin);
  return 0;
}

static const struct primtype_info_t* read_bin_read_type_enum() {
  char read_binname[4];

  int num_matched = scanf("%4c", read_binname);
  if (num_matched != 1) { futhark_panic(1, "binary-input: Couldn't read element type.\n"); }

  const struct primtype_info_t **type = primtypes;

  for (; *type != NULL; type++) {
    // I compare the 4 characters manually instead of using strncmp because
    // this allows any value to be used, also NULL bytes
    if (memcmp(read_binname, (*type)->binname, 4) == 0) {
      return *type;
    }
  }
  futhark_panic(1, "binary-input: Did not recognize the type '%s'.\n", read_binname);
  return NULL;
}

static void read_bin_ensure_scalar(const struct primtype_info_t *expected_type) {
  int8_t bin_dims;
  int ret = read_byte(&bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != 0) {
    futhark_panic(1, "binary-input: Expected scalar (0 dimensions), but got array with %i dimensions.\n",
          bin_dims);
  }

  const struct primtype_info_t *bin_type = read_bin_read_type_enum();
  if (bin_type != expected_type) {
    futhark_panic(1, "binary-input: Expected scalar of type %s but got scalar of type %s.\n",
          expected_type->type_name,
          bin_type->type_name);
  }
}

//// High-level interface

static int read_bin_array(const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  int ret;

  int8_t bin_dims;
  ret = read_byte(&bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != dims) {
    futhark_panic(1, "binary-input: Expected %i dimensions, but got array with %i dimensions.\n",
          dims, bin_dims);
  }

  const struct primtype_info_t *bin_primtype = read_bin_read_type_enum();
  if (expected_type != bin_primtype) {
    futhark_panic(1, "binary-input: Expected %iD-array with element type '%s' but got %iD-array with element type '%s'.\n",
          dims, expected_type->type_name, dims, bin_primtype->type_name);
  }

  int64_t elem_count = 1;
  for (int i=0; i<dims; i++) {
    int64_t bin_shape;
    ret = fread(&bin_shape, sizeof(bin_shape), 1, stdin);
    if (ret != 1) {
      futhark_panic(1, "binary-input: Couldn't read size for dimension %i of array.\n", i);
    }
    if (IS_BIG_ENDIAN) {
      flip_bytes(sizeof(bin_shape), (unsigned char*) &bin_shape);
    }
    elem_count *= bin_shape;
    shape[i] = bin_shape;
  }

  int64_t elem_size = expected_type->size;
  void* tmp = realloc(*data, (size_t)(elem_count * elem_size));
  if (tmp == NULL) {
    futhark_panic(1, "binary-input: Failed to allocate array of size %i.\n",
          elem_count * elem_size);
  }
  *data = tmp;

  int64_t num_elems_read = (int64_t)fread(*data, (size_t)elem_size, (size_t)elem_count, stdin);
  if (num_elems_read != elem_count) {
    futhark_panic(1, "binary-input: tried to read %i elements of an array, but only got %i elements.\n",
          elem_count, num_elems_read);
  }

  // If we're on big endian platform we must change all multibyte elements
  // from using little endian to big endian
  if (IS_BIG_ENDIAN && elem_size != 1) {
    flip_bytes(elem_size, (unsigned char*) *data);
  }

  return 0;
}

static int read_array(const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  if (!read_is_binary()) {
    return read_str_array(expected_type->size, (str_reader)expected_type->read_str, expected_type->type_name, data, shape, dims);
  } else {
    return read_bin_array(expected_type, data, shape, dims);
  }
}

static int end_of_input() {
  skipspaces();
  char token[2];
  next_token(token, sizeof(token));
  if (strcmp(token, "") == 0) {
    return 0;
  } else {
    return 1;
  }
}

static int write_str_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  if (rank==0) {
    elem_type->write_str(out, (void*)data);
  } else {
    int64_t len = (int64_t)shape[0];
    int64_t slice_size = 1;

    int64_t elem_size = elem_type->size;
    for (int8_t i = 1; i < rank; i++) {
      slice_size *= shape[i];
    }

    if (len*slice_size == 0) {
      printf("empty(");
      for (int64_t i = 0; i < rank; i++) {
        printf("[%"PRIi64"]", shape[i]);
      }
      printf("%s", elem_type->type_name);
      printf(")");
    } else if (rank==1) {
      putchar('[');
      for (int64_t i = 0; i < len; i++) {
        elem_type->write_str(out, (void*) (data + i * elem_size));
        if (i != len-1) {
          printf(", ");
        }
      }
      putchar(']');
    } else {
      putchar('[');
      for (int64_t i = 0; i < len; i++) {
        write_str_array(out, elem_type, data + i * slice_size * elem_size, shape+1, rank-1);
        if (i != len-1) {
          printf(", ");
        }
      }
      putchar(']');
    }
  }
  return 0;
}

static int write_bin_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  int64_t num_elems = 1;
  for (int64_t i = 0; i < rank; i++) {
    num_elems *= shape[i];
  }

  fputc('b', out);
  fputc((char)BINARY_FORMAT_VERSION, out);
  fwrite(&rank, sizeof(int8_t), 1, out);
  fputs(elem_type->binname, out);
  if (shape != NULL) {
    fwrite(shape, sizeof(int64_t), (size_t)rank, out);
  }

  if (IS_BIG_ENDIAN) {
    for (int64_t i = 0; i < num_elems; i++) {
      const unsigned char *elem = data+i*elem_type->size;
      for (int64_t j = 0; j < elem_type->size; j++) {
        fwrite(&elem[elem_type->size-j], 1, 1, out);
      }
    }
  } else {
    fwrite(data, (size_t)elem_type->size, (size_t)num_elems, out);
  }

  return 0;
}

static int write_array(FILE *out, int write_binary,
                       const struct primtype_info_t *elem_type,
                       const void *data,
                       const int64_t *shape,
                       const int8_t rank) {
  if (write_binary) {
    return write_bin_array(out, elem_type, data, shape, rank);
  } else {
    return write_str_array(out, elem_type, data, shape, rank);
  }
}

static int read_scalar(const struct primtype_info_t *expected_type, void *dest) {
  if (!read_is_binary()) {
    char buf[100];
    next_token(buf, sizeof(buf));
    return expected_type->read_str(buf, dest);
  } else {
    read_bin_ensure_scalar(expected_type);
    int64_t elem_size = expected_type->size;
    int num_elems_read = fread(dest, (size_t)elem_size, 1, stdin);
    if (IS_BIG_ENDIAN) {
      flip_bytes(elem_size, (unsigned char*) dest);
    }
    return num_elems_read == 1 ? 0 : 1;
  }
}

static int write_scalar(FILE *out, int write_binary, const struct primtype_info_t *type, void *src) {
  if (write_binary) {
    return write_bin_array(out, type, src, NULL, 0);
  } else {
    return type->write_str(out, src);
  }
}

// End of values.h.

#define __private
static int binary_output = 0;
static FILE *runtime_file;
static int perform_warmup = 0;
static int num_runs = 1;
static const char *entry_point = "main";
// Start of tuning.h.

static char* load_tuning_file(const char *fname,
                              void *cfg,
                              int (*set_size)(void*, const char*, size_t)) {
  const int max_line_len = 1024;
  char* line = (char*) malloc(max_line_len);

  FILE *f = fopen(fname, "r");

  if (f == NULL) {
    snprintf(line, max_line_len, "Cannot open file: %s", strerror(errno));
    return line;
  }

  int lineno = 0;
  while (fgets(line, max_line_len, f) != NULL) {
    lineno++;
    char *eql = strstr(line, "=");
    if (eql) {
      *eql = 0;
      int value = atoi(eql+1);
      if (set_size(cfg, line, value) != 0) {
        strncpy(eql+1, line, max_line_len-strlen(line)-1);
        snprintf(line, max_line_len, "Unknown name '%s' on line %d.", eql+1, lineno);
        return line;
      }
    } else {
      snprintf(line, max_line_len, "Invalid line %d (must be of form 'name=int').",
               lineno);
      return line;
    }
  }

  free(line);

  return NULL;
}

// End of tuning.h.

int parse_options(struct futhark_context_config *cfg, int argc,
                  char *const argv[])
{
    int ch;
    static struct option long_options[] = {{"write-runtime-to",
                                            required_argument, NULL, 1},
                                           {"runs", required_argument, NULL, 2},
                                           {"debugging", no_argument, NULL, 3},
                                           {"log", no_argument, NULL, 4},
                                           {"entry-point", required_argument,
                                            NULL, 5}, {"binary-output",
                                                       no_argument, NULL, 6},
                                           {"help", no_argument, NULL, 7},
                                           {"device", required_argument, NULL,
                                            8}, {"default-group-size",
                                                 required_argument, NULL, 9},
                                           {"default-num-groups",
                                            required_argument, NULL, 10},
                                           {"default-tile-size",
                                            required_argument, NULL, 11},
                                           {"default-threshold",
                                            required_argument, NULL, 12},
                                           {"print-sizes", no_argument, NULL,
                                            13}, {"size", required_argument,
                                                  NULL, 14}, {"tuning",
                                                              required_argument,
                                                              NULL, 15},
                                           {"platform", required_argument, NULL,
                                            16}, {"dump-opencl",
                                                  required_argument, NULL, 17},
                                           {"load-opencl", required_argument,
                                            NULL, 18}, {"dump-opencl-binary",
                                                        required_argument, NULL,
                                                        19},
                                           {"load-opencl-binary",
                                            required_argument, NULL, 20},
                                           {"build-option", required_argument,
                                            NULL, 21}, {"profile", no_argument,
                                                        NULL, 22},
                                           {"list-devices", no_argument, NULL,
                                            23}, {0, 0, 0, 0}};
    static char *option_descriptions =
                "  -t/--write-runtime-to FILE Print the time taken to execute the program to the indicated file, an integral number of microseconds.\n  -r/--runs INT              Perform NUM runs of the program.\n  -D/--debugging             Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                   Print various low-overhead logging information to stderr while running.\n  -e/--entry-point NAME      The entry point to run. Defaults to main.\n  -b/--binary-output         Print the program result in the binary output format.\n  -h/--help                  Print help information and exit.\n  -d/--device NAME           Use the first OpenCL device whose name contains the given string.\n  --default-group-size INT   The default size of OpenCL workgroups that are launched.\n  --default-num-groups INT   The default number of OpenCL workgroups that are launched.\n  --default-tile-size INT    The default tile size used when performing two-dimensional tiling.\n  --default-threshold INT    The default parallelism threshold.\n  --print-sizes              Print all sizes that can be set with -size or --tuning.\n  --size ASSIGNMENT          Set a configurable run-time parameter to the given value.\n  --tuning FILE              Read size=value assignments from the given file.\n  -p/--platform NAME         Use the first OpenCL platform whose name contains the given string.\n  --dump-opencl FILE         Dump the embedded OpenCL program to the indicated file.\n  --load-opencl FILE         Instead of using the embedded OpenCL program, load it from the indicated file.\n  --dump-opencl-binary FILE  Dump the compiled version of the embedded OpenCL program to the indicated file.\n  --load-opencl-binary FILE  Load an OpenCL binary from the indicated file.\n  --build-option OPT         Add an additional build option to the string passed to clBuildProgram().\n  -P/--profile               Gather profiling data while executing and print out a summary at the end.\n  --list-devices             List all OpenCL devices and platforms available on the system.\n";
    
    while ((ch = getopt_long(argc, argv, ":t:r:DLe:bhd:p:P", long_options,
                             NULL)) != -1) {
        if (ch == 1 || ch == 't') {
            runtime_file = fopen(optarg, "w");
            if (runtime_file == NULL)
                futhark_panic(1, "Cannot open %s: %s\n", optarg,
                              strerror(errno));
        }
        if (ch == 2 || ch == 'r') {
            num_runs = atoi(optarg);
            perform_warmup = 1;
            if (num_runs <= 0)
                futhark_panic(1, "Need a positive number of runs, not %s\n",
                              optarg);
        }
        if (ch == 3 || ch == 'D')
            futhark_context_config_set_debugging(cfg, 1);
        if (ch == 4 || ch == 'L')
            futhark_context_config_set_logging(cfg, 1);
        if (ch == 5 || ch == 'e') {
            if (entry_point != NULL)
                entry_point = optarg;
        }
        if (ch == 6 || ch == 'b')
            binary_output = 1;
        if (ch == 7 || ch == 'h') {
            printf("Usage: %s [OPTION]...\nOptions:\n\n%s\nFor more information, consult the Futhark User's Guide or the man pages.\n",
                   fut_progname, option_descriptions);
            exit(0);
        }
        if (ch == 8 || ch == 'd')
            futhark_context_config_set_device(cfg, optarg);
        if (ch == 9)
            futhark_context_config_set_default_group_size(cfg, atoi(optarg));
        if (ch == 10)
            futhark_context_config_set_default_num_groups(cfg, atoi(optarg));
        if (ch == 11)
            futhark_context_config_set_default_tile_size(cfg, atoi(optarg));
        if (ch == 12)
            futhark_context_config_set_default_threshold(cfg, atoi(optarg));
        if (ch == 13) {
            int n = futhark_get_num_sizes();
            
            for (int i = 0; i < n; i++)
                printf("%s (%s)\n", futhark_get_size_name(i),
                       futhark_get_size_class(i));
            exit(0);
        }
        if (ch == 14) {
            char *name = optarg;
            char *equals = strstr(optarg, "=");
            char *value_str = equals != NULL ? equals + 1 : optarg;
            int value = atoi(value_str);
            
            if (equals != NULL) {
                *equals = 0;
                if (futhark_context_config_set_size(cfg, name, value) != 0)
                    futhark_panic(1, "Unknown size: %s\n", name);
            } else
                futhark_panic(1, "Invalid argument for size option: %s\n",
                              optarg);
        }
        if (ch == 15) {
            char *ret = load_tuning_file(optarg, cfg, (int (*)(void *, const
                                                               char *,
                                                               size_t)) futhark_context_config_set_size);
            
            if (ret != NULL)
                futhark_panic(1, "When loading tuning from '%s': %s\n", optarg,
                              ret);
        }
        if (ch == 16 || ch == 'p')
            futhark_context_config_set_platform(cfg, optarg);
        if (ch == 17) {
            futhark_context_config_dump_program_to(cfg, optarg);
            entry_point = NULL;
        }
        if (ch == 18)
            futhark_context_config_load_program_from(cfg, optarg);
        if (ch == 19) {
            futhark_context_config_dump_binary_to(cfg, optarg);
            entry_point = NULL;
        }
        if (ch == 20)
            futhark_context_config_load_binary_from(cfg, optarg);
        if (ch == 21)
            futhark_context_config_add_build_option(cfg, optarg);
        if (ch == 22 || ch == 'P')
            futhark_context_config_set_profiling(cfg, 1);
        if (ch == 23) {
            futhark_context_config_list_devices(cfg);
            entry_point = NULL;
        }
        if (ch == ':')
            futhark_panic(-1, "Missing argument for option %s\n", argv[optind -
                                                                       1]);
        if (ch == '?') {
            fprintf(stderr, "Usage: %s: %s\n", fut_progname,
                    "  -t/--write-runtime-to FILE Print the time taken to execute the program to the indicated file, an integral number of microseconds.\n  -r/--runs INT              Perform NUM runs of the program.\n  -D/--debugging             Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                   Print various low-overhead logging information to stderr while running.\n  -e/--entry-point NAME      The entry point to run. Defaults to main.\n  -b/--binary-output         Print the program result in the binary output format.\n  -h/--help                  Print help information and exit.\n  -d/--device NAME           Use the first OpenCL device whose name contains the given string.\n  --default-group-size INT   The default size of OpenCL workgroups that are launched.\n  --default-num-groups INT   The default number of OpenCL workgroups that are launched.\n  --default-tile-size INT    The default tile size used when performing two-dimensional tiling.\n  --default-threshold INT    The default parallelism threshold.\n  --print-sizes              Print all sizes that can be set with -size or --tuning.\n  --size ASSIGNMENT          Set a configurable run-time parameter to the given value.\n  --tuning FILE              Read size=value assignments from the given file.\n  -p/--platform NAME         Use the first OpenCL platform whose name contains the given string.\n  --dump-opencl FILE         Dump the embedded OpenCL program to the indicated file.\n  --load-opencl FILE         Instead of using the embedded OpenCL program, load it from the indicated file.\n  --dump-opencl-binary FILE  Dump the compiled version of the embedded OpenCL program to the indicated file.\n  --load-opencl-binary FILE  Load an OpenCL binary from the indicated file.\n  --build-option OPT         Add an additional build option to the string passed to clBuildProgram().\n  -P/--profile               Gather profiling data while executing and print out a summary at the end.\n  --list-devices             List all OpenCL devices and platforms available on the system.\n");
            futhark_panic(1, "Unknown option: %s\n", argv[optind - 1]);
        }
    }
    return optind;
}
static void futrts_cli_entry_main(struct futhark_context *ctx)
{
    int64_t t_start, t_end;
    int time_runs = 0, profile_run = 0;
    
    // We do not want to profile all the initialisation.
    futhark_context_pause_profiling(ctx);
    // Declare and read input.
    set_binary_mode(stdin);
    
    int64_t read_value_29084;
    
    if (read_scalar(&i64_info, &read_value_29084) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      0, i64_info.type_name, strerror(errno));
    
    int64_t read_value_29085;
    
    if (read_scalar(&i64_info, &read_value_29085) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      1, i64_info.type_name, strerror(errno));
    
    struct futhark_f32_1d *read_value_29086;
    int64_t read_shape_29087[1];
    float *read_arr_29088 = NULL;
    
    errno = 0;
    if (read_array(&f32_info, (void **) &read_arr_29088, read_shape_29087, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s%s (errno: %s).\n", 2,
                      "[]", f32_info.type_name, strerror(errno));
    
    struct futhark_i64_1d *read_value_29089;
    int64_t read_shape_29090[1];
    int64_t *read_arr_29091 = NULL;
    
    errno = 0;
    if (read_array(&i64_info, (void **) &read_arr_29091, read_shape_29090, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s%s (errno: %s).\n", 3,
                      "[]", i64_info.type_name, strerror(errno));
    
    struct futhark_f32_1d *read_value_29092;
    int64_t read_shape_29093[1];
    float *read_arr_29094 = NULL;
    
    errno = 0;
    if (read_array(&f32_info, (void **) &read_arr_29094, read_shape_29093, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s%s (errno: %s).\n", 4,
                      "[]", f32_info.type_name, strerror(errno));
    
    float read_value_29095;
    
    if (read_scalar(&f32_info, &read_value_29095) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      5, f32_info.type_name, strerror(errno));
    
    float read_value_29096;
    
    if (read_scalar(&f32_info, &read_value_29096) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      6, f32_info.type_name, strerror(errno));
    
    float read_value_29097;
    
    if (read_scalar(&f32_info, &read_value_29097) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      7, f32_info.type_name, strerror(errno));
    
    float read_value_29098;
    
    if (read_scalar(&f32_info, &read_value_29098) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      8, f32_info.type_name, strerror(errno));
    if (end_of_input() != 0)
        futhark_panic(1, "Expected EOF on stdin after reading input for %s.\n",
                      "\"main\"");
    
    float result_29099;
    struct futhark_f32_1d *result_29100;
    
    if (perform_warmup) {
        int r;
        
        ;
        ;
        assert((read_value_29086 = futhark_new_f32_1d(ctx, read_arr_29088,
                                                      read_shape_29087[0])) !=
            0);
        assert((read_value_29089 = futhark_new_i64_1d(ctx, read_arr_29091,
                                                      read_shape_29090[0])) !=
            0);
        assert((read_value_29092 = futhark_new_f32_1d(ctx, read_arr_29094,
                                                      read_shape_29093[0])) !=
            0);
        ;
        ;
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_main(ctx, &result_29099, &result_29100,
                               read_value_29084, read_value_29085,
                               read_value_29086, read_value_29089,
                               read_value_29092, read_value_29095,
                               read_value_29096, read_value_29097,
                               read_value_29098);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        assert(futhark_free_f32_1d(ctx, read_value_29086) == 0);
        assert(futhark_free_i64_1d(ctx, read_value_29089) == 0);
        assert(futhark_free_f32_1d(ctx, read_value_29092) == 0);
        ;
        ;
        ;
        ;
        ;
        assert(futhark_free_f32_1d(ctx, result_29100) == 0);
    }
    time_runs = 1;
    // Proper run.
    for (int run = 0; run < num_runs; run++) {
        // Only profile last run.
        profile_run = run == num_runs - 1;
        
        int r;
        
        ;
        ;
        assert((read_value_29086 = futhark_new_f32_1d(ctx, read_arr_29088,
                                                      read_shape_29087[0])) !=
            0);
        assert((read_value_29089 = futhark_new_i64_1d(ctx, read_arr_29091,
                                                      read_shape_29090[0])) !=
            0);
        assert((read_value_29092 = futhark_new_f32_1d(ctx, read_arr_29094,
                                                      read_shape_29093[0])) !=
            0);
        ;
        ;
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_main(ctx, &result_29099, &result_29100,
                               read_value_29084, read_value_29085,
                               read_value_29086, read_value_29089,
                               read_value_29092, read_value_29095,
                               read_value_29096, read_value_29097,
                               read_value_29098);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        assert(futhark_free_f32_1d(ctx, read_value_29086) == 0);
        assert(futhark_free_i64_1d(ctx, read_value_29089) == 0);
        assert(futhark_free_f32_1d(ctx, read_value_29092) == 0);
        ;
        ;
        ;
        ;
        if (run < num_runs - 1) {
            ;
            assert(futhark_free_f32_1d(ctx, result_29100) == 0);
        }
    }
    ;
    ;
    free(read_arr_29088);
    free(read_arr_29091);
    free(read_arr_29094);
    ;
    ;
    ;
    ;
    if (binary_output)
        set_binary_mode(stdout);
    write_scalar(stdout, binary_output, &f32_info, &result_29099);
    printf("\n");
    {
        float *arr = calloc(sizeof(float), futhark_shape_f32_1d(ctx,
                                                                result_29100)[0]);
        
        assert(arr != NULL);
        assert(futhark_values_f32_1d(ctx, result_29100, arr) == 0);
        write_array(stdout, binary_output, &f32_info, arr,
                    futhark_shape_f32_1d(ctx, result_29100), 1);
        free(arr);
    }
    printf("\n");
    ;
    assert(futhark_free_f32_1d(ctx, result_29100) == 0);
}
static void futrts_cli_entry_test(struct futhark_context *ctx)
{
    int64_t t_start, t_end;
    int time_runs = 0, profile_run = 0;
    
    // We do not want to profile all the initialisation.
    futhark_context_pause_profiling(ctx);
    // Declare and read input.
    set_binary_mode(stdin);
    
    int64_t read_value_29101;
    
    if (read_scalar(&i64_info, &read_value_29101) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      0, i64_info.type_name, strerror(errno));
    
    int64_t read_value_29102;
    
    if (read_scalar(&i64_info, &read_value_29102) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      1, i64_info.type_name, strerror(errno));
    if (end_of_input() != 0)
        futhark_panic(1, "Expected EOF on stdin after reading input for %s.\n",
                      "\"test\"");
    
    float result_29103;
    
    if (perform_warmup) {
        int r;
        
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_test(ctx, &result_29103, read_value_29101,
                               read_value_29102);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        ;
    }
    time_runs = 1;
    // Proper run.
    for (int run = 0; run < num_runs; run++) {
        // Only profile last run.
        profile_run = run == num_runs - 1;
        
        int r;
        
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_test(ctx, &result_29103, read_value_29101,
                               read_value_29102);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        if (run < num_runs - 1) {
            ;
        }
    }
    ;
    ;
    if (binary_output)
        set_binary_mode(stdout);
    write_scalar(stdout, binary_output, &f32_info, &result_29103);
    printf("\n");
    ;
}
typedef void entry_point_fun(struct futhark_context *);
struct entry_point_entry {
    const char *name;
    entry_point_fun *fun;
} ;
int main(int argc, char **argv)
{
    fut_progname = argv[0];
    
    struct entry_point_entry entry_points[] = {{.name ="main", .fun =
                                                futrts_cli_entry_main}, {.name =
                                                                         "test",
                                                                         .fun =
                                                                         futrts_cli_entry_test}};
    struct futhark_context_config *cfg = futhark_context_config_new();
    
    assert(cfg != NULL);
    
    int parsed_options = parse_options(cfg, argc, argv);
    
    argc -= parsed_options;
    argv += parsed_options;
    if (argc != 0)
        futhark_panic(1, "Excess non-option: %s\n", argv[0]);
    
    struct futhark_context *ctx = futhark_context_new(cfg);
    
    assert(ctx != NULL);
    
    char *error = futhark_context_get_error(ctx);
    
    if (error != NULL)
        futhark_panic(1, "%s", error);
    if (entry_point != NULL) {
        int num_entry_points = sizeof(entry_points) / sizeof(entry_points[0]);
        entry_point_fun *entry_point_fun = NULL;
        
        for (int i = 0; i < num_entry_points; i++) {
            if (strcmp(entry_points[i].name, entry_point) == 0) {
                entry_point_fun = entry_points[i].fun;
                break;
            }
        }
        if (entry_point_fun == NULL) {
            fprintf(stderr,
                    "No entry point '%s'.  Select another with --entry-point.  Options are:\n",
                    entry_point);
            for (int i = 0; i < num_entry_points; i++)
                fprintf(stderr, "%s\n", entry_points[i].name);
            return 1;
        }
        entry_point_fun(ctx);
        if (runtime_file != NULL)
            fclose(runtime_file);
        
        char *report = futhark_context_report(ctx);
        
        fputs(report, stderr);
        free(report);
    }
    futhark_context_free(ctx);
    futhark_context_config_free(cfg);
    return 0;
}
#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <inttypes.h>
#include <ctype.h>
#include <errno.h>
#include <assert.h>
#define CL_TARGET_OPENCL_VERSION 120
#define CL_USE_DEPRECATED_OPENCL_1_2_APIS
#ifdef __APPLE__
#define CL_SILENCE_DEPRECATION
#include <OpenCL/cl.h>
#else
#include <CL/cl.h>
#endif

// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.

static inline uint8_t add8(uint8_t x, uint8_t y)
{
    return x + y;
}
static inline uint16_t add16(uint16_t x, uint16_t y)
{
    return x + y;
}
static inline uint32_t add32(uint32_t x, uint32_t y)
{
    return x + y;
}
static inline uint64_t add64(uint64_t x, uint64_t y)
{
    return x + y;
}
static inline uint8_t sub8(uint8_t x, uint8_t y)
{
    return x - y;
}
static inline uint16_t sub16(uint16_t x, uint16_t y)
{
    return x - y;
}
static inline uint32_t sub32(uint32_t x, uint32_t y)
{
    return x - y;
}
static inline uint64_t sub64(uint64_t x, uint64_t y)
{
    return x - y;
}
static inline uint8_t mul8(uint8_t x, uint8_t y)
{
    return x * y;
}
static inline uint16_t mul16(uint16_t x, uint16_t y)
{
    return x * y;
}
static inline uint32_t mul32(uint32_t x, uint32_t y)
{
    return x * y;
}
static inline uint64_t mul64(uint64_t x, uint64_t y)
{
    return x * y;
}
static inline uint8_t udiv8(uint8_t x, uint8_t y)
{
    return x / y;
}
static inline uint16_t udiv16(uint16_t x, uint16_t y)
{
    return x / y;
}
static inline uint32_t udiv32(uint32_t x, uint32_t y)
{
    return x / y;
}
static inline uint64_t udiv64(uint64_t x, uint64_t y)
{
    return x / y;
}
static inline uint8_t udiv_up8(uint8_t x, uint8_t y)
{
    return (x + y - 1) / y;
}
static inline uint16_t udiv_up16(uint16_t x, uint16_t y)
{
    return (x + y - 1) / y;
}
static inline uint32_t udiv_up32(uint32_t x, uint32_t y)
{
    return (x + y - 1) / y;
}
static inline uint64_t udiv_up64(uint64_t x, uint64_t y)
{
    return (x + y - 1) / y;
}
static inline uint8_t umod8(uint8_t x, uint8_t y)
{
    return x % y;
}
static inline uint16_t umod16(uint16_t x, uint16_t y)
{
    return x % y;
}
static inline uint32_t umod32(uint32_t x, uint32_t y)
{
    return x % y;
}
static inline uint64_t umod64(uint64_t x, uint64_t y)
{
    return x % y;
}
static inline uint8_t udiv_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint16_t udiv_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint32_t udiv_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint64_t udiv_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint8_t umod_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint16_t umod_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint32_t umod_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint64_t umod_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int8_t sdiv8(int8_t x, int8_t y)
{
    int8_t q = x / y;
    int8_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int16_t sdiv16(int16_t x, int16_t y)
{
    int16_t q = x / y;
    int16_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int32_t sdiv32(int32_t x, int32_t y)
{
    int32_t q = x / y;
    int32_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int64_t sdiv64(int64_t x, int64_t y)
{
    int64_t q = x / y;
    int64_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int8_t sdiv_up8(int8_t x, int8_t y)
{
    return sdiv8(x + y - 1, y);
}
static inline int16_t sdiv_up16(int16_t x, int16_t y)
{
    return sdiv16(x + y - 1, y);
}
static inline int32_t sdiv_up32(int32_t x, int32_t y)
{
    return sdiv32(x + y - 1, y);
}
static inline int64_t sdiv_up64(int64_t x, int64_t y)
{
    return sdiv64(x + y - 1, y);
}
static inline int8_t smod8(int8_t x, int8_t y)
{
    int8_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int16_t smod16(int16_t x, int16_t y)
{
    int16_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int32_t smod32(int32_t x, int32_t y)
{
    int32_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int64_t smod64(int64_t x, int64_t y)
{
    int64_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int8_t sdiv_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : sdiv8(x, y);
}
static inline int16_t sdiv_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : sdiv16(x, y);
}
static inline int32_t sdiv_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : sdiv32(x, y);
}
static inline int64_t sdiv_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : sdiv64(x, y);
}
static inline int8_t sdiv_up_safe8(int8_t x, int8_t y)
{
    return sdiv_safe8(x + y - 1, y);
}
static inline int16_t sdiv_up_safe16(int16_t x, int16_t y)
{
    return sdiv_safe16(x + y - 1, y);
}
static inline int32_t sdiv_up_safe32(int32_t x, int32_t y)
{
    return sdiv_safe32(x + y - 1, y);
}
static inline int64_t sdiv_up_safe64(int64_t x, int64_t y)
{
    return sdiv_safe64(x + y - 1, y);
}
static inline int8_t smod_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : smod8(x, y);
}
static inline int16_t smod_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : smod16(x, y);
}
static inline int32_t smod_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : smod32(x, y);
}
static inline int64_t smod_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : smod64(x, y);
}
static inline int8_t squot8(int8_t x, int8_t y)
{
    return x / y;
}
static inline int16_t squot16(int16_t x, int16_t y)
{
    return x / y;
}
static inline int32_t squot32(int32_t x, int32_t y)
{
    return x / y;
}
static inline int64_t squot64(int64_t x, int64_t y)
{
    return x / y;
}
static inline int8_t srem8(int8_t x, int8_t y)
{
    return x % y;
}
static inline int16_t srem16(int16_t x, int16_t y)
{
    return x % y;
}
static inline int32_t srem32(int32_t x, int32_t y)
{
    return x % y;
}
static inline int64_t srem64(int64_t x, int64_t y)
{
    return x % y;
}
static inline int8_t squot_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int16_t squot_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int32_t squot_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int64_t squot_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int8_t srem_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int16_t srem_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int32_t srem_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int64_t srem_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int8_t smin8(int8_t x, int8_t y)
{
    return x < y ? x : y;
}
static inline int16_t smin16(int16_t x, int16_t y)
{
    return x < y ? x : y;
}
static inline int32_t smin32(int32_t x, int32_t y)
{
    return x < y ? x : y;
}
static inline int64_t smin64(int64_t x, int64_t y)
{
    return x < y ? x : y;
}
static inline uint8_t umin8(uint8_t x, uint8_t y)
{
    return x < y ? x : y;
}
static inline uint16_t umin16(uint16_t x, uint16_t y)
{
    return x < y ? x : y;
}
static inline uint32_t umin32(uint32_t x, uint32_t y)
{
    return x < y ? x : y;
}
static inline uint64_t umin64(uint64_t x, uint64_t y)
{
    return x < y ? x : y;
}
static inline int8_t smax8(int8_t x, int8_t y)
{
    return x < y ? y : x;
}
static inline int16_t smax16(int16_t x, int16_t y)
{
    return x < y ? y : x;
}
static inline int32_t smax32(int32_t x, int32_t y)
{
    return x < y ? y : x;
}
static inline int64_t smax64(int64_t x, int64_t y)
{
    return x < y ? y : x;
}
static inline uint8_t umax8(uint8_t x, uint8_t y)
{
    return x < y ? y : x;
}
static inline uint16_t umax16(uint16_t x, uint16_t y)
{
    return x < y ? y : x;
}
static inline uint32_t umax32(uint32_t x, uint32_t y)
{
    return x < y ? y : x;
}
static inline uint64_t umax64(uint64_t x, uint64_t y)
{
    return x < y ? y : x;
}
static inline uint8_t shl8(uint8_t x, uint8_t y)
{
    return x << y;
}
static inline uint16_t shl16(uint16_t x, uint16_t y)
{
    return x << y;
}
static inline uint32_t shl32(uint32_t x, uint32_t y)
{
    return x << y;
}
static inline uint64_t shl64(uint64_t x, uint64_t y)
{
    return x << y;
}
static inline uint8_t lshr8(uint8_t x, uint8_t y)
{
    return x >> y;
}
static inline uint16_t lshr16(uint16_t x, uint16_t y)
{
    return x >> y;
}
static inline uint32_t lshr32(uint32_t x, uint32_t y)
{
    return x >> y;
}
static inline uint64_t lshr64(uint64_t x, uint64_t y)
{
    return x >> y;
}
static inline int8_t ashr8(int8_t x, int8_t y)
{
    return x >> y;
}
static inline int16_t ashr16(int16_t x, int16_t y)
{
    return x >> y;
}
static inline int32_t ashr32(int32_t x, int32_t y)
{
    return x >> y;
}
static inline int64_t ashr64(int64_t x, int64_t y)
{
    return x >> y;
}
static inline uint8_t and8(uint8_t x, uint8_t y)
{
    return x & y;
}
static inline uint16_t and16(uint16_t x, uint16_t y)
{
    return x & y;
}
static inline uint32_t and32(uint32_t x, uint32_t y)
{
    return x & y;
}
static inline uint64_t and64(uint64_t x, uint64_t y)
{
    return x & y;
}
static inline uint8_t or8(uint8_t x, uint8_t y)
{
    return x | y;
}
static inline uint16_t or16(uint16_t x, uint16_t y)
{
    return x | y;
}
static inline uint32_t or32(uint32_t x, uint32_t y)
{
    return x | y;
}
static inline uint64_t or64(uint64_t x, uint64_t y)
{
    return x | y;
}
static inline uint8_t xor8(uint8_t x, uint8_t y)
{
    return x ^ y;
}
static inline uint16_t xor16(uint16_t x, uint16_t y)
{
    return x ^ y;
}
static inline uint32_t xor32(uint32_t x, uint32_t y)
{
    return x ^ y;
}
static inline uint64_t xor64(uint64_t x, uint64_t y)
{
    return x ^ y;
}
static inline bool ult8(uint8_t x, uint8_t y)
{
    return x < y;
}
static inline bool ult16(uint16_t x, uint16_t y)
{
    return x < y;
}
static inline bool ult32(uint32_t x, uint32_t y)
{
    return x < y;
}
static inline bool ult64(uint64_t x, uint64_t y)
{
    return x < y;
}
static inline bool ule8(uint8_t x, uint8_t y)
{
    return x <= y;
}
static inline bool ule16(uint16_t x, uint16_t y)
{
    return x <= y;
}
static inline bool ule32(uint32_t x, uint32_t y)
{
    return x <= y;
}
static inline bool ule64(uint64_t x, uint64_t y)
{
    return x <= y;
}
static inline bool slt8(int8_t x, int8_t y)
{
    return x < y;
}
static inline bool slt16(int16_t x, int16_t y)
{
    return x < y;
}
static inline bool slt32(int32_t x, int32_t y)
{
    return x < y;
}
static inline bool slt64(int64_t x, int64_t y)
{
    return x < y;
}
static inline bool sle8(int8_t x, int8_t y)
{
    return x <= y;
}
static inline bool sle16(int16_t x, int16_t y)
{
    return x <= y;
}
static inline bool sle32(int32_t x, int32_t y)
{
    return x <= y;
}
static inline bool sle64(int64_t x, int64_t y)
{
    return x <= y;
}
static inline int8_t pow8(int8_t x, int8_t y)
{
    int8_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int16_t pow16(int16_t x, int16_t y)
{
    int16_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int32_t pow32(int32_t x, int32_t y)
{
    int32_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int64_t pow64(int64_t x, int64_t y)
{
    int64_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline bool itob_i8_bool(int8_t x)
{
    return x;
}
static inline bool itob_i16_bool(int16_t x)
{
    return x;
}
static inline bool itob_i32_bool(int32_t x)
{
    return x;
}
static inline bool itob_i64_bool(int64_t x)
{
    return x;
}
static inline int8_t btoi_bool_i8(bool x)
{
    return x;
}
static inline int16_t btoi_bool_i16(bool x)
{
    return x;
}
static inline int32_t btoi_bool_i32(bool x)
{
    return x;
}
static inline int64_t btoi_bool_i64(bool x)
{
    return x;
}
#define sext_i8_i8(x) ((int8_t) (int8_t) x)
#define sext_i8_i16(x) ((int16_t) (int8_t) x)
#define sext_i8_i32(x) ((int32_t) (int8_t) x)
#define sext_i8_i64(x) ((int64_t) (int8_t) x)
#define sext_i16_i8(x) ((int8_t) (int16_t) x)
#define sext_i16_i16(x) ((int16_t) (int16_t) x)
#define sext_i16_i32(x) ((int32_t) (int16_t) x)
#define sext_i16_i64(x) ((int64_t) (int16_t) x)
#define sext_i32_i8(x) ((int8_t) (int32_t) x)
#define sext_i32_i16(x) ((int16_t) (int32_t) x)
#define sext_i32_i32(x) ((int32_t) (int32_t) x)
#define sext_i32_i64(x) ((int64_t) (int32_t) x)
#define sext_i64_i8(x) ((int8_t) (int64_t) x)
#define sext_i64_i16(x) ((int16_t) (int64_t) x)
#define sext_i64_i32(x) ((int32_t) (int64_t) x)
#define sext_i64_i64(x) ((int64_t) (int64_t) x)
#define zext_i8_i8(x) ((int8_t) (uint8_t) x)
#define zext_i8_i16(x) ((int16_t) (uint8_t) x)
#define zext_i8_i32(x) ((int32_t) (uint8_t) x)
#define zext_i8_i64(x) ((int64_t) (uint8_t) x)
#define zext_i16_i8(x) ((int8_t) (uint16_t) x)
#define zext_i16_i16(x) ((int16_t) (uint16_t) x)
#define zext_i16_i32(x) ((int32_t) (uint16_t) x)
#define zext_i16_i64(x) ((int64_t) (uint16_t) x)
#define zext_i32_i8(x) ((int8_t) (uint32_t) x)
#define zext_i32_i16(x) ((int16_t) (uint32_t) x)
#define zext_i32_i32(x) ((int32_t) (uint32_t) x)
#define zext_i32_i64(x) ((int64_t) (uint32_t) x)
#define zext_i64_i8(x) ((int8_t) (uint64_t) x)
#define zext_i64_i16(x) ((int16_t) (uint64_t) x)
#define zext_i64_i32(x) ((int32_t) (uint64_t) x)
#define zext_i64_i64(x) ((int64_t) (uint64_t) x)
#if defined(__OPENCL_VERSION__)
static int32_t futrts_popc8(int8_t x)
{
    return popcount(x);
}
static int32_t futrts_popc16(int16_t x)
{
    return popcount(x);
}
static int32_t futrts_popc32(int32_t x)
{
    return popcount(x);
}
static int32_t futrts_popc64(int64_t x)
{
    return popcount(x);
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_popc8(int8_t x)
{
    return __popc(zext_i8_i32(x));
}
static int32_t futrts_popc16(int16_t x)
{
    return __popc(zext_i16_i32(x));
}
static int32_t futrts_popc32(int32_t x)
{
    return __popc(x);
}
static int32_t futrts_popc64(int64_t x)
{
    return __popcll(x);
}
#else
static int32_t futrts_popc8(int8_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc16(int16_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc32(int32_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc64(int64_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
#endif
#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    return mul_hi(a, b);
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    return mul_hi(a, b);
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    return mul_hi(a, b);
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    return mul_hi(a, b);
}
#elif defined(__CUDA_ARCH__)
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    uint16_t aa = a;
    uint16_t bb = b;
    
    return aa * bb >> 8;
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    uint32_t aa = a;
    uint32_t bb = b;
    
    return aa * bb >> 16;
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    return mulhi(a, b);
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    return mul64hi(a, b);
}
#else
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    uint16_t aa = a;
    uint16_t bb = b;
    
    return aa * bb >> 8;
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    uint32_t aa = a;
    uint32_t bb = b;
    
    return aa * bb >> 16;
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    uint64_t aa = a;
    uint64_t bb = b;
    
    return aa * bb >> 32;
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    __uint128_t aa = a;
    __uint128_t bb = b;
    
    return aa * bb >> 64;
}
#endif
#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)
{
    return mad_hi(a, b, c);
}
static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)
{
    return mad_hi(a, b, c);
}
static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)
{
    return mad_hi(a, b, c);
}
static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)
{
    return mad_hi(a, b, c);
}
#else
static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)
{
    return futrts_mul_hi8(a, b) + c;
}
static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)
{
    return futrts_mul_hi16(a, b) + c;
}
static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)
{
    return futrts_mul_hi32(a, b) + c;
}
static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)
{
    return futrts_mul_hi64(a, b) + c;
}
#endif
#if defined(__OPENCL_VERSION__)
static int32_t futrts_clzz8(int8_t x)
{
    return clz(x);
}
static int32_t futrts_clzz16(int16_t x)
{
    return clz(x);
}
static int32_t futrts_clzz32(int32_t x)
{
    return clz(x);
}
static int32_t futrts_clzz64(int64_t x)
{
    return clz(x);
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_clzz8(int8_t x)
{
    return __clz(zext_i8_i32(x)) - 24;
}
static int32_t futrts_clzz16(int16_t x)
{
    return __clz(zext_i16_i32(x)) - 16;
}
static int32_t futrts_clzz32(int32_t x)
{
    return __clz(x);
}
static int32_t futrts_clzz64(int64_t x)
{
    return __clzll(x);
}
#else
static int32_t futrts_clzz8(int8_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz16(int16_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz32(int32_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz64(int64_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
#endif
#if defined(__OPENCL_VERSION__)
static int32_t futrts_ctzz8(int8_t x)
{
    int i = 0;
    
    for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz16(int16_t x)
{
    int i = 0;
    
    for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz32(int32_t x)
{
    int i = 0;
    
    for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz64(int64_t x)
{
    int i = 0;
    
    for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_ctzz8(int8_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 8 : y - 1;
}
static int32_t futrts_ctzz16(int16_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 16 : y - 1;
}
static int32_t futrts_ctzz32(int32_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 32 : y - 1;
}
static int32_t futrts_ctzz64(int64_t x)
{
    int y = __ffsll(x);
    
    return y == 0 ? 64 : y - 1;
}
#else
static int32_t futrts_ctzz8(int8_t x)
{
    return x == 0 ? 8 : __builtin_ctz((uint32_t) x);
}
static int32_t futrts_ctzz16(int16_t x)
{
    return x == 0 ? 16 : __builtin_ctz((uint32_t) x);
}
static int32_t futrts_ctzz32(int32_t x)
{
    return x == 0 ? 32 : __builtin_ctz(x);
}
static int32_t futrts_ctzz64(int64_t x)
{
    return x == 0 ? 64 : __builtin_ctzl(x);
}
#endif
static inline float fdiv32(float x, float y)
{
    return x / y;
}
static inline float fadd32(float x, float y)
{
    return x + y;
}
static inline float fsub32(float x, float y)
{
    return x - y;
}
static inline float fmul32(float x, float y)
{
    return x * y;
}
static inline float fmin32(float x, float y)
{
    return fmin(x, y);
}
static inline float fmax32(float x, float y)
{
    return fmax(x, y);
}
static inline float fpow32(float x, float y)
{
    return pow(x, y);
}
static inline bool cmplt32(float x, float y)
{
    return x < y;
}
static inline bool cmple32(float x, float y)
{
    return x <= y;
}
static inline float sitofp_i8_f32(int8_t x)
{
    return (float) x;
}
static inline float sitofp_i16_f32(int16_t x)
{
    return (float) x;
}
static inline float sitofp_i32_f32(int32_t x)
{
    return (float) x;
}
static inline float sitofp_i64_f32(int64_t x)
{
    return (float) x;
}
static inline float uitofp_i8_f32(uint8_t x)
{
    return (float) x;
}
static inline float uitofp_i16_f32(uint16_t x)
{
    return (float) x;
}
static inline float uitofp_i32_f32(uint32_t x)
{
    return (float) x;
}
static inline float uitofp_i64_f32(uint64_t x)
{
    return (float) x;
}
static inline int8_t fptosi_f32_i8(float x)
{
    return (int8_t) x;
}
static inline int16_t fptosi_f32_i16(float x)
{
    return (int16_t) x;
}
static inline int32_t fptosi_f32_i32(float x)
{
    return (int32_t) x;
}
static inline int64_t fptosi_f32_i64(float x)
{
    return (int64_t) x;
}
static inline uint8_t fptoui_f32_i8(float x)
{
    return (uint8_t) x;
}
static inline uint16_t fptoui_f32_i16(float x)
{
    return (uint16_t) x;
}
static inline uint32_t fptoui_f32_i32(float x)
{
    return (uint32_t) x;
}
static inline uint64_t fptoui_f32_i64(float x)
{
    return (uint64_t) x;
}
static inline double fdiv64(double x, double y)
{
    return x / y;
}
static inline double fadd64(double x, double y)
{
    return x + y;
}
static inline double fsub64(double x, double y)
{
    return x - y;
}
static inline double fmul64(double x, double y)
{
    return x * y;
}
static inline double fmin64(double x, double y)
{
    return fmin(x, y);
}
static inline double fmax64(double x, double y)
{
    return fmax(x, y);
}
static inline double fpow64(double x, double y)
{
    return pow(x, y);
}
static inline bool cmplt64(double x, double y)
{
    return x < y;
}
static inline bool cmple64(double x, double y)
{
    return x <= y;
}
static inline double sitofp_i8_f64(int8_t x)
{
    return (double) x;
}
static inline double sitofp_i16_f64(int16_t x)
{
    return (double) x;
}
static inline double sitofp_i32_f64(int32_t x)
{
    return (double) x;
}
static inline double sitofp_i64_f64(int64_t x)
{
    return (double) x;
}
static inline double uitofp_i8_f64(uint8_t x)
{
    return (double) x;
}
static inline double uitofp_i16_f64(uint16_t x)
{
    return (double) x;
}
static inline double uitofp_i32_f64(uint32_t x)
{
    return (double) x;
}
static inline double uitofp_i64_f64(uint64_t x)
{
    return (double) x;
}
static inline int8_t fptosi_f64_i8(double x)
{
    return (int8_t) x;
}
static inline int16_t fptosi_f64_i16(double x)
{
    return (int16_t) x;
}
static inline int32_t fptosi_f64_i32(double x)
{
    return (int32_t) x;
}
static inline int64_t fptosi_f64_i64(double x)
{
    return (int64_t) x;
}
static inline uint8_t fptoui_f64_i8(double x)
{
    return (uint8_t) x;
}
static inline uint16_t fptoui_f64_i16(double x)
{
    return (uint16_t) x;
}
static inline uint32_t fptoui_f64_i32(double x)
{
    return (uint32_t) x;
}
static inline uint64_t fptoui_f64_i64(double x)
{
    return (uint64_t) x;
}
static inline float fpconv_f32_f32(float x)
{
    return (float) x;
}
static inline double fpconv_f32_f64(float x)
{
    return (double) x;
}
static inline float fpconv_f64_f32(double x)
{
    return (float) x;
}
static inline double fpconv_f64_f64(double x)
{
    return (double) x;
}
static inline float futrts_log32(float x)
{
    return log(x);
}
static inline float futrts_log2_32(float x)
{
    return log2(x);
}
static inline float futrts_log10_32(float x)
{
    return log10(x);
}
static inline float futrts_sqrt32(float x)
{
    return sqrt(x);
}
static inline float futrts_exp32(float x)
{
    return exp(x);
}
static inline float futrts_cos32(float x)
{
    return cos(x);
}
static inline float futrts_sin32(float x)
{
    return sin(x);
}
static inline float futrts_tan32(float x)
{
    return tan(x);
}
static inline float futrts_acos32(float x)
{
    return acos(x);
}
static inline float futrts_asin32(float x)
{
    return asin(x);
}
static inline float futrts_atan32(float x)
{
    return atan(x);
}
static inline float futrts_cosh32(float x)
{
    return cosh(x);
}
static inline float futrts_sinh32(float x)
{
    return sinh(x);
}
static inline float futrts_tanh32(float x)
{
    return tanh(x);
}
static inline float futrts_acosh32(float x)
{
    return acosh(x);
}
static inline float futrts_asinh32(float x)
{
    return asinh(x);
}
static inline float futrts_atanh32(float x)
{
    return atanh(x);
}
static inline float futrts_atan2_32(float x, float y)
{
    return atan2(x, y);
}
static inline float futrts_gamma32(float x)
{
    return tgamma(x);
}
static inline float futrts_lgamma32(float x)
{
    return lgamma(x);
}
static inline bool futrts_isnan32(float x)
{
    return isnan(x);
}
static inline bool futrts_isinf32(float x)
{
    return isinf(x);
}
static inline int32_t futrts_to_bits32(float x)
{
    union {
        float f;
        int32_t t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline float futrts_from_bits32(int32_t x)
{
    union {
        int32_t f;
        float t;
    } p;
    
    p.f = x;
    return p.t;
}
#ifdef __OPENCL_VERSION__
static inline float fmod32(float x, float y)
{
    return fmod(x, y);
}
static inline float futrts_round32(float x)
{
    return rint(x);
}
static inline float futrts_floor32(float x)
{
    return floor(x);
}
static inline float futrts_ceil32(float x)
{
    return ceil(x);
}
static inline float futrts_lerp32(float v0, float v1, float t)
{
    return mix(v0, v1, t);
}
static inline float futrts_mad32(float a, float b, float c)
{
    return mad(a, b, c);
}
static inline float futrts_fma32(float a, float b, float c)
{
    return fma(a, b, c);
}
#else
static inline float fmod32(float x, float y)
{
    return fmodf(x, y);
}
static inline float futrts_round32(float x)
{
    return rintf(x);
}
static inline float futrts_floor32(float x)
{
    return floorf(x);
}
static inline float futrts_ceil32(float x)
{
    return ceilf(x);
}
static inline float futrts_lerp32(float v0, float v1, float t)
{
    return v0 + (v1 - v0) * t;
}
static inline float futrts_mad32(float a, float b, float c)
{
    return a * b + c;
}
static inline float futrts_fma32(float a, float b, float c)
{
    return fmaf(a, b, c);
}
#endif
static inline double futrts_log64(double x)
{
    return log(x);
}
static inline double futrts_log2_64(double x)
{
    return log2(x);
}
static inline double futrts_log10_64(double x)
{
    return log10(x);
}
static inline double futrts_sqrt64(double x)
{
    return sqrt(x);
}
static inline double futrts_exp64(double x)
{
    return exp(x);
}
static inline double futrts_cos64(double x)
{
    return cos(x);
}
static inline double futrts_sin64(double x)
{
    return sin(x);
}
static inline double futrts_tan64(double x)
{
    return tan(x);
}
static inline double futrts_acos64(double x)
{
    return acos(x);
}
static inline double futrts_asin64(double x)
{
    return asin(x);
}
static inline double futrts_atan64(double x)
{
    return atan(x);
}
static inline double futrts_cosh64(double x)
{
    return cosh(x);
}
static inline double futrts_sinh64(double x)
{
    return sinh(x);
}
static inline double futrts_tanh64(double x)
{
    return tanh(x);
}
static inline double futrts_acosh64(double x)
{
    return acosh(x);
}
static inline double futrts_asinh64(double x)
{
    return asinh(x);
}
static inline double futrts_atanh64(double x)
{
    return atanh(x);
}
static inline double futrts_atan2_64(double x, double y)
{
    return atan2(x, y);
}
static inline double futrts_gamma64(double x)
{
    return tgamma(x);
}
static inline double futrts_lgamma64(double x)
{
    return lgamma(x);
}
static inline double futrts_fma64(double a, double b, double c)
{
    return fma(a, b, c);
}
static inline double futrts_round64(double x)
{
    return rint(x);
}
static inline double futrts_ceil64(double x)
{
    return ceil(x);
}
static inline double futrts_floor64(double x)
{
    return floor(x);
}
static inline bool futrts_isnan64(double x)
{
    return isnan(x);
}
static inline bool futrts_isinf64(double x)
{
    return isinf(x);
}
static inline int64_t futrts_to_bits64(double x)
{
    union {
        double f;
        int64_t t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline double futrts_from_bits64(int64_t x)
{
    union {
        int64_t f;
        double t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline double fmod64(double x, double y)
{
    return fmod(x, y);
}
#ifdef __OPENCL_VERSION__
static inline double futrts_lerp64(double v0, double v1, double t)
{
    return mix(v0, v1, t);
}
static inline double futrts_mad64(double a, double b, double c)
{
    return mad(a, b, c);
}
#else
static inline double futrts_lerp64(double v0, double v1, double t)
{
    return v0 + (v1 - v0) * t;
}
static inline double futrts_mad64(double a, double b, double c)
{
    return a * b + c;
}
#endif
int init_constants(struct futhark_context *);
int free_constants(struct futhark_context *);
static int32_t mainzicounter_mem_realtype_28666[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_28728[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzihist_locks_mem_realtype_28740[100151];
static int32_t mainzicounter_mem_realtype_28751[10240];
static int32_t mainzicounter_mem_realtype_28828[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_28855[10240];
static int32_t mainzicounter_mem_realtype_28866[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static float testzistatic_array_realtype_28874[45] = {1.0F, -0.5F, 1.0F, 1.0F,
                                                      1.0F, 1.0F, 1.0F, 1.0F,
                                                      1.0F, 1.0F, -0.5F, 1.0F,
                                                      1.0F, 1.0F, 1.0F, 1.0F,
                                                      1.0F, 1.0F, 1.0F, -0.5F,
                                                      1.0F, 1.0F, 1.0F, 1.0F,
                                                      1.0F, 1.0F, 1.0F, 1.0F,
                                                      -0.5F, 1.0F, 1.0F, 1.0F,
                                                      1.0F, 1.0F, 1.0F, 1.0F,
                                                      1.0F, -0.5F, 1.0F, 1.0F,
                                                      1.0F, 1.0F, 1.0F, 1.0F,
                                                      1.0F};
static int64_t testzistatic_array_realtype_28875[45] = {10, 20, 5, 5, 50, 20,
                                                        30, 15, 18, 10, 200, 5,
                                                        5, 50, 20, 30, 15, 18,
                                                        10, 20, 5, 5, 100, 20,
                                                        30, 15, 18, 10, 20, 5,
                                                        5, 50, 20, 30, 15, 18,
                                                        10, 20, 5, 5, 50, 20,
                                                        30, 15, 18};
static float testzistatic_array_realtype_28876[45] = {1.0F, 0.5F, 0.25F, 0.1F,
                                                      0.3F, 0.1F, 2.0F, 3.0F,
                                                      1.0F, 1.0F, 0.5F, 0.25F,
                                                      0.1F, 0.3F, 0.1F, 2.0F,
                                                      3.0F, 1.0F, 1.0F, 0.5F,
                                                      0.25F, 0.1F, 0.3F, 0.1F,
                                                      2.0F, 3.0F, 1.0F, 1.0F,
                                                      0.5F, 0.25F, 0.1F, 0.3F,
                                                      0.1F, 2.0F, 3.0F, 1.0F,
                                                      1.0F, 0.5F, 0.25F, 0.1F,
                                                      0.3F, 0.1F, 2.0F, 3.0F,
                                                      1.0F};
static int32_t testzicounter_mem_realtype_28877[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_28939[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzihist_locks_mem_realtype_28951[100151];
static int32_t testzicounter_mem_realtype_28962[10240];
static int32_t testzicounter_mem_realtype_29039[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_29066[10240];
static int32_t testzicounter_mem_realtype_29077[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
struct memblock_device {
    int *references;
    cl_mem mem;
    int64_t size;
    const char *desc;
} ;
struct memblock {
    int *references;
    char *mem;
    int64_t size;
    const char *desc;
} ;
typedef cl_mem fl_mem_t;
// Start of free_list.h.

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem_t mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries;        // Pointer to entries.
  int capacity;                           // Number of entries.
  int used;                               // Number of valid entries.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
}

static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem_t mem, const char *tag) {
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size,
                          size_t *size_out, fl_mem_t *mem_out) {
  int size_match = -1;
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid &&
        size <= l->entries[i].size &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    return 0;
  } else {
    return 1;
  }
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem_t *mem_out) {
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      return 0;
    }
  }

  return 1;
}

// End of free_list.h.

// Start of opencl.h.

#define OPENCL_SUCCEED_FATAL(e) opencl_succeed_fatal(e, #e, __FILE__, __LINE__)
#define OPENCL_SUCCEED_NONFATAL(e) opencl_succeed_nonfatal(e, #e, __FILE__, __LINE__)
// Take care not to override an existing error.
#define OPENCL_SUCCEED_OR_RETURN(e) {             \
    char *serror = OPENCL_SUCCEED_NONFATAL(e);    \
    if (serror) {                                 \
      if (!ctx->error) {                          \
        ctx->error = serror;                      \
        return bad;                               \
      } else {                                    \
        free(serror);                             \
      }                                           \
    }                                             \
  }

// OPENCL_SUCCEED_OR_RETURN returns the value of the variable 'bad' in
// scope.  By default, it will be this one.  Create a local variable
// of some other type if needed.  This is a bit of a hack, but it
// saves effort in the code generator.
static const int bad = 1;

struct opencl_config {
  int debugging;
  int profiling;
  int logging;
  int preferred_device_num;
  const char *preferred_platform;
  const char *preferred_device;
  int ignore_blacklist;

  const char* dump_program_to;
  const char* load_program_from;
  const char* dump_binary_to;
  const char* load_binary_from;

  size_t default_group_size;
  size_t default_num_groups;
  size_t default_tile_size;
  size_t default_threshold;

  int default_group_size_changed;
  int default_tile_size_changed;

  int num_sizes;
  const char **size_names;
  const char **size_vars;
  size_t *size_values;
  const char **size_classes;
};

static void opencl_config_init(struct opencl_config *cfg,
                               int num_sizes,
                               const char *size_names[],
                               const char *size_vars[],
                               size_t *size_values,
                               const char *size_classes[]) {
  cfg->debugging = 0;
  cfg->logging = 0;
  cfg->profiling = 0;
  cfg->preferred_device_num = 0;
  cfg->preferred_platform = "";
  cfg->preferred_device = "";
  cfg->ignore_blacklist = 0;
  cfg->dump_program_to = NULL;
  cfg->load_program_from = NULL;
  cfg->dump_binary_to = NULL;
  cfg->load_binary_from = NULL;

  // The following are dummy sizes that mean the concrete defaults
  // will be set during initialisation via hardware-inspection-based
  // heuristics.
  cfg->default_group_size = 0;
  cfg->default_num_groups = 0;
  cfg->default_tile_size = 0;
  cfg->default_threshold = 0;

  cfg->default_group_size_changed = 0;
  cfg->default_tile_size_changed = 0;

  cfg->num_sizes = num_sizes;
  cfg->size_names = size_names;
  cfg->size_vars = size_vars;
  cfg->size_values = size_values;
  cfg->size_classes = size_classes;
}

// A record of something that happened.
struct profiling_record {
  cl_event *event;
  int *runs;
  int64_t *runtime;
};

struct opencl_context {
  cl_device_id device;
  cl_context ctx;
  cl_command_queue queue;

  struct opencl_config cfg;

  struct free_list free_list;

  size_t max_group_size;
  size_t max_num_groups;
  size_t max_tile_size;
  size_t max_threshold;
  size_t max_local_memory;

  size_t lockstep_width;

  struct profiling_record *profiling_records;
  int profiling_records_capacity;
  int profiling_records_used;
};

struct opencl_device_option {
  cl_platform_id platform;
  cl_device_id device;
  cl_device_type device_type;
  char *platform_name;
  char *device_name;
};

// This function must be defined by the user.  It is invoked by
// setup_opencl() after the platform and device has been found, but
// before the program is loaded.  Its intended use is to tune
// constants based on the selected platform and device.
static void post_opencl_setup(struct opencl_context*, struct opencl_device_option*);

static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

static const char* opencl_error_string(cl_int err)
{
    switch (err) {
        case CL_SUCCESS:                            return "Success!";
        case CL_DEVICE_NOT_FOUND:                   return "Device not found.";
        case CL_DEVICE_NOT_AVAILABLE:               return "Device not available";
        case CL_COMPILER_NOT_AVAILABLE:             return "Compiler not available";
        case CL_MEM_OBJECT_ALLOCATION_FAILURE:      return "Memory object allocation failure";
        case CL_OUT_OF_RESOURCES:                   return "Out of resources";
        case CL_OUT_OF_HOST_MEMORY:                 return "Out of host memory";
        case CL_PROFILING_INFO_NOT_AVAILABLE:       return "Profiling information not available";
        case CL_MEM_COPY_OVERLAP:                   return "Memory copy overlap";
        case CL_IMAGE_FORMAT_MISMATCH:              return "Image format mismatch";
        case CL_IMAGE_FORMAT_NOT_SUPPORTED:         return "Image format not supported";
        case CL_BUILD_PROGRAM_FAILURE:              return "Program build failure";
        case CL_MAP_FAILURE:                        return "Map failure";
        case CL_INVALID_VALUE:                      return "Invalid value";
        case CL_INVALID_DEVICE_TYPE:                return "Invalid device type";
        case CL_INVALID_PLATFORM:                   return "Invalid platform";
        case CL_INVALID_DEVICE:                     return "Invalid device";
        case CL_INVALID_CONTEXT:                    return "Invalid context";
        case CL_INVALID_QUEUE_PROPERTIES:           return "Invalid queue properties";
        case CL_INVALID_COMMAND_QUEUE:              return "Invalid command queue";
        case CL_INVALID_HOST_PTR:                   return "Invalid host pointer";
        case CL_INVALID_MEM_OBJECT:                 return "Invalid memory object";
        case CL_INVALID_IMAGE_FORMAT_DESCRIPTOR:    return "Invalid image format descriptor";
        case CL_INVALID_IMAGE_SIZE:                 return "Invalid image size";
        case CL_INVALID_SAMPLER:                    return "Invalid sampler";
        case CL_INVALID_BINARY:                     return "Invalid binary";
        case CL_INVALID_BUILD_OPTIONS:              return "Invalid build options";
        case CL_INVALID_PROGRAM:                    return "Invalid program";
        case CL_INVALID_PROGRAM_EXECUTABLE:         return "Invalid program executable";
        case CL_INVALID_KERNEL_NAME:                return "Invalid kernel name";
        case CL_INVALID_KERNEL_DEFINITION:          return "Invalid kernel definition";
        case CL_INVALID_KERNEL:                     return "Invalid kernel";
        case CL_INVALID_ARG_INDEX:                  return "Invalid argument index";
        case CL_INVALID_ARG_VALUE:                  return "Invalid argument value";
        case CL_INVALID_ARG_SIZE:                   return "Invalid argument size";
        case CL_INVALID_KERNEL_ARGS:                return "Invalid kernel arguments";
        case CL_INVALID_WORK_DIMENSION:             return "Invalid work dimension";
        case CL_INVALID_WORK_GROUP_SIZE:            return "Invalid work group size";
        case CL_INVALID_WORK_ITEM_SIZE:             return "Invalid work item size";
        case CL_INVALID_GLOBAL_OFFSET:              return "Invalid global offset";
        case CL_INVALID_EVENT_WAIT_LIST:            return "Invalid event wait list";
        case CL_INVALID_EVENT:                      return "Invalid event";
        case CL_INVALID_OPERATION:                  return "Invalid operation";
        case CL_INVALID_GL_OBJECT:                  return "Invalid OpenGL object";
        case CL_INVALID_BUFFER_SIZE:                return "Invalid buffer size";
        case CL_INVALID_MIP_LEVEL:                  return "Invalid mip-map level";
        default:                                    return "Unknown";
    }
}

static void opencl_succeed_fatal(unsigned int ret,
                                 const char *call,
                                 const char *file,
                                 int line) {
  if (ret != CL_SUCCESS) {
    futhark_panic(-1, "%s:%d: OpenCL call\n  %s\nfailed with error code %d (%s)\n",
          file, line, call, ret, opencl_error_string(ret));
  }
}

static char* opencl_succeed_nonfatal(unsigned int ret,
                                     const char *call,
                                     const char *file,
                                     int line) {
  if (ret != CL_SUCCESS) {
    return msgprintf("%s:%d: OpenCL call\n  %s\nfailed with error code %d (%s)\n",
                     file, line, call, ret, opencl_error_string(ret));
  } else {
    return NULL;
  }
}

static void set_preferred_platform(struct opencl_config *cfg, const char *s) {
  cfg->preferred_platform = s;
  cfg->ignore_blacklist = 1;
}

static void set_preferred_device(struct opencl_config *cfg, const char *s) {
  int x = 0;
  if (*s == '#') {
    s++;
    while (isdigit(*s)) {
      x = x * 10 + (*s++)-'0';
    }
    // Skip trailing spaces.
    while (isspace(*s)) {
      s++;
    }
  }
  cfg->preferred_device = s;
  cfg->preferred_device_num = x;
  cfg->ignore_blacklist = 1;
}

static char* opencl_platform_info(cl_platform_id platform,
                                  cl_platform_info param) {
  size_t req_bytes;
  char *info;

  OPENCL_SUCCEED_FATAL(clGetPlatformInfo(platform, param, 0, NULL, &req_bytes));

  info = (char*) malloc(req_bytes);

  OPENCL_SUCCEED_FATAL(clGetPlatformInfo(platform, param, req_bytes, info, NULL));

  return info;
}

static char* opencl_device_info(cl_device_id device,
                                cl_device_info param) {
  size_t req_bytes;
  char *info;

  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device, param, 0, NULL, &req_bytes));

  info = (char*) malloc(req_bytes);

  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device, param, req_bytes, info, NULL));

  return info;
}

static void opencl_all_device_options(struct opencl_device_option **devices_out,
                                      size_t *num_devices_out) {
  size_t num_devices = 0, num_devices_added = 0;

  cl_platform_id *all_platforms;
  cl_uint *platform_num_devices;

  cl_uint num_platforms;

  // Find the number of platforms.
  OPENCL_SUCCEED_FATAL(clGetPlatformIDs(0, NULL, &num_platforms));

  // Make room for them.
  all_platforms = calloc(num_platforms, sizeof(cl_platform_id));
  platform_num_devices = calloc(num_platforms, sizeof(cl_uint));

  // Fetch all the platforms.
  OPENCL_SUCCEED_FATAL(clGetPlatformIDs(num_platforms, all_platforms, NULL));

  // Count the number of devices for each platform, as well as the
  // total number of devices.
  for (cl_uint i = 0; i < num_platforms; i++) {
    if (clGetDeviceIDs(all_platforms[i], CL_DEVICE_TYPE_ALL,
                       0, NULL, &platform_num_devices[i]) == CL_SUCCESS) {
      num_devices += platform_num_devices[i];
    } else {
      platform_num_devices[i] = 0;
    }
  }

  // Make room for all the device options.
  struct opencl_device_option *devices =
    calloc(num_devices, sizeof(struct opencl_device_option));

  // Loop through the platforms, getting information about their devices.
  for (cl_uint i = 0; i < num_platforms; i++) {
    cl_platform_id platform = all_platforms[i];
    cl_uint num_platform_devices = platform_num_devices[i];

    if (num_platform_devices == 0) {
      continue;
    }

    char *platform_name = opencl_platform_info(platform, CL_PLATFORM_NAME);
    cl_device_id *platform_devices =
      calloc(num_platform_devices, sizeof(cl_device_id));

    // Fetch all the devices.
    OPENCL_SUCCEED_FATAL(clGetDeviceIDs(platform, CL_DEVICE_TYPE_ALL,
                                  num_platform_devices, platform_devices, NULL));

    // Loop through the devices, adding them to the devices array.
    for (cl_uint i = 0; i < num_platform_devices; i++) {
      char *device_name = opencl_device_info(platform_devices[i], CL_DEVICE_NAME);
      devices[num_devices_added].platform = platform;
      devices[num_devices_added].device = platform_devices[i];
      OPENCL_SUCCEED_FATAL(clGetDeviceInfo(platform_devices[i], CL_DEVICE_TYPE,
                                     sizeof(cl_device_type),
                                     &devices[num_devices_added].device_type,
                                     NULL));
      // We don't want the structs to share memory, so copy the platform name.
      // Each device name is already unique.
      devices[num_devices_added].platform_name = strclone(platform_name);
      devices[num_devices_added].device_name = device_name;
      num_devices_added++;
    }
    free(platform_devices);
    free(platform_name);
  }
  free(all_platforms);
  free(platform_num_devices);

  *devices_out = devices;
  *num_devices_out = num_devices;
}

// Returns 0 on success.
static int list_devices(struct opencl_config *cfg) {
  struct opencl_device_option *devices;
  size_t num_devices;

  opencl_all_device_options(&devices, &num_devices);

  const char *cur_platform = "";
  for (size_t i = 0; i < num_devices; i++) {
    struct opencl_device_option device = devices[i];
    if (strcmp(cur_platform, device.platform_name) != 0) {
      printf("Platform: %s\n", device.platform_name);
      cur_platform = device.platform_name;
    }
    printf("[%d]: %s\n", (int)i, device.device_name);
  }

  // Free all the platform and device names.
  for (size_t j = 0; j < num_devices; j++) {
    free(devices[j].platform_name);
    free(devices[j].device_name);
  }
  free(devices);

  return 0;
}

// Returns 0 on success.
static int select_device_interactively(struct opencl_config *cfg) {
  struct opencl_device_option *devices;
  size_t num_devices;
  int ret = 1;

  opencl_all_device_options(&devices, &num_devices);

  printf("Choose OpenCL device:\n");
  const char *cur_platform = "";
  for (size_t i = 0; i < num_devices; i++) {
    struct opencl_device_option device = devices[i];
    if (strcmp(cur_platform, device.platform_name) != 0) {
      printf("Platform: %s\n", device.platform_name);
      cur_platform = device.platform_name;
    }
    printf("[%d] %s\n", (int)i, device.device_name);
  }

  int selection;
  printf("Choice: ");
  if (scanf("%d", &selection) == 1) {
    ret = 0;
    cfg->preferred_platform = "";
    cfg->preferred_device = "";
    cfg->preferred_device_num = selection;
    cfg->ignore_blacklist = 1;
  }

  // Free all the platform and device names.
  for (size_t j = 0; j < num_devices; j++) {
    free(devices[j].platform_name);
    free(devices[j].device_name);
  }
  free(devices);

  return ret;
}

static int is_blacklisted(const char *platform_name, const char *device_name,
                          const struct opencl_config *cfg) {
  if (strcmp(cfg->preferred_platform, "") != 0 ||
      strcmp(cfg->preferred_device, "") != 0) {
    return 0;
  } else if (strstr(platform_name, "Apple") != NULL &&
             strstr(device_name, "Intel(R) Core(TM)") != NULL) {
    return 1;
  } else {
    return 0;
  }
}

static struct opencl_device_option get_preferred_device(const struct opencl_config *cfg) {
  struct opencl_device_option *devices;
  size_t num_devices;

  opencl_all_device_options(&devices, &num_devices);

  int num_device_matches = 0;

  for (size_t i = 0; i < num_devices; i++) {
    struct opencl_device_option device = devices[i];
    if (strstr(device.platform_name, cfg->preferred_platform) != NULL &&
        strstr(device.device_name, cfg->preferred_device) != NULL &&
        (cfg->ignore_blacklist ||
         !is_blacklisted(device.platform_name, device.device_name, cfg)) &&
        num_device_matches++ == cfg->preferred_device_num) {
      // Free all the platform and device names, except the ones we have chosen.
      for (size_t j = 0; j < num_devices; j++) {
        if (j != i) {
          free(devices[j].platform_name);
          free(devices[j].device_name);
        }
      }
      free(devices);
      return device;
    }
  }

  futhark_panic(1, "Could not find acceptable OpenCL device.\n");
  exit(1); // Never reached
}

static void describe_device_option(struct opencl_device_option device) {
  fprintf(stderr, "Using platform: %s\n", device.platform_name);
  fprintf(stderr, "Using device: %s\n", device.device_name);
}

static cl_build_status build_opencl_program(cl_program program, cl_device_id device, const char* options) {
  cl_int clBuildProgram_error = clBuildProgram(program, 1, &device, options, NULL, NULL);

  // Avoid termination due to CL_BUILD_PROGRAM_FAILURE
  if (clBuildProgram_error != CL_SUCCESS &&
      clBuildProgram_error != CL_BUILD_PROGRAM_FAILURE) {
    OPENCL_SUCCEED_FATAL(clBuildProgram_error);
  }

  cl_build_status build_status;
  OPENCL_SUCCEED_FATAL(clGetProgramBuildInfo(program,
                                             device,
                                             CL_PROGRAM_BUILD_STATUS,
                                             sizeof(cl_build_status),
                                             &build_status,
                                             NULL));

  if (build_status != CL_SUCCESS) {
    char *build_log;
    size_t ret_val_size;
    OPENCL_SUCCEED_FATAL(clGetProgramBuildInfo(program, device, CL_PROGRAM_BUILD_LOG, 0, NULL, &ret_val_size));

    build_log = (char*) malloc(ret_val_size+1);
    OPENCL_SUCCEED_FATAL(clGetProgramBuildInfo(program, device, CL_PROGRAM_BUILD_LOG, ret_val_size, build_log, NULL));

    // The spec technically does not say whether the build log is zero-terminated, so let's be careful.
    build_log[ret_val_size] = '\0';

    fprintf(stderr, "Build log:\n%s\n", build_log);

    free(build_log);
  }

  return build_status;
}

// Fields in a bitmask indicating which types we must be sure are
// available.
enum opencl_required_type { OPENCL_F64 = 1 };

// We take as input several strings representing the program, because
// C does not guarantee that the compiler supports particularly large
// literals.  Notably, Visual C has a limit of 2048 characters.  The
// array must be NULL-terminated.
static cl_program setup_opencl_with_command_queue(struct opencl_context *ctx,
                                                  cl_command_queue queue,
                                                  const char *srcs[],
                                                  int required_types,
                                                  const char *extra_build_opts[]) {
  int error;

  free_list_init(&ctx->free_list);
  ctx->queue = queue;

  OPENCL_SUCCEED_FATAL(clGetCommandQueueInfo(ctx->queue, CL_QUEUE_CONTEXT, sizeof(cl_context), &ctx->ctx, NULL));

  // Fill out the device info.  This is redundant work if we are
  // called from setup_opencl() (which is the common case), but I
  // doubt it matters much.
  struct opencl_device_option device_option;
  OPENCL_SUCCEED_FATAL(clGetCommandQueueInfo(ctx->queue, CL_QUEUE_DEVICE,
                                       sizeof(cl_device_id),
                                       &device_option.device,
                                       NULL));
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_PLATFORM,
                                 sizeof(cl_platform_id),
                                 &device_option.platform,
                                 NULL));
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_TYPE,
                                 sizeof(cl_device_type),
                                 &device_option.device_type,
                                 NULL));
  device_option.platform_name = opencl_platform_info(device_option.platform, CL_PLATFORM_NAME);
  device_option.device_name = opencl_device_info(device_option.device, CL_DEVICE_NAME);

  ctx->device = device_option.device;

  if (required_types & OPENCL_F64) {
    cl_uint supported;
    OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_PREFERRED_VECTOR_WIDTH_DOUBLE,
                                   sizeof(cl_uint), &supported, NULL));
    if (!supported) {
      futhark_panic(1, "Program uses double-precision floats, but this is not supported on the chosen device: %s\n",
            device_option.device_name);
    }
  }

  size_t max_group_size;
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_MAX_WORK_GROUP_SIZE,
                                 sizeof(size_t), &max_group_size, NULL));

  size_t max_tile_size = sqrt(max_group_size);

  cl_ulong max_local_memory;
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_LOCAL_MEM_SIZE,
                                       sizeof(size_t), &max_local_memory, NULL));

  // Futhark reserves 4 bytes for bookkeeping information.
  max_local_memory -= 4;

  // The OpenCL implementation may reserve some local memory bytes for
  // various purposes.  In principle, we should use
  // clGetKernelWorkGroupInfo() to figure out for each kernel how much
  // is actually available, but our current code generator design
  // makes this infeasible.  Instead, we have this nasty hack where we
  // arbitrarily subtract some bytes, based on empirical measurements
  // (but which might be arbitrarily wrong).  Fortunately, we rarely
  // try to really push the local memory usage.
  if (strstr(device_option.platform_name, "NVIDIA CUDA") != NULL) {
    max_local_memory -= 12;
  } else if (strstr(device_option.platform_name, "AMD") != NULL) {
    max_local_memory -= 16;
  }

  // Make sure this function is defined.
  post_opencl_setup(ctx, &device_option);

  if (max_group_size < ctx->cfg.default_group_size) {
    if (ctx->cfg.default_group_size_changed) {
      fprintf(stderr, "Note: Device limits default group size to %zu (down from %zu).\n",
              max_group_size, ctx->cfg.default_group_size);
    }
    ctx->cfg.default_group_size = max_group_size;
  }

  if (max_tile_size < ctx->cfg.default_tile_size) {
    if (ctx->cfg.default_tile_size_changed) {
      fprintf(stderr, "Note: Device limits default tile size to %zu (down from %zu).\n",
              max_tile_size, ctx->cfg.default_tile_size);
    }
    ctx->cfg.default_tile_size = max_tile_size;
  }

  ctx->max_group_size = max_group_size;
  ctx->max_tile_size = max_tile_size; // No limit.
  ctx->max_threshold = ctx->max_num_groups = 0; // No limit.
  ctx->max_local_memory = max_local_memory;

  // Now we go through all the sizes, clamp them to the valid range,
  // or set them to the default.
  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    const char *size_class = ctx->cfg.size_classes[i];
    size_t *size_value = &ctx->cfg.size_values[i];
    const char* size_name = ctx->cfg.size_names[i];
    size_t max_value = 0, default_value = 0;
    if (strstr(size_class, "group_size") == size_class) {
      max_value = max_group_size;
      default_value = ctx->cfg.default_group_size;
    } else if (strstr(size_class, "num_groups") == size_class) {
      max_value = max_group_size; // Futhark assumes this constraint.
      default_value = ctx->cfg.default_num_groups;
      // XXX: as a quick and dirty hack, use twice as many threads for
      // histograms by default.  We really should just be smarter
      // about sizes somehow.
      if (strstr(size_name, ".seghist_") != NULL) {
        default_value *= 2;
      }
    } else if (strstr(size_class, "tile_size") == size_class) {
      max_value = sqrt(max_group_size);
      default_value = ctx->cfg.default_tile_size;
    } else if (strstr(size_class, "threshold") == size_class) {
      // Threshold can be as large as it takes.
      default_value = ctx->cfg.default_threshold;
    } else {
      // Bespoke sizes have no limit or default.
    }
    if (*size_value == 0) {
      *size_value = default_value;
    } else if (max_value > 0 && *size_value > max_value) {
      fprintf(stderr, "Note: Device limits %s to %d (down from %d)\n",
              size_name, (int)max_value, (int)*size_value);
      *size_value = max_value;
    }
  }

  if (ctx->lockstep_width == 0) {
    ctx->lockstep_width = 1;
  }

  if (ctx->cfg.logging) {
    fprintf(stderr, "Lockstep width: %d\n", (int)ctx->lockstep_width);
    fprintf(stderr, "Default group size: %d\n", (int)ctx->cfg.default_group_size);
    fprintf(stderr, "Default number of groups: %d\n", (int)ctx->cfg.default_num_groups);
  }

  char *fut_opencl_src = NULL;
  cl_program prog;
  error = CL_SUCCESS;

  if (ctx->cfg.load_binary_from == NULL) {
    size_t src_size = 0;

    // Maybe we have to read OpenCL source from somewhere else (used for debugging).
    if (ctx->cfg.load_program_from != NULL) {
      fut_opencl_src = slurp_file(ctx->cfg.load_program_from, NULL);
      assert(fut_opencl_src != NULL);
    } else {
      // Construct the OpenCL source concatenating all the fragments.
      for (const char **src = srcs; src && *src; src++) {
        src_size += strlen(*src);
      }

      fut_opencl_src = (char*) malloc(src_size + 1);

      size_t n, i;
      for (i = 0, n = 0; srcs && srcs[i]; i++) {
        strncpy(fut_opencl_src+n, srcs[i], src_size-n);
        n += strlen(srcs[i]);
      }
      fut_opencl_src[src_size] = 0;
    }

    if (ctx->cfg.dump_program_to != NULL) {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "Dumping OpenCL source to %s...\n", ctx->cfg.dump_program_to);
      }

      dump_file(ctx->cfg.dump_program_to, fut_opencl_src, strlen(fut_opencl_src));
    }

    if (ctx->cfg.debugging) {
      fprintf(stderr, "Creating OpenCL program...\n");
    }

    const char* src_ptr[] = {fut_opencl_src};
    prog = clCreateProgramWithSource(ctx->ctx, 1, src_ptr, &src_size, &error);
    OPENCL_SUCCEED_FATAL(error);
  } else {
    if (ctx->cfg.debugging) {
      fprintf(stderr, "Loading OpenCL binary from %s...\n", ctx->cfg.load_binary_from);
    }
    size_t binary_size;
    unsigned char *fut_opencl_bin =
      (unsigned char*) slurp_file(ctx->cfg.load_binary_from, &binary_size);
    assert(fut_opencl_bin != NULL);
    const unsigned char *binaries[1] = { fut_opencl_bin };
    cl_int status = 0;

    prog = clCreateProgramWithBinary(ctx->ctx, 1, &device_option.device,
                                     &binary_size, binaries,
                                     &status, &error);

    OPENCL_SUCCEED_FATAL(status);
    OPENCL_SUCCEED_FATAL(error);
  }

  int compile_opts_size = 1024;

  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    compile_opts_size += strlen(ctx->cfg.size_names[i]) + 20;
  }

  for (int i = 0; extra_build_opts[i] != NULL; i++) {
    compile_opts_size += strlen(extra_build_opts[i] + 1);
  }

  char *compile_opts = (char*) malloc(compile_opts_size);

  int w = snprintf(compile_opts, compile_opts_size,
                   "-DLOCKSTEP_WIDTH=%d ",
                   (int)ctx->lockstep_width);

  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    w += snprintf(compile_opts+w, compile_opts_size-w,
                  "-D%s=%d ",
                  ctx->cfg.size_vars[i],
                  (int)ctx->cfg.size_values[i]);
  }

  for (int i = 0; extra_build_opts[i] != NULL; i++) {
    w += snprintf(compile_opts+w, compile_opts_size-w,
                  "%s ", extra_build_opts[i]);
  }

  if (ctx->cfg.debugging) {
    fprintf(stderr, "OpenCL compiler options: %s\n", compile_opts);
    fprintf(stderr, "Building OpenCL program...\n");
  }
  OPENCL_SUCCEED_FATAL(build_opencl_program(prog, device_option.device, compile_opts));

  free(compile_opts);
  free(fut_opencl_src);

  if (ctx->cfg.dump_binary_to != NULL) {
    if (ctx->cfg.debugging) {
      fprintf(stderr, "Dumping OpenCL binary to %s...\n", ctx->cfg.dump_binary_to);
    }

    size_t binary_size;
    OPENCL_SUCCEED_FATAL(clGetProgramInfo(prog, CL_PROGRAM_BINARY_SIZES,
                                          sizeof(size_t), &binary_size, NULL));
    unsigned char *binary = (unsigned char*) malloc(binary_size);
    unsigned char *binaries[1] = { binary };
    OPENCL_SUCCEED_FATAL(clGetProgramInfo(prog, CL_PROGRAM_BINARIES,
                                          sizeof(unsigned char*), binaries, NULL));

    dump_file(ctx->cfg.dump_binary_to, binary, binary_size);
  }

  return prog;
}

static cl_program setup_opencl(struct opencl_context *ctx,
                               const char *srcs[],
                               int required_types,
                               const char *extra_build_opts[]) {

  ctx->lockstep_width = 0; // Real value set later.

  struct opencl_device_option device_option = get_preferred_device(&ctx->cfg);

  if (ctx->cfg.logging) {
    describe_device_option(device_option);
  }

  // Note that NVIDIA's OpenCL requires the platform property
  cl_context_properties properties[] = {
    CL_CONTEXT_PLATFORM,
    (cl_context_properties)device_option.platform,
    0
  };

  cl_int clCreateContext_error;
  ctx->ctx = clCreateContext(properties, 1, &device_option.device, NULL, NULL, &clCreateContext_error);
  OPENCL_SUCCEED_FATAL(clCreateContext_error);

  cl_int clCreateCommandQueue_error;
  cl_command_queue queue =
    clCreateCommandQueue(ctx->ctx,
                         device_option.device,
                         ctx->cfg.profiling ? CL_QUEUE_PROFILING_ENABLE : 0,
                         &clCreateCommandQueue_error);
  OPENCL_SUCCEED_FATAL(clCreateCommandQueue_error);

  return setup_opencl_with_command_queue(ctx, queue, srcs, required_types, extra_build_opts);
}

// Count up the runtime all the profiling_records that occured during execution.
// Also clears the buffer of profiling_records.
static cl_int opencl_tally_profiling_records(struct opencl_context *ctx) {
  cl_int err;
  for (int i = 0; i < ctx->profiling_records_used; i++) {
    struct profiling_record record = ctx->profiling_records[i];

    cl_ulong start_t, end_t;

    if ((err = clGetEventProfilingInfo(*record.event,
                                       CL_PROFILING_COMMAND_START,
                                       sizeof(start_t),
                                       &start_t,
                                       NULL)) != CL_SUCCESS) {
      return err;
    }

    if ((err = clGetEventProfilingInfo(*record.event,
                                       CL_PROFILING_COMMAND_END,
                                       sizeof(end_t),
                                       &end_t,
                                       NULL)) != CL_SUCCESS) {
      return err;
    }

    // OpenCL provides nanosecond resolution, but we want
    // microseconds.
    *record.runs += 1;
    *record.runtime += (end_t - start_t)/1000;

    if ((err = clReleaseEvent(*record.event)) != CL_SUCCESS) {
      return err;
    }
    free(record.event);
  }

  ctx->profiling_records_used = 0;

  return CL_SUCCESS;
}

// If profiling, produce an event associated with a profiling record.
static cl_event* opencl_get_event(struct opencl_context *ctx, int *runs, int64_t *runtime) {
    if (ctx->profiling_records_used == ctx->profiling_records_capacity) {
      ctx->profiling_records_capacity *= 2;
      ctx->profiling_records =
        realloc(ctx->profiling_records,
                ctx->profiling_records_capacity *
                sizeof(struct profiling_record));
    }
    cl_event *event = malloc(sizeof(cl_event));
    ctx->profiling_records[ctx->profiling_records_used].event = event;
    ctx->profiling_records[ctx->profiling_records_used].runs = runs;
    ctx->profiling_records[ctx->profiling_records_used].runtime = runtime;
    ctx->profiling_records_used++;
    return event;
}

// Allocate memory from driver. The problem is that OpenCL may perform
// lazy allocation, so we cannot know whether an allocation succeeded
// until the first time we try to use it.  Hence we immediately
// perform a write to see if the allocation succeeded.  This is slow,
// but the assumption is that this operation will be rare (most things
// will go through the free list).
static int opencl_alloc_actual(struct opencl_context *ctx, size_t size, cl_mem *mem_out) {
  int error;
  *mem_out = clCreateBuffer(ctx->ctx, CL_MEM_READ_WRITE, size, NULL, &error);

  if (error != CL_SUCCESS) {
    return error;
  }

  int x = 2;
  error = clEnqueueWriteBuffer(ctx->queue, *mem_out, 1, 0, sizeof(x), &x, 0, NULL, NULL);

  // No need to wait for completion here. clWaitForEvents() cannot
  // return mem object allocation failures. This implies that the
  // buffer is faulted onto the device on enqueue. (Observation by
  // Andreas Kloeckner.)

  return error;
}

static int opencl_alloc(struct opencl_context *ctx, size_t min_size, const char *tag, cl_mem *mem_out) {
  (void)tag;
  if (min_size < sizeof(int)) {
    min_size = sizeof(int);
  }

  size_t size;

  if (free_list_find(&ctx->free_list, min_size, &size, mem_out) == 0) {
    // Successfully found a free block.  Is it big enough?
    //
    // FIXME: we might also want to check whether the block is *too
    // big*, to avoid internal fragmentation.  However, this can
    // sharply impact performance on programs where arrays change size
    // frequently.  Fortunately, such allocations are usually fairly
    // short-lived, as they are necessarily within a loop, so the risk
    // of internal fragmentation resulting in an OOM situation is
    // limited.  However, it would be preferable if we could go back
    // and *shrink* oversize allocations when we encounter an OOM
    // condition.  That is technically feasible, since we do not
    // expose OpenCL pointer values directly to the application, but
    // instead rely on a level of indirection.
    if (size >= min_size) {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "No need to allocate: Found a block in the free list.\n");
      }

      return CL_SUCCESS;
    } else {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "Found a free block, but it was too small.\n");
      }

      // Not just right - free it.
      int error = clReleaseMemObject(*mem_out);
      if (error != CL_SUCCESS) {
        return error;
      }
    }
  }

  // We have to allocate a new block from the driver.  If the
  // allocation does not succeed, then we might be in an out-of-memory
  // situation.  We now start freeing things from the free list until
  // we think we have freed enough that the allocation will succeed.
  // Since we don't know how far the allocation is from fitting, we
  // have to check after every deallocation.  This might be pretty
  // expensive.  Let's hope that this case is hit rarely.

  if (ctx->cfg.debugging) {
    fprintf(stderr, "Actually allocating the desired block.\n");
  }

  int error = opencl_alloc_actual(ctx, min_size, mem_out);

  while (error == CL_MEM_OBJECT_ALLOCATION_FAILURE) {
    if (ctx->cfg.debugging) {
      fprintf(stderr, "Out of OpenCL memory: releasing entry from the free list...\n");
    }
    cl_mem mem;
    if (free_list_first(&ctx->free_list, &mem) == 0) {
      error = clReleaseMemObject(mem);
      if (error != CL_SUCCESS) {
        return error;
      }
    } else {
      break;
    }
    error = opencl_alloc_actual(ctx, min_size, mem_out);
  }

  return error;
}

static int opencl_free(struct opencl_context *ctx, cl_mem mem, const char *tag) {
  size_t size;
  cl_mem existing_mem;

  // If there is already a block with this tag, then remove it.
  if (free_list_find(&ctx->free_list, -1, &size, &existing_mem) == 0) {
    int error = clReleaseMemObject(existing_mem);
    if (error != CL_SUCCESS) {
      return error;
    }
  }

  int error = clGetMemObjectInfo(mem, CL_MEM_SIZE, sizeof(size_t), &size, NULL);

  if (error == CL_SUCCESS) {
    free_list_insert(&ctx->free_list, size, mem, tag);
  }

  return error;
}

static int opencl_free_all(struct opencl_context *ctx) {
  cl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, &mem) == 0) {
    int error = clReleaseMemObject(mem);
    if (error != CL_SUCCESS) {
      return error;
    }
  }

  return CL_SUCCESS;
}

// Free everything that belongs to 'ctx', but do not free 'ctx'
// itself.
static void teardown_opencl(struct opencl_context *ctx) {
  (void)opencl_tally_profiling_records(ctx);
  free(ctx->profiling_records);
  (void)opencl_free_all(ctx);
  (void)clReleaseCommandQueue(ctx->queue);
  (void)clReleaseContext(ctx->ctx);
}

// End of opencl.h.

static const char *opencl_program[] =
                  {"#ifdef cl_clang_storage_class_specifiers\n#pragma OPENCL EXTENSION cl_clang_storage_class_specifiers : enable\n#endif\n#pragma OPENCL EXTENSION cl_khr_byte_addressable_store : enable\n__kernel void dummy_kernel(__global unsigned char *dummy, int n)\n{\n    const int thread_gid = get_global_id(0);\n    \n    if (thread_gid >= n)\n        return;\n}\ntypedef char int8_t;\ntypedef short int16_t;\ntypedef int int32_t;\ntypedef long int64_t;\ntypedef uchar uint8_t;\ntypedef ushort uint16_t;\ntypedef uint uint32_t;\ntypedef ulong uint64_t;\n#ifdef cl_nv_pragma_unroll\nstatic inline void mem_fence_global()\n{\n    asm(\"membar.gl;\");\n}\n#else\nstatic inline void mem_fence_global()\n{\n    mem_fence(CLK_LOCAL_MEM_FENCE | CLK_GLOBAL_MEM_FENCE);\n}\n#endif\nstatic inline void mem_fence_local()\n{\n    mem_fence(CLK_LOCAL_MEM_FENCE);\n}\nstatic inline uint8_t add8(uint8_t x, uint8_t y)\n{\n    return x + y;\n}\nstatic inline uint16_t add16(uint16_t x, uint16_t y)\n{\n    return x + y;\n}\nstatic inline uint32_t add32(uint32_t x, uint32_t y)\n{\n    return x + y;\n}\nstatic inline uint64_t add64(uint64_t x, uint64_t y)\n{\n    return x + y;\n}\nstatic inline uint8_t sub8(uint8_t x, uint8_t y)\n{\n    return x - y;\n}\nstatic inline uint16_t sub16(uint16_t x, uint16_t y)\n{\n    return x - y;\n}\nstatic inline uint32_t sub32(uint32_t x, uint32_t y)\n{\n    return x - y;\n}\nstatic inline uint64_t sub64(uint64_t x, uint64_t y)\n{\n    return x - y;\n}\nstatic inline uint8_t mul8(uint8_t x, uint8_t y)\n{\n    return x * y;\n}\nstatic inline uint16_t mul16(uint16_t x, uint16_t y)\n{\n    return x * y;\n}\nstatic inline uint32_t mul32(uint32_t x, uint32_t y)\n{\n    return x * y;\n}\nstatic inline uint64_t mul64(uint64_t x, uint64_t y)\n{\n    return x * y;\n}\nstatic inline uint8_t udiv8(uint8_t x, uint8_t y)\n{\n    return x / y;\n}\nstatic inline uint16_t udiv16(uint16_t x, uint16_t y)\n{\n    return x / y;\n}\nstatic inline uint32_t udiv32(uint32_t x, uint32_t y)\n{\n    return x / y;\n}\nstatic inline uint64_t udiv64(uint64_t x, uint64_t y)\n{\n    return x / y;\n}\nstatic ",
                   "inline uint8_t udiv_up8(uint8_t x, uint8_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint16_t udiv_up16(uint16_t x, uint16_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint32_t udiv_up32(uint32_t x, uint32_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint64_t udiv_up64(uint64_t x, uint64_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint8_t umod8(uint8_t x, uint8_t y)\n{\n    return x % y;\n}\nstatic inline uint16_t umod16(uint16_t x, uint16_t y)\n{\n    return x % y;\n}\nstatic inline uint32_t umod32(uint32_t x, uint32_t y)\n{\n    return x % y;\n}\nstatic inline uint64_t umod64(uint64_t x, uint64_t y)\n{\n    return x % y;\n}\nstatic inline uint8_t udiv_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint16_t udiv_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint32_t udiv_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint64_t udiv_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint8_t umod_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint16_t umod_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint32_t umod_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint64_t umod_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int8_t sdiv8(int8_t x, int8_t y)\n{\n    int8_t q = x / y;\n    int8_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int16_t sdiv16(int16",
                   "_t x, int16_t y)\n{\n    int16_t q = x / y;\n    int16_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int32_t sdiv32(int32_t x, int32_t y)\n{\n    int32_t q = x / y;\n    int32_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int64_t sdiv64(int64_t x, int64_t y)\n{\n    int64_t q = x / y;\n    int64_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int8_t sdiv_up8(int8_t x, int8_t y)\n{\n    return sdiv8(x + y - 1, y);\n}\nstatic inline int16_t sdiv_up16(int16_t x, int16_t y)\n{\n    return sdiv16(x + y - 1, y);\n}\nstatic inline int32_t sdiv_up32(int32_t x, int32_t y)\n{\n    return sdiv32(x + y - 1, y);\n}\nstatic inline int64_t sdiv_up64(int64_t x, int64_t y)\n{\n    return sdiv64(x + y - 1, y);\n}\nstatic inline int8_t smod8(int8_t x, int8_t y)\n{\n    int8_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int16_t smod16(int16_t x, int16_t y)\n{\n    int16_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int32_t smod32(int32_t x, int32_t y)\n{\n    int32_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int64_t smod64(int64_t x, int64_t y)\n{\n    int64_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int8_t sdiv_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : sdiv8(x, y);\n}\nstatic inline int16_t sdiv_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : sdiv16(x, y);\n}\nstatic inline int32_t sdiv_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : sdiv32(x, y);\n}\nstatic inline int64_t sdiv_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : sdiv64(x, y);\n}\nstatic inline int8_t sdiv_up_safe8(int8_t x, int8_t y)\n{\n    return sdiv_safe8(x + y - 1, y);\n}\nstatic inline int16_t sdiv_up_safe16(int16_t x, int16_t y)\n{\n    return sdiv_safe16(x + y - 1, y",
                   ");\n}\nstatic inline int32_t sdiv_up_safe32(int32_t x, int32_t y)\n{\n    return sdiv_safe32(x + y - 1, y);\n}\nstatic inline int64_t sdiv_up_safe64(int64_t x, int64_t y)\n{\n    return sdiv_safe64(x + y - 1, y);\n}\nstatic inline int8_t smod_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : smod8(x, y);\n}\nstatic inline int16_t smod_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : smod16(x, y);\n}\nstatic inline int32_t smod_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : smod32(x, y);\n}\nstatic inline int64_t smod_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : smod64(x, y);\n}\nstatic inline int8_t squot8(int8_t x, int8_t y)\n{\n    return x / y;\n}\nstatic inline int16_t squot16(int16_t x, int16_t y)\n{\n    return x / y;\n}\nstatic inline int32_t squot32(int32_t x, int32_t y)\n{\n    return x / y;\n}\nstatic inline int64_t squot64(int64_t x, int64_t y)\n{\n    return x / y;\n}\nstatic inline int8_t srem8(int8_t x, int8_t y)\n{\n    return x % y;\n}\nstatic inline int16_t srem16(int16_t x, int16_t y)\n{\n    return x % y;\n}\nstatic inline int32_t srem32(int32_t x, int32_t y)\n{\n    return x % y;\n}\nstatic inline int64_t srem64(int64_t x, int64_t y)\n{\n    return x % y;\n}\nstatic inline int8_t squot_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int16_t squot_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int32_t squot_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int64_t squot_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int8_t srem_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int16_t srem_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int32_t srem_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int64_t srem_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int8_t smin8(int8_t x, int8_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int16_t smi",
                   "n16(int16_t x, int16_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int32_t smin32(int32_t x, int32_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int64_t smin64(int64_t x, int64_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint8_t umin8(uint8_t x, uint8_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint16_t umin16(uint16_t x, uint16_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint32_t umin32(uint32_t x, uint32_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint64_t umin64(uint64_t x, uint64_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int8_t smax8(int8_t x, int8_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int16_t smax16(int16_t x, int16_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int32_t smax32(int32_t x, int32_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int64_t smax64(int64_t x, int64_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint8_t umax8(uint8_t x, uint8_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint16_t umax16(uint16_t x, uint16_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint32_t umax32(uint32_t x, uint32_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint64_t umax64(uint64_t x, uint64_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint8_t shl8(uint8_t x, uint8_t y)\n{\n    return x << y;\n}\nstatic inline uint16_t shl16(uint16_t x, uint16_t y)\n{\n    return x << y;\n}\nstatic inline uint32_t shl32(uint32_t x, uint32_t y)\n{\n    return x << y;\n}\nstatic inline uint64_t shl64(uint64_t x, uint64_t y)\n{\n    return x << y;\n}\nstatic inline uint8_t lshr8(uint8_t x, uint8_t y)\n{\n    return x >> y;\n}\nstatic inline uint16_t lshr16(uint16_t x, uint16_t y)\n{\n    return x >> y;\n}\nstatic inline uint32_t lshr32(uint32_t x, uint32_t y)\n{\n    return x >> y;\n}\nstatic inline uint64_t lshr64(uint64_t x, uint64_t y)\n{\n    return x >> y;\n}\nstatic inline int8_t ashr8(int8_t x, int8_t y)\n{\n    return x >> y;\n}\nstatic inline int16_t ashr16(int16_t x, int16_t y)\n{\n    return x >> y;\n}\nstatic inline int32_t ashr32(int32_t x, int32_t y)",
                   "\n{\n    return x >> y;\n}\nstatic inline int64_t ashr64(int64_t x, int64_t y)\n{\n    return x >> y;\n}\nstatic inline uint8_t and8(uint8_t x, uint8_t y)\n{\n    return x & y;\n}\nstatic inline uint16_t and16(uint16_t x, uint16_t y)\n{\n    return x & y;\n}\nstatic inline uint32_t and32(uint32_t x, uint32_t y)\n{\n    return x & y;\n}\nstatic inline uint64_t and64(uint64_t x, uint64_t y)\n{\n    return x & y;\n}\nstatic inline uint8_t or8(uint8_t x, uint8_t y)\n{\n    return x | y;\n}\nstatic inline uint16_t or16(uint16_t x, uint16_t y)\n{\n    return x | y;\n}\nstatic inline uint32_t or32(uint32_t x, uint32_t y)\n{\n    return x | y;\n}\nstatic inline uint64_t or64(uint64_t x, uint64_t y)\n{\n    return x | y;\n}\nstatic inline uint8_t xor8(uint8_t x, uint8_t y)\n{\n    return x ^ y;\n}\nstatic inline uint16_t xor16(uint16_t x, uint16_t y)\n{\n    return x ^ y;\n}\nstatic inline uint32_t xor32(uint32_t x, uint32_t y)\n{\n    return x ^ y;\n}\nstatic inline uint64_t xor64(uint64_t x, uint64_t y)\n{\n    return x ^ y;\n}\nstatic inline bool ult8(uint8_t x, uint8_t y)\n{\n    return x < y;\n}\nstatic inline bool ult16(uint16_t x, uint16_t y)\n{\n    return x < y;\n}\nstatic inline bool ult32(uint32_t x, uint32_t y)\n{\n    return x < y;\n}\nstatic inline bool ult64(uint64_t x, uint64_t y)\n{\n    return x < y;\n}\nstatic inline bool ule8(uint8_t x, uint8_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule16(uint16_t x, uint16_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule32(uint32_t x, uint32_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule64(uint64_t x, uint64_t y)\n{\n    return x <= y;\n}\nstatic inline bool slt8(int8_t x, int8_t y)\n{\n    return x < y;\n}\nstatic inline bool slt16(int16_t x, int16_t y)\n{\n    return x < y;\n}\nstatic inline bool slt32(int32_t x, int32_t y)\n{\n    return x < y;\n}\nstatic inline bool slt64(int64_t x, int64_t y)\n{\n    return x < y;\n}\nstatic inline bool sle8(int8_t x, int8_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle16(int16_t x, int16_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle32(int32_t x, int32_",
                   "t y)\n{\n    return x <= y;\n}\nstatic inline bool sle64(int64_t x, int64_t y)\n{\n    return x <= y;\n}\nstatic inline int8_t pow8(int8_t x, int8_t y)\n{\n    int8_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int16_t pow16(int16_t x, int16_t y)\n{\n    int16_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int32_t pow32(int32_t x, int32_t y)\n{\n    int32_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int64_t pow64(int64_t x, int64_t y)\n{\n    int64_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline bool itob_i8_bool(int8_t x)\n{\n    return x;\n}\nstatic inline bool itob_i16_bool(int16_t x)\n{\n    return x;\n}\nstatic inline bool itob_i32_bool(int32_t x)\n{\n    return x;\n}\nstatic inline bool itob_i64_bool(int64_t x)\n{\n    return x;\n}\nstatic inline int8_t btoi_bool_i8(bool x)\n{\n    return x;\n}\nstatic inline int16_t btoi_bool_i16(bool x)\n{\n    return x;\n}\nstatic inline int32_t btoi_bool_i32(bool x)\n{\n    return x;\n}\nstatic inline int64_t btoi_bool_i64(bool x)\n{\n    return x;\n}\n#define sext_i8_i8(x) ((int8_t) (int8_t) x)\n#define sext_i8_i16(x) ((int16_t) (int8_t) x)\n#define sext_i8_i32(x) ((int32_t) (int8_t) x)\n#define sext_i8_i64(x) ((int64_t) (int8_t) x)\n#define sext_i16_i8(x) ((int8_t) (int16_t) x)\n#define sext_i16_i16(x) ((int16_t) (int16_t) x)\n#define sext_i16_i32(x) ((int32_t) (int16_t) x)\n#define sext_i16_i64(x) ((int64_t) (int16_t) x)\n#define sext_i32_i8(x) ((int8_t) (int32_t) x)\n#define sext_i32_i16(x) ((int16_t) (int32_t) x)\n#define sext_i32_i32(x) ((int32_t) (int32_t) x)\n#define sext_i32_i64(x) ((int64_t) (int32_t) x)\n#defi",
                   "ne sext_i64_i8(x) ((int8_t) (int64_t) x)\n#define sext_i64_i16(x) ((int16_t) (int64_t) x)\n#define sext_i64_i32(x) ((int32_t) (int64_t) x)\n#define sext_i64_i64(x) ((int64_t) (int64_t) x)\n#define zext_i8_i8(x) ((int8_t) (uint8_t) x)\n#define zext_i8_i16(x) ((int16_t) (uint8_t) x)\n#define zext_i8_i32(x) ((int32_t) (uint8_t) x)\n#define zext_i8_i64(x) ((int64_t) (uint8_t) x)\n#define zext_i16_i8(x) ((int8_t) (uint16_t) x)\n#define zext_i16_i16(x) ((int16_t) (uint16_t) x)\n#define zext_i16_i32(x) ((int32_t) (uint16_t) x)\n#define zext_i16_i64(x) ((int64_t) (uint16_t) x)\n#define zext_i32_i8(x) ((int8_t) (uint32_t) x)\n#define zext_i32_i16(x) ((int16_t) (uint32_t) x)\n#define zext_i32_i32(x) ((int32_t) (uint32_t) x)\n#define zext_i32_i64(x) ((int64_t) (uint32_t) x)\n#define zext_i64_i8(x) ((int8_t) (uint64_t) x)\n#define zext_i64_i16(x) ((int16_t) (uint64_t) x)\n#define zext_i64_i32(x) ((int32_t) (uint64_t) x)\n#define zext_i64_i64(x) ((int64_t) (uint64_t) x)\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_popc8(int8_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    return popcount(x);\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_popc8(int8_t x)\n{\n    return __popc(zext_i8_i32(x));\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    return __popc(zext_i16_i32(x));\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    return __popc(x);\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    return __popcll(x);\n}\n#else\nstatic int32_t futrts_popc8(int8_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    int c = 0;\n    \n    for ",
                   "(; x; ++c)\n        x &= x - 1;\n    return c;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    return mul_hi(a, b);\n}\n#elif defined(__CUDA_ARCH__)\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    uint16_t aa = a;\n    uint16_t bb = b;\n    \n    return aa * bb >> 8;\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    uint32_t aa = a;\n    uint32_t bb = b;\n    \n    return aa * bb >> 16;\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    return mulhi(a, b);\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    return mul64hi(a, b);\n}\n#else\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    uint16_t aa = a;\n    uint16_t bb = b;\n    \n    return aa * bb >> 8;\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    uint32_t aa = a;\n    uint32_t bb = b;\n    \n    return aa * bb >> 16;\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    uint64_t aa = a;\n    uint64_t bb = b;\n    \n    return aa * bb >> 32;\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    __uint128_t aa = a;\n    __uint128_t bb = b;\n    \n    return aa * bb >> 64;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)\n{\n    return mad_hi(a, b, c);\n}\n#else\nstatic uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)\n{\n    return futrts_mul_hi8(a, b) + c;\n}\nstatic uint16_t futrts_mad_hi16(uin",
                   "t16_t a, uint16_t b, uint16_t c)\n{\n    return futrts_mul_hi16(a, b) + c;\n}\nstatic uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)\n{\n    return futrts_mul_hi32(a, b) + c;\n}\nstatic uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)\n{\n    return futrts_mul_hi64(a, b) + c;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    return clz(x);\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    return __clz(zext_i8_i32(x)) - 24;\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    return __clz(zext_i16_i32(x)) - 16;\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    return __clz(x);\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    return __clzll(x);\n}\n#else\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    int i = 0;\n    \n    for (; i < 8 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz16(int16_t ",
                   "x)\n{\n    int i = 0;\n    \n    for (; i < 16 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    int i = 0;\n    \n    for (; i < 32 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    int i = 0;\n    \n    for (; i < 64 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 8 : y - 1;\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 16 : y - 1;\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 32 : y - 1;\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    int y = __ffsll(x);\n    \n    return y == 0 ? 64 : y - 1;\n}\n#else\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    return x == 0 ? 8 : __builtin_ctz((uint32_t) x);\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    return x == 0 ? 16 : __builtin_ctz((uint32_t) x);\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    return x == 0 ? 32 : __builtin_ctz(x);\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    return x == 0 ? 64 : __builtin_ctzl(x);\n}\n#endif\nstatic inline float fdiv32(float x, float y)\n{\n    return x / y;\n}\nstatic inline float fadd32(float x, float y)\n{\n    return x + y;\n}\nstatic inline float fsub32(float x, float y)\n{\n    return x - y;\n}\nstatic inline float fmul32(float x, float y)\n{\n    return x * y;\n}\nstatic inline float fmin32(float x, float y)\n{\n    return fmin(x, y);\n}\nstatic inline float fmax32(float x, float y)\n{\n    return fmax(x, y);\n}\nstatic inline float fpow32(float x, float y)\n{\n    return pow(x, y);\n}\nstatic inline bool cmplt32(float x, float y)\n{\n    return x < y;\n}\nstatic inline bool cmple32(float x, float y)\n{\n    return x <= y;\n}\nstatic inline float sitofp_i8_f32(int8_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i16_f32(int16_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i32_f32(int32_t x)",
                   "\n{\n    return (float) x;\n}\nstatic inline float sitofp_i64_f32(int64_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i8_f32(uint8_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i16_f32(uint16_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i32_f32(uint32_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i64_f32(uint64_t x)\n{\n    return (float) x;\n}\nstatic inline int8_t fptosi_f32_i8(float x)\n{\n    return (int8_t) x;\n}\nstatic inline int16_t fptosi_f32_i16(float x)\n{\n    return (int16_t) x;\n}\nstatic inline int32_t fptosi_f32_i32(float x)\n{\n    return (int32_t) x;\n}\nstatic inline int64_t fptosi_f32_i64(float x)\n{\n    return (int64_t) x;\n}\nstatic inline uint8_t fptoui_f32_i8(float x)\n{\n    return (uint8_t) x;\n}\nstatic inline uint16_t fptoui_f32_i16(float x)\n{\n    return (uint16_t) x;\n}\nstatic inline uint32_t fptoui_f32_i32(float x)\n{\n    return (uint32_t) x;\n}\nstatic inline uint64_t fptoui_f32_i64(float x)\n{\n    return (uint64_t) x;\n}\nstatic inline float futrts_log32(float x)\n{\n    return log(x);\n}\nstatic inline float futrts_log2_32(float x)\n{\n    return log2(x);\n}\nstatic inline float futrts_log10_32(float x)\n{\n    return log10(x);\n}\nstatic inline float futrts_sqrt32(float x)\n{\n    return sqrt(x);\n}\nstatic inline float futrts_exp32(float x)\n{\n    return exp(x);\n}\nstatic inline float futrts_cos32(float x)\n{\n    return cos(x);\n}\nstatic inline float futrts_sin32(float x)\n{\n    return sin(x);\n}\nstatic inline float futrts_tan32(float x)\n{\n    return tan(x);\n}\nstatic inline float futrts_acos32(float x)\n{\n    return acos(x);\n}\nstatic inline float futrts_asin32(float x)\n{\n    return asin(x);\n}\nstatic inline float futrts_atan32(float x)\n{\n    return atan(x);\n}\nstatic inline float futrts_cosh32(float x)\n{\n    return cosh(x);\n}\nstatic inline float futrts_sinh32(float x)\n{\n    return sinh(x);\n}\nstatic inline float futrts_tanh32(float x)\n{\n    return tanh(x);\n}\nstatic inline float futrts_acosh32(float x)\n{\n    return acosh(x);\n}\nstatic inline fl",
                   "oat futrts_asinh32(float x)\n{\n    return asinh(x);\n}\nstatic inline float futrts_atanh32(float x)\n{\n    return atanh(x);\n}\nstatic inline float futrts_atan2_32(float x, float y)\n{\n    return atan2(x, y);\n}\nstatic inline float futrts_gamma32(float x)\n{\n    return tgamma(x);\n}\nstatic inline float futrts_lgamma32(float x)\n{\n    return lgamma(x);\n}\nstatic inline bool futrts_isnan32(float x)\n{\n    return isnan(x);\n}\nstatic inline bool futrts_isinf32(float x)\n{\n    return isinf(x);\n}\nstatic inline int32_t futrts_to_bits32(float x)\n{\n    union {\n        float f;\n        int32_t t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\nstatic inline float futrts_from_bits32(int32_t x)\n{\n    union {\n        int32_t f;\n        float t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\n#ifdef __OPENCL_VERSION__\nstatic inline float fmod32(float x, float y)\n{\n    return fmod(x, y);\n}\nstatic inline float futrts_round32(float x)\n{\n    return rint(x);\n}\nstatic inline float futrts_floor32(float x)\n{\n    return floor(x);\n}\nstatic inline float futrts_ceil32(float x)\n{\n    return ceil(x);\n}\nstatic inline float futrts_lerp32(float v0, float v1, float t)\n{\n    return mix(v0, v1, t);\n}\nstatic inline float futrts_mad32(float a, float b, float c)\n{\n    return mad(a, b, c);\n}\nstatic inline float futrts_fma32(float a, float b, float c)\n{\n    return fma(a, b, c);\n}\n#else\nstatic inline float fmod32(float x, float y)\n{\n    return fmodf(x, y);\n}\nstatic inline float futrts_round32(float x)\n{\n    return rintf(x);\n}\nstatic inline float futrts_floor32(float x)\n{\n    return floorf(x);\n}\nstatic inline float futrts_ceil32(float x)\n{\n    return ceilf(x);\n}\nstatic inline float futrts_lerp32(float v0, float v1, float t)\n{\n    return v0 + (v1 - v0) * t;\n}\nstatic inline float futrts_mad32(float a, float b, float c)\n{\n    return a * b + c;\n}\nstatic inline float futrts_fma32(float a, float b, float c)\n{\n    return fmaf(a, b, c);\n}\n#endif\n// Start of atomics.h\n\ninline int32_t atomic_add_i32_global(volatile __global int32_t *p, ",
                   "int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\ninline int32_t atomic_add_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\ninline float atomic_fadd_f32_global(volatile __global float *p, float x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg((volatile __global int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\ninline float atomic_fadd_f32_local(volatile __local float *p, float x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg((volatile __local int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\ninline int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline int32_t atomic_smax_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline int32_t atomic_smin_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p",
                   ", x);\n#endif\n}\n\ninline uint32_t atomic_umax_i32_local(volatile __local uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline uint32_t atomic_umin_i32_local(volatile __local uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\ninline int32_t atomic_and_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\ninline int32_t atomic_or_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\ninline int32_t atomic_or_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\ninline int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xor_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xchg_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t",
                   " atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                         int32_t cmp, int32_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\ninline int32_t atomic_cmpxchg_i32_local(volatile __local int32_t *p,\n                                         int32_t cmp, int32_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\n// End of atomics.h\n\n\n\n\n__kernel void builtinzhreplicate_f32zireplicate_28460(__global\n                                                      unsigned char *mem_28456,\n                                                      int32_t num_elems_28457,\n                                                      float val_28458)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t replicate_gtid_28460;\n    int32_t replicate_ltid_28461;\n    int32_t replicate_gid_28462;\n    \n    replicate_gtid_28460 = get_global_id(0);\n    replicate_ltid_28461 = get_local_id(0);\n    replicate_gid_28462 = get_group_id(0);\n    if (slt64(replicate_gtid_28460, num_elems_28457)) {\n        ((__global float *) mem_28456)[sext_i32_i64(replicate_gtid_28460)] =\n            val_28458;\n    }\n    \n  error_0:\n    return;\n}\n__kernel void builtinzhreplicate_i64zireplicate_28051(__global\n                                                      unsigned char *mem_28047,\n                                                      int32_t num_elems_28048,\n                                                      int64_t val_28049)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t replicate_gtid_28051;\n    int32_t replicate_ltid_28052;\n    int32_t replicate_gid_28053;\n    \n    replicate_gtid_28051 = get_global_id(0);\n    replicate_ltid_28052 = get_local_id(0);\n    replicate_gid_28053 = get_group_id(0);\n    if (slt64(replicate_gtid_28051, nu",
                   "m_elems_28048)) {\n        ((__global int64_t *) mem_28047)[sext_i32_i64(replicate_gtid_28051)] =\n            val_28049;\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32(__local volatile\n                                    int64_t *block_9_backing_aligned_0,\n                                    int32_t destoffset_1, int32_t srcoffset_3,\n                                    int32_t num_arrays_4, int32_t x_elems_5,\n                                    int32_t y_elems_6, int32_t mulx_7,\n                                    int32_t muly_8, __global\n                                    unsigned char *destmem_0, __global\n                                    unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = get_group_id_2_42 * x_elems_5 * y_elems_6;\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t x_index_31 = get_global_id_0_37;\n    int32_t y_index_32 = get_group_id_1_41 * 32 + get_local_id_1_39;\n    \n    if (slt32(x_index_31, x_elems_5)) {\n        for (int32_t j_43 = 0; j_43 < 4; j_43++) {\n            int32",
                   "_t index_in_35 = (y_index_32 + j_43 * 8) * x_elems_5 +\n                    x_index_31;\n            \n            if (slt32(y_index_32 + j_43 * 8, y_elems_6)) {\n                ((__local float *) block_9)[sext_i32_i64((get_local_id_1_39 +\n                                                          j_43 * 8) * 33 +\n                                            get_local_id_0_38)] = ((__global\n                                                                    float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                                       index_in_35)];\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    x_index_31 = get_group_id_1_41 * 32 + get_local_id_0_38;\n    y_index_32 = get_group_id_0_40 * 32 + get_local_id_1_39;\n    if (slt32(x_index_31, y_elems_6)) {\n        for (int32_t j_43 = 0; j_43 < 4; j_43++) {\n            int32_t index_out_36 = (y_index_32 + j_43 * 8) * y_elems_6 +\n                    x_index_31;\n            \n            if (slt32(y_index_32 + j_43 * 8, x_elems_5)) {\n                ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                               index_out_36)] = ((__local\n                                                                  float *) block_9)[sext_i32_i64(get_local_id_0_38 *\n                                                                                    33 +\n                                                                                    get_local_id_1_39 +\n                                                                                    j_43 *\n                                                                                    8)];\n            }\n        }\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32_low_height(__local volatile\n                                               int64_t *block_9_backing_aligned_0,\n                                               int32_t destoffset_1,\n                   ",
                   "                            int32_t srcoffset_3,\n                                               int32_t num_arrays_4,\n                                               int32_t x_elems_5,\n                                               int32_t y_elems_6,\n                                               int32_t mulx_7, int32_t muly_8,\n                                               __global\n                                               unsigned char *destmem_0,\n                                               __global unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = get_group_id_2_42 * x_elems_5 * y_elems_6;\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t x_index_31 = get_group_id_0_40 * 16 * mulx_7 + get_local_id_0_38 +\n            srem32(get_local_id_1_39, mulx_7) * 16;\n    int32_t y_index_32 = get_group_id_1_41 * 16 + squot32(get_local_id_1_39,\n                                                          mulx_7);\n    int32_t index_in_35 = y_index_32 * x_elems_5 + x_index_31;\n    \n    if (slt32(x_index_31, x_elems_5) && slt32(",
                   "y_index_32, y_elems_6)) {\n        ((__local float *) block_9)[sext_i32_i64(get_local_id_1_39 * 17 +\n                                    get_local_id_0_38)] = ((__global\n                                                            float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                               index_in_35)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    x_index_31 = get_group_id_1_41 * 16 + squot32(get_local_id_0_38, mulx_7);\n    y_index_32 = get_group_id_0_40 * 16 * mulx_7 + get_local_id_1_39 +\n        srem32(get_local_id_0_38, mulx_7) * 16;\n    \n    int32_t index_out_36 = y_index_32 * y_elems_6 + x_index_31;\n    \n    if (slt32(x_index_31, y_elems_6) && slt32(y_index_32, x_elems_5)) {\n        ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                       index_out_36)] = ((__local\n                                                          float *) block_9)[sext_i32_i64(get_local_id_0_38 *\n                                                                            17 +\n                                                                            get_local_id_1_39)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32_low_width(__local volatile\n                                              int64_t *block_9_backing_aligned_0,\n                                              int32_t destoffset_1,\n                                              int32_t srcoffset_3,\n                                              int32_t num_arrays_4,\n                                              int32_t x_elems_5,\n                                              int32_t y_elems_6, int32_t mulx_7,\n                                              int32_t muly_8, __global\n                                              unsigned char *destmem_0, __global\n                                              unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    co",
                   "nst int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = get_group_id_2_42 * x_elems_5 * y_elems_6;\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t x_index_31 = get_group_id_0_40 * 16 + squot32(get_local_id_0_38,\n                                                          muly_8);\n    int32_t y_index_32 = get_group_id_1_41 * 16 * muly_8 + get_local_id_1_39 +\n            srem32(get_local_id_0_38, muly_8) * 16;\n    int32_t index_in_35 = y_index_32 * x_elems_5 + x_index_31;\n    \n    if (slt32(x_index_31, x_elems_5) && slt32(y_index_32, y_elems_6)) {\n        ((__local float *) block_9)[sext_i32_i64(get_local_id_1_39 * 17 +\n                                    get_local_id_0_38)] = ((__global\n                                                            float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                               index_in_35)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    x_index_31 = get_group_id_1_41 * 16 * muly_8 + get_local_id_0_38 +\n        srem32(get_local_id_1_39, muly_8) * 16;\n    y_index_32 = get_group_id_0_40 * 16 + squot32(get_local_id_1_39, muly_8",
                   ");\n    \n    int32_t index_out_36 = y_index_32 * y_elems_6 + x_index_31;\n    \n    if (slt32(x_index_31, y_elems_6) && slt32(y_index_32, x_elems_5)) {\n        ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                       index_out_36)] = ((__local\n                                                          float *) block_9)[sext_i32_i64(get_local_id_0_38 *\n                                                                            17 +\n                                                                            get_local_id_1_39)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32_small(__local volatile\n                                          int64_t *block_9_backing_aligned_0,\n                                          int32_t destoffset_1,\n                                          int32_t srcoffset_3,\n                                          int32_t num_arrays_4,\n                                          int32_t x_elems_5, int32_t y_elems_6,\n                                          int32_t mulx_7, int32_t muly_8,\n                                          __global unsigned char *destmem_0,\n                                          __global unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    ",
                   "\n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = squot32(get_global_id_0_37, y_elems_6 *\n                                          x_elems_5) * (y_elems_6 * x_elems_5);\n    int32_t x_index_31 = squot32(srem32(get_global_id_0_37, y_elems_6 *\n                                        x_elems_5), y_elems_6);\n    int32_t y_index_32 = srem32(get_global_id_0_37, y_elems_6);\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t index_in_35 = y_index_32 * x_elems_5 + x_index_31;\n    int32_t index_out_36 = x_index_31 * y_elems_6 + y_index_32;\n    \n    if (slt32(get_global_id_0_37, x_elems_5 * y_elems_6 * num_arrays_4)) {\n        ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                       index_out_36)] = ((__global\n                                                          float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                             index_in_35)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void mainzicopy_28472(int64_t n_23343, int64_t paths_23346,\n                               int64_t steps_23347, __global\n                               unsigned char *mem_27767, __global\n                               unsigned char *mem_27772)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_28472;\n    int32_t copy_ltid_28473;\n    int32_t copy_gid_28474;\n    \n    copy_gtid_28472 = get_global_id(0);\n    copy_ltid_28473 = get_local_id(0);\n    copy_gid_28474 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_28472), steps_23347 * paths_23346 *\n              n_23343)) {\n        ((__global float *) mem_27772)[squot64(sext_i32_i64(copy_gtid_28472),\n                                               paths_23346 * n_23343) *\n                          ",
                   "             (n_23343 * paths_23346) +\n                                       squot64(sext_i32_i64(copy_gtid_28472) -\n                                               squot64(sext_i32_i64(copy_gtid_28472),\n                                                       paths_23346 * n_23343) *\n                                               (paths_23346 * n_23343),\n                                               n_23343) * n_23343 +\n                                       (sext_i32_i64(copy_gtid_28472) -\n                                        squot64(sext_i32_i64(copy_gtid_28472),\n                                                paths_23346 * n_23343) *\n                                        (paths_23346 * n_23343) -\n                                        squot64(sext_i32_i64(copy_gtid_28472) -\n                                                squot64(sext_i32_i64(copy_gtid_28472),\n                                                        paths_23346 * n_23343) *\n                                                (paths_23346 * n_23343),\n                                                n_23343) * n_23343)] =\n            ((__global\n              float *) mem_27767)[squot64(sext_i32_i64(copy_gtid_28472) -\n                                          squot64(sext_i32_i64(copy_gtid_28472),\n                                                  paths_23346 * n_23343) *\n                                          (paths_23346 * n_23343), n_23343) *\n                                  (n_23343 * steps_23347) +\n                                  squot64(sext_i32_i64(copy_gtid_28472),\n                                          paths_23346 * n_23343) * n_23343 +\n                                  (sext_i32_i64(copy_gtid_28472) -\n                                   squot64(sext_i32_i64(copy_gtid_28472),\n                                           paths_23346 * n_23343) *\n                                   (paths_23346 * n_23343) -\n                                   squot64(sext_i32_i64(copy_gtid_28472) -\n        ",
                   "                                   squot64(sext_i32_i64(copy_gtid_28472),\n                                                   paths_23346 * n_23343) *\n                                           (paths_23346 * n_23343), n_23343) *\n                                   n_23343)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void mainzicopy_28509(int64_t n_23343, int64_t paths_23346,\n                               int64_t steps_23347, __global\n                               unsigned char *mem_27767, __global\n                               unsigned char *mem_27785)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_28509;\n    int32_t copy_ltid_28510;\n    int32_t copy_gid_28511;\n    \n    copy_gtid_28509 = get_global_id(0);\n    copy_ltid_28510 = get_local_id(0);\n    copy_gid_28511 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_28509), steps_23347 * paths_23346 *\n              n_23343)) {\n        ((__global float *) mem_27785)[squot64(sext_i32_i64(copy_gtid_28509),\n                                               paths_23346 * n_23343) *\n                                       (n_23343 * paths_23346) +\n                                       squot64(sext_i32_i64(copy_gtid_28509) -\n                                               squot64(sext_i32_i64(copy_gtid_28509),\n                                                       paths_23346 * n_23343) *\n                                               (paths_23346 * n_23343),\n                                               n_23343) * n_23343 +\n                                       (sext_i32_i64(copy_gtid_28509) -\n                                        squot64(sext_i32_i64(copy_gtid_28509),\n                                                paths_23346 * n_23343) *\n                                        (paths_23346 * n_23343) -\n                                        squot64(sext_i32_i64(copy_gtid_28509) -\n                                                squot64(sext_i32_i6",
                   "4(copy_gtid_28509),\n                                                        paths_23346 * n_23343) *\n                                                (paths_23346 * n_23343),\n                                                n_23343) * n_23343)] =\n            ((__global\n              float *) mem_27767)[squot64(sext_i32_i64(copy_gtid_28509) -\n                                          squot64(sext_i32_i64(copy_gtid_28509),\n                                                  paths_23346 * n_23343) *\n                                          (paths_23346 * n_23343), n_23343) *\n                                  (n_23343 * steps_23347) +\n                                  squot64(sext_i32_i64(copy_gtid_28509),\n                                          paths_23346 * n_23343) * n_23343 +\n                                  (sext_i32_i64(copy_gtid_28509) -\n                                   squot64(sext_i32_i64(copy_gtid_28509),\n                                           paths_23346 * n_23343) *\n                                   (paths_23346 * n_23343) -\n                                   squot64(sext_i32_i64(copy_gtid_28509) -\n                                           squot64(sext_i32_i64(copy_gtid_28509),\n                                                   paths_23346 * n_23343) *\n                                           (paths_23346 * n_23343), n_23343) *\n                                   n_23343)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void mainziscan_stage1_25333(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_27973_backing_aligned_0,\n                                      int64_t n_23343, int64_t steps_23347,\n                                      int64_t one_intra_par_min_24642, __global\n                                      unsigned char *res_mem_27659, __global\n                                      unsigned char *res_mem_27660,\n                                      int",
                   "64_t binop_x_27689, __global\n                                      unsigned char *res_mem_27734, __global\n                                      unsigned char *mem_27737, __global\n                                      unsigned char *mem_27739,\n                                      int32_t num_threads_27967)\n{\n    #define segscan_group_sizze_25328 (mainzisegscan_group_sizze_25327)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_27973_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_27973_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27968;\n    int32_t local_tid_27969;\n    int64_t group_sizze_27972;\n    int32_t wave_sizze_27971;\n    int32_t group_tid_27970;\n    \n    global_tid_27968 = get_global_id(0);\n    local_tid_27969 = get_local_id(0);\n    group_sizze_27972 = get_local_size(0);\n    wave_sizze_27971 = LOCKSTEP_WIDTH;\n    group_tid_27970 = get_group_id(0);\n    \n    int32_t phys_tid_25333;\n    \n    phys_tid_25333 = global_tid_27968;\n    \n    __local char *scan_arr_mem_27973;\n    \n    scan_arr_mem_27973 = (__local char *) scan_arr_mem_27973_backing_0;\n    \n    int64_t x_23534;\n    int64_t x_23535;\n    \n    x_23534 = 0;\n    for (int64_t j_27975 = 0; j_27975 < sdiv_up64(binop_x_27689,\n                                                  sext_i32_i64(num_threads_27967));\n         j_27975++) {\n        int64_t chunk_offset_27976 = segscan_group_sizze_25328 * j_27975 +\n                sext_i32_i64(group_tid_27970) * (segscan_group_sizze_25328 *\n                                                 sdiv_up64(binop_x_27689,\n                                                           sext_i32_i64(num_threads_27967)));\n        int64_t flat_idx_27977 = chunk_offset_27976 +\n                sext_i32_i64(local_tid_27969);\n        int64_t gtid_25332 = flat_idx_27977;\n        \n        // threa",
                   "ds in bounds read input\n        {\n            if (slt64(gtid_25332, binop_x_27689)) {\n                int64_t binop_x_27491 = squot64(gtid_25332,\n                                                one_intra_par_min_24642);\n                int64_t binop_y_27493 = one_intra_par_min_24642 * binop_x_27491;\n                int64_t binop_x_27494 = gtid_25332 - binop_y_27493;\n                int64_t binop_x_27500 = squot64(binop_x_27494, n_23343);\n                int64_t binop_y_27501 = n_23343 * binop_x_27500;\n                int64_t new_index_27502 = binop_x_27494 - binop_y_27501;\n                int64_t x_23537 = ((__global\n                                    int64_t *) res_mem_27659)[new_index_27502];\n                float x_23538 = ((__global\n                                  float *) res_mem_27660)[new_index_27502];\n                float x_23539 = ((__global\n                                  float *) res_mem_27734)[binop_x_27491 *\n                                                          (n_23343 *\n                                                           steps_23347) +\n                                                          binop_x_27500 *\n                                                          n_23343 +\n                                                          new_index_27502];\n                float x_23540 = x_23539 / x_23538;\n                float ceil_arg_23541 = x_23540 - 1.0F;\n                float res_23542;\n                \n                res_23542 = futrts_ceil32(ceil_arg_23541);\n                \n                int64_t res_23543 = fptosi_f32_i64(res_23542);\n                int64_t max_arg_23544 = sub64(x_23537, res_23543);\n                int64_t res_23545 = smax64(0, max_arg_23544);\n                bool cond_23546 = res_23545 == 0;\n                int64_t res_23547;\n                \n                if (cond_23546) {\n                    res_23547 = 1;\n                } else {\n                    res_23547 = res_23545;\n                }\n                /",
                   "/ write to-scan values to parameters\n                {\n                    x_23535 = res_23547;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global int64_t *) mem_27739)[gtid_25332] = res_23547;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_25332, binop_x_27689)) {\n                    x_23535 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_23536 = add64(x_23534, x_23535);\n                \n                ((__local\n                  int64_t *) scan_arr_mem_27973)[sext_i32_i64(local_tid_27969)] =\n                    res_23536;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_27978;\n            int64_t x_27979;\n            int64_t x_27981;\n            int64_t x_27982;\n            bool ltid_in_bounds_27984;\n            \n            ltid_in_bounds_27984 = slt64(sext_i32_i64(local_tid_27969),\n                                         segscan_group_sizze_25328);\n            \n            int32_t skip_threads_27985;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_27984) {\n                    x_27979 = ((volatile __local\n                                int64_t *) scan_arr_mem_27973)[sext_i32_i64(local_tid_27969)];\n                    if ((local_tid_27969 - squot32(local_tid_27969, 32) * 32) ==\n                        0) {\n                        x_27978 = x_27979;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_27985 = 1;\n                while (slt32(skip_threads_27985, 32)) {\n                    if (sle32(skip_threads_27985, local",
                   "_tid_27969 -\n                              squot32(local_tid_27969, 32) * 32) &&\n                        ltid_in_bounds_27984) {\n                        // read operands\n                        {\n                            x_27978 = ((volatile __local\n                                        int64_t *) scan_arr_mem_27973)[sext_i32_i64(local_tid_27969) -\n                                                                       sext_i32_i64(skip_threads_27985)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_27980 = add64(x_27978, x_27979);\n                            \n                            x_27978 = res_27980;\n                        }\n                    }\n                    if (sle32(wave_sizze_27971, skip_threads_27985)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_27985, local_tid_27969 -\n                              squot32(local_tid_27969, 32) * 32) &&\n                        ltid_in_bounds_27984) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_27973)[sext_i32_i64(local_tid_27969)] =\n                                x_27978;\n                            x_27979 = x_27978;\n                        }\n                    }\n                    if (sle32(wave_sizze_27971, skip_threads_27985)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_27985 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_27969 - squot32(local_tid_27969, 32) * 32) ==\n                    31 && ltid_in_bounds_27984) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_2797",
                   "3)[sext_i32_i64(squot32(local_tid_27969,\n                                                                          32))] =\n                        x_27978;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_27986;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_27969, 32) == 0 &&\n                        ltid_in_bounds_27984) {\n                        x_27982 = ((volatile __local\n                                    int64_t *) scan_arr_mem_27973)[sext_i32_i64(local_tid_27969)];\n                        if ((local_tid_27969 - squot32(local_tid_27969, 32) *\n                             32) == 0) {\n                            x_27981 = x_27982;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_27986 = 1;\n                    while (slt32(skip_threads_27986, 32)) {\n                        if (sle32(skip_threads_27986, local_tid_27969 -\n                                  squot32(local_tid_27969, 32) * 32) &&\n                            (squot32(local_tid_27969, 32) == 0 &&\n                             ltid_in_bounds_27984)) {\n                            // read operands\n                            {\n                                x_27981 = ((volatile __local\n                                            int64_t *) scan_arr_mem_27973)[sext_i32_i64(local_tid_27969) -\n                                                                           sext_i32_i64(skip_threads_27986)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_27983 = add64(x_27981, x_27982);\n                                \n                    ",
                   "            x_27981 = res_27983;\n                            }\n                        }\n                        if (sle32(wave_sizze_27971, skip_threads_27986)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_27986, local_tid_27969 -\n                                  squot32(local_tid_27969, 32) * 32) &&\n                            (squot32(local_tid_27969, 32) == 0 &&\n                             ltid_in_bounds_27984)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_27973)[sext_i32_i64(local_tid_27969)] =\n                                    x_27981;\n                                x_27982 = x_27981;\n                            }\n                        }\n                        if (sle32(wave_sizze_27971, skip_threads_27986)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_27986 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_27969, 32) == 0 ||\n                      !ltid_in_bounds_27984)) {\n                    // read operands\n                    {\n                        x_27979 = x_27978;\n                        x_27978 = ((__local\n                                    int64_t *) scan_arr_mem_27973)[sext_i32_i64(squot32(local_tid_27969,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_27980 = add64(x_27978, x_27979);\n                        \n                        x_27978 = r",
                   "es_27980;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_27973)[sext_i32_i64(local_tid_27969)] =\n                            x_27978;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_27969, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_27973)[sext_i32_i64(local_tid_27969)] =\n                        x_27979;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_25332, binop_x_27689)) {\n                    ((__global int64_t *) mem_27737)[gtid_25332] = ((__local\n                                                                     int64_t *) scan_arr_mem_27973)[sext_i32_i64(local_tid_27969)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_27987 = 0;\n                bool should_load_carry_27988 = local_tid_27969 == 0 &&\n                     !crosses_segment_27987;\n                \n                if (should_load_carry_27988) {\n                    x_23534 = ((__local\n                                int64_t *) scan_arr_mem_27973)[segscan_group_sizze_25328 -\n                                                               1];\n                }\n                if (!should_load_carry_27988) {\n                    x_23534 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_25328\n}\n__kernel void mainziscan_stage1_25366(__global int *global_failure,\n                                      __local",
                   " volatile\n                                      int64_t *scan_arr_mem_28214_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28212_backing_aligned_1,\n                                      int64_t res_23550, __global\n                                      unsigned char *mem_27744, __global\n                                      unsigned char *mem_27748, __global\n                                      unsigned char *mem_27750,\n                                      int32_t num_threads_28206)\n{\n    #define segscan_group_sizze_25361 (mainzisegscan_group_sizze_25360)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28214_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28214_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28212_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28212_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28207;\n    int32_t local_tid_28208;\n    int64_t group_sizze_28211;\n    int32_t wave_sizze_28210;\n    int32_t group_tid_28209;\n    \n    global_tid_28207 = get_global_id(0);\n    local_tid_28208 = get_local_id(0);\n    group_sizze_28211 = get_local_size(0);\n    wave_sizze_28210 = LOCKSTEP_WIDTH;\n    group_tid_28209 = get_group_id(0);\n    \n    int32_t phys_tid_25366;\n    \n    phys_tid_25366 = global_tid_28207;\n    \n    __local char *scan_arr_mem_28212;\n    __local char *scan_arr_mem_28214;\n    \n    scan_arr_mem_28212 = (__local char *) scan_arr_mem_28212_backing_0;\n    scan_arr_mem_28214 = (__local char *) scan_arr_mem_28214_backing_1;\n    \n    bool x_23569;\n    int64_t x_23570;\n    bool x_23571;\n    int64_t x_23572;\n    \n    x_23569 = 0;\n    x_23570 = 0;\n    for (int64_t j_28216 = 0; j_28216 < sdiv_up",
                   "64(res_23550,\n                                                  sext_i32_i64(num_threads_28206));\n         j_28216++) {\n        int64_t chunk_offset_28217 = segscan_group_sizze_25361 * j_28216 +\n                sext_i32_i64(group_tid_28209) * (segscan_group_sizze_25361 *\n                                                 sdiv_up64(res_23550,\n                                                           sext_i32_i64(num_threads_28206)));\n        int64_t flat_idx_28218 = chunk_offset_28217 +\n                sext_i32_i64(local_tid_28208);\n        int64_t gtid_25365 = flat_idx_28218;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_25365, res_23550)) {\n                int64_t x_23576 = ((__global int64_t *) mem_27744)[gtid_25365];\n                bool res_23577 = slt64(0, x_23576);\n                \n                // write to-scan values to parameters\n                {\n                    x_23571 = res_23577;\n                    x_23572 = x_23576;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_25365, res_23550)) {\n                    x_23571 = 0;\n                    x_23572 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_23573 = x_23569 || x_23571;\n                int64_t res_23574;\n                \n                if (x_23571) {\n                    res_23574 = x_23572;\n                } else {\n                    int64_t res_23575 = add64(x_23570, x_23572);\n                    \n                    res_23574 = res_23575;\n                }\n                ((__local\n                  bool *) scan_arr_mem_28212)[sext_i32_i64(local_tid_28208)] =\n                    res_23573;\n                ((__local",
                   "\n                  int64_t *) scan_arr_mem_28214)[sext_i32_i64(local_tid_28208)] =\n                    res_23574;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28219;\n            int64_t x_28220;\n            bool x_28221;\n            int64_t x_28222;\n            bool x_28226;\n            int64_t x_28227;\n            bool x_28228;\n            int64_t x_28229;\n            bool ltid_in_bounds_28233;\n            \n            ltid_in_bounds_28233 = slt64(sext_i32_i64(local_tid_28208),\n                                         segscan_group_sizze_25361);\n            \n            int32_t skip_threads_28234;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28233) {\n                    x_28221 = ((volatile __local\n                                bool *) scan_arr_mem_28212)[sext_i32_i64(local_tid_28208)];\n                    x_28222 = ((volatile __local\n                                int64_t *) scan_arr_mem_28214)[sext_i32_i64(local_tid_28208)];\n                    if ((local_tid_28208 - squot32(local_tid_28208, 32) * 32) ==\n                        0) {\n                        x_28219 = x_28221;\n                        x_28220 = x_28222;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28234 = 1;\n                while (slt32(skip_threads_28234, 32)) {\n                    if (sle32(skip_threads_28234, local_tid_28208 -\n                              squot32(local_tid_28208, 32) * 32) &&\n                        ltid_in_bounds_28233) {\n                        // read operands\n                        {\n                            x_28219 = ((volatile __local\n                                        bool *) scan_arr_mem_28212)[sext_i32_i64(local_tid_28208) -\n                                                                    sext_i32_i64(skip_threads_28234)];\n                    ",
                   "        x_28220 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28214)[sext_i32_i64(local_tid_28208) -\n                                                                       sext_i32_i64(skip_threads_28234)];\n                        }\n                        // perform operation\n                        {\n                            bool res_28223 = x_28219 || x_28221;\n                            int64_t res_28224;\n                            \n                            if (x_28221) {\n                                res_28224 = x_28222;\n                            } else {\n                                int64_t res_28225 = add64(x_28220, x_28222);\n                                \n                                res_28224 = res_28225;\n                            }\n                            x_28219 = res_28223;\n                            x_28220 = res_28224;\n                        }\n                    }\n                    if (sle32(wave_sizze_28210, skip_threads_28234)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28234, local_tid_28208 -\n                              squot32(local_tid_28208, 32) * 32) &&\n                        ltid_in_bounds_28233) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_28212)[sext_i32_i64(local_tid_28208)] =\n                                x_28219;\n                            x_28221 = x_28219;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28214)[sext_i32_i64(local_tid_28208)] =\n                                x_28220;\n                            x_28222 = x_28220;\n                        }\n                    }\n                    if (sle32(wave_sizze_28210, skip_threads_28234)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                 ",
                   "   }\n                    skip_threads_28234 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28208 - squot32(local_tid_28208, 32) * 32) ==\n                    31 && ltid_in_bounds_28233) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28212)[sext_i32_i64(squot32(local_tid_28208,\n                                                                       32))] =\n                        x_28219;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28214)[sext_i32_i64(squot32(local_tid_28208,\n                                                                          32))] =\n                        x_28220;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28235;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28208, 32) == 0 &&\n                        ltid_in_bounds_28233) {\n                        x_28228 = ((volatile __local\n                                    bool *) scan_arr_mem_28212)[sext_i32_i64(local_tid_28208)];\n                        x_28229 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28214)[sext_i32_i64(local_tid_28208)];\n                        if ((local_tid_28208 - squot32(local_tid_28208, 32) *\n                             32) == 0) {\n                            x_28226 = x_28228;\n                            x_28227 = x_28229;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28235 = 1;\n                    while (slt32(skip_threads_28235, 32",
                   ")) {\n                        if (sle32(skip_threads_28235, local_tid_28208 -\n                                  squot32(local_tid_28208, 32) * 32) &&\n                            (squot32(local_tid_28208, 32) == 0 &&\n                             ltid_in_bounds_28233)) {\n                            // read operands\n                            {\n                                x_28226 = ((volatile __local\n                                            bool *) scan_arr_mem_28212)[sext_i32_i64(local_tid_28208) -\n                                                                        sext_i32_i64(skip_threads_28235)];\n                                x_28227 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28214)[sext_i32_i64(local_tid_28208) -\n                                                                           sext_i32_i64(skip_threads_28235)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28230 = x_28226 || x_28228;\n                                int64_t res_28231;\n                                \n                                if (x_28228) {\n                                    res_28231 = x_28229;\n                                } else {\n                                    int64_t res_28232 = add64(x_28227, x_28229);\n                                    \n                                    res_28231 = res_28232;\n                                }\n                                x_28226 = res_28230;\n                                x_28227 = res_28231;\n                            }\n                        }\n                        if (sle32(wave_sizze_28210, skip_threads_28235)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28235, local_tid_28208 -\n                                  squot32(local_tid_28208, 32) * 32) &&\n                       ",
                   "     (squot32(local_tid_28208, 32) == 0 &&\n                             ltid_in_bounds_28233)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_28212)[sext_i32_i64(local_tid_28208)] =\n                                    x_28226;\n                                x_28228 = x_28226;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28214)[sext_i32_i64(local_tid_28208)] =\n                                    x_28227;\n                                x_28229 = x_28227;\n                            }\n                        }\n                        if (sle32(wave_sizze_28210, skip_threads_28235)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28235 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28208, 32) == 0 ||\n                      !ltid_in_bounds_28233)) {\n                    // read operands\n                    {\n                        x_28221 = x_28219;\n                        x_28222 = x_28220;\n                        x_28219 = ((__local\n                                    bool *) scan_arr_mem_28212)[sext_i32_i64(squot32(local_tid_28208,\n                                                                                     32)) -\n                                                                1];\n                        x_28220 = ((__local\n                                    int64_t *) scan_arr_mem_28214)[sext_i32_i64(squot32(local_tid_28208,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                ",
                   "    // perform operation\n                    {\n                        bool res_28223 = x_28219 || x_28221;\n                        int64_t res_28224;\n                        \n                        if (x_28221) {\n                            res_28224 = x_28222;\n                        } else {\n                            int64_t res_28225 = add64(x_28220, x_28222);\n                            \n                            res_28224 = res_28225;\n                        }\n                        x_28219 = res_28223;\n                        x_28220 = res_28224;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28212)[sext_i32_i64(local_tid_28208)] =\n                            x_28219;\n                        ((__local\n                          int64_t *) scan_arr_mem_28214)[sext_i32_i64(local_tid_28208)] =\n                            x_28220;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28208, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_28212)[sext_i32_i64(local_tid_28208)] =\n                        x_28221;\n                    ((__local\n                      int64_t *) scan_arr_mem_28214)[sext_i32_i64(local_tid_28208)] =\n                        x_28222;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_25365, res_23550)) {\n                    ((__global bool *) mem_27748)[gtid_25365] = ((__local\n                                                                  bool *) scan_arr_mem_28212)[sext_i32_i64(local_tid_28208)];\n                    ((__global int64_t *) mem_27750)[gtid_25365] = ((__local\n                                     ",
                   "                                int64_t *) scan_arr_mem_28214)[sext_i32_i64(local_tid_28208)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28236 = 0;\n                bool should_load_carry_28237 = local_tid_28208 == 0 &&\n                     !crosses_segment_28236;\n                \n                if (should_load_carry_28237) {\n                    x_23569 = ((__local\n                                bool *) scan_arr_mem_28212)[segscan_group_sizze_25361 -\n                                                            1];\n                    x_23570 = ((__local\n                                int64_t *) scan_arr_mem_28214)[segscan_group_sizze_25361 -\n                                                               1];\n                }\n                if (!should_load_carry_28237) {\n                    x_23569 = 0;\n                    x_23570 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_25361\n}\n__kernel void mainziscan_stage1_25374(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28281_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28279_backing_aligned_1,\n                                      int64_t res_23550, __global\n                                      unsigned char *mem_27750, __global\n                                      unsigned char *mem_27753, __global\n                                      unsigned char *mem_27755, __global\n                                      unsigned char *mem_27757,\n                                      int32_t num_threads_28273)\n{\n    #define segscan_group_sizze_25369 (mainzisegscan_group_sizze_253",
                   "68)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28281_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28281_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28279_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28279_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28274;\n    int32_t local_tid_28275;\n    int64_t group_sizze_28278;\n    int32_t wave_sizze_28277;\n    int32_t group_tid_28276;\n    \n    global_tid_28274 = get_global_id(0);\n    local_tid_28275 = get_local_id(0);\n    group_sizze_28278 = get_local_size(0);\n    wave_sizze_28277 = LOCKSTEP_WIDTH;\n    group_tid_28276 = get_group_id(0);\n    \n    int32_t phys_tid_25374;\n    \n    phys_tid_25374 = global_tid_28274;\n    \n    __local char *scan_arr_mem_28279;\n    __local char *scan_arr_mem_28281;\n    \n    scan_arr_mem_28279 = (__local char *) scan_arr_mem_28279_backing_0;\n    scan_arr_mem_28281 = (__local char *) scan_arr_mem_28281_backing_1;\n    \n    bool x_23609;\n    int64_t x_23610;\n    bool x_23611;\n    int64_t x_23612;\n    \n    x_23609 = 0;\n    x_23610 = 0;\n    for (int64_t j_28283 = 0; j_28283 < sdiv_up64(res_23550,\n                                                  sext_i32_i64(num_threads_28273));\n         j_28283++) {\n        int64_t chunk_offset_28284 = segscan_group_sizze_25369 * j_28283 +\n                sext_i32_i64(group_tid_28276) * (segscan_group_sizze_25369 *\n                                                 sdiv_up64(res_23550,\n                                                           sext_i32_i64(num_threads_28273)));\n        int64_t flat_idx_28285 = chunk_offset_28284 +\n                sext_i32_i64(local_tid_28275);\n        int64_t gtid_25373 = flat_idx_28285;\n        \n        // threads in bounds read input\n        {\n     ",
                   "       if (slt64(gtid_25373, res_23550)) {\n                int64_t x_23616 = ((__global int64_t *) mem_27750)[gtid_25373];\n                int64_t i_p_o_27551 = add64(-1, gtid_25373);\n                int64_t rot_i_27552 = smod64(i_p_o_27551, res_23550);\n                int64_t x_23617 = ((__global int64_t *) mem_27750)[rot_i_27552];\n                bool res_23619 = x_23616 == x_23617;\n                bool res_23620 = !res_23619;\n                \n                // write to-scan values to parameters\n                {\n                    x_23611 = res_23620;\n                    x_23612 = 1;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global bool *) mem_27757)[gtid_25373] = res_23620;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_25373, res_23550)) {\n                    x_23611 = 0;\n                    x_23612 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_23613 = x_23609 || x_23611;\n                int64_t res_23614;\n                \n                if (x_23611) {\n                    res_23614 = x_23612;\n                } else {\n                    int64_t res_23615 = add64(x_23610, x_23612);\n                    \n                    res_23614 = res_23615;\n                }\n                ((__local\n                  bool *) scan_arr_mem_28279)[sext_i32_i64(local_tid_28275)] =\n                    res_23613;\n                ((__local\n                  int64_t *) scan_arr_mem_28281)[sext_i32_i64(local_tid_28275)] =\n                    res_23614;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28286;\n            int64_t x_28287;\n            bool x_28288;\n            int64_t x_28289;\n          ",
                   "  bool x_28293;\n            int64_t x_28294;\n            bool x_28295;\n            int64_t x_28296;\n            bool ltid_in_bounds_28300;\n            \n            ltid_in_bounds_28300 = slt64(sext_i32_i64(local_tid_28275),\n                                         segscan_group_sizze_25369);\n            \n            int32_t skip_threads_28301;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28300) {\n                    x_28288 = ((volatile __local\n                                bool *) scan_arr_mem_28279)[sext_i32_i64(local_tid_28275)];\n                    x_28289 = ((volatile __local\n                                int64_t *) scan_arr_mem_28281)[sext_i32_i64(local_tid_28275)];\n                    if ((local_tid_28275 - squot32(local_tid_28275, 32) * 32) ==\n                        0) {\n                        x_28286 = x_28288;\n                        x_28287 = x_28289;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28301 = 1;\n                while (slt32(skip_threads_28301, 32)) {\n                    if (sle32(skip_threads_28301, local_tid_28275 -\n                              squot32(local_tid_28275, 32) * 32) &&\n                        ltid_in_bounds_28300) {\n                        // read operands\n                        {\n                            x_28286 = ((volatile __local\n                                        bool *) scan_arr_mem_28279)[sext_i32_i64(local_tid_28275) -\n                                                                    sext_i32_i64(skip_threads_28301)];\n                            x_28287 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28281)[sext_i32_i64(local_tid_28275) -\n                                                                       sext_i32_i64(skip_threads_28301)];\n                        }\n                        // perf",
                   "orm operation\n                        {\n                            bool res_28290 = x_28286 || x_28288;\n                            int64_t res_28291;\n                            \n                            if (x_28288) {\n                                res_28291 = x_28289;\n                            } else {\n                                int64_t res_28292 = add64(x_28287, x_28289);\n                                \n                                res_28291 = res_28292;\n                            }\n                            x_28286 = res_28290;\n                            x_28287 = res_28291;\n                        }\n                    }\n                    if (sle32(wave_sizze_28277, skip_threads_28301)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28301, local_tid_28275 -\n                              squot32(local_tid_28275, 32) * 32) &&\n                        ltid_in_bounds_28300) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_28279)[sext_i32_i64(local_tid_28275)] =\n                                x_28286;\n                            x_28288 = x_28286;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28281)[sext_i32_i64(local_tid_28275)] =\n                                x_28287;\n                            x_28289 = x_28287;\n                        }\n                    }\n                    if (sle32(wave_sizze_28277, skip_threads_28301)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28301 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28275 - squot32(local_tid_28275, 32) * 32) ==\n                ",
                   "    31 && ltid_in_bounds_28300) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28279)[sext_i32_i64(squot32(local_tid_28275,\n                                                                       32))] =\n                        x_28286;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28281)[sext_i32_i64(squot32(local_tid_28275,\n                                                                          32))] =\n                        x_28287;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28302;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28275, 32) == 0 &&\n                        ltid_in_bounds_28300) {\n                        x_28295 = ((volatile __local\n                                    bool *) scan_arr_mem_28279)[sext_i32_i64(local_tid_28275)];\n                        x_28296 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28281)[sext_i32_i64(local_tid_28275)];\n                        if ((local_tid_28275 - squot32(local_tid_28275, 32) *\n                             32) == 0) {\n                            x_28293 = x_28295;\n                            x_28294 = x_28296;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28302 = 1;\n                    while (slt32(skip_threads_28302, 32)) {\n                        if (sle32(skip_threads_28302, local_tid_28275 -\n                                  squot32(local_tid_28275, 32) * 32) &&\n                            (squot32(local_tid_28275, 32) == 0 &&\n                             ltid_in_bounds_28300)) {\n                            // rea",
                   "d operands\n                            {\n                                x_28293 = ((volatile __local\n                                            bool *) scan_arr_mem_28279)[sext_i32_i64(local_tid_28275) -\n                                                                        sext_i32_i64(skip_threads_28302)];\n                                x_28294 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28281)[sext_i32_i64(local_tid_28275) -\n                                                                           sext_i32_i64(skip_threads_28302)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28297 = x_28293 || x_28295;\n                                int64_t res_28298;\n                                \n                                if (x_28295) {\n                                    res_28298 = x_28296;\n                                } else {\n                                    int64_t res_28299 = add64(x_28294, x_28296);\n                                    \n                                    res_28298 = res_28299;\n                                }\n                                x_28293 = res_28297;\n                                x_28294 = res_28298;\n                            }\n                        }\n                        if (sle32(wave_sizze_28277, skip_threads_28302)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28302, local_tid_28275 -\n                                  squot32(local_tid_28275, 32) * 32) &&\n                            (squot32(local_tid_28275, 32) == 0 &&\n                             ltid_in_bounds_28300)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_28279)[sext_i32_i64(local_",
                   "tid_28275)] =\n                                    x_28293;\n                                x_28295 = x_28293;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28281)[sext_i32_i64(local_tid_28275)] =\n                                    x_28294;\n                                x_28296 = x_28294;\n                            }\n                        }\n                        if (sle32(wave_sizze_28277, skip_threads_28302)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28302 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28275, 32) == 0 ||\n                      !ltid_in_bounds_28300)) {\n                    // read operands\n                    {\n                        x_28288 = x_28286;\n                        x_28289 = x_28287;\n                        x_28286 = ((__local\n                                    bool *) scan_arr_mem_28279)[sext_i32_i64(squot32(local_tid_28275,\n                                                                                     32)) -\n                                                                1];\n                        x_28287 = ((__local\n                                    int64_t *) scan_arr_mem_28281)[sext_i32_i64(squot32(local_tid_28275,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        bool res_28290 = x_28286 || x_28288;\n                        int64_t res_28291;\n                        \n                        if (x_28288) {\n                            res_28291 = x_28289;\n                        } else {\n      ",
                   "                      int64_t res_28292 = add64(x_28287, x_28289);\n                            \n                            res_28291 = res_28292;\n                        }\n                        x_28286 = res_28290;\n                        x_28287 = res_28291;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28279)[sext_i32_i64(local_tid_28275)] =\n                            x_28286;\n                        ((__local\n                          int64_t *) scan_arr_mem_28281)[sext_i32_i64(local_tid_28275)] =\n                            x_28287;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28275, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_28279)[sext_i32_i64(local_tid_28275)] =\n                        x_28288;\n                    ((__local\n                      int64_t *) scan_arr_mem_28281)[sext_i32_i64(local_tid_28275)] =\n                        x_28289;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_25373, res_23550)) {\n                    ((__global bool *) mem_27753)[gtid_25373] = ((__local\n                                                                  bool *) scan_arr_mem_28279)[sext_i32_i64(local_tid_28275)];\n                    ((__global int64_t *) mem_27755)[gtid_25373] = ((__local\n                                                                     int64_t *) scan_arr_mem_28281)[sext_i32_i64(local_tid_28275)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28303",
                   " = 0;\n                bool should_load_carry_28304 = local_tid_28275 == 0 &&\n                     !crosses_segment_28303;\n                \n                if (should_load_carry_28304) {\n                    x_23609 = ((__local\n                                bool *) scan_arr_mem_28279)[segscan_group_sizze_25369 -\n                                                            1];\n                    x_23610 = ((__local\n                                int64_t *) scan_arr_mem_28281)[segscan_group_sizze_25369 -\n                                                               1];\n                }\n                if (!should_load_carry_28304) {\n                    x_23609 = 0;\n                    x_23610 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_25369\n}\n__kernel void mainziscan_stage1_25382(__global int *global_failure,\n                                      int failure_is_an_option, __global\n                                      int64_t *global_failure_args,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28348_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28346_backing_aligned_1,\n                                      int64_t n_23343, int64_t steps_23347,\n                                      float a_23351, float b_23352,\n                                      float sigma_23353, int64_t res_23550,\n                                      int64_t one_intra_par_min_24642, __global\n                                      unsigned char *res_mem_27657, __global\n                                      unsigned char *res_mem_27658, __global\n                                      unsigned char *res_mem_27659, __global\n                                      unsigned char *res_mem_27660,\n                                      int64_t b",
                   "inop_x_27689, __global\n                                      unsigned char *res_mem_27733, __global\n                                      unsigned char *res_mem_27734, __global\n                                      unsigned char *mem_27750, __global\n                                      unsigned char *mem_27755, __global\n                                      unsigned char *mem_27757, __global\n                                      unsigned char *mem_27760, __global\n                                      unsigned char *mem_27762,\n                                      int32_t num_threads_28340)\n{\n    #define segscan_group_sizze_25377 (mainzisegscan_group_sizze_25376)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28348_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28348_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28346_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28346_backing_aligned_1;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_28341;\n    int32_t local_tid_28342;\n    int64_t group_sizze_28345;\n    int32_t wave_sizze_28344;\n    int32_t group_tid_28343;\n    \n    global_tid_28341 = get_global_id(0);\n    local_tid_28342 = get_local_id(0);\n    group_sizze_28345 = get_local_size(0);\n    wave_sizze_28344 = LOCKSTEP_WIDTH;\n    group_tid_28343 = get_group_id(0);\n    \n    int32_t phys_tid_25382;\n    \n    phys_tid_25382 = global_tid_28341;\n    \n    __local char *scan_arr_mem_28346;\n    __local char *scan_arr_mem_28348;\n    \n    scan_arr_mem_28346 = (__local char *) scan_arr_mem_28346_backing_0;\n    scan_arr_mem_28348 = (__local",
                   " char *) scan_arr_mem_28348_backing_1;\n    \n    bool x_23635;\n    float x_23636;\n    bool x_23637;\n    float x_23638;\n    \n    x_23635 = 0;\n    x_23636 = 0.0F;\n    for (int64_t j_28350 = 0; j_28350 < sdiv_up64(res_23550,\n                                                  sext_i32_i64(num_threads_28340));\n         j_28350++) {\n        int64_t chunk_offset_28351 = segscan_group_sizze_25377 * j_28350 +\n                sext_i32_i64(group_tid_28343) * (segscan_group_sizze_25377 *\n                                                 sdiv_up64(res_23550,\n                                                           sext_i32_i64(num_threads_28340)));\n        int64_t flat_idx_28352 = chunk_offset_28351 +\n                sext_i32_i64(local_tid_28342);\n        int64_t gtid_25381 = flat_idx_28352;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_25381, res_23550)) {\n                int64_t x_23643 = ((__global int64_t *) mem_27755)[gtid_25381];\n                int64_t x_23644 = ((__global int64_t *) mem_27750)[gtid_25381];\n                bool x_23645 = ((__global bool *) mem_27757)[gtid_25381];\n                int64_t res_23648 = sub64(x_23643, 1);\n                bool x_23649 = sle64(0, x_23644);\n                bool y_23650 = slt64(x_23644, binop_x_27689);\n                bool bounds_check_23651 = x_23649 && y_23650;\n                bool index_certs_23652;\n                \n                if (!bounds_check_23651) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 8) ==\n                            -1) {\n                            global_failure_args[0] = x_23644;\n                            global_failure_args[1] = binop_x_27689;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t new_index_23653 = squot64(x_23644,\n                   ",
                   "                               one_intra_par_min_24642);\n                int64_t binop_y_23654 = new_index_23653 *\n                        one_intra_par_min_24642;\n                int64_t binop_x_23655 = x_23644 - binop_y_23654;\n                int64_t new_index_23656 = squot64(binop_x_23655, n_23343);\n                int64_t binop_y_23657 = n_23343 * new_index_23656;\n                int64_t new_index_23658 = binop_x_23655 - binop_y_23657;\n                int64_t lifted_0_get_arg_23662 = ((__global\n                                                   int64_t *) res_mem_27659)[new_index_23658];\n                float lifted_0_get_arg_23663 = ((__global\n                                                 float *) res_mem_27660)[new_index_23658];\n                float lifted_0_get_arg_23664 = ((__global\n                                                 float *) res_mem_27734)[new_index_23653 *\n                                                                         (n_23343 *\n                                                                          steps_23347) +\n                                                                         new_index_23656 *\n                                                                         n_23343 +\n                                                                         new_index_23658];\n                float x_23665 = lifted_0_get_arg_23664 / lifted_0_get_arg_23663;\n                float ceil_arg_23666 = x_23665 - 1.0F;\n                float res_23667;\n                \n                res_23667 = futrts_ceil32(ceil_arg_23666);\n                \n                int64_t res_23668 = fptosi_f32_i64(res_23667);\n                int64_t max_arg_23669 = sub64(lifted_0_get_arg_23662,\n                                              res_23668);\n                int64_t res_23670 = smax64(0, max_arg_23669);\n                bool cond_23671 = res_23670 == 0;\n                float res_23672;\n                \n                if (cond_23671) {\n                ",
                   "    res_23672 = 0.0F;\n                } else {\n                    float lifted_0_get_arg_23659 = ((__global\n                                                     float *) res_mem_27733)[new_index_23653 *\n                                                                             (n_23343 *\n                                                                              steps_23347) +\n                                                                             new_index_23656 *\n                                                                             n_23343 +\n                                                                             new_index_23658];\n                    float lifted_0_get_arg_23660 = ((__global\n                                                     float *) res_mem_27657)[new_index_23658];\n                    float lifted_0_get_arg_23661 = ((__global\n                                                     float *) res_mem_27658)[new_index_23658];\n                    float res_23673;\n                    \n                    res_23673 = futrts_ceil32(x_23665);\n                    \n                    float start_23674 = lifted_0_get_arg_23663 * res_23673;\n                    float res_23675;\n                    \n                    res_23675 = futrts_ceil32(ceil_arg_23666);\n                    \n                    int64_t res_23676 = fptosi_f32_i64(res_23675);\n                    int64_t max_arg_23677 = sub64(lifted_0_get_arg_23662,\n                                                  res_23676);\n                    int64_t res_23678 = smax64(0, max_arg_23677);\n                    int64_t sizze_23679 = sub64(res_23678, 1);\n                    bool cond_23680 = res_23648 == 0;\n                    float res_23681;\n                    \n                    if (cond_23680) {\n                        res_23681 = 1.0F;\n                    } else {\n                        res_23681 = 0.0F;\n                    }\n                    \n                    bool cond_236",
                   "82 = slt64(0, res_23648);\n                    float res_23683;\n                    \n                    if (cond_23682) {\n                        float y_23684 = lifted_0_get_arg_23660 *\n                              lifted_0_get_arg_23663;\n                        float res_23685 = res_23681 - y_23684;\n                        \n                        res_23683 = res_23685;\n                    } else {\n                        res_23683 = res_23681;\n                    }\n                    \n                    bool cond_23686 = res_23648 == sizze_23679;\n                    float res_23687;\n                    \n                    if (cond_23686) {\n                        float res_23688 = res_23683 - 1.0F;\n                        \n                        res_23687 = res_23688;\n                    } else {\n                        res_23687 = res_23683;\n                    }\n                    \n                    float res_23689 = lifted_0_get_arg_23661 * res_23687;\n                    float res_23690 = sitofp_i64_f32(res_23648);\n                    float y_23691 = lifted_0_get_arg_23663 * res_23690;\n                    float bondprice_arg_23692 = start_23674 + y_23691;\n                    float y_23693 = bondprice_arg_23692 -\n                          lifted_0_get_arg_23664;\n                    float negate_arg_23694 = a_23351 * y_23693;\n                    float exp_arg_23695 = 0.0F - negate_arg_23694;\n                    float res_23696 = fpow32(2.7182817F, exp_arg_23695);\n                    float x_23697 = 1.0F - res_23696;\n                    float B_23698 = x_23697 / a_23351;\n                    float x_23699 = B_23698 - bondprice_arg_23692;\n                    float x_23700 = lifted_0_get_arg_23664 + x_23699;\n                    float x_23701 = fpow32(a_23351, 2.0F);\n                    float x_23702 = b_23352 * x_23701;\n                    float x_23703 = fpow32(sigma_23353, 2.0F);\n                    float y_23704 = x_23703 / 2.0F;\n                    float",
                   " y_23705 = x_23702 - y_23704;\n                    float x_23706 = x_23700 * y_23705;\n                    float A1_23707 = x_23706 / x_23701;\n                    float y_23708 = fpow32(B_23698, 2.0F);\n                    float x_23709 = x_23703 * y_23708;\n                    float y_23710 = 4.0F * a_23351;\n                    float A2_23711 = x_23709 / y_23710;\n                    float exp_arg_23712 = A1_23707 - A2_23711;\n                    float res_23713 = fpow32(2.7182817F, exp_arg_23712);\n                    float negate_arg_23714 = lifted_0_get_arg_23659 * B_23698;\n                    float exp_arg_23715 = 0.0F - negate_arg_23714;\n                    float res_23716 = fpow32(2.7182817F, exp_arg_23715);\n                    float res_23717 = res_23713 * res_23716;\n                    float res_23718 = res_23689 * res_23717;\n                    \n                    res_23672 = res_23718;\n                }\n                // write to-scan values to parameters\n                {\n                    x_23637 = x_23645;\n                    x_23638 = res_23672;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_25381, res_23550)) {\n                    x_23637 = 0;\n                    x_23638 = 0.0F;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_23639 = x_23635 || x_23637;\n                float res_23640;\n                \n                if (x_23637) {\n                    res_23640 = x_23638;\n                } else {\n                    float res_23641 = x_23636 + x_23638;\n                    \n                    res_23640 = res_23641;\n                }\n                ((__local\n                  bool *) scan_arr_mem_28346)[sext_i32_i64",
                   "(local_tid_28342)] =\n                    res_23639;\n                ((__local\n                  float *) scan_arr_mem_28348)[sext_i32_i64(local_tid_28342)] =\n                    res_23640;\n            }\n            \n          error_0:\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_failure)\n                return;\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28353;\n            float x_28354;\n            bool x_28355;\n            float x_28356;\n            bool x_28360;\n            float x_28361;\n            bool x_28362;\n            float x_28363;\n            bool ltid_in_bounds_28367;\n            \n            ltid_in_bounds_28367 = slt64(sext_i32_i64(local_tid_28342),\n                                         segscan_group_sizze_25377);\n            \n            int32_t skip_threads_28368;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28367) {\n                    x_28355 = ((volatile __local\n                                bool *) scan_arr_mem_28346)[sext_i32_i64(local_tid_28342)];\n                    x_28356 = ((volatile __local\n                                float *) scan_arr_mem_28348)[sext_i32_i64(local_tid_28342)];\n                    if ((local_tid_28342 - squot32(local_tid_28342, 32) * 32) ==\n                        0) {\n                        x_28353 = x_28355;\n                        x_28354 = x_28356;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28368 = 1;\n                while (slt32(skip_threads_28368, 32)) {\n                    if (sle32(skip_threads_28368, local_tid_28342 -\n                              squot32(local_tid_28342, 32) * 32) &&\n                        ltid_in_bounds_28367) {\n                        // read operands\n                        {\n                            x_28353 = ((volatile __local\n                             ",
                   "           bool *) scan_arr_mem_28346)[sext_i32_i64(local_tid_28342) -\n                                                                    sext_i32_i64(skip_threads_28368)];\n                            x_28354 = ((volatile __local\n                                        float *) scan_arr_mem_28348)[sext_i32_i64(local_tid_28342) -\n                                                                     sext_i32_i64(skip_threads_28368)];\n                        }\n                        // perform operation\n                        {\n                            bool res_28357 = x_28353 || x_28355;\n                            float res_28358;\n                            \n                            if (x_28355) {\n                                res_28358 = x_28356;\n                            } else {\n                                float res_28359 = x_28354 + x_28356;\n                                \n                                res_28358 = res_28359;\n                            }\n                            x_28353 = res_28357;\n                            x_28354 = res_28358;\n                        }\n                    }\n                    if (sle32(wave_sizze_28344, skip_threads_28368)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28368, local_tid_28342 -\n                              squot32(local_tid_28342, 32) * 32) &&\n                        ltid_in_bounds_28367) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_28346)[sext_i32_i64(local_tid_28342)] =\n                                x_28353;\n                            x_28355 = x_28353;\n                            ((volatile __local\n                              float *) scan_arr_mem_28348)[sext_i32_i64(local_tid_28342)] =\n                                x_28354;\n                            x_28356 = x_28354;\n            ",
                   "            }\n                    }\n                    if (sle32(wave_sizze_28344, skip_threads_28368)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28368 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28342 - squot32(local_tid_28342, 32) * 32) ==\n                    31 && ltid_in_bounds_28367) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28346)[sext_i32_i64(squot32(local_tid_28342,\n                                                                       32))] =\n                        x_28353;\n                    ((volatile __local\n                      float *) scan_arr_mem_28348)[sext_i32_i64(squot32(local_tid_28342,\n                                                                        32))] =\n                        x_28354;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28369;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28342, 32) == 0 &&\n                        ltid_in_bounds_28367) {\n                        x_28362 = ((volatile __local\n                                    bool *) scan_arr_mem_28346)[sext_i32_i64(local_tid_28342)];\n                        x_28363 = ((volatile __local\n                                    float *) scan_arr_mem_28348)[sext_i32_i64(local_tid_28342)];\n                        if ((local_tid_28342 - squot32(local_tid_28342, 32) *\n                             32) == 0) {\n                            x_28360 = x_28362;\n                            x_28361 = x_28363;\n                        }\n                    }\n                }\n         ",
                   "       // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28369 = 1;\n                    while (slt32(skip_threads_28369, 32)) {\n                        if (sle32(skip_threads_28369, local_tid_28342 -\n                                  squot32(local_tid_28342, 32) * 32) &&\n                            (squot32(local_tid_28342, 32) == 0 &&\n                             ltid_in_bounds_28367)) {\n                            // read operands\n                            {\n                                x_28360 = ((volatile __local\n                                            bool *) scan_arr_mem_28346)[sext_i32_i64(local_tid_28342) -\n                                                                        sext_i32_i64(skip_threads_28369)];\n                                x_28361 = ((volatile __local\n                                            float *) scan_arr_mem_28348)[sext_i32_i64(local_tid_28342) -\n                                                                         sext_i32_i64(skip_threads_28369)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28364 = x_28360 || x_28362;\n                                float res_28365;\n                                \n                                if (x_28362) {\n                                    res_28365 = x_28363;\n                                } else {\n                                    float res_28366 = x_28361 + x_28363;\n                                    \n                                    res_28365 = res_28366;\n                                }\n                                x_28360 = res_28364;\n                                x_28361 = res_28365;\n                            }\n                        }\n                        if (sle32(wave_sizze_28344, skip_threads_28369)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n         ",
                   "               if (sle32(skip_threads_28369, local_tid_28342 -\n                                  squot32(local_tid_28342, 32) * 32) &&\n                            (squot32(local_tid_28342, 32) == 0 &&\n                             ltid_in_bounds_28367)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_28346)[sext_i32_i64(local_tid_28342)] =\n                                    x_28360;\n                                x_28362 = x_28360;\n                                ((volatile __local\n                                  float *) scan_arr_mem_28348)[sext_i32_i64(local_tid_28342)] =\n                                    x_28361;\n                                x_28363 = x_28361;\n                            }\n                        }\n                        if (sle32(wave_sizze_28344, skip_threads_28369)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28369 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28342, 32) == 0 ||\n                      !ltid_in_bounds_28367)) {\n                    // read operands\n                    {\n                        x_28355 = x_28353;\n                        x_28356 = x_28354;\n                        x_28353 = ((__local\n                                    bool *) scan_arr_mem_28346)[sext_i32_i64(squot32(local_tid_28342,\n                                                                                     32)) -\n                                                                1];\n                        x_28354 = ((__local\n                                    float *) scan_arr_mem_28348)[sext_i32_i64(squot32(local_tid_28342,\n                                                  ",
                   "                                    32)) -\n                                                                 1];\n                    }\n                    // perform operation\n                    {\n                        bool res_28357 = x_28353 || x_28355;\n                        float res_28358;\n                        \n                        if (x_28355) {\n                            res_28358 = x_28356;\n                        } else {\n                            float res_28359 = x_28354 + x_28356;\n                            \n                            res_28358 = res_28359;\n                        }\n                        x_28353 = res_28357;\n                        x_28354 = res_28358;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28346)[sext_i32_i64(local_tid_28342)] =\n                            x_28353;\n                        ((__local\n                          float *) scan_arr_mem_28348)[sext_i32_i64(local_tid_28342)] =\n                            x_28354;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28342, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_28346)[sext_i32_i64(local_tid_28342)] =\n                        x_28355;\n                    ((__local\n                      float *) scan_arr_mem_28348)[sext_i32_i64(local_tid_28342)] =\n                        x_28356;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_25381, res_23550)) {\n                    ((__global bool *) mem_27760)[gtid_25381] = ((__local\n                                                                  bool *) scan_arr_mem_28346)[sext_i32_i",
                   "64(local_tid_28342)];\n                    ((__global float *) mem_27762)[gtid_25381] = ((__local\n                                                                   float *) scan_arr_mem_28348)[sext_i32_i64(local_tid_28342)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28370 = 0;\n                bool should_load_carry_28371 = local_tid_28342 == 0 &&\n                     !crosses_segment_28370;\n                \n                if (should_load_carry_28371) {\n                    x_23635 = ((__local\n                                bool *) scan_arr_mem_28346)[segscan_group_sizze_25377 -\n                                                            1];\n                    x_23636 = ((__local\n                                float *) scan_arr_mem_28348)[segscan_group_sizze_25377 -\n                                                             1];\n                }\n                if (!should_load_carry_28371) {\n                    x_23635 = 0;\n                    x_23636 = 0.0F;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_25377\n}\n__kernel void mainziscan_stage1_25434(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28413_backing_aligned_0,\n                                      int64_t res_23550, __global\n                                      unsigned char *mem_27757, __global\n                                      unsigned char *mem_27765,\n                                      int32_t num_threads_28407)\n{\n    #define segscan_group_sizze_25429 (mainzisegscan_group_sizze_25428)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28413_bac",
                   "king_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28413_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28408;\n    int32_t local_tid_28409;\n    int64_t group_sizze_28412;\n    int32_t wave_sizze_28411;\n    int32_t group_tid_28410;\n    \n    global_tid_28408 = get_global_id(0);\n    local_tid_28409 = get_local_id(0);\n    group_sizze_28412 = get_local_size(0);\n    wave_sizze_28411 = LOCKSTEP_WIDTH;\n    group_tid_28410 = get_group_id(0);\n    \n    int32_t phys_tid_25434;\n    \n    phys_tid_25434 = global_tid_28408;\n    \n    __local char *scan_arr_mem_28413;\n    \n    scan_arr_mem_28413 = (__local char *) scan_arr_mem_28413_backing_0;\n    \n    int64_t x_23742;\n    int64_t x_23743;\n    \n    x_23742 = 0;\n    for (int64_t j_28415 = 0; j_28415 < sdiv_up64(res_23550,\n                                                  sext_i32_i64(num_threads_28407));\n         j_28415++) {\n        int64_t chunk_offset_28416 = segscan_group_sizze_25429 * j_28415 +\n                sext_i32_i64(group_tid_28410) * (segscan_group_sizze_25429 *\n                                                 sdiv_up64(res_23550,\n                                                           sext_i32_i64(num_threads_28407)));\n        int64_t flat_idx_28417 = chunk_offset_28416 +\n                sext_i32_i64(local_tid_28409);\n        int64_t gtid_25433 = flat_idx_28417;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_25433, res_23550)) {\n                int64_t i_p_o_27553 = add64(1, gtid_25433);\n                int64_t rot_i_27554 = smod64(i_p_o_27553, res_23550);\n                bool x_23745 = ((__global bool *) mem_27757)[rot_i_27554];\n                int64_t res_23746 = btoi_bool_i64(x_23745);\n                \n                // write to-scan values to parameters\n                {\n                    x_23743 = res_23746;\n                }\n                // write mapped values results t",
                   "o global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_25433, res_23550)) {\n                    x_23743 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_23744 = add64(x_23742, x_23743);\n                \n                ((__local\n                  int64_t *) scan_arr_mem_28413)[sext_i32_i64(local_tid_28409)] =\n                    res_23744;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_28418;\n            int64_t x_28419;\n            int64_t x_28421;\n            int64_t x_28422;\n            bool ltid_in_bounds_28424;\n            \n            ltid_in_bounds_28424 = slt64(sext_i32_i64(local_tid_28409),\n                                         segscan_group_sizze_25429);\n            \n            int32_t skip_threads_28425;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28424) {\n                    x_28419 = ((volatile __local\n                                int64_t *) scan_arr_mem_28413)[sext_i32_i64(local_tid_28409)];\n                    if ((local_tid_28409 - squot32(local_tid_28409, 32) * 32) ==\n                        0) {\n                        x_28418 = x_28419;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28425 = 1;\n                while (slt32(skip_threads_28425, 32)) {\n                    if (sle32(skip_threads_28425, local_tid_28409 -\n                              squot32(local_tid_28409, 32) * 32) &&\n                        ltid_in_bounds_28424) {\n                        // read operands\n                        {\n                            x_28418 = ((volatile __local\n       ",
                   "                                 int64_t *) scan_arr_mem_28413)[sext_i32_i64(local_tid_28409) -\n                                                                       sext_i32_i64(skip_threads_28425)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_28420 = add64(x_28418, x_28419);\n                            \n                            x_28418 = res_28420;\n                        }\n                    }\n                    if (sle32(wave_sizze_28411, skip_threads_28425)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28425, local_tid_28409 -\n                              squot32(local_tid_28409, 32) * 32) &&\n                        ltid_in_bounds_28424) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28413)[sext_i32_i64(local_tid_28409)] =\n                                x_28418;\n                            x_28419 = x_28418;\n                        }\n                    }\n                    if (sle32(wave_sizze_28411, skip_threads_28425)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28425 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28409 - squot32(local_tid_28409, 32) * 32) ==\n                    31 && ltid_in_bounds_28424) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28413)[sext_i32_i64(squot32(local_tid_28409,\n                                                                          32))] =\n                        x_28418;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first ",
                   "block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28426;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28409, 32) == 0 &&\n                        ltid_in_bounds_28424) {\n                        x_28422 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28413)[sext_i32_i64(local_tid_28409)];\n                        if ((local_tid_28409 - squot32(local_tid_28409, 32) *\n                             32) == 0) {\n                            x_28421 = x_28422;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28426 = 1;\n                    while (slt32(skip_threads_28426, 32)) {\n                        if (sle32(skip_threads_28426, local_tid_28409 -\n                                  squot32(local_tid_28409, 32) * 32) &&\n                            (squot32(local_tid_28409, 32) == 0 &&\n                             ltid_in_bounds_28424)) {\n                            // read operands\n                            {\n                                x_28421 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28413)[sext_i32_i64(local_tid_28409) -\n                                                                           sext_i32_i64(skip_threads_28426)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_28423 = add64(x_28421, x_28422);\n                                \n                                x_28421 = res_28423;\n                            }\n                        }\n                        if (sle32(wave_sizze_28411, skip_threads_28426)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n            ",
                   "            if (sle32(skip_threads_28426, local_tid_28409 -\n                                  squot32(local_tid_28409, 32) * 32) &&\n                            (squot32(local_tid_28409, 32) == 0 &&\n                             ltid_in_bounds_28424)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28413)[sext_i32_i64(local_tid_28409)] =\n                                    x_28421;\n                                x_28422 = x_28421;\n                            }\n                        }\n                        if (sle32(wave_sizze_28411, skip_threads_28426)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28426 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28409, 32) == 0 ||\n                      !ltid_in_bounds_28424)) {\n                    // read operands\n                    {\n                        x_28419 = x_28418;\n                        x_28418 = ((__local\n                                    int64_t *) scan_arr_mem_28413)[sext_i32_i64(squot32(local_tid_28409,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28420 = add64(x_28418, x_28419);\n                        \n                        x_28418 = res_28420;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_28413)[sext_i32_i64(local_tid_28409)] =\n                            x_28418;\n   ",
                   "                 }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28409, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_28413)[sext_i32_i64(local_tid_28409)] =\n                        x_28419;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_25433, res_23550)) {\n                    ((__global int64_t *) mem_27765)[gtid_25433] = ((__local\n                                                                     int64_t *) scan_arr_mem_28413)[sext_i32_i64(local_tid_28409)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28427 = 0;\n                bool should_load_carry_28428 = local_tid_28409 == 0 &&\n                     !crosses_segment_28427;\n                \n                if (should_load_carry_28428) {\n                    x_23742 = ((__local\n                                int64_t *) scan_arr_mem_28413)[segscan_group_sizze_25429 -\n                                                               1];\n                }\n                if (!should_load_carry_28428) {\n                    x_23742 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_25429\n}\n__kernel void mainziscan_stage2_25333(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_27994_backing_aligned_0,\n                                      int64_t binop_x_27689, __global\n                                      unsigned char *mem_27737,\n                                   ",
                   "   int64_t stage1_num_groups_27966,\n                                      int32_t num_threads_27967)\n{\n    #define segscan_group_sizze_25328 (mainzisegscan_group_sizze_25327)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_27994_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_27994_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27989;\n    int32_t local_tid_27990;\n    int64_t group_sizze_27993;\n    int32_t wave_sizze_27992;\n    int32_t group_tid_27991;\n    \n    global_tid_27989 = get_global_id(0);\n    local_tid_27990 = get_local_id(0);\n    group_sizze_27993 = get_local_size(0);\n    wave_sizze_27992 = LOCKSTEP_WIDTH;\n    group_tid_27991 = get_group_id(0);\n    \n    int32_t phys_tid_25333;\n    \n    phys_tid_25333 = global_tid_27989;\n    \n    __local char *scan_arr_mem_27994;\n    \n    scan_arr_mem_27994 = (__local char *) scan_arr_mem_27994_backing_0;\n    \n    int64_t flat_idx_27996;\n    \n    flat_idx_27996 = (sext_i32_i64(local_tid_27990) + 1) *\n        (segscan_group_sizze_25328 * sdiv_up64(binop_x_27689,\n                                               sext_i32_i64(num_threads_27967))) -\n        1;\n    \n    int64_t gtid_25332;\n    \n    gtid_25332 = flat_idx_27996;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_25332, binop_x_27689)) {\n            ((__local\n              int64_t *) scan_arr_mem_27994)[sext_i32_i64(local_tid_27990)] =\n                ((__global int64_t *) mem_27737)[gtid_25332];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_27994)[sext_i32_i64(local_tid_27990)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_23534;\n    int64_t x_23535;\n    int64_t x_27997;\n    int64_t x_27998;\n    bool ltid_in_bounds_28000;\n    \n    ltid_in_bounds_28000 = slt64(sext_i32_",
                   "i64(local_tid_27990),\n                                 stage1_num_groups_27966);\n    \n    int32_t skip_threads_28001;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28000) {\n            x_23535 = ((volatile __local\n                        int64_t *) scan_arr_mem_27994)[sext_i32_i64(local_tid_27990)];\n            if ((local_tid_27990 - squot32(local_tid_27990, 32) * 32) == 0) {\n                x_23534 = x_23535;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28001 = 1;\n        while (slt32(skip_threads_28001, 32)) {\n            if (sle32(skip_threads_28001, local_tid_27990 -\n                      squot32(local_tid_27990, 32) * 32) &&\n                ltid_in_bounds_28000) {\n                // read operands\n                {\n                    x_23534 = ((volatile __local\n                                int64_t *) scan_arr_mem_27994)[sext_i32_i64(local_tid_27990) -\n                                                               sext_i32_i64(skip_threads_28001)];\n                }\n                // perform operation\n                {\n                    int64_t res_23536 = add64(x_23534, x_23535);\n                    \n                    x_23534 = res_23536;\n                }\n            }\n            if (sle32(wave_sizze_27992, skip_threads_28001)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28001, local_tid_27990 -\n                      squot32(local_tid_27990, 32) * 32) &&\n                ltid_in_bounds_28000) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_27994)[sext_i32_i64(local_tid_27990)] =\n                        x_23534;\n                    x_23535 = x_23534;\n                }\n            }\n            if (sle32(wave_sizze_27992, skip_threads_28001)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_thr",
                   "eads_28001 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_27990 - squot32(local_tid_27990, 32) * 32) == 31 &&\n            ltid_in_bounds_28000) {\n            ((volatile __local\n              int64_t *) scan_arr_mem_27994)[sext_i32_i64(squot32(local_tid_27990,\n                                                                  32))] =\n                x_23534;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28002;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_27990, 32) == 0 && ltid_in_bounds_28000) {\n                x_27998 = ((volatile __local\n                            int64_t *) scan_arr_mem_27994)[sext_i32_i64(local_tid_27990)];\n                if ((local_tid_27990 - squot32(local_tid_27990, 32) * 32) ==\n                    0) {\n                    x_27997 = x_27998;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28002 = 1;\n            while (slt32(skip_threads_28002, 32)) {\n                if (sle32(skip_threads_28002, local_tid_27990 -\n                          squot32(local_tid_27990, 32) * 32) &&\n                    (squot32(local_tid_27990, 32) == 0 &&\n                     ltid_in_bounds_28000)) {\n                    // read operands\n                    {\n                        x_27997 = ((volatile __local\n                                    int64_t *) scan_arr_mem_27994)[sext_i32_i64(local_tid_27990) -\n                                                                   sext_i32_i64(skip_threads_28002)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_27999 = add64(x_27997, x_27998);\n                        \n                        x_27",
                   "997 = res_27999;\n                    }\n                }\n                if (sle32(wave_sizze_27992, skip_threads_28002)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28002, local_tid_27990 -\n                          squot32(local_tid_27990, 32) * 32) &&\n                    (squot32(local_tid_27990, 32) == 0 &&\n                     ltid_in_bounds_28000)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_27994)[sext_i32_i64(local_tid_27990)] =\n                            x_27997;\n                        x_27998 = x_27997;\n                    }\n                }\n                if (sle32(wave_sizze_27992, skip_threads_28002)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28002 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_27990, 32) == 0 || !ltid_in_bounds_28000)) {\n            // read operands\n            {\n                x_23535 = x_23534;\n                x_23534 = ((__local\n                            int64_t *) scan_arr_mem_27994)[sext_i32_i64(squot32(local_tid_27990,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_23536 = add64(x_23534, x_23535);\n                \n                x_23534 = res_23536;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_27994)[sext_i32_i64(local_tid_27990)] =\n                    x_23534;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_27990, 32) ",
                   "== 0) {\n            ((__local\n              int64_t *) scan_arr_mem_27994)[sext_i32_i64(local_tid_27990)] =\n                x_23535;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_25332, binop_x_27689)) {\n            ((__global int64_t *) mem_27737)[gtid_25332] = ((__local\n                                                             int64_t *) scan_arr_mem_27994)[sext_i32_i64(local_tid_27990)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25328\n}\n__kernel void mainziscan_stage2_25366(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28245_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28243_backing_aligned_1,\n                                      int64_t res_23550, __global\n                                      unsigned char *mem_27748, __global\n                                      unsigned char *mem_27750,\n                                      int64_t stage1_num_groups_28205,\n                                      int32_t num_threads_28206)\n{\n    #define segscan_group_sizze_25361 (mainzisegscan_group_sizze_25360)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28245_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28245_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28243_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28243_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28238;\n    int32_t local_tid_28239;\n    int64_t group_sizze_28242;\n    int32_t wave_sizze_28241;\n    int32_t group_tid_28240;\n    \n    gl",
                   "obal_tid_28238 = get_global_id(0);\n    local_tid_28239 = get_local_id(0);\n    group_sizze_28242 = get_local_size(0);\n    wave_sizze_28241 = LOCKSTEP_WIDTH;\n    group_tid_28240 = get_group_id(0);\n    \n    int32_t phys_tid_25366;\n    \n    phys_tid_25366 = global_tid_28238;\n    \n    __local char *scan_arr_mem_28243;\n    __local char *scan_arr_mem_28245;\n    \n    scan_arr_mem_28243 = (__local char *) scan_arr_mem_28243_backing_0;\n    scan_arr_mem_28245 = (__local char *) scan_arr_mem_28245_backing_1;\n    \n    int64_t flat_idx_28247;\n    \n    flat_idx_28247 = (sext_i32_i64(local_tid_28239) + 1) *\n        (segscan_group_sizze_25361 * sdiv_up64(res_23550,\n                                               sext_i32_i64(num_threads_28206))) -\n        1;\n    \n    int64_t gtid_25365;\n    \n    gtid_25365 = flat_idx_28247;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_25365, res_23550)) {\n            ((__local\n              bool *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)] =\n                ((__global bool *) mem_27748)[gtid_25365];\n            ((__local\n              int64_t *) scan_arr_mem_28245)[sext_i32_i64(local_tid_28239)] =\n                ((__global int64_t *) mem_27750)[gtid_25365];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_28245)[sext_i32_i64(local_tid_28239)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_23569;\n    int64_t x_23570;\n    bool x_23571;\n    int64_t x_23572;\n    bool x_28248;\n    int64_t x_28249;\n    bool x_28250;\n    int64_t x_28251;\n    bool ltid_in_bounds_28255;\n    \n    ltid_in_bounds_28255 = slt64(sext_i32_i64(local_tid_28239),\n                                 stage1_num_groups_28205);\n    \n    int32_t skip_threads_28256;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28255) {\n            x_23571 = ((volatile __loca",
                   "l\n                        bool *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)];\n            x_23572 = ((volatile __local\n                        int64_t *) scan_arr_mem_28245)[sext_i32_i64(local_tid_28239)];\n            if ((local_tid_28239 - squot32(local_tid_28239, 32) * 32) == 0) {\n                x_23569 = x_23571;\n                x_23570 = x_23572;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28256 = 1;\n        while (slt32(skip_threads_28256, 32)) {\n            if (sle32(skip_threads_28256, local_tid_28239 -\n                      squot32(local_tid_28239, 32) * 32) &&\n                ltid_in_bounds_28255) {\n                // read operands\n                {\n                    x_23569 = ((volatile __local\n                                bool *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239) -\n                                                            sext_i32_i64(skip_threads_28256)];\n                    x_23570 = ((volatile __local\n                                int64_t *) scan_arr_mem_28245)[sext_i32_i64(local_tid_28239) -\n                                                               sext_i32_i64(skip_threads_28256)];\n                }\n                // perform operation\n                {\n                    bool res_23573 = x_23569 || x_23571;\n                    int64_t res_23574;\n                    \n                    if (x_23571) {\n                        res_23574 = x_23572;\n                    } else {\n                        int64_t res_23575 = add64(x_23570, x_23572);\n                        \n                        res_23574 = res_23575;\n                    }\n                    x_23569 = res_23573;\n                    x_23570 = res_23574;\n                }\n            }\n            if (sle32(wave_sizze_28241, skip_threads_28256)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28256, local_tid_28239 -\n                      ",
                   "squot32(local_tid_28239, 32) * 32) &&\n                ltid_in_bounds_28255) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)] =\n                        x_23569;\n                    x_23571 = x_23569;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28245)[sext_i32_i64(local_tid_28239)] =\n                        x_23570;\n                    x_23572 = x_23570;\n                }\n            }\n            if (sle32(wave_sizze_28241, skip_threads_28256)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28256 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28239 - squot32(local_tid_28239, 32) * 32) == 31 &&\n            ltid_in_bounds_28255) {\n            ((volatile __local\n              bool *) scan_arr_mem_28243)[sext_i32_i64(squot32(local_tid_28239,\n                                                               32))] = x_23569;\n            ((volatile __local\n              int64_t *) scan_arr_mem_28245)[sext_i32_i64(squot32(local_tid_28239,\n                                                                  32))] =\n                x_23570;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28257;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28239, 32) == 0 && ltid_in_bounds_28255) {\n                x_28250 = ((volatile __local\n                            bool *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)];\n                x_28251 = ((volatile __local\n                            int64_t *) scan_arr_mem_28245)[sext_i32_i64(local_tid_28239)];\n                if ((local_tid_28239 - squot32(local_tid_28239, 32) * 3",
                   "2) ==\n                    0) {\n                    x_28248 = x_28250;\n                    x_28249 = x_28251;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28257 = 1;\n            while (slt32(skip_threads_28257, 32)) {\n                if (sle32(skip_threads_28257, local_tid_28239 -\n                          squot32(local_tid_28239, 32) * 32) &&\n                    (squot32(local_tid_28239, 32) == 0 &&\n                     ltid_in_bounds_28255)) {\n                    // read operands\n                    {\n                        x_28248 = ((volatile __local\n                                    bool *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239) -\n                                                                sext_i32_i64(skip_threads_28257)];\n                        x_28249 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28245)[sext_i32_i64(local_tid_28239) -\n                                                                   sext_i32_i64(skip_threads_28257)];\n                    }\n                    // perform operation\n                    {\n                        bool res_28252 = x_28248 || x_28250;\n                        int64_t res_28253;\n                        \n                        if (x_28250) {\n                            res_28253 = x_28251;\n                        } else {\n                            int64_t res_28254 = add64(x_28249, x_28251);\n                            \n                            res_28253 = res_28254;\n                        }\n                        x_28248 = res_28252;\n                        x_28249 = res_28253;\n                    }\n                }\n                if (sle32(wave_sizze_28241, skip_threads_28257)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28257, local_tid_28239 -\n                          squot32(local_tid_28239, 32) * 32",
                   ") &&\n                    (squot32(local_tid_28239, 32) == 0 &&\n                     ltid_in_bounds_28255)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)] =\n                            x_28248;\n                        x_28250 = x_28248;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28245)[sext_i32_i64(local_tid_28239)] =\n                            x_28249;\n                        x_28251 = x_28249;\n                    }\n                }\n                if (sle32(wave_sizze_28241, skip_threads_28257)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28257 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28239, 32) == 0 || !ltid_in_bounds_28255)) {\n            // read operands\n            {\n                x_23571 = x_23569;\n                x_23572 = x_23570;\n                x_23569 = ((__local\n                            bool *) scan_arr_mem_28243)[sext_i32_i64(squot32(local_tid_28239,\n                                                                             32)) -\n                                                        1];\n                x_23570 = ((__local\n                            int64_t *) scan_arr_mem_28245)[sext_i32_i64(squot32(local_tid_28239,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_23573 = x_23569 || x_23571;\n                int64_t res_23574;\n                \n                if (x_23571) {\n                    res_23574 = x_23572;\n                } else {\n                    int64_t res_23575 = add64(x_23570, x_23572);\n",
                   "                    \n                    res_23574 = res_23575;\n                }\n                x_23569 = res_23573;\n                x_23570 = res_23574;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)] =\n                    x_23569;\n                ((__local\n                  int64_t *) scan_arr_mem_28245)[sext_i32_i64(local_tid_28239)] =\n                    x_23570;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28239, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)] =\n                x_23571;\n            ((__local\n              int64_t *) scan_arr_mem_28245)[sext_i32_i64(local_tid_28239)] =\n                x_23572;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_25365, res_23550)) {\n            ((__global bool *) mem_27748)[gtid_25365] = ((__local\n                                                          bool *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)];\n            ((__global int64_t *) mem_27750)[gtid_25365] = ((__local\n                                                             int64_t *) scan_arr_mem_28245)[sext_i32_i64(local_tid_28239)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25361\n}\n__kernel void mainziscan_stage2_25374(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28312_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28310_backing_aligned_1,\n                                      int64_t res_23550, __global\n                                      unsigned char *mem_27753, __global\n     ",
                   "                                 unsigned char *mem_27755,\n                                      int64_t stage1_num_groups_28272,\n                                      int32_t num_threads_28273)\n{\n    #define segscan_group_sizze_25369 (mainzisegscan_group_sizze_25368)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28312_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28312_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28310_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28310_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28305;\n    int32_t local_tid_28306;\n    int64_t group_sizze_28309;\n    int32_t wave_sizze_28308;\n    int32_t group_tid_28307;\n    \n    global_tid_28305 = get_global_id(0);\n    local_tid_28306 = get_local_id(0);\n    group_sizze_28309 = get_local_size(0);\n    wave_sizze_28308 = LOCKSTEP_WIDTH;\n    group_tid_28307 = get_group_id(0);\n    \n    int32_t phys_tid_25374;\n    \n    phys_tid_25374 = global_tid_28305;\n    \n    __local char *scan_arr_mem_28310;\n    __local char *scan_arr_mem_28312;\n    \n    scan_arr_mem_28310 = (__local char *) scan_arr_mem_28310_backing_0;\n    scan_arr_mem_28312 = (__local char *) scan_arr_mem_28312_backing_1;\n    \n    int64_t flat_idx_28314;\n    \n    flat_idx_28314 = (sext_i32_i64(local_tid_28306) + 1) *\n        (segscan_group_sizze_25369 * sdiv_up64(res_23550,\n                                               sext_i32_i64(num_threads_28273))) -\n        1;\n    \n    int64_t gtid_25373;\n    \n    gtid_25373 = flat_idx_28314;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_25373, res_23550)) {\n            ((__local\n              bool *) scan_arr_mem_28310)[sext_i32_i64(local_tid_28306)] =\n                ((__gl",
                   "obal bool *) mem_27753)[gtid_25373];\n            ((__local\n              int64_t *) scan_arr_mem_28312)[sext_i32_i64(local_tid_28306)] =\n                ((__global int64_t *) mem_27755)[gtid_25373];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28310)[sext_i32_i64(local_tid_28306)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_28312)[sext_i32_i64(local_tid_28306)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_23609;\n    int64_t x_23610;\n    bool x_23611;\n    int64_t x_23612;\n    bool x_28315;\n    int64_t x_28316;\n    bool x_28317;\n    int64_t x_28318;\n    bool ltid_in_bounds_28322;\n    \n    ltid_in_bounds_28322 = slt64(sext_i32_i64(local_tid_28306),\n                                 stage1_num_groups_28272);\n    \n    int32_t skip_threads_28323;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28322) {\n            x_23611 = ((volatile __local\n                        bool *) scan_arr_mem_28310)[sext_i32_i64(local_tid_28306)];\n            x_23612 = ((volatile __local\n                        int64_t *) scan_arr_mem_28312)[sext_i32_i64(local_tid_28306)];\n            if ((local_tid_28306 - squot32(local_tid_28306, 32) * 32) == 0) {\n                x_23609 = x_23611;\n                x_23610 = x_23612;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28323 = 1;\n        while (slt32(skip_threads_28323, 32)) {\n            if (sle32(skip_threads_28323, local_tid_28306 -\n                      squot32(local_tid_28306, 32) * 32) &&\n                ltid_in_bounds_28322) {\n                // read operands\n                {\n                    x_23609 = ((volatile __local\n                                bool *) scan_arr_mem_28310)[sext_i32_i64(local_tid_28306) -\n                                                            sext_i32_i64(skip_threads_28323)];\n                    x_23610 = ((volatile __local\n                          ",
                   "      int64_t *) scan_arr_mem_28312)[sext_i32_i64(local_tid_28306) -\n                                                               sext_i32_i64(skip_threads_28323)];\n                }\n                // perform operation\n                {\n                    bool res_23613 = x_23609 || x_23611;\n                    int64_t res_23614;\n                    \n                    if (x_23611) {\n                        res_23614 = x_23612;\n                    } else {\n                        int64_t res_23615 = add64(x_23610, x_23612);\n                        \n                        res_23614 = res_23615;\n                    }\n                    x_23609 = res_23613;\n                    x_23610 = res_23614;\n                }\n            }\n            if (sle32(wave_sizze_28308, skip_threads_28323)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28323, local_tid_28306 -\n                      squot32(local_tid_28306, 32) * 32) &&\n                ltid_in_bounds_28322) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28310)[sext_i32_i64(local_tid_28306)] =\n                        x_23609;\n                    x_23611 = x_23609;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28312)[sext_i32_i64(local_tid_28306)] =\n                        x_23610;\n                    x_23612 = x_23610;\n                }\n            }\n            if (sle32(wave_sizze_28308, skip_threads_28323)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28323 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28306 - squot32(local_tid_28306, 32) * 32) == 31 &&\n            ltid_in_bounds_28322) {\n            ((volatile __local\n              bool *) scan_arr_mem_28310)[sext_i32_i64(squot32(local_tid_28306,",
                   "\n                                                               32))] = x_23609;\n            ((volatile __local\n              int64_t *) scan_arr_mem_28312)[sext_i32_i64(squot32(local_tid_28306,\n                                                                  32))] =\n                x_23610;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28324;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28306, 32) == 0 && ltid_in_bounds_28322) {\n                x_28317 = ((volatile __local\n                            bool *) scan_arr_mem_28310)[sext_i32_i64(local_tid_28306)];\n                x_28318 = ((volatile __local\n                            int64_t *) scan_arr_mem_28312)[sext_i32_i64(local_tid_28306)];\n                if ((local_tid_28306 - squot32(local_tid_28306, 32) * 32) ==\n                    0) {\n                    x_28315 = x_28317;\n                    x_28316 = x_28318;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28324 = 1;\n            while (slt32(skip_threads_28324, 32)) {\n                if (sle32(skip_threads_28324, local_tid_28306 -\n                          squot32(local_tid_28306, 32) * 32) &&\n                    (squot32(local_tid_28306, 32) == 0 &&\n                     ltid_in_bounds_28322)) {\n                    // read operands\n                    {\n                        x_28315 = ((volatile __local\n                                    bool *) scan_arr_mem_28310)[sext_i32_i64(local_tid_28306) -\n                                                                sext_i32_i64(skip_threads_28324)];\n                        x_28316 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28312)[sext_i32_i64(local_tid_28306) -\n                                                        ",
                   "           sext_i32_i64(skip_threads_28324)];\n                    }\n                    // perform operation\n                    {\n                        bool res_28319 = x_28315 || x_28317;\n                        int64_t res_28320;\n                        \n                        if (x_28317) {\n                            res_28320 = x_28318;\n                        } else {\n                            int64_t res_28321 = add64(x_28316, x_28318);\n                            \n                            res_28320 = res_28321;\n                        }\n                        x_28315 = res_28319;\n                        x_28316 = res_28320;\n                    }\n                }\n                if (sle32(wave_sizze_28308, skip_threads_28324)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28324, local_tid_28306 -\n                          squot32(local_tid_28306, 32) * 32) &&\n                    (squot32(local_tid_28306, 32) == 0 &&\n                     ltid_in_bounds_28322)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28310)[sext_i32_i64(local_tid_28306)] =\n                            x_28315;\n                        x_28317 = x_28315;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28312)[sext_i32_i64(local_tid_28306)] =\n                            x_28316;\n                        x_28318 = x_28316;\n                    }\n                }\n                if (sle32(wave_sizze_28308, skip_threads_28324)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28324 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28306, 32) == 0 || !ltid_in_bounds_28322)) {\n            // read operands\n            {\n       ",
                   "         x_23611 = x_23609;\n                x_23612 = x_23610;\n                x_23609 = ((__local\n                            bool *) scan_arr_mem_28310)[sext_i32_i64(squot32(local_tid_28306,\n                                                                             32)) -\n                                                        1];\n                x_23610 = ((__local\n                            int64_t *) scan_arr_mem_28312)[sext_i32_i64(squot32(local_tid_28306,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_23613 = x_23609 || x_23611;\n                int64_t res_23614;\n                \n                if (x_23611) {\n                    res_23614 = x_23612;\n                } else {\n                    int64_t res_23615 = add64(x_23610, x_23612);\n                    \n                    res_23614 = res_23615;\n                }\n                x_23609 = res_23613;\n                x_23610 = res_23614;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28310)[sext_i32_i64(local_tid_28306)] =\n                    x_23609;\n                ((__local\n                  int64_t *) scan_arr_mem_28312)[sext_i32_i64(local_tid_28306)] =\n                    x_23610;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28306, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28310)[sext_i32_i64(local_tid_28306)] =\n                x_23611;\n            ((__local\n              int64_t *) scan_arr_mem_28312)[sext_i32_i64(local_tid_28306)] =\n                x_23612;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_25373, res_23550)) {\n    ",
                   "        ((__global bool *) mem_27753)[gtid_25373] = ((__local\n                                                          bool *) scan_arr_mem_28310)[sext_i32_i64(local_tid_28306)];\n            ((__global int64_t *) mem_27755)[gtid_25373] = ((__local\n                                                             int64_t *) scan_arr_mem_28312)[sext_i32_i64(local_tid_28306)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25369\n}\n__kernel void mainziscan_stage2_25382(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28379_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28377_backing_aligned_1,\n                                      int64_t res_23550, __global\n                                      unsigned char *mem_27760, __global\n                                      unsigned char *mem_27762,\n                                      int64_t stage1_num_groups_28339,\n                                      int32_t num_threads_28340)\n{\n    #define segscan_group_sizze_25377 (mainzisegscan_group_sizze_25376)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28379_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28379_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28377_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28377_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28372;\n    int32_t local_tid_28373;\n    int64_t group_sizze_28376;\n    int32_t wave_sizze_28375;\n    int32_t group_tid_28374;\n    \n    global_tid_28372 = get_global_id(0);\n    local_tid_28373 = get_local_id(0);\n    group_sizze_28376 = get_lo",
                   "cal_size(0);\n    wave_sizze_28375 = LOCKSTEP_WIDTH;\n    group_tid_28374 = get_group_id(0);\n    \n    int32_t phys_tid_25382;\n    \n    phys_tid_25382 = global_tid_28372;\n    \n    __local char *scan_arr_mem_28377;\n    __local char *scan_arr_mem_28379;\n    \n    scan_arr_mem_28377 = (__local char *) scan_arr_mem_28377_backing_0;\n    scan_arr_mem_28379 = (__local char *) scan_arr_mem_28379_backing_1;\n    \n    int64_t flat_idx_28381;\n    \n    flat_idx_28381 = (sext_i32_i64(local_tid_28373) + 1) *\n        (segscan_group_sizze_25377 * sdiv_up64(res_23550,\n                                               sext_i32_i64(num_threads_28340))) -\n        1;\n    \n    int64_t gtid_25381;\n    \n    gtid_25381 = flat_idx_28381;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_25381, res_23550)) {\n            ((__local\n              bool *) scan_arr_mem_28377)[sext_i32_i64(local_tid_28373)] =\n                ((__global bool *) mem_27760)[gtid_25381];\n            ((__local\n              float *) scan_arr_mem_28379)[sext_i32_i64(local_tid_28373)] =\n                ((__global float *) mem_27762)[gtid_25381];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28377)[sext_i32_i64(local_tid_28373)] = 0;\n            ((__local\n              float *) scan_arr_mem_28379)[sext_i32_i64(local_tid_28373)] =\n                0.0F;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_23635;\n    float x_23636;\n    bool x_23637;\n    float x_23638;\n    bool x_28382;\n    float x_28383;\n    bool x_28384;\n    float x_28385;\n    bool ltid_in_bounds_28389;\n    \n    ltid_in_bounds_28389 = slt64(sext_i32_i64(local_tid_28373),\n                                 stage1_num_groups_28339);\n    \n    int32_t skip_threads_28390;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28389) {\n            x_23637 = ((volatile __local\n                        bool *) scan_arr_mem_28377)[sext_i32_i64(local_tid_28373)];\n            x",
                   "_23638 = ((volatile __local\n                        float *) scan_arr_mem_28379)[sext_i32_i64(local_tid_28373)];\n            if ((local_tid_28373 - squot32(local_tid_28373, 32) * 32) == 0) {\n                x_23635 = x_23637;\n                x_23636 = x_23638;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28390 = 1;\n        while (slt32(skip_threads_28390, 32)) {\n            if (sle32(skip_threads_28390, local_tid_28373 -\n                      squot32(local_tid_28373, 32) * 32) &&\n                ltid_in_bounds_28389) {\n                // read operands\n                {\n                    x_23635 = ((volatile __local\n                                bool *) scan_arr_mem_28377)[sext_i32_i64(local_tid_28373) -\n                                                            sext_i32_i64(skip_threads_28390)];\n                    x_23636 = ((volatile __local\n                                float *) scan_arr_mem_28379)[sext_i32_i64(local_tid_28373) -\n                                                             sext_i32_i64(skip_threads_28390)];\n                }\n                // perform operation\n                {\n                    bool res_23639 = x_23635 || x_23637;\n                    float res_23640;\n                    \n                    if (x_23637) {\n                        res_23640 = x_23638;\n                    } else {\n                        float res_23641 = x_23636 + x_23638;\n                        \n                        res_23640 = res_23641;\n                    }\n                    x_23635 = res_23639;\n                    x_23636 = res_23640;\n                }\n            }\n            if (sle32(wave_sizze_28375, skip_threads_28390)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28390, local_tid_28373 -\n                      squot32(local_tid_28373, 32) * 32) &&\n                ltid_in_bounds_28389) {\n                // write result\n     ",
                   "           {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28377)[sext_i32_i64(local_tid_28373)] =\n                        x_23635;\n                    x_23637 = x_23635;\n                    ((volatile __local\n                      float *) scan_arr_mem_28379)[sext_i32_i64(local_tid_28373)] =\n                        x_23636;\n                    x_23638 = x_23636;\n                }\n            }\n            if (sle32(wave_sizze_28375, skip_threads_28390)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28390 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28373 - squot32(local_tid_28373, 32) * 32) == 31 &&\n            ltid_in_bounds_28389) {\n            ((volatile __local\n              bool *) scan_arr_mem_28377)[sext_i32_i64(squot32(local_tid_28373,\n                                                               32))] = x_23635;\n            ((volatile __local\n              float *) scan_arr_mem_28379)[sext_i32_i64(squot32(local_tid_28373,\n                                                                32))] = x_23636;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28391;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28373, 32) == 0 && ltid_in_bounds_28389) {\n                x_28384 = ((volatile __local\n                            bool *) scan_arr_mem_28377)[sext_i32_i64(local_tid_28373)];\n                x_28385 = ((volatile __local\n                            float *) scan_arr_mem_28379)[sext_i32_i64(local_tid_28373)];\n                if ((local_tid_28373 - squot32(local_tid_28373, 32) * 32) ==\n                    0) {\n                    x_28382 = x_28384;\n                    x_28383 = x_28385;\n                }\n            ",
                   "}\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28391 = 1;\n            while (slt32(skip_threads_28391, 32)) {\n                if (sle32(skip_threads_28391, local_tid_28373 -\n                          squot32(local_tid_28373, 32) * 32) &&\n                    (squot32(local_tid_28373, 32) == 0 &&\n                     ltid_in_bounds_28389)) {\n                    // read operands\n                    {\n                        x_28382 = ((volatile __local\n                                    bool *) scan_arr_mem_28377)[sext_i32_i64(local_tid_28373) -\n                                                                sext_i32_i64(skip_threads_28391)];\n                        x_28383 = ((volatile __local\n                                    float *) scan_arr_mem_28379)[sext_i32_i64(local_tid_28373) -\n                                                                 sext_i32_i64(skip_threads_28391)];\n                    }\n                    // perform operation\n                    {\n                        bool res_28386 = x_28382 || x_28384;\n                        float res_28387;\n                        \n                        if (x_28384) {\n                            res_28387 = x_28385;\n                        } else {\n                            float res_28388 = x_28383 + x_28385;\n                            \n                            res_28387 = res_28388;\n                        }\n                        x_28382 = res_28386;\n                        x_28383 = res_28387;\n                    }\n                }\n                if (sle32(wave_sizze_28375, skip_threads_28391)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28391, local_tid_28373 -\n                          squot32(local_tid_28373, 32) * 32) &&\n                    (squot32(local_tid_28373, 32) == 0 &&\n                     ltid_in_bounds_28389)) {\n                    // write result\n        ",
                   "            {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28377)[sext_i32_i64(local_tid_28373)] =\n                            x_28382;\n                        x_28384 = x_28382;\n                        ((volatile __local\n                          float *) scan_arr_mem_28379)[sext_i32_i64(local_tid_28373)] =\n                            x_28383;\n                        x_28385 = x_28383;\n                    }\n                }\n                if (sle32(wave_sizze_28375, skip_threads_28391)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28391 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28373, 32) == 0 || !ltid_in_bounds_28389)) {\n            // read operands\n            {\n                x_23637 = x_23635;\n                x_23638 = x_23636;\n                x_23635 = ((__local\n                            bool *) scan_arr_mem_28377)[sext_i32_i64(squot32(local_tid_28373,\n                                                                             32)) -\n                                                        1];\n                x_23636 = ((__local\n                            float *) scan_arr_mem_28379)[sext_i32_i64(squot32(local_tid_28373,\n                                                                              32)) -\n                                                         1];\n            }\n            // perform operation\n            {\n                bool res_23639 = x_23635 || x_23637;\n                float res_23640;\n                \n                if (x_23637) {\n                    res_23640 = x_23638;\n                } else {\n                    float res_23641 = x_23636 + x_23638;\n                    \n                    res_23640 = res_23641;\n                }\n                x_23635 = res_23639;\n                x_23636 = res_23640;\n            }\n ",
                   "           // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28377)[sext_i32_i64(local_tid_28373)] =\n                    x_23635;\n                ((__local\n                  float *) scan_arr_mem_28379)[sext_i32_i64(local_tid_28373)] =\n                    x_23636;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28373, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28377)[sext_i32_i64(local_tid_28373)] =\n                x_23637;\n            ((__local\n              float *) scan_arr_mem_28379)[sext_i32_i64(local_tid_28373)] =\n                x_23638;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_25381, res_23550)) {\n            ((__global bool *) mem_27760)[gtid_25381] = ((__local\n                                                          bool *) scan_arr_mem_28377)[sext_i32_i64(local_tid_28373)];\n            ((__global float *) mem_27762)[gtid_25381] = ((__local\n                                                           float *) scan_arr_mem_28379)[sext_i32_i64(local_tid_28373)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25377\n}\n__kernel void mainziscan_stage2_25434(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28434_backing_aligned_0,\n                                      int64_t res_23550, __global\n                                      unsigned char *mem_27765,\n                                      int64_t stage1_num_groups_28406,\n                                      int32_t num_threads_28407)\n{\n    #define segscan_group_sizze_25429 (mainzisegscan_group_sizze_25428)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *res",
                   "trict scan_arr_mem_28434_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28434_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28429;\n    int32_t local_tid_28430;\n    int64_t group_sizze_28433;\n    int32_t wave_sizze_28432;\n    int32_t group_tid_28431;\n    \n    global_tid_28429 = get_global_id(0);\n    local_tid_28430 = get_local_id(0);\n    group_sizze_28433 = get_local_size(0);\n    wave_sizze_28432 = LOCKSTEP_WIDTH;\n    group_tid_28431 = get_group_id(0);\n    \n    int32_t phys_tid_25434;\n    \n    phys_tid_25434 = global_tid_28429;\n    \n    __local char *scan_arr_mem_28434;\n    \n    scan_arr_mem_28434 = (__local char *) scan_arr_mem_28434_backing_0;\n    \n    int64_t flat_idx_28436;\n    \n    flat_idx_28436 = (sext_i32_i64(local_tid_28430) + 1) *\n        (segscan_group_sizze_25429 * sdiv_up64(res_23550,\n                                               sext_i32_i64(num_threads_28407))) -\n        1;\n    \n    int64_t gtid_25433;\n    \n    gtid_25433 = flat_idx_28436;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_25433, res_23550)) {\n            ((__local\n              int64_t *) scan_arr_mem_28434)[sext_i32_i64(local_tid_28430)] =\n                ((__global int64_t *) mem_27765)[gtid_25433];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_28434)[sext_i32_i64(local_tid_28430)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_23742;\n    int64_t x_23743;\n    int64_t x_28437;\n    int64_t x_28438;\n    bool ltid_in_bounds_28440;\n    \n    ltid_in_bounds_28440 = slt64(sext_i32_i64(local_tid_28430),\n                                 stage1_num_groups_28406);\n    \n    int32_t skip_threads_28441;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28440) {\n            x_23743 = ((volatile __local\n                        int64_t *) scan_arr_mem_28434)[sext_i32_i6",
                   "4(local_tid_28430)];\n            if ((local_tid_28430 - squot32(local_tid_28430, 32) * 32) == 0) {\n                x_23742 = x_23743;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28441 = 1;\n        while (slt32(skip_threads_28441, 32)) {\n            if (sle32(skip_threads_28441, local_tid_28430 -\n                      squot32(local_tid_28430, 32) * 32) &&\n                ltid_in_bounds_28440) {\n                // read operands\n                {\n                    x_23742 = ((volatile __local\n                                int64_t *) scan_arr_mem_28434)[sext_i32_i64(local_tid_28430) -\n                                                               sext_i32_i64(skip_threads_28441)];\n                }\n                // perform operation\n                {\n                    int64_t res_23744 = add64(x_23742, x_23743);\n                    \n                    x_23742 = res_23744;\n                }\n            }\n            if (sle32(wave_sizze_28432, skip_threads_28441)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28441, local_tid_28430 -\n                      squot32(local_tid_28430, 32) * 32) &&\n                ltid_in_bounds_28440) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28434)[sext_i32_i64(local_tid_28430)] =\n                        x_23742;\n                    x_23743 = x_23742;\n                }\n            }\n            if (sle32(wave_sizze_28432, skip_threads_28441)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28441 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28430 - squot32(local_tid_28430, 32) * 32) == 31 &&\n            ltid_in_bounds_28440) {\n            ((volatile __local\n              int64_t *) scan",
                   "_arr_mem_28434)[sext_i32_i64(squot32(local_tid_28430,\n                                                                  32))] =\n                x_23742;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28442;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28430, 32) == 0 && ltid_in_bounds_28440) {\n                x_28438 = ((volatile __local\n                            int64_t *) scan_arr_mem_28434)[sext_i32_i64(local_tid_28430)];\n                if ((local_tid_28430 - squot32(local_tid_28430, 32) * 32) ==\n                    0) {\n                    x_28437 = x_28438;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28442 = 1;\n            while (slt32(skip_threads_28442, 32)) {\n                if (sle32(skip_threads_28442, local_tid_28430 -\n                          squot32(local_tid_28430, 32) * 32) &&\n                    (squot32(local_tid_28430, 32) == 0 &&\n                     ltid_in_bounds_28440)) {\n                    // read operands\n                    {\n                        x_28437 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28434)[sext_i32_i64(local_tid_28430) -\n                                                                   sext_i32_i64(skip_threads_28442)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28439 = add64(x_28437, x_28438);\n                        \n                        x_28437 = res_28439;\n                    }\n                }\n                if (sle32(wave_sizze_28432, skip_threads_28442)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28442, local_tid_28430 -\n                          squot32(local_tid_28430, 3",
                   "2) * 32) &&\n                    (squot32(local_tid_28430, 32) == 0 &&\n                     ltid_in_bounds_28440)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28434)[sext_i32_i64(local_tid_28430)] =\n                            x_28437;\n                        x_28438 = x_28437;\n                    }\n                }\n                if (sle32(wave_sizze_28432, skip_threads_28442)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28442 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28430, 32) == 0 || !ltid_in_bounds_28440)) {\n            // read operands\n            {\n                x_23743 = x_23742;\n                x_23742 = ((__local\n                            int64_t *) scan_arr_mem_28434)[sext_i32_i64(squot32(local_tid_28430,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_23744 = add64(x_23742, x_23743);\n                \n                x_23742 = res_23744;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_28434)[sext_i32_i64(local_tid_28430)] =\n                    x_23742;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28430, 32) == 0) {\n            ((__local\n              int64_t *) scan_arr_mem_28434)[sext_i32_i64(local_tid_28430)] =\n                x_23743;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_25433, res_23550)) {\n            ((__global int64",
                   "_t *) mem_27765)[gtid_25433] = ((__local\n                                                             int64_t *) scan_arr_mem_28434)[sext_i32_i64(local_tid_28430)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25429\n}\n__kernel void mainziscan_stage3_25333(__global int *global_failure,\n                                      int64_t num_groups_25330,\n                                      int64_t binop_x_27689, __global\n                                      unsigned char *mem_27737,\n                                      int32_t num_threads_27967,\n                                      int32_t required_groups_28003)\n{\n    #define segscan_group_sizze_25328 (mainzisegscan_group_sizze_25327)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28004;\n    int32_t local_tid_28005;\n    int64_t group_sizze_28008;\n    int32_t wave_sizze_28007;\n    int32_t group_tid_28006;\n    \n    global_tid_28004 = get_global_id(0);\n    local_tid_28005 = get_local_id(0);\n    group_sizze_28008 = get_local_size(0);\n    wave_sizze_28007 = LOCKSTEP_WIDTH;\n    group_tid_28006 = get_group_id(0);\n    \n    int32_t phys_tid_25333;\n    \n    phys_tid_25333 = global_tid_28004;\n    \n    int32_t phys_group_id_28009;\n    \n    phys_group_id_28009 = get_group_id(0);\n    for (int32_t i_28010 = 0; i_28010 < sdiv_up32(required_groups_28003 -\n                                                  phys_group_id_28009,\n                                                  sext_i64_i32(num_groups_25330));\n         i_28010++) {\n        int32_t virt_group_id_28011 = phys_group_id_28009 + i_28010 *\n                sext_i64_i32(num_groups_25330);\n        int64_t flat_idx_28012 = sext_i32_i64(virt_group_id_28011) *\n                segscan_group_sizze_25328 + sext_i32_i64(local_tid_28005);\n        int64_t gtid_25332 = flat_idx_28012;\n        int64_t orig_group_28013 = squot64(flat_idx_",
                   "28012,\n                                           segscan_group_sizze_25328 *\n                                           sdiv_up64(binop_x_27689,\n                                                     sext_i32_i64(num_threads_27967)));\n        int64_t carry_in_flat_idx_28014 = orig_group_28013 *\n                (segscan_group_sizze_25328 * sdiv_up64(binop_x_27689,\n                                                       sext_i32_i64(num_threads_27967))) -\n                1;\n        \n        if (slt64(gtid_25332, binop_x_27689)) {\n            if (!(orig_group_28013 == 0 || flat_idx_28012 == (orig_group_28013 +\n                                                              1) *\n                  (segscan_group_sizze_25328 * sdiv_up64(binop_x_27689,\n                                                         sext_i32_i64(num_threads_27967))) -\n                  1)) {\n                int64_t x_23534;\n                int64_t x_23535;\n                \n                x_23534 = ((__global\n                            int64_t *) mem_27737)[carry_in_flat_idx_28014];\n                x_23535 = ((__global int64_t *) mem_27737)[gtid_25332];\n                \n                int64_t res_23536;\n                \n                res_23536 = add64(x_23534, x_23535);\n                x_23534 = res_23536;\n                ((__global int64_t *) mem_27737)[gtid_25332] = x_23534;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25328\n}\n__kernel void mainziscan_stage3_25366(__global int *global_failure,\n                                      int64_t res_23550,\n                                      int64_t num_groups_25363, __global\n                                      unsigned char *mem_27748, __global\n                                      unsigned char *mem_27750,\n                                      int32_t num_threads_28206,\n                                      int32_t required_groups_28258)\n{\n   ",
                   " #define segscan_group_sizze_25361 (mainzisegscan_group_sizze_25360)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28259;\n    int32_t local_tid_28260;\n    int64_t group_sizze_28263;\n    int32_t wave_sizze_28262;\n    int32_t group_tid_28261;\n    \n    global_tid_28259 = get_global_id(0);\n    local_tid_28260 = get_local_id(0);\n    group_sizze_28263 = get_local_size(0);\n    wave_sizze_28262 = LOCKSTEP_WIDTH;\n    group_tid_28261 = get_group_id(0);\n    \n    int32_t phys_tid_25366;\n    \n    phys_tid_25366 = global_tid_28259;\n    \n    int32_t phys_group_id_28264;\n    \n    phys_group_id_28264 = get_group_id(0);\n    for (int32_t i_28265 = 0; i_28265 < sdiv_up32(required_groups_28258 -\n                                                  phys_group_id_28264,\n                                                  sext_i64_i32(num_groups_25363));\n         i_28265++) {\n        int32_t virt_group_id_28266 = phys_group_id_28264 + i_28265 *\n                sext_i64_i32(num_groups_25363);\n        int64_t flat_idx_28267 = sext_i32_i64(virt_group_id_28266) *\n                segscan_group_sizze_25361 + sext_i32_i64(local_tid_28260);\n        int64_t gtid_25365 = flat_idx_28267;\n        int64_t orig_group_28268 = squot64(flat_idx_28267,\n                                           segscan_group_sizze_25361 *\n                                           sdiv_up64(res_23550,\n                                                     sext_i32_i64(num_threads_28206)));\n        int64_t carry_in_flat_idx_28269 = orig_group_28268 *\n                (segscan_group_sizze_25361 * sdiv_up64(res_23550,\n                                                       sext_i32_i64(num_threads_28206))) -\n                1;\n        \n        if (slt64(gtid_25365, res_23550)) {\n            if (!(orig_group_28268 == 0 || flat_idx_28267 == (orig_group_28268 +\n                                                    ",
                   "          1) *\n                  (segscan_group_sizze_25361 * sdiv_up64(res_23550,\n                                                         sext_i32_i64(num_threads_28206))) -\n                  1)) {\n                bool x_23569;\n                int64_t x_23570;\n                bool x_23571;\n                int64_t x_23572;\n                \n                x_23569 = ((__global\n                            bool *) mem_27748)[carry_in_flat_idx_28269];\n                x_23570 = ((__global\n                            int64_t *) mem_27750)[carry_in_flat_idx_28269];\n                x_23571 = ((__global bool *) mem_27748)[gtid_25365];\n                x_23572 = ((__global int64_t *) mem_27750)[gtid_25365];\n                \n                bool res_23573;\n                \n                res_23573 = x_23569 || x_23571;\n                \n                int64_t res_23574;\n                \n                if (x_23571) {\n                    res_23574 = x_23572;\n                } else {\n                    int64_t res_23575 = add64(x_23570, x_23572);\n                    \n                    res_23574 = res_23575;\n                }\n                x_23569 = res_23573;\n                x_23570 = res_23574;\n                ((__global bool *) mem_27748)[gtid_25365] = x_23569;\n                ((__global int64_t *) mem_27750)[gtid_25365] = x_23570;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25361\n}\n__kernel void mainziscan_stage3_25374(__global int *global_failure,\n                                      int64_t res_23550,\n                                      int64_t num_groups_25371, __global\n                                      unsigned char *mem_27753, __global\n                                      unsigned char *mem_27755,\n                                      int32_t num_threads_28273,\n                                      int32_t required_groups_28325)\n{\n    #define segscan_gr",
                   "oup_sizze_25369 (mainzisegscan_group_sizze_25368)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28326;\n    int32_t local_tid_28327;\n    int64_t group_sizze_28330;\n    int32_t wave_sizze_28329;\n    int32_t group_tid_28328;\n    \n    global_tid_28326 = get_global_id(0);\n    local_tid_28327 = get_local_id(0);\n    group_sizze_28330 = get_local_size(0);\n    wave_sizze_28329 = LOCKSTEP_WIDTH;\n    group_tid_28328 = get_group_id(0);\n    \n    int32_t phys_tid_25374;\n    \n    phys_tid_25374 = global_tid_28326;\n    \n    int32_t phys_group_id_28331;\n    \n    phys_group_id_28331 = get_group_id(0);\n    for (int32_t i_28332 = 0; i_28332 < sdiv_up32(required_groups_28325 -\n                                                  phys_group_id_28331,\n                                                  sext_i64_i32(num_groups_25371));\n         i_28332++) {\n        int32_t virt_group_id_28333 = phys_group_id_28331 + i_28332 *\n                sext_i64_i32(num_groups_25371);\n        int64_t flat_idx_28334 = sext_i32_i64(virt_group_id_28333) *\n                segscan_group_sizze_25369 + sext_i32_i64(local_tid_28327);\n        int64_t gtid_25373 = flat_idx_28334;\n        int64_t orig_group_28335 = squot64(flat_idx_28334,\n                                           segscan_group_sizze_25369 *\n                                           sdiv_up64(res_23550,\n                                                     sext_i32_i64(num_threads_28273)));\n        int64_t carry_in_flat_idx_28336 = orig_group_28335 *\n                (segscan_group_sizze_25369 * sdiv_up64(res_23550,\n                                                       sext_i32_i64(num_threads_28273))) -\n                1;\n        \n        if (slt64(gtid_25373, res_23550)) {\n            if (!(orig_group_28335 == 0 || flat_idx_28334 == (orig_group_28335 +\n                                                              1) *\n    ",
                   "              (segscan_group_sizze_25369 * sdiv_up64(res_23550,\n                                                         sext_i32_i64(num_threads_28273))) -\n                  1)) {\n                bool x_23609;\n                int64_t x_23610;\n                bool x_23611;\n                int64_t x_23612;\n                \n                x_23609 = ((__global\n                            bool *) mem_27753)[carry_in_flat_idx_28336];\n                x_23610 = ((__global\n                            int64_t *) mem_27755)[carry_in_flat_idx_28336];\n                x_23611 = ((__global bool *) mem_27753)[gtid_25373];\n                x_23612 = ((__global int64_t *) mem_27755)[gtid_25373];\n                \n                bool res_23613;\n                \n                res_23613 = x_23609 || x_23611;\n                \n                int64_t res_23614;\n                \n                if (x_23611) {\n                    res_23614 = x_23612;\n                } else {\n                    int64_t res_23615 = add64(x_23610, x_23612);\n                    \n                    res_23614 = res_23615;\n                }\n                x_23609 = res_23613;\n                x_23610 = res_23614;\n                ((__global bool *) mem_27753)[gtid_25373] = x_23609;\n                ((__global int64_t *) mem_27755)[gtid_25373] = x_23610;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25369\n}\n__kernel void mainziscan_stage3_25382(__global int *global_failure,\n                                      int64_t res_23550,\n                                      int64_t num_groups_25379, __global\n                                      unsigned char *mem_27760, __global\n                                      unsigned char *mem_27762,\n                                      int32_t num_threads_28340,\n                                      int32_t required_groups_28392)\n{\n    #define segscan_group_sizze_25377 (ma",
                   "inzisegscan_group_sizze_25376)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28393;\n    int32_t local_tid_28394;\n    int64_t group_sizze_28397;\n    int32_t wave_sizze_28396;\n    int32_t group_tid_28395;\n    \n    global_tid_28393 = get_global_id(0);\n    local_tid_28394 = get_local_id(0);\n    group_sizze_28397 = get_local_size(0);\n    wave_sizze_28396 = LOCKSTEP_WIDTH;\n    group_tid_28395 = get_group_id(0);\n    \n    int32_t phys_tid_25382;\n    \n    phys_tid_25382 = global_tid_28393;\n    \n    int32_t phys_group_id_28398;\n    \n    phys_group_id_28398 = get_group_id(0);\n    for (int32_t i_28399 = 0; i_28399 < sdiv_up32(required_groups_28392 -\n                                                  phys_group_id_28398,\n                                                  sext_i64_i32(num_groups_25379));\n         i_28399++) {\n        int32_t virt_group_id_28400 = phys_group_id_28398 + i_28399 *\n                sext_i64_i32(num_groups_25379);\n        int64_t flat_idx_28401 = sext_i32_i64(virt_group_id_28400) *\n                segscan_group_sizze_25377 + sext_i32_i64(local_tid_28394);\n        int64_t gtid_25381 = flat_idx_28401;\n        int64_t orig_group_28402 = squot64(flat_idx_28401,\n                                           segscan_group_sizze_25377 *\n                                           sdiv_up64(res_23550,\n                                                     sext_i32_i64(num_threads_28340)));\n        int64_t carry_in_flat_idx_28403 = orig_group_28402 *\n                (segscan_group_sizze_25377 * sdiv_up64(res_23550,\n                                                       sext_i32_i64(num_threads_28340))) -\n                1;\n        \n        if (slt64(gtid_25381, res_23550)) {\n            if (!(orig_group_28402 == 0 || flat_idx_28401 == (orig_group_28402 +\n                                                              1) *\n                  (segs",
                   "can_group_sizze_25377 * sdiv_up64(res_23550,\n                                                         sext_i32_i64(num_threads_28340))) -\n                  1)) {\n                bool x_23635;\n                float x_23636;\n                bool x_23637;\n                float x_23638;\n                \n                x_23635 = ((__global\n                            bool *) mem_27760)[carry_in_flat_idx_28403];\n                x_23636 = ((__global\n                            float *) mem_27762)[carry_in_flat_idx_28403];\n                x_23637 = ((__global bool *) mem_27760)[gtid_25381];\n                x_23638 = ((__global float *) mem_27762)[gtid_25381];\n                \n                bool res_23639;\n                \n                res_23639 = x_23635 || x_23637;\n                \n                float res_23640;\n                \n                if (x_23637) {\n                    res_23640 = x_23638;\n                } else {\n                    float res_23641 = x_23636 + x_23638;\n                    \n                    res_23640 = res_23641;\n                }\n                x_23635 = res_23639;\n                x_23636 = res_23640;\n                ((__global bool *) mem_27760)[gtid_25381] = x_23635;\n                ((__global float *) mem_27762)[gtid_25381] = x_23636;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25377\n}\n__kernel void mainziscan_stage3_25434(__global int *global_failure,\n                                      int64_t res_23550,\n                                      int64_t num_groups_25431, __global\n                                      unsigned char *mem_27765,\n                                      int32_t num_threads_28407,\n                                      int32_t required_groups_28443)\n{\n    #define segscan_group_sizze_25429 (mainzisegscan_group_sizze_25428)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int bl",
                   "ock_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28444;\n    int32_t local_tid_28445;\n    int64_t group_sizze_28448;\n    int32_t wave_sizze_28447;\n    int32_t group_tid_28446;\n    \n    global_tid_28444 = get_global_id(0);\n    local_tid_28445 = get_local_id(0);\n    group_sizze_28448 = get_local_size(0);\n    wave_sizze_28447 = LOCKSTEP_WIDTH;\n    group_tid_28446 = get_group_id(0);\n    \n    int32_t phys_tid_25434;\n    \n    phys_tid_25434 = global_tid_28444;\n    \n    int32_t phys_group_id_28449;\n    \n    phys_group_id_28449 = get_group_id(0);\n    for (int32_t i_28450 = 0; i_28450 < sdiv_up32(required_groups_28443 -\n                                                  phys_group_id_28449,\n                                                  sext_i64_i32(num_groups_25431));\n         i_28450++) {\n        int32_t virt_group_id_28451 = phys_group_id_28449 + i_28450 *\n                sext_i64_i32(num_groups_25431);\n        int64_t flat_idx_28452 = sext_i32_i64(virt_group_id_28451) *\n                segscan_group_sizze_25429 + sext_i32_i64(local_tid_28445);\n        int64_t gtid_25433 = flat_idx_28452;\n        int64_t orig_group_28453 = squot64(flat_idx_28452,\n                                           segscan_group_sizze_25429 *\n                                           sdiv_up64(res_23550,\n                                                     sext_i32_i64(num_threads_28407)));\n        int64_t carry_in_flat_idx_28454 = orig_group_28453 *\n                (segscan_group_sizze_25429 * sdiv_up64(res_23550,\n                                                       sext_i32_i64(num_threads_28407))) -\n                1;\n        \n        if (slt64(gtid_25433, res_23550)) {\n            if (!(orig_group_28453 == 0 || flat_idx_28452 == (orig_group_28453 +\n                                                              1) *\n                  (segscan_group_sizze_25429 * sdiv_up64(res_23550,\n                                                         sext_i32_i",
                   "64(num_threads_28407))) -\n                  1)) {\n                int64_t x_23742;\n                int64_t x_23743;\n                \n                x_23742 = ((__global\n                            int64_t *) mem_27765)[carry_in_flat_idx_28454];\n                x_23743 = ((__global int64_t *) mem_27765)[gtid_25433];\n                \n                int64_t res_23744;\n                \n                res_23744 = add64(x_23742, x_23743);\n                x_23742 = res_23744;\n                ((__global int64_t *) mem_27765)[gtid_25433] = x_23742;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25429\n}\n__kernel void mainziseghist_global_25351(__global int *global_failure,\n                                         int64_t res_23550,\n                                         int64_t num_groups_25348,\n                                         int64_t binop_x_27689, __global\n                                         unsigned char *mem_27737,\n                                         int32_t num_subhistos_28056, __global\n                                         unsigned char *res_subhistos_mem_28057,\n                                         __global\n                                         unsigned char *mainzihist_locks_mem_28127,\n                                         int32_t chk_i_28129,\n                                         int64_t hist_H_chk_28130)\n{\n    #define seghist_group_sizze_25346 (mainziseghist_group_sizze_25345)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28131;\n    int32_t local_tid_28132;\n    int64_t group_sizze_28135;\n    int32_t wave_sizze_28134;\n    int32_t group_tid_28133;\n    \n    global_tid_28131 = get_global_id(0);\n    local_tid_28132 = get_local_id(0);\n    group_sizze_28135 = get_local_size(0);\n    wave_sizze_28134 = LOCKSTE",
                   "P_WIDTH;\n    group_tid_28133 = get_group_id(0);\n    \n    int32_t phys_tid_25351;\n    \n    phys_tid_25351 = global_tid_28131;\n    \n    int32_t subhisto_ind_28136;\n    \n    subhisto_ind_28136 = squot32(global_tid_28131,\n                                 sdiv_up32(sext_i64_i32(seghist_group_sizze_25346 *\n                                           num_groups_25348),\n                                           num_subhistos_28056));\n    for (int64_t i_28137 = 0; i_28137 < sdiv_up64(binop_x_27689 -\n                                                  sext_i32_i64(global_tid_28131),\n                                                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_25346 *\n                                                  num_groups_25348)));\n         i_28137++) {\n        int32_t gtid_25350 = sext_i64_i32(i_28137 *\n                sext_i32_i64(sext_i64_i32(seghist_group_sizze_25346 *\n                num_groups_25348)) + sext_i32_i64(global_tid_28131));\n        \n        if (slt64(i_28137 *\n                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_25346 *\n                  num_groups_25348)) + sext_i32_i64(global_tid_28131),\n                  binop_x_27689)) {\n            int64_t i_p_o_27547 = add64(-1, gtid_25350);\n            int64_t rot_i_27548 = smod64(i_p_o_27547, binop_x_27689);\n            bool cond_25357 = gtid_25350 == 0;\n            int64_t res_25358;\n            \n            if (cond_25357) {\n                res_25358 = 0;\n            } else {\n                int64_t x_25356 = ((__global int64_t *) mem_27737)[rot_i_27548];\n                \n                res_25358 = x_25356;\n            }\n            // save map-out results\n            { }\n            // perform atomic updates\n            {\n                if (sle64(sext_i32_i64(chk_i_28129) * hist_H_chk_28130,\n                          res_25358) && (slt64(res_25358,\n                                               sext_i32_i64(chk_i_28129) *\n                                               hist_H_chk_2",
                   "8130 +\n                                               hist_H_chk_28130) &&\n                                         slt64(res_25358, res_23550))) {\n                    int64_t x_25352;\n                    int64_t x_25353;\n                    \n                    x_25353 = gtid_25350;\n                    \n                    int32_t old_28138;\n                    volatile bool continue_28139;\n                    \n                    continue_28139 = 1;\n                    while (continue_28139) {\n                        old_28138 =\n                            atomic_cmpxchg_i32_global(&((volatile __global\n                                                         int *) mainzihist_locks_mem_28127)[srem64(sext_i32_i64(subhisto_ind_28136) *\n                                                                                                   res_23550 +\n                                                                                                   res_25358,\n                                                                                                   100151)],\n                                                      0, 1);\n                        if (old_28138 == 0) {\n                            int64_t x_25352;\n                            \n                            // bind lhs\n                            {\n                                x_25352 = ((volatile __global\n                                            int64_t *) res_subhistos_mem_28057)[sext_i32_i64(subhisto_ind_28136) *\n                                                                                res_23550 +\n                                                                                res_25358];\n                            }\n                            // execute operation\n                            {\n                                int64_t res_25354 = smax64(x_25352, x_25353);\n                                \n                                x_25352 = res_25354;\n                            }\n         ",
                   "                   // update global result\n                            {\n                                ((volatile __global\n                                  int64_t *) res_subhistos_mem_28057)[sext_i32_i64(subhisto_ind_28136) *\n                                                                      res_23550 +\n                                                                      res_25358] =\n                                    x_25352;\n                            }\n                            mem_fence_global();\n                            old_28138 =\n                                atomic_cmpxchg_i32_global(&((volatile __global\n                                                             int *) mainzihist_locks_mem_28127)[srem64(sext_i32_i64(subhisto_ind_28136) *\n                                                                                                       res_23550 +\n                                                                                                       res_25358,\n                                                                                                       100151)],\n                                                          1, 0);\n                            continue_28139 = 0;\n                        }\n                        mem_fence_global();\n                    }\n                }\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef seghist_group_sizze_25346\n}\n__kernel void mainziseghist_local_25351(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *locks_mem_28097_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *subhistogram_local_mem_28095_backing_aligned_1,\n                                        int64_t res_23550,\n                                        int64_t binop_x_27689, __global\n                                        unsigned char *mem_27737, _",
                   "_global\n                                        unsigned char *res_subhistos_mem_28057,\n                                        int32_t max_group_sizze_28066,\n                                        int64_t num_groups_28067,\n                                        int32_t hist_M_28073,\n                                        int32_t chk_i_28078,\n                                        int64_t num_segments_28079,\n                                        int64_t hist_H_chk_28080,\n                                        int64_t histo_sizze_28081,\n                                        int32_t init_per_thread_28082)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict locks_mem_28097_backing_1 =\n                          (__local volatile\n                           char *) locks_mem_28097_backing_aligned_0;\n    __local volatile char *restrict subhistogram_local_mem_28095_backing_0 =\n                          (__local volatile\n                           char *) subhistogram_local_mem_28095_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28083;\n    int32_t local_tid_28084;\n    int64_t group_sizze_28087;\n    int32_t wave_sizze_28086;\n    int32_t group_tid_28085;\n    \n    global_tid_28083 = get_global_id(0);\n    local_tid_28084 = get_local_id(0);\n    group_sizze_28087 = get_local_size(0);\n    wave_sizze_28086 = LOCKSTEP_WIDTH;\n    group_tid_28085 = get_group_id(0);\n    \n    int32_t phys_tid_25351;\n    \n    phys_tid_25351 = global_tid_28083;\n    \n    int32_t phys_group_id_28088;\n    \n    phys_group_id_28088 = get_group_id(0);\n    for (int32_t i_28089 = 0; i_28089 <\n         sdiv_up32(sext_i64_i32(num_groups_28067 * num_segments_28079) -\n                   phys_group_id_28088, sext_i64_i32(num_groups_28067));\n         i_28089++) {\n        int32_t virt_group_id_28090 = phys_group_id_28088 + i_28089 *\n                sext_i64_i32(num_groups_28067);\n      ",
                   "  int32_t flat_segment_id_28091 = squot32(virt_group_id_28090,\n                                                sext_i64_i32(num_groups_28067));\n        int32_t gid_in_segment_28092 = srem32(virt_group_id_28090,\n                                              sext_i64_i32(num_groups_28067));\n        int32_t pgtid_in_segment_28093 = gid_in_segment_28092 *\n                sext_i64_i32(max_group_sizze_28066) + local_tid_28084;\n        int32_t threads_per_segment_28094 = sext_i64_i32(num_groups_28067 *\n                max_group_sizze_28066);\n        __local char *subhistogram_local_mem_28095;\n        \n        subhistogram_local_mem_28095 = (__local\n                                        char *) subhistogram_local_mem_28095_backing_0;\n        \n        __local char *locks_mem_28097;\n        \n        locks_mem_28097 = (__local char *) locks_mem_28097_backing_1;\n        // All locks start out unlocked\n        {\n            for (int64_t i_28099 = 0; i_28099 < sdiv_up64(hist_M_28073 *\n                                                          hist_H_chk_28080 -\n                                                          sext_i32_i64(local_tid_28084),\n                                                          max_group_sizze_28066);\n                 i_28099++) {\n                ((__local int32_t *) locks_mem_28097)[squot64(i_28099 *\n                                                              max_group_sizze_28066 +\n                                                              sext_i32_i64(local_tid_28084),\n                                                              hist_H_chk_28080) *\n                                                      hist_H_chk_28080 +\n                                                      (i_28099 *\n                                                       max_group_sizze_28066 +\n                                                       sext_i32_i64(local_tid_28084) -\n                                                       squot64(i_28099 *\n                        ",
                   "                                       max_group_sizze_28066 +\n                                                               sext_i32_i64(local_tid_28084),\n                                                               hist_H_chk_28080) *\n                                                       hist_H_chk_28080)] = 0;\n            }\n        }\n        \n        int32_t thread_local_subhisto_i_28100;\n        \n        thread_local_subhisto_i_28100 = srem32(local_tid_28084, hist_M_28073);\n        // initialize histograms in local memory\n        {\n            for (int32_t local_i_28101 = 0; local_i_28101 <\n                 init_per_thread_28082; local_i_28101++) {\n                int32_t j_28102 = local_i_28101 *\n                        sext_i64_i32(max_group_sizze_28066) + local_tid_28084;\n                int32_t j_offset_28103 = hist_M_28073 *\n                        sext_i64_i32(histo_sizze_28081) * gid_in_segment_28092 +\n                        j_28102;\n                int32_t local_subhisto_i_28104 = squot32(j_28102,\n                                                         sext_i64_i32(histo_sizze_28081));\n                int32_t global_subhisto_i_28105 = squot32(j_offset_28103,\n                                                          sext_i64_i32(histo_sizze_28081));\n                \n                if (slt32(j_28102, hist_M_28073 *\n                          sext_i64_i32(histo_sizze_28081))) {\n                    // First subhistogram is initialised from global memory; others with neutral element.\n                    {\n                        if (global_subhisto_i_28105 == 0) {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_28095)[sext_i32_i64(local_subhisto_i_28104) *\n                                                                       hist_H_chk_28080 +\n                                                                       sext_i32_i64(srem32(j_28102,\n                                                          ",
                   "                                 sext_i64_i32(histo_sizze_28081)))] =\n                                ((__global\n                                  int64_t *) res_subhistos_mem_28057)[sext_i32_i64(srem32(j_28102,\n                                                                                          sext_i64_i32(histo_sizze_28081))) +\n                                                                      sext_i32_i64(chk_i_28078) *\n                                                                      hist_H_chk_28080];\n                        } else {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_28095)[sext_i32_i64(local_subhisto_i_28104) *\n                                                                       hist_H_chk_28080 +\n                                                                       sext_i32_i64(srem32(j_28102,\n                                                                                           sext_i64_i32(histo_sizze_28081)))] =\n                                0;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_28106 = 0; i_28106 <\n             sdiv_up32(sext_i64_i32(binop_x_27689) - pgtid_in_segment_28093,\n                       threads_per_segment_28094); i_28106++) {\n            int32_t gtid_25350 = i_28106 * threads_per_segment_28094 +\n                    pgtid_in_segment_28093;\n            int64_t i_p_o_27547 = add64(-1, gtid_25350);\n            int64_t rot_i_27548 = smod64(i_p_o_27547, binop_x_27689);\n            bool cond_25357 = gtid_25350 == 0;\n            int64_t res_25358;\n            \n            if (cond_25357) {\n                res_25358 = 0;\n            } else {\n                int64_t x_25356 = ((__global int64_t *) mem_27737)[rot_i_27548];\n                \n                res_25358 = x_25356;\n            }\n            if (chk_i_28078 == 0) {\n                // save map-",
                   "out results\n                { }\n            }\n            // perform atomic updates\n            {\n                if (slt64(res_25358, res_23550) &&\n                    (sle64(sext_i32_i64(chk_i_28078) * hist_H_chk_28080,\n                           res_25358) && slt64(res_25358,\n                                               sext_i32_i64(chk_i_28078) *\n                                               hist_H_chk_28080 +\n                                               hist_H_chk_28080))) {\n                    int64_t x_25352;\n                    int64_t x_25353;\n                    \n                    x_25353 = gtid_25350;\n                    \n                    int32_t old_28107;\n                    volatile bool continue_28108;\n                    \n                    continue_28108 = 1;\n                    while (continue_28108) {\n                        old_28107 = atomic_cmpxchg_i32_local(&((volatile __local\n                                                                int *) locks_mem_28097)[sext_i32_i64(thread_local_subhisto_i_28100) *\n                                                                                        hist_H_chk_28080 +\n                                                                                        (res_25358 -\n                                                                                         sext_i32_i64(chk_i_28078) *\n                                                                                         hist_H_chk_28080)],\n                                                             0, 1);\n                        if (old_28107 == 0) {\n                            int64_t x_25352;\n                            \n                            // bind lhs\n                            {\n                                x_25352 = ((volatile __local\n                                            int64_t *) subhistogram_local_mem_28095)[sext_i32_i64(thread_local_subhisto_i_28100) *\n                                                          ",
                   "                           hist_H_chk_28080 +\n                                                                                     (res_25358 -\n                                                                                      sext_i32_i64(chk_i_28078) *\n                                                                                      hist_H_chk_28080)];\n                            }\n                            // execute operation\n                            {\n                                int64_t res_25354 = smax64(x_25352, x_25353);\n                                \n                                x_25352 = res_25354;\n                            }\n                            // update global result\n                            {\n                                ((volatile __local\n                                  int64_t *) subhistogram_local_mem_28095)[sext_i32_i64(thread_local_subhisto_i_28100) *\n                                                                           hist_H_chk_28080 +\n                                                                           (res_25358 -\n                                                                            sext_i32_i64(chk_i_28078) *\n                                                                            hist_H_chk_28080)] =\n                                    x_25352;\n                            }\n                            mem_fence_local();\n                            old_28107 =\n                                atomic_cmpxchg_i32_local(&((volatile __local\n                                                            int *) locks_mem_28097)[sext_i32_i64(thread_local_subhisto_i_28100) *\n                                                                                    hist_H_chk_28080 +\n                                                                                    (res_25358 -\n                                                                                     sext_i32_i64(chk_i_28078) *\n              ",
                   "                                                                       hist_H_chk_28080)],\n                                                         1, 0);\n                            continue_28108 = 0;\n                        }\n                        mem_fence_local();\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Compact the multiple local memory subhistograms to result in global memory\n        {\n            int64_t trunc_H_28109 = smin64(hist_H_chk_28080, res_23550 -\n                                           sext_i32_i64(chk_i_28078) *\n                                           hist_H_chk_28080);\n            int32_t histo_sizze_28110 = sext_i64_i32(trunc_H_28109);\n            \n            for (int32_t local_i_28111 = 0; local_i_28111 <\n                 init_per_thread_28082; local_i_28111++) {\n                int32_t j_28112 = local_i_28111 *\n                        sext_i64_i32(max_group_sizze_28066) + local_tid_28084;\n                \n                if (slt32(j_28112, histo_sizze_28110)) {\n                    int64_t x_25352;\n                    int64_t x_25353;\n                    \n                    // Read values from subhistogram 0.\n                    {\n                        x_25352 = ((__local\n                                    int64_t *) subhistogram_local_mem_28095)[sext_i32_i64(j_28112)];\n                    }\n                    // Accumulate based on values in other subhistograms.\n                    {\n                        for (int32_t subhisto_id_28113 = 0; subhisto_id_28113 <\n                             hist_M_28073 - 1; subhisto_id_28113++) {\n                            x_25353 = ((__local\n                                        int64_t *) subhistogram_local_mem_28095)[(sext_i32_i64(subhisto_id_28113) +\n                                                                                  1) *\n                                                                                 hi",
                   "st_H_chk_28080 +\n                                                                                 sext_i32_i64(j_28112)];\n                            \n                            int64_t res_25354;\n                            \n                            res_25354 = smax64(x_25352, x_25353);\n                            x_25352 = res_25354;\n                        }\n                    }\n                    // Put final bucket value in global memory.\n                    {\n                        ((__global\n                          int64_t *) res_subhistos_mem_28057)[srem64(sext_i32_i64(virt_group_id_28090),\n                                                                     num_groups_28067) *\n                                                              res_23550 +\n                                                              (sext_i32_i64(j_28112) +\n                                                               sext_i32_i64(chk_i_28078) *\n                                                               hist_H_chk_28080)] =\n                            x_25352;\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\n__kernel void mainzisegmap_24279(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, int64_t n_23343,\n                                 float a_23351, float r0_23354, float x_23371,\n                                 float x_23373, float y_23375, float y_23376,\n                                 __global unsigned char *swap_term_mem_27633,\n                                 __global unsigned char *payments_mem_27634,\n                                 __global unsigned char *mem_27647)\n{\n    #define segmap_group_sizze_24345 (mainzisegmap_group_sizze_24281)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    ",
                   "\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27906;\n    int32_t local_tid_27907;\n    int64_t group_sizze_27910;\n    int32_t wave_sizze_27909;\n    int32_t group_tid_27908;\n    \n    global_tid_27906 = get_global_id(0);\n    local_tid_27907 = get_local_id(0);\n    group_sizze_27910 = get_local_size(0);\n    wave_sizze_27909 = LOCKSTEP_WIDTH;\n    group_tid_27908 = get_group_id(0);\n    \n    int32_t phys_tid_24279;\n    \n    phys_tid_24279 = global_tid_27906;\n    \n    int64_t gtid_24278;\n    \n    gtid_24278 = sext_i32_i64(group_tid_27908) * segmap_group_sizze_24345 +\n        sext_i32_i64(local_tid_27907);\n    if (slt64(gtid_24278, n_23343)) {\n        float res_24356 = ((__global float *) swap_term_mem_27633)[gtid_24278];\n        int64_t res_24357 = ((__global\n                              int64_t *) payments_mem_27634)[gtid_24278];\n        bool bounds_invalid_upwards_24359 = slt64(res_24357, 1);\n        bool valid_24360 = !bounds_invalid_upwards_24359;\n        bool range_valid_c_24361;\n        \n        if (!valid_24360) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 0) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = 2;\n                    global_failure_args[2] = res_24357;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        bool y_24363 = slt64(0, res_24357);\n        bool index_certs_24364;\n        \n        if (!y_24363) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 1) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_24357;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_24365 = sitofp_i64_f32(res_24357);\n        float index_primexp_24366 = res_24356 * binop_y_24365;\n        float negate_arg_24367 = a_23351 * index_primexp_24366;\n        float e",
                   "xp_arg_24368 = 0.0F - negate_arg_24367;\n        float res_24369 = fpow32(2.7182817F, exp_arg_24368);\n        float x_24370 = 1.0F - res_24369;\n        float B_24371 = x_24370 / a_23351;\n        float x_24372 = B_24371 - index_primexp_24366;\n        float x_24373 = y_23375 * x_24372;\n        float A1_24374 = x_24373 / x_23371;\n        float y_24375 = fpow32(B_24371, 2.0F);\n        float x_24376 = x_23373 * y_24375;\n        float A2_24377 = x_24376 / y_23376;\n        float exp_arg_24378 = A1_24374 - A2_24377;\n        float res_24379 = fpow32(2.7182817F, exp_arg_24378);\n        float negate_arg_24380 = r0_23354 * B_24371;\n        float exp_arg_24381 = 0.0F - negate_arg_24380;\n        float res_24382 = fpow32(2.7182817F, exp_arg_24381);\n        float res_24383 = res_24379 * res_24382;\n        float res_24384;\n        float redout_27455 = 0.0F;\n        \n        for (int64_t i_27456 = 0; i_27456 < res_24357; i_27456++) {\n            int64_t index_primexp_27574 = add64(1, i_27456);\n            float res_24389 = sitofp_i64_f32(index_primexp_27574);\n            float res_24390 = res_24356 * res_24389;\n            float negate_arg_24391 = a_23351 * res_24390;\n            float exp_arg_24392 = 0.0F - negate_arg_24391;\n            float res_24393 = fpow32(2.7182817F, exp_arg_24392);\n            float x_24394 = 1.0F - res_24393;\n            float B_24395 = x_24394 / a_23351;\n            float x_24396 = B_24395 - res_24390;\n            float x_24397 = y_23375 * x_24396;\n            float A1_24398 = x_24397 / x_23371;\n            float y_24399 = fpow32(B_24395, 2.0F);\n            float x_24400 = x_23373 * y_24399;\n            float A2_24401 = x_24400 / y_23376;\n            float exp_arg_24402 = A1_24398 - A2_24401;\n            float res_24403 = fpow32(2.7182817F, exp_arg_24402);\n            float negate_arg_24404 = r0_23354 * B_24395;\n            float exp_arg_24405 = 0.0F - negate_arg_24404;\n            float res_24406 = fpow32(2.7182817F, exp_arg_24405);\n            float res_24",
                   "407 = res_24403 * res_24406;\n            float res_24387 = res_24407 + redout_27455;\n            float redout_tmp_27911 = res_24387;\n            \n            redout_27455 = redout_tmp_27911;\n        }\n        res_24384 = redout_27455;\n        \n        float x_24408 = 1.0F - res_24383;\n        float y_24409 = res_24356 * res_24384;\n        float res_24410 = x_24408 / y_24409;\n        \n        ((__global float *) mem_27647)[gtid_24278] = res_24410;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_24345\n}\n__kernel void mainzisegmap_24428(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, int64_t n_23343,\n                                 float a_23351, float r0_23354, float x_23371,\n                                 float x_23373, float y_23375, float y_23376,\n                                 __global unsigned char *swap_term_mem_27633,\n                                 __global unsigned char *payments_mem_27634,\n                                 __global unsigned char *mem_27656)\n{\n    #define segmap_group_sizze_24494 (mainzisegmap_group_sizze_24430)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27912;\n    int32_t local_tid_27913;\n    int64_t group_sizze_27916;\n    int32_t wave_sizze_27915;\n    int32_t group_tid_27914;\n    \n    global_tid_27912 = get_global_id(0);\n    local_tid_27913 = get_local_id(0);\n    group_sizze_27916 = get_local_size(0);\n    wave_sizze_27915 = LOCKSTEP_WIDTH;\n    group_tid_27914 = get_group_id(0);\n    \n    int32_t phys_tid_24428;\n    \n    phys_tid_24428 = global_tid_27912;\n    \n    int64_t gtid_24427;\n    \n    gtid_24427 = sext_i32_i64(group_tid_27914) * segmap_group_sizze_24494 +\n        sext_i32_i64(local_tid_27913);\n    if (slt64(gtid_24427, n_23343)) {\n        float res_24505 = ((__global float *",
                   ") swap_term_mem_27633)[gtid_24427];\n        int64_t res_24506 = ((__global\n                              int64_t *) payments_mem_27634)[gtid_24427];\n        bool bounds_invalid_upwards_24508 = slt64(res_24506, 1);\n        bool valid_24509 = !bounds_invalid_upwards_24508;\n        bool range_valid_c_24510;\n        \n        if (!valid_24509) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 2) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = 2;\n                    global_failure_args[2] = res_24506;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        bool y_24512 = slt64(0, res_24506);\n        bool index_certs_24513;\n        \n        if (!y_24512) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 3) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_24506;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_24514 = sitofp_i64_f32(res_24506);\n        float index_primexp_24515 = res_24505 * binop_y_24514;\n        float negate_arg_24516 = a_23351 * index_primexp_24515;\n        float exp_arg_24517 = 0.0F - negate_arg_24516;\n        float res_24518 = fpow32(2.7182817F, exp_arg_24517);\n        float x_24519 = 1.0F - res_24518;\n        float B_24520 = x_24519 / a_23351;\n        float x_24521 = B_24520 - index_primexp_24515;\n        float x_24522 = y_23375 * x_24521;\n        float A1_24523 = x_24522 / x_23371;\n        float y_24524 = fpow32(B_24520, 2.0F);\n        float x_24525 = x_23373 * y_24524;\n        float A2_24526 = x_24525 / y_23376;\n        float exp_arg_24527 = A1_24523 - A2_24526;\n        float res_24528 = fpow32(2.7182817F, exp_arg_24527);\n        float negate_arg_24529 = r0_23354 * B_24520;\n        float exp_arg_24530 = 0.0F - negate_arg_24529;\n        float res_24531 = fpow32(",
                   "2.7182817F, exp_arg_24530);\n        float res_24532 = res_24528 * res_24531;\n        float res_24533;\n        float redout_27459 = 0.0F;\n        \n        for (int64_t i_27460 = 0; i_27460 < res_24506; i_27460++) {\n            int64_t index_primexp_27576 = add64(1, i_27460);\n            float res_24538 = sitofp_i64_f32(index_primexp_27576);\n            float res_24539 = res_24505 * res_24538;\n            float negate_arg_24540 = a_23351 * res_24539;\n            float exp_arg_24541 = 0.0F - negate_arg_24540;\n            float res_24542 = fpow32(2.7182817F, exp_arg_24541);\n            float x_24543 = 1.0F - res_24542;\n            float B_24544 = x_24543 / a_23351;\n            float x_24545 = B_24544 - res_24539;\n            float x_24546 = y_23375 * x_24545;\n            float A1_24547 = x_24546 / x_23371;\n            float y_24548 = fpow32(B_24544, 2.0F);\n            float x_24549 = x_23373 * y_24548;\n            float A2_24550 = x_24549 / y_23376;\n            float exp_arg_24551 = A1_24547 - A2_24550;\n            float res_24552 = fpow32(2.7182817F, exp_arg_24551);\n            float negate_arg_24553 = r0_23354 * B_24544;\n            float exp_arg_24554 = 0.0F - negate_arg_24553;\n            float res_24555 = fpow32(2.7182817F, exp_arg_24554);\n            float res_24556 = res_24552 * res_24555;\n            float res_24536 = res_24556 + redout_27459;\n            float redout_tmp_27917 = res_24536;\n            \n            redout_27459 = redout_tmp_27917;\n        }\n        res_24533 = redout_27459;\n        \n        float x_24557 = 1.0F - res_24532;\n        float y_24558 = res_24505 * res_24533;\n        float res_24559 = x_24557 / y_24558;\n        \n        ((__global float *) mem_27656)[gtid_24427] = res_24559;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_24494\n}\n__kernel void mainzisegmap_24906(__global int *global_failure, int64_t n_23343,\n                                 int64_t paths_23346, int64_t steps_23347,\n                                 floa",
                   "t sims_per_year_23441, __global\n                                 unsigned char *mem_27732)\n{\n    #define segmap_group_sizze_25316 (mainzisegmap_group_sizze_24910)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27958;\n    int32_t local_tid_27959;\n    int64_t group_sizze_27962;\n    int32_t wave_sizze_27961;\n    int32_t group_tid_27960;\n    \n    global_tid_27958 = get_global_id(0);\n    local_tid_27959 = get_local_id(0);\n    group_sizze_27962 = get_local_size(0);\n    wave_sizze_27961 = LOCKSTEP_WIDTH;\n    group_tid_27960 = get_group_id(0);\n    \n    int32_t phys_tid_24906;\n    \n    phys_tid_24906 = global_tid_27958;\n    \n    int64_t gtid_24903;\n    \n    gtid_24903 = squot64(sext_i32_i64(group_tid_27960) *\n                         segmap_group_sizze_25316 +\n                         sext_i32_i64(local_tid_27959), steps_23347 * n_23343);\n    \n    int64_t gtid_24904;\n    \n    gtid_24904 = squot64(sext_i32_i64(group_tid_27960) *\n                         segmap_group_sizze_25316 +\n                         sext_i32_i64(local_tid_27959) -\n                         squot64(sext_i32_i64(group_tid_27960) *\n                                 segmap_group_sizze_25316 +\n                                 sext_i32_i64(local_tid_27959), steps_23347 *\n                                 n_23343) * (steps_23347 * n_23343), n_23343);\n    \n    int64_t gtid_24905;\n    \n    gtid_24905 = sext_i32_i64(group_tid_27960) * segmap_group_sizze_25316 +\n        sext_i32_i64(local_tid_27959) - squot64(sext_i32_i64(group_tid_27960) *\n                                                segmap_group_sizze_25316 +\n                                                sext_i32_i64(local_tid_27959),\n                                                steps_23347 * n_23343) *\n        (steps_23347 * n_23343) - squot64(sext_i32_i64(group_tid_27960) *\n                                          segmap_group_siz",
                   "ze_25316 +\n                                          sext_i32_i64(local_tid_27959) -\n                                          squot64(sext_i32_i64(group_tid_27960) *\n                                                  segmap_group_sizze_25316 +\n                                                  sext_i32_i64(local_tid_27959),\n                                                  steps_23347 * n_23343) *\n                                          (steps_23347 * n_23343), n_23343) *\n        n_23343;\n    if ((slt64(gtid_24903, paths_23346) && slt64(gtid_24904, steps_23347)) &&\n        slt64(gtid_24905, n_23343)) {\n        int64_t convop_x_27479 = add64(1, gtid_24904);\n        float binop_x_27480 = sitofp_i64_f32(convop_x_27479);\n        float index_primexp_27481 = binop_x_27480 / sims_per_year_23441;\n        \n        ((__global float *) mem_27732)[gtid_24903 * (n_23343 * steps_23347) +\n                                       gtid_24904 * n_23343 + gtid_24905] =\n            index_primexp_27481;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25316\n}\n__kernel void mainzisegmap_24944(__global int *global_failure, int64_t n_23343,\n                                 int64_t paths_23346, int64_t steps_23347,\n                                 __global unsigned char *mem_27722, __global\n                                 unsigned char *mem_27727)\n{\n    #define segmap_group_sizze_25298 (mainzisegmap_group_sizze_24948)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27953;\n    int32_t local_tid_27954;\n    int64_t group_sizze_27957;\n    int32_t wave_sizze_27956;\n    int32_t group_tid_27955;\n    \n    global_tid_27953 = get_global_id(0);\n    local_tid_27954 = get_local_id(0);\n    group_sizze_27957 = get_local_size(0);\n    wave_sizze_27956 = LOCKSTEP_WIDTH;\n    group_tid_27955 = get_group_id(0);\n    \n    int32_t phys_tid_24944;\n    \n    phys_tid_24944 = glo",
                   "bal_tid_27953;\n    \n    int64_t gtid_24941;\n    \n    gtid_24941 = squot64(sext_i32_i64(group_tid_27955) *\n                         segmap_group_sizze_25298 +\n                         sext_i32_i64(local_tid_27954), steps_23347 * n_23343);\n    \n    int64_t gtid_24942;\n    \n    gtid_24942 = squot64(sext_i32_i64(group_tid_27955) *\n                         segmap_group_sizze_25298 +\n                         sext_i32_i64(local_tid_27954) -\n                         squot64(sext_i32_i64(group_tid_27955) *\n                                 segmap_group_sizze_25298 +\n                                 sext_i32_i64(local_tid_27954), steps_23347 *\n                                 n_23343) * (steps_23347 * n_23343), n_23343);\n    \n    int64_t gtid_24943;\n    \n    gtid_24943 = sext_i32_i64(group_tid_27955) * segmap_group_sizze_25298 +\n        sext_i32_i64(local_tid_27954) - squot64(sext_i32_i64(group_tid_27955) *\n                                                segmap_group_sizze_25298 +\n                                                sext_i32_i64(local_tid_27954),\n                                                steps_23347 * n_23343) *\n        (steps_23347 * n_23343) - squot64(sext_i32_i64(group_tid_27955) *\n                                          segmap_group_sizze_25298 +\n                                          sext_i32_i64(local_tid_27954) -\n                                          squot64(sext_i32_i64(group_tid_27955) *\n                                                  segmap_group_sizze_25298 +\n                                                  sext_i32_i64(local_tid_27954),\n                                                  steps_23347 * n_23343) *\n                                          (steps_23347 * n_23343), n_23343) *\n        n_23343;\n    if ((slt64(gtid_24941, paths_23346) && slt64(gtid_24942, steps_23347)) &&\n        slt64(gtid_24943, n_23343)) {\n        float x_25301 = ((__global float *) mem_27722)[gtid_24942 *\n                                                    ",
                   "   paths_23346 +\n                                                       gtid_24941];\n        \n        ((__global float *) mem_27727)[gtid_24941 * (n_23343 * steps_23347) +\n                                       gtid_24942 * n_23343 + gtid_24943] =\n            x_25301;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25298\n}\n__kernel void mainzisegmap_25001(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args,\n                                 int64_t paths_23346, int64_t steps_23347,\n                                 float a_23351, float b_23352,\n                                 float sigma_23353, float r0_23354,\n                                 float dt_23369, int64_t upper_bound_23455,\n                                 float res_23456, int64_t num_groups_25253,\n                                 __global unsigned char *mem_27704, __global\n                                 unsigned char *mem_27707, __global\n                                 unsigned char *mem_27722)\n{\n    #define segmap_group_sizze_25252 (mainzisegmap_group_sizze_25003)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27942;\n    int32_t local_tid_27943;\n    int64_t group_sizze_27946;\n    int32_t wave_sizze_27945;\n    int32_t group_tid_27944;\n    \n    global_tid_27942 = get_global_id(0);\n    local_tid_27943 = get_local_id(0);\n    group_sizze_27946 = get_local_size(0);\n    wave_sizze_27945 = LOCKSTEP_WIDTH;\n    group_tid_27944 = get_group_id(0);\n    \n    int32_t phys_tid_25001;\n    \n    phys_tid_25001 = global_tid_27942;\n    \n    int32_t phys_group_id_27947;\n    \n    phys_group_id_2",
                   "7947 = get_group_id(0);\n    for (int32_t i_27948 = 0; i_27948 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(paths_23346,\n                                          segmap_group_sizze_25252)) -\n                   phys_group_id_27947, sext_i64_i32(num_groups_25253));\n         i_27948++) {\n        int32_t virt_group_id_27949 = phys_group_id_27947 + i_27948 *\n                sext_i64_i32(num_groups_25253);\n        int64_t gtid_25000 = sext_i32_i64(virt_group_id_27949) *\n                segmap_group_sizze_25252 + sext_i32_i64(local_tid_27943);\n        \n        if (slt64(gtid_25000, paths_23346)) {\n            for (int64_t i_27950 = 0; i_27950 < steps_23347; i_27950++) {\n                ((__global float *) mem_27707)[phys_tid_25001 + i_27950 *\n                                               (num_groups_25253 *\n                                                segmap_group_sizze_25252)] =\n                    r0_23354;\n            }\n            for (int64_t i_25259 = 0; i_25259 < upper_bound_23455; i_25259++) {\n                bool y_25261 = slt64(i_25259, steps_23347);\n                bool index_certs_25262;\n                \n                if (!y_25261) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 6) ==\n                            -1) {\n                            global_failure_args[0] = i_25259;\n                            global_failure_args[1] = steps_23347;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float shortstep_arg_25263 = ((__global\n                                              float *) mem_27704)[i_25259 *\n                                                                  paths_23346 +\n                                                                  gtid_25000];\n                float shortstep_arg_25264 = ((__global\n                                ",
                   "              float *) mem_27707)[phys_tid_25001 +\n                                                                  i_25259 *\n                                                                  (num_groups_25253 *\n                                                                   segmap_group_sizze_25252)];\n                float y_25265 = b_23352 - shortstep_arg_25264;\n                float x_25266 = a_23351 * y_25265;\n                float x_25267 = dt_23369 * x_25266;\n                float x_25268 = res_23456 * shortstep_arg_25263;\n                float y_25269 = sigma_23353 * x_25268;\n                float delta_r_25270 = x_25267 + y_25269;\n                float res_25271 = shortstep_arg_25264 + delta_r_25270;\n                int64_t i_25272 = add64(1, i_25259);\n                bool x_25273 = sle64(0, i_25272);\n                bool y_25274 = slt64(i_25272, steps_23347);\n                bool bounds_check_25275 = x_25273 && y_25274;\n                bool index_certs_25276;\n                \n                if (!bounds_check_25275) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 7) ==\n                            -1) {\n                            global_failure_args[0] = i_25272;\n                            global_failure_args[1] = steps_23347;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                ((__global float *) mem_27707)[phys_tid_25001 + i_25272 *\n                                               (num_groups_25253 *\n                                                segmap_group_sizze_25252)] =\n                    res_25271;\n            }\n            for (int64_t i_27952 = 0; i_27952 < steps_23347; i_27952++) {\n                ((__global float *) mem_27722)[i_27952 * paths_23346 +\n                                               gtid_25000] = ((__global\n                             ",
                   "                                  float *) mem_27707)[phys_tid_25001 +\n                                                                                   i_27952 *\n                                                                                   (num_groups_25253 *\n                                                                                    segmap_group_sizze_25252)];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25252\n}\n__kernel void mainzisegmap_25099(__global int *global_failure,\n                                 int64_t paths_23346, int64_t steps_23347,\n                                 __global unsigned char *mem_27697, __global\n                                 unsigned char *mem_27701)\n{\n    #define segmap_group_sizze_25207 (mainzisegmap_group_sizze_25102)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27937;\n    int32_t local_tid_27938;\n    int64_t group_sizze_27941;\n    int32_t wave_sizze_27940;\n    int32_t group_tid_27939;\n    \n    global_tid_27937 = get_global_id(0);\n    local_tid_27938 = get_local_id(0);\n    group_sizze_27941 = get_local_size(0);\n    wave_sizze_27940 = LOCKSTEP_WIDTH;\n    group_tid_27939 = get_group_id(0);\n    \n    int32_t phys_tid_25099;\n    \n    phys_tid_25099 = global_tid_27937;\n    \n    int64_t gtid_25097;\n    \n    gtid_25097 = squot64(sext_i32_i64(group_tid_27939) *\n                         segmap_group_sizze_25207 +\n                         sext_i32_i64(local_tid_27938), steps_23347);\n    \n    int64_t gtid_25098;\n    \n    gtid_25098 = sext_i32_i64(group_tid_27939) * segmap_group_sizze_25207 +\n        sext_i32_i64(local_tid_27938) - squot64(sext_i32_i64(group_tid_27939) *\n                                                segmap_group_sizze_25207 +\n                                                sext_i32_",
                   "i64(local_tid_27938),\n                                                steps_23347) * steps_23347;\n    if (slt64(gtid_25097, paths_23346) && slt64(gtid_25098, steps_23347)) {\n        int32_t unsign_arg_25210 = ((__global int32_t *) mem_27697)[gtid_25097];\n        int32_t res_25212 = sext_i64_i32(gtid_25098);\n        int32_t x_25213 = lshr32(res_25212, 16);\n        int32_t x_25214 = res_25212 ^ x_25213;\n        int32_t x_25215 = mul32(73244475, x_25214);\n        int32_t x_25216 = lshr32(x_25215, 16);\n        int32_t x_25217 = x_25215 ^ x_25216;\n        int32_t x_25218 = mul32(73244475, x_25217);\n        int32_t x_25219 = lshr32(x_25218, 16);\n        int32_t x_25220 = x_25218 ^ x_25219;\n        int32_t unsign_arg_25221 = unsign_arg_25210 ^ x_25220;\n        int32_t unsign_arg_25222 = mul32(48271, unsign_arg_25221);\n        int32_t unsign_arg_25223 = umod32(unsign_arg_25222, 2147483647);\n        int32_t unsign_arg_25224 = mul32(48271, unsign_arg_25223);\n        int32_t unsign_arg_25225 = umod32(unsign_arg_25224, 2147483647);\n        float res_25226 = uitofp_i32_f32(unsign_arg_25223);\n        float res_25227 = res_25226 / 2.1474836e9F;\n        float res_25228 = uitofp_i32_f32(unsign_arg_25225);\n        float res_25229 = res_25228 / 2.1474836e9F;\n        float res_25230;\n        \n        res_25230 = futrts_log32(res_25227);\n        \n        float res_25231 = -2.0F * res_25230;\n        float res_25232;\n        \n        res_25232 = futrts_sqrt32(res_25231);\n        \n        float res_25233 = 6.2831855F * res_25229;\n        float res_25234;\n        \n        res_25234 = futrts_cos32(res_25233);\n        \n        float res_25235 = res_25232 * res_25234;\n        \n        ((__global float *) mem_27701)[gtid_25097 * steps_23347 + gtid_25098] =\n            res_25235;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25207\n}\n__kernel void mainzisegmap_25163(__global int *global_failure,\n                                 int64_t paths_23346, __global\n                     ",
                   "            unsigned char *mem_27697)\n{\n    #define segmap_group_sizze_25182 (mainzisegmap_group_sizze_25165)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27932;\n    int32_t local_tid_27933;\n    int64_t group_sizze_27936;\n    int32_t wave_sizze_27935;\n    int32_t group_tid_27934;\n    \n    global_tid_27932 = get_global_id(0);\n    local_tid_27933 = get_local_id(0);\n    group_sizze_27936 = get_local_size(0);\n    wave_sizze_27935 = LOCKSTEP_WIDTH;\n    group_tid_27934 = get_group_id(0);\n    \n    int32_t phys_tid_25163;\n    \n    phys_tid_25163 = global_tid_27932;\n    \n    int64_t gtid_25162;\n    \n    gtid_25162 = sext_i32_i64(group_tid_27934) * segmap_group_sizze_25182 +\n        sext_i32_i64(local_tid_27933);\n    if (slt64(gtid_25162, paths_23346)) {\n        int32_t res_25186 = sext_i64_i32(gtid_25162);\n        int32_t x_25187 = lshr32(res_25186, 16);\n        int32_t x_25188 = res_25186 ^ x_25187;\n        int32_t x_25189 = mul32(73244475, x_25188);\n        int32_t x_25190 = lshr32(x_25189, 16);\n        int32_t x_25191 = x_25189 ^ x_25190;\n        int32_t x_25192 = mul32(73244475, x_25191);\n        int32_t x_25193 = lshr32(x_25192, 16);\n        int32_t x_25194 = x_25192 ^ x_25193;\n        int32_t unsign_arg_25195 = 777822902 ^ x_25194;\n        int32_t unsign_arg_25196 = mul32(48271, unsign_arg_25195);\n        int32_t unsign_arg_25197 = umod32(unsign_arg_25196, 2147483647);\n        \n        ((__global int32_t *) mem_27697)[gtid_25162] = unsign_arg_25197;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25182\n}\n__kernel void mainzisegmap_25436(__global int *global_failure,\n                                 int64_t res_23550, int64_t num_segments_23748,\n                                 __global unsigned char *mem_27757, __global\n                                 unsigned char *mem_27762, __global\n                                 unsigne",
                   "d char *mem_27765, __global\n                                 unsigned char *mem_27767)\n{\n    #define segmap_group_sizze_25439 (mainzisegmap_group_sizze_25438)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28464;\n    int32_t local_tid_28465;\n    int64_t group_sizze_28468;\n    int32_t wave_sizze_28467;\n    int32_t group_tid_28466;\n    \n    global_tid_28464 = get_global_id(0);\n    local_tid_28465 = get_local_id(0);\n    group_sizze_28468 = get_local_size(0);\n    wave_sizze_28467 = LOCKSTEP_WIDTH;\n    group_tid_28466 = get_group_id(0);\n    \n    int32_t phys_tid_25436;\n    \n    phys_tid_25436 = global_tid_28464;\n    \n    int64_t write_i_25435;\n    \n    write_i_25435 = sext_i32_i64(group_tid_28466) * segmap_group_sizze_25439 +\n        sext_i32_i64(local_tid_28465);\n    if (slt64(write_i_25435, res_23550)) {\n        int64_t i_p_o_27555 = add64(1, write_i_25435);\n        int64_t rot_i_27556 = smod64(i_p_o_27555, res_23550);\n        bool x_23761 = ((__global bool *) mem_27757)[rot_i_27556];\n        float write_value_23762 = ((__global float *) mem_27762)[write_i_25435];\n        int64_t res_23763;\n        \n        if (x_23761) {\n            int64_t x_23760 = ((__global int64_t *) mem_27765)[write_i_25435];\n            int64_t res_23764 = sub64(x_23760, 1);\n            \n            res_23763 = res_23764;\n        } else {\n            res_23763 = -1;\n        }\n        if (sle64(0, res_23763) && slt64(res_23763, num_segments_23748)) {\n            ((__global float *) mem_27767)[res_23763] = write_value_23762;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25439\n}\n__kernel void mainzisegmap_25508(__global int *global_failure, int64_t n_23343,\n                                 int64_t paths_23346, int64_t steps_23347,\n                                 float a_23351, float x_23371, float x_23373,\n                                 float",
                   " y_23375, float y_23376,\n                                 float sims_per_year_23441, float res_23769,\n                                 __global unsigned char *mem_27789, __global\n                                 unsigned char *mem_27792, __global\n                                 unsigned char *mem_27794)\n{\n    #define segmap_group_sizze_25739 (mainzisegmap_group_sizze_25510)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28514;\n    int32_t local_tid_28515;\n    int64_t group_sizze_28518;\n    int32_t wave_sizze_28517;\n    int32_t group_tid_28516;\n    \n    global_tid_28514 = get_global_id(0);\n    local_tid_28515 = get_local_id(0);\n    group_sizze_28518 = get_local_size(0);\n    wave_sizze_28517 = LOCKSTEP_WIDTH;\n    group_tid_28516 = get_group_id(0);\n    \n    int32_t phys_tid_25508;\n    \n    phys_tid_25508 = global_tid_28514;\n    \n    int64_t gtid_25507;\n    \n    gtid_25507 = sext_i32_i64(group_tid_28516) * segmap_group_sizze_25739 +\n        sext_i32_i64(local_tid_28515);\n    if (slt64(gtid_25507, steps_23347)) {\n        int64_t convop_x_27562 = add64(1, gtid_25507);\n        float binop_x_27563 = sitofp_i64_f32(convop_x_27562);\n        float index_primexp_27564 = binop_x_27563 / sims_per_year_23441;\n        float res_25745;\n        float redout_27616 = 0.0F;\n        \n        for (int64_t i_27617 = 0; i_27617 < paths_23346; i_27617++) {\n            float res_25750;\n            float redout_27618 = 0.0F;\n            \n            for (int64_t i_27619 = 0; i_27619 < n_23343; i_27619++) {\n                float x_25754 = ((__global float *) mem_27789)[i_27617 *\n                                                               (steps_23347 *\n                                                                n_23343) +\n                                                               i_27619 *\n                                                               steps_",
                   "23347 +\n                                                               gtid_25507];\n                float res_25753 = x_25754 + redout_27618;\n                float redout_tmp_28520 = res_25753;\n                \n                redout_27618 = redout_tmp_28520;\n            }\n            res_25750 = redout_27618;\n            \n            float res_25755 = fmax32(0.0F, res_25750);\n            float res_25748 = res_25755 + redout_27616;\n            float redout_tmp_28519 = res_25748;\n            \n            redout_27616 = redout_tmp_28519;\n        }\n        res_25745 = redout_27616;\n        \n        float res_25756 = res_25745 / res_23769;\n        float negate_arg_25757 = a_23351 * index_primexp_27564;\n        float exp_arg_25758 = 0.0F - negate_arg_25757;\n        float res_25759 = fpow32(2.7182817F, exp_arg_25758);\n        float x_25760 = 1.0F - res_25759;\n        float B_25761 = x_25760 / a_23351;\n        float x_25762 = B_25761 - index_primexp_27564;\n        float x_25763 = y_23375 * x_25762;\n        float A1_25764 = x_25763 / x_23371;\n        float y_25765 = fpow32(B_25761, 2.0F);\n        float x_25766 = x_23373 * y_25765;\n        float A2_25767 = x_25766 / y_23376;\n        float exp_arg_25768 = A1_25764 - A2_25767;\n        float res_25769 = fpow32(2.7182817F, exp_arg_25768);\n        float negate_arg_25770 = 5.0e-2F * B_25761;\n        float exp_arg_25771 = 0.0F - negate_arg_25770;\n        float res_25772 = fpow32(2.7182817F, exp_arg_25771);\n        float res_25773 = res_25769 * res_25772;\n        float res_25774 = res_25756 * res_25773;\n        \n        ((__global float *) mem_27792)[gtid_25507] = res_25774;\n        ((__global float *) mem_27794)[gtid_25507] = res_25756;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25739\n}\n__kernel void mainzisegmap_25623(__global int *global_failure,\n                                 int64_t steps_23347, float a_23351,\n                                 float x_23371, float x_23373, float y_23375,\n                  ",
                   "               float y_23376, float sims_per_year_23441,\n                                 float res_23769, __global\n                                 unsigned char *mem_27807, __global\n                                 unsigned char *mem_27810, __global\n                                 unsigned char *mem_27812)\n{\n    #define segmap_group_sizze_25829 (mainzisegmap_group_sizze_25625)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28594;\n    int32_t local_tid_28595;\n    int64_t group_sizze_28598;\n    int32_t wave_sizze_28597;\n    int32_t group_tid_28596;\n    \n    global_tid_28594 = get_global_id(0);\n    local_tid_28595 = get_local_id(0);\n    group_sizze_28598 = get_local_size(0);\n    wave_sizze_28597 = LOCKSTEP_WIDTH;\n    group_tid_28596 = get_group_id(0);\n    \n    int32_t phys_tid_25623;\n    \n    phys_tid_25623 = global_tid_28594;\n    \n    int64_t gtid_25622;\n    \n    gtid_25622 = sext_i32_i64(group_tid_28596) * segmap_group_sizze_25829 +\n        sext_i32_i64(local_tid_28595);\n    if (slt64(gtid_25622, steps_23347)) {\n        int64_t convop_x_27570 = add64(1, gtid_25622);\n        float binop_x_27571 = sitofp_i64_f32(convop_x_27570);\n        float index_primexp_27572 = binop_x_27571 / sims_per_year_23441;\n        float res_25834 = ((__global float *) mem_27807)[gtid_25622];\n        float res_25835 = res_25834 / res_23769;\n        float negate_arg_25836 = a_23351 * index_primexp_27572;\n        float exp_arg_25837 = 0.0F - negate_arg_25836;\n        float res_25838 = fpow32(2.7182817F, exp_arg_25837);\n        float x_25839 = 1.0F - res_25838;\n        float B_25840 = x_25839 / a_23351;\n        float x_25841 = B_25840 - index_primexp_27572;\n        float x_25842 = y_23375 * x_25841;\n        float A1_25843 = x_25842 / x_23371;\n        float y_25844 = fpow32(B_25840, 2.0F);\n        float x_25845 = x_23373 * y_25844;\n        float A2_25846 = x_25845 / y_",
                   "23376;\n        float exp_arg_25847 = A1_25843 - A2_25846;\n        float res_25848 = fpow32(2.7182817F, exp_arg_25847);\n        float negate_arg_25849 = 5.0e-2F * B_25840;\n        float exp_arg_25850 = 0.0F - negate_arg_25849;\n        float res_25851 = fpow32(2.7182817F, exp_arg_25850);\n        float res_25852 = res_25848 * res_25851;\n        float res_25853 = res_25835 * res_25852;\n        \n        ((__global float *) mem_27810)[gtid_25622] = res_25853;\n        ((__global float *) mem_27812)[gtid_25622] = res_25835;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25829\n}\n__kernel void mainzisegmap_intragroup_24645(__global int *global_failure,\n                                            int failure_is_an_option, __global\n                                            int64_t *global_failure_args,\n                                            __local volatile\n                                            int64_t *mem_27686_backing_aligned_0,\n                                            __local volatile\n                                            int64_t *mem_27682_backing_aligned_1,\n                                            __local volatile\n                                            int64_t *mem_27666_backing_aligned_2,\n                                            __local volatile\n                                            int64_t *mem_27664_backing_aligned_3,\n                                            int64_t n_23343,\n                                            int64_t steps_23347, float a_23351,\n                                            float b_23352, float sigma_23353,\n                                            float r0_23354, float dt_23369,\n                                            float sims_per_year_23441,\n                                            int64_t upper_bound_23455,\n                                            float res_23456,\n                                            int64_t computed_group_sizze_24602,\n                             ",
                   "               __global unsigned char *mem_27690,\n                                            __global unsigned char *mem_27694)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict mem_27686_backing_3 = (__local volatile\n                                                           char *) mem_27686_backing_aligned_0;\n    __local volatile char *restrict mem_27682_backing_2 = (__local volatile\n                                                           char *) mem_27682_backing_aligned_1;\n    __local volatile char *restrict mem_27666_backing_1 = (__local volatile\n                                                           char *) mem_27666_backing_aligned_2;\n    __local volatile char *restrict mem_27664_backing_0 = (__local volatile\n                                                           char *) mem_27664_backing_aligned_3;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27920;\n    int32_t local_tid_27921;\n    int64_t group_sizze_27924;\n    int32_t wave_sizze_27923;\n    int32_t group_tid_27922;\n    \n    global_tid_27920 = get_global_id(0);\n    local_tid_27921 = get_local_id(0);\n    group_sizze_27924 = get_local_size(0);\n    wave_sizze_27923 = LOCKSTEP_WIDTH;\n    group_tid_27922 = get_group_id(0);\n    \n    int32_t phys_tid_24645;\n    \n    phys_tid_24645 = group_tid_27922;\n    \n    int32_t ltid_pre_27925;\n    \n    ltid_pre_27925 = local_tid_27921;\n    \n    int32_t ltid_pre_27926;\n    \n    ltid_pre_27926 = squot32(local_tid_27921, sext_i64_i32(n_23343));\n    \n    int32_t ltid_pre_27927;\n    \n    ltid_pre_27927 = local_tid_27921 - squot32(local_tid_27921,\n                                               sext_i64_i32(n_23343)) *\n        sext_i64_i32(n_23343);\n    \n    int64_t gtid_24600;\n",
                   "    \n    gtid_24600 = sext_i32_i64(group_tid_27922);\n    \n    int32_t res_24800;\n    \n    res_24800 = sext_i64_i32(gtid_24600);\n    \n    int32_t x_24801 = lshr32(res_24800, 16);\n    int32_t x_24802 = res_24800 ^ x_24801;\n    int32_t x_24803 = mul32(73244475, x_24802);\n    int32_t x_24804 = lshr32(x_24803, 16);\n    int32_t x_24805 = x_24803 ^ x_24804;\n    int32_t x_24806 = mul32(73244475, x_24805);\n    int32_t x_24807 = lshr32(x_24806, 16);\n    int32_t x_24808 = x_24806 ^ x_24807;\n    int32_t unsign_arg_24809 = 777822902 ^ x_24808;\n    int32_t unsign_arg_24810 = mul32(48271, unsign_arg_24809);\n    int32_t unsign_arg_24811 = umod32(unsign_arg_24810, 2147483647);\n    __local char *mem_27664;\n    \n    mem_27664 = (__local char *) mem_27664_backing_0;\n    \n    int64_t gtid_24603 = sext_i32_i64(ltid_pre_27925);\n    int32_t phys_tid_24604 = local_tid_27921;\n    \n    if (slt64(gtid_24603, steps_23347)) {\n        int32_t res_24814 = sext_i64_i32(gtid_24603);\n        int32_t x_24815 = lshr32(res_24814, 16);\n        int32_t x_24816 = res_24814 ^ x_24815;\n        int32_t x_24817 = mul32(73244475, x_24816);\n        int32_t x_24818 = lshr32(x_24817, 16);\n        int32_t x_24819 = x_24817 ^ x_24818;\n        int32_t x_24820 = mul32(73244475, x_24819);\n        int32_t x_24821 = lshr32(x_24820, 16);\n        int32_t x_24822 = x_24820 ^ x_24821;\n        int32_t unsign_arg_24823 = unsign_arg_24811 ^ x_24822;\n        int32_t unsign_arg_24824 = mul32(48271, unsign_arg_24823);\n        int32_t unsign_arg_24825 = umod32(unsign_arg_24824, 2147483647);\n        int32_t unsign_arg_24826 = mul32(48271, unsign_arg_24825);\n        int32_t unsign_arg_24827 = umod32(unsign_arg_24826, 2147483647);\n        float res_24828 = uitofp_i32_f32(unsign_arg_24825);\n        float res_24829 = res_24828 / 2.1474836e9F;\n        float res_24830 = uitofp_i32_f32(unsign_arg_24827);\n        float res_24831 = res_24830 / 2.1474836e9F;\n        float res_24832;\n        \n        res_24832 = futrts_log32(res_24829);\n      ",
                   "  \n        float res_24833 = -2.0F * res_24832;\n        float res_24834;\n        \n        res_24834 = futrts_sqrt32(res_24833);\n        \n        float res_24835 = 6.2831855F * res_24831;\n        float res_24836;\n        \n        res_24836 = futrts_cos32(res_24835);\n        \n        float res_24837 = res_24834 * res_24836;\n        \n        ((__local float *) mem_27664)[gtid_24603] = res_24837;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    __local char *mem_27666;\n    \n    mem_27666 = (__local char *) mem_27666_backing_1;\n    for (int64_t i_27928 = 0; i_27928 < sdiv_up64(steps_23347 -\n                                                  sext_i32_i64(local_tid_27921),\n                                                  computed_group_sizze_24602);\n         i_27928++) {\n        ((__local float *) mem_27666)[i_27928 * computed_group_sizze_24602 +\n                                      sext_i32_i64(local_tid_27921)] = r0_23354;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int64_t i_24840 = 0; i_24840 < upper_bound_23455; i_24840++) {\n        bool y_24842 = slt64(i_24840, steps_23347);\n        bool index_certs_24843;\n        \n        if (!y_24842) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 4) == -1) {\n                    global_failure_args[0] = i_24840;\n                    global_failure_args[1] = steps_23347;\n                    ;\n                }\n                local_failure = true;\n                goto error_1;\n            }\n        }\n        \n        float shortstep_arg_24844 = ((__local float *) mem_27664)[i_24840];\n        float shortstep_arg_24845 = ((__local float *) mem_27666)[i_24840];\n        float y_24846 = b_23352 - shortstep_arg_24845;\n        float x_24847 = a_23351 * y_24846;\n        float x_24848 = dt_23369 * x_24847;\n        float x_24849 = res_23456 * shortstep_arg_24844;\n        float y_24850 = sigma_23353 * x_24849;\n        float delta_r_24851 = x_24848 + y_24850;\n        float res_24852 = shortstep_arg_24845 ",
                   "+ delta_r_24851;\n        int64_t i_24853 = add64(1, i_24840);\n        bool x_24854 = sle64(0, i_24853);\n        bool y_24855 = slt64(i_24853, steps_23347);\n        bool bounds_check_24856 = x_24854 && y_24855;\n        bool index_certs_24857;\n        \n        if (!bounds_check_24856) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 5) == -1) {\n                    global_failure_args[0] = i_24853;\n                    global_failure_args[1] = steps_23347;\n                    ;\n                }\n                local_failure = true;\n                goto error_1;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_27921 == 0) {\n            ((__local float *) mem_27666)[i_24853] = res_24852;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    __local char *mem_27682;\n    \n    mem_27682 = (__local char *) mem_27682_backing_2;\n    \n    int64_t gtid_24637 = sext_i32_i64(ltid_pre_27926);\n    int64_t gtid_24638 = sext_i32_i64(ltid_pre_27927);\n    int32_t phys_tid_24639 = local_tid_27921;\n    \n    if (slt64(gtid_24637, steps_23347) && slt64(gtid_24638, n_23343)) {\n        float x_24860 = ((__local float *) mem_27666)[gtid_24637];\n        \n        ((__local float *) mem_27682)[gtid_24637 * n_23343 + gtid_24638] =\n            x_24860;\n    }\n    \n  error_1:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    __local char *mem_27686;\n    \n    mem_27686 = (__local char *) mem_27686_backing_3;\n    \n    int64_t gtid_24631 = sext_i32_i64(ltid_pre_27926);\n    int64_t gtid_24632 = sext_i32_i64(ltid_pre_27927);\n    int32_t phys_tid_24633 = local_tid_27921;\n    \n    if (slt64(gtid_24631, steps_23347) && slt64(gtid_24632, n_23343)) {\n        int64_t convop_x_27468 = add64(1, gtid_24631);\n        float binop_x_27469 = sitofp_i64_f32(convop_x_27468);\n        float index_primexp_27470 = binop_x_27469 / sims_per_year_23441;\n        \n        ((__local float ",
                   "*) mem_27686)[gtid_24631 * n_23343 + gtid_24632] =\n            index_primexp_27470;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int64_t i_27930 = 0; i_27930 < sdiv_up64(steps_23347 * n_23343 -\n                                                  sext_i32_i64(local_tid_27921),\n                                                  computed_group_sizze_24602);\n         i_27930++) {\n        ((__global float *) mem_27690)[gtid_24600 * (n_23343 * steps_23347) +\n                                       squot64(i_27930 *\n                                               computed_group_sizze_24602 +\n                                               sext_i32_i64(local_tid_27921),\n                                               n_23343) * n_23343 + (i_27930 *\n                                                                     computed_group_sizze_24602 +\n                                                                     sext_i32_i64(local_tid_27921) -\n                                                                     squot64(i_27930 *\n                                                                             computed_group_sizze_24602 +\n                                                                             sext_i32_i64(local_tid_27921),\n                                                                             n_23343) *\n                                                                     n_23343)] =\n            ((__local float *) mem_27682)[squot64(i_27930 *\n                                                  computed_group_sizze_24602 +\n                                                  sext_i32_i64(local_tid_27921),\n                                                  n_23343) * n_23343 +\n                                          (i_27930 *\n                                           computed_group_sizze_24602 +\n                                           sext_i32_i64(local_tid_27921) -\n                                           squot64(i_27930 *\n                               ",
                   "                    computed_group_sizze_24602 +\n                                                   sext_i32_i64(local_tid_27921),\n                                                   n_23343) * n_23343)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int64_t i_27931 = 0; i_27931 < sdiv_up64(steps_23347 * n_23343 -\n                                                  sext_i32_i64(local_tid_27921),\n                                                  computed_group_sizze_24602);\n         i_27931++) {\n        ((__global float *) mem_27694)[gtid_24600 * (n_23343 * steps_23347) +\n                                       squot64(i_27931 *\n                                               computed_group_sizze_24602 +\n                                               sext_i32_i64(local_tid_27921),\n                                               n_23343) * n_23343 + (i_27931 *\n                                                                     computed_group_sizze_24602 +\n                                                                     sext_i32_i64(local_tid_27921) -\n                                                                     squot64(i_27931 *\n                                                                             computed_group_sizze_24602 +\n                                                                             sext_i32_i64(local_tid_27921),\n                                                                             n_23343) *\n                                                                     n_23343)] =\n            ((__local float *) mem_27686)[squot64(i_27931 *\n                                                  computed_group_sizze_24602 +\n                                                  sext_i32_i64(local_tid_27921),\n                                                  n_23343) * n_23343 +\n                                          (i_27931 *\n                                           computed_group_sizze_24602 +\n                                           sext",
                   "_i32_i64(local_tid_27921) -\n                                           squot64(i_27931 *\n                                                   computed_group_sizze_24602 +\n                                                   sext_i32_i64(local_tid_27921),\n                                                   n_23343) * n_23343)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n  error_3:\n    return;\n}\n__kernel void mainzisegmap_intragroup_25506(__global int *global_failure,\n                                            __local volatile\n                                            int64_t *red_arr_mem_28527_backing_aligned_0,\n                                            int64_t n_23343,\n                                            int64_t paths_23346, float a_23351,\n                                            float x_23371, float x_23373,\n                                            float y_23375, float y_23376,\n                                            float sims_per_year_23441,\n                                            float res_23769,\n                                            int64_t one_intra_par_min_24642,\n                                            __global unsigned char *mem_27767,\n                                            __global unsigned char *mem_27798,\n                                            __global unsigned char *mem_27800)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28527_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28527_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28521;\n    int32_t local_tid_28522;\n    int64_t group_sizze_28525;\n    int32_t wave_sizze_28524;\n    int32_t group_tid_28523;\n    \n    global_tid_28521 = get_global_id(0);\n    local_tid_28522 = get_local_id(0);\n    group_sizze_28525 = get_local_size(0);\n    wave_sizze_28524 = LOCKSTEP_WIDTH;\n",
                   "    group_tid_28523 = get_group_id(0);\n    \n    int32_t phys_tid_25506;\n    \n    phys_tid_25506 = group_tid_28523;\n    \n    int32_t ltid_pre_28526;\n    \n    ltid_pre_28526 = local_tid_28522;\n    \n    int64_t gtid_25501;\n    \n    gtid_25501 = sext_i32_i64(group_tid_28523);\n    \n    int64_t convop_x_27566;\n    \n    convop_x_27566 = add64(1, gtid_25501);\n    \n    float binop_x_27567 = sitofp_i64_f32(convop_x_27566);\n    float index_primexp_27568 = binop_x_27567 / sims_per_year_23441;\n    int64_t binop_y_27626 = n_23343 * gtid_25501;\n    float res_25781;\n    int64_t gtid_25504 = sext_i32_i64(ltid_pre_28526);\n    int32_t phys_tid_25505 = local_tid_28522;\n    __local char *red_arr_mem_28527;\n    \n    red_arr_mem_28527 = (__local char *) red_arr_mem_28527_backing_0;\n    if (slt64(gtid_25504, paths_23346)) {\n        int64_t binop_x_27625 = one_intra_par_min_24642 * gtid_25504;\n        int64_t binop_x_27627 = binop_x_27625 + binop_y_27626;\n        float res_25786;\n        float redout_27620 = 0.0F;\n        \n        for (int64_t i_27621 = 0; i_27621 < n_23343; i_27621++) {\n            int64_t new_index_27628 = i_27621 + binop_x_27627;\n            float x_25790 = ((__global float *) mem_27767)[new_index_27628];\n            float res_25789 = x_25790 + redout_27620;\n            float redout_tmp_28529 = res_25789;\n            \n            redout_27620 = redout_tmp_28529;\n        }\n        res_25786 = redout_27620;\n        \n        float res_25791 = fmax32(0.0F, res_25786);\n        \n        ((__local float *) red_arr_mem_28527)[gtid_25504] = res_25791;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28530;\n    int32_t skip_waves_28531;\n    \n    skip_waves_28531 = 1;\n    \n    float x_25782;\n    float x_25783;\n    \n    offset_28530 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28522, sext_i64_i32(paths_23346))) {\n            x_25782 = ((__local\n                        float *) red_arr_mem_28527)[sext_i32_i64(local_tid_28",
                   "522 +\n                                                    offset_28530)];\n        }\n    }\n    offset_28530 = 1;\n    while (slt32(offset_28530, wave_sizze_28524)) {\n        if (slt32(local_tid_28522 + offset_28530, sext_i64_i32(paths_23346)) &&\n            ((local_tid_28522 - squot32(local_tid_28522, wave_sizze_28524) *\n              wave_sizze_28524) & (2 * offset_28530 - 1)) == 0) {\n            // read array element\n            {\n                x_25783 = ((volatile __local\n                            float *) red_arr_mem_28527)[sext_i32_i64(local_tid_28522 +\n                                                        offset_28530)];\n            }\n            // apply reduction operation\n            {\n                float res_25784 = x_25782 + x_25783;\n                \n                x_25782 = res_25784;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_28527)[sext_i32_i64(local_tid_28522)] =\n                    x_25782;\n            }\n        }\n        offset_28530 *= 2;\n    }\n    while (slt32(skip_waves_28531, squot32(sext_i64_i32(paths_23346) +\n                                           wave_sizze_28524 - 1,\n                                           wave_sizze_28524))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28530 = skip_waves_28531 * wave_sizze_28524;\n        if (slt32(local_tid_28522 + offset_28530, sext_i64_i32(paths_23346)) &&\n            ((local_tid_28522 - squot32(local_tid_28522, wave_sizze_28524) *\n              wave_sizze_28524) == 0 && (squot32(local_tid_28522,\n                                                 wave_sizze_28524) & (2 *\n                                                                      skip_waves_28531 -\n                                                                      1)) ==\n             0)) {\n            // read array element\n            {\n                x_25783 = ((__local\n                            float *) red_arr_mem_28",
                   "527)[sext_i32_i64(local_tid_28522 +\n                                                        offset_28530)];\n            }\n            // apply reduction operation\n            {\n                float res_25784 = x_25782 + x_25783;\n                \n                x_25782 = res_25784;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_28527)[sext_i32_i64(local_tid_28522)] =\n                    x_25782;\n            }\n        }\n        skip_waves_28531 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    res_25781 = ((__local float *) red_arr_mem_28527)[0];\n    \n    float res_25792 = res_25781 / res_23769;\n    float negate_arg_25793 = a_23351 * index_primexp_27568;\n    float exp_arg_25794 = 0.0F - negate_arg_25793;\n    float res_25795 = fpow32(2.7182817F, exp_arg_25794);\n    float x_25796 = 1.0F - res_25795;\n    float B_25797 = x_25796 / a_23351;\n    float x_25798 = B_25797 - index_primexp_27568;\n    float x_25799 = y_23375 * x_25798;\n    float A1_25800 = x_25799 / x_23371;\n    float y_25801 = fpow32(B_25797, 2.0F);\n    float x_25802 = x_23373 * y_25801;\n    float A2_25803 = x_25802 / y_23376;\n    float exp_arg_25804 = A1_25800 - A2_25803;\n    float res_25805 = fpow32(2.7182817F, exp_arg_25804);\n    float negate_arg_25806 = 5.0e-2F * B_25797;\n    float exp_arg_25807 = 0.0F - negate_arg_25806;\n    float res_25808 = fpow32(2.7182817F, exp_arg_25807);\n    float res_25809 = res_25805 * res_25808;\n    float res_25810 = res_25792 * res_25809;\n    \n    if (local_tid_28522 == 0) {\n        ((__global float *) mem_27798)[gtid_25501] = res_25810;\n    }\n    if (local_tid_28522 == 0) {\n        ((__global float *) mem_27800)[gtid_25501] = res_25792;\n    }\n    \n  error_2:\n    return;\n}\n__kernel void mainzisegred_large_25658(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_28570_backing_aligned_0,\n             ",
                   "                          __local volatile\n                                       int64_t *red_arr_mem_28568_backing_aligned_1,\n                                       int64_t n_23343, int64_t paths_23346,\n                                       int64_t steps_23347,\n                                       int64_t num_groups_25814, __global\n                                       unsigned char *mem_27804, __global\n                                       unsigned char *mem_27807,\n                                       int64_t groups_per_segment_28554,\n                                       int64_t elements_per_thread_28555,\n                                       int64_t virt_num_groups_28556,\n                                       int64_t threads_per_segment_28558,\n                                       __global\n                                       unsigned char *group_res_arr_mem_28559,\n                                       __global\n                                       unsigned char *mainzicounter_mem_28561)\n{\n    #define segred_group_sizze_25813 (mainzisegred_group_sizze_25652)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_28570_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_28570_backing_aligned_0;\n    __local volatile char *restrict red_arr_mem_28568_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28568_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28563;\n    int32_t local_tid_28564;\n    int64_t group_sizze_28567;\n    int32_t wave_sizze_28566;\n    int32_t group_tid_28565;\n    \n    global_tid_28563 = get_global_id(0);\n    local_tid_28564 = get_local_id(0);\n    group_sizze_28567 = get_local_size(0);\n    wave_sizze_28566 = LOCKSTEP_WIDTH;\n    group_tid_28565 = get_group_id(0);\n    \n    int32_t phys_tid_25658;\n",
                   "    \n    phys_tid_25658 = global_tid_28563;\n    \n    __local char *red_arr_mem_28568;\n    \n    red_arr_mem_28568 = (__local char *) red_arr_mem_28568_backing_0;\n    \n    __local char *sync_arr_mem_28570;\n    \n    sync_arr_mem_28570 = (__local char *) sync_arr_mem_28570_backing_1;\n    \n    int32_t phys_group_id_28572;\n    \n    phys_group_id_28572 = get_group_id(0);\n    for (int32_t i_28573 = 0; i_28573 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_28556) - phys_group_id_28572,\n                   sext_i64_i32(num_groups_25814)); i_28573++) {\n        int32_t virt_group_id_28574 = phys_group_id_28572 + i_28573 *\n                sext_i64_i32(num_groups_25814);\n        int32_t flat_segment_id_28575 = squot32(virt_group_id_28574,\n                                                sext_i64_i32(groups_per_segment_28554));\n        int64_t global_tid_28576 = srem64(sext_i32_i64(virt_group_id_28574) *\n                                          segred_group_sizze_25813 +\n                                          sext_i32_i64(local_tid_28564),\n                                          segred_group_sizze_25813 *\n                                          groups_per_segment_28554);\n        int64_t gtid_25649 = sext_i32_i64(flat_segment_id_28575);\n        int64_t gtid_25657;\n        float x_acc_28577;\n        int64_t chunk_sizze_28578;\n        \n        chunk_sizze_28578 = smin64(elements_per_thread_28555,\n                                   sdiv_up64(paths_23346 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_28576)),\n                                             threads_per_segment_28558));\n        \n        float x_25817;\n        float x_25818;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_28577 = 0.0F;\n        }\n        for (int64_t i_28582 = 0; i_28582 < chunk_sizze_28578; i_28582++) {\n            gtid_25657 = sext_i32_i64(sext_i64_i32(global_tid_28576)) +\n                threads_per_segment_28558 * i_28582;\n ",
                   "           // apply map function\n            {\n                float res_25822;\n                float redout_27622 = 0.0F;\n                \n                for (int64_t i_27623 = 0; i_27623 < n_23343; i_27623++) {\n                    float x_25826 = ((__global float *) mem_27804)[i_27623 *\n                                                                   (steps_23347 *\n                                                                    paths_23346) +\n                                                                   gtid_25657 *\n                                                                   steps_23347 +\n                                                                   gtid_25649];\n                    float res_25825 = x_25826 + redout_27622;\n                    float redout_tmp_28583 = res_25825;\n                    \n                    redout_27622 = redout_tmp_28583;\n                }\n                res_25822 = redout_27622;\n                \n                float res_25827 = fmax32(0.0F, res_25822);\n                \n                // save map-out results\n                { }\n                // load accumulator\n                {\n                    x_25817 = x_acc_28577;\n                }\n                // load new values\n                {\n                    x_25818 = res_25827;\n                }\n                // apply reduction operator\n                {\n                    float res_25819 = x_25817 + x_25818;\n                    \n                    // store in accumulator\n                    {\n                        x_acc_28577 = res_25819;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_25817 = x_acc_28577;\n            ((__local\n              float *) red_arr_mem_28568)[sext_i32_i64(local_tid_28564)] =\n                x_25817;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_28584;\n        int32_t skip_waves_28",
                   "585;\n        \n        skip_waves_28585 = 1;\n        \n        float x_28579;\n        float x_28580;\n        \n        offset_28584 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_28564,\n                      sext_i64_i32(segred_group_sizze_25813))) {\n                x_28579 = ((__local\n                            float *) red_arr_mem_28568)[sext_i32_i64(local_tid_28564 +\n                                                        offset_28584)];\n            }\n        }\n        offset_28584 = 1;\n        while (slt32(offset_28584, wave_sizze_28566)) {\n            if (slt32(local_tid_28564 + offset_28584,\n                      sext_i64_i32(segred_group_sizze_25813)) &&\n                ((local_tid_28564 - squot32(local_tid_28564, wave_sizze_28566) *\n                  wave_sizze_28566) & (2 * offset_28584 - 1)) == 0) {\n                // read array element\n                {\n                    x_28580 = ((volatile __local\n                                float *) red_arr_mem_28568)[sext_i32_i64(local_tid_28564 +\n                                                            offset_28584)];\n                }\n                // apply reduction operation\n                {\n                    float res_28581 = x_28579 + x_28580;\n                    \n                    x_28579 = res_28581;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      float *) red_arr_mem_28568)[sext_i32_i64(local_tid_28564)] =\n                        x_28579;\n                }\n            }\n            offset_28584 *= 2;\n        }\n        while (slt32(skip_waves_28585,\n                     squot32(sext_i64_i32(segred_group_sizze_25813) +\n                             wave_sizze_28566 - 1, wave_sizze_28566))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_28584 = skip_waves_28585 * wave_sizze_28566;\n            if (slt32(local_tid_28564 + offset_28584,\n",
                   "                      sext_i64_i32(segred_group_sizze_25813)) &&\n                ((local_tid_28564 - squot32(local_tid_28564, wave_sizze_28566) *\n                  wave_sizze_28566) == 0 && (squot32(local_tid_28564,\n                                                     wave_sizze_28566) & (2 *\n                                                                          skip_waves_28585 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_28580 = ((__local\n                                float *) red_arr_mem_28568)[sext_i32_i64(local_tid_28564 +\n                                                            offset_28584)];\n                }\n                // apply reduction operation\n                {\n                    float res_28581 = x_28579 + x_28580;\n                    \n                    x_28579 = res_28581;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      float *) red_arr_mem_28568)[sext_i32_i64(local_tid_28564)] =\n                        x_28579;\n                }\n            }\n            skip_waves_28585 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_28564) == 0) {\n                x_acc_28577 = x_28579;\n            }\n        }\n        if (groups_per_segment_28554 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_28564 == 0) {\n                    ((__global float *) mem_27807)[gtid_25649] = x_acc_28577;\n                }\n            }\n        } else {\n            int32_t old_counter_28586;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_28564 == 0) {\n                    ((__global\n           ",
                   "           float *) group_res_arr_mem_28559)[sext_i32_i64(virt_group_id_28574) *\n                                                        segred_group_sizze_25813] =\n                        x_acc_28577;\n                    mem_fence_global();\n                    old_counter_28586 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_28561)[sext_i32_i64(srem32(flat_segment_id_28575,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_28570)[0] =\n                        old_counter_28586 == groups_per_segment_28554 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_28587;\n            \n            is_last_group_28587 = ((__local bool *) sync_arr_mem_28570)[0];\n            if (is_last_group_28587) {\n                if (local_tid_28564 == 0) {\n                    old_counter_28586 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_28561)[sext_i32_i64(srem32(flat_segment_id_28575,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_28554));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_28588 =\n                            sdiv_up64(groups_per_segment_28554,\n                                      segred_group_sizze_25813);\n                    \n                    x_25817 = 0.0F;\n                    for (int64_t i_28589 = 0; i_28589 < read_per_thread_28588;\n                    ",
                   "     i_28589++) {\n                        int64_t group_res_id_28590 =\n                                sext_i32_i64(local_tid_28564) *\n                                read_per_thread_28588 + i_28589;\n                        int64_t index_of_group_res_28591 =\n                                sext_i32_i64(flat_segment_id_28575) *\n                                groups_per_segment_28554 + group_res_id_28590;\n                        \n                        if (slt64(group_res_id_28590,\n                                  groups_per_segment_28554)) {\n                            x_25818 = ((__global\n                                        float *) group_res_arr_mem_28559)[index_of_group_res_28591 *\n                                                                          segred_group_sizze_25813];\n                            \n                            float res_25819;\n                            \n                            res_25819 = x_25817 + x_25818;\n                            x_25817 = res_25819;\n                        }\n                    }\n                }\n                ((__local\n                  float *) red_arr_mem_28568)[sext_i32_i64(local_tid_28564)] =\n                    x_25817;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_28592;\n                    int32_t skip_waves_28593;\n                    \n                    skip_waves_28593 = 1;\n                    \n                    float x_28579;\n                    float x_28580;\n                    \n                    offset_28592 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_28564,\n                                  sext_i64_i32(segred_group_sizze_25813))) {\n                            x_28579 = ((__local\n                                        float *) red_arr_mem_28568)[sext_i32_i64(local_tid_28564 +\n        ",
                   "                                                            offset_28592)];\n                        }\n                    }\n                    offset_28592 = 1;\n                    while (slt32(offset_28592, wave_sizze_28566)) {\n                        if (slt32(local_tid_28564 + offset_28592,\n                                  sext_i64_i32(segred_group_sizze_25813)) &&\n                            ((local_tid_28564 - squot32(local_tid_28564,\n                                                        wave_sizze_28566) *\n                              wave_sizze_28566) & (2 * offset_28592 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_28580 = ((volatile __local\n                                            float *) red_arr_mem_28568)[sext_i32_i64(local_tid_28564 +\n                                                                        offset_28592)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_28581 = x_28579 + x_28580;\n                                \n                                x_28579 = res_28581;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_28568)[sext_i32_i64(local_tid_28564)] =\n                                    x_28579;\n                            }\n                        }\n                        offset_28592 *= 2;\n                    }\n                    while (slt32(skip_waves_28593,\n                                 squot32(sext_i64_i32(segred_group_sizze_25813) +\n                                         wave_sizze_28566 - 1,\n                                         wave_sizze_28566))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                      ",
                   "  offset_28592 = skip_waves_28593 * wave_sizze_28566;\n                        if (slt32(local_tid_28564 + offset_28592,\n                                  sext_i64_i32(segred_group_sizze_25813)) &&\n                            ((local_tid_28564 - squot32(local_tid_28564,\n                                                        wave_sizze_28566) *\n                              wave_sizze_28566) == 0 &&\n                             (squot32(local_tid_28564, wave_sizze_28566) & (2 *\n                                                                            skip_waves_28593 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_28580 = ((__local\n                                            float *) red_arr_mem_28568)[sext_i32_i64(local_tid_28564 +\n                                                                        offset_28592)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_28581 = x_28579 + x_28580;\n                                \n                                x_28579 = res_28581;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  float *) red_arr_mem_28568)[sext_i32_i64(local_tid_28564)] =\n                                    x_28579;\n                            }\n                        }\n                        skip_waves_28593 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_28564 == 0) {\n                            ((__global float *) mem_27807)[gtid_25649] =\n                                x_28579;\n                        }\n        ",
                   "            }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_25813\n}\n__kernel void mainzisegred_large_28142(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_28180_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_28178_backing_aligned_1,\n                                       int64_t res_23550,\n                                       int64_t num_groups_25348, __global\n                                       unsigned char *mem_27744,\n                                       int32_t num_subhistos_28056, __global\n                                       unsigned char *res_subhistos_mem_28057,\n                                       int64_t groups_per_segment_28164,\n                                       int64_t elements_per_thread_28165,\n                                       int64_t virt_num_groups_28166,\n                                       int64_t threads_per_segment_28168,\n                                       __global\n                                       unsigned char *group_res_arr_mem_28169,\n                                       __global\n                                       unsigned char *mainzicounter_mem_28171)\n{\n    #define seghist_group_sizze_25346 (mainziseghist_group_sizze_25345)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_28180_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_28180_backing_aligned_0;\n    __local volatile char *restrict red_arr_mem_28178_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28178_backing_aligned_1;\n    \n    if (*global_failu",
                   "re >= 0)\n        return;\n    \n    int32_t global_tid_28173;\n    int32_t local_tid_28174;\n    int64_t group_sizze_28177;\n    int32_t wave_sizze_28176;\n    int32_t group_tid_28175;\n    \n    global_tid_28173 = get_global_id(0);\n    local_tid_28174 = get_local_id(0);\n    group_sizze_28177 = get_local_size(0);\n    wave_sizze_28176 = LOCKSTEP_WIDTH;\n    group_tid_28175 = get_group_id(0);\n    \n    int32_t flat_gtid_28142;\n    \n    flat_gtid_28142 = global_tid_28173;\n    \n    __local char *red_arr_mem_28178;\n    \n    red_arr_mem_28178 = (__local char *) red_arr_mem_28178_backing_0;\n    \n    __local char *sync_arr_mem_28180;\n    \n    sync_arr_mem_28180 = (__local char *) sync_arr_mem_28180_backing_1;\n    \n    int32_t phys_group_id_28182;\n    \n    phys_group_id_28182 = get_group_id(0);\n    for (int32_t i_28183 = 0; i_28183 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_28166) - phys_group_id_28182,\n                   sext_i64_i32(num_groups_25348)); i_28183++) {\n        int32_t virt_group_id_28184 = phys_group_id_28182 + i_28183 *\n                sext_i64_i32(num_groups_25348);\n        int32_t flat_segment_id_28185 = squot32(virt_group_id_28184,\n                                                sext_i64_i32(groups_per_segment_28164));\n        int64_t global_tid_28186 = srem64(sext_i32_i64(virt_group_id_28184) *\n                                          seghist_group_sizze_25346 +\n                                          sext_i32_i64(local_tid_28174),\n                                          seghist_group_sizze_25346 *\n                                          groups_per_segment_28164);\n        int64_t bucket_id_28140 = sext_i32_i64(flat_segment_id_28185);\n        int64_t subhistogram_id_28141;\n        int64_t x_acc_28187;\n        int64_t chunk_sizze_28188;\n        \n        chunk_sizze_28188 = smin64(elements_per_thread_28165,\n                                   sdiv_up64(num_subhistos_28056 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_",
                   "28186)),\n                                             threads_per_segment_28168));\n        \n        int64_t x_25352;\n        int64_t x_25353;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_28187 = 0;\n        }\n        for (int64_t i_28192 = 0; i_28192 < chunk_sizze_28188; i_28192++) {\n            subhistogram_id_28141 =\n                sext_i32_i64(sext_i64_i32(global_tid_28186)) +\n                threads_per_segment_28168 * i_28192;\n            // apply map function\n            {\n                // load accumulator\n                {\n                    x_25352 = x_acc_28187;\n                }\n                // load new values\n                {\n                    x_25353 = ((__global\n                                int64_t *) res_subhistos_mem_28057)[subhistogram_id_28141 *\n                                                                    res_23550 +\n                                                                    bucket_id_28140];\n                }\n                // apply reduction operator\n                {\n                    int64_t res_25354 = smax64(x_25352, x_25353);\n                    \n                    // store in accumulator\n                    {\n                        x_acc_28187 = res_25354;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_25352 = x_acc_28187;\n            ((__local\n              int64_t *) red_arr_mem_28178)[sext_i32_i64(local_tid_28174)] =\n                x_25352;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_28193;\n        int32_t skip_waves_28194;\n        \n        skip_waves_28194 = 1;\n        \n        int64_t x_28189;\n        int64_t x_28190;\n        \n        offset_28193 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_28174,\n                      sext_i64_i32(seghist_group_sizze_25346))) {",
                   "\n                x_28189 = ((__local\n                            int64_t *) red_arr_mem_28178)[sext_i32_i64(local_tid_28174 +\n                                                          offset_28193)];\n            }\n        }\n        offset_28193 = 1;\n        while (slt32(offset_28193, wave_sizze_28176)) {\n            if (slt32(local_tid_28174 + offset_28193,\n                      sext_i64_i32(seghist_group_sizze_25346)) &&\n                ((local_tid_28174 - squot32(local_tid_28174, wave_sizze_28176) *\n                  wave_sizze_28176) & (2 * offset_28193 - 1)) == 0) {\n                // read array element\n                {\n                    x_28190 = ((volatile __local\n                                int64_t *) red_arr_mem_28178)[sext_i32_i64(local_tid_28174 +\n                                                              offset_28193)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_28191 = smax64(x_28189, x_28190);\n                    \n                    x_28189 = res_28191;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      int64_t *) red_arr_mem_28178)[sext_i32_i64(local_tid_28174)] =\n                        x_28189;\n                }\n            }\n            offset_28193 *= 2;\n        }\n        while (slt32(skip_waves_28194,\n                     squot32(sext_i64_i32(seghist_group_sizze_25346) +\n                             wave_sizze_28176 - 1, wave_sizze_28176))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_28193 = skip_waves_28194 * wave_sizze_28176;\n            if (slt32(local_tid_28174 + offset_28193,\n                      sext_i64_i32(seghist_group_sizze_25346)) &&\n                ((local_tid_28174 - squot32(local_tid_28174, wave_sizze_28176) *\n                  wave_sizze_28176) == 0 && (squot32(local_tid_28174,\n                                                     wave_sizze_281",
                   "76) & (2 *\n                                                                          skip_waves_28194 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_28190 = ((__local\n                                int64_t *) red_arr_mem_28178)[sext_i32_i64(local_tid_28174 +\n                                                              offset_28193)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_28191 = smax64(x_28189, x_28190);\n                    \n                    x_28189 = res_28191;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_28178)[sext_i32_i64(local_tid_28174)] =\n                        x_28189;\n                }\n            }\n            skip_waves_28194 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_28174) == 0) {\n                x_acc_28187 = x_28189;\n            }\n        }\n        if (groups_per_segment_28164 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_28174 == 0) {\n                    ((__global int64_t *) mem_27744)[bucket_id_28140] =\n                        x_acc_28187;\n                }\n            }\n        } else {\n            int32_t old_counter_28195;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_28174 == 0) {\n                    ((__global\n                      int64_t *) group_res_arr_mem_28169)[sext_i32_i64(virt_group_id_28184) *\n                                                          seghist_group_sizze_25346] =\n                        x_acc_28187;\n                    mem_fence_",
                   "global();\n                    old_counter_28195 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_28171)[sext_i32_i64(srem32(flat_segment_id_28185,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_28180)[0] =\n                        old_counter_28195 == groups_per_segment_28164 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_28196;\n            \n            is_last_group_28196 = ((__local bool *) sync_arr_mem_28180)[0];\n            if (is_last_group_28196) {\n                if (local_tid_28174 == 0) {\n                    old_counter_28195 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_28171)[sext_i32_i64(srem32(flat_segment_id_28185,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_28164));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_28197 =\n                            sdiv_up64(groups_per_segment_28164,\n                                      seghist_group_sizze_25346);\n                    \n                    x_25352 = 0;\n                    for (int64_t i_28198 = 0; i_28198 < read_per_thread_28197;\n                         i_28198++) {\n                        int64_t group_res_id_28199 =\n                                sext_i32_i64(local_tid_28174) *\n                                read_per_thread_28197 + i_28198;\n                        int64_t in",
                   "dex_of_group_res_28200 =\n                                sext_i32_i64(flat_segment_id_28185) *\n                                groups_per_segment_28164 + group_res_id_28199;\n                        \n                        if (slt64(group_res_id_28199,\n                                  groups_per_segment_28164)) {\n                            x_25353 = ((__global\n                                        int64_t *) group_res_arr_mem_28169)[index_of_group_res_28200 *\n                                                                            seghist_group_sizze_25346];\n                            \n                            int64_t res_25354;\n                            \n                            res_25354 = smax64(x_25352, x_25353);\n                            x_25352 = res_25354;\n                        }\n                    }\n                }\n                ((__local\n                  int64_t *) red_arr_mem_28178)[sext_i32_i64(local_tid_28174)] =\n                    x_25352;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_28201;\n                    int32_t skip_waves_28202;\n                    \n                    skip_waves_28202 = 1;\n                    \n                    int64_t x_28189;\n                    int64_t x_28190;\n                    \n                    offset_28201 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_28174,\n                                  sext_i64_i32(seghist_group_sizze_25346))) {\n                            x_28189 = ((__local\n                                        int64_t *) red_arr_mem_28178)[sext_i32_i64(local_tid_28174 +\n                                                                      offset_28201)];\n                        }\n                    }\n                    offset_28201 = 1;\n                    while (slt32(offset_28201, ",
                   "wave_sizze_28176)) {\n                        if (slt32(local_tid_28174 + offset_28201,\n                                  sext_i64_i32(seghist_group_sizze_25346)) &&\n                            ((local_tid_28174 - squot32(local_tid_28174,\n                                                        wave_sizze_28176) *\n                              wave_sizze_28176) & (2 * offset_28201 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_28190 = ((volatile __local\n                                            int64_t *) red_arr_mem_28178)[sext_i32_i64(local_tid_28174 +\n                                                                          offset_28201)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_28191 = smax64(x_28189, x_28190);\n                                \n                                x_28189 = res_28191;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_28178)[sext_i32_i64(local_tid_28174)] =\n                                    x_28189;\n                            }\n                        }\n                        offset_28201 *= 2;\n                    }\n                    while (slt32(skip_waves_28202,\n                                 squot32(sext_i64_i32(seghist_group_sizze_25346) +\n                                         wave_sizze_28176 - 1,\n                                         wave_sizze_28176))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_28201 = skip_waves_28202 * wave_sizze_28176;\n                        if (slt32(local_tid_28174 + offset_28201,\n                                  sext_i64_i32(seghist_group_sizze_25346",
                   ")) &&\n                            ((local_tid_28174 - squot32(local_tid_28174,\n                                                        wave_sizze_28176) *\n                              wave_sizze_28176) == 0 &&\n                             (squot32(local_tid_28174, wave_sizze_28176) & (2 *\n                                                                            skip_waves_28202 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_28190 = ((__local\n                                            int64_t *) red_arr_mem_28178)[sext_i32_i64(local_tid_28174 +\n                                                                          offset_28201)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_28191 = smax64(x_28189, x_28190);\n                                \n                                x_28189 = res_28191;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  int64_t *) red_arr_mem_28178)[sext_i32_i64(local_tid_28174)] =\n                                    x_28189;\n                            }\n                        }\n                        skip_waves_28202 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_28174 == 0) {\n                            ((__global int64_t *) mem_27744)[bucket_id_28140] =\n                                x_28189;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist",
                   "_group_sizze_25346\n}\n__kernel void mainzisegred_nonseg_24275(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_27888_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_27886_backing_aligned_1,\n                                        int64_t n_23343,\n                                        int64_t num_groups_24270, __global\n                                        unsigned char *swap_term_mem_27633,\n                                        __global\n                                        unsigned char *payments_mem_27634,\n                                        __global unsigned char *mem_27638,\n                                        __global\n                                        unsigned char *mainzicounter_mem_27876,\n                                        __global\n                                        unsigned char *group_res_arr_mem_27878,\n                                        int64_t num_threads_27880)\n{\n    #define segred_group_sizze_24268 (mainzisegred_group_sizze_24267)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27888_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_27888_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_27886_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_27886_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27881;\n    int32_t local_tid_27882;\n    int64_t group_sizze_27885;\n    int32_t wave_sizze_27884;\n    int32_t group_tid_27883;\n    \n    global_tid_27881 = get_global_id(0);\n    local_tid_27882 = get_local_id(0);\n    group_sizze_27885 = get_local_size(0);\n    wave_sizze_27884 = L",
                   "OCKSTEP_WIDTH;\n    group_tid_27883 = get_group_id(0);\n    \n    int32_t phys_tid_24275;\n    \n    phys_tid_24275 = global_tid_27881;\n    \n    __local char *sync_arr_mem_27886;\n    \n    sync_arr_mem_27886 = (__local char *) sync_arr_mem_27886_backing_0;\n    \n    __local char *red_arr_mem_27888;\n    \n    red_arr_mem_27888 = (__local char *) red_arr_mem_27888_backing_1;\n    \n    int64_t dummy_24273;\n    \n    dummy_24273 = 0;\n    \n    int64_t gtid_24274;\n    \n    gtid_24274 = 0;\n    \n    float x_acc_27890;\n    int64_t chunk_sizze_27891;\n    \n    chunk_sizze_27891 = smin64(sdiv_up64(n_23343,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_24268 *\n                                         num_groups_24270))),\n                               sdiv_up64(n_23343 - sext_i32_i64(phys_tid_24275),\n                                         num_threads_27880));\n    \n    float x_23361;\n    float x_23362;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_27890 = -INFINITY;\n    }\n    for (int64_t i_27895 = 0; i_27895 < chunk_sizze_27891; i_27895++) {\n        gtid_24274 = sext_i32_i64(phys_tid_24275) + num_threads_27880 * i_27895;\n        // apply map function\n        {\n            float x_23364 = ((__global\n                              float *) swap_term_mem_27633)[gtid_24274];\n            int64_t x_23365 = ((__global\n                                int64_t *) payments_mem_27634)[gtid_24274];\n            float res_23366 = sitofp_i64_f32(x_23365);\n            float res_23367 = x_23364 * res_23366;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_23361 = x_acc_27890;\n            }\n            // load new values\n            {\n                x_23362 = res_23367;\n            }\n            // apply reduction operator\n            {\n                float res_23363 = fmax32(x_23361, x_23362);\n                \n                // store in accumulator\n              ",
                   "  {\n                    x_acc_27890 = res_23363;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_23361 = x_acc_27890;\n        ((__local float *) red_arr_mem_27888)[sext_i32_i64(local_tid_27882)] =\n            x_23361;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_27896;\n    int32_t skip_waves_27897;\n    \n    skip_waves_27897 = 1;\n    \n    float x_27892;\n    float x_27893;\n    \n    offset_27896 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_27882, sext_i64_i32(segred_group_sizze_24268))) {\n            x_27892 = ((__local\n                        float *) red_arr_mem_27888)[sext_i32_i64(local_tid_27882 +\n                                                    offset_27896)];\n        }\n    }\n    offset_27896 = 1;\n    while (slt32(offset_27896, wave_sizze_27884)) {\n        if (slt32(local_tid_27882 + offset_27896,\n                  sext_i64_i32(segred_group_sizze_24268)) && ((local_tid_27882 -\n                                                               squot32(local_tid_27882,\n                                                                       wave_sizze_27884) *\n                                                               wave_sizze_27884) &\n                                                              (2 *\n                                                               offset_27896 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_27893 = ((volatile __local\n                            float *) red_arr_mem_27888)[sext_i32_i64(local_tid_27882 +\n                                                        offset_27896)];\n            }\n            // apply reduction operation\n            {\n                float res_27894 = fmax32(x_27892, x_27893);\n                \n                x_27892 = res_27894;\n            }\n            // write resul",
                   "t of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_27888)[sext_i32_i64(local_tid_27882)] =\n                    x_27892;\n            }\n        }\n        offset_27896 *= 2;\n    }\n    while (slt32(skip_waves_27897,\n                 squot32(sext_i64_i32(segred_group_sizze_24268) +\n                         wave_sizze_27884 - 1, wave_sizze_27884))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_27896 = skip_waves_27897 * wave_sizze_27884;\n        if (slt32(local_tid_27882 + offset_27896,\n                  sext_i64_i32(segred_group_sizze_24268)) && ((local_tid_27882 -\n                                                               squot32(local_tid_27882,\n                                                                       wave_sizze_27884) *\n                                                               wave_sizze_27884) ==\n                                                              0 &&\n                                                              (squot32(local_tid_27882,\n                                                                       wave_sizze_27884) &\n                                                               (2 *\n                                                                skip_waves_27897 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_27893 = ((__local\n                            float *) red_arr_mem_27888)[sext_i32_i64(local_tid_27882 +\n                                                        offset_27896)];\n            }\n            // apply reduction operation\n            {\n                float res_27894 = fmax32(x_27892, x_27893);\n                \n                x_27892 = res_27894;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_27888)[sext_i32_i64(local_tid_27882)] =\n                    x_27892;\n      ",
                   "      }\n        }\n        skip_waves_27897 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_27882) == 0) {\n            x_acc_27890 = x_27892;\n        }\n    }\n    \n    int32_t old_counter_27898;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_27882 == 0) {\n            ((__global\n              float *) group_res_arr_mem_27878)[sext_i32_i64(group_tid_27883) *\n                                                segred_group_sizze_24268] =\n                x_acc_27890;\n            mem_fence_global();\n            old_counter_27898 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_27876)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_27886)[0] = old_counter_27898 ==\n                num_groups_24270 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_27899;\n    \n    is_last_group_27899 = ((__local bool *) sync_arr_mem_27886)[0];\n    if (is_last_group_27899) {\n        if (local_tid_27882 == 0) {\n            old_counter_27898 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_27876)[0],\n                                                      (int) (0 -\n                                                             num_groups_24270));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_27900 = sdiv_up64(num_groups_24270,\n                                                      segred_group_sizze_24268);\n            \n            x_23361 = -INFINITY;\n            for (int64_t i_27901 = 0; i_27901 < read_per_thread_27900;\n                 i_27901++) {\n                int64_t group_res_id_27902 = sext_i32_i64(local_tid_27882) *\n                  ",
                   "      read_per_thread_27900 + i_27901;\n                int64_t index_of_group_res_27903 = group_res_id_27902;\n                \n                if (slt64(group_res_id_27902, num_groups_24270)) {\n                    x_23362 = ((__global\n                                float *) group_res_arr_mem_27878)[index_of_group_res_27903 *\n                                                                  segred_group_sizze_24268];\n                    \n                    float res_23363;\n                    \n                    res_23363 = fmax32(x_23361, x_23362);\n                    x_23361 = res_23363;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_27888)[sext_i32_i64(local_tid_27882)] =\n            x_23361;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_27904;\n            int32_t skip_waves_27905;\n            \n            skip_waves_27905 = 1;\n            \n            float x_27892;\n            float x_27893;\n            \n            offset_27904 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_27882,\n                          sext_i64_i32(segred_group_sizze_24268))) {\n                    x_27892 = ((__local\n                                float *) red_arr_mem_27888)[sext_i32_i64(local_tid_27882 +\n                                                            offset_27904)];\n                }\n            }\n            offset_27904 = 1;\n            while (slt32(offset_27904, wave_sizze_27884)) {\n                if (slt32(local_tid_27882 + offset_27904,\n                          sext_i64_i32(segred_group_sizze_24268)) &&\n                    ((local_tid_27882 - squot32(local_tid_27882,\n                                                wave_sizze_27884) *\n                      wave_sizze_27884) & (2 * offset_27904 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_2",
                   "7893 = ((volatile __local\n                                    float *) red_arr_mem_27888)[sext_i32_i64(local_tid_27882 +\n                                                                offset_27904)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27894 = fmax32(x_27892, x_27893);\n                        \n                        x_27892 = res_27894;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_27888)[sext_i32_i64(local_tid_27882)] =\n                            x_27892;\n                    }\n                }\n                offset_27904 *= 2;\n            }\n            while (slt32(skip_waves_27905,\n                         squot32(sext_i64_i32(segred_group_sizze_24268) +\n                                 wave_sizze_27884 - 1, wave_sizze_27884))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_27904 = skip_waves_27905 * wave_sizze_27884;\n                if (slt32(local_tid_27882 + offset_27904,\n                          sext_i64_i32(segred_group_sizze_24268)) &&\n                    ((local_tid_27882 - squot32(local_tid_27882,\n                                                wave_sizze_27884) *\n                      wave_sizze_27884) == 0 && (squot32(local_tid_27882,\n                                                         wave_sizze_27884) &\n                                                 (2 * skip_waves_27905 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_27893 = ((__local\n                                    float *) red_arr_mem_27888)[sext_i32_i64(local_tid_27882 +\n                                                                offset_27904)];\n                    }\n                    // apply reduction operation\n                    {\n                 ",
                   "       float res_27894 = fmax32(x_27892, x_27893);\n                        \n                        x_27892 = res_27894;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_27888)[sext_i32_i64(local_tid_27882)] =\n                            x_27892;\n                    }\n                }\n                skip_waves_27905 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_27882 == 0) {\n                    ((__global float *) mem_27638)[0] = x_27892;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_24268\n}\n__kernel void mainzisegred_nonseg_25343(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28028_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28026_backing_aligned_1,\n                                        int64_t num_groups_25338,\n                                        int64_t binop_x_27689, __global\n                                        unsigned char *mem_27739, __global\n                                        unsigned char *mem_27742, __global\n                                        unsigned char *mainzicounter_mem_28016,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28018,\n                                        int64_t num_threads_28020)\n{\n    #define segred_group_sizze_25336 (mainzisegred_group_sizze_25335)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28028_backing_1 =\n                          (__local volatile\n                           char *) red_arr_m",
                   "em_28028_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28026_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28026_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28021;\n    int32_t local_tid_28022;\n    int64_t group_sizze_28025;\n    int32_t wave_sizze_28024;\n    int32_t group_tid_28023;\n    \n    global_tid_28021 = get_global_id(0);\n    local_tid_28022 = get_local_id(0);\n    group_sizze_28025 = get_local_size(0);\n    wave_sizze_28024 = LOCKSTEP_WIDTH;\n    group_tid_28023 = get_group_id(0);\n    \n    int32_t phys_tid_25343;\n    \n    phys_tid_25343 = global_tid_28021;\n    \n    __local char *sync_arr_mem_28026;\n    \n    sync_arr_mem_28026 = (__local char *) sync_arr_mem_28026_backing_0;\n    \n    __local char *red_arr_mem_28028;\n    \n    red_arr_mem_28028 = (__local char *) red_arr_mem_28028_backing_1;\n    \n    int64_t dummy_25341;\n    \n    dummy_25341 = 0;\n    \n    int64_t gtid_25342;\n    \n    gtid_25342 = 0;\n    \n    int64_t x_acc_28030;\n    int64_t chunk_sizze_28031;\n    \n    chunk_sizze_28031 = smin64(sdiv_up64(binop_x_27689,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_25336 *\n                                         num_groups_25338))),\n                               sdiv_up64(binop_x_27689 -\n                                         sext_i32_i64(phys_tid_25343),\n                                         num_threads_28020));\n    \n    int64_t x_23551;\n    int64_t x_23552;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28030 = 0;\n    }\n    for (int64_t i_28035 = 0; i_28035 < chunk_sizze_28031; i_28035++) {\n        gtid_25342 = sext_i32_i64(phys_tid_25343) + num_threads_28020 * i_28035;\n        // apply map function\n        {\n            int64_t x_23554 = ((__global int64_t *) mem_27739)[gtid_25342];\n            \n            // save map-out results\n            { }\n            // load",
                   " accumulator\n            {\n                x_23551 = x_acc_28030;\n            }\n            // load new values\n            {\n                x_23552 = x_23554;\n            }\n            // apply reduction operator\n            {\n                int64_t res_23553 = add64(x_23551, x_23552);\n                \n                // store in accumulator\n                {\n                    x_acc_28030 = res_23553;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_23551 = x_acc_28030;\n        ((__local int64_t *) red_arr_mem_28028)[sext_i32_i64(local_tid_28022)] =\n            x_23551;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28036;\n    int32_t skip_waves_28037;\n    \n    skip_waves_28037 = 1;\n    \n    int64_t x_28032;\n    int64_t x_28033;\n    \n    offset_28036 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28022, sext_i64_i32(segred_group_sizze_25336))) {\n            x_28032 = ((__local\n                        int64_t *) red_arr_mem_28028)[sext_i32_i64(local_tid_28022 +\n                                                      offset_28036)];\n        }\n    }\n    offset_28036 = 1;\n    while (slt32(offset_28036, wave_sizze_28024)) {\n        if (slt32(local_tid_28022 + offset_28036,\n                  sext_i64_i32(segred_group_sizze_25336)) && ((local_tid_28022 -\n                                                               squot32(local_tid_28022,\n                                                                       wave_sizze_28024) *\n                                                               wave_sizze_28024) &\n                                                              (2 *\n                                                               offset_28036 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28033 = ((volatile __local\n            ",
                   "                int64_t *) red_arr_mem_28028)[sext_i32_i64(local_tid_28022 +\n                                                          offset_28036)];\n            }\n            // apply reduction operation\n            {\n                int64_t res_28034 = add64(x_28032, x_28033);\n                \n                x_28032 = res_28034;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_28028)[sext_i32_i64(local_tid_28022)] =\n                    x_28032;\n            }\n        }\n        offset_28036 *= 2;\n    }\n    while (slt32(skip_waves_28037,\n                 squot32(sext_i64_i32(segred_group_sizze_25336) +\n                         wave_sizze_28024 - 1, wave_sizze_28024))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28036 = skip_waves_28037 * wave_sizze_28024;\n        if (slt32(local_tid_28022 + offset_28036,\n                  sext_i64_i32(segred_group_sizze_25336)) && ((local_tid_28022 -\n                                                               squot32(local_tid_28022,\n                                                                       wave_sizze_28024) *\n                                                               wave_sizze_28024) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28022,\n                                                                       wave_sizze_28024) &\n                                                               (2 *\n                                                                skip_waves_28037 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28033 = ((__local\n                            int64_t *) red_arr_mem_28028)[sext_i32_i64(local_tid_28022 +\n                                                          offset_28036)];\n           ",
                   " }\n            // apply reduction operation\n            {\n                int64_t res_28034 = add64(x_28032, x_28033);\n                \n                x_28032 = res_28034;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_28028)[sext_i32_i64(local_tid_28022)] =\n                    x_28032;\n            }\n        }\n        skip_waves_28037 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28022) == 0) {\n            x_acc_28030 = x_28032;\n        }\n    }\n    \n    int32_t old_counter_28038;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28022 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_28018)[sext_i32_i64(group_tid_28023) *\n                                                  segred_group_sizze_25336] =\n                x_acc_28030;\n            mem_fence_global();\n            old_counter_28038 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28016)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28026)[0] = old_counter_28038 ==\n                num_groups_25338 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28039;\n    \n    is_last_group_28039 = ((__local bool *) sync_arr_mem_28026)[0];\n    if (is_last_group_28039) {\n        if (local_tid_28022 == 0) {\n            old_counter_28038 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28016)[0],\n                                                      (int) (0 -\n                                                             num_groups_25338));\n        }\n        // read in the per-group-results\n        {\n       ",
                   "     int64_t read_per_thread_28040 = sdiv_up64(num_groups_25338,\n                                                      segred_group_sizze_25336);\n            \n            x_23551 = 0;\n            for (int64_t i_28041 = 0; i_28041 < read_per_thread_28040;\n                 i_28041++) {\n                int64_t group_res_id_28042 = sext_i32_i64(local_tid_28022) *\n                        read_per_thread_28040 + i_28041;\n                int64_t index_of_group_res_28043 = group_res_id_28042;\n                \n                if (slt64(group_res_id_28042, num_groups_25338)) {\n                    x_23552 = ((__global\n                                int64_t *) group_res_arr_mem_28018)[index_of_group_res_28043 *\n                                                                    segred_group_sizze_25336];\n                    \n                    int64_t res_23553;\n                    \n                    res_23553 = add64(x_23551, x_23552);\n                    x_23551 = res_23553;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_28028)[sext_i32_i64(local_tid_28022)] =\n            x_23551;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28044;\n            int32_t skip_waves_28045;\n            \n            skip_waves_28045 = 1;\n            \n            int64_t x_28032;\n            int64_t x_28033;\n            \n            offset_28044 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28022,\n                          sext_i64_i32(segred_group_sizze_25336))) {\n                    x_28032 = ((__local\n                                int64_t *) red_arr_mem_28028)[sext_i32_i64(local_tid_28022 +\n                                                              offset_28044)];\n                }\n            }\n            offset_28044 = 1;\n            while (slt32(offset_28044, wave_sizze_28024)) {\n                if (slt32(loca",
                   "l_tid_28022 + offset_28044,\n                          sext_i64_i32(segred_group_sizze_25336)) &&\n                    ((local_tid_28022 - squot32(local_tid_28022,\n                                                wave_sizze_28024) *\n                      wave_sizze_28024) & (2 * offset_28044 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28033 = ((volatile __local\n                                    int64_t *) red_arr_mem_28028)[sext_i32_i64(local_tid_28022 +\n                                                                  offset_28044)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_28034 = add64(x_28032, x_28033);\n                        \n                        x_28032 = res_28034;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28028)[sext_i32_i64(local_tid_28022)] =\n                            x_28032;\n                    }\n                }\n                offset_28044 *= 2;\n            }\n            while (slt32(skip_waves_28045,\n                         squot32(sext_i64_i32(segred_group_sizze_25336) +\n                                 wave_sizze_28024 - 1, wave_sizze_28024))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28044 = skip_waves_28045 * wave_sizze_28024;\n                if (slt32(local_tid_28022 + offset_28044,\n                          sext_i64_i32(segred_group_sizze_25336)) &&\n                    ((local_tid_28022 - squot32(local_tid_28022,\n                                                wave_sizze_28024) *\n                      wave_sizze_28024) == 0 && (squot32(local_tid_28022,\n                                                         wave_sizze_28024) &\n                                                 (2 * skip_waves_28045 - 1)) ==\n                  ",
                   "   0)) {\n                    // read array element\n                    {\n                        x_28033 = ((__local\n                                    int64_t *) red_arr_mem_28028)[sext_i32_i64(local_tid_28022 +\n                                                                  offset_28044)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_28034 = add64(x_28032, x_28033);\n                        \n                        x_28032 = res_28034;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_28028)[sext_i32_i64(local_tid_28022)] =\n                            x_28032;\n                    }\n                }\n                skip_waves_28045 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28022 == 0) {\n                    ((__global int64_t *) mem_27742)[0] = x_28032;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_25336\n}\n__kernel void mainzisegred_nonseg_25453(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28489_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28487_backing_aligned_1,\n                                        int64_t n_23343, int64_t paths_23346,\n                                        int64_t steps_23347, float a_23351,\n                                        float x_23371, float x_23373,\n                                        float y_23375, float y_23376,\n                                        float sims_per_year_23441,\n                                        float res_23769,\n                                        int64_t num_grou",
                   "ps_25456, __global\n                                        unsigned char *mem_27776, __global\n                                        unsigned char *mem_27779, __global\n                                        unsigned char *mem_27781, __global\n                                        unsigned char *mainzicounter_mem_28477,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28479,\n                                        int64_t num_threads_28481)\n{\n    #define segred_group_sizze_25455 (mainzisegred_group_sizze_25444)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28489_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28489_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28487_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28487_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28482;\n    int32_t local_tid_28483;\n    int64_t group_sizze_28486;\n    int32_t wave_sizze_28485;\n    int32_t group_tid_28484;\n    \n    global_tid_28482 = get_global_id(0);\n    local_tid_28483 = get_local_id(0);\n    group_sizze_28486 = get_local_size(0);\n    wave_sizze_28485 = LOCKSTEP_WIDTH;\n    group_tid_28484 = get_group_id(0);\n    \n    int32_t phys_tid_25453;\n    \n    phys_tid_25453 = global_tid_28482;\n    \n    __local char *sync_arr_mem_28487;\n    \n    sync_arr_mem_28487 = (__local char *) sync_arr_mem_28487_backing_0;\n    \n    __local char *red_arr_mem_28489;\n    \n    red_arr_mem_28489 = (__local char *) red_arr_mem_28489_backing_1;\n    \n    int64_t dummy_25451;\n    \n    dummy_25451 = 0;\n    \n    int64_t gtid_25452;\n    \n    gtid_25452 = 0;\n    \n    float x_acc_28491;\n    int64_t chunk_sizze_28492;\n    \n    chunk_sizze_28492 = smin64(sdiv_up64(steps_2",
                   "3347,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_25455 *\n                                         num_groups_25456))),\n                               sdiv_up64(steps_23347 -\n                                         sext_i32_i64(phys_tid_25453),\n                                         num_threads_28481));\n    \n    float x_25460;\n    float x_25461;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28491 = 0.0F;\n    }\n    for (int64_t i_28496 = 0; i_28496 < chunk_sizze_28492; i_28496++) {\n        gtid_25452 = sext_i32_i64(phys_tid_25453) + num_threads_28481 * i_28496;\n        // apply map function\n        {\n            int64_t convop_x_27558 = add64(1, gtid_25452);\n            float binop_x_27559 = sitofp_i64_f32(convop_x_27558);\n            float index_primexp_27560 = binop_x_27559 / sims_per_year_23441;\n            float res_25465;\n            float redout_27612 = 0.0F;\n            \n            for (int64_t i_27613 = 0; i_27613 < paths_23346; i_27613++) {\n                float res_25470;\n                float redout_27614 = 0.0F;\n                \n                for (int64_t i_27615 = 0; i_27615 < n_23343; i_27615++) {\n                    float x_25474 = ((__global float *) mem_27776)[i_27613 *\n                                                                   (steps_23347 *\n                                                                    n_23343) +\n                                                                   i_27615 *\n                                                                   steps_23347 +\n                                                                   gtid_25452];\n                    float res_25473 = x_25474 + redout_27614;\n                    float redout_tmp_28498 = res_25473;\n                    \n                    redout_27614 = redout_tmp_28498;\n                }\n                res_25470 = redout_27614;\n                \n                float res_25475 = fmax32(0.0F, res_25470)",
                   ";\n                float res_25468 = res_25475 + redout_27612;\n                float redout_tmp_28497 = res_25468;\n                \n                redout_27612 = redout_tmp_28497;\n            }\n            res_25465 = redout_27612;\n            \n            float res_25476 = res_25465 / res_23769;\n            float negate_arg_25477 = a_23351 * index_primexp_27560;\n            float exp_arg_25478 = 0.0F - negate_arg_25477;\n            float res_25479 = fpow32(2.7182817F, exp_arg_25478);\n            float x_25480 = 1.0F - res_25479;\n            float B_25481 = x_25480 / a_23351;\n            float x_25482 = B_25481 - index_primexp_27560;\n            float x_25483 = y_23375 * x_25482;\n            float A1_25484 = x_25483 / x_23371;\n            float y_25485 = fpow32(B_25481, 2.0F);\n            float x_25486 = x_23373 * y_25485;\n            float A2_25487 = x_25486 / y_23376;\n            float exp_arg_25488 = A1_25484 - A2_25487;\n            float res_25489 = fpow32(2.7182817F, exp_arg_25488);\n            float negate_arg_25490 = 5.0e-2F * B_25481;\n            float exp_arg_25491 = 0.0F - negate_arg_25490;\n            float res_25492 = fpow32(2.7182817F, exp_arg_25491);\n            float res_25493 = res_25489 * res_25492;\n            float res_25494 = res_25476 * res_25493;\n            \n            // save map-out results\n            {\n                ((__global float *) mem_27781)[dummy_25451 * steps_23347 +\n                                               gtid_25452] = res_25476;\n            }\n            // load accumulator\n            {\n                x_25460 = x_acc_28491;\n            }\n            // load new values\n            {\n                x_25461 = res_25494;\n            }\n            // apply reduction operator\n            {\n                float res_25462 = x_25460 + x_25461;\n                \n                // store in accumulator\n                {\n                    x_acc_28491 = res_25462;\n                }\n            }\n        }\n    }\n    // to reduce ",
                   "current chunk, first store our result in memory\n    {\n        x_25460 = x_acc_28491;\n        ((__local float *) red_arr_mem_28489)[sext_i32_i64(local_tid_28483)] =\n            x_25460;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28499;\n    int32_t skip_waves_28500;\n    \n    skip_waves_28500 = 1;\n    \n    float x_28493;\n    float x_28494;\n    \n    offset_28499 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28483, sext_i64_i32(segred_group_sizze_25455))) {\n            x_28493 = ((__local\n                        float *) red_arr_mem_28489)[sext_i32_i64(local_tid_28483 +\n                                                    offset_28499)];\n        }\n    }\n    offset_28499 = 1;\n    while (slt32(offset_28499, wave_sizze_28485)) {\n        if (slt32(local_tid_28483 + offset_28499,\n                  sext_i64_i32(segred_group_sizze_25455)) && ((local_tid_28483 -\n                                                               squot32(local_tid_28483,\n                                                                       wave_sizze_28485) *\n                                                               wave_sizze_28485) &\n                                                              (2 *\n                                                               offset_28499 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28494 = ((volatile __local\n                            float *) red_arr_mem_28489)[sext_i32_i64(local_tid_28483 +\n                                                        offset_28499)];\n            }\n            // apply reduction operation\n            {\n                float res_28495 = x_28493 + x_28494;\n                \n                x_28493 = res_28495;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_28489)[sext_i32_i6",
                   "4(local_tid_28483)] =\n                    x_28493;\n            }\n        }\n        offset_28499 *= 2;\n    }\n    while (slt32(skip_waves_28500,\n                 squot32(sext_i64_i32(segred_group_sizze_25455) +\n                         wave_sizze_28485 - 1, wave_sizze_28485))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28499 = skip_waves_28500 * wave_sizze_28485;\n        if (slt32(local_tid_28483 + offset_28499,\n                  sext_i64_i32(segred_group_sizze_25455)) && ((local_tid_28483 -\n                                                               squot32(local_tid_28483,\n                                                                       wave_sizze_28485) *\n                                                               wave_sizze_28485) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28483,\n                                                                       wave_sizze_28485) &\n                                                               (2 *\n                                                                skip_waves_28500 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28494 = ((__local\n                            float *) red_arr_mem_28489)[sext_i32_i64(local_tid_28483 +\n                                                        offset_28499)];\n            }\n            // apply reduction operation\n            {\n                float res_28495 = x_28493 + x_28494;\n                \n                x_28493 = res_28495;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_28489)[sext_i32_i64(local_tid_28483)] =\n                    x_28493;\n            }\n        }\n        skip_waves_28500 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in",
                   " accumulator\n    {\n        if (sext_i32_i64(local_tid_28483) == 0) {\n            x_acc_28491 = x_28493;\n        }\n    }\n    \n    int32_t old_counter_28501;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28483 == 0) {\n            ((__global\n              float *) group_res_arr_mem_28479)[sext_i32_i64(group_tid_28484) *\n                                                segred_group_sizze_25455] =\n                x_acc_28491;\n            mem_fence_global();\n            old_counter_28501 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28477)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28487)[0] = old_counter_28501 ==\n                num_groups_25456 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28502;\n    \n    is_last_group_28502 = ((__local bool *) sync_arr_mem_28487)[0];\n    if (is_last_group_28502) {\n        if (local_tid_28483 == 0) {\n            old_counter_28501 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28477)[0],\n                                                      (int) (0 -\n                                                             num_groups_25456));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28503 = sdiv_up64(num_groups_25456,\n                                                      segred_group_sizze_25455);\n            \n            x_25460 = 0.0F;\n            for (int64_t i_28504 = 0; i_28504 < read_per_thread_28503;\n                 i_28504++) {\n                int64_t group_res_id_28505 = sext_i32_i64(local_tid_28483) *\n                        read_per_thread_28503 + i_28504;\n                int64_t index_of_group_res_28506 = group_res_id_28505;\n                \n      ",
                   "          if (slt64(group_res_id_28505, num_groups_25456)) {\n                    x_25461 = ((__global\n                                float *) group_res_arr_mem_28479)[index_of_group_res_28506 *\n                                                                  segred_group_sizze_25455];\n                    \n                    float res_25462;\n                    \n                    res_25462 = x_25460 + x_25461;\n                    x_25460 = res_25462;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_28489)[sext_i32_i64(local_tid_28483)] =\n            x_25460;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28507;\n            int32_t skip_waves_28508;\n            \n            skip_waves_28508 = 1;\n            \n            float x_28493;\n            float x_28494;\n            \n            offset_28507 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28483,\n                          sext_i64_i32(segred_group_sizze_25455))) {\n                    x_28493 = ((__local\n                                float *) red_arr_mem_28489)[sext_i32_i64(local_tid_28483 +\n                                                            offset_28507)];\n                }\n            }\n            offset_28507 = 1;\n            while (slt32(offset_28507, wave_sizze_28485)) {\n                if (slt32(local_tid_28483 + offset_28507,\n                          sext_i64_i32(segred_group_sizze_25455)) &&\n                    ((local_tid_28483 - squot32(local_tid_28483,\n                                                wave_sizze_28485) *\n                      wave_sizze_28485) & (2 * offset_28507 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28494 = ((volatile __local\n                                    float *) red_arr_mem_28489)[sext_i32_i64(local_tid_28483 +\n                   ",
                   "                                             offset_28507)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28495 = x_28493 + x_28494;\n                        \n                        x_28493 = res_28495;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_28489)[sext_i32_i64(local_tid_28483)] =\n                            x_28493;\n                    }\n                }\n                offset_28507 *= 2;\n            }\n            while (slt32(skip_waves_28508,\n                         squot32(sext_i64_i32(segred_group_sizze_25455) +\n                                 wave_sizze_28485 - 1, wave_sizze_28485))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28507 = skip_waves_28508 * wave_sizze_28485;\n                if (slt32(local_tid_28483 + offset_28507,\n                          sext_i64_i32(segred_group_sizze_25455)) &&\n                    ((local_tid_28483 - squot32(local_tid_28483,\n                                                wave_sizze_28485) *\n                      wave_sizze_28485) == 0 && (squot32(local_tid_28483,\n                                                         wave_sizze_28485) &\n                                                 (2 * skip_waves_28508 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28494 = ((__local\n                                    float *) red_arr_mem_28489)[sext_i32_i64(local_tid_28483 +\n                                                                offset_28507)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28495 = x_28493 + x_28494;\n                        \n                        x_28493 = res_28495;\n                    }\n           ",
                   "         // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_28489)[sext_i32_i64(local_tid_28483)] =\n                            x_28493;\n                    }\n                }\n                skip_waves_28508 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28483 == 0) {\n                    ((__global float *) mem_27779)[0] = x_28493;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_25455\n}\n__kernel void mainzisegred_nonseg_25726(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28613_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28611_backing_aligned_1,\n                                        int64_t steps_23347,\n                                        int64_t num_groups_25858, __global\n                                        unsigned char *res_map_acc_mem_27815,\n                                        __global unsigned char *mem_27819,\n                                        __global\n                                        unsigned char *mainzicounter_mem_28601,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28603,\n                                        int64_t num_threads_28605)\n{\n    #define segred_group_sizze_25857 (mainzisegred_group_sizze_25718)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28613_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28613_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28611_backing_0 =\n         ",
                   "                 (__local volatile\n                           char *) sync_arr_mem_28611_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28606;\n    int32_t local_tid_28607;\n    int64_t group_sizze_28610;\n    int32_t wave_sizze_28609;\n    int32_t group_tid_28608;\n    \n    global_tid_28606 = get_global_id(0);\n    local_tid_28607 = get_local_id(0);\n    group_sizze_28610 = get_local_size(0);\n    wave_sizze_28609 = LOCKSTEP_WIDTH;\n    group_tid_28608 = get_group_id(0);\n    \n    int32_t phys_tid_25726;\n    \n    phys_tid_25726 = global_tid_28606;\n    \n    __local char *sync_arr_mem_28611;\n    \n    sync_arr_mem_28611 = (__local char *) sync_arr_mem_28611_backing_0;\n    \n    __local char *red_arr_mem_28613;\n    \n    red_arr_mem_28613 = (__local char *) red_arr_mem_28613_backing_1;\n    \n    int64_t dummy_25724;\n    \n    dummy_25724 = 0;\n    \n    int64_t gtid_25725;\n    \n    gtid_25725 = 0;\n    \n    float x_acc_28615;\n    int64_t chunk_sizze_28616;\n    \n    chunk_sizze_28616 = smin64(sdiv_up64(steps_23347,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_25857 *\n                                         num_groups_25858))),\n                               sdiv_up64(steps_23347 -\n                                         sext_i32_i64(phys_tid_25726),\n                                         num_threads_28605));\n    \n    float x_25861;\n    float x_25862;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28615 = 0.0F;\n    }\n    for (int64_t i_28620 = 0; i_28620 < chunk_sizze_28616; i_28620++) {\n        gtid_25725 = sext_i32_i64(phys_tid_25726) + num_threads_28605 * i_28620;\n        // apply map function\n        {\n            float x_25864 = ((__global\n                              float *) res_map_acc_mem_27815)[gtid_25725];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_25861 = x_acc_28615;\n       ",
                   "     }\n            // load new values\n            {\n                x_25862 = x_25864;\n            }\n            // apply reduction operator\n            {\n                float res_25863 = x_25861 + x_25862;\n                \n                // store in accumulator\n                {\n                    x_acc_28615 = res_25863;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_25861 = x_acc_28615;\n        ((__local float *) red_arr_mem_28613)[sext_i32_i64(local_tid_28607)] =\n            x_25861;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28621;\n    int32_t skip_waves_28622;\n    \n    skip_waves_28622 = 1;\n    \n    float x_28617;\n    float x_28618;\n    \n    offset_28621 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28607, sext_i64_i32(segred_group_sizze_25857))) {\n            x_28617 = ((__local\n                        float *) red_arr_mem_28613)[sext_i32_i64(local_tid_28607 +\n                                                    offset_28621)];\n        }\n    }\n    offset_28621 = 1;\n    while (slt32(offset_28621, wave_sizze_28609)) {\n        if (slt32(local_tid_28607 + offset_28621,\n                  sext_i64_i32(segred_group_sizze_25857)) && ((local_tid_28607 -\n                                                               squot32(local_tid_28607,\n                                                                       wave_sizze_28609) *\n                                                               wave_sizze_28609) &\n                                                              (2 *\n                                                               offset_28621 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28618 = ((volatile __local\n                            float *) red_arr_mem_28613)[sext_i32_i64(local_tid_28607 +\n                ",
                   "                                        offset_28621)];\n            }\n            // apply reduction operation\n            {\n                float res_28619 = x_28617 + x_28618;\n                \n                x_28617 = res_28619;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_28613)[sext_i32_i64(local_tid_28607)] =\n                    x_28617;\n            }\n        }\n        offset_28621 *= 2;\n    }\n    while (slt32(skip_waves_28622,\n                 squot32(sext_i64_i32(segred_group_sizze_25857) +\n                         wave_sizze_28609 - 1, wave_sizze_28609))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28621 = skip_waves_28622 * wave_sizze_28609;\n        if (slt32(local_tid_28607 + offset_28621,\n                  sext_i64_i32(segred_group_sizze_25857)) && ((local_tid_28607 -\n                                                               squot32(local_tid_28607,\n                                                                       wave_sizze_28609) *\n                                                               wave_sizze_28609) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28607,\n                                                                       wave_sizze_28609) &\n                                                               (2 *\n                                                                skip_waves_28622 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28618 = ((__local\n                            float *) red_arr_mem_28613)[sext_i32_i64(local_tid_28607 +\n                                                        offset_28621)];\n            }\n            // apply reduction operation\n            {\n                float res_28619 = x_28617 + x_28618",
                   ";\n                \n                x_28617 = res_28619;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_28613)[sext_i32_i64(local_tid_28607)] =\n                    x_28617;\n            }\n        }\n        skip_waves_28622 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28607) == 0) {\n            x_acc_28615 = x_28617;\n        }\n    }\n    \n    int32_t old_counter_28623;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28607 == 0) {\n            ((__global\n              float *) group_res_arr_mem_28603)[sext_i32_i64(group_tid_28608) *\n                                                segred_group_sizze_25857] =\n                x_acc_28615;\n            mem_fence_global();\n            old_counter_28623 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28601)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28611)[0] = old_counter_28623 ==\n                num_groups_25858 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28624;\n    \n    is_last_group_28624 = ((__local bool *) sync_arr_mem_28611)[0];\n    if (is_last_group_28624) {\n        if (local_tid_28607 == 0) {\n            old_counter_28623 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28601)[0],\n                                                      (int) (0 -\n                                                             num_groups_25858));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28625 = sdiv_up64(num_groups_25858,\n                                                      segr",
                   "ed_group_sizze_25857);\n            \n            x_25861 = 0.0F;\n            for (int64_t i_28626 = 0; i_28626 < read_per_thread_28625;\n                 i_28626++) {\n                int64_t group_res_id_28627 = sext_i32_i64(local_tid_28607) *\n                        read_per_thread_28625 + i_28626;\n                int64_t index_of_group_res_28628 = group_res_id_28627;\n                \n                if (slt64(group_res_id_28627, num_groups_25858)) {\n                    x_25862 = ((__global\n                                float *) group_res_arr_mem_28603)[index_of_group_res_28628 *\n                                                                  segred_group_sizze_25857];\n                    \n                    float res_25863;\n                    \n                    res_25863 = x_25861 + x_25862;\n                    x_25861 = res_25863;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_28613)[sext_i32_i64(local_tid_28607)] =\n            x_25861;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28629;\n            int32_t skip_waves_28630;\n            \n            skip_waves_28630 = 1;\n            \n            float x_28617;\n            float x_28618;\n            \n            offset_28629 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28607,\n                          sext_i64_i32(segred_group_sizze_25857))) {\n                    x_28617 = ((__local\n                                float *) red_arr_mem_28613)[sext_i32_i64(local_tid_28607 +\n                                                            offset_28629)];\n                }\n            }\n            offset_28629 = 1;\n            while (slt32(offset_28629, wave_sizze_28609)) {\n                if (slt32(local_tid_28607 + offset_28629,\n                          sext_i64_i32(segred_group_sizze_25857)) &&\n                    ((local_tid_28607 - squot",
                   "32(local_tid_28607,\n                                                wave_sizze_28609) *\n                      wave_sizze_28609) & (2 * offset_28629 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28618 = ((volatile __local\n                                    float *) red_arr_mem_28613)[sext_i32_i64(local_tid_28607 +\n                                                                offset_28629)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28619 = x_28617 + x_28618;\n                        \n                        x_28617 = res_28619;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_28613)[sext_i32_i64(local_tid_28607)] =\n                            x_28617;\n                    }\n                }\n                offset_28629 *= 2;\n            }\n            while (slt32(skip_waves_28630,\n                         squot32(sext_i64_i32(segred_group_sizze_25857) +\n                                 wave_sizze_28609 - 1, wave_sizze_28609))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28629 = skip_waves_28630 * wave_sizze_28609;\n                if (slt32(local_tid_28607 + offset_28629,\n                          sext_i64_i32(segred_group_sizze_25857)) &&\n                    ((local_tid_28607 - squot32(local_tid_28607,\n                                                wave_sizze_28609) *\n                      wave_sizze_28609) == 0 && (squot32(local_tid_28607,\n                                                         wave_sizze_28609) &\n                                                 (2 * skip_waves_28630 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28618 = ((__local\n                                    flo",
                   "at *) red_arr_mem_28613)[sext_i32_i64(local_tid_28607 +\n                                                                offset_28629)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28619 = x_28617 + x_28618;\n                        \n                        x_28617 = res_28619;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_28613)[sext_i32_i64(local_tid_28607)] =\n                            x_28617;\n                    }\n                }\n                skip_waves_28630 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28607 == 0) {\n                    ((__global float *) mem_27819)[0] = x_28617;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_25857\n}\n__kernel void mainzisegred_small_25658(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *red_arr_mem_28539_backing_aligned_0,\n                                       int64_t n_23343, int64_t paths_23346,\n                                       int64_t steps_23347,\n                                       int64_t num_groups_25814, __global\n                                       unsigned char *mem_27804, __global\n                                       unsigned char *mem_27807,\n                                       int64_t segment_sizze_nonzzero_28532)\n{\n    #define segred_group_sizze_25813 (mainzisegred_group_sizze_25652)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28539_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28539_backing_aligned_0;\n    \n    if (*glo",
                   "bal_failure >= 0)\n        return;\n    \n    int32_t global_tid_28534;\n    int32_t local_tid_28535;\n    int64_t group_sizze_28538;\n    int32_t wave_sizze_28537;\n    int32_t group_tid_28536;\n    \n    global_tid_28534 = get_global_id(0);\n    local_tid_28535 = get_local_id(0);\n    group_sizze_28538 = get_local_size(0);\n    wave_sizze_28537 = LOCKSTEP_WIDTH;\n    group_tid_28536 = get_group_id(0);\n    \n    int32_t phys_tid_25658;\n    \n    phys_tid_25658 = global_tid_28534;\n    \n    __local char *red_arr_mem_28539;\n    \n    red_arr_mem_28539 = (__local char *) red_arr_mem_28539_backing_0;\n    \n    int32_t phys_group_id_28541;\n    \n    phys_group_id_28541 = get_group_id(0);\n    for (int32_t i_28542 = 0; i_28542 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(steps_23347,\n                                          squot64(segred_group_sizze_25813,\n                                                  segment_sizze_nonzzero_28532))) -\n                   phys_group_id_28541, sext_i64_i32(num_groups_25814));\n         i_28542++) {\n        int32_t virt_group_id_28543 = phys_group_id_28541 + i_28542 *\n                sext_i64_i32(num_groups_25814);\n        int64_t gtid_25649 = squot64(sext_i32_i64(local_tid_28535),\n                                     segment_sizze_nonzzero_28532) +\n                sext_i32_i64(virt_group_id_28543) *\n                squot64(segred_group_sizze_25813, segment_sizze_nonzzero_28532);\n        int64_t gtid_25657 = srem64(sext_i32_i64(local_tid_28535), paths_23346);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, paths_23346) && (slt64(gtid_25649, steps_23347) &&\n                                          slt64(sext_i32_i64(local_tid_28535),\n                                                paths_23346 *\n                                                squot64(segred_group_sizze_25813,\n                                                        segment_sizze_nonzzero_28532)))) {\n                float res_25822;\n                float ",
                   "redout_27622 = 0.0F;\n                \n                for (int64_t i_27623 = 0; i_27623 < n_23343; i_27623++) {\n                    float x_25826 = ((__global float *) mem_27804)[i_27623 *\n                                                                   (steps_23347 *\n                                                                    paths_23346) +\n                                                                   gtid_25657 *\n                                                                   steps_23347 +\n                                                                   gtid_25649];\n                    float res_25825 = x_25826 + redout_27622;\n                    float redout_tmp_28544 = res_25825;\n                    \n                    redout_27622 = redout_tmp_28544;\n                }\n                res_25822 = redout_27622;\n                \n                float res_25827 = fmax32(0.0F, res_25822);\n                \n                // save map-out results\n                { }\n                // save results to be reduced\n                {\n                    ((__local\n                      float *) red_arr_mem_28539)[sext_i32_i64(local_tid_28535)] =\n                        res_25827;\n                }\n            } else {\n                ((__local\n                  float *) red_arr_mem_28539)[sext_i32_i64(local_tid_28535)] =\n                    0.0F;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, paths_23346)) {\n            // perform segmented scan to imitate reduction\n            {\n                float x_25817;\n                float x_25818;\n                float x_28545;\n                float x_28546;\n                bool ltid_in_bounds_28548;\n                \n                ltid_in_bounds_28548 = slt64(sext_i32_i64(local_tid_28535),\n                                             paths_23346 *\n                                             squot64(segred_group_sizze_25813,\n                                                ",
                   "     segment_sizze_nonzzero_28532));\n                \n                int32_t skip_threads_28549;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_28548) {\n                        x_25818 = ((volatile __local\n                                    float *) red_arr_mem_28539)[sext_i32_i64(local_tid_28535)];\n                        if ((local_tid_28535 - squot32(local_tid_28535, 32) *\n                             32) == 0) {\n                            x_25817 = x_25818;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28549 = 1;\n                    while (slt32(skip_threads_28549, 32)) {\n                        if (sle32(skip_threads_28549, local_tid_28535 -\n                                  squot32(local_tid_28535, 32) * 32) &&\n                            ltid_in_bounds_28548) {\n                            // read operands\n                            {\n                                x_25817 = ((volatile __local\n                                            float *) red_arr_mem_28539)[sext_i32_i64(local_tid_28535) -\n                                                                        sext_i32_i64(skip_threads_28549)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_28550 =\n                                     slt64(srem64(sext_i32_i64(local_tid_28535),\n                                                  paths_23346),\n                                           sext_i32_i64(local_tid_28535) -\n                                           sext_i32_i64(local_tid_28535 -\n                                           skip_threads_28549));\n                                \n                                if (inactive_28550) {\n                                    x_25817 = x_2581",
                   "8;\n                                }\n                                if (!inactive_28550) {\n                                    float res_25819 = x_25817 + x_25818;\n                                    \n                                    x_25817 = res_25819;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_28537, skip_threads_28549)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28549, local_tid_28535 -\n                                  squot32(local_tid_28535, 32) * 32) &&\n                            ltid_in_bounds_28548) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_28539)[sext_i32_i64(local_tid_28535)] =\n                                    x_25817;\n                                x_25818 = x_25817;\n                            }\n                        }\n                        if (sle32(wave_sizze_28537, skip_threads_28549)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28549 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_28535 - squot32(local_tid_28535, 32) * 32) ==\n                        31 && ltid_in_bounds_28548) {\n                        ((volatile __local\n                          float *) red_arr_mem_28539)[sext_i32_i64(squot32(local_tid_28535,\n                                                                           32))] =\n                            x_25817;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset ",
                   "'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_28551;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_28535, 32) == 0 &&\n                            ltid_in_bounds_28548) {\n                            x_28546 = ((volatile __local\n                                        float *) red_arr_mem_28539)[sext_i32_i64(local_tid_28535)];\n                            if ((local_tid_28535 - squot32(local_tid_28535,\n                                                           32) * 32) == 0) {\n                                x_28545 = x_28546;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_28551 = 1;\n                        while (slt32(skip_threads_28551, 32)) {\n                            if (sle32(skip_threads_28551, local_tid_28535 -\n                                      squot32(local_tid_28535, 32) * 32) &&\n                                (squot32(local_tid_28535, 32) == 0 &&\n                                 ltid_in_bounds_28548)) {\n                                // read operands\n                                {\n                                    x_28545 = ((volatile __local\n                                                float *) red_arr_mem_28539)[sext_i32_i64(local_tid_28535) -\n                                                                            sext_i32_i64(skip_threads_28551)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_28552 =\n                                         slt64(srem64(sext_i32_i64(local_tid_28535 *\n                                                      32 + 32 - 1),\n                                                      paths_2334",
                   "6),\n                                               sext_i32_i64(local_tid_28535 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_28535 -\n                                                             skip_threads_28551) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_28552) {\n                                        x_28545 = x_28546;\n                                    }\n                                    if (!inactive_28552) {\n                                        float res_28547 = x_28545 + x_28546;\n                                        \n                                        x_28545 = res_28547;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_28537, skip_threads_28551)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_28551, local_tid_28535 -\n                                      squot32(local_tid_28535, 32) * 32) &&\n                                (squot32(local_tid_28535, 32) == 0 &&\n                                 ltid_in_bounds_28548)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      float *) red_arr_mem_28539)[sext_i32_i64(local_tid_28535)] =\n                                        x_28545;\n                                    x_28546 = x_28545;\n                                }\n                            }\n                            if (sle32(wave_sizze_28537, skip_threads_28551)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_28551 *= 2;\n                     ",
                   "   }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_28535, 32) == 0 ||\n                          !ltid_in_bounds_28548)) {\n                        // read operands\n                        {\n                            x_25818 = x_25817;\n                            x_25817 = ((__local\n                                        float *) red_arr_mem_28539)[sext_i32_i64(squot32(local_tid_28535,\n                                                                                         32)) -\n                                                                    1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_28553 =\n                                 slt64(srem64(sext_i32_i64(local_tid_28535),\n                                              paths_23346),\n                                       sext_i32_i64(local_tid_28535) -\n                                       sext_i32_i64(squot32(local_tid_28535,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_28553) {\n                                x_25817 = x_25818;\n                            }\n                            if (!inactive_28553) {\n                                float res_25819 = x_25817 + x_25818;\n                                \n                                x_25817 = res_25819;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              float *) red_arr_mem_28539)[sext_i32_i64(local_tid_28535)] =\n                                x_25817;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FEN",
                   "CE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_28535, 32) == 0) {\n                        ((__local\n                          float *) red_arr_mem_28539)[sext_i32_i64(local_tid_28535)] =\n                            x_25818;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_28543) *\n                      squot64(segred_group_sizze_25813,\n                              segment_sizze_nonzzero_28532) +\n                      sext_i32_i64(local_tid_28535), steps_23347) &&\n                slt64(sext_i32_i64(local_tid_28535),\n                      squot64(segred_group_sizze_25813,\n                              segment_sizze_nonzzero_28532))) {\n                ((__global\n                  float *) mem_27807)[sext_i32_i64(virt_group_id_28543) *\n                                      squot64(segred_group_sizze_25813,\n                                              segment_sizze_nonzzero_28532) +\n                                      sext_i32_i64(local_tid_28535)] = ((__local\n                                                                         float *) red_arr_mem_28539)[(sext_i32_i64(local_tid_28535) +\n                                                                                                      1) *\n                                                                                                     segment_sizze_nonzzero_28532 -\n                                                                                                     1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_25813\n}\n__kernel void mainzisegred_small_28142(__global int *global_failure,\n         ",
                   "                              __local volatile\n                                       int64_t *red_arr_mem_28150_backing_aligned_0,\n                                       int64_t res_23550,\n                                       int64_t num_groups_25348, __global\n                                       unsigned char *mem_27744,\n                                       int32_t num_subhistos_28056, __global\n                                       unsigned char *res_subhistos_mem_28057,\n                                       int64_t segment_sizze_nonzzero_28143)\n{\n    #define seghist_group_sizze_25346 (mainziseghist_group_sizze_25345)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28150_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28150_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28145;\n    int32_t local_tid_28146;\n    int64_t group_sizze_28149;\n    int32_t wave_sizze_28148;\n    int32_t group_tid_28147;\n    \n    global_tid_28145 = get_global_id(0);\n    local_tid_28146 = get_local_id(0);\n    group_sizze_28149 = get_local_size(0);\n    wave_sizze_28148 = LOCKSTEP_WIDTH;\n    group_tid_28147 = get_group_id(0);\n    \n    int32_t flat_gtid_28142;\n    \n    flat_gtid_28142 = global_tid_28145;\n    \n    __local char *red_arr_mem_28150;\n    \n    red_arr_mem_28150 = (__local char *) red_arr_mem_28150_backing_0;\n    \n    int32_t phys_group_id_28152;\n    \n    phys_group_id_28152 = get_group_id(0);\n    for (int32_t i_28153 = 0; i_28153 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(res_23550,\n                                          squot64(seghist_group_sizze_25346,\n                                                  segment_sizze_nonzzero_28143))) -\n                   phys_group_id_28152, sext_i64_i32(num_groups_25348));\n         i_28153++) {\n        int32_t virt_group_id_28154 = phys_gr",
                   "oup_id_28152 + i_28153 *\n                sext_i64_i32(num_groups_25348);\n        int64_t bucket_id_28140 = squot64(sext_i32_i64(local_tid_28146),\n                                          segment_sizze_nonzzero_28143) +\n                sext_i32_i64(virt_group_id_28154) *\n                squot64(seghist_group_sizze_25346,\n                        segment_sizze_nonzzero_28143);\n        int64_t subhistogram_id_28141 = srem64(sext_i32_i64(local_tid_28146),\n                                               num_subhistos_28056);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, num_subhistos_28056) && (slt64(bucket_id_28140,\n                                                        res_23550) &&\n                                                  slt64(sext_i32_i64(local_tid_28146),\n                                                        num_subhistos_28056 *\n                                                        squot64(seghist_group_sizze_25346,\n                                                                segment_sizze_nonzzero_28143)))) {\n                // save results to be reduced\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_28150)[sext_i32_i64(local_tid_28146)] =\n                        ((__global\n                          int64_t *) res_subhistos_mem_28057)[subhistogram_id_28141 *\n                                                              res_23550 +\n                                                              bucket_id_28140];\n                }\n            } else {\n                ((__local\n                  int64_t *) red_arr_mem_28150)[sext_i32_i64(local_tid_28146)] =\n                    0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, num_subhistos_28056)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t x_25352;\n                int64_t x_25353;\n                int64_t x_28155;\n             ",
                   "   int64_t x_28156;\n                bool ltid_in_bounds_28158;\n                \n                ltid_in_bounds_28158 = slt64(sext_i32_i64(local_tid_28146),\n                                             num_subhistos_28056 *\n                                             squot64(seghist_group_sizze_25346,\n                                                     segment_sizze_nonzzero_28143));\n                \n                int32_t skip_threads_28159;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_28158) {\n                        x_25353 = ((volatile __local\n                                    int64_t *) red_arr_mem_28150)[sext_i32_i64(local_tid_28146)];\n                        if ((local_tid_28146 - squot32(local_tid_28146, 32) *\n                             32) == 0) {\n                            x_25352 = x_25353;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28159 = 1;\n                    while (slt32(skip_threads_28159, 32)) {\n                        if (sle32(skip_threads_28159, local_tid_28146 -\n                                  squot32(local_tid_28146, 32) * 32) &&\n                            ltid_in_bounds_28158) {\n                            // read operands\n                            {\n                                x_25352 = ((volatile __local\n                                            int64_t *) red_arr_mem_28150)[sext_i32_i64(local_tid_28146) -\n                                                                          sext_i32_i64(skip_threads_28159)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_28160 =\n                                     slt64(srem64(sext_i32_i64(local_tid_28146),\n                                                  num_subhis",
                   "tos_28056),\n                                           sext_i32_i64(local_tid_28146) -\n                                           sext_i32_i64(local_tid_28146 -\n                                           skip_threads_28159));\n                                \n                                if (inactive_28160) {\n                                    x_25352 = x_25353;\n                                }\n                                if (!inactive_28160) {\n                                    int64_t res_25354 = smax64(x_25352,\n                                                               x_25353);\n                                    \n                                    x_25352 = res_25354;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_28148, skip_threads_28159)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28159, local_tid_28146 -\n                                  squot32(local_tid_28146, 32) * 32) &&\n                            ltid_in_bounds_28158) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_28150)[sext_i32_i64(local_tid_28146)] =\n                                    x_25352;\n                                x_25353 = x_25352;\n                            }\n                        }\n                        if (sle32(wave_sizze_28148, skip_threads_28159)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28159 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_28146 - squot32(local_tid_28146, 32) * 32) ==\n                ",
                   "        31 && ltid_in_bounds_28158) {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28150)[sext_i32_i64(squot32(local_tid_28146,\n                                                                             32))] =\n                            x_25352;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_28161;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_28146, 32) == 0 &&\n                            ltid_in_bounds_28158) {\n                            x_28156 = ((volatile __local\n                                        int64_t *) red_arr_mem_28150)[sext_i32_i64(local_tid_28146)];\n                            if ((local_tid_28146 - squot32(local_tid_28146,\n                                                           32) * 32) == 0) {\n                                x_28155 = x_28156;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_28161 = 1;\n                        while (slt32(skip_threads_28161, 32)) {\n                            if (sle32(skip_threads_28161, local_tid_28146 -\n                                      squot32(local_tid_28146, 32) * 32) &&\n                                (squot32(local_tid_28146, 32) == 0 &&\n                                 ltid_in_bounds_28158)) {\n                                // read operands\n                                {\n                                    x_28155 = ((volatile __local\n                                                int64_t *) red_arr_mem_28150)[sext_i32_i64(local_tid_28146) -\n                                                            ",
                   "                  sext_i32_i64(skip_threads_28161)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_28162 =\n                                         slt64(srem64(sext_i32_i64(local_tid_28146 *\n                                                      32 + 32 - 1),\n                                                      num_subhistos_28056),\n                                               sext_i32_i64(local_tid_28146 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_28146 -\n                                                             skip_threads_28161) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_28162) {\n                                        x_28155 = x_28156;\n                                    }\n                                    if (!inactive_28162) {\n                                        int64_t res_28157 = smax64(x_28155,\n                                                                   x_28156);\n                                        \n                                        x_28155 = res_28157;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_28148, skip_threads_28161)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_28161, local_tid_28146 -\n                                      squot32(local_tid_28146, 32) * 32) &&\n                                (squot32(local_tid_28146, 32) == 0 &&\n                                 ltid_in_bounds_28158)) {\n                                // write result\n                                {\n                                  ",
                   "  ((volatile __local\n                                      int64_t *) red_arr_mem_28150)[sext_i32_i64(local_tid_28146)] =\n                                        x_28155;\n                                    x_28156 = x_28155;\n                                }\n                            }\n                            if (sle32(wave_sizze_28148, skip_threads_28161)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_28161 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_28146, 32) == 0 ||\n                          !ltid_in_bounds_28158)) {\n                        // read operands\n                        {\n                            x_25353 = x_25352;\n                            x_25352 = ((__local\n                                        int64_t *) red_arr_mem_28150)[sext_i32_i64(squot32(local_tid_28146,\n                                                                                           32)) -\n                                                                      1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_28163 =\n                                 slt64(srem64(sext_i32_i64(local_tid_28146),\n                                              num_subhistos_28056),\n                                       sext_i32_i64(local_tid_28146) -\n                                       sext_i32_i64(squot32(local_tid_28146,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_28163) {\n                                x_25352 = x_25353;\n                            }\n                            if (!inactive_28163) {\n           ",
                   "                     int64_t res_25354 = smax64(x_25352, x_25353);\n                                \n                                x_25352 = res_25354;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              int64_t *) red_arr_mem_28150)[sext_i32_i64(local_tid_28146)] =\n                                x_25352;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_28146, 32) == 0) {\n                        ((__local\n                          int64_t *) red_arr_mem_28150)[sext_i32_i64(local_tid_28146)] =\n                            x_25353;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_28154) *\n                      squot64(seghist_group_sizze_25346,\n                              segment_sizze_nonzzero_28143) +\n                      sext_i32_i64(local_tid_28146), res_23550) &&\n                slt64(sext_i32_i64(local_tid_28146),\n                      squot64(seghist_group_sizze_25346,\n                              segment_sizze_nonzzero_28143))) {\n                ((__global\n                  int64_t *) mem_27744)[sext_i32_i64(virt_group_id_28154) *\n                                        squot64(seghist_group_sizze_25346,\n                                                segment_sizze_nonzzero_28143) +\n                                        sext_i32_i64(local_tid_28146)] =\n                    ((__local\n                      int64_t *) red_arr_mem_28150)[(sext_i32_i64(local_tid_28146) +\n                                                     1) *\n                 ",
                   "                                   segment_sizze_nonzzero_28143 -\n                                                    1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_25346\n}\n__kernel void testzicopy_28473(int64_t paths_23826, int64_t steps_23827,\n                               __global unsigned char *mem_27770, __global\n                               unsigned char *mem_27775)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_28473;\n    int32_t copy_ltid_28474;\n    int32_t copy_gid_28475;\n    \n    copy_gtid_28473 = get_global_id(0);\n    copy_ltid_28474 = get_local_id(0);\n    copy_gid_28475 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_28473), steps_23827 * paths_23826 * 45)) {\n        ((__global float *) mem_27775)[squot64(sext_i32_i64(copy_gtid_28473),\n                                               paths_23826 * 45) * (45 *\n                                                                    paths_23826) +\n                                       squot64(sext_i32_i64(copy_gtid_28473) -\n                                               squot64(sext_i32_i64(copy_gtid_28473),\n                                                       paths_23826 * 45) *\n                                               (paths_23826 * 45), 45) * 45 +\n                                       (sext_i32_i64(copy_gtid_28473) -\n                                        squot64(sext_i32_i64(copy_gtid_28473),\n                                                paths_23826 * 45) *\n                                        (paths_23826 * 45) -\n                                        squot64(sext_i32_i64(copy_gtid_28473) -\n                                                squot64(sext_i32_i64(copy_gtid_28473),\n                                                        paths_23826 * 45) *\n                      ",
                   "                          (paths_23826 * 45), 45) * 45)] =\n            ((__global\n              float *) mem_27770)[squot64(sext_i32_i64(copy_gtid_28473) -\n                                          squot64(sext_i32_i64(copy_gtid_28473),\n                                                  paths_23826 * 45) *\n                                          (paths_23826 * 45), 45) * (45 *\n                                                                     steps_23827) +\n                                  squot64(sext_i32_i64(copy_gtid_28473),\n                                          paths_23826 * 45) * 45 +\n                                  (sext_i32_i64(copy_gtid_28473) -\n                                   squot64(sext_i32_i64(copy_gtid_28473),\n                                           paths_23826 * 45) * (paths_23826 *\n                                                                45) -\n                                   squot64(sext_i32_i64(copy_gtid_28473) -\n                                           squot64(sext_i32_i64(copy_gtid_28473),\n                                                   paths_23826 * 45) *\n                                           (paths_23826 * 45), 45) * 45)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void testzicopy_28510(int64_t paths_23826, int64_t steps_23827,\n                               __global unsigned char *mem_27770, __global\n                               unsigned char *mem_27786)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_28510;\n    int32_t copy_ltid_28511;\n    int32_t copy_gid_28512;\n    \n    copy_gtid_28510 = get_global_id(0);\n    copy_ltid_28511 = get_local_id(0);\n    copy_gid_28512 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_28510), steps_23827 * paths_23826 * 45)) {\n        ((__global float *) mem_27786)[squot64(sext_i32_i64(copy_gtid_28510),\n                                               paths_23826 * 45) * (45 *\n                               ",
                   "                                     paths_23826) +\n                                       squot64(sext_i32_i64(copy_gtid_28510) -\n                                               squot64(sext_i32_i64(copy_gtid_28510),\n                                                       paths_23826 * 45) *\n                                               (paths_23826 * 45), 45) * 45 +\n                                       (sext_i32_i64(copy_gtid_28510) -\n                                        squot64(sext_i32_i64(copy_gtid_28510),\n                                                paths_23826 * 45) *\n                                        (paths_23826 * 45) -\n                                        squot64(sext_i32_i64(copy_gtid_28510) -\n                                                squot64(sext_i32_i64(copy_gtid_28510),\n                                                        paths_23826 * 45) *\n                                                (paths_23826 * 45), 45) * 45)] =\n            ((__global\n              float *) mem_27770)[squot64(sext_i32_i64(copy_gtid_28510) -\n                                          squot64(sext_i32_i64(copy_gtid_28510),\n                                                  paths_23826 * 45) *\n                                          (paths_23826 * 45), 45) * (45 *\n                                                                     steps_23827) +\n                                  squot64(sext_i32_i64(copy_gtid_28510),\n                                          paths_23826 * 45) * 45 +\n                                  (sext_i32_i64(copy_gtid_28510) -\n                                   squot64(sext_i32_i64(copy_gtid_28510),\n                                           paths_23826 * 45) * (paths_23826 *\n                                                                45) -\n                                   squot64(sext_i32_i64(copy_gtid_28510) -\n                                           squot64(sext_i32_i64(copy_gtid_28510),\n                                  ",
                   "                 paths_23826 * 45) *\n                                           (paths_23826 * 45), 45) * 45)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void testziscan_stage1_26935(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_27974_backing_aligned_0,\n                                      int64_t steps_23827,\n                                      int64_t one_intra_par_min_26244, __global\n                                      unsigned char *res_mem_27662, __global\n                                      unsigned char *res_mem_27663,\n                                      int64_t binop_x_27692, __global\n                                      unsigned char *res_mem_27737, __global\n                                      unsigned char *mem_27740, __global\n                                      unsigned char *mem_27742,\n                                      int32_t num_threads_27968)\n{\n    #define segscan_group_sizze_26930 (testzisegscan_group_sizze_26929)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_27974_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_27974_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27969;\n    int32_t local_tid_27970;\n    int64_t group_sizze_27973;\n    int32_t wave_sizze_27972;\n    int32_t group_tid_27971;\n    \n    global_tid_27969 = get_global_id(0);\n    local_tid_27970 = get_local_id(0);\n    group_sizze_27973 = get_local_size(0);\n    wave_sizze_27972 = LOCKSTEP_WIDTH;\n    group_tid_27971 = get_group_id(0);\n    \n    int32_t phys_tid_26935;\n    \n    phys_tid_26935 = global_tid_27969;\n    \n    __local char *scan_arr_mem_27974;\n    \n    scan_arr_mem_27974 = (__local char *) scan_arr_mem_27974_backing_0;\n    \n    int64_t x_23999;\n    int64_t x_24000;\n   ",
                   " \n    x_23999 = 0;\n    for (int64_t j_27976 = 0; j_27976 < sdiv_up64(binop_x_27692,\n                                                  sext_i32_i64(num_threads_27968));\n         j_27976++) {\n        int64_t chunk_offset_27977 = segscan_group_sizze_26930 * j_27976 +\n                sext_i32_i64(group_tid_27971) * (segscan_group_sizze_26930 *\n                                                 sdiv_up64(binop_x_27692,\n                                                           sext_i32_i64(num_threads_27968)));\n        int64_t flat_idx_27978 = chunk_offset_27977 +\n                sext_i32_i64(local_tid_27970);\n        int64_t gtid_26934 = flat_idx_27978;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_26934, binop_x_27692)) {\n                int64_t binop_x_27491 = squot64(gtid_26934,\n                                                one_intra_par_min_26244);\n                int64_t binop_y_27493 = one_intra_par_min_26244 * binop_x_27491;\n                int64_t binop_x_27494 = gtid_26934 - binop_y_27493;\n                int64_t binop_x_27500 = squot64(binop_x_27494, 45);\n                int64_t binop_y_27501 = 45 * binop_x_27500;\n                int64_t new_index_27502 = binop_x_27494 - binop_y_27501;\n                int64_t x_24002 = ((__global\n                                    int64_t *) res_mem_27662)[new_index_27502];\n                float x_24003 = ((__global\n                                  float *) res_mem_27663)[new_index_27502];\n                float x_24004 = ((__global\n                                  float *) res_mem_27737)[binop_x_27491 * (45 *\n                                                                           steps_23827) +\n                                                          binop_x_27500 * 45 +\n                                                          new_index_27502];\n                float x_24005 = x_24004 / x_24003;\n                float ceil_arg_24006 = x_24005 - 1.0F;\n                float res_24007",
                   ";\n                \n                res_24007 = futrts_ceil32(ceil_arg_24006);\n                \n                int64_t res_24008 = fptosi_f32_i64(res_24007);\n                int64_t max_arg_24009 = sub64(x_24002, res_24008);\n                int64_t res_24010 = smax64(0, max_arg_24009);\n                bool cond_24011 = res_24010 == 0;\n                int64_t res_24012;\n                \n                if (cond_24011) {\n                    res_24012 = 1;\n                } else {\n                    res_24012 = res_24010;\n                }\n                // write to-scan values to parameters\n                {\n                    x_24000 = res_24012;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global int64_t *) mem_27742)[gtid_26934] = res_24012;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_26934, binop_x_27692)) {\n                    x_24000 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_24001 = add64(x_23999, x_24000);\n                \n                ((__local\n                  int64_t *) scan_arr_mem_27974)[sext_i32_i64(local_tid_27970)] =\n                    res_24001;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_27979;\n            int64_t x_27980;\n            int64_t x_27982;\n            int64_t x_27983;\n            bool ltid_in_bounds_27985;\n            \n            ltid_in_bounds_27985 = slt64(sext_i32_i64(local_tid_27970),\n                                         segscan_group_sizze_26930);\n            \n            int32_t skip_threads_27986;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_27985) {\n               ",
                   "     x_27980 = ((volatile __local\n                                int64_t *) scan_arr_mem_27974)[sext_i32_i64(local_tid_27970)];\n                    if ((local_tid_27970 - squot32(local_tid_27970, 32) * 32) ==\n                        0) {\n                        x_27979 = x_27980;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_27986 = 1;\n                while (slt32(skip_threads_27986, 32)) {\n                    if (sle32(skip_threads_27986, local_tid_27970 -\n                              squot32(local_tid_27970, 32) * 32) &&\n                        ltid_in_bounds_27985) {\n                        // read operands\n                        {\n                            x_27979 = ((volatile __local\n                                        int64_t *) scan_arr_mem_27974)[sext_i32_i64(local_tid_27970) -\n                                                                       sext_i32_i64(skip_threads_27986)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_27981 = add64(x_27979, x_27980);\n                            \n                            x_27979 = res_27981;\n                        }\n                    }\n                    if (sle32(wave_sizze_27972, skip_threads_27986)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_27986, local_tid_27970 -\n                              squot32(local_tid_27970, 32) * 32) &&\n                        ltid_in_bounds_27985) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_27974)[sext_i32_i64(local_tid_27970)] =\n                                x_27979;\n                            x_27980 = x_27979;\n                        }\n                    }\n       ",
                   "             if (sle32(wave_sizze_27972, skip_threads_27986)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_27986 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_27970 - squot32(local_tid_27970, 32) * 32) ==\n                    31 && ltid_in_bounds_27985) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_27974)[sext_i32_i64(squot32(local_tid_27970,\n                                                                          32))] =\n                        x_27979;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_27987;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_27970, 32) == 0 &&\n                        ltid_in_bounds_27985) {\n                        x_27983 = ((volatile __local\n                                    int64_t *) scan_arr_mem_27974)[sext_i32_i64(local_tid_27970)];\n                        if ((local_tid_27970 - squot32(local_tid_27970, 32) *\n                             32) == 0) {\n                            x_27982 = x_27983;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_27987 = 1;\n                    while (slt32(skip_threads_27987, 32)) {\n                        if (sle32(skip_threads_27987, local_tid_27970 -\n                                  squot32(local_tid_27970, 32) * 32) &&\n                            (squot32(local_tid_27970, 32) == 0 &&\n                             ltid_in_bounds_27985)) {\n                            // ",
                   "read operands\n                            {\n                                x_27982 = ((volatile __local\n                                            int64_t *) scan_arr_mem_27974)[sext_i32_i64(local_tid_27970) -\n                                                                           sext_i32_i64(skip_threads_27987)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_27984 = add64(x_27982, x_27983);\n                                \n                                x_27982 = res_27984;\n                            }\n                        }\n                        if (sle32(wave_sizze_27972, skip_threads_27987)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_27987, local_tid_27970 -\n                                  squot32(local_tid_27970, 32) * 32) &&\n                            (squot32(local_tid_27970, 32) == 0 &&\n                             ltid_in_bounds_27985)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_27974)[sext_i32_i64(local_tid_27970)] =\n                                    x_27982;\n                                x_27983 = x_27982;\n                            }\n                        }\n                        if (sle32(wave_sizze_27972, skip_threads_27987)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_27987 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_27970, 32) == 0 ||\n                      !ltid_in_bounds_27985)) {\n                    // read operands\n                    {\n           ",
                   "             x_27980 = x_27979;\n                        x_27979 = ((__local\n                                    int64_t *) scan_arr_mem_27974)[sext_i32_i64(squot32(local_tid_27970,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_27981 = add64(x_27979, x_27980);\n                        \n                        x_27979 = res_27981;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_27974)[sext_i32_i64(local_tid_27970)] =\n                            x_27979;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_27970, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_27974)[sext_i32_i64(local_tid_27970)] =\n                        x_27980;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_26934, binop_x_27692)) {\n                    ((__global int64_t *) mem_27740)[gtid_26934] = ((__local\n                                                                     int64_t *) scan_arr_mem_27974)[sext_i32_i64(local_tid_27970)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_27988 = 0;\n                bool should_load_carry_27989 = local_tid_27970 == 0 &&\n                     !crosses_segment_27988;\n                \n                if (should_load_carry_27989) {\n      ",
                   "              x_23999 = ((__local\n                                int64_t *) scan_arr_mem_27974)[segscan_group_sizze_26930 -\n                                                               1];\n                }\n                if (!should_load_carry_27989) {\n                    x_23999 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_26930\n}\n__kernel void testziscan_stage1_26968(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28215_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28213_backing_aligned_1,\n                                      int64_t res_24015, __global\n                                      unsigned char *mem_27747, __global\n                                      unsigned char *mem_27751, __global\n                                      unsigned char *mem_27753,\n                                      int32_t num_threads_28207)\n{\n    #define segscan_group_sizze_26963 (testzisegscan_group_sizze_26962)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28215_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28215_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28213_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28213_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28208;\n    int32_t local_tid_28209;\n    int64_t group_sizze_28212;\n    int32_t wave_sizze_28211;\n    int32_t group_tid_28210;\n    \n    global_tid_28208 = get_global_id(0);\n    local_tid_28209 = get_local_id(0);\n    group_sizze_28212 = get_local_si",
                   "ze(0);\n    wave_sizze_28211 = LOCKSTEP_WIDTH;\n    group_tid_28210 = get_group_id(0);\n    \n    int32_t phys_tid_26968;\n    \n    phys_tid_26968 = global_tid_28208;\n    \n    __local char *scan_arr_mem_28213;\n    __local char *scan_arr_mem_28215;\n    \n    scan_arr_mem_28213 = (__local char *) scan_arr_mem_28213_backing_0;\n    scan_arr_mem_28215 = (__local char *) scan_arr_mem_28215_backing_1;\n    \n    bool x_24034;\n    int64_t x_24035;\n    bool x_24036;\n    int64_t x_24037;\n    \n    x_24034 = 0;\n    x_24035 = 0;\n    for (int64_t j_28217 = 0; j_28217 < sdiv_up64(res_24015,\n                                                  sext_i32_i64(num_threads_28207));\n         j_28217++) {\n        int64_t chunk_offset_28218 = segscan_group_sizze_26963 * j_28217 +\n                sext_i32_i64(group_tid_28210) * (segscan_group_sizze_26963 *\n                                                 sdiv_up64(res_24015,\n                                                           sext_i32_i64(num_threads_28207)));\n        int64_t flat_idx_28219 = chunk_offset_28218 +\n                sext_i32_i64(local_tid_28209);\n        int64_t gtid_26967 = flat_idx_28219;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_26967, res_24015)) {\n                int64_t x_24041 = ((__global int64_t *) mem_27747)[gtid_26967];\n                bool res_24042 = slt64(0, x_24041);\n                \n                // write to-scan values to parameters\n                {\n                    x_24036 = res_24042;\n                    x_24037 = x_24041;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_26967, res_24015)) {\n                    x_24036 = 0;\n                    x_24037 = 0;\n                }\n            }\n            // combine ",
                   "with carry and write to local memory\n            {\n                bool res_24038 = x_24034 || x_24036;\n                int64_t res_24039;\n                \n                if (x_24036) {\n                    res_24039 = x_24037;\n                } else {\n                    int64_t res_24040 = add64(x_24035, x_24037);\n                    \n                    res_24039 = res_24040;\n                }\n                ((__local\n                  bool *) scan_arr_mem_28213)[sext_i32_i64(local_tid_28209)] =\n                    res_24038;\n                ((__local\n                  int64_t *) scan_arr_mem_28215)[sext_i32_i64(local_tid_28209)] =\n                    res_24039;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28220;\n            int64_t x_28221;\n            bool x_28222;\n            int64_t x_28223;\n            bool x_28227;\n            int64_t x_28228;\n            bool x_28229;\n            int64_t x_28230;\n            bool ltid_in_bounds_28234;\n            \n            ltid_in_bounds_28234 = slt64(sext_i32_i64(local_tid_28209),\n                                         segscan_group_sizze_26963);\n            \n            int32_t skip_threads_28235;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28234) {\n                    x_28222 = ((volatile __local\n                                bool *) scan_arr_mem_28213)[sext_i32_i64(local_tid_28209)];\n                    x_28223 = ((volatile __local\n                                int64_t *) scan_arr_mem_28215)[sext_i32_i64(local_tid_28209)];\n                    if ((local_tid_28209 - squot32(local_tid_28209, 32) * 32) ==\n                        0) {\n                        x_28220 = x_28222;\n                        x_28221 = x_28223;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28235 = 1;\n                while (slt",
                   "32(skip_threads_28235, 32)) {\n                    if (sle32(skip_threads_28235, local_tid_28209 -\n                              squot32(local_tid_28209, 32) * 32) &&\n                        ltid_in_bounds_28234) {\n                        // read operands\n                        {\n                            x_28220 = ((volatile __local\n                                        bool *) scan_arr_mem_28213)[sext_i32_i64(local_tid_28209) -\n                                                                    sext_i32_i64(skip_threads_28235)];\n                            x_28221 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28215)[sext_i32_i64(local_tid_28209) -\n                                                                       sext_i32_i64(skip_threads_28235)];\n                        }\n                        // perform operation\n                        {\n                            bool res_28224 = x_28220 || x_28222;\n                            int64_t res_28225;\n                            \n                            if (x_28222) {\n                                res_28225 = x_28223;\n                            } else {\n                                int64_t res_28226 = add64(x_28221, x_28223);\n                                \n                                res_28225 = res_28226;\n                            }\n                            x_28220 = res_28224;\n                            x_28221 = res_28225;\n                        }\n                    }\n                    if (sle32(wave_sizze_28211, skip_threads_28235)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28235, local_tid_28209 -\n                              squot32(local_tid_28209, 32) * 32) &&\n                        ltid_in_bounds_28234) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *)",
                   " scan_arr_mem_28213)[sext_i32_i64(local_tid_28209)] =\n                                x_28220;\n                            x_28222 = x_28220;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28215)[sext_i32_i64(local_tid_28209)] =\n                                x_28221;\n                            x_28223 = x_28221;\n                        }\n                    }\n                    if (sle32(wave_sizze_28211, skip_threads_28235)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28235 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28209 - squot32(local_tid_28209, 32) * 32) ==\n                    31 && ltid_in_bounds_28234) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28213)[sext_i32_i64(squot32(local_tid_28209,\n                                                                       32))] =\n                        x_28220;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28215)[sext_i32_i64(squot32(local_tid_28209,\n                                                                          32))] =\n                        x_28221;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28236;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28209, 32) == 0 &&\n                        ltid_in_bounds_28234) {\n                        x_28229 = ((volatile __local\n                                    bool *) scan_arr_mem_28213)[sext_i32_i64(local_tid_28209)];\n                        x_28230 = ((volatile __loca",
                   "l\n                                    int64_t *) scan_arr_mem_28215)[sext_i32_i64(local_tid_28209)];\n                        if ((local_tid_28209 - squot32(local_tid_28209, 32) *\n                             32) == 0) {\n                            x_28227 = x_28229;\n                            x_28228 = x_28230;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28236 = 1;\n                    while (slt32(skip_threads_28236, 32)) {\n                        if (sle32(skip_threads_28236, local_tid_28209 -\n                                  squot32(local_tid_28209, 32) * 32) &&\n                            (squot32(local_tid_28209, 32) == 0 &&\n                             ltid_in_bounds_28234)) {\n                            // read operands\n                            {\n                                x_28227 = ((volatile __local\n                                            bool *) scan_arr_mem_28213)[sext_i32_i64(local_tid_28209) -\n                                                                        sext_i32_i64(skip_threads_28236)];\n                                x_28228 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28215)[sext_i32_i64(local_tid_28209) -\n                                                                           sext_i32_i64(skip_threads_28236)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28231 = x_28227 || x_28229;\n                                int64_t res_28232;\n                                \n                                if (x_28229) {\n                                    res_28232 = x_28230;\n                                } else {\n                                    int64_t res_28233 = add64(x_28228, x_28230);\n                                    \n                    ",
                   "                res_28232 = res_28233;\n                                }\n                                x_28227 = res_28231;\n                                x_28228 = res_28232;\n                            }\n                        }\n                        if (sle32(wave_sizze_28211, skip_threads_28236)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28236, local_tid_28209 -\n                                  squot32(local_tid_28209, 32) * 32) &&\n                            (squot32(local_tid_28209, 32) == 0 &&\n                             ltid_in_bounds_28234)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_28213)[sext_i32_i64(local_tid_28209)] =\n                                    x_28227;\n                                x_28229 = x_28227;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28215)[sext_i32_i64(local_tid_28209)] =\n                                    x_28228;\n                                x_28230 = x_28228;\n                            }\n                        }\n                        if (sle32(wave_sizze_28211, skip_threads_28236)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28236 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28209, 32) == 0 ||\n                      !ltid_in_bounds_28234)) {\n                    // read operands\n                    {\n                        x_28222 = x_28220;\n                        x_28223 = x_28221;\n                        x_28220 = ((__local\n                                    bool *) scan_arr_m",
                   "em_28213)[sext_i32_i64(squot32(local_tid_28209,\n                                                                                     32)) -\n                                                                1];\n                        x_28221 = ((__local\n                                    int64_t *) scan_arr_mem_28215)[sext_i32_i64(squot32(local_tid_28209,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        bool res_28224 = x_28220 || x_28222;\n                        int64_t res_28225;\n                        \n                        if (x_28222) {\n                            res_28225 = x_28223;\n                        } else {\n                            int64_t res_28226 = add64(x_28221, x_28223);\n                            \n                            res_28225 = res_28226;\n                        }\n                        x_28220 = res_28224;\n                        x_28221 = res_28225;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28213)[sext_i32_i64(local_tid_28209)] =\n                            x_28220;\n                        ((__local\n                          int64_t *) scan_arr_mem_28215)[sext_i32_i64(local_tid_28209)] =\n                            x_28221;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28209, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_28213)[sext_i32_i64(local_tid_28209)] =\n                        x_28222;\n                    ((__local\n                      int64_t *) scan_arr_mem_28215)[sext_i32_i64(local",
                   "_tid_28209)] =\n                        x_28223;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_26967, res_24015)) {\n                    ((__global bool *) mem_27751)[gtid_26967] = ((__local\n                                                                  bool *) scan_arr_mem_28213)[sext_i32_i64(local_tid_28209)];\n                    ((__global int64_t *) mem_27753)[gtid_26967] = ((__local\n                                                                     int64_t *) scan_arr_mem_28215)[sext_i32_i64(local_tid_28209)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28237 = 0;\n                bool should_load_carry_28238 = local_tid_28209 == 0 &&\n                     !crosses_segment_28237;\n                \n                if (should_load_carry_28238) {\n                    x_24034 = ((__local\n                                bool *) scan_arr_mem_28213)[segscan_group_sizze_26963 -\n                                                            1];\n                    x_24035 = ((__local\n                                int64_t *) scan_arr_mem_28215)[segscan_group_sizze_26963 -\n                                                               1];\n                }\n                if (!should_load_carry_28238) {\n                    x_24034 = 0;\n                    x_24035 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_26963\n}\n__kernel void testziscan_stage1_26976(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28282_backing_aligned_0,\n                                      __local volatile\n        ",
                   "                              int64_t *scan_arr_mem_28280_backing_aligned_1,\n                                      int64_t res_24015, __global\n                                      unsigned char *mem_27753, __global\n                                      unsigned char *mem_27756, __global\n                                      unsigned char *mem_27758, __global\n                                      unsigned char *mem_27760,\n                                      int32_t num_threads_28274)\n{\n    #define segscan_group_sizze_26971 (testzisegscan_group_sizze_26970)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28282_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28282_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28280_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28280_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28275;\n    int32_t local_tid_28276;\n    int64_t group_sizze_28279;\n    int32_t wave_sizze_28278;\n    int32_t group_tid_28277;\n    \n    global_tid_28275 = get_global_id(0);\n    local_tid_28276 = get_local_id(0);\n    group_sizze_28279 = get_local_size(0);\n    wave_sizze_28278 = LOCKSTEP_WIDTH;\n    group_tid_28277 = get_group_id(0);\n    \n    int32_t phys_tid_26976;\n    \n    phys_tid_26976 = global_tid_28275;\n    \n    __local char *scan_arr_mem_28280;\n    __local char *scan_arr_mem_28282;\n    \n    scan_arr_mem_28280 = (__local char *) scan_arr_mem_28280_backing_0;\n    scan_arr_mem_28282 = (__local char *) scan_arr_mem_28282_backing_1;\n    \n    bool x_24074;\n    int64_t x_24075;\n    bool x_24076;\n    int64_t x_24077;\n    \n    x_24074 = 0;\n    x_24075 = 0;\n    for (int64_t j_28284 = 0; j_28284 < sdiv_up64(res_24015,\n                                                  sext_i32_i64(num_thre",
                   "ads_28274));\n         j_28284++) {\n        int64_t chunk_offset_28285 = segscan_group_sizze_26971 * j_28284 +\n                sext_i32_i64(group_tid_28277) * (segscan_group_sizze_26971 *\n                                                 sdiv_up64(res_24015,\n                                                           sext_i32_i64(num_threads_28274)));\n        int64_t flat_idx_28286 = chunk_offset_28285 +\n                sext_i32_i64(local_tid_28276);\n        int64_t gtid_26975 = flat_idx_28286;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_26975, res_24015)) {\n                int64_t x_24081 = ((__global int64_t *) mem_27753)[gtid_26975];\n                int64_t i_p_o_27551 = add64(-1, gtid_26975);\n                int64_t rot_i_27552 = smod64(i_p_o_27551, res_24015);\n                int64_t x_24082 = ((__global int64_t *) mem_27753)[rot_i_27552];\n                bool res_24084 = x_24081 == x_24082;\n                bool res_24085 = !res_24084;\n                \n                // write to-scan values to parameters\n                {\n                    x_24076 = res_24085;\n                    x_24077 = 1;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global bool *) mem_27760)[gtid_26975] = res_24085;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_26975, res_24015)) {\n                    x_24076 = 0;\n                    x_24077 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_24078 = x_24074 || x_24076;\n                int64_t res_24079;\n                \n                if (x_24076) {\n                    res_24079 = x_24077;\n                } else {\n                    int64_t res_24080 = add64(x_24",
                   "075, x_24077);\n                    \n                    res_24079 = res_24080;\n                }\n                ((__local\n                  bool *) scan_arr_mem_28280)[sext_i32_i64(local_tid_28276)] =\n                    res_24078;\n                ((__local\n                  int64_t *) scan_arr_mem_28282)[sext_i32_i64(local_tid_28276)] =\n                    res_24079;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28287;\n            int64_t x_28288;\n            bool x_28289;\n            int64_t x_28290;\n            bool x_28294;\n            int64_t x_28295;\n            bool x_28296;\n            int64_t x_28297;\n            bool ltid_in_bounds_28301;\n            \n            ltid_in_bounds_28301 = slt64(sext_i32_i64(local_tid_28276),\n                                         segscan_group_sizze_26971);\n            \n            int32_t skip_threads_28302;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28301) {\n                    x_28289 = ((volatile __local\n                                bool *) scan_arr_mem_28280)[sext_i32_i64(local_tid_28276)];\n                    x_28290 = ((volatile __local\n                                int64_t *) scan_arr_mem_28282)[sext_i32_i64(local_tid_28276)];\n                    if ((local_tid_28276 - squot32(local_tid_28276, 32) * 32) ==\n                        0) {\n                        x_28287 = x_28289;\n                        x_28288 = x_28290;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28302 = 1;\n                while (slt32(skip_threads_28302, 32)) {\n                    if (sle32(skip_threads_28302, local_tid_28276 -\n                              squot32(local_tid_28276, 32) * 32) &&\n                        ltid_in_bounds_28301) {\n                        // read operands\n                        {\n                      ",
                   "      x_28287 = ((volatile __local\n                                        bool *) scan_arr_mem_28280)[sext_i32_i64(local_tid_28276) -\n                                                                    sext_i32_i64(skip_threads_28302)];\n                            x_28288 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28282)[sext_i32_i64(local_tid_28276) -\n                                                                       sext_i32_i64(skip_threads_28302)];\n                        }\n                        // perform operation\n                        {\n                            bool res_28291 = x_28287 || x_28289;\n                            int64_t res_28292;\n                            \n                            if (x_28289) {\n                                res_28292 = x_28290;\n                            } else {\n                                int64_t res_28293 = add64(x_28288, x_28290);\n                                \n                                res_28292 = res_28293;\n                            }\n                            x_28287 = res_28291;\n                            x_28288 = res_28292;\n                        }\n                    }\n                    if (sle32(wave_sizze_28278, skip_threads_28302)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28302, local_tid_28276 -\n                              squot32(local_tid_28276, 32) * 32) &&\n                        ltid_in_bounds_28301) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_28280)[sext_i32_i64(local_tid_28276)] =\n                                x_28287;\n                            x_28289 = x_28287;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28282)[sext_i32_i64(local_tid_28276)] =\n                    ",
                   "            x_28288;\n                            x_28290 = x_28288;\n                        }\n                    }\n                    if (sle32(wave_sizze_28278, skip_threads_28302)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28302 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28276 - squot32(local_tid_28276, 32) * 32) ==\n                    31 && ltid_in_bounds_28301) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28280)[sext_i32_i64(squot32(local_tid_28276,\n                                                                       32))] =\n                        x_28287;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28282)[sext_i32_i64(squot32(local_tid_28276,\n                                                                          32))] =\n                        x_28288;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28303;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28276, 32) == 0 &&\n                        ltid_in_bounds_28301) {\n                        x_28296 = ((volatile __local\n                                    bool *) scan_arr_mem_28280)[sext_i32_i64(local_tid_28276)];\n                        x_28297 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28282)[sext_i32_i64(local_tid_28276)];\n                        if ((local_tid_28276 - squot32(local_tid_28276, 32) *\n                             32) == 0) {\n                            x_28294 = x_28296;\n                            x_28295 ",
                   "= x_28297;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28303 = 1;\n                    while (slt32(skip_threads_28303, 32)) {\n                        if (sle32(skip_threads_28303, local_tid_28276 -\n                                  squot32(local_tid_28276, 32) * 32) &&\n                            (squot32(local_tid_28276, 32) == 0 &&\n                             ltid_in_bounds_28301)) {\n                            // read operands\n                            {\n                                x_28294 = ((volatile __local\n                                            bool *) scan_arr_mem_28280)[sext_i32_i64(local_tid_28276) -\n                                                                        sext_i32_i64(skip_threads_28303)];\n                                x_28295 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28282)[sext_i32_i64(local_tid_28276) -\n                                                                           sext_i32_i64(skip_threads_28303)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28298 = x_28294 || x_28296;\n                                int64_t res_28299;\n                                \n                                if (x_28296) {\n                                    res_28299 = x_28297;\n                                } else {\n                                    int64_t res_28300 = add64(x_28295, x_28297);\n                                    \n                                    res_28299 = res_28300;\n                                }\n                                x_28294 = res_28298;\n                                x_28295 = res_28299;\n                            }\n                        }\n                        if (sle32(wave_sizze_28278, skip_threads_283",
                   "03)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28303, local_tid_28276 -\n                                  squot32(local_tid_28276, 32) * 32) &&\n                            (squot32(local_tid_28276, 32) == 0 &&\n                             ltid_in_bounds_28301)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_28280)[sext_i32_i64(local_tid_28276)] =\n                                    x_28294;\n                                x_28296 = x_28294;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28282)[sext_i32_i64(local_tid_28276)] =\n                                    x_28295;\n                                x_28297 = x_28295;\n                            }\n                        }\n                        if (sle32(wave_sizze_28278, skip_threads_28303)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28303 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28276, 32) == 0 ||\n                      !ltid_in_bounds_28301)) {\n                    // read operands\n                    {\n                        x_28289 = x_28287;\n                        x_28290 = x_28288;\n                        x_28287 = ((__local\n                                    bool *) scan_arr_mem_28280)[sext_i32_i64(squot32(local_tid_28276,\n                                                                                     32)) -\n                                                                1];\n                        x_28288 = ((__local\n                                    int64_t *) scan",
                   "_arr_mem_28282)[sext_i32_i64(squot32(local_tid_28276,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        bool res_28291 = x_28287 || x_28289;\n                        int64_t res_28292;\n                        \n                        if (x_28289) {\n                            res_28292 = x_28290;\n                        } else {\n                            int64_t res_28293 = add64(x_28288, x_28290);\n                            \n                            res_28292 = res_28293;\n                        }\n                        x_28287 = res_28291;\n                        x_28288 = res_28292;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28280)[sext_i32_i64(local_tid_28276)] =\n                            x_28287;\n                        ((__local\n                          int64_t *) scan_arr_mem_28282)[sext_i32_i64(local_tid_28276)] =\n                            x_28288;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28276, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_28280)[sext_i32_i64(local_tid_28276)] =\n                        x_28289;\n                    ((__local\n                      int64_t *) scan_arr_mem_28282)[sext_i32_i64(local_tid_28276)] =\n                        x_28290;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_26975, res_24015)) {\n                    ((__global bool *) mem_27756)[gtid_2",
                   "6975] = ((__local\n                                                                  bool *) scan_arr_mem_28280)[sext_i32_i64(local_tid_28276)];\n                    ((__global int64_t *) mem_27758)[gtid_26975] = ((__local\n                                                                     int64_t *) scan_arr_mem_28282)[sext_i32_i64(local_tid_28276)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28304 = 0;\n                bool should_load_carry_28305 = local_tid_28276 == 0 &&\n                     !crosses_segment_28304;\n                \n                if (should_load_carry_28305) {\n                    x_24074 = ((__local\n                                bool *) scan_arr_mem_28280)[segscan_group_sizze_26971 -\n                                                            1];\n                    x_24075 = ((__local\n                                int64_t *) scan_arr_mem_28282)[segscan_group_sizze_26971 -\n                                                               1];\n                }\n                if (!should_load_carry_28305) {\n                    x_24074 = 0;\n                    x_24075 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_26971\n}\n__kernel void testziscan_stage1_26984(__global int *global_failure,\n                                      int failure_is_an_option, __global\n                                      int64_t *global_failure_args,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28349_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28347_backing_aligned_1,\n                                      int64_t steps_23827, int64_t res_24015,\n       ",
                   "                               int64_t one_intra_par_min_26244, __global\n                                      unsigned char *res_mem_27660, __global\n                                      unsigned char *res_mem_27661, __global\n                                      unsigned char *res_mem_27662, __global\n                                      unsigned char *res_mem_27663,\n                                      int64_t binop_x_27692, __global\n                                      unsigned char *res_mem_27736, __global\n                                      unsigned char *res_mem_27737, __global\n                                      unsigned char *mem_27753, __global\n                                      unsigned char *mem_27758, __global\n                                      unsigned char *mem_27760, __global\n                                      unsigned char *mem_27763, __global\n                                      unsigned char *mem_27765,\n                                      int32_t num_threads_28341)\n{\n    #define segscan_group_sizze_26979 (testzisegscan_group_sizze_26978)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28349_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28349_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28347_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28347_backing_aligned_1;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_28342;\n    int32_t local_tid_28343;\n    int64_t group_sizze_28346;\n    int32_t wave_sizze_28345;\n    int32_t group_tid_28344;\n    \n    global_tid_28342 = get_global_id(0);\n    local",
                   "_tid_28343 = get_local_id(0);\n    group_sizze_28346 = get_local_size(0);\n    wave_sizze_28345 = LOCKSTEP_WIDTH;\n    group_tid_28344 = get_group_id(0);\n    \n    int32_t phys_tid_26984;\n    \n    phys_tid_26984 = global_tid_28342;\n    \n    __local char *scan_arr_mem_28347;\n    __local char *scan_arr_mem_28349;\n    \n    scan_arr_mem_28347 = (__local char *) scan_arr_mem_28347_backing_0;\n    scan_arr_mem_28349 = (__local char *) scan_arr_mem_28349_backing_1;\n    \n    bool x_24100;\n    float x_24101;\n    bool x_24102;\n    float x_24103;\n    \n    x_24100 = 0;\n    x_24101 = 0.0F;\n    for (int64_t j_28351 = 0; j_28351 < sdiv_up64(res_24015,\n                                                  sext_i32_i64(num_threads_28341));\n         j_28351++) {\n        int64_t chunk_offset_28352 = segscan_group_sizze_26979 * j_28351 +\n                sext_i32_i64(group_tid_28344) * (segscan_group_sizze_26979 *\n                                                 sdiv_up64(res_24015,\n                                                           sext_i32_i64(num_threads_28341)));\n        int64_t flat_idx_28353 = chunk_offset_28352 +\n                sext_i32_i64(local_tid_28343);\n        int64_t gtid_26983 = flat_idx_28353;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_26983, res_24015)) {\n                int64_t x_24108 = ((__global int64_t *) mem_27758)[gtid_26983];\n                int64_t x_24109 = ((__global int64_t *) mem_27753)[gtid_26983];\n                bool x_24110 = ((__global bool *) mem_27760)[gtid_26983];\n                int64_t res_24113 = sub64(x_24108, 1);\n                bool x_24114 = sle64(0, x_24109);\n                bool y_24115 = slt64(x_24109, binop_x_27692);\n                bool bounds_check_24116 = x_24114 && y_24115;\n                bool index_certs_24117;\n                \n                if (!bounds_check_24116) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 17) ==\n                   ",
                   "         -1) {\n                            global_failure_args[0] = x_24109;\n                            global_failure_args[1] = binop_x_27692;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t new_index_24118 = squot64(x_24109,\n                                                  one_intra_par_min_26244);\n                int64_t binop_y_24119 = new_index_24118 *\n                        one_intra_par_min_26244;\n                int64_t binop_x_24120 = x_24109 - binop_y_24119;\n                int64_t new_index_24121 = squot64(binop_x_24120, 45);\n                int64_t binop_y_24122 = 45 * new_index_24121;\n                int64_t new_index_24123 = binop_x_24120 - binop_y_24122;\n                int64_t lifted_0_get_arg_24127 = ((__global\n                                                   int64_t *) res_mem_27662)[new_index_24123];\n                float lifted_0_get_arg_24128 = ((__global\n                                                 float *) res_mem_27663)[new_index_24123];\n                float lifted_0_get_arg_24129 = ((__global\n                                                 float *) res_mem_27737)[new_index_24118 *\n                                                                         (45 *\n                                                                          steps_23827) +\n                                                                         new_index_24121 *\n                                                                         45 +\n                                                                         new_index_24123];\n                float x_24130 = lifted_0_get_arg_24129 / lifted_0_get_arg_24128;\n                float ceil_arg_24131 = x_24130 - 1.0F;\n                float res_24132;\n                \n                res_24132 = futrts_ceil32(ceil_arg_24131);\n                \n   ",
                   "             int64_t res_24133 = fptosi_f32_i64(res_24132);\n                int64_t max_arg_24134 = sub64(lifted_0_get_arg_24127,\n                                              res_24133);\n                int64_t res_24135 = smax64(0, max_arg_24134);\n                bool cond_24136 = res_24135 == 0;\n                float res_24137;\n                \n                if (cond_24136) {\n                    res_24137 = 0.0F;\n                } else {\n                    float lifted_0_get_arg_24124 = ((__global\n                                                     float *) res_mem_27736)[new_index_24118 *\n                                                                             (45 *\n                                                                              steps_23827) +\n                                                                             new_index_24121 *\n                                                                             45 +\n                                                                             new_index_24123];\n                    float lifted_0_get_arg_24125 = ((__global\n                                                     float *) res_mem_27660)[new_index_24123];\n                    float lifted_0_get_arg_24126 = ((__global\n                                                     float *) res_mem_27661)[new_index_24123];\n                    float res_24138;\n                    \n                    res_24138 = futrts_ceil32(x_24130);\n                    \n                    float start_24139 = lifted_0_get_arg_24128 * res_24138;\n                    float res_24140;\n                    \n                    res_24140 = futrts_ceil32(ceil_arg_24131);\n                    \n                    int64_t res_24141 = fptosi_f32_i64(res_24140);\n                    int64_t max_arg_24142 = sub64(lifted_0_get_arg_24127,\n                                                  res_24141);\n                    int64_t res_24143 = smax64(0, max_arg_24142);\n            ",
                   "        int64_t sizze_24144 = sub64(res_24143, 1);\n                    bool cond_24145 = res_24113 == 0;\n                    float res_24146;\n                    \n                    if (cond_24145) {\n                        res_24146 = 1.0F;\n                    } else {\n                        res_24146 = 0.0F;\n                    }\n                    \n                    bool cond_24147 = slt64(0, res_24113);\n                    float res_24148;\n                    \n                    if (cond_24147) {\n                        float y_24149 = lifted_0_get_arg_24125 *\n                              lifted_0_get_arg_24128;\n                        float res_24150 = res_24146 - y_24149;\n                        \n                        res_24148 = res_24150;\n                    } else {\n                        res_24148 = res_24146;\n                    }\n                    \n                    bool cond_24151 = res_24113 == sizze_24144;\n                    float res_24152;\n                    \n                    if (cond_24151) {\n                        float res_24153 = res_24148 - 1.0F;\n                        \n                        res_24152 = res_24153;\n                    } else {\n                        res_24152 = res_24148;\n                    }\n                    \n                    float res_24154 = lifted_0_get_arg_24126 * res_24152;\n                    float res_24155 = sitofp_i64_f32(res_24113);\n                    float y_24156 = lifted_0_get_arg_24128 * res_24155;\n                    float bondprice_arg_24157 = start_24139 + y_24156;\n                    float y_24158 = bondprice_arg_24157 -\n                          lifted_0_get_arg_24129;\n                    float negate_arg_24159 = 1.0e-2F * y_24158;\n                    float exp_arg_24160 = 0.0F - negate_arg_24159;\n                    float res_24161 = fpow32(2.7182817F, exp_arg_24160);\n                    float x_24162 = 1.0F - res_24161;\n                    float B_24163 = x_24162 / 1.0e-2F;\n ",
                   "                   float x_24164 = B_24163 - bondprice_arg_24157;\n                    float x_24165 = lifted_0_get_arg_24129 + x_24164;\n                    float x_24166 = 4.4999997e-6F * x_24165;\n                    float A1_24167 = x_24166 / 1.0e-4F;\n                    float y_24168 = fpow32(B_24163, 2.0F);\n                    float x_24169 = 1.0000001e-6F * y_24168;\n                    float A2_24170 = x_24169 / 4.0e-2F;\n                    float exp_arg_24171 = A1_24167 - A2_24170;\n                    float res_24172 = fpow32(2.7182817F, exp_arg_24171);\n                    float negate_arg_24173 = lifted_0_get_arg_24124 * B_24163;\n                    float exp_arg_24174 = 0.0F - negate_arg_24173;\n                    float res_24175 = fpow32(2.7182817F, exp_arg_24174);\n                    float res_24176 = res_24172 * res_24175;\n                    float res_24177 = res_24154 * res_24176;\n                    \n                    res_24137 = res_24177;\n                }\n                // write to-scan values to parameters\n                {\n                    x_24102 = x_24110;\n                    x_24103 = res_24137;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_26983, res_24015)) {\n                    x_24102 = 0;\n                    x_24103 = 0.0F;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_24104 = x_24100 || x_24102;\n                float res_24105;\n                \n                if (x_24102) {\n                    res_24105 = x_24103;\n                } else {\n                    float res_24106 = x_24101 + x_24103;\n                    \n                    res_24105 = res_24106;\n                }\n                ((",
                   "__local\n                  bool *) scan_arr_mem_28347)[sext_i32_i64(local_tid_28343)] =\n                    res_24104;\n                ((__local\n                  float *) scan_arr_mem_28349)[sext_i32_i64(local_tid_28343)] =\n                    res_24105;\n            }\n            \n          error_0:\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_failure)\n                return;\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28354;\n            float x_28355;\n            bool x_28356;\n            float x_28357;\n            bool x_28361;\n            float x_28362;\n            bool x_28363;\n            float x_28364;\n            bool ltid_in_bounds_28368;\n            \n            ltid_in_bounds_28368 = slt64(sext_i32_i64(local_tid_28343),\n                                         segscan_group_sizze_26979);\n            \n            int32_t skip_threads_28369;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28368) {\n                    x_28356 = ((volatile __local\n                                bool *) scan_arr_mem_28347)[sext_i32_i64(local_tid_28343)];\n                    x_28357 = ((volatile __local\n                                float *) scan_arr_mem_28349)[sext_i32_i64(local_tid_28343)];\n                    if ((local_tid_28343 - squot32(local_tid_28343, 32) * 32) ==\n                        0) {\n                        x_28354 = x_28356;\n                        x_28355 = x_28357;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28369 = 1;\n                while (slt32(skip_threads_28369, 32)) {\n                    if (sle32(skip_threads_28369, local_tid_28343 -\n                              squot32(local_tid_28343, 32) * 32) &&\n                        ltid_in_bounds_28368) {\n                        // read operands\n                        {\n                    ",
                   "        x_28354 = ((volatile __local\n                                        bool *) scan_arr_mem_28347)[sext_i32_i64(local_tid_28343) -\n                                                                    sext_i32_i64(skip_threads_28369)];\n                            x_28355 = ((volatile __local\n                                        float *) scan_arr_mem_28349)[sext_i32_i64(local_tid_28343) -\n                                                                     sext_i32_i64(skip_threads_28369)];\n                        }\n                        // perform operation\n                        {\n                            bool res_28358 = x_28354 || x_28356;\n                            float res_28359;\n                            \n                            if (x_28356) {\n                                res_28359 = x_28357;\n                            } else {\n                                float res_28360 = x_28355 + x_28357;\n                                \n                                res_28359 = res_28360;\n                            }\n                            x_28354 = res_28358;\n                            x_28355 = res_28359;\n                        }\n                    }\n                    if (sle32(wave_sizze_28345, skip_threads_28369)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28369, local_tid_28343 -\n                              squot32(local_tid_28343, 32) * 32) &&\n                        ltid_in_bounds_28368) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_28347)[sext_i32_i64(local_tid_28343)] =\n                                x_28354;\n                            x_28356 = x_28354;\n                            ((volatile __local\n                              float *) scan_arr_mem_28349)[sext_i32_i64(local_tid_28343)] =\n                                x_",
                   "28355;\n                            x_28357 = x_28355;\n                        }\n                    }\n                    if (sle32(wave_sizze_28345, skip_threads_28369)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28369 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28343 - squot32(local_tid_28343, 32) * 32) ==\n                    31 && ltid_in_bounds_28368) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28347)[sext_i32_i64(squot32(local_tid_28343,\n                                                                       32))] =\n                        x_28354;\n                    ((volatile __local\n                      float *) scan_arr_mem_28349)[sext_i32_i64(squot32(local_tid_28343,\n                                                                        32))] =\n                        x_28355;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28370;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28343, 32) == 0 &&\n                        ltid_in_bounds_28368) {\n                        x_28363 = ((volatile __local\n                                    bool *) scan_arr_mem_28347)[sext_i32_i64(local_tid_28343)];\n                        x_28364 = ((volatile __local\n                                    float *) scan_arr_mem_28349)[sext_i32_i64(local_tid_28343)];\n                        if ((local_tid_28343 - squot32(local_tid_28343, 32) *\n                             32) == 0) {\n                            x_28361 = x_28363;\n                            x_28362 = x_28364;\n         ",
                   "               }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28370 = 1;\n                    while (slt32(skip_threads_28370, 32)) {\n                        if (sle32(skip_threads_28370, local_tid_28343 -\n                                  squot32(local_tid_28343, 32) * 32) &&\n                            (squot32(local_tid_28343, 32) == 0 &&\n                             ltid_in_bounds_28368)) {\n                            // read operands\n                            {\n                                x_28361 = ((volatile __local\n                                            bool *) scan_arr_mem_28347)[sext_i32_i64(local_tid_28343) -\n                                                                        sext_i32_i64(skip_threads_28370)];\n                                x_28362 = ((volatile __local\n                                            float *) scan_arr_mem_28349)[sext_i32_i64(local_tid_28343) -\n                                                                         sext_i32_i64(skip_threads_28370)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28365 = x_28361 || x_28363;\n                                float res_28366;\n                                \n                                if (x_28363) {\n                                    res_28366 = x_28364;\n                                } else {\n                                    float res_28367 = x_28362 + x_28364;\n                                    \n                                    res_28366 = res_28367;\n                                }\n                                x_28361 = res_28365;\n                                x_28362 = res_28366;\n                            }\n                        }\n                        if (sle32(wave_sizze_28345, skip_threads_28370)) {\n                           ",
                   " barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28370, local_tid_28343 -\n                                  squot32(local_tid_28343, 32) * 32) &&\n                            (squot32(local_tid_28343, 32) == 0 &&\n                             ltid_in_bounds_28368)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_28347)[sext_i32_i64(local_tid_28343)] =\n                                    x_28361;\n                                x_28363 = x_28361;\n                                ((volatile __local\n                                  float *) scan_arr_mem_28349)[sext_i32_i64(local_tid_28343)] =\n                                    x_28362;\n                                x_28364 = x_28362;\n                            }\n                        }\n                        if (sle32(wave_sizze_28345, skip_threads_28370)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28370 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28343, 32) == 0 ||\n                      !ltid_in_bounds_28368)) {\n                    // read operands\n                    {\n                        x_28356 = x_28354;\n                        x_28357 = x_28355;\n                        x_28354 = ((__local\n                                    bool *) scan_arr_mem_28347)[sext_i32_i64(squot32(local_tid_28343,\n                                                                                     32)) -\n                                                                1];\n                        x_28355 = ((__local\n                                    float *) scan_arr_mem_28349)[sext_i32_i64(squot32(l",
                   "ocal_tid_28343,\n                                                                                      32)) -\n                                                                 1];\n                    }\n                    // perform operation\n                    {\n                        bool res_28358 = x_28354 || x_28356;\n                        float res_28359;\n                        \n                        if (x_28356) {\n                            res_28359 = x_28357;\n                        } else {\n                            float res_28360 = x_28355 + x_28357;\n                            \n                            res_28359 = res_28360;\n                        }\n                        x_28354 = res_28358;\n                        x_28355 = res_28359;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28347)[sext_i32_i64(local_tid_28343)] =\n                            x_28354;\n                        ((__local\n                          float *) scan_arr_mem_28349)[sext_i32_i64(local_tid_28343)] =\n                            x_28355;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28343, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_28347)[sext_i32_i64(local_tid_28343)] =\n                        x_28356;\n                    ((__local\n                      float *) scan_arr_mem_28349)[sext_i32_i64(local_tid_28343)] =\n                        x_28357;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_26983, res_24015)) {\n                    ((__global bool *) mem_27763)[gtid_26983] = ((__local\n                                      ",
                   "                            bool *) scan_arr_mem_28347)[sext_i32_i64(local_tid_28343)];\n                    ((__global float *) mem_27765)[gtid_26983] = ((__local\n                                                                   float *) scan_arr_mem_28349)[sext_i32_i64(local_tid_28343)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28371 = 0;\n                bool should_load_carry_28372 = local_tid_28343 == 0 &&\n                     !crosses_segment_28371;\n                \n                if (should_load_carry_28372) {\n                    x_24100 = ((__local\n                                bool *) scan_arr_mem_28347)[segscan_group_sizze_26979 -\n                                                            1];\n                    x_24101 = ((__local\n                                float *) scan_arr_mem_28349)[segscan_group_sizze_26979 -\n                                                             1];\n                }\n                if (!should_load_carry_28372) {\n                    x_24100 = 0;\n                    x_24101 = 0.0F;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_26979\n}\n__kernel void testziscan_stage1_27036(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28414_backing_aligned_0,\n                                      int64_t res_24015, __global\n                                      unsigned char *mem_27760, __global\n                                      unsigned char *mem_27768,\n                                      int32_t num_threads_28408)\n{\n    #define segscan_group_sizze_27031 (testzisegscan_group_sizze_27030)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_di",
                   "m2 = 2;\n    __local volatile char *restrict scan_arr_mem_28414_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28414_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28409;\n    int32_t local_tid_28410;\n    int64_t group_sizze_28413;\n    int32_t wave_sizze_28412;\n    int32_t group_tid_28411;\n    \n    global_tid_28409 = get_global_id(0);\n    local_tid_28410 = get_local_id(0);\n    group_sizze_28413 = get_local_size(0);\n    wave_sizze_28412 = LOCKSTEP_WIDTH;\n    group_tid_28411 = get_group_id(0);\n    \n    int32_t phys_tid_27036;\n    \n    phys_tid_27036 = global_tid_28409;\n    \n    __local char *scan_arr_mem_28414;\n    \n    scan_arr_mem_28414 = (__local char *) scan_arr_mem_28414_backing_0;\n    \n    int64_t x_24201;\n    int64_t x_24202;\n    \n    x_24201 = 0;\n    for (int64_t j_28416 = 0; j_28416 < sdiv_up64(res_24015,\n                                                  sext_i32_i64(num_threads_28408));\n         j_28416++) {\n        int64_t chunk_offset_28417 = segscan_group_sizze_27031 * j_28416 +\n                sext_i32_i64(group_tid_28411) * (segscan_group_sizze_27031 *\n                                                 sdiv_up64(res_24015,\n                                                           sext_i32_i64(num_threads_28408)));\n        int64_t flat_idx_28418 = chunk_offset_28417 +\n                sext_i32_i64(local_tid_28410);\n        int64_t gtid_27035 = flat_idx_28418;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27035, res_24015)) {\n                int64_t i_p_o_27553 = add64(1, gtid_27035);\n                int64_t rot_i_27554 = smod64(i_p_o_27553, res_24015);\n                bool x_24204 = ((__global bool *) mem_27760)[rot_i_27554];\n                int64_t res_24205 = btoi_bool_i64(x_24204);\n                \n                // write to-scan values to parameters\n                {\n                    x_24202 = res_24205;\n",
                   "                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27035, res_24015)) {\n                    x_24202 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_24203 = add64(x_24201, x_24202);\n                \n                ((__local\n                  int64_t *) scan_arr_mem_28414)[sext_i32_i64(local_tid_28410)] =\n                    res_24203;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_28419;\n            int64_t x_28420;\n            int64_t x_28422;\n            int64_t x_28423;\n            bool ltid_in_bounds_28425;\n            \n            ltid_in_bounds_28425 = slt64(sext_i32_i64(local_tid_28410),\n                                         segscan_group_sizze_27031);\n            \n            int32_t skip_threads_28426;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28425) {\n                    x_28420 = ((volatile __local\n                                int64_t *) scan_arr_mem_28414)[sext_i32_i64(local_tid_28410)];\n                    if ((local_tid_28410 - squot32(local_tid_28410, 32) * 32) ==\n                        0) {\n                        x_28419 = x_28420;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28426 = 1;\n                while (slt32(skip_threads_28426, 32)) {\n                    if (sle32(skip_threads_28426, local_tid_28410 -\n                              squot32(local_tid_28410, 32) * 32) &&\n                        ltid_in_bounds_28425) {\n                        // read operands\n                        ",
                   "{\n                            x_28419 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28414)[sext_i32_i64(local_tid_28410) -\n                                                                       sext_i32_i64(skip_threads_28426)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_28421 = add64(x_28419, x_28420);\n                            \n                            x_28419 = res_28421;\n                        }\n                    }\n                    if (sle32(wave_sizze_28412, skip_threads_28426)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28426, local_tid_28410 -\n                              squot32(local_tid_28410, 32) * 32) &&\n                        ltid_in_bounds_28425) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28414)[sext_i32_i64(local_tid_28410)] =\n                                x_28419;\n                            x_28420 = x_28419;\n                        }\n                    }\n                    if (sle32(wave_sizze_28412, skip_threads_28426)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28426 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28410 - squot32(local_tid_28410, 32) * 32) ==\n                    31 && ltid_in_bounds_28425) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28414)[sext_i32_i64(squot32(local_tid_28410,\n                                                                          32))] =\n                        x_28419;\n                }\n            }\n      ",
                   "      barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28427;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28410, 32) == 0 &&\n                        ltid_in_bounds_28425) {\n                        x_28423 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28414)[sext_i32_i64(local_tid_28410)];\n                        if ((local_tid_28410 - squot32(local_tid_28410, 32) *\n                             32) == 0) {\n                            x_28422 = x_28423;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28427 = 1;\n                    while (slt32(skip_threads_28427, 32)) {\n                        if (sle32(skip_threads_28427, local_tid_28410 -\n                                  squot32(local_tid_28410, 32) * 32) &&\n                            (squot32(local_tid_28410, 32) == 0 &&\n                             ltid_in_bounds_28425)) {\n                            // read operands\n                            {\n                                x_28422 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28414)[sext_i32_i64(local_tid_28410) -\n                                                                           sext_i32_i64(skip_threads_28427)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_28424 = add64(x_28422, x_28423);\n                                \n                                x_28422 = res_28424;\n                            }\n                        }\n                        if (sle32(wave_sizze_28412, skip_threads_28427)) {\n                            ba",
                   "rrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28427, local_tid_28410 -\n                                  squot32(local_tid_28410, 32) * 32) &&\n                            (squot32(local_tid_28410, 32) == 0 &&\n                             ltid_in_bounds_28425)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28414)[sext_i32_i64(local_tid_28410)] =\n                                    x_28422;\n                                x_28423 = x_28422;\n                            }\n                        }\n                        if (sle32(wave_sizze_28412, skip_threads_28427)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28427 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28410, 32) == 0 ||\n                      !ltid_in_bounds_28425)) {\n                    // read operands\n                    {\n                        x_28420 = x_28419;\n                        x_28419 = ((__local\n                                    int64_t *) scan_arr_mem_28414)[sext_i32_i64(squot32(local_tid_28410,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28421 = add64(x_28419, x_28420);\n                        \n                        x_28419 = res_28421;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_28414)[sext_i3",
                   "2_i64(local_tid_28410)] =\n                            x_28419;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28410, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_28414)[sext_i32_i64(local_tid_28410)] =\n                        x_28420;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_27035, res_24015)) {\n                    ((__global int64_t *) mem_27768)[gtid_27035] = ((__local\n                                                                     int64_t *) scan_arr_mem_28414)[sext_i32_i64(local_tid_28410)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28428 = 0;\n                bool should_load_carry_28429 = local_tid_28410 == 0 &&\n                     !crosses_segment_28428;\n                \n                if (should_load_carry_28429) {\n                    x_24201 = ((__local\n                                int64_t *) scan_arr_mem_28414)[segscan_group_sizze_27031 -\n                                                               1];\n                }\n                if (!should_load_carry_28429) {\n                    x_24201 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27031\n}\n__kernel void testziscan_stage2_26935(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_27995_backing_aligned_0,\n                                      int64_t binop_x_27692, __global\n                                 ",
                   "     unsigned char *mem_27740,\n                                      int64_t stage1_num_groups_27967,\n                                      int32_t num_threads_27968)\n{\n    #define segscan_group_sizze_26930 (testzisegscan_group_sizze_26929)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_27995_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_27995_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27990;\n    int32_t local_tid_27991;\n    int64_t group_sizze_27994;\n    int32_t wave_sizze_27993;\n    int32_t group_tid_27992;\n    \n    global_tid_27990 = get_global_id(0);\n    local_tid_27991 = get_local_id(0);\n    group_sizze_27994 = get_local_size(0);\n    wave_sizze_27993 = LOCKSTEP_WIDTH;\n    group_tid_27992 = get_group_id(0);\n    \n    int32_t phys_tid_26935;\n    \n    phys_tid_26935 = global_tid_27990;\n    \n    __local char *scan_arr_mem_27995;\n    \n    scan_arr_mem_27995 = (__local char *) scan_arr_mem_27995_backing_0;\n    \n    int64_t flat_idx_27997;\n    \n    flat_idx_27997 = (sext_i32_i64(local_tid_27991) + 1) *\n        (segscan_group_sizze_26930 * sdiv_up64(binop_x_27692,\n                                               sext_i32_i64(num_threads_27968))) -\n        1;\n    \n    int64_t gtid_26934;\n    \n    gtid_26934 = flat_idx_27997;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_26934, binop_x_27692)) {\n            ((__local\n              int64_t *) scan_arr_mem_27995)[sext_i32_i64(local_tid_27991)] =\n                ((__global int64_t *) mem_27740)[gtid_26934];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_27995)[sext_i32_i64(local_tid_27991)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_23999;\n    int64_t x_24000;\n    int64_t x_27998;\n    int64_t x_27999;\n    bool lti",
                   "d_in_bounds_28001;\n    \n    ltid_in_bounds_28001 = slt64(sext_i32_i64(local_tid_27991),\n                                 stage1_num_groups_27967);\n    \n    int32_t skip_threads_28002;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28001) {\n            x_24000 = ((volatile __local\n                        int64_t *) scan_arr_mem_27995)[sext_i32_i64(local_tid_27991)];\n            if ((local_tid_27991 - squot32(local_tid_27991, 32) * 32) == 0) {\n                x_23999 = x_24000;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28002 = 1;\n        while (slt32(skip_threads_28002, 32)) {\n            if (sle32(skip_threads_28002, local_tid_27991 -\n                      squot32(local_tid_27991, 32) * 32) &&\n                ltid_in_bounds_28001) {\n                // read operands\n                {\n                    x_23999 = ((volatile __local\n                                int64_t *) scan_arr_mem_27995)[sext_i32_i64(local_tid_27991) -\n                                                               sext_i32_i64(skip_threads_28002)];\n                }\n                // perform operation\n                {\n                    int64_t res_24001 = add64(x_23999, x_24000);\n                    \n                    x_23999 = res_24001;\n                }\n            }\n            if (sle32(wave_sizze_27993, skip_threads_28002)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28002, local_tid_27991 -\n                      squot32(local_tid_27991, 32) * 32) &&\n                ltid_in_bounds_28001) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_27995)[sext_i32_i64(local_tid_27991)] =\n                        x_23999;\n                    x_24000 = x_23999;\n                }\n            }\n            if (sle32(wave_sizze_27993, skip_threads_28002)) {\n              ",
                   "  barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28002 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_27991 - squot32(local_tid_27991, 32) * 32) == 31 &&\n            ltid_in_bounds_28001) {\n            ((volatile __local\n              int64_t *) scan_arr_mem_27995)[sext_i32_i64(squot32(local_tid_27991,\n                                                                  32))] =\n                x_23999;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28003;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_27991, 32) == 0 && ltid_in_bounds_28001) {\n                x_27999 = ((volatile __local\n                            int64_t *) scan_arr_mem_27995)[sext_i32_i64(local_tid_27991)];\n                if ((local_tid_27991 - squot32(local_tid_27991, 32) * 32) ==\n                    0) {\n                    x_27998 = x_27999;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28003 = 1;\n            while (slt32(skip_threads_28003, 32)) {\n                if (sle32(skip_threads_28003, local_tid_27991 -\n                          squot32(local_tid_27991, 32) * 32) &&\n                    (squot32(local_tid_27991, 32) == 0 &&\n                     ltid_in_bounds_28001)) {\n                    // read operands\n                    {\n                        x_27998 = ((volatile __local\n                                    int64_t *) scan_arr_mem_27995)[sext_i32_i64(local_tid_27991) -\n                                                                   sext_i32_i64(skip_threads_28003)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28000 = add64(x_2799",
                   "8, x_27999);\n                        \n                        x_27998 = res_28000;\n                    }\n                }\n                if (sle32(wave_sizze_27993, skip_threads_28003)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28003, local_tid_27991 -\n                          squot32(local_tid_27991, 32) * 32) &&\n                    (squot32(local_tid_27991, 32) == 0 &&\n                     ltid_in_bounds_28001)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_27995)[sext_i32_i64(local_tid_27991)] =\n                            x_27998;\n                        x_27999 = x_27998;\n                    }\n                }\n                if (sle32(wave_sizze_27993, skip_threads_28003)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28003 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_27991, 32) == 0 || !ltid_in_bounds_28001)) {\n            // read operands\n            {\n                x_24000 = x_23999;\n                x_23999 = ((__local\n                            int64_t *) scan_arr_mem_27995)[sext_i32_i64(squot32(local_tid_27991,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_24001 = add64(x_23999, x_24000);\n                \n                x_23999 = res_24001;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_27995)[sext_i32_i64(local_tid_27991)] =\n                    x_23999;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct valu",
                   "es for first block\n    {\n        if (squot32(local_tid_27991, 32) == 0) {\n            ((__local\n              int64_t *) scan_arr_mem_27995)[sext_i32_i64(local_tid_27991)] =\n                x_24000;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_26934, binop_x_27692)) {\n            ((__global int64_t *) mem_27740)[gtid_26934] = ((__local\n                                                             int64_t *) scan_arr_mem_27995)[sext_i32_i64(local_tid_27991)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26930\n}\n__kernel void testziscan_stage2_26968(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28246_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28244_backing_aligned_1,\n                                      int64_t res_24015, __global\n                                      unsigned char *mem_27751, __global\n                                      unsigned char *mem_27753,\n                                      int64_t stage1_num_groups_28206,\n                                      int32_t num_threads_28207)\n{\n    #define segscan_group_sizze_26963 (testzisegscan_group_sizze_26962)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28246_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28246_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28244_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28244_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28239;\n    int32_t local_tid_28240;\n    int64_t group_sizze_28243;\n    ",
                   "int32_t wave_sizze_28242;\n    int32_t group_tid_28241;\n    \n    global_tid_28239 = get_global_id(0);\n    local_tid_28240 = get_local_id(0);\n    group_sizze_28243 = get_local_size(0);\n    wave_sizze_28242 = LOCKSTEP_WIDTH;\n    group_tid_28241 = get_group_id(0);\n    \n    int32_t phys_tid_26968;\n    \n    phys_tid_26968 = global_tid_28239;\n    \n    __local char *scan_arr_mem_28244;\n    __local char *scan_arr_mem_28246;\n    \n    scan_arr_mem_28244 = (__local char *) scan_arr_mem_28244_backing_0;\n    scan_arr_mem_28246 = (__local char *) scan_arr_mem_28246_backing_1;\n    \n    int64_t flat_idx_28248;\n    \n    flat_idx_28248 = (sext_i32_i64(local_tid_28240) + 1) *\n        (segscan_group_sizze_26963 * sdiv_up64(res_24015,\n                                               sext_i32_i64(num_threads_28207))) -\n        1;\n    \n    int64_t gtid_26967;\n    \n    gtid_26967 = flat_idx_28248;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_26967, res_24015)) {\n            ((__local\n              bool *) scan_arr_mem_28244)[sext_i32_i64(local_tid_28240)] =\n                ((__global bool *) mem_27751)[gtid_26967];\n            ((__local\n              int64_t *) scan_arr_mem_28246)[sext_i32_i64(local_tid_28240)] =\n                ((__global int64_t *) mem_27753)[gtid_26967];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28244)[sext_i32_i64(local_tid_28240)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_28246)[sext_i32_i64(local_tid_28240)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_24034;\n    int64_t x_24035;\n    bool x_24036;\n    int64_t x_24037;\n    bool x_28249;\n    int64_t x_28250;\n    bool x_28251;\n    int64_t x_28252;\n    bool ltid_in_bounds_28256;\n    \n    ltid_in_bounds_28256 = slt64(sext_i32_i64(local_tid_28240),\n                                 stage1_num_groups_28206);\n    \n    int32_t skip_threads_28257;\n    \n    // read input for in-block scan\n    {\n        i",
                   "f (ltid_in_bounds_28256) {\n            x_24036 = ((volatile __local\n                        bool *) scan_arr_mem_28244)[sext_i32_i64(local_tid_28240)];\n            x_24037 = ((volatile __local\n                        int64_t *) scan_arr_mem_28246)[sext_i32_i64(local_tid_28240)];\n            if ((local_tid_28240 - squot32(local_tid_28240, 32) * 32) == 0) {\n                x_24034 = x_24036;\n                x_24035 = x_24037;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28257 = 1;\n        while (slt32(skip_threads_28257, 32)) {\n            if (sle32(skip_threads_28257, local_tid_28240 -\n                      squot32(local_tid_28240, 32) * 32) &&\n                ltid_in_bounds_28256) {\n                // read operands\n                {\n                    x_24034 = ((volatile __local\n                                bool *) scan_arr_mem_28244)[sext_i32_i64(local_tid_28240) -\n                                                            sext_i32_i64(skip_threads_28257)];\n                    x_24035 = ((volatile __local\n                                int64_t *) scan_arr_mem_28246)[sext_i32_i64(local_tid_28240) -\n                                                               sext_i32_i64(skip_threads_28257)];\n                }\n                // perform operation\n                {\n                    bool res_24038 = x_24034 || x_24036;\n                    int64_t res_24039;\n                    \n                    if (x_24036) {\n                        res_24039 = x_24037;\n                    } else {\n                        int64_t res_24040 = add64(x_24035, x_24037);\n                        \n                        res_24039 = res_24040;\n                    }\n                    x_24034 = res_24038;\n                    x_24035 = res_24039;\n                }\n            }\n            if (sle32(wave_sizze_28242, skip_threads_28257)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (",
                   "sle32(skip_threads_28257, local_tid_28240 -\n                      squot32(local_tid_28240, 32) * 32) &&\n                ltid_in_bounds_28256) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28244)[sext_i32_i64(local_tid_28240)] =\n                        x_24034;\n                    x_24036 = x_24034;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28246)[sext_i32_i64(local_tid_28240)] =\n                        x_24035;\n                    x_24037 = x_24035;\n                }\n            }\n            if (sle32(wave_sizze_28242, skip_threads_28257)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28257 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28240 - squot32(local_tid_28240, 32) * 32) == 31 &&\n            ltid_in_bounds_28256) {\n            ((volatile __local\n              bool *) scan_arr_mem_28244)[sext_i32_i64(squot32(local_tid_28240,\n                                                               32))] = x_24034;\n            ((volatile __local\n              int64_t *) scan_arr_mem_28246)[sext_i32_i64(squot32(local_tid_28240,\n                                                                  32))] =\n                x_24035;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28258;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28240, 32) == 0 && ltid_in_bounds_28256) {\n                x_28251 = ((volatile __local\n                            bool *) scan_arr_mem_28244)[sext_i32_i64(local_tid_28240)];\n                x_28252 = ((volatile __local\n                            int64_t *) scan_arr_mem_28246)[sext_i32_i64(local_tid_28240)];\n     ",
                   "           if ((local_tid_28240 - squot32(local_tid_28240, 32) * 32) ==\n                    0) {\n                    x_28249 = x_28251;\n                    x_28250 = x_28252;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28258 = 1;\n            while (slt32(skip_threads_28258, 32)) {\n                if (sle32(skip_threads_28258, local_tid_28240 -\n                          squot32(local_tid_28240, 32) * 32) &&\n                    (squot32(local_tid_28240, 32) == 0 &&\n                     ltid_in_bounds_28256)) {\n                    // read operands\n                    {\n                        x_28249 = ((volatile __local\n                                    bool *) scan_arr_mem_28244)[sext_i32_i64(local_tid_28240) -\n                                                                sext_i32_i64(skip_threads_28258)];\n                        x_28250 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28246)[sext_i32_i64(local_tid_28240) -\n                                                                   sext_i32_i64(skip_threads_28258)];\n                    }\n                    // perform operation\n                    {\n                        bool res_28253 = x_28249 || x_28251;\n                        int64_t res_28254;\n                        \n                        if (x_28251) {\n                            res_28254 = x_28252;\n                        } else {\n                            int64_t res_28255 = add64(x_28250, x_28252);\n                            \n                            res_28254 = res_28255;\n                        }\n                        x_28249 = res_28253;\n                        x_28250 = res_28254;\n                    }\n                }\n                if (sle32(wave_sizze_28242, skip_threads_28258)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28258, local_tid_2",
                   "8240 -\n                          squot32(local_tid_28240, 32) * 32) &&\n                    (squot32(local_tid_28240, 32) == 0 &&\n                     ltid_in_bounds_28256)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28244)[sext_i32_i64(local_tid_28240)] =\n                            x_28249;\n                        x_28251 = x_28249;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28246)[sext_i32_i64(local_tid_28240)] =\n                            x_28250;\n                        x_28252 = x_28250;\n                    }\n                }\n                if (sle32(wave_sizze_28242, skip_threads_28258)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28258 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28240, 32) == 0 || !ltid_in_bounds_28256)) {\n            // read operands\n            {\n                x_24036 = x_24034;\n                x_24037 = x_24035;\n                x_24034 = ((__local\n                            bool *) scan_arr_mem_28244)[sext_i32_i64(squot32(local_tid_28240,\n                                                                             32)) -\n                                                        1];\n                x_24035 = ((__local\n                            int64_t *) scan_arr_mem_28246)[sext_i32_i64(squot32(local_tid_28240,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_24038 = x_24034 || x_24036;\n                int64_t res_24039;\n                \n                if (x_24036) {\n                    res_24039 = x_24037;\n                } else {",
                   "\n                    int64_t res_24040 = add64(x_24035, x_24037);\n                    \n                    res_24039 = res_24040;\n                }\n                x_24034 = res_24038;\n                x_24035 = res_24039;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28244)[sext_i32_i64(local_tid_28240)] =\n                    x_24034;\n                ((__local\n                  int64_t *) scan_arr_mem_28246)[sext_i32_i64(local_tid_28240)] =\n                    x_24035;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28240, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28244)[sext_i32_i64(local_tid_28240)] =\n                x_24036;\n            ((__local\n              int64_t *) scan_arr_mem_28246)[sext_i32_i64(local_tid_28240)] =\n                x_24037;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_26967, res_24015)) {\n            ((__global bool *) mem_27751)[gtid_26967] = ((__local\n                                                          bool *) scan_arr_mem_28244)[sext_i32_i64(local_tid_28240)];\n            ((__global int64_t *) mem_27753)[gtid_26967] = ((__local\n                                                             int64_t *) scan_arr_mem_28246)[sext_i32_i64(local_tid_28240)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26963\n}\n__kernel void testziscan_stage2_26976(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28313_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28311_backing_aligned_1,\n                                      int64_t res_24015, __global\n            ",
                   "                          unsigned char *mem_27756, __global\n                                      unsigned char *mem_27758,\n                                      int64_t stage1_num_groups_28273,\n                                      int32_t num_threads_28274)\n{\n    #define segscan_group_sizze_26971 (testzisegscan_group_sizze_26970)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28313_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28313_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28311_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28311_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28306;\n    int32_t local_tid_28307;\n    int64_t group_sizze_28310;\n    int32_t wave_sizze_28309;\n    int32_t group_tid_28308;\n    \n    global_tid_28306 = get_global_id(0);\n    local_tid_28307 = get_local_id(0);\n    group_sizze_28310 = get_local_size(0);\n    wave_sizze_28309 = LOCKSTEP_WIDTH;\n    group_tid_28308 = get_group_id(0);\n    \n    int32_t phys_tid_26976;\n    \n    phys_tid_26976 = global_tid_28306;\n    \n    __local char *scan_arr_mem_28311;\n    __local char *scan_arr_mem_28313;\n    \n    scan_arr_mem_28311 = (__local char *) scan_arr_mem_28311_backing_0;\n    scan_arr_mem_28313 = (__local char *) scan_arr_mem_28313_backing_1;\n    \n    int64_t flat_idx_28315;\n    \n    flat_idx_28315 = (sext_i32_i64(local_tid_28307) + 1) *\n        (segscan_group_sizze_26971 * sdiv_up64(res_24015,\n                                               sext_i32_i64(num_threads_28274))) -\n        1;\n    \n    int64_t gtid_26975;\n    \n    gtid_26975 = flat_idx_28315;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_26975, res_24015)) {\n            ((__local\n              bool *) scan_arr_",
                   "mem_28311)[sext_i32_i64(local_tid_28307)] =\n                ((__global bool *) mem_27756)[gtid_26975];\n            ((__local\n              int64_t *) scan_arr_mem_28313)[sext_i32_i64(local_tid_28307)] =\n                ((__global int64_t *) mem_27758)[gtid_26975];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28311)[sext_i32_i64(local_tid_28307)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_28313)[sext_i32_i64(local_tid_28307)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_24074;\n    int64_t x_24075;\n    bool x_24076;\n    int64_t x_24077;\n    bool x_28316;\n    int64_t x_28317;\n    bool x_28318;\n    int64_t x_28319;\n    bool ltid_in_bounds_28323;\n    \n    ltid_in_bounds_28323 = slt64(sext_i32_i64(local_tid_28307),\n                                 stage1_num_groups_28273);\n    \n    int32_t skip_threads_28324;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28323) {\n            x_24076 = ((volatile __local\n                        bool *) scan_arr_mem_28311)[sext_i32_i64(local_tid_28307)];\n            x_24077 = ((volatile __local\n                        int64_t *) scan_arr_mem_28313)[sext_i32_i64(local_tid_28307)];\n            if ((local_tid_28307 - squot32(local_tid_28307, 32) * 32) == 0) {\n                x_24074 = x_24076;\n                x_24075 = x_24077;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28324 = 1;\n        while (slt32(skip_threads_28324, 32)) {\n            if (sle32(skip_threads_28324, local_tid_28307 -\n                      squot32(local_tid_28307, 32) * 32) &&\n                ltid_in_bounds_28323) {\n                // read operands\n                {\n                    x_24074 = ((volatile __local\n                                bool *) scan_arr_mem_28311)[sext_i32_i64(local_tid_28307) -\n                                                            sext_i32_i64(skip_threads_28324)];\n         ",
                   "           x_24075 = ((volatile __local\n                                int64_t *) scan_arr_mem_28313)[sext_i32_i64(local_tid_28307) -\n                                                               sext_i32_i64(skip_threads_28324)];\n                }\n                // perform operation\n                {\n                    bool res_24078 = x_24074 || x_24076;\n                    int64_t res_24079;\n                    \n                    if (x_24076) {\n                        res_24079 = x_24077;\n                    } else {\n                        int64_t res_24080 = add64(x_24075, x_24077);\n                        \n                        res_24079 = res_24080;\n                    }\n                    x_24074 = res_24078;\n                    x_24075 = res_24079;\n                }\n            }\n            if (sle32(wave_sizze_28309, skip_threads_28324)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28324, local_tid_28307 -\n                      squot32(local_tid_28307, 32) * 32) &&\n                ltid_in_bounds_28323) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28311)[sext_i32_i64(local_tid_28307)] =\n                        x_24074;\n                    x_24076 = x_24074;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28313)[sext_i32_i64(local_tid_28307)] =\n                        x_24075;\n                    x_24077 = x_24075;\n                }\n            }\n            if (sle32(wave_sizze_28309, skip_threads_28324)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28324 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28307 - squot32(local_tid_28307, 32) * 32) == 31 &&\n            ltid_in_bounds_28323) {\n            ((volatile __local\n             ",
                   " bool *) scan_arr_mem_28311)[sext_i32_i64(squot32(local_tid_28307,\n                                                               32))] = x_24074;\n            ((volatile __local\n              int64_t *) scan_arr_mem_28313)[sext_i32_i64(squot32(local_tid_28307,\n                                                                  32))] =\n                x_24075;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28325;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28307, 32) == 0 && ltid_in_bounds_28323) {\n                x_28318 = ((volatile __local\n                            bool *) scan_arr_mem_28311)[sext_i32_i64(local_tid_28307)];\n                x_28319 = ((volatile __local\n                            int64_t *) scan_arr_mem_28313)[sext_i32_i64(local_tid_28307)];\n                if ((local_tid_28307 - squot32(local_tid_28307, 32) * 32) ==\n                    0) {\n                    x_28316 = x_28318;\n                    x_28317 = x_28319;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28325 = 1;\n            while (slt32(skip_threads_28325, 32)) {\n                if (sle32(skip_threads_28325, local_tid_28307 -\n                          squot32(local_tid_28307, 32) * 32) &&\n                    (squot32(local_tid_28307, 32) == 0 &&\n                     ltid_in_bounds_28323)) {\n                    // read operands\n                    {\n                        x_28316 = ((volatile __local\n                                    bool *) scan_arr_mem_28311)[sext_i32_i64(local_tid_28307) -\n                                                                sext_i32_i64(skip_threads_28325)];\n                        x_28317 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28313)[sext_i32_i64(local_tid",
                   "_28307) -\n                                                                   sext_i32_i64(skip_threads_28325)];\n                    }\n                    // perform operation\n                    {\n                        bool res_28320 = x_28316 || x_28318;\n                        int64_t res_28321;\n                        \n                        if (x_28318) {\n                            res_28321 = x_28319;\n                        } else {\n                            int64_t res_28322 = add64(x_28317, x_28319);\n                            \n                            res_28321 = res_28322;\n                        }\n                        x_28316 = res_28320;\n                        x_28317 = res_28321;\n                    }\n                }\n                if (sle32(wave_sizze_28309, skip_threads_28325)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28325, local_tid_28307 -\n                          squot32(local_tid_28307, 32) * 32) &&\n                    (squot32(local_tid_28307, 32) == 0 &&\n                     ltid_in_bounds_28323)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28311)[sext_i32_i64(local_tid_28307)] =\n                            x_28316;\n                        x_28318 = x_28316;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28313)[sext_i32_i64(local_tid_28307)] =\n                            x_28317;\n                        x_28319 = x_28317;\n                    }\n                }\n                if (sle32(wave_sizze_28309, skip_threads_28325)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28325 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28307, 32) == 0 || !ltid_in_b",
                   "ounds_28323)) {\n            // read operands\n            {\n                x_24076 = x_24074;\n                x_24077 = x_24075;\n                x_24074 = ((__local\n                            bool *) scan_arr_mem_28311)[sext_i32_i64(squot32(local_tid_28307,\n                                                                             32)) -\n                                                        1];\n                x_24075 = ((__local\n                            int64_t *) scan_arr_mem_28313)[sext_i32_i64(squot32(local_tid_28307,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_24078 = x_24074 || x_24076;\n                int64_t res_24079;\n                \n                if (x_24076) {\n                    res_24079 = x_24077;\n                } else {\n                    int64_t res_24080 = add64(x_24075, x_24077);\n                    \n                    res_24079 = res_24080;\n                }\n                x_24074 = res_24078;\n                x_24075 = res_24079;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28311)[sext_i32_i64(local_tid_28307)] =\n                    x_24074;\n                ((__local\n                  int64_t *) scan_arr_mem_28313)[sext_i32_i64(local_tid_28307)] =\n                    x_24075;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28307, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28311)[sext_i32_i64(local_tid_28307)] =\n                x_24076;\n            ((__local\n              int64_t *) scan_arr_mem_28313)[sext_i32_i64(local_tid_28307)] =\n                x_24077;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scan",
                   "ned carries\n    {\n        if (slt64(gtid_26975, res_24015)) {\n            ((__global bool *) mem_27756)[gtid_26975] = ((__local\n                                                          bool *) scan_arr_mem_28311)[sext_i32_i64(local_tid_28307)];\n            ((__global int64_t *) mem_27758)[gtid_26975] = ((__local\n                                                             int64_t *) scan_arr_mem_28313)[sext_i32_i64(local_tid_28307)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26971\n}\n__kernel void testziscan_stage2_26984(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28380_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28378_backing_aligned_1,\n                                      int64_t res_24015, __global\n                                      unsigned char *mem_27763, __global\n                                      unsigned char *mem_27765,\n                                      int64_t stage1_num_groups_28340,\n                                      int32_t num_threads_28341)\n{\n    #define segscan_group_sizze_26979 (testzisegscan_group_sizze_26978)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28380_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28380_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28378_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28378_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28373;\n    int32_t local_tid_28374;\n    int64_t group_sizze_28377;\n    int32_t wave_sizze_28376;\n    int32_t group_tid_28375;\n    \n    global_tid_28373 = get_global_id(0);\n   ",
                   " local_tid_28374 = get_local_id(0);\n    group_sizze_28377 = get_local_size(0);\n    wave_sizze_28376 = LOCKSTEP_WIDTH;\n    group_tid_28375 = get_group_id(0);\n    \n    int32_t phys_tid_26984;\n    \n    phys_tid_26984 = global_tid_28373;\n    \n    __local char *scan_arr_mem_28378;\n    __local char *scan_arr_mem_28380;\n    \n    scan_arr_mem_28378 = (__local char *) scan_arr_mem_28378_backing_0;\n    scan_arr_mem_28380 = (__local char *) scan_arr_mem_28380_backing_1;\n    \n    int64_t flat_idx_28382;\n    \n    flat_idx_28382 = (sext_i32_i64(local_tid_28374) + 1) *\n        (segscan_group_sizze_26979 * sdiv_up64(res_24015,\n                                               sext_i32_i64(num_threads_28341))) -\n        1;\n    \n    int64_t gtid_26983;\n    \n    gtid_26983 = flat_idx_28382;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_26983, res_24015)) {\n            ((__local\n              bool *) scan_arr_mem_28378)[sext_i32_i64(local_tid_28374)] =\n                ((__global bool *) mem_27763)[gtid_26983];\n            ((__local\n              float *) scan_arr_mem_28380)[sext_i32_i64(local_tid_28374)] =\n                ((__global float *) mem_27765)[gtid_26983];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28378)[sext_i32_i64(local_tid_28374)] = 0;\n            ((__local\n              float *) scan_arr_mem_28380)[sext_i32_i64(local_tid_28374)] =\n                0.0F;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_24100;\n    float x_24101;\n    bool x_24102;\n    float x_24103;\n    bool x_28383;\n    float x_28384;\n    bool x_28385;\n    float x_28386;\n    bool ltid_in_bounds_28390;\n    \n    ltid_in_bounds_28390 = slt64(sext_i32_i64(local_tid_28374),\n                                 stage1_num_groups_28340);\n    \n    int32_t skip_threads_28391;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28390) {\n            x_24102 = ((volatile __local\n                        bool *)",
                   " scan_arr_mem_28378)[sext_i32_i64(local_tid_28374)];\n            x_24103 = ((volatile __local\n                        float *) scan_arr_mem_28380)[sext_i32_i64(local_tid_28374)];\n            if ((local_tid_28374 - squot32(local_tid_28374, 32) * 32) == 0) {\n                x_24100 = x_24102;\n                x_24101 = x_24103;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28391 = 1;\n        while (slt32(skip_threads_28391, 32)) {\n            if (sle32(skip_threads_28391, local_tid_28374 -\n                      squot32(local_tid_28374, 32) * 32) &&\n                ltid_in_bounds_28390) {\n                // read operands\n                {\n                    x_24100 = ((volatile __local\n                                bool *) scan_arr_mem_28378)[sext_i32_i64(local_tid_28374) -\n                                                            sext_i32_i64(skip_threads_28391)];\n                    x_24101 = ((volatile __local\n                                float *) scan_arr_mem_28380)[sext_i32_i64(local_tid_28374) -\n                                                             sext_i32_i64(skip_threads_28391)];\n                }\n                // perform operation\n                {\n                    bool res_24104 = x_24100 || x_24102;\n                    float res_24105;\n                    \n                    if (x_24102) {\n                        res_24105 = x_24103;\n                    } else {\n                        float res_24106 = x_24101 + x_24103;\n                        \n                        res_24105 = res_24106;\n                    }\n                    x_24100 = res_24104;\n                    x_24101 = res_24105;\n                }\n            }\n            if (sle32(wave_sizze_28376, skip_threads_28391)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28391, local_tid_28374 -\n                      squot32(local_tid_28374, 32) * 32) &&\n           ",
                   "     ltid_in_bounds_28390) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28378)[sext_i32_i64(local_tid_28374)] =\n                        x_24100;\n                    x_24102 = x_24100;\n                    ((volatile __local\n                      float *) scan_arr_mem_28380)[sext_i32_i64(local_tid_28374)] =\n                        x_24101;\n                    x_24103 = x_24101;\n                }\n            }\n            if (sle32(wave_sizze_28376, skip_threads_28391)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28391 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28374 - squot32(local_tid_28374, 32) * 32) == 31 &&\n            ltid_in_bounds_28390) {\n            ((volatile __local\n              bool *) scan_arr_mem_28378)[sext_i32_i64(squot32(local_tid_28374,\n                                                               32))] = x_24100;\n            ((volatile __local\n              float *) scan_arr_mem_28380)[sext_i32_i64(squot32(local_tid_28374,\n                                                                32))] = x_24101;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28392;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28374, 32) == 0 && ltid_in_bounds_28390) {\n                x_28385 = ((volatile __local\n                            bool *) scan_arr_mem_28378)[sext_i32_i64(local_tid_28374)];\n                x_28386 = ((volatile __local\n                            float *) scan_arr_mem_28380)[sext_i32_i64(local_tid_28374)];\n                if ((local_tid_28374 - squot32(local_tid_28374, 32) * 32) ==\n                    0) {\n                    x_28383 = x_28385;\n   ",
                   "                 x_28384 = x_28386;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28392 = 1;\n            while (slt32(skip_threads_28392, 32)) {\n                if (sle32(skip_threads_28392, local_tid_28374 -\n                          squot32(local_tid_28374, 32) * 32) &&\n                    (squot32(local_tid_28374, 32) == 0 &&\n                     ltid_in_bounds_28390)) {\n                    // read operands\n                    {\n                        x_28383 = ((volatile __local\n                                    bool *) scan_arr_mem_28378)[sext_i32_i64(local_tid_28374) -\n                                                                sext_i32_i64(skip_threads_28392)];\n                        x_28384 = ((volatile __local\n                                    float *) scan_arr_mem_28380)[sext_i32_i64(local_tid_28374) -\n                                                                 sext_i32_i64(skip_threads_28392)];\n                    }\n                    // perform operation\n                    {\n                        bool res_28387 = x_28383 || x_28385;\n                        float res_28388;\n                        \n                        if (x_28385) {\n                            res_28388 = x_28386;\n                        } else {\n                            float res_28389 = x_28384 + x_28386;\n                            \n                            res_28388 = res_28389;\n                        }\n                        x_28383 = res_28387;\n                        x_28384 = res_28388;\n                    }\n                }\n                if (sle32(wave_sizze_28376, skip_threads_28392)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28392, local_tid_28374 -\n                          squot32(local_tid_28374, 32) * 32) &&\n                    (squot32(local_tid_28374, 32) == 0 &&\n                     lti",
                   "d_in_bounds_28390)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28378)[sext_i32_i64(local_tid_28374)] =\n                            x_28383;\n                        x_28385 = x_28383;\n                        ((volatile __local\n                          float *) scan_arr_mem_28380)[sext_i32_i64(local_tid_28374)] =\n                            x_28384;\n                        x_28386 = x_28384;\n                    }\n                }\n                if (sle32(wave_sizze_28376, skip_threads_28392)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28392 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28374, 32) == 0 || !ltid_in_bounds_28390)) {\n            // read operands\n            {\n                x_24102 = x_24100;\n                x_24103 = x_24101;\n                x_24100 = ((__local\n                            bool *) scan_arr_mem_28378)[sext_i32_i64(squot32(local_tid_28374,\n                                                                             32)) -\n                                                        1];\n                x_24101 = ((__local\n                            float *) scan_arr_mem_28380)[sext_i32_i64(squot32(local_tid_28374,\n                                                                              32)) -\n                                                         1];\n            }\n            // perform operation\n            {\n                bool res_24104 = x_24100 || x_24102;\n                float res_24105;\n                \n                if (x_24102) {\n                    res_24105 = x_24103;\n                } else {\n                    float res_24106 = x_24101 + x_24103;\n                    \n                    res_24105 = res_24106;\n                }\n                x_24100",
                   " = res_24104;\n                x_24101 = res_24105;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28378)[sext_i32_i64(local_tid_28374)] =\n                    x_24100;\n                ((__local\n                  float *) scan_arr_mem_28380)[sext_i32_i64(local_tid_28374)] =\n                    x_24101;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28374, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28378)[sext_i32_i64(local_tid_28374)] =\n                x_24102;\n            ((__local\n              float *) scan_arr_mem_28380)[sext_i32_i64(local_tid_28374)] =\n                x_24103;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_26983, res_24015)) {\n            ((__global bool *) mem_27763)[gtid_26983] = ((__local\n                                                          bool *) scan_arr_mem_28378)[sext_i32_i64(local_tid_28374)];\n            ((__global float *) mem_27765)[gtid_26983] = ((__local\n                                                           float *) scan_arr_mem_28380)[sext_i32_i64(local_tid_28374)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26979\n}\n__kernel void testziscan_stage2_27036(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28435_backing_aligned_0,\n                                      int64_t res_24015, __global\n                                      unsigned char *mem_27768,\n                                      int64_t stage1_num_groups_28407,\n                                      int32_t num_threads_28408)\n{\n    #define segscan_group_sizze_27031 (testzisegscan_group_sizze_27030)\n    \n    const int block_dim0 = 0;\n    const int block_dim1",
                   " = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28435_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28435_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28430;\n    int32_t local_tid_28431;\n    int64_t group_sizze_28434;\n    int32_t wave_sizze_28433;\n    int32_t group_tid_28432;\n    \n    global_tid_28430 = get_global_id(0);\n    local_tid_28431 = get_local_id(0);\n    group_sizze_28434 = get_local_size(0);\n    wave_sizze_28433 = LOCKSTEP_WIDTH;\n    group_tid_28432 = get_group_id(0);\n    \n    int32_t phys_tid_27036;\n    \n    phys_tid_27036 = global_tid_28430;\n    \n    __local char *scan_arr_mem_28435;\n    \n    scan_arr_mem_28435 = (__local char *) scan_arr_mem_28435_backing_0;\n    \n    int64_t flat_idx_28437;\n    \n    flat_idx_28437 = (sext_i32_i64(local_tid_28431) + 1) *\n        (segscan_group_sizze_27031 * sdiv_up64(res_24015,\n                                               sext_i32_i64(num_threads_28408))) -\n        1;\n    \n    int64_t gtid_27035;\n    \n    gtid_27035 = flat_idx_28437;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27035, res_24015)) {\n            ((__local\n              int64_t *) scan_arr_mem_28435)[sext_i32_i64(local_tid_28431)] =\n                ((__global int64_t *) mem_27768)[gtid_27035];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_28435)[sext_i32_i64(local_tid_28431)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_24201;\n    int64_t x_24202;\n    int64_t x_28438;\n    int64_t x_28439;\n    bool ltid_in_bounds_28441;\n    \n    ltid_in_bounds_28441 = slt64(sext_i32_i64(local_tid_28431),\n                                 stage1_num_groups_28407);\n    \n    int32_t skip_threads_28442;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28441) {\n            x_24202 = ((volatile __local\n",
                   "                        int64_t *) scan_arr_mem_28435)[sext_i32_i64(local_tid_28431)];\n            if ((local_tid_28431 - squot32(local_tid_28431, 32) * 32) == 0) {\n                x_24201 = x_24202;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28442 = 1;\n        while (slt32(skip_threads_28442, 32)) {\n            if (sle32(skip_threads_28442, local_tid_28431 -\n                      squot32(local_tid_28431, 32) * 32) &&\n                ltid_in_bounds_28441) {\n                // read operands\n                {\n                    x_24201 = ((volatile __local\n                                int64_t *) scan_arr_mem_28435)[sext_i32_i64(local_tid_28431) -\n                                                               sext_i32_i64(skip_threads_28442)];\n                }\n                // perform operation\n                {\n                    int64_t res_24203 = add64(x_24201, x_24202);\n                    \n                    x_24201 = res_24203;\n                }\n            }\n            if (sle32(wave_sizze_28433, skip_threads_28442)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28442, local_tid_28431 -\n                      squot32(local_tid_28431, 32) * 32) &&\n                ltid_in_bounds_28441) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28435)[sext_i32_i64(local_tid_28431)] =\n                        x_24201;\n                    x_24202 = x_24201;\n                }\n            }\n            if (sle32(wave_sizze_28433, skip_threads_28442)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28442 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28431 - squot32(local_tid_28431, 32) * 32) == 31 &&\n            ltid_in_bounds_284",
                   "41) {\n            ((volatile __local\n              int64_t *) scan_arr_mem_28435)[sext_i32_i64(squot32(local_tid_28431,\n                                                                  32))] =\n                x_24201;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28443;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28431, 32) == 0 && ltid_in_bounds_28441) {\n                x_28439 = ((volatile __local\n                            int64_t *) scan_arr_mem_28435)[sext_i32_i64(local_tid_28431)];\n                if ((local_tid_28431 - squot32(local_tid_28431, 32) * 32) ==\n                    0) {\n                    x_28438 = x_28439;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28443 = 1;\n            while (slt32(skip_threads_28443, 32)) {\n                if (sle32(skip_threads_28443, local_tid_28431 -\n                          squot32(local_tid_28431, 32) * 32) &&\n                    (squot32(local_tid_28431, 32) == 0 &&\n                     ltid_in_bounds_28441)) {\n                    // read operands\n                    {\n                        x_28438 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28435)[sext_i32_i64(local_tid_28431) -\n                                                                   sext_i32_i64(skip_threads_28443)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28440 = add64(x_28438, x_28439);\n                        \n                        x_28438 = res_28440;\n                    }\n                }\n                if (sle32(wave_sizze_28433, skip_threads_28443)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28443, loca",
                   "l_tid_28431 -\n                          squot32(local_tid_28431, 32) * 32) &&\n                    (squot32(local_tid_28431, 32) == 0 &&\n                     ltid_in_bounds_28441)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28435)[sext_i32_i64(local_tid_28431)] =\n                            x_28438;\n                        x_28439 = x_28438;\n                    }\n                }\n                if (sle32(wave_sizze_28433, skip_threads_28443)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28443 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28431, 32) == 0 || !ltid_in_bounds_28441)) {\n            // read operands\n            {\n                x_24202 = x_24201;\n                x_24201 = ((__local\n                            int64_t *) scan_arr_mem_28435)[sext_i32_i64(squot32(local_tid_28431,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_24203 = add64(x_24201, x_24202);\n                \n                x_24201 = res_24203;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_28435)[sext_i32_i64(local_tid_28431)] =\n                    x_24201;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28431, 32) == 0) {\n            ((__local\n              int64_t *) scan_arr_mem_28435)[sext_i32_i64(local_tid_28431)] =\n                x_24202;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n      ",
                   "  if (slt64(gtid_27035, res_24015)) {\n            ((__global int64_t *) mem_27768)[gtid_27035] = ((__local\n                                                             int64_t *) scan_arr_mem_28435)[sext_i32_i64(local_tid_28431)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27031\n}\n__kernel void testziscan_stage3_26935(__global int *global_failure,\n                                      int64_t num_groups_26932,\n                                      int64_t binop_x_27692, __global\n                                      unsigned char *mem_27740,\n                                      int32_t num_threads_27968,\n                                      int32_t required_groups_28004)\n{\n    #define segscan_group_sizze_26930 (testzisegscan_group_sizze_26929)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28005;\n    int32_t local_tid_28006;\n    int64_t group_sizze_28009;\n    int32_t wave_sizze_28008;\n    int32_t group_tid_28007;\n    \n    global_tid_28005 = get_global_id(0);\n    local_tid_28006 = get_local_id(0);\n    group_sizze_28009 = get_local_size(0);\n    wave_sizze_28008 = LOCKSTEP_WIDTH;\n    group_tid_28007 = get_group_id(0);\n    \n    int32_t phys_tid_26935;\n    \n    phys_tid_26935 = global_tid_28005;\n    \n    int32_t phys_group_id_28010;\n    \n    phys_group_id_28010 = get_group_id(0);\n    for (int32_t i_28011 = 0; i_28011 < sdiv_up32(required_groups_28004 -\n                                                  phys_group_id_28010,\n                                                  sext_i64_i32(num_groups_26932));\n         i_28011++) {\n        int32_t virt_group_id_28012 = phys_group_id_28010 + i_28011 *\n                sext_i64_i32(num_groups_26932);\n        int64_t flat_idx_28013 = sext_i32_i64(virt_group_id_28012) *\n                segscan_group_sizze_26930 + sext_i32_i64(local_tid_28006);\n        int64_t gtid_26934 = fl",
                   "at_idx_28013;\n        int64_t orig_group_28014 = squot64(flat_idx_28013,\n                                           segscan_group_sizze_26930 *\n                                           sdiv_up64(binop_x_27692,\n                                                     sext_i32_i64(num_threads_27968)));\n        int64_t carry_in_flat_idx_28015 = orig_group_28014 *\n                (segscan_group_sizze_26930 * sdiv_up64(binop_x_27692,\n                                                       sext_i32_i64(num_threads_27968))) -\n                1;\n        \n        if (slt64(gtid_26934, binop_x_27692)) {\n            if (!(orig_group_28014 == 0 || flat_idx_28013 == (orig_group_28014 +\n                                                              1) *\n                  (segscan_group_sizze_26930 * sdiv_up64(binop_x_27692,\n                                                         sext_i32_i64(num_threads_27968))) -\n                  1)) {\n                int64_t x_23999;\n                int64_t x_24000;\n                \n                x_23999 = ((__global\n                            int64_t *) mem_27740)[carry_in_flat_idx_28015];\n                x_24000 = ((__global int64_t *) mem_27740)[gtid_26934];\n                \n                int64_t res_24001;\n                \n                res_24001 = add64(x_23999, x_24000);\n                x_23999 = res_24001;\n                ((__global int64_t *) mem_27740)[gtid_26934] = x_23999;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26930\n}\n__kernel void testziscan_stage3_26968(__global int *global_failure,\n                                      int64_t res_24015,\n                                      int64_t num_groups_26965, __global\n                                      unsigned char *mem_27751, __global\n                                      unsigned char *mem_27753,\n                                      int32_t num_threads_28207,\n        ",
                   "                              int32_t required_groups_28259)\n{\n    #define segscan_group_sizze_26963 (testzisegscan_group_sizze_26962)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28260;\n    int32_t local_tid_28261;\n    int64_t group_sizze_28264;\n    int32_t wave_sizze_28263;\n    int32_t group_tid_28262;\n    \n    global_tid_28260 = get_global_id(0);\n    local_tid_28261 = get_local_id(0);\n    group_sizze_28264 = get_local_size(0);\n    wave_sizze_28263 = LOCKSTEP_WIDTH;\n    group_tid_28262 = get_group_id(0);\n    \n    int32_t phys_tid_26968;\n    \n    phys_tid_26968 = global_tid_28260;\n    \n    int32_t phys_group_id_28265;\n    \n    phys_group_id_28265 = get_group_id(0);\n    for (int32_t i_28266 = 0; i_28266 < sdiv_up32(required_groups_28259 -\n                                                  phys_group_id_28265,\n                                                  sext_i64_i32(num_groups_26965));\n         i_28266++) {\n        int32_t virt_group_id_28267 = phys_group_id_28265 + i_28266 *\n                sext_i64_i32(num_groups_26965);\n        int64_t flat_idx_28268 = sext_i32_i64(virt_group_id_28267) *\n                segscan_group_sizze_26963 + sext_i32_i64(local_tid_28261);\n        int64_t gtid_26967 = flat_idx_28268;\n        int64_t orig_group_28269 = squot64(flat_idx_28268,\n                                           segscan_group_sizze_26963 *\n                                           sdiv_up64(res_24015,\n                                                     sext_i32_i64(num_threads_28207)));\n        int64_t carry_in_flat_idx_28270 = orig_group_28269 *\n                (segscan_group_sizze_26963 * sdiv_up64(res_24015,\n                                                       sext_i32_i64(num_threads_28207))) -\n                1;\n        \n        if (slt64(gtid_26967, res_24015)) {\n            if (!(orig_group_28269 == 0 || flat_idx_28268 == (orig_",
                   "group_28269 +\n                                                              1) *\n                  (segscan_group_sizze_26963 * sdiv_up64(res_24015,\n                                                         sext_i32_i64(num_threads_28207))) -\n                  1)) {\n                bool x_24034;\n                int64_t x_24035;\n                bool x_24036;\n                int64_t x_24037;\n                \n                x_24034 = ((__global\n                            bool *) mem_27751)[carry_in_flat_idx_28270];\n                x_24035 = ((__global\n                            int64_t *) mem_27753)[carry_in_flat_idx_28270];\n                x_24036 = ((__global bool *) mem_27751)[gtid_26967];\n                x_24037 = ((__global int64_t *) mem_27753)[gtid_26967];\n                \n                bool res_24038;\n                \n                res_24038 = x_24034 || x_24036;\n                \n                int64_t res_24039;\n                \n                if (x_24036) {\n                    res_24039 = x_24037;\n                } else {\n                    int64_t res_24040 = add64(x_24035, x_24037);\n                    \n                    res_24039 = res_24040;\n                }\n                x_24034 = res_24038;\n                x_24035 = res_24039;\n                ((__global bool *) mem_27751)[gtid_26967] = x_24034;\n                ((__global int64_t *) mem_27753)[gtid_26967] = x_24035;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26963\n}\n__kernel void testziscan_stage3_26976(__global int *global_failure,\n                                      int64_t res_24015,\n                                      int64_t num_groups_26973, __global\n                                      unsigned char *mem_27756, __global\n                                      unsigned char *mem_27758,\n                                      int32_t num_threads_28274,\n                           ",
                   "           int32_t required_groups_28326)\n{\n    #define segscan_group_sizze_26971 (testzisegscan_group_sizze_26970)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28327;\n    int32_t local_tid_28328;\n    int64_t group_sizze_28331;\n    int32_t wave_sizze_28330;\n    int32_t group_tid_28329;\n    \n    global_tid_28327 = get_global_id(0);\n    local_tid_28328 = get_local_id(0);\n    group_sizze_28331 = get_local_size(0);\n    wave_sizze_28330 = LOCKSTEP_WIDTH;\n    group_tid_28329 = get_group_id(0);\n    \n    int32_t phys_tid_26976;\n    \n    phys_tid_26976 = global_tid_28327;\n    \n    int32_t phys_group_id_28332;\n    \n    phys_group_id_28332 = get_group_id(0);\n    for (int32_t i_28333 = 0; i_28333 < sdiv_up32(required_groups_28326 -\n                                                  phys_group_id_28332,\n                                                  sext_i64_i32(num_groups_26973));\n         i_28333++) {\n        int32_t virt_group_id_28334 = phys_group_id_28332 + i_28333 *\n                sext_i64_i32(num_groups_26973);\n        int64_t flat_idx_28335 = sext_i32_i64(virt_group_id_28334) *\n                segscan_group_sizze_26971 + sext_i32_i64(local_tid_28328);\n        int64_t gtid_26975 = flat_idx_28335;\n        int64_t orig_group_28336 = squot64(flat_idx_28335,\n                                           segscan_group_sizze_26971 *\n                                           sdiv_up64(res_24015,\n                                                     sext_i32_i64(num_threads_28274)));\n        int64_t carry_in_flat_idx_28337 = orig_group_28336 *\n                (segscan_group_sizze_26971 * sdiv_up64(res_24015,\n                                                       sext_i32_i64(num_threads_28274))) -\n                1;\n        \n        if (slt64(gtid_26975, res_24015)) {\n            if (!(orig_group_28336 == 0 || flat_idx_28335 == (orig_group_28336 +\n     ",
                   "                                                         1) *\n                  (segscan_group_sizze_26971 * sdiv_up64(res_24015,\n                                                         sext_i32_i64(num_threads_28274))) -\n                  1)) {\n                bool x_24074;\n                int64_t x_24075;\n                bool x_24076;\n                int64_t x_24077;\n                \n                x_24074 = ((__global\n                            bool *) mem_27756)[carry_in_flat_idx_28337];\n                x_24075 = ((__global\n                            int64_t *) mem_27758)[carry_in_flat_idx_28337];\n                x_24076 = ((__global bool *) mem_27756)[gtid_26975];\n                x_24077 = ((__global int64_t *) mem_27758)[gtid_26975];\n                \n                bool res_24078;\n                \n                res_24078 = x_24074 || x_24076;\n                \n                int64_t res_24079;\n                \n                if (x_24076) {\n                    res_24079 = x_24077;\n                } else {\n                    int64_t res_24080 = add64(x_24075, x_24077);\n                    \n                    res_24079 = res_24080;\n                }\n                x_24074 = res_24078;\n                x_24075 = res_24079;\n                ((__global bool *) mem_27756)[gtid_26975] = x_24074;\n                ((__global int64_t *) mem_27758)[gtid_26975] = x_24075;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26971\n}\n__kernel void testziscan_stage3_26984(__global int *global_failure,\n                                      int64_t res_24015,\n                                      int64_t num_groups_26981, __global\n                                      unsigned char *mem_27763, __global\n                                      unsigned char *mem_27765,\n                                      int32_t num_threads_28341,\n                                      int32_t ",
                   "required_groups_28393)\n{\n    #define segscan_group_sizze_26979 (testzisegscan_group_sizze_26978)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28394;\n    int32_t local_tid_28395;\n    int64_t group_sizze_28398;\n    int32_t wave_sizze_28397;\n    int32_t group_tid_28396;\n    \n    global_tid_28394 = get_global_id(0);\n    local_tid_28395 = get_local_id(0);\n    group_sizze_28398 = get_local_size(0);\n    wave_sizze_28397 = LOCKSTEP_WIDTH;\n    group_tid_28396 = get_group_id(0);\n    \n    int32_t phys_tid_26984;\n    \n    phys_tid_26984 = global_tid_28394;\n    \n    int32_t phys_group_id_28399;\n    \n    phys_group_id_28399 = get_group_id(0);\n    for (int32_t i_28400 = 0; i_28400 < sdiv_up32(required_groups_28393 -\n                                                  phys_group_id_28399,\n                                                  sext_i64_i32(num_groups_26981));\n         i_28400++) {\n        int32_t virt_group_id_28401 = phys_group_id_28399 + i_28400 *\n                sext_i64_i32(num_groups_26981);\n        int64_t flat_idx_28402 = sext_i32_i64(virt_group_id_28401) *\n                segscan_group_sizze_26979 + sext_i32_i64(local_tid_28395);\n        int64_t gtid_26983 = flat_idx_28402;\n        int64_t orig_group_28403 = squot64(flat_idx_28402,\n                                           segscan_group_sizze_26979 *\n                                           sdiv_up64(res_24015,\n                                                     sext_i32_i64(num_threads_28341)));\n        int64_t carry_in_flat_idx_28404 = orig_group_28403 *\n                (segscan_group_sizze_26979 * sdiv_up64(res_24015,\n                                                       sext_i32_i64(num_threads_28341))) -\n                1;\n        \n        if (slt64(gtid_26983, res_24015)) {\n            if (!(orig_group_28403 == 0 || flat_idx_28402 == (orig_group_28403 +\n                        ",
                   "                                      1) *\n                  (segscan_group_sizze_26979 * sdiv_up64(res_24015,\n                                                         sext_i32_i64(num_threads_28341))) -\n                  1)) {\n                bool x_24100;\n                float x_24101;\n                bool x_24102;\n                float x_24103;\n                \n                x_24100 = ((__global\n                            bool *) mem_27763)[carry_in_flat_idx_28404];\n                x_24101 = ((__global\n                            float *) mem_27765)[carry_in_flat_idx_28404];\n                x_24102 = ((__global bool *) mem_27763)[gtid_26983];\n                x_24103 = ((__global float *) mem_27765)[gtid_26983];\n                \n                bool res_24104;\n                \n                res_24104 = x_24100 || x_24102;\n                \n                float res_24105;\n                \n                if (x_24102) {\n                    res_24105 = x_24103;\n                } else {\n                    float res_24106 = x_24101 + x_24103;\n                    \n                    res_24105 = res_24106;\n                }\n                x_24100 = res_24104;\n                x_24101 = res_24105;\n                ((__global bool *) mem_27763)[gtid_26983] = x_24100;\n                ((__global float *) mem_27765)[gtid_26983] = x_24101;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26979\n}\n__kernel void testziscan_stage3_27036(__global int *global_failure,\n                                      int64_t res_24015,\n                                      int64_t num_groups_27033, __global\n                                      unsigned char *mem_27768,\n                                      int32_t num_threads_28408,\n                                      int32_t required_groups_28444)\n{\n    #define segscan_group_sizze_27031 (testzisegscan_group_sizze_27030)\n    \n    const ",
                   "int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28445;\n    int32_t local_tid_28446;\n    int64_t group_sizze_28449;\n    int32_t wave_sizze_28448;\n    int32_t group_tid_28447;\n    \n    global_tid_28445 = get_global_id(0);\n    local_tid_28446 = get_local_id(0);\n    group_sizze_28449 = get_local_size(0);\n    wave_sizze_28448 = LOCKSTEP_WIDTH;\n    group_tid_28447 = get_group_id(0);\n    \n    int32_t phys_tid_27036;\n    \n    phys_tid_27036 = global_tid_28445;\n    \n    int32_t phys_group_id_28450;\n    \n    phys_group_id_28450 = get_group_id(0);\n    for (int32_t i_28451 = 0; i_28451 < sdiv_up32(required_groups_28444 -\n                                                  phys_group_id_28450,\n                                                  sext_i64_i32(num_groups_27033));\n         i_28451++) {\n        int32_t virt_group_id_28452 = phys_group_id_28450 + i_28451 *\n                sext_i64_i32(num_groups_27033);\n        int64_t flat_idx_28453 = sext_i32_i64(virt_group_id_28452) *\n                segscan_group_sizze_27031 + sext_i32_i64(local_tid_28446);\n        int64_t gtid_27035 = flat_idx_28453;\n        int64_t orig_group_28454 = squot64(flat_idx_28453,\n                                           segscan_group_sizze_27031 *\n                                           sdiv_up64(res_24015,\n                                                     sext_i32_i64(num_threads_28408)));\n        int64_t carry_in_flat_idx_28455 = orig_group_28454 *\n                (segscan_group_sizze_27031 * sdiv_up64(res_24015,\n                                                       sext_i32_i64(num_threads_28408))) -\n                1;\n        \n        if (slt64(gtid_27035, res_24015)) {\n            if (!(orig_group_28454 == 0 || flat_idx_28453 == (orig_group_28454 +\n                                                              1) *\n                  (segscan_group_sizze_27031 * sdiv_up64(res_24015,\n ",
                   "                                                        sext_i32_i64(num_threads_28408))) -\n                  1)) {\n                int64_t x_24201;\n                int64_t x_24202;\n                \n                x_24201 = ((__global\n                            int64_t *) mem_27768)[carry_in_flat_idx_28455];\n                x_24202 = ((__global int64_t *) mem_27768)[gtid_27035];\n                \n                int64_t res_24203;\n                \n                res_24203 = add64(x_24201, x_24202);\n                x_24201 = res_24203;\n                ((__global int64_t *) mem_27768)[gtid_27035] = x_24201;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27031\n}\n__kernel void testziseghist_global_26953(__global int *global_failure,\n                                         int64_t res_24015,\n                                         int64_t num_groups_26950,\n                                         int64_t binop_x_27692, __global\n                                         unsigned char *mem_27740,\n                                         int32_t num_subhistos_28057, __global\n                                         unsigned char *res_subhistos_mem_28058,\n                                         __global\n                                         unsigned char *testzihist_locks_mem_28128,\n                                         int32_t chk_i_28130,\n                                         int64_t hist_H_chk_28131)\n{\n    #define seghist_group_sizze_26948 (testziseghist_group_sizze_26947)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28132;\n    int32_t local_tid_28133;\n    int64_t group_sizze_28136;\n    int32_t wave_sizze_28135;\n    int32_t group_tid_28134;\n    \n    global_tid_28132 = get_global_id(0);\n    local_tid_28133 = get_local_id(0);\n    gro",
                   "up_sizze_28136 = get_local_size(0);\n    wave_sizze_28135 = LOCKSTEP_WIDTH;\n    group_tid_28134 = get_group_id(0);\n    \n    int32_t phys_tid_26953;\n    \n    phys_tid_26953 = global_tid_28132;\n    \n    int32_t subhisto_ind_28137;\n    \n    subhisto_ind_28137 = squot32(global_tid_28132,\n                                 sdiv_up32(sext_i64_i32(seghist_group_sizze_26948 *\n                                           num_groups_26950),\n                                           num_subhistos_28057));\n    for (int64_t i_28138 = 0; i_28138 < sdiv_up64(binop_x_27692 -\n                                                  sext_i32_i64(global_tid_28132),\n                                                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_26948 *\n                                                  num_groups_26950)));\n         i_28138++) {\n        int32_t gtid_26952 = sext_i64_i32(i_28138 *\n                sext_i32_i64(sext_i64_i32(seghist_group_sizze_26948 *\n                num_groups_26950)) + sext_i32_i64(global_tid_28132));\n        \n        if (slt64(i_28138 *\n                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_26948 *\n                  num_groups_26950)) + sext_i32_i64(global_tid_28132),\n                  binop_x_27692)) {\n            int64_t i_p_o_27547 = add64(-1, gtid_26952);\n            int64_t rot_i_27548 = smod64(i_p_o_27547, binop_x_27692);\n            bool cond_26959 = gtid_26952 == 0;\n            int64_t res_26960;\n            \n            if (cond_26959) {\n                res_26960 = 0;\n            } else {\n                int64_t x_26958 = ((__global int64_t *) mem_27740)[rot_i_27548];\n                \n                res_26960 = x_26958;\n            }\n            // save map-out results\n            { }\n            // perform atomic updates\n            {\n                if (sle64(sext_i32_i64(chk_i_28130) * hist_H_chk_28131,\n                          res_26960) && (slt64(res_26960,\n                                               sext_i32_i64(chk_i_28",
                   "130) *\n                                               hist_H_chk_28131 +\n                                               hist_H_chk_28131) &&\n                                         slt64(res_26960, res_24015))) {\n                    int64_t x_26954;\n                    int64_t x_26955;\n                    \n                    x_26955 = gtid_26952;\n                    \n                    int32_t old_28139;\n                    volatile bool continue_28140;\n                    \n                    continue_28140 = 1;\n                    while (continue_28140) {\n                        old_28139 =\n                            atomic_cmpxchg_i32_global(&((volatile __global\n                                                         int *) testzihist_locks_mem_28128)[srem64(sext_i32_i64(subhisto_ind_28137) *\n                                                                                                   res_24015 +\n                                                                                                   res_26960,\n                                                                                                   100151)],\n                                                      0, 1);\n                        if (old_28139 == 0) {\n                            int64_t x_26954;\n                            \n                            // bind lhs\n                            {\n                                x_26954 = ((volatile __global\n                                            int64_t *) res_subhistos_mem_28058)[sext_i32_i64(subhisto_ind_28137) *\n                                                                                res_24015 +\n                                                                                res_26960];\n                            }\n                            // execute operation\n                            {\n                                int64_t res_26956 = smax64(x_26954, x_26955);\n                                \n                          ",
                   "      x_26954 = res_26956;\n                            }\n                            // update global result\n                            {\n                                ((volatile __global\n                                  int64_t *) res_subhistos_mem_28058)[sext_i32_i64(subhisto_ind_28137) *\n                                                                      res_24015 +\n                                                                      res_26960] =\n                                    x_26954;\n                            }\n                            mem_fence_global();\n                            old_28139 =\n                                atomic_cmpxchg_i32_global(&((volatile __global\n                                                             int *) testzihist_locks_mem_28128)[srem64(sext_i32_i64(subhisto_ind_28137) *\n                                                                                                       res_24015 +\n                                                                                                       res_26960,\n                                                                                                       100151)],\n                                                          1, 0);\n                            continue_28140 = 0;\n                        }\n                        mem_fence_global();\n                    }\n                }\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef seghist_group_sizze_26948\n}\n__kernel void testziseghist_local_26953(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *locks_mem_28098_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *subhistogram_local_mem_28096_backing_aligned_1,\n                                        int64_t res_24015,\n                                        int64_t binop_x_27692, __global\n ",
                   "                                       unsigned char *mem_27740, __global\n                                        unsigned char *res_subhistos_mem_28058,\n                                        int32_t max_group_sizze_28067,\n                                        int64_t num_groups_28068,\n                                        int32_t hist_M_28074,\n                                        int32_t chk_i_28079,\n                                        int64_t num_segments_28080,\n                                        int64_t hist_H_chk_28081,\n                                        int64_t histo_sizze_28082,\n                                        int32_t init_per_thread_28083)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict locks_mem_28098_backing_1 =\n                          (__local volatile\n                           char *) locks_mem_28098_backing_aligned_0;\n    __local volatile char *restrict subhistogram_local_mem_28096_backing_0 =\n                          (__local volatile\n                           char *) subhistogram_local_mem_28096_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28084;\n    int32_t local_tid_28085;\n    int64_t group_sizze_28088;\n    int32_t wave_sizze_28087;\n    int32_t group_tid_28086;\n    \n    global_tid_28084 = get_global_id(0);\n    local_tid_28085 = get_local_id(0);\n    group_sizze_28088 = get_local_size(0);\n    wave_sizze_28087 = LOCKSTEP_WIDTH;\n    group_tid_28086 = get_group_id(0);\n    \n    int32_t phys_tid_26953;\n    \n    phys_tid_26953 = global_tid_28084;\n    \n    int32_t phys_group_id_28089;\n    \n    phys_group_id_28089 = get_group_id(0);\n    for (int32_t i_28090 = 0; i_28090 <\n         sdiv_up32(sext_i64_i32(num_groups_28068 * num_segments_28080) -\n                   phys_group_id_28089, sext_i64_i32(num_groups_28068));\n         i_28090++) {\n        int32_t virt_group_id_28091 = phys_group_id_28089 ",
                   "+ i_28090 *\n                sext_i64_i32(num_groups_28068);\n        int32_t flat_segment_id_28092 = squot32(virt_group_id_28091,\n                                                sext_i64_i32(num_groups_28068));\n        int32_t gid_in_segment_28093 = srem32(virt_group_id_28091,\n                                              sext_i64_i32(num_groups_28068));\n        int32_t pgtid_in_segment_28094 = gid_in_segment_28093 *\n                sext_i64_i32(max_group_sizze_28067) + local_tid_28085;\n        int32_t threads_per_segment_28095 = sext_i64_i32(num_groups_28068 *\n                max_group_sizze_28067);\n        __local char *subhistogram_local_mem_28096;\n        \n        subhistogram_local_mem_28096 = (__local\n                                        char *) subhistogram_local_mem_28096_backing_0;\n        \n        __local char *locks_mem_28098;\n        \n        locks_mem_28098 = (__local char *) locks_mem_28098_backing_1;\n        // All locks start out unlocked\n        {\n            for (int64_t i_28100 = 0; i_28100 < sdiv_up64(hist_M_28074 *\n                                                          hist_H_chk_28081 -\n                                                          sext_i32_i64(local_tid_28085),\n                                                          max_group_sizze_28067);\n                 i_28100++) {\n                ((__local int32_t *) locks_mem_28098)[squot64(i_28100 *\n                                                              max_group_sizze_28067 +\n                                                              sext_i32_i64(local_tid_28085),\n                                                              hist_H_chk_28081) *\n                                                      hist_H_chk_28081 +\n                                                      (i_28100 *\n                                                       max_group_sizze_28067 +\n                                                       sext_i32_i64(local_tid_28085) -\n                               ",
                   "                        squot64(i_28100 *\n                                                               max_group_sizze_28067 +\n                                                               sext_i32_i64(local_tid_28085),\n                                                               hist_H_chk_28081) *\n                                                       hist_H_chk_28081)] = 0;\n            }\n        }\n        \n        int32_t thread_local_subhisto_i_28101;\n        \n        thread_local_subhisto_i_28101 = srem32(local_tid_28085, hist_M_28074);\n        // initialize histograms in local memory\n        {\n            for (int32_t local_i_28102 = 0; local_i_28102 <\n                 init_per_thread_28083; local_i_28102++) {\n                int32_t j_28103 = local_i_28102 *\n                        sext_i64_i32(max_group_sizze_28067) + local_tid_28085;\n                int32_t j_offset_28104 = hist_M_28074 *\n                        sext_i64_i32(histo_sizze_28082) * gid_in_segment_28093 +\n                        j_28103;\n                int32_t local_subhisto_i_28105 = squot32(j_28103,\n                                                         sext_i64_i32(histo_sizze_28082));\n                int32_t global_subhisto_i_28106 = squot32(j_offset_28104,\n                                                          sext_i64_i32(histo_sizze_28082));\n                \n                if (slt32(j_28103, hist_M_28074 *\n                          sext_i64_i32(histo_sizze_28082))) {\n                    // First subhistogram is initialised from global memory; others with neutral element.\n                    {\n                        if (global_subhisto_i_28106 == 0) {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_28096)[sext_i32_i64(local_subhisto_i_28105) *\n                                                                       hist_H_chk_28081 +\n                                                                       sext_i32_i64(srem32(j",
                   "_28103,\n                                                                                           sext_i64_i32(histo_sizze_28082)))] =\n                                ((__global\n                                  int64_t *) res_subhistos_mem_28058)[sext_i32_i64(srem32(j_28103,\n                                                                                          sext_i64_i32(histo_sizze_28082))) +\n                                                                      sext_i32_i64(chk_i_28079) *\n                                                                      hist_H_chk_28081];\n                        } else {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_28096)[sext_i32_i64(local_subhisto_i_28105) *\n                                                                       hist_H_chk_28081 +\n                                                                       sext_i32_i64(srem32(j_28103,\n                                                                                           sext_i64_i32(histo_sizze_28082)))] =\n                                0;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_28107 = 0; i_28107 <\n             sdiv_up32(sext_i64_i32(binop_x_27692) - pgtid_in_segment_28094,\n                       threads_per_segment_28095); i_28107++) {\n            int32_t gtid_26952 = i_28107 * threads_per_segment_28095 +\n                    pgtid_in_segment_28094;\n            int64_t i_p_o_27547 = add64(-1, gtid_26952);\n            int64_t rot_i_27548 = smod64(i_p_o_27547, binop_x_27692);\n            bool cond_26959 = gtid_26952 == 0;\n            int64_t res_26960;\n            \n            if (cond_26959) {\n                res_26960 = 0;\n            } else {\n                int64_t x_26958 = ((__global int64_t *) mem_27740)[rot_i_27548];\n                \n                res_26960 = x_26958;\n            ",
                   "}\n            if (chk_i_28079 == 0) {\n                // save map-out results\n                { }\n            }\n            // perform atomic updates\n            {\n                if (slt64(res_26960, res_24015) &&\n                    (sle64(sext_i32_i64(chk_i_28079) * hist_H_chk_28081,\n                           res_26960) && slt64(res_26960,\n                                               sext_i32_i64(chk_i_28079) *\n                                               hist_H_chk_28081 +\n                                               hist_H_chk_28081))) {\n                    int64_t x_26954;\n                    int64_t x_26955;\n                    \n                    x_26955 = gtid_26952;\n                    \n                    int32_t old_28108;\n                    volatile bool continue_28109;\n                    \n                    continue_28109 = 1;\n                    while (continue_28109) {\n                        old_28108 = atomic_cmpxchg_i32_local(&((volatile __local\n                                                                int *) locks_mem_28098)[sext_i32_i64(thread_local_subhisto_i_28101) *\n                                                                                        hist_H_chk_28081 +\n                                                                                        (res_26960 -\n                                                                                         sext_i32_i64(chk_i_28079) *\n                                                                                         hist_H_chk_28081)],\n                                                             0, 1);\n                        if (old_28108 == 0) {\n                            int64_t x_26954;\n                            \n                            // bind lhs\n                            {\n                                x_26954 = ((volatile __local\n                                            int64_t *) subhistogram_local_mem_28096)[sext_i32_i64(thread_local_subhisto_i_2",
                   "8101) *\n                                                                                     hist_H_chk_28081 +\n                                                                                     (res_26960 -\n                                                                                      sext_i32_i64(chk_i_28079) *\n                                                                                      hist_H_chk_28081)];\n                            }\n                            // execute operation\n                            {\n                                int64_t res_26956 = smax64(x_26954, x_26955);\n                                \n                                x_26954 = res_26956;\n                            }\n                            // update global result\n                            {\n                                ((volatile __local\n                                  int64_t *) subhistogram_local_mem_28096)[sext_i32_i64(thread_local_subhisto_i_28101) *\n                                                                           hist_H_chk_28081 +\n                                                                           (res_26960 -\n                                                                            sext_i32_i64(chk_i_28079) *\n                                                                            hist_H_chk_28081)] =\n                                    x_26954;\n                            }\n                            mem_fence_local();\n                            old_28108 =\n                                atomic_cmpxchg_i32_local(&((volatile __local\n                                                            int *) locks_mem_28098)[sext_i32_i64(thread_local_subhisto_i_28101) *\n                                                                                    hist_H_chk_28081 +\n                                                                                    (res_26960 -\n                                                             ",
                   "                        sext_i32_i64(chk_i_28079) *\n                                                                                     hist_H_chk_28081)],\n                                                         1, 0);\n                            continue_28109 = 0;\n                        }\n                        mem_fence_local();\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Compact the multiple local memory subhistograms to result in global memory\n        {\n            int64_t trunc_H_28110 = smin64(hist_H_chk_28081, res_24015 -\n                                           sext_i32_i64(chk_i_28079) *\n                                           hist_H_chk_28081);\n            int32_t histo_sizze_28111 = sext_i64_i32(trunc_H_28110);\n            \n            for (int32_t local_i_28112 = 0; local_i_28112 <\n                 init_per_thread_28083; local_i_28112++) {\n                int32_t j_28113 = local_i_28112 *\n                        sext_i64_i32(max_group_sizze_28067) + local_tid_28085;\n                \n                if (slt32(j_28113, histo_sizze_28111)) {\n                    int64_t x_26954;\n                    int64_t x_26955;\n                    \n                    // Read values from subhistogram 0.\n                    {\n                        x_26954 = ((__local\n                                    int64_t *) subhistogram_local_mem_28096)[sext_i32_i64(j_28113)];\n                    }\n                    // Accumulate based on values in other subhistograms.\n                    {\n                        for (int32_t subhisto_id_28114 = 0; subhisto_id_28114 <\n                             hist_M_28074 - 1; subhisto_id_28114++) {\n                            x_26955 = ((__local\n                                        int64_t *) subhistogram_local_mem_28096)[(sext_i32_i64(subhisto_id_28114) +\n                                                                                  1) *\n                 ",
                   "                                                                hist_H_chk_28081 +\n                                                                                 sext_i32_i64(j_28113)];\n                            \n                            int64_t res_26956;\n                            \n                            res_26956 = smax64(x_26954, x_26955);\n                            x_26954 = res_26956;\n                        }\n                    }\n                    // Put final bucket value in global memory.\n                    {\n                        ((__global\n                          int64_t *) res_subhistos_mem_28058)[srem64(sext_i32_i64(virt_group_id_28091),\n                                                                     num_groups_28068) *\n                                                              res_24015 +\n                                                              (sext_i32_i64(j_28113) +\n                                                               sext_i32_i64(chk_i_28079) *\n                                                               hist_H_chk_28081)] =\n                            x_26954;\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\n__kernel void testzisegmap_25881(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, __global\n                                 unsigned char *mem_27636, __global\n                                 unsigned char *mem_27638, __global\n                                 unsigned char *mem_27650)\n{\n    #define segmap_group_sizze_25947 (testzisegmap_group_sizze_25883)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27907;\n    int32_t local_tid_27908;\n    int64_t grou",
                   "p_sizze_27911;\n    int32_t wave_sizze_27910;\n    int32_t group_tid_27909;\n    \n    global_tid_27907 = get_global_id(0);\n    local_tid_27908 = get_local_id(0);\n    group_sizze_27911 = get_local_size(0);\n    wave_sizze_27910 = LOCKSTEP_WIDTH;\n    group_tid_27909 = get_group_id(0);\n    \n    int32_t phys_tid_25881;\n    \n    phys_tid_25881 = global_tid_27907;\n    \n    int64_t gtid_25880;\n    \n    gtid_25880 = sext_i32_i64(group_tid_27909) * segmap_group_sizze_25947 +\n        sext_i32_i64(local_tid_27908);\n    if (slt64(gtid_25880, 45)) {\n        float res_25958 = ((__global float *) mem_27638)[gtid_25880];\n        int64_t res_25959 = ((__global int64_t *) mem_27636)[gtid_25880];\n        bool bounds_invalid_upwards_25961 = slt64(res_25959, 1);\n        bool valid_25962 = !bounds_invalid_upwards_25961;\n        bool range_valid_c_25963;\n        \n        if (!valid_25962) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 9) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = 2;\n                    global_failure_args[2] = res_25959;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        bool y_25965 = slt64(0, res_25959);\n        bool index_certs_25966;\n        \n        if (!y_25965) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 10) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_25959;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_25967 = sitofp_i64_f32(res_25959);\n        float index_primexp_25968 = res_25958 * binop_y_25967;\n        float negate_arg_25969 = 1.0e-2F * index_primexp_25968;\n        float exp_arg_25970 = 0.0F - negate_arg_25969;\n        float res_25971 = fpow32(2.7182817F, exp_arg_25970);\n        float x_25972 = 1.0F - res_25971;\n        float B_25973 = x_25972 / 1.0",
                   "e-2F;\n        float x_25974 = B_25973 - index_primexp_25968;\n        float x_25975 = 4.4999997e-6F * x_25974;\n        float A1_25976 = x_25975 / 1.0e-4F;\n        float y_25977 = fpow32(B_25973, 2.0F);\n        float x_25978 = 1.0000001e-6F * y_25977;\n        float A2_25979 = x_25978 / 4.0e-2F;\n        float exp_arg_25980 = A1_25976 - A2_25979;\n        float res_25981 = fpow32(2.7182817F, exp_arg_25980);\n        float negate_arg_25982 = 5.0e-2F * B_25973;\n        float exp_arg_25983 = 0.0F - negate_arg_25982;\n        float res_25984 = fpow32(2.7182817F, exp_arg_25983);\n        float res_25985 = res_25981 * res_25984;\n        float res_25986;\n        float redout_27455 = 0.0F;\n        \n        for (int64_t i_27456 = 0; i_27456 < res_25959; i_27456++) {\n            int64_t index_primexp_27574 = add64(1, i_27456);\n            float res_25991 = sitofp_i64_f32(index_primexp_27574);\n            float res_25992 = res_25958 * res_25991;\n            float negate_arg_25993 = 1.0e-2F * res_25992;\n            float exp_arg_25994 = 0.0F - negate_arg_25993;\n            float res_25995 = fpow32(2.7182817F, exp_arg_25994);\n            float x_25996 = 1.0F - res_25995;\n            float B_25997 = x_25996 / 1.0e-2F;\n            float x_25998 = B_25997 - res_25992;\n            float x_25999 = 4.4999997e-6F * x_25998;\n            float A1_26000 = x_25999 / 1.0e-4F;\n            float y_26001 = fpow32(B_25997, 2.0F);\n            float x_26002 = 1.0000001e-6F * y_26001;\n            float A2_26003 = x_26002 / 4.0e-2F;\n            float exp_arg_26004 = A1_26000 - A2_26003;\n            float res_26005 = fpow32(2.7182817F, exp_arg_26004);\n            float negate_arg_26006 = 5.0e-2F * B_25997;\n            float exp_arg_26007 = 0.0F - negate_arg_26006;\n            float res_26008 = fpow32(2.7182817F, exp_arg_26007);\n            float res_26009 = res_26005 * res_26008;\n            float res_25989 = res_26009 + redout_27455;\n            float redout_tmp_27912 = res_25989;\n            \n            ",
                   "redout_27455 = redout_tmp_27912;\n        }\n        res_25986 = redout_27455;\n        \n        float x_26010 = 1.0F - res_25985;\n        float y_26011 = res_25958 * res_25986;\n        float res_26012 = x_26010 / y_26011;\n        \n        ((__global float *) mem_27650)[gtid_25880] = res_26012;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25947\n}\n__kernel void testzisegmap_26030(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, __global\n                                 unsigned char *mem_27636, __global\n                                 unsigned char *mem_27638, __global\n                                 unsigned char *mem_27659)\n{\n    #define segmap_group_sizze_26096 (testzisegmap_group_sizze_26032)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27913;\n    int32_t local_tid_27914;\n    int64_t group_sizze_27917;\n    int32_t wave_sizze_27916;\n    int32_t group_tid_27915;\n    \n    global_tid_27913 = get_global_id(0);\n    local_tid_27914 = get_local_id(0);\n    group_sizze_27917 = get_local_size(0);\n    wave_sizze_27916 = LOCKSTEP_WIDTH;\n    group_tid_27915 = get_group_id(0);\n    \n    int32_t phys_tid_26030;\n    \n    phys_tid_26030 = global_tid_27913;\n    \n    int64_t gtid_26029;\n    \n    gtid_26029 = sext_i32_i64(group_tid_27915) * segmap_group_sizze_26096 +\n        sext_i32_i64(local_tid_27914);\n    if (slt64(gtid_26029, 45)) {\n        float res_26107 = ((__global float *) mem_27638)[gtid_26029];\n        int64_t res_26108 = ((__global int64_t *) mem_27636)[gtid_26029];\n        bool bounds_invalid_upwards_26110 = slt64(res_26108, 1);\n        bool valid_26111 = !bounds_invalid_upwards_26110;\n        bool range_valid_c_26112;\n        \n        if (!valid_26111) {\n            {\n                if (atomic_cmpxchg_i32_global(gl",
                   "obal_failure, -1, 11) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = 2;\n                    global_failure_args[2] = res_26108;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        bool y_26114 = slt64(0, res_26108);\n        bool index_certs_26115;\n        \n        if (!y_26114) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 12) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_26108;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_26116 = sitofp_i64_f32(res_26108);\n        float index_primexp_26117 = res_26107 * binop_y_26116;\n        float negate_arg_26118 = 1.0e-2F * index_primexp_26117;\n        float exp_arg_26119 = 0.0F - negate_arg_26118;\n        float res_26120 = fpow32(2.7182817F, exp_arg_26119);\n        float x_26121 = 1.0F - res_26120;\n        float B_26122 = x_26121 / 1.0e-2F;\n        float x_26123 = B_26122 - index_primexp_26117;\n        float x_26124 = 4.4999997e-6F * x_26123;\n        float A1_26125 = x_26124 / 1.0e-4F;\n        float y_26126 = fpow32(B_26122, 2.0F);\n        float x_26127 = 1.0000001e-6F * y_26126;\n        float A2_26128 = x_26127 / 4.0e-2F;\n        float exp_arg_26129 = A1_26125 - A2_26128;\n        float res_26130 = fpow32(2.7182817F, exp_arg_26129);\n        float negate_arg_26131 = 5.0e-2F * B_26122;\n        float exp_arg_26132 = 0.0F - negate_arg_26131;\n        float res_26133 = fpow32(2.7182817F, exp_arg_26132);\n        float res_26134 = res_26130 * res_26133;\n        float res_26135;\n        float redout_27459 = 0.0F;\n        \n        for (int64_t i_27460 = 0; i_27460 < res_26108; i_27460++) {\n            int64_t index_primexp_27576 = add64(1, i_27460);\n            float res_26140 = sitofp_i64_f32(index_primexp_27576);\n            float res_26141 = res_26107 * res_2614",
                   "0;\n            float negate_arg_26142 = 1.0e-2F * res_26141;\n            float exp_arg_26143 = 0.0F - negate_arg_26142;\n            float res_26144 = fpow32(2.7182817F, exp_arg_26143);\n            float x_26145 = 1.0F - res_26144;\n            float B_26146 = x_26145 / 1.0e-2F;\n            float x_26147 = B_26146 - res_26141;\n            float x_26148 = 4.4999997e-6F * x_26147;\n            float A1_26149 = x_26148 / 1.0e-4F;\n            float y_26150 = fpow32(B_26146, 2.0F);\n            float x_26151 = 1.0000001e-6F * y_26150;\n            float A2_26152 = x_26151 / 4.0e-2F;\n            float exp_arg_26153 = A1_26149 - A2_26152;\n            float res_26154 = fpow32(2.7182817F, exp_arg_26153);\n            float negate_arg_26155 = 5.0e-2F * B_26146;\n            float exp_arg_26156 = 0.0F - negate_arg_26155;\n            float res_26157 = fpow32(2.7182817F, exp_arg_26156);\n            float res_26158 = res_26154 * res_26157;\n            float res_26138 = res_26158 + redout_27459;\n            float redout_tmp_27918 = res_26138;\n            \n            redout_27459 = redout_tmp_27918;\n        }\n        res_26135 = redout_27459;\n        \n        float x_26159 = 1.0F - res_26134;\n        float y_26160 = res_26107 * res_26135;\n        float res_26161 = x_26159 / y_26160;\n        \n        ((__global float *) mem_27659)[gtid_26029] = res_26161;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26096\n}\n__kernel void testzisegmap_26508(__global int *global_failure,\n                                 int64_t paths_23826, int64_t steps_23827,\n                                 float sims_per_year_23906, __global\n                                 unsigned char *mem_27735)\n{\n    #define segmap_group_sizze_26918 (testzisegmap_group_sizze_26512)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27959;\n    int32_t local_tid_27960;\n    int64_t group_sizze_2",
                   "7963;\n    int32_t wave_sizze_27962;\n    int32_t group_tid_27961;\n    \n    global_tid_27959 = get_global_id(0);\n    local_tid_27960 = get_local_id(0);\n    group_sizze_27963 = get_local_size(0);\n    wave_sizze_27962 = LOCKSTEP_WIDTH;\n    group_tid_27961 = get_group_id(0);\n    \n    int32_t phys_tid_26508;\n    \n    phys_tid_26508 = global_tid_27959;\n    \n    int64_t gtid_26505;\n    \n    gtid_26505 = squot64(sext_i32_i64(group_tid_27961) *\n                         segmap_group_sizze_26918 +\n                         sext_i32_i64(local_tid_27960), steps_23827 * 45);\n    \n    int64_t gtid_26506;\n    \n    gtid_26506 = squot64(sext_i32_i64(group_tid_27961) *\n                         segmap_group_sizze_26918 +\n                         sext_i32_i64(local_tid_27960) -\n                         squot64(sext_i32_i64(group_tid_27961) *\n                                 segmap_group_sizze_26918 +\n                                 sext_i32_i64(local_tid_27960), steps_23827 *\n                                 45) * (steps_23827 * 45), 45);\n    \n    int64_t gtid_26507;\n    \n    gtid_26507 = sext_i32_i64(group_tid_27961) * segmap_group_sizze_26918 +\n        sext_i32_i64(local_tid_27960) - squot64(sext_i32_i64(group_tid_27961) *\n                                                segmap_group_sizze_26918 +\n                                                sext_i32_i64(local_tid_27960),\n                                                steps_23827 * 45) *\n        (steps_23827 * 45) - squot64(sext_i32_i64(group_tid_27961) *\n                                     segmap_group_sizze_26918 +\n                                     sext_i32_i64(local_tid_27960) -\n                                     squot64(sext_i32_i64(group_tid_27961) *\n                                             segmap_group_sizze_26918 +\n                                             sext_i32_i64(local_tid_27960),\n                                             steps_23827 * 45) * (steps_23827 *\n                                                ",
                   "                  45), 45) * 45;\n    if ((slt64(gtid_26505, paths_23826) && slt64(gtid_26506, steps_23827)) &&\n        slt64(gtid_26507, 45)) {\n        int64_t convop_x_27479 = add64(1, gtid_26506);\n        float binop_x_27480 = sitofp_i64_f32(convop_x_27479);\n        float index_primexp_27481 = binop_x_27480 / sims_per_year_23906;\n        \n        ((__global float *) mem_27735)[gtid_26505 * (45 * steps_23827) +\n                                       gtid_26506 * 45 + gtid_26507] =\n            index_primexp_27481;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26918\n}\n__kernel void testzisegmap_26546(__global int *global_failure,\n                                 int64_t paths_23826, int64_t steps_23827,\n                                 __global unsigned char *mem_27725, __global\n                                 unsigned char *mem_27730)\n{\n    #define segmap_group_sizze_26900 (testzisegmap_group_sizze_26550)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27954;\n    int32_t local_tid_27955;\n    int64_t group_sizze_27958;\n    int32_t wave_sizze_27957;\n    int32_t group_tid_27956;\n    \n    global_tid_27954 = get_global_id(0);\n    local_tid_27955 = get_local_id(0);\n    group_sizze_27958 = get_local_size(0);\n    wave_sizze_27957 = LOCKSTEP_WIDTH;\n    group_tid_27956 = get_group_id(0);\n    \n    int32_t phys_tid_26546;\n    \n    phys_tid_26546 = global_tid_27954;\n    \n    int64_t gtid_26543;\n    \n    gtid_26543 = squot64(sext_i32_i64(group_tid_27956) *\n                         segmap_group_sizze_26900 +\n                         sext_i32_i64(local_tid_27955), steps_23827 * 45);\n    \n    int64_t gtid_26544;\n    \n    gtid_26544 = squot64(sext_i32_i64(group_tid_27956) *\n                         segmap_group_sizze_26900 +\n                         sext_i32_i64(local_tid_27955) -\n                         squot64(sext_i32_i64(group_tid_27956",
                   ") *\n                                 segmap_group_sizze_26900 +\n                                 sext_i32_i64(local_tid_27955), steps_23827 *\n                                 45) * (steps_23827 * 45), 45);\n    \n    int64_t gtid_26545;\n    \n    gtid_26545 = sext_i32_i64(group_tid_27956) * segmap_group_sizze_26900 +\n        sext_i32_i64(local_tid_27955) - squot64(sext_i32_i64(group_tid_27956) *\n                                                segmap_group_sizze_26900 +\n                                                sext_i32_i64(local_tid_27955),\n                                                steps_23827 * 45) *\n        (steps_23827 * 45) - squot64(sext_i32_i64(group_tid_27956) *\n                                     segmap_group_sizze_26900 +\n                                     sext_i32_i64(local_tid_27955) -\n                                     squot64(sext_i32_i64(group_tid_27956) *\n                                             segmap_group_sizze_26900 +\n                                             sext_i32_i64(local_tid_27955),\n                                             steps_23827 * 45) * (steps_23827 *\n                                                                  45), 45) * 45;\n    if ((slt64(gtid_26543, paths_23826) && slt64(gtid_26544, steps_23827)) &&\n        slt64(gtid_26545, 45)) {\n        float x_26903 = ((__global float *) mem_27725)[gtid_26544 *\n                                                       paths_23826 +\n                                                       gtid_26543];\n        \n        ((__global float *) mem_27730)[gtid_26543 * (45 * steps_23827) +\n                                       gtid_26544 * 45 + gtid_26545] = x_26903;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26900\n}\n__kernel void testzisegmap_26603(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args,\n                                 int64_t paths_238",
                   "26, int64_t steps_23827,\n                                 float dt_23840, int64_t upper_bound_23920,\n                                 float res_23921, int64_t num_groups_26855,\n                                 __global unsigned char *mem_27707, __global\n                                 unsigned char *mem_27710, __global\n                                 unsigned char *mem_27725)\n{\n    #define segmap_group_sizze_26854 (testzisegmap_group_sizze_26605)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27943;\n    int32_t local_tid_27944;\n    int64_t group_sizze_27947;\n    int32_t wave_sizze_27946;\n    int32_t group_tid_27945;\n    \n    global_tid_27943 = get_global_id(0);\n    local_tid_27944 = get_local_id(0);\n    group_sizze_27947 = get_local_size(0);\n    wave_sizze_27946 = LOCKSTEP_WIDTH;\n    group_tid_27945 = get_group_id(0);\n    \n    int32_t phys_tid_26603;\n    \n    phys_tid_26603 = global_tid_27943;\n    \n    int32_t phys_group_id_27948;\n    \n    phys_group_id_27948 = get_group_id(0);\n    for (int32_t i_27949 = 0; i_27949 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(paths_23826,\n                                          segmap_group_sizze_26854)) -\n                   phys_group_id_27948, sext_i64_i32(num_groups_26855));\n         i_27949++) {\n        int32_t virt_group_id_27950 = phys_group_id_27948 + i_27949 *\n                sext_i64_i32(num_groups_26855);\n        int64_t gtid_26602 = sext_i32_i64(virt_group_id_27950) *\n                segmap_group_sizze_26854 + sext_i32_i64(local_tid_27944);\n        \n        if (slt64(gtid_26602, paths_23826)) {\n            for (int64_t i_27951 = 0; i_27951 < steps_23827; i_27951++) {\n                ((__global float *) mem_27710",
                   ")[phys_tid_26603 + i_27951 *\n                                               (num_groups_26855 *\n                                                segmap_group_sizze_26854)] =\n                    5.0e-2F;\n            }\n            for (int64_t i_26861 = 0; i_26861 < upper_bound_23920; i_26861++) {\n                bool y_26863 = slt64(i_26861, steps_23827);\n                bool index_certs_26864;\n                \n                if (!y_26863) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 15) ==\n                            -1) {\n                            global_failure_args[0] = i_26861;\n                            global_failure_args[1] = steps_23827;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float shortstep_arg_26865 = ((__global\n                                              float *) mem_27707)[i_26861 *\n                                                                  paths_23826 +\n                                                                  gtid_26602];\n                float shortstep_arg_26866 = ((__global\n                                              float *) mem_27710)[phys_tid_26603 +\n                                                                  i_26861 *\n                                                                  (num_groups_26855 *\n                                                                   segmap_group_sizze_26854)];\n                float y_26867 = 5.0e-2F - shortstep_arg_26866;\n                float x_26868 = 1.0e-2F * y_26867;\n                float x_26869 = dt_23840 * x_26868;\n                float x_26870 = res_23921 * shortstep_arg_26865;\n                float y_26871 = 1.0e-3F * x_26870;\n                float delta_r_26872 = x_26869 + y_26871;\n                float res_26873 = shortstep_arg_26866 + delta_r_26872",
                   ";\n                int64_t i_26874 = add64(1, i_26861);\n                bool x_26875 = sle64(0, i_26874);\n                bool y_26876 = slt64(i_26874, steps_23827);\n                bool bounds_check_26877 = x_26875 && y_26876;\n                bool index_certs_26878;\n                \n                if (!bounds_check_26877) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 16) ==\n                            -1) {\n                            global_failure_args[0] = i_26874;\n                            global_failure_args[1] = steps_23827;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                ((__global float *) mem_27710)[phys_tid_26603 + i_26874 *\n                                               (num_groups_26855 *\n                                                segmap_group_sizze_26854)] =\n                    res_26873;\n            }\n            for (int64_t i_27953 = 0; i_27953 < steps_23827; i_27953++) {\n                ((__global float *) mem_27725)[i_27953 * paths_23826 +\n                                               gtid_26602] = ((__global\n                                                               float *) mem_27710)[phys_tid_26603 +\n                                                                                   i_27953 *\n                                                                                   (num_groups_26855 *\n                                                                                    segmap_group_sizze_26854)];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26854\n}\n__kernel void testzisegmap_26701(__global int *global_failure,\n                                 int64_t paths_23826, int64_t steps_23827,\n                                 __global uns",
                   "igned char *mem_27700, __global\n                                 unsigned char *mem_27704)\n{\n    #define segmap_group_sizze_26809 (testzisegmap_group_sizze_26704)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27938;\n    int32_t local_tid_27939;\n    int64_t group_sizze_27942;\n    int32_t wave_sizze_27941;\n    int32_t group_tid_27940;\n    \n    global_tid_27938 = get_global_id(0);\n    local_tid_27939 = get_local_id(0);\n    group_sizze_27942 = get_local_size(0);\n    wave_sizze_27941 = LOCKSTEP_WIDTH;\n    group_tid_27940 = get_group_id(0);\n    \n    int32_t phys_tid_26701;\n    \n    phys_tid_26701 = global_tid_27938;\n    \n    int64_t gtid_26699;\n    \n    gtid_26699 = squot64(sext_i32_i64(group_tid_27940) *\n                         segmap_group_sizze_26809 +\n                         sext_i32_i64(local_tid_27939), steps_23827);\n    \n    int64_t gtid_26700;\n    \n    gtid_26700 = sext_i32_i64(group_tid_27940) * segmap_group_sizze_26809 +\n        sext_i32_i64(local_tid_27939) - squot64(sext_i32_i64(group_tid_27940) *\n                                                segmap_group_sizze_26809 +\n                                                sext_i32_i64(local_tid_27939),\n                                                steps_23827) * steps_23827;\n    if (slt64(gtid_26699, paths_23826) && slt64(gtid_26700, steps_23827)) {\n        int32_t unsign_arg_26812 = ((__global int32_t *) mem_27700)[gtid_26699];\n        int32_t res_26814 = sext_i64_i32(gtid_26700);\n        int32_t x_26815 = lshr32(res_26814, 16);\n        int32_t x_26816 = res_26814 ^ x_26815;\n        int32_t x_26817 = mul32(73244475, x_26816);\n        int32_t x_26818 = lshr32(x_26817, 16);\n        int32_t x_26819 = x_26817 ^ x_26818;\n        int32_t x_26820 = mul32(73244475, x_26819);\n        int32_t x_26821 = lshr32(x_26820, 16);\n        int32_t x_26822 = x_26820 ^ x_26821;\n        int32_t unsign_arg",
                   "_26823 = unsign_arg_26812 ^ x_26822;\n        int32_t unsign_arg_26824 = mul32(48271, unsign_arg_26823);\n        int32_t unsign_arg_26825 = umod32(unsign_arg_26824, 2147483647);\n        int32_t unsign_arg_26826 = mul32(48271, unsign_arg_26825);\n        int32_t unsign_arg_26827 = umod32(unsign_arg_26826, 2147483647);\n        float res_26828 = uitofp_i32_f32(unsign_arg_26825);\n        float res_26829 = res_26828 / 2.1474836e9F;\n        float res_26830 = uitofp_i32_f32(unsign_arg_26827);\n        float res_26831 = res_26830 / 2.1474836e9F;\n        float res_26832;\n        \n        res_26832 = futrts_log32(res_26829);\n        \n        float res_26833 = -2.0F * res_26832;\n        float res_26834;\n        \n        res_26834 = futrts_sqrt32(res_26833);\n        \n        float res_26835 = 6.2831855F * res_26831;\n        float res_26836;\n        \n        res_26836 = futrts_cos32(res_26835);\n        \n        float res_26837 = res_26834 * res_26836;\n        \n        ((__global float *) mem_27704)[gtid_26699 * steps_23827 + gtid_26700] =\n            res_26837;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26809\n}\n__kernel void testzisegmap_26765(__global int *global_failure,\n                                 int64_t paths_23826, __global\n                                 unsigned char *mem_27700)\n{\n    #define segmap_group_sizze_26784 (testzisegmap_group_sizze_26767)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27933;\n    int32_t local_tid_27934;\n    int64_t group_sizze_27937;\n    int32_t wave_sizze_27936;\n    int32_t group_tid_27935;\n    \n    global_tid_27933 = get_global_id(0);\n    local_tid_27934 = get_local_id(0);\n    group_sizze_27937 = get_local_size(0);\n    wave_sizze_27936 = LOCKSTEP_WIDTH;\n    group_tid_27935 = get_group_id(0);\n    \n    int32_t phys_tid_26765;\n    \n    phys_tid_26765 = global_tid_27933;\n    \n    int64_t gtid_2676",
                   "4;\n    \n    gtid_26764 = sext_i32_i64(group_tid_27935) * segmap_group_sizze_26784 +\n        sext_i32_i64(local_tid_27934);\n    if (slt64(gtid_26764, paths_23826)) {\n        int32_t res_26788 = sext_i64_i32(gtid_26764);\n        int32_t x_26789 = lshr32(res_26788, 16);\n        int32_t x_26790 = res_26788 ^ x_26789;\n        int32_t x_26791 = mul32(73244475, x_26790);\n        int32_t x_26792 = lshr32(x_26791, 16);\n        int32_t x_26793 = x_26791 ^ x_26792;\n        int32_t x_26794 = mul32(73244475, x_26793);\n        int32_t x_26795 = lshr32(x_26794, 16);\n        int32_t x_26796 = x_26794 ^ x_26795;\n        int32_t unsign_arg_26797 = 777822902 ^ x_26796;\n        int32_t unsign_arg_26798 = mul32(48271, unsign_arg_26797);\n        int32_t unsign_arg_26799 = umod32(unsign_arg_26798, 2147483647);\n        \n        ((__global int32_t *) mem_27700)[gtid_26764] = unsign_arg_26799;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26784\n}\n__kernel void testzisegmap_27038(__global int *global_failure,\n                                 int64_t res_24015, int64_t num_segments_24207,\n                                 __global unsigned char *mem_27760, __global\n                                 unsigned char *mem_27765, __global\n                                 unsigned char *mem_27768, __global\n                                 unsigned char *mem_27770)\n{\n    #define segmap_group_sizze_27041 (testzisegmap_group_sizze_27040)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28465;\n    int32_t local_tid_28466;\n    int64_t group_sizze_28469;\n    int32_t wave_sizze_28468;\n    int32_t group_tid_28467;\n    \n    global_tid_28465 = get_global_id(0);\n    local_tid_28466 = get_local_id(0);\n    group_sizze_28469 = get_local_size(0);\n    wave_sizze_28468 = LOCKSTEP_WIDTH;\n    group_tid_28467 = get_group_id(0);\n    \n    int32_t phys_tid_27038;\n    \n    phys_tid_270",
                   "38 = global_tid_28465;\n    \n    int64_t write_i_27037;\n    \n    write_i_27037 = sext_i32_i64(group_tid_28467) * segmap_group_sizze_27041 +\n        sext_i32_i64(local_tid_28466);\n    if (slt64(write_i_27037, res_24015)) {\n        int64_t i_p_o_27555 = add64(1, write_i_27037);\n        int64_t rot_i_27556 = smod64(i_p_o_27555, res_24015);\n        bool x_24220 = ((__global bool *) mem_27760)[rot_i_27556];\n        float write_value_24221 = ((__global float *) mem_27765)[write_i_27037];\n        int64_t res_24222;\n        \n        if (x_24220) {\n            int64_t x_24219 = ((__global int64_t *) mem_27768)[write_i_27037];\n            int64_t res_24223 = sub64(x_24219, 1);\n            \n            res_24222 = res_24223;\n        } else {\n            res_24222 = -1;\n        }\n        if (sle64(0, res_24222) && slt64(res_24222, num_segments_24207)) {\n            ((__global float *) mem_27770)[res_24222] = write_value_24221;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27041\n}\n__kernel void testzisegmap_27107(__global int *global_failure,\n                                 int64_t paths_23826, int64_t steps_23827,\n                                 float sims_per_year_23906, float res_24226,\n                                 __global unsigned char *mem_27790, __global\n                                 unsigned char *mem_27793)\n{\n    #define segmap_group_sizze_27332 (testzisegmap_group_sizze_27109)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28515;\n    int32_t local_tid_28516;\n    int64_t group_sizze_28519;\n    int32_t wave_sizze_28518;\n    int32_t group_tid_28517;\n    \n    global_tid_28515 = get_global_id(0);\n    local_tid_28516 = get_local_id(0);\n    group_sizze_28519 = get_local_size(0);\n    wave_sizze_28518 = LOCKSTEP_WIDTH;\n    group_tid_28517 = get_group_id(0);\n    \n    int32_t phys_tid_27107;\n    \n    phys_tid_27107 = gl",
                   "obal_tid_28515;\n    \n    int64_t gtid_27106;\n    \n    gtid_27106 = sext_i32_i64(group_tid_28517) * segmap_group_sizze_27332 +\n        sext_i32_i64(local_tid_28516);\n    if (slt64(gtid_27106, steps_23827)) {\n        int64_t convop_x_27562 = add64(1, gtid_27106);\n        float binop_x_27563 = sitofp_i64_f32(convop_x_27562);\n        float index_primexp_27564 = binop_x_27563 / sims_per_year_23906;\n        float res_27337;\n        float redout_27616 = 0.0F;\n        \n        for (int64_t i_27617 = 0; i_27617 < paths_23826; i_27617++) {\n            float res_27342;\n            float redout_27618 = 0.0F;\n            \n            for (int32_t i_27625 = 0; i_27625 < 45; i_27625++) {\n                int64_t i_27619 = sext_i32_i64(i_27625);\n                float x_27346 = ((__global float *) mem_27790)[i_27617 *\n                                                               (steps_23827 *\n                                                                45) + i_27619 *\n                                                               steps_23827 +\n                                                               gtid_27106];\n                float res_27345 = x_27346 + redout_27618;\n                float redout_tmp_28521 = res_27345;\n                \n                redout_27618 = redout_tmp_28521;\n            }\n            res_27342 = redout_27618;\n            \n            float res_27347 = fmax32(0.0F, res_27342);\n            float res_27340 = res_27347 + redout_27616;\n            float redout_tmp_28520 = res_27340;\n            \n            redout_27616 = redout_tmp_28520;\n        }\n        res_27337 = redout_27616;\n        \n        float res_27348 = res_27337 / res_24226;\n        float negate_arg_27349 = 1.0e-2F * index_primexp_27564;\n        float exp_arg_27350 = 0.0F - negate_arg_27349;\n        float res_27351 = fpow32(2.7182817F, exp_arg_27350);\n        float x_27352 = 1.0F - res_27351;\n        float B_27353 = x_27352 / 1.0e-2F;\n        float x_27354 = B_27353 - index_primexp_2756",
                   "4;\n        float x_27355 = 4.4999997e-6F * x_27354;\n        float A1_27356 = x_27355 / 1.0e-4F;\n        float y_27357 = fpow32(B_27353, 2.0F);\n        float x_27358 = 1.0000001e-6F * y_27357;\n        float A2_27359 = x_27358 / 4.0e-2F;\n        float exp_arg_27360 = A1_27356 - A2_27359;\n        float res_27361 = fpow32(2.7182817F, exp_arg_27360);\n        float negate_arg_27362 = 5.0e-2F * B_27353;\n        float exp_arg_27363 = 0.0F - negate_arg_27362;\n        float res_27364 = fpow32(2.7182817F, exp_arg_27363);\n        float res_27365 = res_27361 * res_27364;\n        float res_27366 = res_27348 * res_27365;\n        \n        ((__global float *) mem_27793)[gtid_27106] = res_27366;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27332\n}\n__kernel void testzisegmap_27220(__global int *global_failure,\n                                 int64_t steps_23827, float sims_per_year_23906,\n                                 float res_24226, __global\n                                 unsigned char *mem_27804, __global\n                                 unsigned char *mem_27807)\n{\n    #define segmap_group_sizze_27419 (testzisegmap_group_sizze_27222)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28595;\n    int32_t local_tid_28596;\n    int64_t group_sizze_28599;\n    int32_t wave_sizze_28598;\n    int32_t group_tid_28597;\n    \n    global_tid_28595 = get_global_id(0);\n    local_tid_28596 = get_local_id(0);\n    group_sizze_28599 = get_local_size(0);\n    wave_sizze_28598 = LOCKSTEP_WIDTH;\n    group_tid_28597 = get_group_id(0);\n    \n    int32_t phys_tid_27220;\n    \n    phys_tid_27220 = global_tid_28595;\n    \n    int64_t gtid_27219;\n    \n    gtid_27219 = sext_i32_i64(group_tid_28597) * segmap_group_sizze_27419 +\n        sext_i32_i64(local_tid_28596);\n    if (slt64(gtid_27219, steps_23827)) {\n        int64_t convop_x_27570 = add64(1, gtid_27219);\n        fl",
                   "oat binop_x_27571 = sitofp_i64_f32(convop_x_27570);\n        float index_primexp_27572 = binop_x_27571 / sims_per_year_23906;\n        float res_27423 = ((__global float *) mem_27804)[gtid_27219];\n        float res_27424 = res_27423 / res_24226;\n        float negate_arg_27425 = 1.0e-2F * index_primexp_27572;\n        float exp_arg_27426 = 0.0F - negate_arg_27425;\n        float res_27427 = fpow32(2.7182817F, exp_arg_27426);\n        float x_27428 = 1.0F - res_27427;\n        float B_27429 = x_27428 / 1.0e-2F;\n        float x_27430 = B_27429 - index_primexp_27572;\n        float x_27431 = 4.4999997e-6F * x_27430;\n        float A1_27432 = x_27431 / 1.0e-4F;\n        float y_27433 = fpow32(B_27429, 2.0F);\n        float x_27434 = 1.0000001e-6F * y_27433;\n        float A2_27435 = x_27434 / 4.0e-2F;\n        float exp_arg_27436 = A1_27432 - A2_27435;\n        float res_27437 = fpow32(2.7182817F, exp_arg_27436);\n        float negate_arg_27438 = 5.0e-2F * B_27429;\n        float exp_arg_27439 = 0.0F - negate_arg_27438;\n        float res_27440 = fpow32(2.7182817F, exp_arg_27439);\n        float res_27441 = res_27437 * res_27440;\n        float res_27442 = res_27424 * res_27441;\n        \n        ((__global float *) mem_27807)[gtid_27219] = res_27442;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27419\n}\n__kernel void testzisegmap_intragroup_26247(__global int *global_failure,\n                                            int failure_is_an_option, __global\n                                            int64_t *global_failure_args,\n                                            __local volatile\n                                            int64_t *mem_27689_backing_aligned_0,\n                                            __local volatile\n                                            int64_t *mem_27685_backing_aligned_1,\n                                            __local volatile\n                                            int64_t *mem_27669_backing_aligned_2,\n                        ",
                   "                    __local volatile\n                                            int64_t *mem_27667_backing_aligned_3,\n                                            int64_t steps_23827, float dt_23840,\n                                            float sims_per_year_23906,\n                                            int64_t upper_bound_23920,\n                                            float res_23921,\n                                            int64_t computed_group_sizze_26204,\n                                            __global unsigned char *mem_27693,\n                                            __global unsigned char *mem_27697)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict mem_27689_backing_3 = (__local volatile\n                                                           char *) mem_27689_backing_aligned_0;\n    __local volatile char *restrict mem_27685_backing_2 = (__local volatile\n                                                           char *) mem_27685_backing_aligned_1;\n    __local volatile char *restrict mem_27669_backing_1 = (__local volatile\n                                                           char *) mem_27669_backing_aligned_2;\n    __local volatile char *restrict mem_27667_backing_0 = (__local volatile\n                                                           char *) mem_27667_backing_aligned_3;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27921;\n    int32_t local_tid_27922;\n    int64_t group_sizze_27925;\n    int32_t wave_sizze_27924;\n    int32_t group_tid_27923;\n    \n    global_tid_27921 = get_global_id(0);\n    local_tid_27922 = get_local_id(0);\n    group_sizze_27925 = get_local_size(0);\n    wave_sizze_27924 = LOCKSTEP_WIDTH;\n    group_tid_27923 =",
                   " get_group_id(0);\n    \n    int32_t phys_tid_26247;\n    \n    phys_tid_26247 = group_tid_27923;\n    \n    int32_t ltid_pre_27926;\n    \n    ltid_pre_27926 = local_tid_27922;\n    \n    int32_t ltid_pre_27927;\n    \n    ltid_pre_27927 = squot32(local_tid_27922, 45);\n    \n    int32_t ltid_pre_27928;\n    \n    ltid_pre_27928 = local_tid_27922 - squot32(local_tid_27922, 45) * 45;\n    \n    int64_t gtid_26202;\n    \n    gtid_26202 = sext_i32_i64(group_tid_27923);\n    \n    int32_t res_26402;\n    \n    res_26402 = sext_i64_i32(gtid_26202);\n    \n    int32_t x_26403 = lshr32(res_26402, 16);\n    int32_t x_26404 = res_26402 ^ x_26403;\n    int32_t x_26405 = mul32(73244475, x_26404);\n    int32_t x_26406 = lshr32(x_26405, 16);\n    int32_t x_26407 = x_26405 ^ x_26406;\n    int32_t x_26408 = mul32(73244475, x_26407);\n    int32_t x_26409 = lshr32(x_26408, 16);\n    int32_t x_26410 = x_26408 ^ x_26409;\n    int32_t unsign_arg_26411 = 777822902 ^ x_26410;\n    int32_t unsign_arg_26412 = mul32(48271, unsign_arg_26411);\n    int32_t unsign_arg_26413 = umod32(unsign_arg_26412, 2147483647);\n    __local char *mem_27667;\n    \n    mem_27667 = (__local char *) mem_27667_backing_0;\n    \n    int64_t gtid_26205 = sext_i32_i64(ltid_pre_27926);\n    int32_t phys_tid_26206 = local_tid_27922;\n    \n    if (slt64(gtid_26205, steps_23827)) {\n        int32_t res_26416 = sext_i64_i32(gtid_26205);\n        int32_t x_26417 = lshr32(res_26416, 16);\n        int32_t x_26418 = res_26416 ^ x_26417;\n        int32_t x_26419 = mul32(73244475, x_26418);\n        int32_t x_26420 = lshr32(x_26419, 16);\n        int32_t x_26421 = x_26419 ^ x_26420;\n        int32_t x_26422 = mul32(73244475, x_26421);\n        int32_t x_26423 = lshr32(x_26422, 16);\n        int32_t x_26424 = x_26422 ^ x_26423;\n        int32_t unsign_arg_26425 = unsign_arg_26413 ^ x_26424;\n        int32_t unsign_arg_26426 = mul32(48271, unsign_arg_26425);\n        int32_t unsign_arg_26427 = umod32(unsign_arg_26426, 2147483647);\n        int32_t unsign_arg_26428 = mul32(48271, u",
                   "nsign_arg_26427);\n        int32_t unsign_arg_26429 = umod32(unsign_arg_26428, 2147483647);\n        float res_26430 = uitofp_i32_f32(unsign_arg_26427);\n        float res_26431 = res_26430 / 2.1474836e9F;\n        float res_26432 = uitofp_i32_f32(unsign_arg_26429);\n        float res_26433 = res_26432 / 2.1474836e9F;\n        float res_26434;\n        \n        res_26434 = futrts_log32(res_26431);\n        \n        float res_26435 = -2.0F * res_26434;\n        float res_26436;\n        \n        res_26436 = futrts_sqrt32(res_26435);\n        \n        float res_26437 = 6.2831855F * res_26433;\n        float res_26438;\n        \n        res_26438 = futrts_cos32(res_26437);\n        \n        float res_26439 = res_26436 * res_26438;\n        \n        ((__local float *) mem_27667)[gtid_26205] = res_26439;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    __local char *mem_27669;\n    \n    mem_27669 = (__local char *) mem_27669_backing_1;\n    for (int64_t i_27929 = 0; i_27929 < sdiv_up64(steps_23827 -\n                                                  sext_i32_i64(local_tid_27922),\n                                                  computed_group_sizze_26204);\n         i_27929++) {\n        ((__local float *) mem_27669)[i_27929 * computed_group_sizze_26204 +\n                                      sext_i32_i64(local_tid_27922)] = 5.0e-2F;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int64_t i_26442 = 0; i_26442 < upper_bound_23920; i_26442++) {\n        bool y_26444 = slt64(i_26442, steps_23827);\n        bool index_certs_26445;\n        \n        if (!y_26444) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 13) == -1) {\n                    global_failure_args[0] = i_26442;\n                    global_failure_args[1] = steps_23827;\n                    ;\n                }\n                local_failure = true;\n                goto error_1;\n            }\n        }\n        \n        float shortstep_arg_26446 = ((__local float *) mem_27667)[i_26442];\n        float sho",
                   "rtstep_arg_26447 = ((__local float *) mem_27669)[i_26442];\n        float y_26448 = 5.0e-2F - shortstep_arg_26447;\n        float x_26449 = 1.0e-2F * y_26448;\n        float x_26450 = dt_23840 * x_26449;\n        float x_26451 = res_23921 * shortstep_arg_26446;\n        float y_26452 = 1.0e-3F * x_26451;\n        float delta_r_26453 = x_26450 + y_26452;\n        float res_26454 = shortstep_arg_26447 + delta_r_26453;\n        int64_t i_26455 = add64(1, i_26442);\n        bool x_26456 = sle64(0, i_26455);\n        bool y_26457 = slt64(i_26455, steps_23827);\n        bool bounds_check_26458 = x_26456 && y_26457;\n        bool index_certs_26459;\n        \n        if (!bounds_check_26458) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 14) == -1) {\n                    global_failure_args[0] = i_26455;\n                    global_failure_args[1] = steps_23827;\n                    ;\n                }\n                local_failure = true;\n                goto error_1;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_27922 == 0) {\n            ((__local float *) mem_27669)[i_26455] = res_26454;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    __local char *mem_27685;\n    \n    mem_27685 = (__local char *) mem_27685_backing_2;\n    \n    int64_t gtid_26239 = sext_i32_i64(ltid_pre_27927);\n    int64_t gtid_26240 = sext_i32_i64(ltid_pre_27928);\n    int32_t phys_tid_26241 = local_tid_27922;\n    \n    if (slt64(gtid_26239, steps_23827) && slt64(gtid_26240, 45)) {\n        float x_26462 = ((__local float *) mem_27669)[gtid_26239];\n        \n        ((__local float *) mem_27685)[gtid_26239 * 45 + gtid_26240] = x_26462;\n    }\n    \n  error_1:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    __local char *mem_27689;\n    \n    mem_27689 = (__local char *) mem_27689_backing_3;\n    \n    int64_t gtid_26233 = sext_i32_i64(ltid_pre_27927);\n    int64_t gtid_26234 = s",
                   "ext_i32_i64(ltid_pre_27928);\n    int32_t phys_tid_26235 = local_tid_27922;\n    \n    if (slt64(gtid_26233, steps_23827) && slt64(gtid_26234, 45)) {\n        int64_t convop_x_27468 = add64(1, gtid_26233);\n        float binop_x_27469 = sitofp_i64_f32(convop_x_27468);\n        float index_primexp_27470 = binop_x_27469 / sims_per_year_23906;\n        \n        ((__local float *) mem_27689)[gtid_26233 * 45 + gtid_26234] =\n            index_primexp_27470;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int64_t i_27931 = 0; i_27931 < sdiv_up64(steps_23827 * 45 -\n                                                  sext_i32_i64(local_tid_27922),\n                                                  computed_group_sizze_26204);\n         i_27931++) {\n        ((__global float *) mem_27693)[gtid_26202 * (45 * steps_23827) +\n                                       squot64(i_27931 *\n                                               computed_group_sizze_26204 +\n                                               sext_i32_i64(local_tid_27922),\n                                               45) * 45 + (i_27931 *\n                                                           computed_group_sizze_26204 +\n                                                           sext_i32_i64(local_tid_27922) -\n                                                           squot64(i_27931 *\n                                                                   computed_group_sizze_26204 +\n                                                                   sext_i32_i64(local_tid_27922),\n                                                                   45) * 45)] =\n            ((__local float *) mem_27685)[squot64(i_27931 *\n                                                  computed_group_sizze_26204 +\n                                                  sext_i32_i64(local_tid_27922),\n                                                  45) * 45 + (i_27931 *\n                                                              computed_group_sizze_26",
                   "204 +\n                                                              sext_i32_i64(local_tid_27922) -\n                                                              squot64(i_27931 *\n                                                                      computed_group_sizze_26204 +\n                                                                      sext_i32_i64(local_tid_27922),\n                                                                      45) *\n                                                              45)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int64_t i_27932 = 0; i_27932 < sdiv_up64(steps_23827 * 45 -\n                                                  sext_i32_i64(local_tid_27922),\n                                                  computed_group_sizze_26204);\n         i_27932++) {\n        ((__global float *) mem_27697)[gtid_26202 * (45 * steps_23827) +\n                                       squot64(i_27932 *\n                                               computed_group_sizze_26204 +\n                                               sext_i32_i64(local_tid_27922),\n                                               45) * 45 + (i_27932 *\n                                                           computed_group_sizze_26204 +\n                                                           sext_i32_i64(local_tid_27922) -\n                                                           squot64(i_27932 *\n                                                                   computed_group_sizze_26204 +\n                                                                   sext_i32_i64(local_tid_27922),\n                                                                   45) * 45)] =\n            ((__local float *) mem_27689)[squot64(i_27932 *\n                                                  computed_group_sizze_26204 +\n                                                  sext_i32_i64(local_tid_27922),\n                                                  45) * 45 + (i_27932 *\n          ",
                   "                                                    computed_group_sizze_26204 +\n                                                              sext_i32_i64(local_tid_27922) -\n                                                              squot64(i_27932 *\n                                                                      computed_group_sizze_26204 +\n                                                                      sext_i32_i64(local_tid_27922),\n                                                                      45) *\n                                                              45)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n  error_3:\n    return;\n}\n__kernel void testzisegmap_intragroup_27105(__global int *global_failure,\n                                            __local volatile\n                                            int64_t *red_arr_mem_28528_backing_aligned_0,\n                                            int64_t paths_23826,\n                                            float sims_per_year_23906,\n                                            float res_24226,\n                                            int64_t one_intra_par_min_26244,\n                                            __global unsigned char *mem_27770,\n                                            __global unsigned char *mem_27797)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28528_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28528_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28522;\n    int32_t local_tid_28523;\n    int64_t group_sizze_28526;\n    int32_t wave_sizze_28525;\n    int32_t group_tid_28524;\n    \n    global_tid_28522 = get_global_id(0);\n    local_tid_28523 = get_local_id(0);\n    group_sizze_28526 = get_local_size(0);\n    wave_sizze_28525 = LOCKSTEP_WIDTH;\n    group_tid_28524 = get_gr",
                   "oup_id(0);\n    \n    int32_t phys_tid_27105;\n    \n    phys_tid_27105 = group_tid_28524;\n    \n    int32_t ltid_pre_28527;\n    \n    ltid_pre_28527 = local_tid_28523;\n    \n    int64_t gtid_27100;\n    \n    gtid_27100 = sext_i32_i64(group_tid_28524);\n    \n    int64_t convop_x_27566;\n    \n    convop_x_27566 = add64(1, gtid_27100);\n    \n    float binop_x_27567 = sitofp_i64_f32(convop_x_27566);\n    float index_primexp_27568 = binop_x_27567 / sims_per_year_23906;\n    int64_t binop_y_27630 = 45 * gtid_27100;\n    float res_27371;\n    int64_t gtid_27103 = sext_i32_i64(ltid_pre_28527);\n    int32_t phys_tid_27104 = local_tid_28523;\n    __local char *red_arr_mem_28528;\n    \n    red_arr_mem_28528 = (__local char *) red_arr_mem_28528_backing_0;\n    if (slt64(gtid_27103, paths_23826)) {\n        int64_t binop_x_27629 = one_intra_par_min_26244 * gtid_27103;\n        int64_t binop_x_27631 = binop_x_27629 + binop_y_27630;\n        float res_27376;\n        float redout_27620 = 0.0F;\n        \n        for (int32_t i_27626 = 0; i_27626 < 45; i_27626++) {\n            int64_t i_27621 = sext_i32_i64(i_27626);\n            int64_t new_index_27632 = i_27621 + binop_x_27631;\n            float x_27380 = ((__global float *) mem_27770)[new_index_27632];\n            float res_27379 = x_27380 + redout_27620;\n            float redout_tmp_28530 = res_27379;\n            \n            redout_27620 = redout_tmp_28530;\n        }\n        res_27376 = redout_27620;\n        \n        float res_27381 = fmax32(0.0F, res_27376);\n        \n        ((__local float *) red_arr_mem_28528)[gtid_27103] = res_27381;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28531;\n    int32_t skip_waves_28532;\n    \n    skip_waves_28532 = 1;\n    \n    float x_27372;\n    float x_27373;\n    \n    offset_28531 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28523, sext_i64_i32(paths_23826))) {\n            x_27372 = ((__local\n                        float *) red_arr_mem_28528)[sext_i32_i",
                   "64(local_tid_28523 +\n                                                    offset_28531)];\n        }\n    }\n    offset_28531 = 1;\n    while (slt32(offset_28531, wave_sizze_28525)) {\n        if (slt32(local_tid_28523 + offset_28531, sext_i64_i32(paths_23826)) &&\n            ((local_tid_28523 - squot32(local_tid_28523, wave_sizze_28525) *\n              wave_sizze_28525) & (2 * offset_28531 - 1)) == 0) {\n            // read array element\n            {\n                x_27373 = ((volatile __local\n                            float *) red_arr_mem_28528)[sext_i32_i64(local_tid_28523 +\n                                                        offset_28531)];\n            }\n            // apply reduction operation\n            {\n                float res_27374 = x_27372 + x_27373;\n                \n                x_27372 = res_27374;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_28528)[sext_i32_i64(local_tid_28523)] =\n                    x_27372;\n            }\n        }\n        offset_28531 *= 2;\n    }\n    while (slt32(skip_waves_28532, squot32(sext_i64_i32(paths_23826) +\n                                           wave_sizze_28525 - 1,\n                                           wave_sizze_28525))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28531 = skip_waves_28532 * wave_sizze_28525;\n        if (slt32(local_tid_28523 + offset_28531, sext_i64_i32(paths_23826)) &&\n            ((local_tid_28523 - squot32(local_tid_28523, wave_sizze_28525) *\n              wave_sizze_28525) == 0 && (squot32(local_tid_28523,\n                                                 wave_sizze_28525) & (2 *\n                                                                      skip_waves_28532 -\n                                                                      1)) ==\n             0)) {\n            // read array element\n            {\n                x_27373 = ((__local\n                            float *)",
                   " red_arr_mem_28528)[sext_i32_i64(local_tid_28523 +\n                                                        offset_28531)];\n            }\n            // apply reduction operation\n            {\n                float res_27374 = x_27372 + x_27373;\n                \n                x_27372 = res_27374;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_28528)[sext_i32_i64(local_tid_28523)] =\n                    x_27372;\n            }\n        }\n        skip_waves_28532 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    res_27371 = ((__local float *) red_arr_mem_28528)[0];\n    \n    float res_27382 = res_27371 / res_24226;\n    float negate_arg_27383 = 1.0e-2F * index_primexp_27568;\n    float exp_arg_27384 = 0.0F - negate_arg_27383;\n    float res_27385 = fpow32(2.7182817F, exp_arg_27384);\n    float x_27386 = 1.0F - res_27385;\n    float B_27387 = x_27386 / 1.0e-2F;\n    float x_27388 = B_27387 - index_primexp_27568;\n    float x_27389 = 4.4999997e-6F * x_27388;\n    float A1_27390 = x_27389 / 1.0e-4F;\n    float y_27391 = fpow32(B_27387, 2.0F);\n    float x_27392 = 1.0000001e-6F * y_27391;\n    float A2_27393 = x_27392 / 4.0e-2F;\n    float exp_arg_27394 = A1_27390 - A2_27393;\n    float res_27395 = fpow32(2.7182817F, exp_arg_27394);\n    float negate_arg_27396 = 5.0e-2F * B_27387;\n    float exp_arg_27397 = 0.0F - negate_arg_27396;\n    float res_27398 = fpow32(2.7182817F, exp_arg_27397);\n    float res_27399 = res_27395 * res_27398;\n    float res_27400 = res_27382 * res_27399;\n    \n    if (local_tid_28523 == 0) {\n        ((__global float *) mem_27797)[gtid_27100] = res_27400;\n    }\n    \n  error_2:\n    return;\n}\n__kernel void testzisegred_large_27255(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_28571_backing_aligned_0,\n                                       __local volatile\n                                ",
                   "       int64_t *red_arr_mem_28569_backing_aligned_1,\n                                       int64_t paths_23826, int64_t steps_23827,\n                                       int64_t num_groups_27404, __global\n                                       unsigned char *mem_27801, __global\n                                       unsigned char *mem_27804,\n                                       int64_t groups_per_segment_28555,\n                                       int64_t elements_per_thread_28556,\n                                       int64_t virt_num_groups_28557,\n                                       int64_t threads_per_segment_28559,\n                                       __global\n                                       unsigned char *group_res_arr_mem_28560,\n                                       __global\n                                       unsigned char *testzicounter_mem_28562)\n{\n    #define segred_group_sizze_27403 (testzisegred_group_sizze_27249)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_28571_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_28571_backing_aligned_0;\n    __local volatile char *restrict red_arr_mem_28569_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28569_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28564;\n    int32_t local_tid_28565;\n    int64_t group_sizze_28568;\n    int32_t wave_sizze_28567;\n    int32_t group_tid_28566;\n    \n    global_tid_28564 = get_global_id(0);\n    local_tid_28565 = get_local_id(0);\n    group_sizze_28568 = get_local_size(0);\n    wave_sizze_28567 = LOCKSTEP_WIDTH;\n    group_tid_28566 = get_group_id(0);\n    \n    int32_t phys_tid_27255;\n    \n    phys_tid_27255 = global_tid_28564;\n    \n    __local char *red_arr_mem_28569;\n    \n    red_arr_mem_28569 = (__local char *)",
                   " red_arr_mem_28569_backing_0;\n    \n    __local char *sync_arr_mem_28571;\n    \n    sync_arr_mem_28571 = (__local char *) sync_arr_mem_28571_backing_1;\n    \n    int32_t phys_group_id_28573;\n    \n    phys_group_id_28573 = get_group_id(0);\n    for (int32_t i_28574 = 0; i_28574 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_28557) - phys_group_id_28573,\n                   sext_i64_i32(num_groups_27404)); i_28574++) {\n        int32_t virt_group_id_28575 = phys_group_id_28573 + i_28574 *\n                sext_i64_i32(num_groups_27404);\n        int32_t flat_segment_id_28576 = squot32(virt_group_id_28575,\n                                                sext_i64_i32(groups_per_segment_28555));\n        int64_t global_tid_28577 = srem64(sext_i32_i64(virt_group_id_28575) *\n                                          segred_group_sizze_27403 +\n                                          sext_i32_i64(local_tid_28565),\n                                          segred_group_sizze_27403 *\n                                          groups_per_segment_28555);\n        int64_t gtid_27246 = sext_i32_i64(flat_segment_id_28576);\n        int64_t gtid_27254;\n        float x_acc_28578;\n        int64_t chunk_sizze_28579;\n        \n        chunk_sizze_28579 = smin64(elements_per_thread_28556,\n                                   sdiv_up64(paths_23826 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_28577)),\n                                             threads_per_segment_28559));\n        \n        float x_27407;\n        float x_27408;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_28578 = 0.0F;\n        }\n        for (int64_t i_28583 = 0; i_28583 < chunk_sizze_28579; i_28583++) {\n            gtid_27254 = sext_i32_i64(sext_i64_i32(global_tid_28577)) +\n                threads_per_segment_28559 * i_28583;\n            // apply map function\n            {\n                float res_27412;\n                float redout_27622 = 0.0F;\n        ",
                   "        \n                for (int32_t i_27627 = 0; i_27627 < 45; i_27627++) {\n                    int64_t i_27623 = sext_i32_i64(i_27627);\n                    float x_27416 = ((__global float *) mem_27801)[i_27623 *\n                                                                   (steps_23827 *\n                                                                    paths_23826) +\n                                                                   gtid_27254 *\n                                                                   steps_23827 +\n                                                                   gtid_27246];\n                    float res_27415 = x_27416 + redout_27622;\n                    float redout_tmp_28584 = res_27415;\n                    \n                    redout_27622 = redout_tmp_28584;\n                }\n                res_27412 = redout_27622;\n                \n                float res_27417 = fmax32(0.0F, res_27412);\n                \n                // save map-out results\n                { }\n                // load accumulator\n                {\n                    x_27407 = x_acc_28578;\n                }\n                // load new values\n                {\n                    x_27408 = res_27417;\n                }\n                // apply reduction operator\n                {\n                    float res_27409 = x_27407 + x_27408;\n                    \n                    // store in accumulator\n                    {\n                        x_acc_28578 = res_27409;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_27407 = x_acc_28578;\n            ((__local\n              float *) red_arr_mem_28569)[sext_i32_i64(local_tid_28565)] =\n                x_27407;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_28585;\n        int32_t skip_waves_28586;\n        \n        skip_waves_28586 = 1;\n        \n        float x_28580;",
                   "\n        float x_28581;\n        \n        offset_28585 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_28565,\n                      sext_i64_i32(segred_group_sizze_27403))) {\n                x_28580 = ((__local\n                            float *) red_arr_mem_28569)[sext_i32_i64(local_tid_28565 +\n                                                        offset_28585)];\n            }\n        }\n        offset_28585 = 1;\n        while (slt32(offset_28585, wave_sizze_28567)) {\n            if (slt32(local_tid_28565 + offset_28585,\n                      sext_i64_i32(segred_group_sizze_27403)) &&\n                ((local_tid_28565 - squot32(local_tid_28565, wave_sizze_28567) *\n                  wave_sizze_28567) & (2 * offset_28585 - 1)) == 0) {\n                // read array element\n                {\n                    x_28581 = ((volatile __local\n                                float *) red_arr_mem_28569)[sext_i32_i64(local_tid_28565 +\n                                                            offset_28585)];\n                }\n                // apply reduction operation\n                {\n                    float res_28582 = x_28580 + x_28581;\n                    \n                    x_28580 = res_28582;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      float *) red_arr_mem_28569)[sext_i32_i64(local_tid_28565)] =\n                        x_28580;\n                }\n            }\n            offset_28585 *= 2;\n        }\n        while (slt32(skip_waves_28586,\n                     squot32(sext_i64_i32(segred_group_sizze_27403) +\n                             wave_sizze_28567 - 1, wave_sizze_28567))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_28585 = skip_waves_28586 * wave_sizze_28567;\n            if (slt32(local_tid_28565 + offset_28585,\n                      sext_i64_i32(segred_group_sizze_27403)) &&\n          ",
                   "      ((local_tid_28565 - squot32(local_tid_28565, wave_sizze_28567) *\n                  wave_sizze_28567) == 0 && (squot32(local_tid_28565,\n                                                     wave_sizze_28567) & (2 *\n                                                                          skip_waves_28586 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_28581 = ((__local\n                                float *) red_arr_mem_28569)[sext_i32_i64(local_tid_28565 +\n                                                            offset_28585)];\n                }\n                // apply reduction operation\n                {\n                    float res_28582 = x_28580 + x_28581;\n                    \n                    x_28580 = res_28582;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      float *) red_arr_mem_28569)[sext_i32_i64(local_tid_28565)] =\n                        x_28580;\n                }\n            }\n            skip_waves_28586 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_28565) == 0) {\n                x_acc_28578 = x_28580;\n            }\n        }\n        if (groups_per_segment_28555 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_28565 == 0) {\n                    ((__global float *) mem_27804)[gtid_27246] = x_acc_28578;\n                }\n            }\n        } else {\n            int32_t old_counter_28587;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_28565 == 0) {\n                    ((__global\n                      float *) group_res_arr_mem_28560)[sext_i32_i64(virt_group_id_285",
                   "75) *\n                                                        segred_group_sizze_27403] =\n                        x_acc_28578;\n                    mem_fence_global();\n                    old_counter_28587 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_28562)[sext_i32_i64(srem32(flat_segment_id_28576,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_28571)[0] =\n                        old_counter_28587 == groups_per_segment_28555 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_28588;\n            \n            is_last_group_28588 = ((__local bool *) sync_arr_mem_28571)[0];\n            if (is_last_group_28588) {\n                if (local_tid_28565 == 0) {\n                    old_counter_28587 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_28562)[sext_i32_i64(srem32(flat_segment_id_28576,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_28555));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_28589 =\n                            sdiv_up64(groups_per_segment_28555,\n                                      segred_group_sizze_27403);\n                    \n                    x_27407 = 0.0F;\n                    for (int64_t i_28590 = 0; i_28590 < read_per_thread_28589;\n                         i_28590++) {\n                        int64_t group_res_id_28591 =\n    ",
                   "                            sext_i32_i64(local_tid_28565) *\n                                read_per_thread_28589 + i_28590;\n                        int64_t index_of_group_res_28592 =\n                                sext_i32_i64(flat_segment_id_28576) *\n                                groups_per_segment_28555 + group_res_id_28591;\n                        \n                        if (slt64(group_res_id_28591,\n                                  groups_per_segment_28555)) {\n                            x_27408 = ((__global\n                                        float *) group_res_arr_mem_28560)[index_of_group_res_28592 *\n                                                                          segred_group_sizze_27403];\n                            \n                            float res_27409;\n                            \n                            res_27409 = x_27407 + x_27408;\n                            x_27407 = res_27409;\n                        }\n                    }\n                }\n                ((__local\n                  float *) red_arr_mem_28569)[sext_i32_i64(local_tid_28565)] =\n                    x_27407;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_28593;\n                    int32_t skip_waves_28594;\n                    \n                    skip_waves_28594 = 1;\n                    \n                    float x_28580;\n                    float x_28581;\n                    \n                    offset_28593 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_28565,\n                                  sext_i64_i32(segred_group_sizze_27403))) {\n                            x_28580 = ((__local\n                                        float *) red_arr_mem_28569)[sext_i32_i64(local_tid_28565 +\n                                                                    offset_28593)];",
                   "\n                        }\n                    }\n                    offset_28593 = 1;\n                    while (slt32(offset_28593, wave_sizze_28567)) {\n                        if (slt32(local_tid_28565 + offset_28593,\n                                  sext_i64_i32(segred_group_sizze_27403)) &&\n                            ((local_tid_28565 - squot32(local_tid_28565,\n                                                        wave_sizze_28567) *\n                              wave_sizze_28567) & (2 * offset_28593 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_28581 = ((volatile __local\n                                            float *) red_arr_mem_28569)[sext_i32_i64(local_tid_28565 +\n                                                                        offset_28593)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_28582 = x_28580 + x_28581;\n                                \n                                x_28580 = res_28582;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_28569)[sext_i32_i64(local_tid_28565)] =\n                                    x_28580;\n                            }\n                        }\n                        offset_28593 *= 2;\n                    }\n                    while (slt32(skip_waves_28594,\n                                 squot32(sext_i64_i32(segred_group_sizze_27403) +\n                                         wave_sizze_28567 - 1,\n                                         wave_sizze_28567))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_28593 = skip_waves_28594 * wave_sizze_28567;\n                     ",
                   "   if (slt32(local_tid_28565 + offset_28593,\n                                  sext_i64_i32(segred_group_sizze_27403)) &&\n                            ((local_tid_28565 - squot32(local_tid_28565,\n                                                        wave_sizze_28567) *\n                              wave_sizze_28567) == 0 &&\n                             (squot32(local_tid_28565, wave_sizze_28567) & (2 *\n                                                                            skip_waves_28594 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_28581 = ((__local\n                                            float *) red_arr_mem_28569)[sext_i32_i64(local_tid_28565 +\n                                                                        offset_28593)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_28582 = x_28580 + x_28581;\n                                \n                                x_28580 = res_28582;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  float *) red_arr_mem_28569)[sext_i32_i64(local_tid_28565)] =\n                                    x_28580;\n                            }\n                        }\n                        skip_waves_28594 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_28565 == 0) {\n                            ((__global float *) mem_27804)[gtid_27246] =\n                                x_28580;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK",
                   "_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27403\n}\n__kernel void testzisegred_large_28143(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_28181_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_28179_backing_aligned_1,\n                                       int64_t res_24015,\n                                       int64_t num_groups_26950, __global\n                                       unsigned char *mem_27747,\n                                       int32_t num_subhistos_28057, __global\n                                       unsigned char *res_subhistos_mem_28058,\n                                       int64_t groups_per_segment_28165,\n                                       int64_t elements_per_thread_28166,\n                                       int64_t virt_num_groups_28167,\n                                       int64_t threads_per_segment_28169,\n                                       __global\n                                       unsigned char *group_res_arr_mem_28170,\n                                       __global\n                                       unsigned char *testzicounter_mem_28172)\n{\n    #define seghist_group_sizze_26948 (testziseghist_group_sizze_26947)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_28181_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_28181_backing_aligned_0;\n    __local volatile char *restrict red_arr_mem_28179_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28179_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28174;\n    int32_t loc",
                   "al_tid_28175;\n    int64_t group_sizze_28178;\n    int32_t wave_sizze_28177;\n    int32_t group_tid_28176;\n    \n    global_tid_28174 = get_global_id(0);\n    local_tid_28175 = get_local_id(0);\n    group_sizze_28178 = get_local_size(0);\n    wave_sizze_28177 = LOCKSTEP_WIDTH;\n    group_tid_28176 = get_group_id(0);\n    \n    int32_t flat_gtid_28143;\n    \n    flat_gtid_28143 = global_tid_28174;\n    \n    __local char *red_arr_mem_28179;\n    \n    red_arr_mem_28179 = (__local char *) red_arr_mem_28179_backing_0;\n    \n    __local char *sync_arr_mem_28181;\n    \n    sync_arr_mem_28181 = (__local char *) sync_arr_mem_28181_backing_1;\n    \n    int32_t phys_group_id_28183;\n    \n    phys_group_id_28183 = get_group_id(0);\n    for (int32_t i_28184 = 0; i_28184 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_28167) - phys_group_id_28183,\n                   sext_i64_i32(num_groups_26950)); i_28184++) {\n        int32_t virt_group_id_28185 = phys_group_id_28183 + i_28184 *\n                sext_i64_i32(num_groups_26950);\n        int32_t flat_segment_id_28186 = squot32(virt_group_id_28185,\n                                                sext_i64_i32(groups_per_segment_28165));\n        int64_t global_tid_28187 = srem64(sext_i32_i64(virt_group_id_28185) *\n                                          seghist_group_sizze_26948 +\n                                          sext_i32_i64(local_tid_28175),\n                                          seghist_group_sizze_26948 *\n                                          groups_per_segment_28165);\n        int64_t bucket_id_28141 = sext_i32_i64(flat_segment_id_28186);\n        int64_t subhistogram_id_28142;\n        int64_t x_acc_28188;\n        int64_t chunk_sizze_28189;\n        \n        chunk_sizze_28189 = smin64(elements_per_thread_28166,\n                                   sdiv_up64(num_subhistos_28057 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_28187)),\n                                             threads_per_segment_2",
                   "8169));\n        \n        int64_t x_26954;\n        int64_t x_26955;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_28188 = 0;\n        }\n        for (int64_t i_28193 = 0; i_28193 < chunk_sizze_28189; i_28193++) {\n            subhistogram_id_28142 =\n                sext_i32_i64(sext_i64_i32(global_tid_28187)) +\n                threads_per_segment_28169 * i_28193;\n            // apply map function\n            {\n                // load accumulator\n                {\n                    x_26954 = x_acc_28188;\n                }\n                // load new values\n                {\n                    x_26955 = ((__global\n                                int64_t *) res_subhistos_mem_28058)[subhistogram_id_28142 *\n                                                                    res_24015 +\n                                                                    bucket_id_28141];\n                }\n                // apply reduction operator\n                {\n                    int64_t res_26956 = smax64(x_26954, x_26955);\n                    \n                    // store in accumulator\n                    {\n                        x_acc_28188 = res_26956;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_26954 = x_acc_28188;\n            ((__local\n              int64_t *) red_arr_mem_28179)[sext_i32_i64(local_tid_28175)] =\n                x_26954;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_28194;\n        int32_t skip_waves_28195;\n        \n        skip_waves_28195 = 1;\n        \n        int64_t x_28190;\n        int64_t x_28191;\n        \n        offset_28194 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_28175,\n                      sext_i64_i32(seghist_group_sizze_26948))) {\n                x_28190 = ((__local\n                            int64_t *)",
                   " red_arr_mem_28179)[sext_i32_i64(local_tid_28175 +\n                                                          offset_28194)];\n            }\n        }\n        offset_28194 = 1;\n        while (slt32(offset_28194, wave_sizze_28177)) {\n            if (slt32(local_tid_28175 + offset_28194,\n                      sext_i64_i32(seghist_group_sizze_26948)) &&\n                ((local_tid_28175 - squot32(local_tid_28175, wave_sizze_28177) *\n                  wave_sizze_28177) & (2 * offset_28194 - 1)) == 0) {\n                // read array element\n                {\n                    x_28191 = ((volatile __local\n                                int64_t *) red_arr_mem_28179)[sext_i32_i64(local_tid_28175 +\n                                                              offset_28194)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_28192 = smax64(x_28190, x_28191);\n                    \n                    x_28190 = res_28192;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      int64_t *) red_arr_mem_28179)[sext_i32_i64(local_tid_28175)] =\n                        x_28190;\n                }\n            }\n            offset_28194 *= 2;\n        }\n        while (slt32(skip_waves_28195,\n                     squot32(sext_i64_i32(seghist_group_sizze_26948) +\n                             wave_sizze_28177 - 1, wave_sizze_28177))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_28194 = skip_waves_28195 * wave_sizze_28177;\n            if (slt32(local_tid_28175 + offset_28194,\n                      sext_i64_i32(seghist_group_sizze_26948)) &&\n                ((local_tid_28175 - squot32(local_tid_28175, wave_sizze_28177) *\n                  wave_sizze_28177) == 0 && (squot32(local_tid_28175,\n                                                     wave_sizze_28177) & (2 *\n                                                                ",
                   "          skip_waves_28195 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_28191 = ((__local\n                                int64_t *) red_arr_mem_28179)[sext_i32_i64(local_tid_28175 +\n                                                              offset_28194)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_28192 = smax64(x_28190, x_28191);\n                    \n                    x_28190 = res_28192;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_28179)[sext_i32_i64(local_tid_28175)] =\n                        x_28190;\n                }\n            }\n            skip_waves_28195 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_28175) == 0) {\n                x_acc_28188 = x_28190;\n            }\n        }\n        if (groups_per_segment_28165 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_28175 == 0) {\n                    ((__global int64_t *) mem_27747)[bucket_id_28141] =\n                        x_acc_28188;\n                }\n            }\n        } else {\n            int32_t old_counter_28196;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_28175 == 0) {\n                    ((__global\n                      int64_t *) group_res_arr_mem_28170)[sext_i32_i64(virt_group_id_28185) *\n                                                          seghist_group_sizze_26948] =\n                        x_acc_28188;\n                    mem_fence_global();\n                    old_counter_28196 =\n                        a",
                   "tomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_28172)[sext_i32_i64(srem32(flat_segment_id_28186,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_28181)[0] =\n                        old_counter_28196 == groups_per_segment_28165 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_28197;\n            \n            is_last_group_28197 = ((__local bool *) sync_arr_mem_28181)[0];\n            if (is_last_group_28197) {\n                if (local_tid_28175 == 0) {\n                    old_counter_28196 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_28172)[sext_i32_i64(srem32(flat_segment_id_28186,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_28165));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_28198 =\n                            sdiv_up64(groups_per_segment_28165,\n                                      seghist_group_sizze_26948);\n                    \n                    x_26954 = 0;\n                    for (int64_t i_28199 = 0; i_28199 < read_per_thread_28198;\n                         i_28199++) {\n                        int64_t group_res_id_28200 =\n                                sext_i32_i64(local_tid_28175) *\n                                read_per_thread_28198 + i_28199;\n                        int64_t index_of_group_res_28201 =\n                                sext_i32_i64(flat_",
                   "segment_id_28186) *\n                                groups_per_segment_28165 + group_res_id_28200;\n                        \n                        if (slt64(group_res_id_28200,\n                                  groups_per_segment_28165)) {\n                            x_26955 = ((__global\n                                        int64_t *) group_res_arr_mem_28170)[index_of_group_res_28201 *\n                                                                            seghist_group_sizze_26948];\n                            \n                            int64_t res_26956;\n                            \n                            res_26956 = smax64(x_26954, x_26955);\n                            x_26954 = res_26956;\n                        }\n                    }\n                }\n                ((__local\n                  int64_t *) red_arr_mem_28179)[sext_i32_i64(local_tid_28175)] =\n                    x_26954;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_28202;\n                    int32_t skip_waves_28203;\n                    \n                    skip_waves_28203 = 1;\n                    \n                    int64_t x_28190;\n                    int64_t x_28191;\n                    \n                    offset_28202 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_28175,\n                                  sext_i64_i32(seghist_group_sizze_26948))) {\n                            x_28190 = ((__local\n                                        int64_t *) red_arr_mem_28179)[sext_i32_i64(local_tid_28175 +\n                                                                      offset_28202)];\n                        }\n                    }\n                    offset_28202 = 1;\n                    while (slt32(offset_28202, wave_sizze_28177)) {\n                        if (slt32(local_tid_28175 + of",
                   "fset_28202,\n                                  sext_i64_i32(seghist_group_sizze_26948)) &&\n                            ((local_tid_28175 - squot32(local_tid_28175,\n                                                        wave_sizze_28177) *\n                              wave_sizze_28177) & (2 * offset_28202 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_28191 = ((volatile __local\n                                            int64_t *) red_arr_mem_28179)[sext_i32_i64(local_tid_28175 +\n                                                                          offset_28202)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_28192 = smax64(x_28190, x_28191);\n                                \n                                x_28190 = res_28192;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_28179)[sext_i32_i64(local_tid_28175)] =\n                                    x_28190;\n                            }\n                        }\n                        offset_28202 *= 2;\n                    }\n                    while (slt32(skip_waves_28203,\n                                 squot32(sext_i64_i32(seghist_group_sizze_26948) +\n                                         wave_sizze_28177 - 1,\n                                         wave_sizze_28177))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_28202 = skip_waves_28203 * wave_sizze_28177;\n                        if (slt32(local_tid_28175 + offset_28202,\n                                  sext_i64_i32(seghist_group_sizze_26948)) &&\n                            ((local_tid_28175 - squot32(local_tid_281",
                   "75,\n                                                        wave_sizze_28177) *\n                              wave_sizze_28177) == 0 &&\n                             (squot32(local_tid_28175, wave_sizze_28177) & (2 *\n                                                                            skip_waves_28203 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_28191 = ((__local\n                                            int64_t *) red_arr_mem_28179)[sext_i32_i64(local_tid_28175 +\n                                                                          offset_28202)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_28192 = smax64(x_28190, x_28191);\n                                \n                                x_28190 = res_28192;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  int64_t *) red_arr_mem_28179)[sext_i32_i64(local_tid_28175)] =\n                                    x_28190;\n                            }\n                        }\n                        skip_waves_28203 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_28175 == 0) {\n                            ((__global int64_t *) mem_27747)[bucket_id_28141] =\n                                x_28190;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_26948\n}\n__kernel void testzisegred_nonseg_25877(__global int *",
                   "global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_27889_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_27887_backing_aligned_1,\n                                        int64_t num_groups_25872, __global\n                                        unsigned char *mem_27636, __global\n                                        unsigned char *mem_27638, __global\n                                        unsigned char *mem_27641, __global\n                                        unsigned char *testzicounter_mem_27877,\n                                        __global\n                                        unsigned char *group_res_arr_mem_27879,\n                                        int64_t num_threads_27881)\n{\n    #define segred_group_sizze_25870 (testzisegred_group_sizze_25869)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27889_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_27889_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_27887_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_27887_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27882;\n    int32_t local_tid_27883;\n    int64_t group_sizze_27886;\n    int32_t wave_sizze_27885;\n    int32_t group_tid_27884;\n    \n    global_tid_27882 = get_global_id(0);\n    local_tid_27883 = get_local_id(0);\n    group_sizze_27886 = get_local_size(0);\n    wave_sizze_27885 = LOCKSTEP_WIDTH;\n    group_tid_27884 = get_group_id(0);\n    \n    int32_t phys_tid_25877;\n    \n    phys_tid_25877 = global_tid_27882;\n    \n    __local char *sync_arr_mem_27887;\n    \n    sync_arr_mem_27887 = (__local char *) sync_arr_m",
                   "em_27887_backing_0;\n    \n    __local char *red_arr_mem_27889;\n    \n    red_arr_mem_27889 = (__local char *) red_arr_mem_27889_backing_1;\n    \n    int64_t dummy_25875;\n    \n    dummy_25875 = 0;\n    \n    int64_t gtid_25876;\n    \n    gtid_25876 = 0;\n    \n    float x_acc_27891;\n    int64_t chunk_sizze_27892;\n    \n    chunk_sizze_27892 = smin64(sdiv_up64(45,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_25870 *\n                                         num_groups_25872))), sdiv_up64(45 -\n                                                                        sext_i32_i64(phys_tid_25877),\n                                                                        num_threads_27881));\n    \n    float x_23832;\n    float x_23833;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_27891 = -INFINITY;\n    }\n    for (int64_t i_27896 = 0; i_27896 < chunk_sizze_27892; i_27896++) {\n        gtid_25876 = sext_i32_i64(phys_tid_25877) + num_threads_27881 * i_27896;\n        // apply map function\n        {\n            float x_23835 = ((__global float *) mem_27638)[gtid_25876];\n            int64_t x_23836 = ((__global int64_t *) mem_27636)[gtid_25876];\n            float res_23837 = sitofp_i64_f32(x_23836);\n            float res_23838 = x_23835 * res_23837;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_23832 = x_acc_27891;\n            }\n            // load new values\n            {\n                x_23833 = res_23838;\n            }\n            // apply reduction operator\n            {\n                float res_23834 = fmax32(x_23832, x_23833);\n                \n                // store in accumulator\n                {\n                    x_acc_27891 = res_23834;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_23832 = x_acc_27891;\n        ((__local float *) red_arr_mem_27889)[sext_",
                   "i32_i64(local_tid_27883)] =\n            x_23832;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_27897;\n    int32_t skip_waves_27898;\n    \n    skip_waves_27898 = 1;\n    \n    float x_27893;\n    float x_27894;\n    \n    offset_27897 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_27883, sext_i64_i32(segred_group_sizze_25870))) {\n            x_27893 = ((__local\n                        float *) red_arr_mem_27889)[sext_i32_i64(local_tid_27883 +\n                                                    offset_27897)];\n        }\n    }\n    offset_27897 = 1;\n    while (slt32(offset_27897, wave_sizze_27885)) {\n        if (slt32(local_tid_27883 + offset_27897,\n                  sext_i64_i32(segred_group_sizze_25870)) && ((local_tid_27883 -\n                                                               squot32(local_tid_27883,\n                                                                       wave_sizze_27885) *\n                                                               wave_sizze_27885) &\n                                                              (2 *\n                                                               offset_27897 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_27894 = ((volatile __local\n                            float *) red_arr_mem_27889)[sext_i32_i64(local_tid_27883 +\n                                                        offset_27897)];\n            }\n            // apply reduction operation\n            {\n                float res_27895 = fmax32(x_27893, x_27894);\n                \n                x_27893 = res_27895;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_27889)[sext_i32_i64(local_tid_27883)] =\n                    x_27893;\n            }\n        }\n        offset_27897 *= 2;\n    }\n    while (slt32(skip",
                   "_waves_27898,\n                 squot32(sext_i64_i32(segred_group_sizze_25870) +\n                         wave_sizze_27885 - 1, wave_sizze_27885))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_27897 = skip_waves_27898 * wave_sizze_27885;\n        if (slt32(local_tid_27883 + offset_27897,\n                  sext_i64_i32(segred_group_sizze_25870)) && ((local_tid_27883 -\n                                                               squot32(local_tid_27883,\n                                                                       wave_sizze_27885) *\n                                                               wave_sizze_27885) ==\n                                                              0 &&\n                                                              (squot32(local_tid_27883,\n                                                                       wave_sizze_27885) &\n                                                               (2 *\n                                                                skip_waves_27898 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_27894 = ((__local\n                            float *) red_arr_mem_27889)[sext_i32_i64(local_tid_27883 +\n                                                        offset_27897)];\n            }\n            // apply reduction operation\n            {\n                float res_27895 = fmax32(x_27893, x_27894);\n                \n                x_27893 = res_27895;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_27889)[sext_i32_i64(local_tid_27883)] =\n                    x_27893;\n            }\n        }\n        skip_waves_27898 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_27883) == 0) {\n            x_acc_27891 = x_27893;\n        }\n    }\n  ",
                   "  \n    int32_t old_counter_27899;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_27883 == 0) {\n            ((__global\n              float *) group_res_arr_mem_27879)[sext_i32_i64(group_tid_27884) *\n                                                segred_group_sizze_25870] =\n                x_acc_27891;\n            mem_fence_global();\n            old_counter_27899 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_27877)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_27887)[0] = old_counter_27899 ==\n                num_groups_25872 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_27900;\n    \n    is_last_group_27900 = ((__local bool *) sync_arr_mem_27887)[0];\n    if (is_last_group_27900) {\n        if (local_tid_27883 == 0) {\n            old_counter_27899 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_27877)[0],\n                                                      (int) (0 -\n                                                             num_groups_25872));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_27901 = sdiv_up64(num_groups_25872,\n                                                      segred_group_sizze_25870);\n            \n            x_23832 = -INFINITY;\n            for (int64_t i_27902 = 0; i_27902 < read_per_thread_27901;\n                 i_27902++) {\n                int64_t group_res_id_27903 = sext_i32_i64(local_tid_27883) *\n                        read_per_thread_27901 + i_27902;\n                int64_t index_of_group_res_27904 = group_res_id_27903;\n                \n                if (slt64(group_res_id_27903, num_groups_25872)) {\n                    x_23833 = ((__global\n               ",
                   "                 float *) group_res_arr_mem_27879)[index_of_group_res_27904 *\n                                                                  segred_group_sizze_25870];\n                    \n                    float res_23834;\n                    \n                    res_23834 = fmax32(x_23832, x_23833);\n                    x_23832 = res_23834;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_27889)[sext_i32_i64(local_tid_27883)] =\n            x_23832;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_27905;\n            int32_t skip_waves_27906;\n            \n            skip_waves_27906 = 1;\n            \n            float x_27893;\n            float x_27894;\n            \n            offset_27905 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_27883,\n                          sext_i64_i32(segred_group_sizze_25870))) {\n                    x_27893 = ((__local\n                                float *) red_arr_mem_27889)[sext_i32_i64(local_tid_27883 +\n                                                            offset_27905)];\n                }\n            }\n            offset_27905 = 1;\n            while (slt32(offset_27905, wave_sizze_27885)) {\n                if (slt32(local_tid_27883 + offset_27905,\n                          sext_i64_i32(segred_group_sizze_25870)) &&\n                    ((local_tid_27883 - squot32(local_tid_27883,\n                                                wave_sizze_27885) *\n                      wave_sizze_27885) & (2 * offset_27905 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_27894 = ((volatile __local\n                                    float *) red_arr_mem_27889)[sext_i32_i64(local_tid_27883 +\n                                                                offset_27905)];\n                    }\n                    // appl",
                   "y reduction operation\n                    {\n                        float res_27895 = fmax32(x_27893, x_27894);\n                        \n                        x_27893 = res_27895;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_27889)[sext_i32_i64(local_tid_27883)] =\n                            x_27893;\n                    }\n                }\n                offset_27905 *= 2;\n            }\n            while (slt32(skip_waves_27906,\n                         squot32(sext_i64_i32(segred_group_sizze_25870) +\n                                 wave_sizze_27885 - 1, wave_sizze_27885))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_27905 = skip_waves_27906 * wave_sizze_27885;\n                if (slt32(local_tid_27883 + offset_27905,\n                          sext_i64_i32(segred_group_sizze_25870)) &&\n                    ((local_tid_27883 - squot32(local_tid_27883,\n                                                wave_sizze_27885) *\n                      wave_sizze_27885) == 0 && (squot32(local_tid_27883,\n                                                         wave_sizze_27885) &\n                                                 (2 * skip_waves_27906 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_27894 = ((__local\n                                    float *) red_arr_mem_27889)[sext_i32_i64(local_tid_27883 +\n                                                                offset_27905)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27895 = fmax32(x_27893, x_27894);\n                        \n                        x_27893 = res_27895;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n  ",
                   "                        float *) red_arr_mem_27889)[sext_i32_i64(local_tid_27883)] =\n                            x_27893;\n                    }\n                }\n                skip_waves_27906 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_27883 == 0) {\n                    ((__global float *) mem_27641)[0] = x_27893;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_25870\n}\n__kernel void testzisegred_nonseg_26945(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28029_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28027_backing_aligned_1,\n                                        int64_t num_groups_26940,\n                                        int64_t binop_x_27692, __global\n                                        unsigned char *mem_27742, __global\n                                        unsigned char *mem_27745, __global\n                                        unsigned char *testzicounter_mem_28017,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28019,\n                                        int64_t num_threads_28021)\n{\n    #define segred_group_sizze_26938 (testzisegred_group_sizze_26937)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28029_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28029_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28027_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28027_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n   ",
                   "     return;\n    \n    int32_t global_tid_28022;\n    int32_t local_tid_28023;\n    int64_t group_sizze_28026;\n    int32_t wave_sizze_28025;\n    int32_t group_tid_28024;\n    \n    global_tid_28022 = get_global_id(0);\n    local_tid_28023 = get_local_id(0);\n    group_sizze_28026 = get_local_size(0);\n    wave_sizze_28025 = LOCKSTEP_WIDTH;\n    group_tid_28024 = get_group_id(0);\n    \n    int32_t phys_tid_26945;\n    \n    phys_tid_26945 = global_tid_28022;\n    \n    __local char *sync_arr_mem_28027;\n    \n    sync_arr_mem_28027 = (__local char *) sync_arr_mem_28027_backing_0;\n    \n    __local char *red_arr_mem_28029;\n    \n    red_arr_mem_28029 = (__local char *) red_arr_mem_28029_backing_1;\n    \n    int64_t dummy_26943;\n    \n    dummy_26943 = 0;\n    \n    int64_t gtid_26944;\n    \n    gtid_26944 = 0;\n    \n    int64_t x_acc_28031;\n    int64_t chunk_sizze_28032;\n    \n    chunk_sizze_28032 = smin64(sdiv_up64(binop_x_27692,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_26938 *\n                                         num_groups_26940))),\n                               sdiv_up64(binop_x_27692 -\n                                         sext_i32_i64(phys_tid_26945),\n                                         num_threads_28021));\n    \n    int64_t x_24016;\n    int64_t x_24017;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28031 = 0;\n    }\n    for (int64_t i_28036 = 0; i_28036 < chunk_sizze_28032; i_28036++) {\n        gtid_26944 = sext_i32_i64(phys_tid_26945) + num_threads_28021 * i_28036;\n        // apply map function\n        {\n            int64_t x_24019 = ((__global int64_t *) mem_27742)[gtid_26944];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_24016 = x_acc_28031;\n            }\n            // load new values\n            {\n                x_24017 = x_24019;\n            }\n            // apply reduction operator\n            {\n                int64_",
                   "t res_24018 = add64(x_24016, x_24017);\n                \n                // store in accumulator\n                {\n                    x_acc_28031 = res_24018;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_24016 = x_acc_28031;\n        ((__local int64_t *) red_arr_mem_28029)[sext_i32_i64(local_tid_28023)] =\n            x_24016;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28037;\n    int32_t skip_waves_28038;\n    \n    skip_waves_28038 = 1;\n    \n    int64_t x_28033;\n    int64_t x_28034;\n    \n    offset_28037 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28023, sext_i64_i32(segred_group_sizze_26938))) {\n            x_28033 = ((__local\n                        int64_t *) red_arr_mem_28029)[sext_i32_i64(local_tid_28023 +\n                                                      offset_28037)];\n        }\n    }\n    offset_28037 = 1;\n    while (slt32(offset_28037, wave_sizze_28025)) {\n        if (slt32(local_tid_28023 + offset_28037,\n                  sext_i64_i32(segred_group_sizze_26938)) && ((local_tid_28023 -\n                                                               squot32(local_tid_28023,\n                                                                       wave_sizze_28025) *\n                                                               wave_sizze_28025) &\n                                                              (2 *\n                                                               offset_28037 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28034 = ((volatile __local\n                            int64_t *) red_arr_mem_28029)[sext_i32_i64(local_tid_28023 +\n                                                          offset_28037)];\n            }\n            // apply reduction operation\n            {\n                int64_t res_28",
                   "035 = add64(x_28033, x_28034);\n                \n                x_28033 = res_28035;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_28029)[sext_i32_i64(local_tid_28023)] =\n                    x_28033;\n            }\n        }\n        offset_28037 *= 2;\n    }\n    while (slt32(skip_waves_28038,\n                 squot32(sext_i64_i32(segred_group_sizze_26938) +\n                         wave_sizze_28025 - 1, wave_sizze_28025))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28037 = skip_waves_28038 * wave_sizze_28025;\n        if (slt32(local_tid_28023 + offset_28037,\n                  sext_i64_i32(segred_group_sizze_26938)) && ((local_tid_28023 -\n                                                               squot32(local_tid_28023,\n                                                                       wave_sizze_28025) *\n                                                               wave_sizze_28025) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28023,\n                                                                       wave_sizze_28025) &\n                                                               (2 *\n                                                                skip_waves_28038 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28034 = ((__local\n                            int64_t *) red_arr_mem_28029)[sext_i32_i64(local_tid_28023 +\n                                                          offset_28037)];\n            }\n            // apply reduction operation\n            {\n                int64_t res_28035 = add64(x_28033, x_28034);\n                \n                x_28033 = res_28035;\n            }\n            // write result of operation\n            {\n        ",
                   "        ((__local\n                  int64_t *) red_arr_mem_28029)[sext_i32_i64(local_tid_28023)] =\n                    x_28033;\n            }\n        }\n        skip_waves_28038 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28023) == 0) {\n            x_acc_28031 = x_28033;\n        }\n    }\n    \n    int32_t old_counter_28039;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28023 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_28019)[sext_i32_i64(group_tid_28024) *\n                                                  segred_group_sizze_26938] =\n                x_acc_28031;\n            mem_fence_global();\n            old_counter_28039 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28017)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28027)[0] = old_counter_28039 ==\n                num_groups_26940 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28040;\n    \n    is_last_group_28040 = ((__local bool *) sync_arr_mem_28027)[0];\n    if (is_last_group_28040) {\n        if (local_tid_28023 == 0) {\n            old_counter_28039 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28017)[0],\n                                                      (int) (0 -\n                                                             num_groups_26940));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28041 = sdiv_up64(num_groups_26940,\n                                                      segred_group_sizze_26938);\n            \n            x_24016 = 0;\n            for (int64_t i_28042 = 0; i_28042 < read_per_thread_28",
                   "041;\n                 i_28042++) {\n                int64_t group_res_id_28043 = sext_i32_i64(local_tid_28023) *\n                        read_per_thread_28041 + i_28042;\n                int64_t index_of_group_res_28044 = group_res_id_28043;\n                \n                if (slt64(group_res_id_28043, num_groups_26940)) {\n                    x_24017 = ((__global\n                                int64_t *) group_res_arr_mem_28019)[index_of_group_res_28044 *\n                                                                    segred_group_sizze_26938];\n                    \n                    int64_t res_24018;\n                    \n                    res_24018 = add64(x_24016, x_24017);\n                    x_24016 = res_24018;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_28029)[sext_i32_i64(local_tid_28023)] =\n            x_24016;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28045;\n            int32_t skip_waves_28046;\n            \n            skip_waves_28046 = 1;\n            \n            int64_t x_28033;\n            int64_t x_28034;\n            \n            offset_28045 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28023,\n                          sext_i64_i32(segred_group_sizze_26938))) {\n                    x_28033 = ((__local\n                                int64_t *) red_arr_mem_28029)[sext_i32_i64(local_tid_28023 +\n                                                              offset_28045)];\n                }\n            }\n            offset_28045 = 1;\n            while (slt32(offset_28045, wave_sizze_28025)) {\n                if (slt32(local_tid_28023 + offset_28045,\n                          sext_i64_i32(segred_group_sizze_26938)) &&\n                    ((local_tid_28023 - squot32(local_tid_28023,\n                                                wave_sizze_28025) *\n                    ",
                   "  wave_sizze_28025) & (2 * offset_28045 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28034 = ((volatile __local\n                                    int64_t *) red_arr_mem_28029)[sext_i32_i64(local_tid_28023 +\n                                                                  offset_28045)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_28035 = add64(x_28033, x_28034);\n                        \n                        x_28033 = res_28035;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28029)[sext_i32_i64(local_tid_28023)] =\n                            x_28033;\n                    }\n                }\n                offset_28045 *= 2;\n            }\n            while (slt32(skip_waves_28046,\n                         squot32(sext_i64_i32(segred_group_sizze_26938) +\n                                 wave_sizze_28025 - 1, wave_sizze_28025))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28045 = skip_waves_28046 * wave_sizze_28025;\n                if (slt32(local_tid_28023 + offset_28045,\n                          sext_i64_i32(segred_group_sizze_26938)) &&\n                    ((local_tid_28023 - squot32(local_tid_28023,\n                                                wave_sizze_28025) *\n                      wave_sizze_28025) == 0 && (squot32(local_tid_28023,\n                                                         wave_sizze_28025) &\n                                                 (2 * skip_waves_28046 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28034 = ((__local\n                                    int64_t *) red_arr_mem_28029)[sext_i32_i64(local_tid_28023 +\n                                    ",
                   "                              offset_28045)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_28035 = add64(x_28033, x_28034);\n                        \n                        x_28033 = res_28035;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_28029)[sext_i32_i64(local_tid_28023)] =\n                            x_28033;\n                    }\n                }\n                skip_waves_28046 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28023 == 0) {\n                    ((__global int64_t *) mem_27745)[0] = x_28033;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_26938\n}\n__kernel void testzisegred_nonseg_27054(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28490_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28488_backing_aligned_1,\n                                        int64_t paths_23826,\n                                        int64_t steps_23827,\n                                        float sims_per_year_23906,\n                                        float res_24226,\n                                        int64_t num_groups_27057, __global\n                                        unsigned char *mem_27779, __global\n                                        unsigned char *mem_27782, __global\n                                        unsigned char *testzicounter_mem_28478,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28480,\n                                        int6",
                   "4_t num_threads_28482)\n{\n    #define segred_group_sizze_27056 (testzisegred_group_sizze_27046)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28490_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28490_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28488_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28488_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28483;\n    int32_t local_tid_28484;\n    int64_t group_sizze_28487;\n    int32_t wave_sizze_28486;\n    int32_t group_tid_28485;\n    \n    global_tid_28483 = get_global_id(0);\n    local_tid_28484 = get_local_id(0);\n    group_sizze_28487 = get_local_size(0);\n    wave_sizze_28486 = LOCKSTEP_WIDTH;\n    group_tid_28485 = get_group_id(0);\n    \n    int32_t phys_tid_27054;\n    \n    phys_tid_27054 = global_tid_28483;\n    \n    __local char *sync_arr_mem_28488;\n    \n    sync_arr_mem_28488 = (__local char *) sync_arr_mem_28488_backing_0;\n    \n    __local char *red_arr_mem_28490;\n    \n    red_arr_mem_28490 = (__local char *) red_arr_mem_28490_backing_1;\n    \n    int64_t dummy_27052;\n    \n    dummy_27052 = 0;\n    \n    int64_t gtid_27053;\n    \n    gtid_27053 = 0;\n    \n    float x_acc_28492;\n    int64_t chunk_sizze_28493;\n    \n    chunk_sizze_28493 = smin64(sdiv_up64(steps_23827,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_27056 *\n                                         num_groups_27057))),\n                               sdiv_up64(steps_23827 -\n                                         sext_i32_i64(phys_tid_27054),\n                                         num_threads_28482));\n    \n    float x_27060;\n    float x_27061;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28492 = 0.0F;\n    }\n    for (int64_t",
                   " i_28497 = 0; i_28497 < chunk_sizze_28493; i_28497++) {\n        gtid_27053 = sext_i32_i64(phys_tid_27054) + num_threads_28482 * i_28497;\n        // apply map function\n        {\n            int64_t convop_x_27558 = add64(1, gtid_27053);\n            float binop_x_27559 = sitofp_i64_f32(convop_x_27558);\n            float index_primexp_27560 = binop_x_27559 / sims_per_year_23906;\n            float res_27065;\n            float redout_27612 = 0.0F;\n            \n            for (int64_t i_27613 = 0; i_27613 < paths_23826; i_27613++) {\n                float res_27070;\n                float redout_27614 = 0.0F;\n                \n                for (int32_t i_27624 = 0; i_27624 < 45; i_27624++) {\n                    int64_t i_27615 = sext_i32_i64(i_27624);\n                    float x_27074 = ((__global float *) mem_27779)[i_27613 *\n                                                                   (steps_23827 *\n                                                                    45) +\n                                                                   i_27615 *\n                                                                   steps_23827 +\n                                                                   gtid_27053];\n                    float res_27073 = x_27074 + redout_27614;\n                    float redout_tmp_28499 = res_27073;\n                    \n                    redout_27614 = redout_tmp_28499;\n                }\n                res_27070 = redout_27614;\n                \n                float res_27075 = fmax32(0.0F, res_27070);\n                float res_27068 = res_27075 + redout_27612;\n                float redout_tmp_28498 = res_27068;\n                \n                redout_27612 = redout_tmp_28498;\n            }\n            res_27065 = redout_27612;\n            \n            float res_27076 = res_27065 / res_24226;\n            float negate_arg_27077 = 1.0e-2F * index_primexp_27560;\n            float exp_arg_27078 = 0.0F - negate_arg_27077;\n            float res",
                   "_27079 = fpow32(2.7182817F, exp_arg_27078);\n            float x_27080 = 1.0F - res_27079;\n            float B_27081 = x_27080 / 1.0e-2F;\n            float x_27082 = B_27081 - index_primexp_27560;\n            float x_27083 = 4.4999997e-6F * x_27082;\n            float A1_27084 = x_27083 / 1.0e-4F;\n            float y_27085 = fpow32(B_27081, 2.0F);\n            float x_27086 = 1.0000001e-6F * y_27085;\n            float A2_27087 = x_27086 / 4.0e-2F;\n            float exp_arg_27088 = A1_27084 - A2_27087;\n            float res_27089 = fpow32(2.7182817F, exp_arg_27088);\n            float negate_arg_27090 = 5.0e-2F * B_27081;\n            float exp_arg_27091 = 0.0F - negate_arg_27090;\n            float res_27092 = fpow32(2.7182817F, exp_arg_27091);\n            float res_27093 = res_27089 * res_27092;\n            float res_27094 = res_27076 * res_27093;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_27060 = x_acc_28492;\n            }\n            // load new values\n            {\n                x_27061 = res_27094;\n            }\n            // apply reduction operator\n            {\n                float res_27062 = x_27060 + x_27061;\n                \n                // store in accumulator\n                {\n                    x_acc_28492 = res_27062;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_27060 = x_acc_28492;\n        ((__local float *) red_arr_mem_28490)[sext_i32_i64(local_tid_28484)] =\n            x_27060;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28500;\n    int32_t skip_waves_28501;\n    \n    skip_waves_28501 = 1;\n    \n    float x_28494;\n    float x_28495;\n    \n    offset_28500 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28484, sext_i64_i32(segred_group_sizze_27056))) {\n            x_28494 = ((__local\n                        float *) red",
                   "_arr_mem_28490)[sext_i32_i64(local_tid_28484 +\n                                                    offset_28500)];\n        }\n    }\n    offset_28500 = 1;\n    while (slt32(offset_28500, wave_sizze_28486)) {\n        if (slt32(local_tid_28484 + offset_28500,\n                  sext_i64_i32(segred_group_sizze_27056)) && ((local_tid_28484 -\n                                                               squot32(local_tid_28484,\n                                                                       wave_sizze_28486) *\n                                                               wave_sizze_28486) &\n                                                              (2 *\n                                                               offset_28500 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28495 = ((volatile __local\n                            float *) red_arr_mem_28490)[sext_i32_i64(local_tid_28484 +\n                                                        offset_28500)];\n            }\n            // apply reduction operation\n            {\n                float res_28496 = x_28494 + x_28495;\n                \n                x_28494 = res_28496;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_28490)[sext_i32_i64(local_tid_28484)] =\n                    x_28494;\n            }\n        }\n        offset_28500 *= 2;\n    }\n    while (slt32(skip_waves_28501,\n                 squot32(sext_i64_i32(segred_group_sizze_27056) +\n                         wave_sizze_28486 - 1, wave_sizze_28486))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28500 = skip_waves_28501 * wave_sizze_28486;\n        if (slt32(local_tid_28484 + offset_28500,\n                  sext_i64_i32(segred_group_sizze_27056)) && ((local_tid_28484 -\n                                                               squot32(local_tid_28484",
                   ",\n                                                                       wave_sizze_28486) *\n                                                               wave_sizze_28486) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28484,\n                                                                       wave_sizze_28486) &\n                                                               (2 *\n                                                                skip_waves_28501 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28495 = ((__local\n                            float *) red_arr_mem_28490)[sext_i32_i64(local_tid_28484 +\n                                                        offset_28500)];\n            }\n            // apply reduction operation\n            {\n                float res_28496 = x_28494 + x_28495;\n                \n                x_28494 = res_28496;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_28490)[sext_i32_i64(local_tid_28484)] =\n                    x_28494;\n            }\n        }\n        skip_waves_28501 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28484) == 0) {\n            x_acc_28492 = x_28494;\n        }\n    }\n    \n    int32_t old_counter_28502;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28484 == 0) {\n            ((__global\n              float *) group_res_arr_mem_28480)[sext_i32_i64(group_tid_28485) *\n                                                segred_group_sizze_27056] =\n                x_acc_28492;\n            mem_fence_global();\n            old_counter_28502 = atomic_add_i32_global(&((volatile __global\n          ",
                   "                                               int *) testzicounter_mem_28478)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28488)[0] = old_counter_28502 ==\n                num_groups_27057 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28503;\n    \n    is_last_group_28503 = ((__local bool *) sync_arr_mem_28488)[0];\n    if (is_last_group_28503) {\n        if (local_tid_28484 == 0) {\n            old_counter_28502 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28478)[0],\n                                                      (int) (0 -\n                                                             num_groups_27057));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28504 = sdiv_up64(num_groups_27057,\n                                                      segred_group_sizze_27056);\n            \n            x_27060 = 0.0F;\n            for (int64_t i_28505 = 0; i_28505 < read_per_thread_28504;\n                 i_28505++) {\n                int64_t group_res_id_28506 = sext_i32_i64(local_tid_28484) *\n                        read_per_thread_28504 + i_28505;\n                int64_t index_of_group_res_28507 = group_res_id_28506;\n                \n                if (slt64(group_res_id_28506, num_groups_27057)) {\n                    x_27061 = ((__global\n                                float *) group_res_arr_mem_28480)[index_of_group_res_28507 *\n                                                                  segred_group_sizze_27056];\n                    \n                    float res_27062;\n                    \n                    res_27062 = x_27060 + x_27061;\n                    x_27060 = res_27062;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_28490)[sext_i32_i64(local_tid_28484)] =\n            x",
                   "_27060;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28508;\n            int32_t skip_waves_28509;\n            \n            skip_waves_28509 = 1;\n            \n            float x_28494;\n            float x_28495;\n            \n            offset_28508 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28484,\n                          sext_i64_i32(segred_group_sizze_27056))) {\n                    x_28494 = ((__local\n                                float *) red_arr_mem_28490)[sext_i32_i64(local_tid_28484 +\n                                                            offset_28508)];\n                }\n            }\n            offset_28508 = 1;\n            while (slt32(offset_28508, wave_sizze_28486)) {\n                if (slt32(local_tid_28484 + offset_28508,\n                          sext_i64_i32(segred_group_sizze_27056)) &&\n                    ((local_tid_28484 - squot32(local_tid_28484,\n                                                wave_sizze_28486) *\n                      wave_sizze_28486) & (2 * offset_28508 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28495 = ((volatile __local\n                                    float *) red_arr_mem_28490)[sext_i32_i64(local_tid_28484 +\n                                                                offset_28508)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28496 = x_28494 + x_28495;\n                        \n                        x_28494 = res_28496;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_28490)[sext_i32_i64(local_tid_28484)] =\n                            x_28494;\n                    }\n                }\n        ",
                   "        offset_28508 *= 2;\n            }\n            while (slt32(skip_waves_28509,\n                         squot32(sext_i64_i32(segred_group_sizze_27056) +\n                                 wave_sizze_28486 - 1, wave_sizze_28486))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28508 = skip_waves_28509 * wave_sizze_28486;\n                if (slt32(local_tid_28484 + offset_28508,\n                          sext_i64_i32(segred_group_sizze_27056)) &&\n                    ((local_tid_28484 - squot32(local_tid_28484,\n                                                wave_sizze_28486) *\n                      wave_sizze_28486) == 0 && (squot32(local_tid_28484,\n                                                         wave_sizze_28486) &\n                                                 (2 * skip_waves_28509 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28495 = ((__local\n                                    float *) red_arr_mem_28490)[sext_i32_i64(local_tid_28484 +\n                                                                offset_28508)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28496 = x_28494 + x_28495;\n                        \n                        x_28494 = res_28496;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_28490)[sext_i32_i64(local_tid_28484)] =\n                            x_28494;\n                    }\n                }\n                skip_waves_28509 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28484 == 0) {\n                    ((__global float *) mem_27782)[0] = x_28494;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_siz",
                   "ze_27056\n}\n__kernel void testzisegred_nonseg_27320(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28614_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28612_backing_aligned_1,\n                                        int64_t steps_23827,\n                                        int64_t num_groups_27446, __global\n                                        unsigned char *res_map_acc_mem_27809,\n                                        __global unsigned char *mem_27812,\n                                        __global\n                                        unsigned char *testzicounter_mem_28602,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28604,\n                                        int64_t num_threads_28606)\n{\n    #define segred_group_sizze_27445 (testzisegred_group_sizze_27312)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28614_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28614_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28612_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28612_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28607;\n    int32_t local_tid_28608;\n    int64_t group_sizze_28611;\n    int32_t wave_sizze_28610;\n    int32_t group_tid_28609;\n    \n    global_tid_28607 = get_global_id(0);\n    local_tid_28608 = get_local_id(0);\n    group_sizze_28611 = get_local_size(0);\n    wave_sizze_28610 = LOCKSTEP_WIDTH;\n    group_tid_28609 = get_group_id(0);\n    \n    int32_t phys_tid_27320;\n    \n    phys_tid_27320 = global_tid_2860",
                   "7;\n    \n    __local char *sync_arr_mem_28612;\n    \n    sync_arr_mem_28612 = (__local char *) sync_arr_mem_28612_backing_0;\n    \n    __local char *red_arr_mem_28614;\n    \n    red_arr_mem_28614 = (__local char *) red_arr_mem_28614_backing_1;\n    \n    int64_t dummy_27318;\n    \n    dummy_27318 = 0;\n    \n    int64_t gtid_27319;\n    \n    gtid_27319 = 0;\n    \n    float x_acc_28616;\n    int64_t chunk_sizze_28617;\n    \n    chunk_sizze_28617 = smin64(sdiv_up64(steps_23827,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_27445 *\n                                         num_groups_27446))),\n                               sdiv_up64(steps_23827 -\n                                         sext_i32_i64(phys_tid_27320),\n                                         num_threads_28606));\n    \n    float x_27449;\n    float x_27450;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28616 = 0.0F;\n    }\n    for (int64_t i_28621 = 0; i_28621 < chunk_sizze_28617; i_28621++) {\n        gtid_27319 = sext_i32_i64(phys_tid_27320) + num_threads_28606 * i_28621;\n        // apply map function\n        {\n            float x_27452 = ((__global\n                              float *) res_map_acc_mem_27809)[gtid_27319];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_27449 = x_acc_28616;\n            }\n            // load new values\n            {\n                x_27450 = x_27452;\n            }\n            // apply reduction operator\n            {\n                float res_27451 = x_27449 + x_27450;\n                \n                // store in accumulator\n                {\n                    x_acc_28616 = res_27451;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_27449 = x_acc_28616;\n        ((__local float *) red_arr_mem_28614)[sext_i32_i64(local_tid_28608)] =\n            x_27449;\n    }\n    barri",
                   "er(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28622;\n    int32_t skip_waves_28623;\n    \n    skip_waves_28623 = 1;\n    \n    float x_28618;\n    float x_28619;\n    \n    offset_28622 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28608, sext_i64_i32(segred_group_sizze_27445))) {\n            x_28618 = ((__local\n                        float *) red_arr_mem_28614)[sext_i32_i64(local_tid_28608 +\n                                                    offset_28622)];\n        }\n    }\n    offset_28622 = 1;\n    while (slt32(offset_28622, wave_sizze_28610)) {\n        if (slt32(local_tid_28608 + offset_28622,\n                  sext_i64_i32(segred_group_sizze_27445)) && ((local_tid_28608 -\n                                                               squot32(local_tid_28608,\n                                                                       wave_sizze_28610) *\n                                                               wave_sizze_28610) &\n                                                              (2 *\n                                                               offset_28622 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28619 = ((volatile __local\n                            float *) red_arr_mem_28614)[sext_i32_i64(local_tid_28608 +\n                                                        offset_28622)];\n            }\n            // apply reduction operation\n            {\n                float res_28620 = x_28618 + x_28619;\n                \n                x_28618 = res_28620;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_28614)[sext_i32_i64(local_tid_28608)] =\n                    x_28618;\n            }\n        }\n        offset_28622 *= 2;\n    }\n    while (slt32(skip_waves_28623,\n                 squot32(sext_i64_i32(segred_group_sizze_",
                   "27445) +\n                         wave_sizze_28610 - 1, wave_sizze_28610))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28622 = skip_waves_28623 * wave_sizze_28610;\n        if (slt32(local_tid_28608 + offset_28622,\n                  sext_i64_i32(segred_group_sizze_27445)) && ((local_tid_28608 -\n                                                               squot32(local_tid_28608,\n                                                                       wave_sizze_28610) *\n                                                               wave_sizze_28610) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28608,\n                                                                       wave_sizze_28610) &\n                                                               (2 *\n                                                                skip_waves_28623 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28619 = ((__local\n                            float *) red_arr_mem_28614)[sext_i32_i64(local_tid_28608 +\n                                                        offset_28622)];\n            }\n            // apply reduction operation\n            {\n                float res_28620 = x_28618 + x_28619;\n                \n                x_28618 = res_28620;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_28614)[sext_i32_i64(local_tid_28608)] =\n                    x_28618;\n            }\n        }\n        skip_waves_28623 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28608) == 0) {\n            x_acc_28616 = x_28618;\n        }\n    }\n    \n    int32_t old_counter_28624;\n    \n    // first thread in group saves grou",
                   "p result to global memory\n    {\n        if (local_tid_28608 == 0) {\n            ((__global\n              float *) group_res_arr_mem_28604)[sext_i32_i64(group_tid_28609) *\n                                                segred_group_sizze_27445] =\n                x_acc_28616;\n            mem_fence_global();\n            old_counter_28624 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28602)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28612)[0] = old_counter_28624 ==\n                num_groups_27446 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28625;\n    \n    is_last_group_28625 = ((__local bool *) sync_arr_mem_28612)[0];\n    if (is_last_group_28625) {\n        if (local_tid_28608 == 0) {\n            old_counter_28624 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28602)[0],\n                                                      (int) (0 -\n                                                             num_groups_27446));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28626 = sdiv_up64(num_groups_27446,\n                                                      segred_group_sizze_27445);\n            \n            x_27449 = 0.0F;\n            for (int64_t i_28627 = 0; i_28627 < read_per_thread_28626;\n                 i_28627++) {\n                int64_t group_res_id_28628 = sext_i32_i64(local_tid_28608) *\n                        read_per_thread_28626 + i_28627;\n                int64_t index_of_group_res_28629 = group_res_id_28628;\n                \n                if (slt64(group_res_id_28628, num_groups_27446)) {\n                    x_27450 = ((__global\n                                float *) group_res_arr_mem_28604)[index_of_group_res_28629 *\n     ",
                   "                                                             segred_group_sizze_27445];\n                    \n                    float res_27451;\n                    \n                    res_27451 = x_27449 + x_27450;\n                    x_27449 = res_27451;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_28614)[sext_i32_i64(local_tid_28608)] =\n            x_27449;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28630;\n            int32_t skip_waves_28631;\n            \n            skip_waves_28631 = 1;\n            \n            float x_28618;\n            float x_28619;\n            \n            offset_28630 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28608,\n                          sext_i64_i32(segred_group_sizze_27445))) {\n                    x_28618 = ((__local\n                                float *) red_arr_mem_28614)[sext_i32_i64(local_tid_28608 +\n                                                            offset_28630)];\n                }\n            }\n            offset_28630 = 1;\n            while (slt32(offset_28630, wave_sizze_28610)) {\n                if (slt32(local_tid_28608 + offset_28630,\n                          sext_i64_i32(segred_group_sizze_27445)) &&\n                    ((local_tid_28608 - squot32(local_tid_28608,\n                                                wave_sizze_28610) *\n                      wave_sizze_28610) & (2 * offset_28630 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28619 = ((volatile __local\n                                    float *) red_arr_mem_28614)[sext_i32_i64(local_tid_28608 +\n                                                                offset_28630)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28620 = x_28",
                   "618 + x_28619;\n                        \n                        x_28618 = res_28620;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_28614)[sext_i32_i64(local_tid_28608)] =\n                            x_28618;\n                    }\n                }\n                offset_28630 *= 2;\n            }\n            while (slt32(skip_waves_28631,\n                         squot32(sext_i64_i32(segred_group_sizze_27445) +\n                                 wave_sizze_28610 - 1, wave_sizze_28610))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28630 = skip_waves_28631 * wave_sizze_28610;\n                if (slt32(local_tid_28608 + offset_28630,\n                          sext_i64_i32(segred_group_sizze_27445)) &&\n                    ((local_tid_28608 - squot32(local_tid_28608,\n                                                wave_sizze_28610) *\n                      wave_sizze_28610) == 0 && (squot32(local_tid_28608,\n                                                         wave_sizze_28610) &\n                                                 (2 * skip_waves_28631 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28619 = ((__local\n                                    float *) red_arr_mem_28614)[sext_i32_i64(local_tid_28608 +\n                                                                offset_28630)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28620 = x_28618 + x_28619;\n                        \n                        x_28618 = res_28620;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_28614)[sext_i32_i64(local_tid_28608)] =\n                   ",
                   "         x_28618;\n                    }\n                }\n                skip_waves_28631 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28608 == 0) {\n                    ((__global float *) mem_27812)[0] = x_28618;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27445\n}\n__kernel void testzisegred_small_27255(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *red_arr_mem_28540_backing_aligned_0,\n                                       int64_t paths_23826, int64_t steps_23827,\n                                       int64_t num_groups_27404, __global\n                                       unsigned char *mem_27801, __global\n                                       unsigned char *mem_27804,\n                                       int64_t segment_sizze_nonzzero_28533)\n{\n    #define segred_group_sizze_27403 (testzisegred_group_sizze_27249)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28540_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28540_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28535;\n    int32_t local_tid_28536;\n    int64_t group_sizze_28539;\n    int32_t wave_sizze_28538;\n    int32_t group_tid_28537;\n    \n    global_tid_28535 = get_global_id(0);\n    local_tid_28536 = get_local_id(0);\n    group_sizze_28539 = get_local_size(0);\n    wave_sizze_28538 = LOCKSTEP_WIDTH;\n    group_tid_28537 = get_group_id(0);\n    \n    int32_t phys_tid_27255;\n    \n    phys_tid_27255 = global_tid_28535;\n    \n    __local char *red_arr_mem_28540;\n    \n    red_arr_mem_28540 = (__local char *) red_arr_mem_28540_backing_0;\n    \n    int32_t phys_group_id_28542;\n    \n    phys_group_id_",
                   "28542 = get_group_id(0);\n    for (int32_t i_28543 = 0; i_28543 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(steps_23827,\n                                          squot64(segred_group_sizze_27403,\n                                                  segment_sizze_nonzzero_28533))) -\n                   phys_group_id_28542, sext_i64_i32(num_groups_27404));\n         i_28543++) {\n        int32_t virt_group_id_28544 = phys_group_id_28542 + i_28543 *\n                sext_i64_i32(num_groups_27404);\n        int64_t gtid_27246 = squot64(sext_i32_i64(local_tid_28536),\n                                     segment_sizze_nonzzero_28533) +\n                sext_i32_i64(virt_group_id_28544) *\n                squot64(segred_group_sizze_27403, segment_sizze_nonzzero_28533);\n        int64_t gtid_27254 = srem64(sext_i32_i64(local_tid_28536), paths_23826);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, paths_23826) && (slt64(gtid_27246, steps_23827) &&\n                                          slt64(sext_i32_i64(local_tid_28536),\n                                                paths_23826 *\n                                                squot64(segred_group_sizze_27403,\n                                                        segment_sizze_nonzzero_28533)))) {\n                float res_27412;\n                float redout_27622 = 0.0F;\n                \n                for (int32_t i_27627 = 0; i_27627 < 45; i_27627++) {\n                    int64_t i_27623 = sext_i32_i64(i_27627);\n                    float x_27416 = ((__global float *) mem_27801)[i_27623 *\n                                                                   (steps_23827 *\n                                                                    paths_23826) +\n                                                                   gtid_27254 *\n                                                                   steps_23827 +\n                                                                   gtid_27246]",
                   ";\n                    float res_27415 = x_27416 + redout_27622;\n                    float redout_tmp_28545 = res_27415;\n                    \n                    redout_27622 = redout_tmp_28545;\n                }\n                res_27412 = redout_27622;\n                \n                float res_27417 = fmax32(0.0F, res_27412);\n                \n                // save map-out results\n                { }\n                // save results to be reduced\n                {\n                    ((__local\n                      float *) red_arr_mem_28540)[sext_i32_i64(local_tid_28536)] =\n                        res_27417;\n                }\n            } else {\n                ((__local\n                  float *) red_arr_mem_28540)[sext_i32_i64(local_tid_28536)] =\n                    0.0F;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, paths_23826)) {\n            // perform segmented scan to imitate reduction\n            {\n                float x_27407;\n                float x_27408;\n                float x_28546;\n                float x_28547;\n                bool ltid_in_bounds_28549;\n                \n                ltid_in_bounds_28549 = slt64(sext_i32_i64(local_tid_28536),\n                                             paths_23826 *\n                                             squot64(segred_group_sizze_27403,\n                                                     segment_sizze_nonzzero_28533));\n                \n                int32_t skip_threads_28550;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_28549) {\n                        x_27408 = ((volatile __local\n                                    float *) red_arr_mem_28540)[sext_i32_i64(local_tid_28536)];\n                        if ((local_tid_28536 - squot32(local_tid_28536, 32) *\n                             32) == 0) {\n                            x_27407 = x_27408;\n                        }\n                    }\n ",
                   "               }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28550 = 1;\n                    while (slt32(skip_threads_28550, 32)) {\n                        if (sle32(skip_threads_28550, local_tid_28536 -\n                                  squot32(local_tid_28536, 32) * 32) &&\n                            ltid_in_bounds_28549) {\n                            // read operands\n                            {\n                                x_27407 = ((volatile __local\n                                            float *) red_arr_mem_28540)[sext_i32_i64(local_tid_28536) -\n                                                                        sext_i32_i64(skip_threads_28550)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_28551 =\n                                     slt64(srem64(sext_i32_i64(local_tid_28536),\n                                                  paths_23826),\n                                           sext_i32_i64(local_tid_28536) -\n                                           sext_i32_i64(local_tid_28536 -\n                                           skip_threads_28550));\n                                \n                                if (inactive_28551) {\n                                    x_27407 = x_27408;\n                                }\n                                if (!inactive_28551) {\n                                    float res_27409 = x_27407 + x_27408;\n                                    \n                                    x_27407 = res_27409;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_28538, skip_threads_28550)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28550, local_tid_28536 -\n             ",
                   "                     squot32(local_tid_28536, 32) * 32) &&\n                            ltid_in_bounds_28549) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_28540)[sext_i32_i64(local_tid_28536)] =\n                                    x_27407;\n                                x_27408 = x_27407;\n                            }\n                        }\n                        if (sle32(wave_sizze_28538, skip_threads_28550)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28550 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_28536 - squot32(local_tid_28536, 32) * 32) ==\n                        31 && ltid_in_bounds_28549) {\n                        ((volatile __local\n                          float *) red_arr_mem_28540)[sext_i32_i64(squot32(local_tid_28536,\n                                                                           32))] =\n                            x_27407;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_28552;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_28536, 32) == 0 &&\n                            ltid_in_bounds_28549) {\n                            x_28547 = ((volatile __local\n                                        float *) red_arr_mem_28540)[sext_i32_i64(local_tid_28536)];\n                            if ((local_tid_28536 - squot32(local_tid_28536,\n                                            ",
                   "               32) * 32) == 0) {\n                                x_28546 = x_28547;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_28552 = 1;\n                        while (slt32(skip_threads_28552, 32)) {\n                            if (sle32(skip_threads_28552, local_tid_28536 -\n                                      squot32(local_tid_28536, 32) * 32) &&\n                                (squot32(local_tid_28536, 32) == 0 &&\n                                 ltid_in_bounds_28549)) {\n                                // read operands\n                                {\n                                    x_28546 = ((volatile __local\n                                                float *) red_arr_mem_28540)[sext_i32_i64(local_tid_28536) -\n                                                                            sext_i32_i64(skip_threads_28552)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_28553 =\n                                         slt64(srem64(sext_i32_i64(local_tid_28536 *\n                                                      32 + 32 - 1),\n                                                      paths_23826),\n                                               sext_i32_i64(local_tid_28536 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_28536 -\n                                                             skip_threads_28552) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_28553) {\n                                        x_28546 = x_28547;\n                                    }\n                                 ",
                   "   if (!inactive_28553) {\n                                        float res_28548 = x_28546 + x_28547;\n                                        \n                                        x_28546 = res_28548;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_28538, skip_threads_28552)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_28552, local_tid_28536 -\n                                      squot32(local_tid_28536, 32) * 32) &&\n                                (squot32(local_tid_28536, 32) == 0 &&\n                                 ltid_in_bounds_28549)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      float *) red_arr_mem_28540)[sext_i32_i64(local_tid_28536)] =\n                                        x_28546;\n                                    x_28547 = x_28546;\n                                }\n                            }\n                            if (sle32(wave_sizze_28538, skip_threads_28552)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_28552 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_28536, 32) == 0 ||\n                          !ltid_in_bounds_28549)) {\n                        // read operands\n                        {\n                            x_27408 = x_27407;\n                            x_27407 = ((__local\n                                        float *) red_arr_mem_28540)[sext_i32_i64(squot32(local_tid_28536,\n                                        ",
                   "                                                 32)) -\n                                                                    1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_28554 =\n                                 slt64(srem64(sext_i32_i64(local_tid_28536),\n                                              paths_23826),\n                                       sext_i32_i64(local_tid_28536) -\n                                       sext_i32_i64(squot32(local_tid_28536,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_28554) {\n                                x_27407 = x_27408;\n                            }\n                            if (!inactive_28554) {\n                                float res_27409 = x_27407 + x_27408;\n                                \n                                x_27407 = res_27409;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              float *) red_arr_mem_28540)[sext_i32_i64(local_tid_28536)] =\n                                x_27407;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_28536, 32) == 0) {\n                        ((__local\n                          float *) red_arr_mem_28540)[sext_i32_i64(local_tid_28536)] =\n                            x_27408;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_28544) *\n                      squot64(segred",
                   "_group_sizze_27403,\n                              segment_sizze_nonzzero_28533) +\n                      sext_i32_i64(local_tid_28536), steps_23827) &&\n                slt64(sext_i32_i64(local_tid_28536),\n                      squot64(segred_group_sizze_27403,\n                              segment_sizze_nonzzero_28533))) {\n                ((__global\n                  float *) mem_27804)[sext_i32_i64(virt_group_id_28544) *\n                                      squot64(segred_group_sizze_27403,\n                                              segment_sizze_nonzzero_28533) +\n                                      sext_i32_i64(local_tid_28536)] = ((__local\n                                                                         float *) red_arr_mem_28540)[(sext_i32_i64(local_tid_28536) +\n                                                                                                      1) *\n                                                                                                     segment_sizze_nonzzero_28533 -\n                                                                                                     1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27403\n}\n__kernel void testzisegred_small_28143(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *red_arr_mem_28151_backing_aligned_0,\n                                       int64_t res_24015,\n                                       int64_t num_groups_26950, __global\n                                       unsigned char *mem_27747,\n                                       int32_t num_subhistos_28057, __global\n                                       unsigned char *res_subhistos_mem_28058,\n                                       int64_t segment_sizze_nonzzero_28144)\n{\n    #define seghist_group_siz",
                   "ze_26948 (testziseghist_group_sizze_26947)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28151_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28151_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28146;\n    int32_t local_tid_28147;\n    int64_t group_sizze_28150;\n    int32_t wave_sizze_28149;\n    int32_t group_tid_28148;\n    \n    global_tid_28146 = get_global_id(0);\n    local_tid_28147 = get_local_id(0);\n    group_sizze_28150 = get_local_size(0);\n    wave_sizze_28149 = LOCKSTEP_WIDTH;\n    group_tid_28148 = get_group_id(0);\n    \n    int32_t flat_gtid_28143;\n    \n    flat_gtid_28143 = global_tid_28146;\n    \n    __local char *red_arr_mem_28151;\n    \n    red_arr_mem_28151 = (__local char *) red_arr_mem_28151_backing_0;\n    \n    int32_t phys_group_id_28153;\n    \n    phys_group_id_28153 = get_group_id(0);\n    for (int32_t i_28154 = 0; i_28154 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(res_24015,\n                                          squot64(seghist_group_sizze_26948,\n                                                  segment_sizze_nonzzero_28144))) -\n                   phys_group_id_28153, sext_i64_i32(num_groups_26950));\n         i_28154++) {\n        int32_t virt_group_id_28155 = phys_group_id_28153 + i_28154 *\n                sext_i64_i32(num_groups_26950);\n        int64_t bucket_id_28141 = squot64(sext_i32_i64(local_tid_28147),\n                                          segment_sizze_nonzzero_28144) +\n                sext_i32_i64(virt_group_id_28155) *\n                squot64(seghist_group_sizze_26948,\n                        segment_sizze_nonzzero_28144);\n        int64_t subhistogram_id_28142 = srem64(sext_i32_i64(local_tid_28147),\n                                               num_subhistos_28057);\n        \n        // apply map function if in bounds\n        {\n      ",
                   "      if (slt64(0, num_subhistos_28057) && (slt64(bucket_id_28141,\n                                                        res_24015) &&\n                                                  slt64(sext_i32_i64(local_tid_28147),\n                                                        num_subhistos_28057 *\n                                                        squot64(seghist_group_sizze_26948,\n                                                                segment_sizze_nonzzero_28144)))) {\n                // save results to be reduced\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_28151)[sext_i32_i64(local_tid_28147)] =\n                        ((__global\n                          int64_t *) res_subhistos_mem_28058)[subhistogram_id_28142 *\n                                                              res_24015 +\n                                                              bucket_id_28141];\n                }\n            } else {\n                ((__local\n                  int64_t *) red_arr_mem_28151)[sext_i32_i64(local_tid_28147)] =\n                    0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, num_subhistos_28057)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t x_26954;\n                int64_t x_26955;\n                int64_t x_28156;\n                int64_t x_28157;\n                bool ltid_in_bounds_28159;\n                \n                ltid_in_bounds_28159 = slt64(sext_i32_i64(local_tid_28147),\n                                             num_subhistos_28057 *\n                                             squot64(seghist_group_sizze_26948,\n                                                     segment_sizze_nonzzero_28144));\n                \n                int32_t skip_threads_28160;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_28159) {\n             ",
                   "           x_26955 = ((volatile __local\n                                    int64_t *) red_arr_mem_28151)[sext_i32_i64(local_tid_28147)];\n                        if ((local_tid_28147 - squot32(local_tid_28147, 32) *\n                             32) == 0) {\n                            x_26954 = x_26955;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28160 = 1;\n                    while (slt32(skip_threads_28160, 32)) {\n                        if (sle32(skip_threads_28160, local_tid_28147 -\n                                  squot32(local_tid_28147, 32) * 32) &&\n                            ltid_in_bounds_28159) {\n                            // read operands\n                            {\n                                x_26954 = ((volatile __local\n                                            int64_t *) red_arr_mem_28151)[sext_i32_i64(local_tid_28147) -\n                                                                          sext_i32_i64(skip_threads_28160)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_28161 =\n                                     slt64(srem64(sext_i32_i64(local_tid_28147),\n                                                  num_subhistos_28057),\n                                           sext_i32_i64(local_tid_28147) -\n                                           sext_i32_i64(local_tid_28147 -\n                                           skip_threads_28160));\n                                \n                                if (inactive_28161) {\n                                    x_26954 = x_26955;\n                                }\n                                if (!inactive_28161) {\n                                    int64_t res_26956 = smax64(x_26954,\n                                                               x",
                   "_26955);\n                                    \n                                    x_26954 = res_26956;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_28149, skip_threads_28160)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28160, local_tid_28147 -\n                                  squot32(local_tid_28147, 32) * 32) &&\n                            ltid_in_bounds_28159) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_28151)[sext_i32_i64(local_tid_28147)] =\n                                    x_26954;\n                                x_26955 = x_26954;\n                            }\n                        }\n                        if (sle32(wave_sizze_28149, skip_threads_28160)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28160 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_28147 - squot32(local_tid_28147, 32) * 32) ==\n                        31 && ltid_in_bounds_28159) {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28151)[sext_i32_i64(squot32(local_tid_28147,\n                                                                             32))] =\n                            x_26954;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_28162;\n                    \n                    // re",
                   "ad input for in-block scan\n                    {\n                        if (squot32(local_tid_28147, 32) == 0 &&\n                            ltid_in_bounds_28159) {\n                            x_28157 = ((volatile __local\n                                        int64_t *) red_arr_mem_28151)[sext_i32_i64(local_tid_28147)];\n                            if ((local_tid_28147 - squot32(local_tid_28147,\n                                                           32) * 32) == 0) {\n                                x_28156 = x_28157;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_28162 = 1;\n                        while (slt32(skip_threads_28162, 32)) {\n                            if (sle32(skip_threads_28162, local_tid_28147 -\n                                      squot32(local_tid_28147, 32) * 32) &&\n                                (squot32(local_tid_28147, 32) == 0 &&\n                                 ltid_in_bounds_28159)) {\n                                // read operands\n                                {\n                                    x_28156 = ((volatile __local\n                                                int64_t *) red_arr_mem_28151)[sext_i32_i64(local_tid_28147) -\n                                                                              sext_i32_i64(skip_threads_28162)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_28163 =\n                                         slt64(srem64(sext_i32_i64(local_tid_28147 *\n                                                      32 + 32 - 1),\n                                                      num_subhistos_28057),\n                                               sext_i32_i64(local_tid_28147 *\n                                               32 + 32",
                   " - 1) -\n                                               sext_i32_i64((local_tid_28147 -\n                                                             skip_threads_28162) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_28163) {\n                                        x_28156 = x_28157;\n                                    }\n                                    if (!inactive_28163) {\n                                        int64_t res_28158 = smax64(x_28156,\n                                                                   x_28157);\n                                        \n                                        x_28156 = res_28158;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_28149, skip_threads_28162)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_28162, local_tid_28147 -\n                                      squot32(local_tid_28147, 32) * 32) &&\n                                (squot32(local_tid_28147, 32) == 0 &&\n                                 ltid_in_bounds_28159)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      int64_t *) red_arr_mem_28151)[sext_i32_i64(local_tid_28147)] =\n                                        x_28156;\n                                    x_28157 = x_28156;\n                                }\n                            }\n                            if (sle32(wave_sizze_28149, skip_threads_28162)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_28162 *= 2;\n                        }\n                    }\n                }\n             ",
                   "   barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_28147, 32) == 0 ||\n                          !ltid_in_bounds_28159)) {\n                        // read operands\n                        {\n                            x_26955 = x_26954;\n                            x_26954 = ((__local\n                                        int64_t *) red_arr_mem_28151)[sext_i32_i64(squot32(local_tid_28147,\n                                                                                           32)) -\n                                                                      1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_28164 =\n                                 slt64(srem64(sext_i32_i64(local_tid_28147),\n                                              num_subhistos_28057),\n                                       sext_i32_i64(local_tid_28147) -\n                                       sext_i32_i64(squot32(local_tid_28147,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_28164) {\n                                x_26954 = x_26955;\n                            }\n                            if (!inactive_28164) {\n                                int64_t res_26956 = smax64(x_26954, x_26955);\n                                \n                                x_26954 = res_26956;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              int64_t *) red_arr_mem_28151)[sext_i32_i64(local_tid_28147)] =\n                                x_26954;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore c",
                   "orrect values for first block\n                {\n                    if (squot32(local_tid_28147, 32) == 0) {\n                        ((__local\n                          int64_t *) red_arr_mem_28151)[sext_i32_i64(local_tid_28147)] =\n                            x_26955;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_28155) *\n                      squot64(seghist_group_sizze_26948,\n                              segment_sizze_nonzzero_28144) +\n                      sext_i32_i64(local_tid_28147), res_24015) &&\n                slt64(sext_i32_i64(local_tid_28147),\n                      squot64(seghist_group_sizze_26948,\n                              segment_sizze_nonzzero_28144))) {\n                ((__global\n                  int64_t *) mem_27747)[sext_i32_i64(virt_group_id_28155) *\n                                        squot64(seghist_group_sizze_26948,\n                                                segment_sizze_nonzzero_28144) +\n                                        sext_i32_i64(local_tid_28147)] =\n                    ((__local\n                      int64_t *) red_arr_mem_28151)[(sext_i32_i64(local_tid_28147) +\n                                                     1) *\n                                                    segment_sizze_nonzzero_28144 -\n                                                    1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_26948\n}\n",
                   NULL};
static const char *size_names[] = {"builtin#replicate_f32.group_size_28463",
                                   "builtin#replicate_i64.group_size_28054",
                                   "main.L2_size_28119",
                                   "main.group_size_28475",
                                   "main.group_size_28512",
                                   "main.seghist_group_size_25345",
                                   "main.seghist_num_groups_25347",
                                   "main.segmap_group_size_24281",
                                   "main.segmap_group_size_24430",
                                   "main.segmap_group_size_24910",
                                   "main.segmap_group_size_24948",
                                   "main.segmap_group_size_25003",
                                   "main.segmap_group_size_25102",
                                   "main.segmap_group_size_25165",
                                   "main.segmap_group_size_25438",
                                   "main.segmap_group_size_25510",
                                   "main.segmap_group_size_25625",
                                   "main.segmap_num_groups_25005",
                                   "main.segred_group_size_24267",
                                   "main.segred_group_size_25335",
                                   "main.segred_group_size_25444",
                                   "main.segred_group_size_25652",
                                   "main.segred_group_size_25718",
                                   "main.segred_num_groups_24269",
                                   "main.segred_num_groups_25337",
                                   "main.segred_num_groups_25446",
                                   "main.segred_num_groups_25654",
                                   "main.segred_num_groups_25720",
                                   "main.segscan_group_size_25327",
                                   "main.segscan_group_size_25360",
                                   "main.segscan_group_size_25368",
                                   "main.segscan_group_size_25376",
                                   "main.segscan_group_size_25428",
                                   "main.segscan_num_groups_25329",
                                   "main.segscan_num_groups_25362",
                                   "main.segscan_num_groups_25370",
                                   "main.segscan_num_groups_25378",
                                   "main.segscan_num_groups_25430",
                                   "main.suff_intra_par_12",
                                   "main.suff_intra_par_3",
                                   "main.suff_outer_par_0",
                                   "main.suff_outer_par_11",
                                   "main.suff_outer_redomap_10",
                                   "test.L2_size_28120",
                                   "test.group_size_28476",
                                   "test.group_size_28513",
                                   "test.seghist_group_size_26947",
                                   "test.seghist_num_groups_26949",
                                   "test.segmap_group_size_25883",
                                   "test.segmap_group_size_26032",
                                   "test.segmap_group_size_26512",
                                   "test.segmap_group_size_26550",
                                   "test.segmap_group_size_26605",
                                   "test.segmap_group_size_26704",
                                   "test.segmap_group_size_26767",
                                   "test.segmap_group_size_27040",
                                   "test.segmap_group_size_27109",
                                   "test.segmap_group_size_27222",
                                   "test.segmap_num_groups_26607",
                                   "test.segred_group_size_25869",
                                   "test.segred_group_size_26937",
                                   "test.segred_group_size_27046",
                                   "test.segred_group_size_27249",
                                   "test.segred_group_size_27312",
                                   "test.segred_num_groups_25871",
                                   "test.segred_num_groups_26939",
                                   "test.segred_num_groups_27048",
                                   "test.segred_num_groups_27251",
                                   "test.segred_num_groups_27314",
                                   "test.segscan_group_size_26929",
                                   "test.segscan_group_size_26962",
                                   "test.segscan_group_size_26970",
                                   "test.segscan_group_size_26978",
                                   "test.segscan_group_size_27030",
                                   "test.segscan_num_groups_26931",
                                   "test.segscan_num_groups_26964",
                                   "test.segscan_num_groups_26972",
                                   "test.segscan_num_groups_26980",
                                   "test.segscan_num_groups_27032",
                                   "test.suff_intra_par_12",
                                   "test.suff_intra_par_3",
                                   "test.suff_outer_par_0",
                                   "test.suff_outer_par_11",
                                   "test.suff_outer_redomap_10"};
static const char *size_vars[] = {"builtinzhreplicate_f32zigroup_sizze_28463",
                                  "builtinzhreplicate_i64zigroup_sizze_28054",
                                  "mainziL2_sizze_28119",
                                  "mainzigroup_sizze_28475",
                                  "mainzigroup_sizze_28512",
                                  "mainziseghist_group_sizze_25345",
                                  "mainziseghist_num_groups_25347",
                                  "mainzisegmap_group_sizze_24281",
                                  "mainzisegmap_group_sizze_24430",
                                  "mainzisegmap_group_sizze_24910",
                                  "mainzisegmap_group_sizze_24948",
                                  "mainzisegmap_group_sizze_25003",
                                  "mainzisegmap_group_sizze_25102",
                                  "mainzisegmap_group_sizze_25165",
                                  "mainzisegmap_group_sizze_25438",
                                  "mainzisegmap_group_sizze_25510",
                                  "mainzisegmap_group_sizze_25625",
                                  "mainzisegmap_num_groups_25005",
                                  "mainzisegred_group_sizze_24267",
                                  "mainzisegred_group_sizze_25335",
                                  "mainzisegred_group_sizze_25444",
                                  "mainzisegred_group_sizze_25652",
                                  "mainzisegred_group_sizze_25718",
                                  "mainzisegred_num_groups_24269",
                                  "mainzisegred_num_groups_25337",
                                  "mainzisegred_num_groups_25446",
                                  "mainzisegred_num_groups_25654",
                                  "mainzisegred_num_groups_25720",
                                  "mainzisegscan_group_sizze_25327",
                                  "mainzisegscan_group_sizze_25360",
                                  "mainzisegscan_group_sizze_25368",
                                  "mainzisegscan_group_sizze_25376",
                                  "mainzisegscan_group_sizze_25428",
                                  "mainzisegscan_num_groups_25329",
                                  "mainzisegscan_num_groups_25362",
                                  "mainzisegscan_num_groups_25370",
                                  "mainzisegscan_num_groups_25378",
                                  "mainzisegscan_num_groups_25430",
                                  "mainzisuff_intra_par_12",
                                  "mainzisuff_intra_par_3",
                                  "mainzisuff_outer_par_0",
                                  "mainzisuff_outer_par_11",
                                  "mainzisuff_outer_redomap_10",
                                  "testziL2_sizze_28120",
                                  "testzigroup_sizze_28476",
                                  "testzigroup_sizze_28513",
                                  "testziseghist_group_sizze_26947",
                                  "testziseghist_num_groups_26949",
                                  "testzisegmap_group_sizze_25883",
                                  "testzisegmap_group_sizze_26032",
                                  "testzisegmap_group_sizze_26512",
                                  "testzisegmap_group_sizze_26550",
                                  "testzisegmap_group_sizze_26605",
                                  "testzisegmap_group_sizze_26704",
                                  "testzisegmap_group_sizze_26767",
                                  "testzisegmap_group_sizze_27040",
                                  "testzisegmap_group_sizze_27109",
                                  "testzisegmap_group_sizze_27222",
                                  "testzisegmap_num_groups_26607",
                                  "testzisegred_group_sizze_25869",
                                  "testzisegred_group_sizze_26937",
                                  "testzisegred_group_sizze_27046",
                                  "testzisegred_group_sizze_27249",
                                  "testzisegred_group_sizze_27312",
                                  "testzisegred_num_groups_25871",
                                  "testzisegred_num_groups_26939",
                                  "testzisegred_num_groups_27048",
                                  "testzisegred_num_groups_27251",
                                  "testzisegred_num_groups_27314",
                                  "testzisegscan_group_sizze_26929",
                                  "testzisegscan_group_sizze_26962",
                                  "testzisegscan_group_sizze_26970",
                                  "testzisegscan_group_sizze_26978",
                                  "testzisegscan_group_sizze_27030",
                                  "testzisegscan_num_groups_26931",
                                  "testzisegscan_num_groups_26964",
                                  "testzisegscan_num_groups_26972",
                                  "testzisegscan_num_groups_26980",
                                  "testzisegscan_num_groups_27032",
                                  "testzisuff_intra_par_12",
                                  "testzisuff_intra_par_3",
                                  "testzisuff_outer_par_0",
                                  "testzisuff_outer_par_11",
                                  "testzisuff_outer_redomap_10"};
static const char *size_classes[] = {"group_size", "group_size",
                                     "L2_for_histogram", "group_size",
                                     "group_size", "group_size", "num_groups",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "num_groups", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups",
                                     "threshold (!main.suff_outer_par_11 !main.suff_outer_redomap_10)",
                                     "threshold ()", "threshold ()",
                                     "threshold (!main.suff_outer_redomap_10)",
                                     "threshold ()", "L2_for_histogram",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "num_groups",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups",
                                     "threshold (!test.suff_outer_par_11 !test.suff_outer_redomap_10)",
                                     "threshold ()", "threshold ()",
                                     "threshold (!test.suff_outer_redomap_10)",
                                     "threshold ()"};
int futhark_get_num_sizes(void)
{
    return 84;
}
const char *futhark_get_size_name(int i)
{
    return size_names[i];
}
const char *futhark_get_size_class(int i)
{
    return size_classes[i];
}
struct sizes {
    size_t builtinzhreplicate_f32zigroup_sizze_28463;
    size_t builtinzhreplicate_i64zigroup_sizze_28054;
    size_t mainziL2_sizze_28119;
    size_t mainzigroup_sizze_28475;
    size_t mainzigroup_sizze_28512;
    size_t mainziseghist_group_sizze_25345;
    size_t mainziseghist_num_groups_25347;
    size_t mainzisegmap_group_sizze_24281;
    size_t mainzisegmap_group_sizze_24430;
    size_t mainzisegmap_group_sizze_24910;
    size_t mainzisegmap_group_sizze_24948;
    size_t mainzisegmap_group_sizze_25003;
    size_t mainzisegmap_group_sizze_25102;
    size_t mainzisegmap_group_sizze_25165;
    size_t mainzisegmap_group_sizze_25438;
    size_t mainzisegmap_group_sizze_25510;
    size_t mainzisegmap_group_sizze_25625;
    size_t mainzisegmap_num_groups_25005;
    size_t mainzisegred_group_sizze_24267;
    size_t mainzisegred_group_sizze_25335;
    size_t mainzisegred_group_sizze_25444;
    size_t mainzisegred_group_sizze_25652;
    size_t mainzisegred_group_sizze_25718;
    size_t mainzisegred_num_groups_24269;
    size_t mainzisegred_num_groups_25337;
    size_t mainzisegred_num_groups_25446;
    size_t mainzisegred_num_groups_25654;
    size_t mainzisegred_num_groups_25720;
    size_t mainzisegscan_group_sizze_25327;
    size_t mainzisegscan_group_sizze_25360;
    size_t mainzisegscan_group_sizze_25368;
    size_t mainzisegscan_group_sizze_25376;
    size_t mainzisegscan_group_sizze_25428;
    size_t mainzisegscan_num_groups_25329;
    size_t mainzisegscan_num_groups_25362;
    size_t mainzisegscan_num_groups_25370;
    size_t mainzisegscan_num_groups_25378;
    size_t mainzisegscan_num_groups_25430;
    size_t mainzisuff_intra_par_12;
    size_t mainzisuff_intra_par_3;
    size_t mainzisuff_outer_par_0;
    size_t mainzisuff_outer_par_11;
    size_t mainzisuff_outer_redomap_10;
    size_t testziL2_sizze_28120;
    size_t testzigroup_sizze_28476;
    size_t testzigroup_sizze_28513;
    size_t testziseghist_group_sizze_26947;
    size_t testziseghist_num_groups_26949;
    size_t testzisegmap_group_sizze_25883;
    size_t testzisegmap_group_sizze_26032;
    size_t testzisegmap_group_sizze_26512;
    size_t testzisegmap_group_sizze_26550;
    size_t testzisegmap_group_sizze_26605;
    size_t testzisegmap_group_sizze_26704;
    size_t testzisegmap_group_sizze_26767;
    size_t testzisegmap_group_sizze_27040;
    size_t testzisegmap_group_sizze_27109;
    size_t testzisegmap_group_sizze_27222;
    size_t testzisegmap_num_groups_26607;
    size_t testzisegred_group_sizze_25869;
    size_t testzisegred_group_sizze_26937;
    size_t testzisegred_group_sizze_27046;
    size_t testzisegred_group_sizze_27249;
    size_t testzisegred_group_sizze_27312;
    size_t testzisegred_num_groups_25871;
    size_t testzisegred_num_groups_26939;
    size_t testzisegred_num_groups_27048;
    size_t testzisegred_num_groups_27251;
    size_t testzisegred_num_groups_27314;
    size_t testzisegscan_group_sizze_26929;
    size_t testzisegscan_group_sizze_26962;
    size_t testzisegscan_group_sizze_26970;
    size_t testzisegscan_group_sizze_26978;
    size_t testzisegscan_group_sizze_27030;
    size_t testzisegscan_num_groups_26931;
    size_t testzisegscan_num_groups_26964;
    size_t testzisegscan_num_groups_26972;
    size_t testzisegscan_num_groups_26980;
    size_t testzisegscan_num_groups_27032;
    size_t testzisuff_intra_par_12;
    size_t testzisuff_intra_par_3;
    size_t testzisuff_outer_par_0;
    size_t testzisuff_outer_par_11;
    size_t testzisuff_outer_redomap_10;
} ;
struct futhark_context_config {
    struct opencl_config opencl;
    size_t sizes[84];
    int num_build_opts;
    const char **build_opts;
} ;
struct futhark_context_config *futhark_context_config_new(void)
{
    struct futhark_context_config *cfg =
                                  (struct futhark_context_config *) malloc(sizeof(struct futhark_context_config));
    
    if (cfg == NULL)
        return NULL;
    cfg->num_build_opts = 0;
    cfg->build_opts = (const char **) malloc(sizeof(const char *));
    cfg->build_opts[0] = NULL;
    cfg->sizes[0] = 0;
    cfg->sizes[1] = 0;
    cfg->sizes[2] = 4194304;
    cfg->sizes[3] = 0;
    cfg->sizes[4] = 0;
    cfg->sizes[5] = 0;
    cfg->sizes[6] = 0;
    cfg->sizes[7] = 0;
    cfg->sizes[8] = 0;
    cfg->sizes[9] = 0;
    cfg->sizes[10] = 0;
    cfg->sizes[11] = 0;
    cfg->sizes[12] = 0;
    cfg->sizes[13] = 0;
    cfg->sizes[14] = 0;
    cfg->sizes[15] = 0;
    cfg->sizes[16] = 0;
    cfg->sizes[17] = 0;
    cfg->sizes[18] = 0;
    cfg->sizes[19] = 0;
    cfg->sizes[20] = 0;
    cfg->sizes[21] = 0;
    cfg->sizes[22] = 0;
    cfg->sizes[23] = 0;
    cfg->sizes[24] = 0;
    cfg->sizes[25] = 0;
    cfg->sizes[26] = 0;
    cfg->sizes[27] = 0;
    cfg->sizes[28] = 0;
    cfg->sizes[29] = 0;
    cfg->sizes[30] = 0;
    cfg->sizes[31] = 0;
    cfg->sizes[32] = 0;
    cfg->sizes[33] = 0;
    cfg->sizes[34] = 0;
    cfg->sizes[35] = 0;
    cfg->sizes[36] = 0;
    cfg->sizes[37] = 0;
    cfg->sizes[38] = 32;
    cfg->sizes[39] = 32;
    cfg->sizes[40] = 0;
    cfg->sizes[41] = 0;
    cfg->sizes[42] = 0;
    cfg->sizes[43] = 4194304;
    cfg->sizes[44] = 0;
    cfg->sizes[45] = 0;
    cfg->sizes[46] = 0;
    cfg->sizes[47] = 0;
    cfg->sizes[48] = 0;
    cfg->sizes[49] = 0;
    cfg->sizes[50] = 0;
    cfg->sizes[51] = 0;
    cfg->sizes[52] = 0;
    cfg->sizes[53] = 0;
    cfg->sizes[54] = 0;
    cfg->sizes[55] = 0;
    cfg->sizes[56] = 0;
    cfg->sizes[57] = 0;
    cfg->sizes[58] = 0;
    cfg->sizes[59] = 0;
    cfg->sizes[60] = 0;
    cfg->sizes[61] = 0;
    cfg->sizes[62] = 0;
    cfg->sizes[63] = 0;
    cfg->sizes[64] = 0;
    cfg->sizes[65] = 0;
    cfg->sizes[66] = 0;
    cfg->sizes[67] = 0;
    cfg->sizes[68] = 0;
    cfg->sizes[69] = 0;
    cfg->sizes[70] = 0;
    cfg->sizes[71] = 0;
    cfg->sizes[72] = 0;
    cfg->sizes[73] = 0;
    cfg->sizes[74] = 0;
    cfg->sizes[75] = 0;
    cfg->sizes[76] = 0;
    cfg->sizes[77] = 0;
    cfg->sizes[78] = 0;
    cfg->sizes[79] = 32;
    cfg->sizes[80] = 32;
    cfg->sizes[81] = 0;
    cfg->sizes[82] = 0;
    cfg->sizes[83] = 0;
    opencl_config_init(&cfg->opencl, 84, size_names, size_vars, cfg->sizes,
                       size_classes);
    return cfg;
}
void futhark_context_config_free(struct futhark_context_config *cfg)
{
    free(cfg->build_opts);
    free(cfg);
}
void futhark_context_config_add_build_option(struct futhark_context_config *cfg,
                                             const char *opt)
{
    cfg->build_opts[cfg->num_build_opts] = opt;
    cfg->num_build_opts++;
    cfg->build_opts = (const char **) realloc(cfg->build_opts,
                                              (cfg->num_build_opts + 1) *
                                              sizeof(const char *));
    cfg->build_opts[cfg->num_build_opts] = NULL;
}
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int flag)
{
    cfg->opencl.profiling = cfg->opencl.logging = cfg->opencl.debugging = flag;
}
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag)
{
    cfg->opencl.profiling = flag;
}
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int flag)
{
    cfg->opencl.logging = flag;
}
void futhark_context_config_set_device(struct futhark_context_config *cfg, const
                                       char *s)
{
    set_preferred_device(&cfg->opencl, s);
}
void futhark_context_config_set_platform(struct futhark_context_config *cfg,
                                         const char *s)
{
    set_preferred_platform(&cfg->opencl, s);
}
void futhark_context_config_select_device_interactively(struct futhark_context_config *cfg)
{
    select_device_interactively(&cfg->opencl);
}
void futhark_context_config_list_devices(struct futhark_context_config *cfg)
{
    list_devices(&cfg->opencl);
}
void futhark_context_config_dump_program_to(struct futhark_context_config *cfg,
                                            const char *path)
{
    cfg->opencl.dump_program_to = path;
}
void futhark_context_config_load_program_from(struct futhark_context_config *cfg,
                                              const char *path)
{
    cfg->opencl.load_program_from = path;
}
void futhark_context_config_dump_binary_to(struct futhark_context_config *cfg,
                                           const char *path)
{
    cfg->opencl.dump_binary_to = path;
}
void futhark_context_config_load_binary_from(struct futhark_context_config *cfg,
                                             const char *path)
{
    cfg->opencl.load_binary_from = path;
}
void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg,
                                                   int size)
{
    cfg->opencl.default_group_size = size;
    cfg->opencl.default_group_size_changed = 1;
}
void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg,
                                                   int num)
{
    cfg->opencl.default_num_groups = num;
}
void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg,
                                                  int size)
{
    cfg->opencl.default_tile_size = size;
    cfg->opencl.default_tile_size_changed = 1;
}
void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg,
                                                  int size)
{
    cfg->opencl.default_threshold = size;
}
int futhark_context_config_set_size(struct futhark_context_config *cfg, const
                                    char *size_name, size_t size_value)
{
    for (int i = 0; i < 84; i++) {
        if (strcmp(size_name, size_names[i]) == 0) {
            cfg->sizes[i] = size_value;
            return 0;
        }
    }
    if (strcmp(size_name, "default_group_size") == 0) {
        cfg->opencl.default_group_size = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_num_groups") == 0) {
        cfg->opencl.default_num_groups = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_threshold") == 0) {
        cfg->opencl.default_threshold = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_tile_size") == 0) {
        cfg->opencl.default_tile_size = size_value;
        return 0;
    }
    return 1;
}
struct futhark_context {
    int detail_memory;
    int debugging;
    int profiling;
    int profiling_paused;
    int logging;
    lock_t lock;
    char *error;
    int64_t peak_mem_usage_device;
    int64_t cur_mem_usage_device;
    int64_t peak_mem_usage_default;
    int64_t cur_mem_usage_default;
    struct {
        int dummy;
    } constants;
    struct memblock_device mainzicounter_mem_27876;
    struct memblock_device mainzicounter_mem_28016;
    struct memblock_device mainzihist_locks_mem_28127;
    struct memblock_device mainzicounter_mem_28171;
    struct memblock_device mainzicounter_mem_28477;
    struct memblock_device mainzicounter_mem_28561;
    struct memblock_device mainzicounter_mem_28601;
    struct memblock_device testzistatic_array_27873;
    struct memblock_device testzistatic_array_27874;
    struct memblock_device testzistatic_array_27875;
    struct memblock_device testzicounter_mem_27877;
    struct memblock_device testzicounter_mem_28017;
    struct memblock_device testzihist_locks_mem_28128;
    struct memblock_device testzicounter_mem_28172;
    struct memblock_device testzicounter_mem_28478;
    struct memblock_device testzicounter_mem_28562;
    struct memblock_device testzicounter_mem_28602;
    int total_runs;
    long total_runtime;
    cl_kernel builtinzhreplicate_f32zireplicate_28460;
    cl_kernel builtinzhreplicate_i64zireplicate_28051;
    cl_kernel gpu_map_transpose_f32;
    cl_kernel gpu_map_transpose_f32_low_height;
    cl_kernel gpu_map_transpose_f32_low_width;
    cl_kernel gpu_map_transpose_f32_small;
    cl_kernel mainzicopy_28472;
    cl_kernel mainzicopy_28509;
    cl_kernel mainziscan_stage1_25333;
    cl_kernel mainziscan_stage1_25366;
    cl_kernel mainziscan_stage1_25374;
    cl_kernel mainziscan_stage1_25382;
    cl_kernel mainziscan_stage1_25434;
    cl_kernel mainziscan_stage2_25333;
    cl_kernel mainziscan_stage2_25366;
    cl_kernel mainziscan_stage2_25374;
    cl_kernel mainziscan_stage2_25382;
    cl_kernel mainziscan_stage2_25434;
    cl_kernel mainziscan_stage3_25333;
    cl_kernel mainziscan_stage3_25366;
    cl_kernel mainziscan_stage3_25374;
    cl_kernel mainziscan_stage3_25382;
    cl_kernel mainziscan_stage3_25434;
    cl_kernel mainziseghist_global_25351;
    cl_kernel mainziseghist_local_25351;
    cl_kernel mainzisegmap_24279;
    cl_kernel mainzisegmap_24428;
    cl_kernel mainzisegmap_24906;
    cl_kernel mainzisegmap_24944;
    cl_kernel mainzisegmap_25001;
    cl_kernel mainzisegmap_25099;
    cl_kernel mainzisegmap_25163;
    cl_kernel mainzisegmap_25436;
    cl_kernel mainzisegmap_25508;
    cl_kernel mainzisegmap_25623;
    cl_kernel mainzisegmap_intragroup_24645;
    cl_kernel mainzisegmap_intragroup_25506;
    cl_kernel mainzisegred_large_25658;
    cl_kernel mainzisegred_large_28142;
    cl_kernel mainzisegred_nonseg_24275;
    cl_kernel mainzisegred_nonseg_25343;
    cl_kernel mainzisegred_nonseg_25453;
    cl_kernel mainzisegred_nonseg_25726;
    cl_kernel mainzisegred_small_25658;
    cl_kernel mainzisegred_small_28142;
    cl_kernel testzicopy_28473;
    cl_kernel testzicopy_28510;
    cl_kernel testziscan_stage1_26935;
    cl_kernel testziscan_stage1_26968;
    cl_kernel testziscan_stage1_26976;
    cl_kernel testziscan_stage1_26984;
    cl_kernel testziscan_stage1_27036;
    cl_kernel testziscan_stage2_26935;
    cl_kernel testziscan_stage2_26968;
    cl_kernel testziscan_stage2_26976;
    cl_kernel testziscan_stage2_26984;
    cl_kernel testziscan_stage2_27036;
    cl_kernel testziscan_stage3_26935;
    cl_kernel testziscan_stage3_26968;
    cl_kernel testziscan_stage3_26976;
    cl_kernel testziscan_stage3_26984;
    cl_kernel testziscan_stage3_27036;
    cl_kernel testziseghist_global_26953;
    cl_kernel testziseghist_local_26953;
    cl_kernel testzisegmap_25881;
    cl_kernel testzisegmap_26030;
    cl_kernel testzisegmap_26508;
    cl_kernel testzisegmap_26546;
    cl_kernel testzisegmap_26603;
    cl_kernel testzisegmap_26701;
    cl_kernel testzisegmap_26765;
    cl_kernel testzisegmap_27038;
    cl_kernel testzisegmap_27107;
    cl_kernel testzisegmap_27220;
    cl_kernel testzisegmap_intragroup_26247;
    cl_kernel testzisegmap_intragroup_27105;
    cl_kernel testzisegred_large_27255;
    cl_kernel testzisegred_large_28143;
    cl_kernel testzisegred_nonseg_25877;
    cl_kernel testzisegred_nonseg_26945;
    cl_kernel testzisegred_nonseg_27054;
    cl_kernel testzisegred_nonseg_27320;
    cl_kernel testzisegred_small_27255;
    cl_kernel testzisegred_small_28143;
    int64_t copy_dev_to_dev_total_runtime;
    int copy_dev_to_dev_runs;
    int64_t copy_dev_to_host_total_runtime;
    int copy_dev_to_host_runs;
    int64_t copy_host_to_dev_total_runtime;
    int copy_host_to_dev_runs;
    int64_t copy_scalar_to_dev_total_runtime;
    int copy_scalar_to_dev_runs;
    int64_t copy_scalar_from_dev_total_runtime;
    int copy_scalar_from_dev_runs;
    int64_t builtinzhreplicate_f32zireplicate_28460_total_runtime;
    int builtinzhreplicate_f32zireplicate_28460_runs;
    int64_t builtinzhreplicate_i64zireplicate_28051_total_runtime;
    int builtinzhreplicate_i64zireplicate_28051_runs;
    int64_t gpu_map_transpose_f32_total_runtime;
    int gpu_map_transpose_f32_runs;
    int64_t gpu_map_transpose_f32_low_height_total_runtime;
    int gpu_map_transpose_f32_low_height_runs;
    int64_t gpu_map_transpose_f32_low_width_total_runtime;
    int gpu_map_transpose_f32_low_width_runs;
    int64_t gpu_map_transpose_f32_small_total_runtime;
    int gpu_map_transpose_f32_small_runs;
    int64_t mainzicopy_28472_total_runtime;
    int mainzicopy_28472_runs;
    int64_t mainzicopy_28509_total_runtime;
    int mainzicopy_28509_runs;
    int64_t mainziscan_stage1_25333_total_runtime;
    int mainziscan_stage1_25333_runs;
    int64_t mainziscan_stage1_25366_total_runtime;
    int mainziscan_stage1_25366_runs;
    int64_t mainziscan_stage1_25374_total_runtime;
    int mainziscan_stage1_25374_runs;
    int64_t mainziscan_stage1_25382_total_runtime;
    int mainziscan_stage1_25382_runs;
    int64_t mainziscan_stage1_25434_total_runtime;
    int mainziscan_stage1_25434_runs;
    int64_t mainziscan_stage2_25333_total_runtime;
    int mainziscan_stage2_25333_runs;
    int64_t mainziscan_stage2_25366_total_runtime;
    int mainziscan_stage2_25366_runs;
    int64_t mainziscan_stage2_25374_total_runtime;
    int mainziscan_stage2_25374_runs;
    int64_t mainziscan_stage2_25382_total_runtime;
    int mainziscan_stage2_25382_runs;
    int64_t mainziscan_stage2_25434_total_runtime;
    int mainziscan_stage2_25434_runs;
    int64_t mainziscan_stage3_25333_total_runtime;
    int mainziscan_stage3_25333_runs;
    int64_t mainziscan_stage3_25366_total_runtime;
    int mainziscan_stage3_25366_runs;
    int64_t mainziscan_stage3_25374_total_runtime;
    int mainziscan_stage3_25374_runs;
    int64_t mainziscan_stage3_25382_total_runtime;
    int mainziscan_stage3_25382_runs;
    int64_t mainziscan_stage3_25434_total_runtime;
    int mainziscan_stage3_25434_runs;
    int64_t mainziseghist_global_25351_total_runtime;
    int mainziseghist_global_25351_runs;
    int64_t mainziseghist_local_25351_total_runtime;
    int mainziseghist_local_25351_runs;
    int64_t mainzisegmap_24279_total_runtime;
    int mainzisegmap_24279_runs;
    int64_t mainzisegmap_24428_total_runtime;
    int mainzisegmap_24428_runs;
    int64_t mainzisegmap_24906_total_runtime;
    int mainzisegmap_24906_runs;
    int64_t mainzisegmap_24944_total_runtime;
    int mainzisegmap_24944_runs;
    int64_t mainzisegmap_25001_total_runtime;
    int mainzisegmap_25001_runs;
    int64_t mainzisegmap_25099_total_runtime;
    int mainzisegmap_25099_runs;
    int64_t mainzisegmap_25163_total_runtime;
    int mainzisegmap_25163_runs;
    int64_t mainzisegmap_25436_total_runtime;
    int mainzisegmap_25436_runs;
    int64_t mainzisegmap_25508_total_runtime;
    int mainzisegmap_25508_runs;
    int64_t mainzisegmap_25623_total_runtime;
    int mainzisegmap_25623_runs;
    int64_t mainzisegmap_intragroup_24645_total_runtime;
    int mainzisegmap_intragroup_24645_runs;
    int64_t mainzisegmap_intragroup_25506_total_runtime;
    int mainzisegmap_intragroup_25506_runs;
    int64_t mainzisegred_large_25658_total_runtime;
    int mainzisegred_large_25658_runs;
    int64_t mainzisegred_large_28142_total_runtime;
    int mainzisegred_large_28142_runs;
    int64_t mainzisegred_nonseg_24275_total_runtime;
    int mainzisegred_nonseg_24275_runs;
    int64_t mainzisegred_nonseg_25343_total_runtime;
    int mainzisegred_nonseg_25343_runs;
    int64_t mainzisegred_nonseg_25453_total_runtime;
    int mainzisegred_nonseg_25453_runs;
    int64_t mainzisegred_nonseg_25726_total_runtime;
    int mainzisegred_nonseg_25726_runs;
    int64_t mainzisegred_small_25658_total_runtime;
    int mainzisegred_small_25658_runs;
    int64_t mainzisegred_small_28142_total_runtime;
    int mainzisegred_small_28142_runs;
    int64_t testzicopy_28473_total_runtime;
    int testzicopy_28473_runs;
    int64_t testzicopy_28510_total_runtime;
    int testzicopy_28510_runs;
    int64_t testziscan_stage1_26935_total_runtime;
    int testziscan_stage1_26935_runs;
    int64_t testziscan_stage1_26968_total_runtime;
    int testziscan_stage1_26968_runs;
    int64_t testziscan_stage1_26976_total_runtime;
    int testziscan_stage1_26976_runs;
    int64_t testziscan_stage1_26984_total_runtime;
    int testziscan_stage1_26984_runs;
    int64_t testziscan_stage1_27036_total_runtime;
    int testziscan_stage1_27036_runs;
    int64_t testziscan_stage2_26935_total_runtime;
    int testziscan_stage2_26935_runs;
    int64_t testziscan_stage2_26968_total_runtime;
    int testziscan_stage2_26968_runs;
    int64_t testziscan_stage2_26976_total_runtime;
    int testziscan_stage2_26976_runs;
    int64_t testziscan_stage2_26984_total_runtime;
    int testziscan_stage2_26984_runs;
    int64_t testziscan_stage2_27036_total_runtime;
    int testziscan_stage2_27036_runs;
    int64_t testziscan_stage3_26935_total_runtime;
    int testziscan_stage3_26935_runs;
    int64_t testziscan_stage3_26968_total_runtime;
    int testziscan_stage3_26968_runs;
    int64_t testziscan_stage3_26976_total_runtime;
    int testziscan_stage3_26976_runs;
    int64_t testziscan_stage3_26984_total_runtime;
    int testziscan_stage3_26984_runs;
    int64_t testziscan_stage3_27036_total_runtime;
    int testziscan_stage3_27036_runs;
    int64_t testziseghist_global_26953_total_runtime;
    int testziseghist_global_26953_runs;
    int64_t testziseghist_local_26953_total_runtime;
    int testziseghist_local_26953_runs;
    int64_t testzisegmap_25881_total_runtime;
    int testzisegmap_25881_runs;
    int64_t testzisegmap_26030_total_runtime;
    int testzisegmap_26030_runs;
    int64_t testzisegmap_26508_total_runtime;
    int testzisegmap_26508_runs;
    int64_t testzisegmap_26546_total_runtime;
    int testzisegmap_26546_runs;
    int64_t testzisegmap_26603_total_runtime;
    int testzisegmap_26603_runs;
    int64_t testzisegmap_26701_total_runtime;
    int testzisegmap_26701_runs;
    int64_t testzisegmap_26765_total_runtime;
    int testzisegmap_26765_runs;
    int64_t testzisegmap_27038_total_runtime;
    int testzisegmap_27038_runs;
    int64_t testzisegmap_27107_total_runtime;
    int testzisegmap_27107_runs;
    int64_t testzisegmap_27220_total_runtime;
    int testzisegmap_27220_runs;
    int64_t testzisegmap_intragroup_26247_total_runtime;
    int testzisegmap_intragroup_26247_runs;
    int64_t testzisegmap_intragroup_27105_total_runtime;
    int testzisegmap_intragroup_27105_runs;
    int64_t testzisegred_large_27255_total_runtime;
    int testzisegred_large_27255_runs;
    int64_t testzisegred_large_28143_total_runtime;
    int testzisegred_large_28143_runs;
    int64_t testzisegred_nonseg_25877_total_runtime;
    int testzisegred_nonseg_25877_runs;
    int64_t testzisegred_nonseg_26945_total_runtime;
    int testzisegred_nonseg_26945_runs;
    int64_t testzisegred_nonseg_27054_total_runtime;
    int testzisegred_nonseg_27054_runs;
    int64_t testzisegred_nonseg_27320_total_runtime;
    int testzisegred_nonseg_27320_runs;
    int64_t testzisegred_small_27255_total_runtime;
    int testzisegred_small_27255_runs;
    int64_t testzisegred_small_28143_total_runtime;
    int testzisegred_small_28143_runs;
    cl_mem global_failure;
    cl_mem global_failure_args;
    struct opencl_context opencl;
    struct sizes sizes;
    cl_int failure_is_an_option;
} ;
void post_opencl_setup(struct opencl_context *ctx,
                       struct opencl_device_option *option)
{
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name,
                                            "NVIDIA CUDA") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_GPU) == CL_DEVICE_TYPE_GPU) {
        ctx->lockstep_width = 32;
    }
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name,
                                            "AMD Accelerated Parallel Processing") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->lockstep_width = 32;
    }
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->lockstep_width = 1;
    }
    if ((ctx->cfg.default_num_groups == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_GPU) == CL_DEVICE_TYPE_GPU) {
        size_t MAX_COMPUTE_UNITS_val = 0;
        
        clGetDeviceInfo(ctx->device, CL_DEVICE_MAX_COMPUTE_UNITS,
                        sizeof(MAX_COMPUTE_UNITS_val), &MAX_COMPUTE_UNITS_val,
                        NULL);
        ctx->cfg.default_num_groups = 4 * MAX_COMPUTE_UNITS_val;
    }
    if ((ctx->cfg.default_group_size == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_GPU) == CL_DEVICE_TYPE_GPU) {
        ctx->cfg.default_group_size = 256;
    }
    if ((ctx->cfg.default_tile_size == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->cfg.default_tile_size = 32;
    }
    if ((ctx->cfg.default_threshold == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->cfg.default_threshold = 32768;
    }
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_CPU) ==
        CL_DEVICE_TYPE_CPU) {
        ctx->lockstep_width = 1;
    }
    if ((ctx->cfg.default_num_groups == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_CPU) == CL_DEVICE_TYPE_CPU) {
        size_t MAX_COMPUTE_UNITS_val = 0;
        
        clGetDeviceInfo(ctx->device, CL_DEVICE_MAX_COMPUTE_UNITS,
                        sizeof(MAX_COMPUTE_UNITS_val), &MAX_COMPUTE_UNITS_val,
                        NULL);
        ctx->cfg.default_num_groups = MAX_COMPUTE_UNITS_val;
    }
    if ((ctx->cfg.default_group_size == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_CPU) == CL_DEVICE_TYPE_CPU) {
        ctx->cfg.default_group_size = 32;
    }
    if ((ctx->cfg.default_tile_size == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_CPU) ==
        CL_DEVICE_TYPE_CPU) {
        ctx->cfg.default_tile_size = 4;
    }
    if ((ctx->cfg.default_threshold == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_CPU) ==
        CL_DEVICE_TYPE_CPU) {
        size_t MAX_COMPUTE_UNITS_val = 0;
        
        clGetDeviceInfo(ctx->device, CL_DEVICE_MAX_COMPUTE_UNITS,
                        sizeof(MAX_COMPUTE_UNITS_val), &MAX_COMPUTE_UNITS_val,
                        NULL);
        ctx->cfg.default_threshold = MAX_COMPUTE_UNITS_val;
    }
}
static void init_context_early(struct futhark_context_config *cfg,
                               struct futhark_context *ctx)
{
    ctx->opencl.cfg = cfg->opencl;
    ctx->detail_memory = cfg->opencl.debugging;
    ctx->debugging = cfg->opencl.debugging;
    ctx->profiling = cfg->opencl.profiling;
    ctx->profiling_paused = 0;
    ctx->logging = cfg->opencl.logging;
    ctx->error = NULL;
    ctx->opencl.profiling_records_capacity = 200;
    ctx->opencl.profiling_records_used = 0;
    ctx->opencl.profiling_records =
        malloc(ctx->opencl.profiling_records_capacity *
        sizeof(struct profiling_record));
    create_lock(&ctx->lock);
    ctx->failure_is_an_option = 0;
    ctx->peak_mem_usage_device = 0;
    ctx->cur_mem_usage_device = 0;
    ctx->peak_mem_usage_default = 0;
    ctx->cur_mem_usage_default = 0;
    ctx->total_runs = 0;
    ctx->total_runtime = 0;
    ctx->copy_dev_to_dev_total_runtime = 0;
    ctx->copy_dev_to_dev_runs = 0;
    ctx->copy_dev_to_host_total_runtime = 0;
    ctx->copy_dev_to_host_runs = 0;
    ctx->copy_host_to_dev_total_runtime = 0;
    ctx->copy_host_to_dev_runs = 0;
    ctx->copy_scalar_to_dev_total_runtime = 0;
    ctx->copy_scalar_to_dev_runs = 0;
    ctx->copy_scalar_from_dev_total_runtime = 0;
    ctx->copy_scalar_from_dev_runs = 0;
    ctx->builtinzhreplicate_f32zireplicate_28460_total_runtime = 0;
    ctx->builtinzhreplicate_f32zireplicate_28460_runs = 0;
    ctx->builtinzhreplicate_i64zireplicate_28051_total_runtime = 0;
    ctx->builtinzhreplicate_i64zireplicate_28051_runs = 0;
    ctx->gpu_map_transpose_f32_total_runtime = 0;
    ctx->gpu_map_transpose_f32_runs = 0;
    ctx->gpu_map_transpose_f32_low_height_total_runtime = 0;
    ctx->gpu_map_transpose_f32_low_height_runs = 0;
    ctx->gpu_map_transpose_f32_low_width_total_runtime = 0;
    ctx->gpu_map_transpose_f32_low_width_runs = 0;
    ctx->gpu_map_transpose_f32_small_total_runtime = 0;
    ctx->gpu_map_transpose_f32_small_runs = 0;
    ctx->mainzicopy_28472_total_runtime = 0;
    ctx->mainzicopy_28472_runs = 0;
    ctx->mainzicopy_28509_total_runtime = 0;
    ctx->mainzicopy_28509_runs = 0;
    ctx->mainziscan_stage1_25333_total_runtime = 0;
    ctx->mainziscan_stage1_25333_runs = 0;
    ctx->mainziscan_stage1_25366_total_runtime = 0;
    ctx->mainziscan_stage1_25366_runs = 0;
    ctx->mainziscan_stage1_25374_total_runtime = 0;
    ctx->mainziscan_stage1_25374_runs = 0;
    ctx->mainziscan_stage1_25382_total_runtime = 0;
    ctx->mainziscan_stage1_25382_runs = 0;
    ctx->mainziscan_stage1_25434_total_runtime = 0;
    ctx->mainziscan_stage1_25434_runs = 0;
    ctx->mainziscan_stage2_25333_total_runtime = 0;
    ctx->mainziscan_stage2_25333_runs = 0;
    ctx->mainziscan_stage2_25366_total_runtime = 0;
    ctx->mainziscan_stage2_25366_runs = 0;
    ctx->mainziscan_stage2_25374_total_runtime = 0;
    ctx->mainziscan_stage2_25374_runs = 0;
    ctx->mainziscan_stage2_25382_total_runtime = 0;
    ctx->mainziscan_stage2_25382_runs = 0;
    ctx->mainziscan_stage2_25434_total_runtime = 0;
    ctx->mainziscan_stage2_25434_runs = 0;
    ctx->mainziscan_stage3_25333_total_runtime = 0;
    ctx->mainziscan_stage3_25333_runs = 0;
    ctx->mainziscan_stage3_25366_total_runtime = 0;
    ctx->mainziscan_stage3_25366_runs = 0;
    ctx->mainziscan_stage3_25374_total_runtime = 0;
    ctx->mainziscan_stage3_25374_runs = 0;
    ctx->mainziscan_stage3_25382_total_runtime = 0;
    ctx->mainziscan_stage3_25382_runs = 0;
    ctx->mainziscan_stage3_25434_total_runtime = 0;
    ctx->mainziscan_stage3_25434_runs = 0;
    ctx->mainziseghist_global_25351_total_runtime = 0;
    ctx->mainziseghist_global_25351_runs = 0;
    ctx->mainziseghist_local_25351_total_runtime = 0;
    ctx->mainziseghist_local_25351_runs = 0;
    ctx->mainzisegmap_24279_total_runtime = 0;
    ctx->mainzisegmap_24279_runs = 0;
    ctx->mainzisegmap_24428_total_runtime = 0;
    ctx->mainzisegmap_24428_runs = 0;
    ctx->mainzisegmap_24906_total_runtime = 0;
    ctx->mainzisegmap_24906_runs = 0;
    ctx->mainzisegmap_24944_total_runtime = 0;
    ctx->mainzisegmap_24944_runs = 0;
    ctx->mainzisegmap_25001_total_runtime = 0;
    ctx->mainzisegmap_25001_runs = 0;
    ctx->mainzisegmap_25099_total_runtime = 0;
    ctx->mainzisegmap_25099_runs = 0;
    ctx->mainzisegmap_25163_total_runtime = 0;
    ctx->mainzisegmap_25163_runs = 0;
    ctx->mainzisegmap_25436_total_runtime = 0;
    ctx->mainzisegmap_25436_runs = 0;
    ctx->mainzisegmap_25508_total_runtime = 0;
    ctx->mainzisegmap_25508_runs = 0;
    ctx->mainzisegmap_25623_total_runtime = 0;
    ctx->mainzisegmap_25623_runs = 0;
    ctx->mainzisegmap_intragroup_24645_total_runtime = 0;
    ctx->mainzisegmap_intragroup_24645_runs = 0;
    ctx->mainzisegmap_intragroup_25506_total_runtime = 0;
    ctx->mainzisegmap_intragroup_25506_runs = 0;
    ctx->mainzisegred_large_25658_total_runtime = 0;
    ctx->mainzisegred_large_25658_runs = 0;
    ctx->mainzisegred_large_28142_total_runtime = 0;
    ctx->mainzisegred_large_28142_runs = 0;
    ctx->mainzisegred_nonseg_24275_total_runtime = 0;
    ctx->mainzisegred_nonseg_24275_runs = 0;
    ctx->mainzisegred_nonseg_25343_total_runtime = 0;
    ctx->mainzisegred_nonseg_25343_runs = 0;
    ctx->mainzisegred_nonseg_25453_total_runtime = 0;
    ctx->mainzisegred_nonseg_25453_runs = 0;
    ctx->mainzisegred_nonseg_25726_total_runtime = 0;
    ctx->mainzisegred_nonseg_25726_runs = 0;
    ctx->mainzisegred_small_25658_total_runtime = 0;
    ctx->mainzisegred_small_25658_runs = 0;
    ctx->mainzisegred_small_28142_total_runtime = 0;
    ctx->mainzisegred_small_28142_runs = 0;
    ctx->testzicopy_28473_total_runtime = 0;
    ctx->testzicopy_28473_runs = 0;
    ctx->testzicopy_28510_total_runtime = 0;
    ctx->testzicopy_28510_runs = 0;
    ctx->testziscan_stage1_26935_total_runtime = 0;
    ctx->testziscan_stage1_26935_runs = 0;
    ctx->testziscan_stage1_26968_total_runtime = 0;
    ctx->testziscan_stage1_26968_runs = 0;
    ctx->testziscan_stage1_26976_total_runtime = 0;
    ctx->testziscan_stage1_26976_runs = 0;
    ctx->testziscan_stage1_26984_total_runtime = 0;
    ctx->testziscan_stage1_26984_runs = 0;
    ctx->testziscan_stage1_27036_total_runtime = 0;
    ctx->testziscan_stage1_27036_runs = 0;
    ctx->testziscan_stage2_26935_total_runtime = 0;
    ctx->testziscan_stage2_26935_runs = 0;
    ctx->testziscan_stage2_26968_total_runtime = 0;
    ctx->testziscan_stage2_26968_runs = 0;
    ctx->testziscan_stage2_26976_total_runtime = 0;
    ctx->testziscan_stage2_26976_runs = 0;
    ctx->testziscan_stage2_26984_total_runtime = 0;
    ctx->testziscan_stage2_26984_runs = 0;
    ctx->testziscan_stage2_27036_total_runtime = 0;
    ctx->testziscan_stage2_27036_runs = 0;
    ctx->testziscan_stage3_26935_total_runtime = 0;
    ctx->testziscan_stage3_26935_runs = 0;
    ctx->testziscan_stage3_26968_total_runtime = 0;
    ctx->testziscan_stage3_26968_runs = 0;
    ctx->testziscan_stage3_26976_total_runtime = 0;
    ctx->testziscan_stage3_26976_runs = 0;
    ctx->testziscan_stage3_26984_total_runtime = 0;
    ctx->testziscan_stage3_26984_runs = 0;
    ctx->testziscan_stage3_27036_total_runtime = 0;
    ctx->testziscan_stage3_27036_runs = 0;
    ctx->testziseghist_global_26953_total_runtime = 0;
    ctx->testziseghist_global_26953_runs = 0;
    ctx->testziseghist_local_26953_total_runtime = 0;
    ctx->testziseghist_local_26953_runs = 0;
    ctx->testzisegmap_25881_total_runtime = 0;
    ctx->testzisegmap_25881_runs = 0;
    ctx->testzisegmap_26030_total_runtime = 0;
    ctx->testzisegmap_26030_runs = 0;
    ctx->testzisegmap_26508_total_runtime = 0;
    ctx->testzisegmap_26508_runs = 0;
    ctx->testzisegmap_26546_total_runtime = 0;
    ctx->testzisegmap_26546_runs = 0;
    ctx->testzisegmap_26603_total_runtime = 0;
    ctx->testzisegmap_26603_runs = 0;
    ctx->testzisegmap_26701_total_runtime = 0;
    ctx->testzisegmap_26701_runs = 0;
    ctx->testzisegmap_26765_total_runtime = 0;
    ctx->testzisegmap_26765_runs = 0;
    ctx->testzisegmap_27038_total_runtime = 0;
    ctx->testzisegmap_27038_runs = 0;
    ctx->testzisegmap_27107_total_runtime = 0;
    ctx->testzisegmap_27107_runs = 0;
    ctx->testzisegmap_27220_total_runtime = 0;
    ctx->testzisegmap_27220_runs = 0;
    ctx->testzisegmap_intragroup_26247_total_runtime = 0;
    ctx->testzisegmap_intragroup_26247_runs = 0;
    ctx->testzisegmap_intragroup_27105_total_runtime = 0;
    ctx->testzisegmap_intragroup_27105_runs = 0;
    ctx->testzisegred_large_27255_total_runtime = 0;
    ctx->testzisegred_large_27255_runs = 0;
    ctx->testzisegred_large_28143_total_runtime = 0;
    ctx->testzisegred_large_28143_runs = 0;
    ctx->testzisegred_nonseg_25877_total_runtime = 0;
    ctx->testzisegred_nonseg_25877_runs = 0;
    ctx->testzisegred_nonseg_26945_total_runtime = 0;
    ctx->testzisegred_nonseg_26945_runs = 0;
    ctx->testzisegred_nonseg_27054_total_runtime = 0;
    ctx->testzisegred_nonseg_27054_runs = 0;
    ctx->testzisegred_nonseg_27320_total_runtime = 0;
    ctx->testzisegred_nonseg_27320_runs = 0;
    ctx->testzisegred_small_27255_total_runtime = 0;
    ctx->testzisegred_small_27255_runs = 0;
    ctx->testzisegred_small_28143_total_runtime = 0;
    ctx->testzisegred_small_28143_runs = 0;
}
static int init_context_late(struct futhark_context_config *cfg,
                             struct futhark_context *ctx, cl_program prog)
{
    cl_int error;
    cl_int no_error = -1;
    
    ctx->global_failure = clCreateBuffer(ctx->opencl.ctx, CL_MEM_READ_WRITE |
                                         CL_MEM_COPY_HOST_PTR, sizeof(cl_int),
                                         &no_error, &error);
    OPENCL_SUCCEED_OR_RETURN(error);
    // The +1 is to avoid zero-byte allocations.
    ctx->global_failure_args = clCreateBuffer(ctx->opencl.ctx,
                                              CL_MEM_READ_WRITE,
                                              sizeof(int64_t) * (3 + 1), NULL,
                                              &error);
    OPENCL_SUCCEED_OR_RETURN(error);
    {
        ctx->builtinzhreplicate_f32zireplicate_28460 = clCreateKernel(prog,
                                                                      "builtinzhreplicate_f32zireplicate_28460",
                                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "builtin#replicate_f32.replicate_28460");
    }
    {
        ctx->builtinzhreplicate_i64zireplicate_28051 = clCreateKernel(prog,
                                                                      "builtinzhreplicate_i64zireplicate_28051",
                                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "builtin#replicate_i64.replicate_28051");
    }
    {
        ctx->gpu_map_transpose_f32 = clCreateKernel(prog,
                                                    "gpu_map_transpose_f32",
                                                    &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "gpu_map_transpose_f32");
    }
    {
        ctx->gpu_map_transpose_f32_low_height = clCreateKernel(prog,
                                                               "gpu_map_transpose_f32_low_height",
                                                               &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "gpu_map_transpose_f32_low_height");
    }
    {
        ctx->gpu_map_transpose_f32_low_width = clCreateKernel(prog,
                                                              "gpu_map_transpose_f32_low_width",
                                                              &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "gpu_map_transpose_f32_low_width");
    }
    {
        ctx->gpu_map_transpose_f32_small = clCreateKernel(prog,
                                                          "gpu_map_transpose_f32_small",
                                                          &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "gpu_map_transpose_f32_small");
    }
    {
        ctx->mainzicopy_28472 = clCreateKernel(prog, "mainzicopy_28472",
                                               &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.copy_28472");
    }
    {
        ctx->mainzicopy_28509 = clCreateKernel(prog, "mainzicopy_28509",
                                               &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.copy_28509");
    }
    {
        ctx->mainziscan_stage1_25333 = clCreateKernel(prog,
                                                      "mainziscan_stage1_25333",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_25333, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_25333");
    }
    {
        ctx->mainziscan_stage1_25366 = clCreateKernel(prog,
                                                      "mainziscan_stage1_25366",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_25366, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_25366");
    }
    {
        ctx->mainziscan_stage1_25374 = clCreateKernel(prog,
                                                      "mainziscan_stage1_25374",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_25374, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_25374");
    }
    {
        ctx->mainziscan_stage1_25382 = clCreateKernel(prog,
                                                      "mainziscan_stage1_25382",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_25382, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_25382, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_25382");
    }
    {
        ctx->mainziscan_stage1_25434 = clCreateKernel(prog,
                                                      "mainziscan_stage1_25434",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_25434, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_25434");
    }
    {
        ctx->mainziscan_stage2_25333 = clCreateKernel(prog,
                                                      "mainziscan_stage2_25333",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_25333, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_25333");
    }
    {
        ctx->mainziscan_stage2_25366 = clCreateKernel(prog,
                                                      "mainziscan_stage2_25366",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_25366, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_25366");
    }
    {
        ctx->mainziscan_stage2_25374 = clCreateKernel(prog,
                                                      "mainziscan_stage2_25374",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_25374, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_25374");
    }
    {
        ctx->mainziscan_stage2_25382 = clCreateKernel(prog,
                                                      "mainziscan_stage2_25382",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_25382, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_25382");
    }
    {
        ctx->mainziscan_stage2_25434 = clCreateKernel(prog,
                                                      "mainziscan_stage2_25434",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_25434, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_25434");
    }
    {
        ctx->mainziscan_stage3_25333 = clCreateKernel(prog,
                                                      "mainziscan_stage3_25333",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_25333, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_25333");
    }
    {
        ctx->mainziscan_stage3_25366 = clCreateKernel(prog,
                                                      "mainziscan_stage3_25366",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_25366, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_25366");
    }
    {
        ctx->mainziscan_stage3_25374 = clCreateKernel(prog,
                                                      "mainziscan_stage3_25374",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_25374, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_25374");
    }
    {
        ctx->mainziscan_stage3_25382 = clCreateKernel(prog,
                                                      "mainziscan_stage3_25382",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_25382, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_25382");
    }
    {
        ctx->mainziscan_stage3_25434 = clCreateKernel(prog,
                                                      "mainziscan_stage3_25434",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_25434, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_25434");
    }
    {
        ctx->mainziseghist_global_25351 = clCreateKernel(prog,
                                                         "mainziseghist_global_25351",
                                                         &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziseghist_global_25351, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "main.seghist_global_25351");
    }
    {
        ctx->mainziseghist_local_25351 = clCreateKernel(prog,
                                                        "mainziseghist_local_25351",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziseghist_local_25351, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.seghist_local_25351");
    }
    {
        ctx->mainzisegmap_24279 = clCreateKernel(prog, "mainzisegmap_24279",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_24279, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_24279, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_24279");
    }
    {
        ctx->mainzisegmap_24428 = clCreateKernel(prog, "mainzisegmap_24428",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_24428, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_24428, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_24428");
    }
    {
        ctx->mainzisegmap_24906 = clCreateKernel(prog, "mainzisegmap_24906",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_24906, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_24906");
    }
    {
        ctx->mainzisegmap_24944 = clCreateKernel(prog, "mainzisegmap_24944",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_24944, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_24944");
    }
    {
        ctx->mainzisegmap_25001 = clCreateKernel(prog, "mainzisegmap_25001",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25001, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25001, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_25001");
    }
    {
        ctx->mainzisegmap_25099 = clCreateKernel(prog, "mainzisegmap_25099",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25099, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_25099");
    }
    {
        ctx->mainzisegmap_25163 = clCreateKernel(prog, "mainzisegmap_25163",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25163, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_25163");
    }
    {
        ctx->mainzisegmap_25436 = clCreateKernel(prog, "mainzisegmap_25436",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25436, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_25436");
    }
    {
        ctx->mainzisegmap_25508 = clCreateKernel(prog, "mainzisegmap_25508",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25508, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_25508");
    }
    {
        ctx->mainzisegmap_25623 = clCreateKernel(prog, "mainzisegmap_25623",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25623, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_25623");
    }
    {
        ctx->mainzisegmap_intragroup_24645 = clCreateKernel(prog,
                                                            "mainzisegmap_intragroup_24645",
                                                            &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                            0, sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                            2, sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "main.segmap_intragroup_24645");
    }
    {
        ctx->mainzisegmap_intragroup_25506 = clCreateKernel(prog,
                                                            "mainzisegmap_intragroup_25506",
                                                            &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_intragroup_25506,
                                            0, sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "main.segmap_intragroup_25506");
    }
    {
        ctx->mainzisegred_large_25658 = clCreateKernel(prog,
                                                       "mainzisegred_large_25658",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_large_25658, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_large_25658");
    }
    {
        ctx->mainzisegred_large_28142 = clCreateKernel(prog,
                                                       "mainzisegred_large_28142",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_large_28142, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_large_28142");
    }
    {
        ctx->mainzisegred_nonseg_24275 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_24275",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_24275, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_24275");
    }
    {
        ctx->mainzisegred_nonseg_25343 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_25343",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_25343, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_25343");
    }
    {
        ctx->mainzisegred_nonseg_25453 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_25453",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_25453, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_25453");
    }
    {
        ctx->mainzisegred_nonseg_25726 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_25726",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_25726, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_25726");
    }
    {
        ctx->mainzisegred_small_25658 = clCreateKernel(prog,
                                                       "mainzisegred_small_25658",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_small_25658, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_small_25658");
    }
    {
        ctx->mainzisegred_small_28142 = clCreateKernel(prog,
                                                       "mainzisegred_small_28142",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_small_28142, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_small_28142");
    }
    {
        ctx->testzicopy_28473 = clCreateKernel(prog, "testzicopy_28473",
                                               &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.copy_28473");
    }
    {
        ctx->testzicopy_28510 = clCreateKernel(prog, "testzicopy_28510",
                                               &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.copy_28510");
    }
    {
        ctx->testziscan_stage1_26935 = clCreateKernel(prog,
                                                      "testziscan_stage1_26935",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_26935, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_26935");
    }
    {
        ctx->testziscan_stage1_26968 = clCreateKernel(prog,
                                                      "testziscan_stage1_26968",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_26968, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_26968");
    }
    {
        ctx->testziscan_stage1_26976 = clCreateKernel(prog,
                                                      "testziscan_stage1_26976",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_26976, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_26976");
    }
    {
        ctx->testziscan_stage1_26984 = clCreateKernel(prog,
                                                      "testziscan_stage1_26984",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_26984, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_26984, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_26984");
    }
    {
        ctx->testziscan_stage1_27036 = clCreateKernel(prog,
                                                      "testziscan_stage1_27036",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_27036, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_27036");
    }
    {
        ctx->testziscan_stage2_26935 = clCreateKernel(prog,
                                                      "testziscan_stage2_26935",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_26935, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_26935");
    }
    {
        ctx->testziscan_stage2_26968 = clCreateKernel(prog,
                                                      "testziscan_stage2_26968",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_26968, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_26968");
    }
    {
        ctx->testziscan_stage2_26976 = clCreateKernel(prog,
                                                      "testziscan_stage2_26976",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_26976, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_26976");
    }
    {
        ctx->testziscan_stage2_26984 = clCreateKernel(prog,
                                                      "testziscan_stage2_26984",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_26984, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_26984");
    }
    {
        ctx->testziscan_stage2_27036 = clCreateKernel(prog,
                                                      "testziscan_stage2_27036",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_27036, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_27036");
    }
    {
        ctx->testziscan_stage3_26935 = clCreateKernel(prog,
                                                      "testziscan_stage3_26935",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_26935, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_26935");
    }
    {
        ctx->testziscan_stage3_26968 = clCreateKernel(prog,
                                                      "testziscan_stage3_26968",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_26968, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_26968");
    }
    {
        ctx->testziscan_stage3_26976 = clCreateKernel(prog,
                                                      "testziscan_stage3_26976",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_26976, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_26976");
    }
    {
        ctx->testziscan_stage3_26984 = clCreateKernel(prog,
                                                      "testziscan_stage3_26984",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_26984, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_26984");
    }
    {
        ctx->testziscan_stage3_27036 = clCreateKernel(prog,
                                                      "testziscan_stage3_27036",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_27036, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_27036");
    }
    {
        ctx->testziseghist_global_26953 = clCreateKernel(prog,
                                                         "testziseghist_global_26953",
                                                         &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziseghist_global_26953, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "test.seghist_global_26953");
    }
    {
        ctx->testziseghist_local_26953 = clCreateKernel(prog,
                                                        "testziseghist_local_26953",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziseghist_local_26953, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.seghist_local_26953");
    }
    {
        ctx->testzisegmap_25881 = clCreateKernel(prog, "testzisegmap_25881",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_25881, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_25881, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_25881");
    }
    {
        ctx->testzisegmap_26030 = clCreateKernel(prog, "testzisegmap_26030",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26030, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26030, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_26030");
    }
    {
        ctx->testzisegmap_26508 = clCreateKernel(prog, "testzisegmap_26508",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26508, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_26508");
    }
    {
        ctx->testzisegmap_26546 = clCreateKernel(prog, "testzisegmap_26546",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26546, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_26546");
    }
    {
        ctx->testzisegmap_26603 = clCreateKernel(prog, "testzisegmap_26603",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26603, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26603, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_26603");
    }
    {
        ctx->testzisegmap_26701 = clCreateKernel(prog, "testzisegmap_26701",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26701, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_26701");
    }
    {
        ctx->testzisegmap_26765 = clCreateKernel(prog, "testzisegmap_26765",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26765, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_26765");
    }
    {
        ctx->testzisegmap_27038 = clCreateKernel(prog, "testzisegmap_27038",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27038, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_27038");
    }
    {
        ctx->testzisegmap_27107 = clCreateKernel(prog, "testzisegmap_27107",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27107, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_27107");
    }
    {
        ctx->testzisegmap_27220 = clCreateKernel(prog, "testzisegmap_27220",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27220, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_27220");
    }
    {
        ctx->testzisegmap_intragroup_26247 = clCreateKernel(prog,
                                                            "testzisegmap_intragroup_26247",
                                                            &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_intragroup_26247,
                                            0, sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_intragroup_26247,
                                            2, sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "test.segmap_intragroup_26247");
    }
    {
        ctx->testzisegmap_intragroup_27105 = clCreateKernel(prog,
                                                            "testzisegmap_intragroup_27105",
                                                            &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_intragroup_27105,
                                            0, sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "test.segmap_intragroup_27105");
    }
    {
        ctx->testzisegred_large_27255 = clCreateKernel(prog,
                                                       "testzisegred_large_27255",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_large_27255, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_large_27255");
    }
    {
        ctx->testzisegred_large_28143 = clCreateKernel(prog,
                                                       "testzisegred_large_28143",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_large_28143, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_large_28143");
    }
    {
        ctx->testzisegred_nonseg_25877 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_25877",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_25877, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_25877");
    }
    {
        ctx->testzisegred_nonseg_26945 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_26945",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_26945, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_26945");
    }
    {
        ctx->testzisegred_nonseg_27054 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_27054",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_27054, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_27054");
    }
    {
        ctx->testzisegred_nonseg_27320 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_27320",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_27320, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_27320");
    }
    {
        ctx->testzisegred_small_27255 = clCreateKernel(prog,
                                                       "testzisegred_small_27255",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_small_27255, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_small_27255");
    }
    {
        ctx->testzisegred_small_28143 = clCreateKernel(prog,
                                                       "testzisegred_small_28143",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_small_28143, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_small_28143");
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_27876.references = NULL;
        ctx->mainzicounter_mem_27876.size = 0;
        ctx->mainzicounter_mem_27876.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_27876.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_28666,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28016.references = NULL;
        ctx->mainzicounter_mem_28016.size = 0;
        ctx->mainzicounter_mem_28016.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28016.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_28728,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzihist_locks_mem_28127.references = NULL;
        ctx->mainzihist_locks_mem_28127.size = 0;
        ctx->mainzihist_locks_mem_28127.mem = clCreateBuffer(ctx->opencl.ctx,
                                                             CL_MEM_READ_WRITE,
                                                             (100151 >
                                                              0 ? 100151 : 1) *
                                                             sizeof(int32_t),
                                                             NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (100151 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzihist_locks_mem_28127.mem,
                                                          CL_TRUE, 0, 100151 *
                                                          sizeof(int32_t),
                                                          mainzihist_locks_mem_realtype_28740,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28171.references = NULL;
        ctx->mainzicounter_mem_28171.size = 0;
        ctx->mainzicounter_mem_28171.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28171.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_28751,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28477.references = NULL;
        ctx->mainzicounter_mem_28477.size = 0;
        ctx->mainzicounter_mem_28477.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28477.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_28828,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28561.references = NULL;
        ctx->mainzicounter_mem_28561.size = 0;
        ctx->mainzicounter_mem_28561.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28561.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_28855,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28601.references = NULL;
        ctx->mainzicounter_mem_28601.size = 0;
        ctx->mainzicounter_mem_28601.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28601.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_28866,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzistatic_array_27873.references = NULL;
        ctx->testzistatic_array_27873.size = 0;
        ctx->testzistatic_array_27873.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (45 > 0 ? 45 : 1) *
                                                           sizeof(float), NULL,
                                                           &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (45 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzistatic_array_27873.mem,
                                                          CL_TRUE, 0, 45 *
                                                          sizeof(float),
                                                          testzistatic_array_realtype_28874,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzistatic_array_27874.references = NULL;
        ctx->testzistatic_array_27874.size = 0;
        ctx->testzistatic_array_27874.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (45 > 0 ? 45 : 1) *
                                                           sizeof(int64_t),
                                                           NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (45 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzistatic_array_27874.mem,
                                                          CL_TRUE, 0, 45 *
                                                          sizeof(int64_t),
                                                          testzistatic_array_realtype_28875,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzistatic_array_27875.references = NULL;
        ctx->testzistatic_array_27875.size = 0;
        ctx->testzistatic_array_27875.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (45 > 0 ? 45 : 1) *
                                                           sizeof(float), NULL,
                                                           &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (45 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzistatic_array_27875.mem,
                                                          CL_TRUE, 0, 45 *
                                                          sizeof(float),
                                                          testzistatic_array_realtype_28876,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_27877.references = NULL;
        ctx->testzicounter_mem_27877.size = 0;
        ctx->testzicounter_mem_27877.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_27877.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_28877,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28017.references = NULL;
        ctx->testzicounter_mem_28017.size = 0;
        ctx->testzicounter_mem_28017.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28017.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_28939,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzihist_locks_mem_28128.references = NULL;
        ctx->testzihist_locks_mem_28128.size = 0;
        ctx->testzihist_locks_mem_28128.mem = clCreateBuffer(ctx->opencl.ctx,
                                                             CL_MEM_READ_WRITE,
                                                             (100151 >
                                                              0 ? 100151 : 1) *
                                                             sizeof(int32_t),
                                                             NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (100151 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzihist_locks_mem_28128.mem,
                                                          CL_TRUE, 0, 100151 *
                                                          sizeof(int32_t),
                                                          testzihist_locks_mem_realtype_28951,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28172.references = NULL;
        ctx->testzicounter_mem_28172.size = 0;
        ctx->testzicounter_mem_28172.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28172.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_28962,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28478.references = NULL;
        ctx->testzicounter_mem_28478.size = 0;
        ctx->testzicounter_mem_28478.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28478.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29039,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28562.references = NULL;
        ctx->testzicounter_mem_28562.size = 0;
        ctx->testzicounter_mem_28562.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28562.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29066,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28602.references = NULL;
        ctx->testzicounter_mem_28602.size = 0;
        ctx->testzicounter_mem_28602.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28602.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29077,
                                                          0, NULL, NULL));
    }
    ctx->sizes.builtinzhreplicate_f32zigroup_sizze_28463 = cfg->sizes[0];
    ctx->sizes.builtinzhreplicate_i64zigroup_sizze_28054 = cfg->sizes[1];
    ctx->sizes.mainziL2_sizze_28119 = cfg->sizes[2];
    ctx->sizes.mainzigroup_sizze_28475 = cfg->sizes[3];
    ctx->sizes.mainzigroup_sizze_28512 = cfg->sizes[4];
    ctx->sizes.mainziseghist_group_sizze_25345 = cfg->sizes[5];
    ctx->sizes.mainziseghist_num_groups_25347 = cfg->sizes[6];
    ctx->sizes.mainzisegmap_group_sizze_24281 = cfg->sizes[7];
    ctx->sizes.mainzisegmap_group_sizze_24430 = cfg->sizes[8];
    ctx->sizes.mainzisegmap_group_sizze_24910 = cfg->sizes[9];
    ctx->sizes.mainzisegmap_group_sizze_24948 = cfg->sizes[10];
    ctx->sizes.mainzisegmap_group_sizze_25003 = cfg->sizes[11];
    ctx->sizes.mainzisegmap_group_sizze_25102 = cfg->sizes[12];
    ctx->sizes.mainzisegmap_group_sizze_25165 = cfg->sizes[13];
    ctx->sizes.mainzisegmap_group_sizze_25438 = cfg->sizes[14];
    ctx->sizes.mainzisegmap_group_sizze_25510 = cfg->sizes[15];
    ctx->sizes.mainzisegmap_group_sizze_25625 = cfg->sizes[16];
    ctx->sizes.mainzisegmap_num_groups_25005 = cfg->sizes[17];
    ctx->sizes.mainzisegred_group_sizze_24267 = cfg->sizes[18];
    ctx->sizes.mainzisegred_group_sizze_25335 = cfg->sizes[19];
    ctx->sizes.mainzisegred_group_sizze_25444 = cfg->sizes[20];
    ctx->sizes.mainzisegred_group_sizze_25652 = cfg->sizes[21];
    ctx->sizes.mainzisegred_group_sizze_25718 = cfg->sizes[22];
    ctx->sizes.mainzisegred_num_groups_24269 = cfg->sizes[23];
    ctx->sizes.mainzisegred_num_groups_25337 = cfg->sizes[24];
    ctx->sizes.mainzisegred_num_groups_25446 = cfg->sizes[25];
    ctx->sizes.mainzisegred_num_groups_25654 = cfg->sizes[26];
    ctx->sizes.mainzisegred_num_groups_25720 = cfg->sizes[27];
    ctx->sizes.mainzisegscan_group_sizze_25327 = cfg->sizes[28];
    ctx->sizes.mainzisegscan_group_sizze_25360 = cfg->sizes[29];
    ctx->sizes.mainzisegscan_group_sizze_25368 = cfg->sizes[30];
    ctx->sizes.mainzisegscan_group_sizze_25376 = cfg->sizes[31];
    ctx->sizes.mainzisegscan_group_sizze_25428 = cfg->sizes[32];
    ctx->sizes.mainzisegscan_num_groups_25329 = cfg->sizes[33];
    ctx->sizes.mainzisegscan_num_groups_25362 = cfg->sizes[34];
    ctx->sizes.mainzisegscan_num_groups_25370 = cfg->sizes[35];
    ctx->sizes.mainzisegscan_num_groups_25378 = cfg->sizes[36];
    ctx->sizes.mainzisegscan_num_groups_25430 = cfg->sizes[37];
    ctx->sizes.mainzisuff_intra_par_12 = cfg->sizes[38];
    ctx->sizes.mainzisuff_intra_par_3 = cfg->sizes[39];
    ctx->sizes.mainzisuff_outer_par_0 = cfg->sizes[40];
    ctx->sizes.mainzisuff_outer_par_11 = cfg->sizes[41];
    ctx->sizes.mainzisuff_outer_redomap_10 = cfg->sizes[42];
    ctx->sizes.testziL2_sizze_28120 = cfg->sizes[43];
    ctx->sizes.testzigroup_sizze_28476 = cfg->sizes[44];
    ctx->sizes.testzigroup_sizze_28513 = cfg->sizes[45];
    ctx->sizes.testziseghist_group_sizze_26947 = cfg->sizes[46];
    ctx->sizes.testziseghist_num_groups_26949 = cfg->sizes[47];
    ctx->sizes.testzisegmap_group_sizze_25883 = cfg->sizes[48];
    ctx->sizes.testzisegmap_group_sizze_26032 = cfg->sizes[49];
    ctx->sizes.testzisegmap_group_sizze_26512 = cfg->sizes[50];
    ctx->sizes.testzisegmap_group_sizze_26550 = cfg->sizes[51];
    ctx->sizes.testzisegmap_group_sizze_26605 = cfg->sizes[52];
    ctx->sizes.testzisegmap_group_sizze_26704 = cfg->sizes[53];
    ctx->sizes.testzisegmap_group_sizze_26767 = cfg->sizes[54];
    ctx->sizes.testzisegmap_group_sizze_27040 = cfg->sizes[55];
    ctx->sizes.testzisegmap_group_sizze_27109 = cfg->sizes[56];
    ctx->sizes.testzisegmap_group_sizze_27222 = cfg->sizes[57];
    ctx->sizes.testzisegmap_num_groups_26607 = cfg->sizes[58];
    ctx->sizes.testzisegred_group_sizze_25869 = cfg->sizes[59];
    ctx->sizes.testzisegred_group_sizze_26937 = cfg->sizes[60];
    ctx->sizes.testzisegred_group_sizze_27046 = cfg->sizes[61];
    ctx->sizes.testzisegred_group_sizze_27249 = cfg->sizes[62];
    ctx->sizes.testzisegred_group_sizze_27312 = cfg->sizes[63];
    ctx->sizes.testzisegred_num_groups_25871 = cfg->sizes[64];
    ctx->sizes.testzisegred_num_groups_26939 = cfg->sizes[65];
    ctx->sizes.testzisegred_num_groups_27048 = cfg->sizes[66];
    ctx->sizes.testzisegred_num_groups_27251 = cfg->sizes[67];
    ctx->sizes.testzisegred_num_groups_27314 = cfg->sizes[68];
    ctx->sizes.testzisegscan_group_sizze_26929 = cfg->sizes[69];
    ctx->sizes.testzisegscan_group_sizze_26962 = cfg->sizes[70];
    ctx->sizes.testzisegscan_group_sizze_26970 = cfg->sizes[71];
    ctx->sizes.testzisegscan_group_sizze_26978 = cfg->sizes[72];
    ctx->sizes.testzisegscan_group_sizze_27030 = cfg->sizes[73];
    ctx->sizes.testzisegscan_num_groups_26931 = cfg->sizes[74];
    ctx->sizes.testzisegscan_num_groups_26964 = cfg->sizes[75];
    ctx->sizes.testzisegscan_num_groups_26972 = cfg->sizes[76];
    ctx->sizes.testzisegscan_num_groups_26980 = cfg->sizes[77];
    ctx->sizes.testzisegscan_num_groups_27032 = cfg->sizes[78];
    ctx->sizes.testzisuff_intra_par_12 = cfg->sizes[79];
    ctx->sizes.testzisuff_intra_par_3 = cfg->sizes[80];
    ctx->sizes.testzisuff_outer_par_0 = cfg->sizes[81];
    ctx->sizes.testzisuff_outer_par_11 = cfg->sizes[82];
    ctx->sizes.testzisuff_outer_redomap_10 = cfg->sizes[83];
    init_constants(ctx);
    // Clear the free list of any deallocations that occurred while initialising constants.
    OPENCL_SUCCEED_OR_RETURN(opencl_free_all(&ctx->opencl));
    // The program will be properly freed after all the kernels have also been freed.
    OPENCL_SUCCEED_OR_RETURN(clReleaseProgram(prog));
    return futhark_context_sync(ctx);
}
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg)
{
    struct futhark_context *ctx =
                           (struct futhark_context *) malloc(sizeof(struct futhark_context));
    
    if (ctx == NULL)
        return NULL;
    
    int required_types = 0;
    
    init_context_early(cfg, ctx);
    
    cl_program prog = setup_opencl(&ctx->opencl, opencl_program, required_types,
                                   cfg->build_opts);
    
    init_context_late(cfg, ctx, prog);
    return ctx;
}
struct futhark_context *futhark_context_new_with_command_queue(struct futhark_context_config *cfg,
                                                               cl_command_queue queue)
{
    struct futhark_context *ctx =
                           (struct futhark_context *) malloc(sizeof(struct futhark_context));
    
    if (ctx == NULL)
        return NULL;
    
    int required_types = 0;
    
    init_context_early(cfg, ctx);
    
    cl_program prog = setup_opencl_with_command_queue(&ctx->opencl, queue,
                                                      opencl_program,
                                                      required_types,
                                                      cfg->build_opts);
    
    init_context_late(cfg, ctx, prog);
    return ctx;
}
void futhark_context_free(struct futhark_context *ctx)
{
    free_constants(ctx);
    free_lock(&ctx->lock);
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->builtinzhreplicate_f32zireplicate_28460));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->builtinzhreplicate_i64zireplicate_28051));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32_low_height));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32_low_width));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32_small));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzicopy_28472));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzicopy_28509));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_25333));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_25366));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_25374));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_25382));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_25434));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_25333));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_25366));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_25374));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_25382));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_25434));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_25333));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_25366));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_25374));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_25382));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_25434));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziseghist_global_25351));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziseghist_local_25351));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_24279));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_24428));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_24906));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_24944));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_25001));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_25099));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_25163));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_25436));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_25508));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_25623));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_intragroup_24645));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_intragroup_25506));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_large_25658));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_large_28142));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_24275));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_25343));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_25453));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_25726));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_small_25658));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_small_28142));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzicopy_28473));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzicopy_28510));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_26935));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_26968));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_26976));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_26984));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_27036));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_26935));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_26968));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_26976));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_26984));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_27036));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_26935));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_26968));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_26976));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_26984));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_27036));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziseghist_global_26953));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziseghist_local_26953));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_25881));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_26030));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_26508));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_26546));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_26603));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_26701));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_26765));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_27038));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_27107));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_27220));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_intragroup_26247));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_intragroup_27105));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_large_27255));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_large_28143));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_25877));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_26945));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_27054));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_27320));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_small_27255));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_small_28143));
    teardown_opencl(&ctx->opencl);
    free(ctx);
}
int futhark_context_sync(struct futhark_context *ctx)
{
    cl_int failure_idx = -1;
    
    if (ctx->failure_is_an_option) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     ctx->global_failure,
                                                     CL_FALSE, 0,
                                                     sizeof(cl_int),
                                                     &failure_idx, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        ctx->failure_is_an_option = 0;
    }
    OPENCL_SUCCEED_OR_RETURN(clFinish(ctx->opencl.queue));
    if (failure_idx >= 0) {
        cl_int no_failure = -1;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                      ctx->global_failure,
                                                      CL_TRUE, 0,
                                                      sizeof(cl_int),
                                                      &no_failure, 0, NULL,
                                                      NULL));
        
        int64_t args[3 + 1];
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     ctx->global_failure_args,
                                                     CL_TRUE, 0, sizeof(args),
                                                     &args, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_host_runs,
                                                                                               &ctx->copy_dev_to_host_total_runtime)));
        switch (failure_idx) {
            
          case 0:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva3d.fut:54:29-48\n   #1  cva3d.fut:95:25-65\n   #2  cva3d.fut:109:16-62\n   #3  cva3d.fut:105:17-109:85\n   #4  cva3d.fut:100:1-146:20\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 1:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva3d.fut:96:47-70\n   #1  cva3d.fut:109:16-62\n   #2  cva3d.fut:105:17-109:85\n   #3  cva3d.fut:100:1-146:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 2:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva3d.fut:54:29-48\n   #1  cva3d.fut:95:25-65\n   #2  cva3d.fut:109:16-62\n   #3  cva3d.fut:105:17-109:85\n   #4  cva3d.fut:100:1-146:20\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 3:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva3d.fut:96:47-70\n   #1  cva3d.fut:109:16-62\n   #2  cva3d.fut:105:17-109:85\n   #3  cva3d.fut:100:1-146:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 4:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva3d.fut:71:97-104\n   #1  cva3d.fut:123:32-62\n   #2  cva3d.fut:123:22-69\n   #3  cva3d.fut:100:1-146:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 5:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva3d.fut:71:58-105\n   #1  cva3d.fut:123:32-62\n   #2  cva3d.fut:123:22-69\n   #3  cva3d.fut:100:1-146:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 6:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva3d.fut:71:97-104\n   #1  cva3d.fut:123:32-62\n   #2  cva3d.fut:123:22-69\n   #3  cva3d.fut:100:1-146:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 7:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva3d.fut:71:58-105\n   #1  cva3d.fut:123:32-62\n   #2  cva3d.fut:123:22-69\n   #3  cva3d.fut:100:1-146:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 8:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/segmented/segmented.fut:90:30-35\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:90:12-49\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva3d.fut:134:18-77\n   #6  cva3d.fut:100:1-146:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 9:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva3d.fut:54:29-48\n   #1  cva3d.fut:95:25-65\n   #2  cva3d.fut:109:16-62\n   #3  cva3d.fut:105:17-109:85\n   #4  cva3d.fut:154:3-156:129\n   #5  cva3d.fut:153:1-156:137\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 10:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva3d.fut:96:47-70\n   #1  cva3d.fut:109:16-62\n   #2  cva3d.fut:105:17-109:85\n   #3  cva3d.fut:154:3-156:129\n   #4  cva3d.fut:153:1-156:137\n",
                              args[0], args[1]);
                break;
            }
            
          case 11:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva3d.fut:54:29-48\n   #1  cva3d.fut:95:25-65\n   #2  cva3d.fut:109:16-62\n   #3  cva3d.fut:105:17-109:85\n   #4  cva3d.fut:154:3-156:129\n   #5  cva3d.fut:153:1-156:137\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 12:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva3d.fut:96:47-70\n   #1  cva3d.fut:109:16-62\n   #2  cva3d.fut:105:17-109:85\n   #3  cva3d.fut:154:3-156:129\n   #4  cva3d.fut:153:1-156:137\n",
                              args[0], args[1]);
                break;
            }
            
          case 13:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva3d.fut:71:97-104\n   #1  cva3d.fut:123:32-62\n   #2  cva3d.fut:123:22-69\n   #3  cva3d.fut:154:3-156:129\n   #4  cva3d.fut:153:1-156:137\n",
                              args[0], args[1]);
                break;
            }
            
          case 14:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva3d.fut:71:58-105\n   #1  cva3d.fut:123:32-62\n   #2  cva3d.fut:123:22-69\n   #3  cva3d.fut:154:3-156:129\n   #4  cva3d.fut:153:1-156:137\n",
                              args[0], args[1]);
                break;
            }
            
          case 15:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva3d.fut:71:97-104\n   #1  cva3d.fut:123:32-62\n   #2  cva3d.fut:123:22-69\n   #3  cva3d.fut:154:3-156:129\n   #4  cva3d.fut:153:1-156:137\n",
                              args[0], args[1]);
                break;
            }
            
          case 16:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva3d.fut:71:58-105\n   #1  cva3d.fut:123:32-62\n   #2  cva3d.fut:123:22-69\n   #3  cva3d.fut:154:3-156:129\n   #4  cva3d.fut:153:1-156:137\n",
                              args[0], args[1]);
                break;
            }
            
          case 17:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/segmented/segmented.fut:90:30-35\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:90:12-49\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva3d.fut:134:18-77\n   #6  cva3d.fut:154:3-156:129\n   #7  cva3d.fut:153:1-156:137\n",
                              args[0], args[1]);
                break;
            }
        }
        return 1;
    }
    return 0;
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    ctx->error = OPENCL_SUCCEED_NONFATAL(opencl_free_all(&ctx->opencl));
    return ctx->error != NULL;
}
cl_command_queue futhark_context_get_command_queue(struct futhark_context *ctx)
{
    return ctx->opencl.queue;
}
static int memblock_unref_device(struct futhark_context *ctx,
                                 struct memblock_device *block, const
                                 char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(stderr,
                    "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n",
                    desc, block->desc, "space 'device'", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_device -= block->size;
            OPENCL_SUCCEED_OR_RETURN(opencl_free(&ctx->opencl, block->mem,
                                                 desc));
            free(block->references);
            if (ctx->detail_memory)
                fprintf(stderr,
                        "%lld bytes freed (now allocated: %lld bytes)\n",
                        (long long) block->size,
                        (long long) ctx->cur_mem_usage_device);
        }
        block->references = NULL;
    }
    return 0;
}
static int memblock_alloc_device(struct futhark_context *ctx,
                                 struct memblock_device *block, int64_t size,
                                 const char *desc)
{
    if (size < 0)
        futhark_panic(1,
                      "Negative allocation of %lld bytes attempted for %s in %s.\n",
                      (long long) size, desc, "space 'device'",
                      ctx->cur_mem_usage_device);
    
    int ret = memblock_unref_device(ctx, block, desc);
    
    ctx->cur_mem_usage_device += size;
    if (ctx->detail_memory)
        fprintf(stderr,
                "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)",
                (long long) size, desc, "space 'device'",
                (long long) ctx->cur_mem_usage_device);
    if (ctx->cur_mem_usage_device > ctx->peak_mem_usage_device) {
        ctx->peak_mem_usage_device = ctx->cur_mem_usage_device;
        if (ctx->detail_memory)
            fprintf(stderr, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(stderr, ".\n");
    OPENCL_SUCCEED_OR_RETURN(opencl_alloc(&ctx->opencl, size, desc,
                                          &block->mem));
    block->references = (int *) malloc(sizeof(int));
    *block->references = 1;
    block->size = size;
    block->desc = desc;
    return ret;
}
static int memblock_set_device(struct futhark_context *ctx,
                               struct memblock_device *lhs,
                               struct memblock_device *rhs, const
                               char *lhs_desc)
{
    int ret = memblock_unref_device(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
static int memblock_unref(struct futhark_context *ctx, struct memblock *block,
                          const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(stderr,
                    "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n",
                    desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            free(block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(stderr,
                        "%lld bytes freed (now allocated: %lld bytes)\n",
                        (long long) block->size,
                        (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
static int memblock_alloc(struct futhark_context *ctx, struct memblock *block,
                          int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1,
                      "Negative allocation of %lld bytes attempted for %s in %s.\n",
                      (long long) size, desc, "default space",
                      ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    ctx->cur_mem_usage_default += size;
    if (ctx->detail_memory)
        fprintf(stderr,
                "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)",
                (long long) size, desc, "default space",
                (long long) ctx->cur_mem_usage_default);
    if (ctx->cur_mem_usage_default > ctx->peak_mem_usage_default) {
        ctx->peak_mem_usage_default = ctx->cur_mem_usage_default;
        if (ctx->detail_memory)
            fprintf(stderr, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(stderr, ".\n");
    block->mem = (char *) malloc(size);
    block->references = (int *) malloc(sizeof(int));
    *block->references = 1;
    block->size = size;
    block->desc = desc;
    return ret;
}
static int memblock_set(struct futhark_context *ctx, struct memblock *lhs,
                        struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    struct str_builder builder;
    
    str_builder_init(&builder);
    if (ctx->detail_memory || ctx->profiling) {
        str_builder(&builder,
                    "Peak memory usage for space 'device': %lld bytes.\n",
                    (long long) ctx->peak_mem_usage_device);
        { }
    }
    if (ctx->profiling) {
        OPENCL_SUCCEED_FATAL(opencl_tally_profiling_records(&ctx->opencl));
        str_builder(&builder,
                    "copy_dev_to_dev                       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_dev_to_dev_runs,
                    (long) ctx->copy_dev_to_dev_total_runtime /
                    (ctx->copy_dev_to_dev_runs !=
                     0 ? ctx->copy_dev_to_dev_runs : 1),
                    (long) ctx->copy_dev_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_dev_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_dev_to_dev_runs;
        str_builder(&builder,
                    "copy_dev_to_host                      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_dev_to_host_runs,
                    (long) ctx->copy_dev_to_host_total_runtime /
                    (ctx->copy_dev_to_host_runs !=
                     0 ? ctx->copy_dev_to_host_runs : 1),
                    (long) ctx->copy_dev_to_host_total_runtime);
        ctx->total_runtime += ctx->copy_dev_to_host_total_runtime;
        ctx->total_runs += ctx->copy_dev_to_host_runs;
        str_builder(&builder,
                    "copy_host_to_dev                      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_host_to_dev_runs,
                    (long) ctx->copy_host_to_dev_total_runtime /
                    (ctx->copy_host_to_dev_runs !=
                     0 ? ctx->copy_host_to_dev_runs : 1),
                    (long) ctx->copy_host_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_host_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_host_to_dev_runs;
        str_builder(&builder,
                    "copy_scalar_to_dev                    ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_scalar_to_dev_runs,
                    (long) ctx->copy_scalar_to_dev_total_runtime /
                    (ctx->copy_scalar_to_dev_runs !=
                     0 ? ctx->copy_scalar_to_dev_runs : 1),
                    (long) ctx->copy_scalar_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_scalar_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_scalar_to_dev_runs;
        str_builder(&builder,
                    "copy_scalar_from_dev                  ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_scalar_from_dev_runs,
                    (long) ctx->copy_scalar_from_dev_total_runtime /
                    (ctx->copy_scalar_from_dev_runs !=
                     0 ? ctx->copy_scalar_from_dev_runs : 1),
                    (long) ctx->copy_scalar_from_dev_total_runtime);
        ctx->total_runtime += ctx->copy_scalar_from_dev_total_runtime;
        ctx->total_runs += ctx->copy_scalar_from_dev_runs;
        str_builder(&builder,
                    "builtin#replicate_f32.replicate_28460 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhreplicate_f32zireplicate_28460_runs,
                    (long) ctx->builtinzhreplicate_f32zireplicate_28460_total_runtime /
                    (ctx->builtinzhreplicate_f32zireplicate_28460_runs !=
                     0 ? ctx->builtinzhreplicate_f32zireplicate_28460_runs : 1),
                    (long) ctx->builtinzhreplicate_f32zireplicate_28460_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhreplicate_f32zireplicate_28460_total_runtime;
        ctx->total_runs += ctx->builtinzhreplicate_f32zireplicate_28460_runs;
        str_builder(&builder,
                    "builtin#replicate_i64.replicate_28051 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhreplicate_i64zireplicate_28051_runs,
                    (long) ctx->builtinzhreplicate_i64zireplicate_28051_total_runtime /
                    (ctx->builtinzhreplicate_i64zireplicate_28051_runs !=
                     0 ? ctx->builtinzhreplicate_i64zireplicate_28051_runs : 1),
                    (long) ctx->builtinzhreplicate_i64zireplicate_28051_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhreplicate_i64zireplicate_28051_total_runtime;
        ctx->total_runs += ctx->builtinzhreplicate_i64zireplicate_28051_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32                 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_runs,
                    (long) ctx->gpu_map_transpose_f32_total_runtime /
                    (ctx->gpu_map_transpose_f32_runs !=
                     0 ? ctx->gpu_map_transpose_f32_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_total_runtime);
        ctx->total_runtime += ctx->gpu_map_transpose_f32_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32_low_height      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_low_height_runs,
                    (long) ctx->gpu_map_transpose_f32_low_height_total_runtime /
                    (ctx->gpu_map_transpose_f32_low_height_runs !=
                     0 ? ctx->gpu_map_transpose_f32_low_height_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_low_height_total_runtime);
        ctx->total_runtime +=
            ctx->gpu_map_transpose_f32_low_height_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_low_height_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32_low_width       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_low_width_runs,
                    (long) ctx->gpu_map_transpose_f32_low_width_total_runtime /
                    (ctx->gpu_map_transpose_f32_low_width_runs !=
                     0 ? ctx->gpu_map_transpose_f32_low_width_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_low_width_total_runtime);
        ctx->total_runtime +=
            ctx->gpu_map_transpose_f32_low_width_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_low_width_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32_small           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_small_runs,
                    (long) ctx->gpu_map_transpose_f32_small_total_runtime /
                    (ctx->gpu_map_transpose_f32_small_runs !=
                     0 ? ctx->gpu_map_transpose_f32_small_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_small_total_runtime);
        ctx->total_runtime += ctx->gpu_map_transpose_f32_small_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_small_runs;
        str_builder(&builder,
                    "main.copy_28472                       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzicopy_28472_runs,
                    (long) ctx->mainzicopy_28472_total_runtime /
                    (ctx->mainzicopy_28472_runs !=
                     0 ? ctx->mainzicopy_28472_runs : 1),
                    (long) ctx->mainzicopy_28472_total_runtime);
        ctx->total_runtime += ctx->mainzicopy_28472_total_runtime;
        ctx->total_runs += ctx->mainzicopy_28472_runs;
        str_builder(&builder,
                    "main.copy_28509                       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzicopy_28509_runs,
                    (long) ctx->mainzicopy_28509_total_runtime /
                    (ctx->mainzicopy_28509_runs !=
                     0 ? ctx->mainzicopy_28509_runs : 1),
                    (long) ctx->mainzicopy_28509_total_runtime);
        ctx->total_runtime += ctx->mainzicopy_28509_total_runtime;
        ctx->total_runs += ctx->mainzicopy_28509_runs;
        str_builder(&builder,
                    "main.scan_stage1_25333                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_25333_runs,
                    (long) ctx->mainziscan_stage1_25333_total_runtime /
                    (ctx->mainziscan_stage1_25333_runs !=
                     0 ? ctx->mainziscan_stage1_25333_runs : 1),
                    (long) ctx->mainziscan_stage1_25333_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_25333_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_25333_runs;
        str_builder(&builder,
                    "main.scan_stage1_25366                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_25366_runs,
                    (long) ctx->mainziscan_stage1_25366_total_runtime /
                    (ctx->mainziscan_stage1_25366_runs !=
                     0 ? ctx->mainziscan_stage1_25366_runs : 1),
                    (long) ctx->mainziscan_stage1_25366_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_25366_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_25366_runs;
        str_builder(&builder,
                    "main.scan_stage1_25374                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_25374_runs,
                    (long) ctx->mainziscan_stage1_25374_total_runtime /
                    (ctx->mainziscan_stage1_25374_runs !=
                     0 ? ctx->mainziscan_stage1_25374_runs : 1),
                    (long) ctx->mainziscan_stage1_25374_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_25374_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_25374_runs;
        str_builder(&builder,
                    "main.scan_stage1_25382                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_25382_runs,
                    (long) ctx->mainziscan_stage1_25382_total_runtime /
                    (ctx->mainziscan_stage1_25382_runs !=
                     0 ? ctx->mainziscan_stage1_25382_runs : 1),
                    (long) ctx->mainziscan_stage1_25382_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_25382_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_25382_runs;
        str_builder(&builder,
                    "main.scan_stage1_25434                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_25434_runs,
                    (long) ctx->mainziscan_stage1_25434_total_runtime /
                    (ctx->mainziscan_stage1_25434_runs !=
                     0 ? ctx->mainziscan_stage1_25434_runs : 1),
                    (long) ctx->mainziscan_stage1_25434_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_25434_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_25434_runs;
        str_builder(&builder,
                    "main.scan_stage2_25333                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_25333_runs,
                    (long) ctx->mainziscan_stage2_25333_total_runtime /
                    (ctx->mainziscan_stage2_25333_runs !=
                     0 ? ctx->mainziscan_stage2_25333_runs : 1),
                    (long) ctx->mainziscan_stage2_25333_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_25333_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_25333_runs;
        str_builder(&builder,
                    "main.scan_stage2_25366                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_25366_runs,
                    (long) ctx->mainziscan_stage2_25366_total_runtime /
                    (ctx->mainziscan_stage2_25366_runs !=
                     0 ? ctx->mainziscan_stage2_25366_runs : 1),
                    (long) ctx->mainziscan_stage2_25366_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_25366_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_25366_runs;
        str_builder(&builder,
                    "main.scan_stage2_25374                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_25374_runs,
                    (long) ctx->mainziscan_stage2_25374_total_runtime /
                    (ctx->mainziscan_stage2_25374_runs !=
                     0 ? ctx->mainziscan_stage2_25374_runs : 1),
                    (long) ctx->mainziscan_stage2_25374_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_25374_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_25374_runs;
        str_builder(&builder,
                    "main.scan_stage2_25382                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_25382_runs,
                    (long) ctx->mainziscan_stage2_25382_total_runtime /
                    (ctx->mainziscan_stage2_25382_runs !=
                     0 ? ctx->mainziscan_stage2_25382_runs : 1),
                    (long) ctx->mainziscan_stage2_25382_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_25382_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_25382_runs;
        str_builder(&builder,
                    "main.scan_stage2_25434                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_25434_runs,
                    (long) ctx->mainziscan_stage2_25434_total_runtime /
                    (ctx->mainziscan_stage2_25434_runs !=
                     0 ? ctx->mainziscan_stage2_25434_runs : 1),
                    (long) ctx->mainziscan_stage2_25434_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_25434_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_25434_runs;
        str_builder(&builder,
                    "main.scan_stage3_25333                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_25333_runs,
                    (long) ctx->mainziscan_stage3_25333_total_runtime /
                    (ctx->mainziscan_stage3_25333_runs !=
                     0 ? ctx->mainziscan_stage3_25333_runs : 1),
                    (long) ctx->mainziscan_stage3_25333_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_25333_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_25333_runs;
        str_builder(&builder,
                    "main.scan_stage3_25366                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_25366_runs,
                    (long) ctx->mainziscan_stage3_25366_total_runtime /
                    (ctx->mainziscan_stage3_25366_runs !=
                     0 ? ctx->mainziscan_stage3_25366_runs : 1),
                    (long) ctx->mainziscan_stage3_25366_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_25366_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_25366_runs;
        str_builder(&builder,
                    "main.scan_stage3_25374                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_25374_runs,
                    (long) ctx->mainziscan_stage3_25374_total_runtime /
                    (ctx->mainziscan_stage3_25374_runs !=
                     0 ? ctx->mainziscan_stage3_25374_runs : 1),
                    (long) ctx->mainziscan_stage3_25374_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_25374_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_25374_runs;
        str_builder(&builder,
                    "main.scan_stage3_25382                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_25382_runs,
                    (long) ctx->mainziscan_stage3_25382_total_runtime /
                    (ctx->mainziscan_stage3_25382_runs !=
                     0 ? ctx->mainziscan_stage3_25382_runs : 1),
                    (long) ctx->mainziscan_stage3_25382_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_25382_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_25382_runs;
        str_builder(&builder,
                    "main.scan_stage3_25434                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_25434_runs,
                    (long) ctx->mainziscan_stage3_25434_total_runtime /
                    (ctx->mainziscan_stage3_25434_runs !=
                     0 ? ctx->mainziscan_stage3_25434_runs : 1),
                    (long) ctx->mainziscan_stage3_25434_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_25434_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_25434_runs;
        str_builder(&builder,
                    "main.seghist_global_25351             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziseghist_global_25351_runs,
                    (long) ctx->mainziseghist_global_25351_total_runtime /
                    (ctx->mainziseghist_global_25351_runs !=
                     0 ? ctx->mainziseghist_global_25351_runs : 1),
                    (long) ctx->mainziseghist_global_25351_total_runtime);
        ctx->total_runtime += ctx->mainziseghist_global_25351_total_runtime;
        ctx->total_runs += ctx->mainziseghist_global_25351_runs;
        str_builder(&builder,
                    "main.seghist_local_25351              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziseghist_local_25351_runs,
                    (long) ctx->mainziseghist_local_25351_total_runtime /
                    (ctx->mainziseghist_local_25351_runs !=
                     0 ? ctx->mainziseghist_local_25351_runs : 1),
                    (long) ctx->mainziseghist_local_25351_total_runtime);
        ctx->total_runtime += ctx->mainziseghist_local_25351_total_runtime;
        ctx->total_runs += ctx->mainziseghist_local_25351_runs;
        str_builder(&builder,
                    "main.segmap_24279                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_24279_runs,
                    (long) ctx->mainzisegmap_24279_total_runtime /
                    (ctx->mainzisegmap_24279_runs !=
                     0 ? ctx->mainzisegmap_24279_runs : 1),
                    (long) ctx->mainzisegmap_24279_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_24279_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_24279_runs;
        str_builder(&builder,
                    "main.segmap_24428                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_24428_runs,
                    (long) ctx->mainzisegmap_24428_total_runtime /
                    (ctx->mainzisegmap_24428_runs !=
                     0 ? ctx->mainzisegmap_24428_runs : 1),
                    (long) ctx->mainzisegmap_24428_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_24428_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_24428_runs;
        str_builder(&builder,
                    "main.segmap_24906                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_24906_runs,
                    (long) ctx->mainzisegmap_24906_total_runtime /
                    (ctx->mainzisegmap_24906_runs !=
                     0 ? ctx->mainzisegmap_24906_runs : 1),
                    (long) ctx->mainzisegmap_24906_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_24906_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_24906_runs;
        str_builder(&builder,
                    "main.segmap_24944                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_24944_runs,
                    (long) ctx->mainzisegmap_24944_total_runtime /
                    (ctx->mainzisegmap_24944_runs !=
                     0 ? ctx->mainzisegmap_24944_runs : 1),
                    (long) ctx->mainzisegmap_24944_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_24944_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_24944_runs;
        str_builder(&builder,
                    "main.segmap_25001                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_25001_runs,
                    (long) ctx->mainzisegmap_25001_total_runtime /
                    (ctx->mainzisegmap_25001_runs !=
                     0 ? ctx->mainzisegmap_25001_runs : 1),
                    (long) ctx->mainzisegmap_25001_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_25001_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_25001_runs;
        str_builder(&builder,
                    "main.segmap_25099                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_25099_runs,
                    (long) ctx->mainzisegmap_25099_total_runtime /
                    (ctx->mainzisegmap_25099_runs !=
                     0 ? ctx->mainzisegmap_25099_runs : 1),
                    (long) ctx->mainzisegmap_25099_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_25099_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_25099_runs;
        str_builder(&builder,
                    "main.segmap_25163                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_25163_runs,
                    (long) ctx->mainzisegmap_25163_total_runtime /
                    (ctx->mainzisegmap_25163_runs !=
                     0 ? ctx->mainzisegmap_25163_runs : 1),
                    (long) ctx->mainzisegmap_25163_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_25163_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_25163_runs;
        str_builder(&builder,
                    "main.segmap_25436                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_25436_runs,
                    (long) ctx->mainzisegmap_25436_total_runtime /
                    (ctx->mainzisegmap_25436_runs !=
                     0 ? ctx->mainzisegmap_25436_runs : 1),
                    (long) ctx->mainzisegmap_25436_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_25436_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_25436_runs;
        str_builder(&builder,
                    "main.segmap_25508                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_25508_runs,
                    (long) ctx->mainzisegmap_25508_total_runtime /
                    (ctx->mainzisegmap_25508_runs !=
                     0 ? ctx->mainzisegmap_25508_runs : 1),
                    (long) ctx->mainzisegmap_25508_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_25508_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_25508_runs;
        str_builder(&builder,
                    "main.segmap_25623                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_25623_runs,
                    (long) ctx->mainzisegmap_25623_total_runtime /
                    (ctx->mainzisegmap_25623_runs !=
                     0 ? ctx->mainzisegmap_25623_runs : 1),
                    (long) ctx->mainzisegmap_25623_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_25623_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_25623_runs;
        str_builder(&builder,
                    "main.segmap_intragroup_24645          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_intragroup_24645_runs,
                    (long) ctx->mainzisegmap_intragroup_24645_total_runtime /
                    (ctx->mainzisegmap_intragroup_24645_runs !=
                     0 ? ctx->mainzisegmap_intragroup_24645_runs : 1),
                    (long) ctx->mainzisegmap_intragroup_24645_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_intragroup_24645_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_intragroup_24645_runs;
        str_builder(&builder,
                    "main.segmap_intragroup_25506          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_intragroup_25506_runs,
                    (long) ctx->mainzisegmap_intragroup_25506_total_runtime /
                    (ctx->mainzisegmap_intragroup_25506_runs !=
                     0 ? ctx->mainzisegmap_intragroup_25506_runs : 1),
                    (long) ctx->mainzisegmap_intragroup_25506_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_intragroup_25506_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_intragroup_25506_runs;
        str_builder(&builder,
                    "main.segred_large_25658               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_large_25658_runs,
                    (long) ctx->mainzisegred_large_25658_total_runtime /
                    (ctx->mainzisegred_large_25658_runs !=
                     0 ? ctx->mainzisegred_large_25658_runs : 1),
                    (long) ctx->mainzisegred_large_25658_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_large_25658_total_runtime;
        ctx->total_runs += ctx->mainzisegred_large_25658_runs;
        str_builder(&builder,
                    "main.segred_large_28142               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_large_28142_runs,
                    (long) ctx->mainzisegred_large_28142_total_runtime /
                    (ctx->mainzisegred_large_28142_runs !=
                     0 ? ctx->mainzisegred_large_28142_runs : 1),
                    (long) ctx->mainzisegred_large_28142_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_large_28142_total_runtime;
        ctx->total_runs += ctx->mainzisegred_large_28142_runs;
        str_builder(&builder,
                    "main.segred_nonseg_24275              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_24275_runs,
                    (long) ctx->mainzisegred_nonseg_24275_total_runtime /
                    (ctx->mainzisegred_nonseg_24275_runs !=
                     0 ? ctx->mainzisegred_nonseg_24275_runs : 1),
                    (long) ctx->mainzisegred_nonseg_24275_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_24275_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_24275_runs;
        str_builder(&builder,
                    "main.segred_nonseg_25343              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_25343_runs,
                    (long) ctx->mainzisegred_nonseg_25343_total_runtime /
                    (ctx->mainzisegred_nonseg_25343_runs !=
                     0 ? ctx->mainzisegred_nonseg_25343_runs : 1),
                    (long) ctx->mainzisegred_nonseg_25343_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_25343_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_25343_runs;
        str_builder(&builder,
                    "main.segred_nonseg_25453              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_25453_runs,
                    (long) ctx->mainzisegred_nonseg_25453_total_runtime /
                    (ctx->mainzisegred_nonseg_25453_runs !=
                     0 ? ctx->mainzisegred_nonseg_25453_runs : 1),
                    (long) ctx->mainzisegred_nonseg_25453_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_25453_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_25453_runs;
        str_builder(&builder,
                    "main.segred_nonseg_25726              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_25726_runs,
                    (long) ctx->mainzisegred_nonseg_25726_total_runtime /
                    (ctx->mainzisegred_nonseg_25726_runs !=
                     0 ? ctx->mainzisegred_nonseg_25726_runs : 1),
                    (long) ctx->mainzisegred_nonseg_25726_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_25726_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_25726_runs;
        str_builder(&builder,
                    "main.segred_small_25658               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_small_25658_runs,
                    (long) ctx->mainzisegred_small_25658_total_runtime /
                    (ctx->mainzisegred_small_25658_runs !=
                     0 ? ctx->mainzisegred_small_25658_runs : 1),
                    (long) ctx->mainzisegred_small_25658_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_small_25658_total_runtime;
        ctx->total_runs += ctx->mainzisegred_small_25658_runs;
        str_builder(&builder,
                    "main.segred_small_28142               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_small_28142_runs,
                    (long) ctx->mainzisegred_small_28142_total_runtime /
                    (ctx->mainzisegred_small_28142_runs !=
                     0 ? ctx->mainzisegred_small_28142_runs : 1),
                    (long) ctx->mainzisegred_small_28142_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_small_28142_total_runtime;
        ctx->total_runs += ctx->mainzisegred_small_28142_runs;
        str_builder(&builder,
                    "test.copy_28473                       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzicopy_28473_runs,
                    (long) ctx->testzicopy_28473_total_runtime /
                    (ctx->testzicopy_28473_runs !=
                     0 ? ctx->testzicopy_28473_runs : 1),
                    (long) ctx->testzicopy_28473_total_runtime);
        ctx->total_runtime += ctx->testzicopy_28473_total_runtime;
        ctx->total_runs += ctx->testzicopy_28473_runs;
        str_builder(&builder,
                    "test.copy_28510                       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzicopy_28510_runs,
                    (long) ctx->testzicopy_28510_total_runtime /
                    (ctx->testzicopy_28510_runs !=
                     0 ? ctx->testzicopy_28510_runs : 1),
                    (long) ctx->testzicopy_28510_total_runtime);
        ctx->total_runtime += ctx->testzicopy_28510_total_runtime;
        ctx->total_runs += ctx->testzicopy_28510_runs;
        str_builder(&builder,
                    "test.scan_stage1_26935                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_26935_runs,
                    (long) ctx->testziscan_stage1_26935_total_runtime /
                    (ctx->testziscan_stage1_26935_runs !=
                     0 ? ctx->testziscan_stage1_26935_runs : 1),
                    (long) ctx->testziscan_stage1_26935_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_26935_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_26935_runs;
        str_builder(&builder,
                    "test.scan_stage1_26968                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_26968_runs,
                    (long) ctx->testziscan_stage1_26968_total_runtime /
                    (ctx->testziscan_stage1_26968_runs !=
                     0 ? ctx->testziscan_stage1_26968_runs : 1),
                    (long) ctx->testziscan_stage1_26968_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_26968_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_26968_runs;
        str_builder(&builder,
                    "test.scan_stage1_26976                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_26976_runs,
                    (long) ctx->testziscan_stage1_26976_total_runtime /
                    (ctx->testziscan_stage1_26976_runs !=
                     0 ? ctx->testziscan_stage1_26976_runs : 1),
                    (long) ctx->testziscan_stage1_26976_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_26976_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_26976_runs;
        str_builder(&builder,
                    "test.scan_stage1_26984                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_26984_runs,
                    (long) ctx->testziscan_stage1_26984_total_runtime /
                    (ctx->testziscan_stage1_26984_runs !=
                     0 ? ctx->testziscan_stage1_26984_runs : 1),
                    (long) ctx->testziscan_stage1_26984_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_26984_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_26984_runs;
        str_builder(&builder,
                    "test.scan_stage1_27036                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_27036_runs,
                    (long) ctx->testziscan_stage1_27036_total_runtime /
                    (ctx->testziscan_stage1_27036_runs !=
                     0 ? ctx->testziscan_stage1_27036_runs : 1),
                    (long) ctx->testziscan_stage1_27036_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_27036_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_27036_runs;
        str_builder(&builder,
                    "test.scan_stage2_26935                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_26935_runs,
                    (long) ctx->testziscan_stage2_26935_total_runtime /
                    (ctx->testziscan_stage2_26935_runs !=
                     0 ? ctx->testziscan_stage2_26935_runs : 1),
                    (long) ctx->testziscan_stage2_26935_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_26935_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_26935_runs;
        str_builder(&builder,
                    "test.scan_stage2_26968                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_26968_runs,
                    (long) ctx->testziscan_stage2_26968_total_runtime /
                    (ctx->testziscan_stage2_26968_runs !=
                     0 ? ctx->testziscan_stage2_26968_runs : 1),
                    (long) ctx->testziscan_stage2_26968_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_26968_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_26968_runs;
        str_builder(&builder,
                    "test.scan_stage2_26976                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_26976_runs,
                    (long) ctx->testziscan_stage2_26976_total_runtime /
                    (ctx->testziscan_stage2_26976_runs !=
                     0 ? ctx->testziscan_stage2_26976_runs : 1),
                    (long) ctx->testziscan_stage2_26976_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_26976_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_26976_runs;
        str_builder(&builder,
                    "test.scan_stage2_26984                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_26984_runs,
                    (long) ctx->testziscan_stage2_26984_total_runtime /
                    (ctx->testziscan_stage2_26984_runs !=
                     0 ? ctx->testziscan_stage2_26984_runs : 1),
                    (long) ctx->testziscan_stage2_26984_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_26984_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_26984_runs;
        str_builder(&builder,
                    "test.scan_stage2_27036                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_27036_runs,
                    (long) ctx->testziscan_stage2_27036_total_runtime /
                    (ctx->testziscan_stage2_27036_runs !=
                     0 ? ctx->testziscan_stage2_27036_runs : 1),
                    (long) ctx->testziscan_stage2_27036_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_27036_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_27036_runs;
        str_builder(&builder,
                    "test.scan_stage3_26935                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_26935_runs,
                    (long) ctx->testziscan_stage3_26935_total_runtime /
                    (ctx->testziscan_stage3_26935_runs !=
                     0 ? ctx->testziscan_stage3_26935_runs : 1),
                    (long) ctx->testziscan_stage3_26935_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_26935_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_26935_runs;
        str_builder(&builder,
                    "test.scan_stage3_26968                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_26968_runs,
                    (long) ctx->testziscan_stage3_26968_total_runtime /
                    (ctx->testziscan_stage3_26968_runs !=
                     0 ? ctx->testziscan_stage3_26968_runs : 1),
                    (long) ctx->testziscan_stage3_26968_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_26968_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_26968_runs;
        str_builder(&builder,
                    "test.scan_stage3_26976                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_26976_runs,
                    (long) ctx->testziscan_stage3_26976_total_runtime /
                    (ctx->testziscan_stage3_26976_runs !=
                     0 ? ctx->testziscan_stage3_26976_runs : 1),
                    (long) ctx->testziscan_stage3_26976_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_26976_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_26976_runs;
        str_builder(&builder,
                    "test.scan_stage3_26984                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_26984_runs,
                    (long) ctx->testziscan_stage3_26984_total_runtime /
                    (ctx->testziscan_stage3_26984_runs !=
                     0 ? ctx->testziscan_stage3_26984_runs : 1),
                    (long) ctx->testziscan_stage3_26984_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_26984_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_26984_runs;
        str_builder(&builder,
                    "test.scan_stage3_27036                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_27036_runs,
                    (long) ctx->testziscan_stage3_27036_total_runtime /
                    (ctx->testziscan_stage3_27036_runs !=
                     0 ? ctx->testziscan_stage3_27036_runs : 1),
                    (long) ctx->testziscan_stage3_27036_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_27036_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_27036_runs;
        str_builder(&builder,
                    "test.seghist_global_26953             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziseghist_global_26953_runs,
                    (long) ctx->testziseghist_global_26953_total_runtime /
                    (ctx->testziseghist_global_26953_runs !=
                     0 ? ctx->testziseghist_global_26953_runs : 1),
                    (long) ctx->testziseghist_global_26953_total_runtime);
        ctx->total_runtime += ctx->testziseghist_global_26953_total_runtime;
        ctx->total_runs += ctx->testziseghist_global_26953_runs;
        str_builder(&builder,
                    "test.seghist_local_26953              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziseghist_local_26953_runs,
                    (long) ctx->testziseghist_local_26953_total_runtime /
                    (ctx->testziseghist_local_26953_runs !=
                     0 ? ctx->testziseghist_local_26953_runs : 1),
                    (long) ctx->testziseghist_local_26953_total_runtime);
        ctx->total_runtime += ctx->testziseghist_local_26953_total_runtime;
        ctx->total_runs += ctx->testziseghist_local_26953_runs;
        str_builder(&builder,
                    "test.segmap_25881                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_25881_runs,
                    (long) ctx->testzisegmap_25881_total_runtime /
                    (ctx->testzisegmap_25881_runs !=
                     0 ? ctx->testzisegmap_25881_runs : 1),
                    (long) ctx->testzisegmap_25881_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_25881_total_runtime;
        ctx->total_runs += ctx->testzisegmap_25881_runs;
        str_builder(&builder,
                    "test.segmap_26030                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_26030_runs,
                    (long) ctx->testzisegmap_26030_total_runtime /
                    (ctx->testzisegmap_26030_runs !=
                     0 ? ctx->testzisegmap_26030_runs : 1),
                    (long) ctx->testzisegmap_26030_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_26030_total_runtime;
        ctx->total_runs += ctx->testzisegmap_26030_runs;
        str_builder(&builder,
                    "test.segmap_26508                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_26508_runs,
                    (long) ctx->testzisegmap_26508_total_runtime /
                    (ctx->testzisegmap_26508_runs !=
                     0 ? ctx->testzisegmap_26508_runs : 1),
                    (long) ctx->testzisegmap_26508_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_26508_total_runtime;
        ctx->total_runs += ctx->testzisegmap_26508_runs;
        str_builder(&builder,
                    "test.segmap_26546                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_26546_runs,
                    (long) ctx->testzisegmap_26546_total_runtime /
                    (ctx->testzisegmap_26546_runs !=
                     0 ? ctx->testzisegmap_26546_runs : 1),
                    (long) ctx->testzisegmap_26546_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_26546_total_runtime;
        ctx->total_runs += ctx->testzisegmap_26546_runs;
        str_builder(&builder,
                    "test.segmap_26603                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_26603_runs,
                    (long) ctx->testzisegmap_26603_total_runtime /
                    (ctx->testzisegmap_26603_runs !=
                     0 ? ctx->testzisegmap_26603_runs : 1),
                    (long) ctx->testzisegmap_26603_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_26603_total_runtime;
        ctx->total_runs += ctx->testzisegmap_26603_runs;
        str_builder(&builder,
                    "test.segmap_26701                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_26701_runs,
                    (long) ctx->testzisegmap_26701_total_runtime /
                    (ctx->testzisegmap_26701_runs !=
                     0 ? ctx->testzisegmap_26701_runs : 1),
                    (long) ctx->testzisegmap_26701_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_26701_total_runtime;
        ctx->total_runs += ctx->testzisegmap_26701_runs;
        str_builder(&builder,
                    "test.segmap_26765                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_26765_runs,
                    (long) ctx->testzisegmap_26765_total_runtime /
                    (ctx->testzisegmap_26765_runs !=
                     0 ? ctx->testzisegmap_26765_runs : 1),
                    (long) ctx->testzisegmap_26765_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_26765_total_runtime;
        ctx->total_runs += ctx->testzisegmap_26765_runs;
        str_builder(&builder,
                    "test.segmap_27038                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_27038_runs,
                    (long) ctx->testzisegmap_27038_total_runtime /
                    (ctx->testzisegmap_27038_runs !=
                     0 ? ctx->testzisegmap_27038_runs : 1),
                    (long) ctx->testzisegmap_27038_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_27038_total_runtime;
        ctx->total_runs += ctx->testzisegmap_27038_runs;
        str_builder(&builder,
                    "test.segmap_27107                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_27107_runs,
                    (long) ctx->testzisegmap_27107_total_runtime /
                    (ctx->testzisegmap_27107_runs !=
                     0 ? ctx->testzisegmap_27107_runs : 1),
                    (long) ctx->testzisegmap_27107_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_27107_total_runtime;
        ctx->total_runs += ctx->testzisegmap_27107_runs;
        str_builder(&builder,
                    "test.segmap_27220                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_27220_runs,
                    (long) ctx->testzisegmap_27220_total_runtime /
                    (ctx->testzisegmap_27220_runs !=
                     0 ? ctx->testzisegmap_27220_runs : 1),
                    (long) ctx->testzisegmap_27220_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_27220_total_runtime;
        ctx->total_runs += ctx->testzisegmap_27220_runs;
        str_builder(&builder,
                    "test.segmap_intragroup_26247          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_intragroup_26247_runs,
                    (long) ctx->testzisegmap_intragroup_26247_total_runtime /
                    (ctx->testzisegmap_intragroup_26247_runs !=
                     0 ? ctx->testzisegmap_intragroup_26247_runs : 1),
                    (long) ctx->testzisegmap_intragroup_26247_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_intragroup_26247_total_runtime;
        ctx->total_runs += ctx->testzisegmap_intragroup_26247_runs;
        str_builder(&builder,
                    "test.segmap_intragroup_27105          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_intragroup_27105_runs,
                    (long) ctx->testzisegmap_intragroup_27105_total_runtime /
                    (ctx->testzisegmap_intragroup_27105_runs !=
                     0 ? ctx->testzisegmap_intragroup_27105_runs : 1),
                    (long) ctx->testzisegmap_intragroup_27105_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_intragroup_27105_total_runtime;
        ctx->total_runs += ctx->testzisegmap_intragroup_27105_runs;
        str_builder(&builder,
                    "test.segred_large_27255               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_large_27255_runs,
                    (long) ctx->testzisegred_large_27255_total_runtime /
                    (ctx->testzisegred_large_27255_runs !=
                     0 ? ctx->testzisegred_large_27255_runs : 1),
                    (long) ctx->testzisegred_large_27255_total_runtime);
        ctx->total_runtime += ctx->testzisegred_large_27255_total_runtime;
        ctx->total_runs += ctx->testzisegred_large_27255_runs;
        str_builder(&builder,
                    "test.segred_large_28143               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_large_28143_runs,
                    (long) ctx->testzisegred_large_28143_total_runtime /
                    (ctx->testzisegred_large_28143_runs !=
                     0 ? ctx->testzisegred_large_28143_runs : 1),
                    (long) ctx->testzisegred_large_28143_total_runtime);
        ctx->total_runtime += ctx->testzisegred_large_28143_total_runtime;
        ctx->total_runs += ctx->testzisegred_large_28143_runs;
        str_builder(&builder,
                    "test.segred_nonseg_25877              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_25877_runs,
                    (long) ctx->testzisegred_nonseg_25877_total_runtime /
                    (ctx->testzisegred_nonseg_25877_runs !=
                     0 ? ctx->testzisegred_nonseg_25877_runs : 1),
                    (long) ctx->testzisegred_nonseg_25877_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_25877_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_25877_runs;
        str_builder(&builder,
                    "test.segred_nonseg_26945              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_26945_runs,
                    (long) ctx->testzisegred_nonseg_26945_total_runtime /
                    (ctx->testzisegred_nonseg_26945_runs !=
                     0 ? ctx->testzisegred_nonseg_26945_runs : 1),
                    (long) ctx->testzisegred_nonseg_26945_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_26945_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_26945_runs;
        str_builder(&builder,
                    "test.segred_nonseg_27054              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_27054_runs,
                    (long) ctx->testzisegred_nonseg_27054_total_runtime /
                    (ctx->testzisegred_nonseg_27054_runs !=
                     0 ? ctx->testzisegred_nonseg_27054_runs : 1),
                    (long) ctx->testzisegred_nonseg_27054_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_27054_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_27054_runs;
        str_builder(&builder,
                    "test.segred_nonseg_27320              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_27320_runs,
                    (long) ctx->testzisegred_nonseg_27320_total_runtime /
                    (ctx->testzisegred_nonseg_27320_runs !=
                     0 ? ctx->testzisegred_nonseg_27320_runs : 1),
                    (long) ctx->testzisegred_nonseg_27320_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_27320_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_27320_runs;
        str_builder(&builder,
                    "test.segred_small_27255               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_small_27255_runs,
                    (long) ctx->testzisegred_small_27255_total_runtime /
                    (ctx->testzisegred_small_27255_runs !=
                     0 ? ctx->testzisegred_small_27255_runs : 1),
                    (long) ctx->testzisegred_small_27255_total_runtime);
        ctx->total_runtime += ctx->testzisegred_small_27255_total_runtime;
        ctx->total_runs += ctx->testzisegred_small_27255_runs;
        str_builder(&builder,
                    "test.segred_small_28143               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_small_28143_runs,
                    (long) ctx->testzisegred_small_28143_total_runtime /
                    (ctx->testzisegred_small_28143_runs !=
                     0 ? ctx->testzisegred_small_28143_runs : 1),
                    (long) ctx->testzisegred_small_28143_total_runtime);
        ctx->total_runtime += ctx->testzisegred_small_28143_total_runtime;
        ctx->total_runs += ctx->testzisegred_small_28143_runs;
        str_builder(&builder, "%d operations with cumulative runtime: %6ldus\n",
                    ctx->total_runs, ctx->total_runtime);
    }
    return builder.str;
}
char *futhark_context_get_error(struct futhark_context *ctx)
{
    char *error = ctx->error;
    
    ctx->error = NULL;
    return error;
}
void futhark_context_pause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 1;
}
void futhark_context_unpause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 0;
}
static int futrts_builtinzhgpu_map_transpose_f32(struct futhark_context *ctx,
                                                 struct memblock_device destmem_0,
                                                 int32_t destoffset_1,
                                                 struct memblock_device srcmem_2,
                                                 int32_t srcoffset_3,
                                                 int32_t num_arrays_4,
                                                 int32_t x_elems_5,
                                                 int32_t y_elems_6);
static int futrts_builtinzhreplicate_f32(struct futhark_context *ctx,
                                         struct memblock_device mem_28456,
                                         int32_t num_elems_28457,
                                         float val_28458);
static int futrts_builtinzhreplicate_i64(struct futhark_context *ctx,
                                         struct memblock_device mem_28047,
                                         int32_t num_elems_28048,
                                         int64_t val_28049);
static int futrts_main(struct futhark_context *ctx, float *out_scalar_out_28663,
                       struct memblock_device *out_mem_p_28664,
                       int64_t *out_out_arrsizze_28665,
                       struct memblock_device swap_term_mem_27633,
                       struct memblock_device payments_mem_27634,
                       struct memblock_device notional_mem_27635,
                       int64_t n_23343, int64_t n_23344, int64_t n_23345,
                       int64_t paths_23346, int64_t steps_23347, float a_23351,
                       float b_23352, float sigma_23353, float r0_23354);
static int futrts_test(struct futhark_context *ctx, float *out_scalar_out_28873,
                       int64_t paths_23826, int64_t steps_23827);
int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    
  cleanup:
    return err;
}
int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    return 0;
}
static int futrts_builtinzhgpu_map_transpose_f32(struct futhark_context *ctx,
                                                 struct memblock_device destmem_0,
                                                 int32_t destoffset_1,
                                                 struct memblock_device srcmem_2,
                                                 int32_t srcoffset_3,
                                                 int32_t num_arrays_4,
                                                 int32_t x_elems_5,
                                                 int32_t y_elems_6)
{
    (void) ctx;
    
    int err = 0;
    
    if (!(num_arrays_4 == 0 || (x_elems_5 == 0 || y_elems_6 == 0))) {
        int32_t muly_8 = squot32(16, x_elems_5);
        int32_t mulx_7 = squot32(16, y_elems_6);
        
        if (num_arrays_4 == 1 && (x_elems_5 == 1 || y_elems_6 == 1)) {
            if (sext_i32_i64(x_elems_5 * y_elems_6 * (int32_t) sizeof(float)) >
                0) {
                OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                             srcmem_2.mem,
                                                             destmem_0.mem,
                                                             sext_i32_i64(srcoffset_3),
                                                             sext_i32_i64(destoffset_1),
                                                             sext_i32_i64(x_elems_5 *
                                                             y_elems_6 *
                                                             (int32_t) sizeof(float)),
                                                             0, NULL,
                                                             ctx->profiling_paused ||
                                                             !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                       &ctx->copy_dev_to_dev_runs,
                                                                                                       &ctx->copy_dev_to_dev_total_runtime)));
                if (ctx->debugging)
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            }
        } else {
            if (sle32(x_elems_5, 8) && slt32(16, y_elems_6)) {
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        0, 1088, NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        1, sizeof(destoffset_1),
                                                        &destoffset_1));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        2, sizeof(srcoffset_3),
                                                        &srcoffset_3));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        3, sizeof(num_arrays_4),
                                                        &num_arrays_4));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        4, sizeof(x_elems_5),
                                                        &x_elems_5));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        5, sizeof(y_elems_6),
                                                        &y_elems_6));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        6, sizeof(mulx_7),
                                                        &mulx_7));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        7, sizeof(muly_8),
                                                        &muly_8));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        8,
                                                        sizeof(destmem_0.mem),
                                                        &destmem_0.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        9, sizeof(srcmem_2.mem),
                                                        &srcmem_2.mem));
                if (1 * ((size_t) sdiv_up32(x_elems_5, 16) * (size_t) 16) *
                    ((size_t) sdiv_up32(sdiv_up32(y_elems_6, muly_8), 16) *
                     (size_t) 16) * ((size_t) num_arrays_4 * (size_t) 1) != 0) {
                    const size_t global_work_sizze_28633[3] =
                                 {(size_t) sdiv_up32(x_elems_5, 16) *
                                  (size_t) 16,
                                  (size_t) sdiv_up32(sdiv_up32(y_elems_6,
                                                               muly_8), 16) *
                                  (size_t) 16, (size_t) num_arrays_4 *
                                  (size_t) 1};
                    const size_t local_work_sizze_28637[3] = {16, 16, 1};
                    int64_t time_start_28634 = 0, time_end_28635 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "gpu_map_transpose_f32_low_width");
                        fprintf(stderr, "%zu", global_work_sizze_28633[0]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", global_work_sizze_28633[1]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", global_work_sizze_28633[2]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_28637[0]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", local_work_sizze_28637[1]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", local_work_sizze_28637[2]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + 1088));
                        time_start_28634 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->gpu_map_transpose_f32_low_width,
                                                                    3, NULL,
                                                                    global_work_sizze_28633,
                                                                    local_work_sizze_28637,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->gpu_map_transpose_f32_low_width_runs,
                                                                                                              &ctx->gpu_map_transpose_f32_low_width_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_28635 = get_wall_time();
                        
                        long time_diff_28636 = time_end_28635 -
                             time_start_28634;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "gpu_map_transpose_f32_low_width",
                                time_diff_28636);
                    }
                }
            } else {
                if (sle32(y_elems_6, 8) && slt32(16, x_elems_5)) {
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            0, 1088, NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            1,
                                                            sizeof(destoffset_1),
                                                            &destoffset_1));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            2,
                                                            sizeof(srcoffset_3),
                                                            &srcoffset_3));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            3,
                                                            sizeof(num_arrays_4),
                                                            &num_arrays_4));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            4,
                                                            sizeof(x_elems_5),
                                                            &x_elems_5));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            5,
                                                            sizeof(y_elems_6),
                                                            &y_elems_6));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            6, sizeof(mulx_7),
                                                            &mulx_7));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            7, sizeof(muly_8),
                                                            &muly_8));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            8,
                                                            sizeof(destmem_0.mem),
                                                            &destmem_0.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            9,
                                                            sizeof(srcmem_2.mem),
                                                            &srcmem_2.mem));
                    if (1 * ((size_t) sdiv_up32(sdiv_up32(x_elems_5, mulx_7),
                                                16) * (size_t) 16) *
                        ((size_t) sdiv_up32(y_elems_6, 16) * (size_t) 16) *
                        ((size_t) num_arrays_4 * (size_t) 1) != 0) {
                        const size_t global_work_sizze_28638[3] =
                                     {(size_t) sdiv_up32(sdiv_up32(x_elems_5,
                                                                   mulx_7),
                                                         16) * (size_t) 16,
                                      (size_t) sdiv_up32(y_elems_6, 16) *
                                      (size_t) 16, (size_t) num_arrays_4 *
                                      (size_t) 1};
                        const size_t local_work_sizze_28642[3] = {16, 16, 1};
                        int64_t time_start_28639 = 0, time_end_28640 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "gpu_map_transpose_f32_low_height");
                            fprintf(stderr, "%zu", global_work_sizze_28638[0]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", global_work_sizze_28638[1]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", global_work_sizze_28638[2]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_28642[0]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", local_work_sizze_28642[1]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", local_work_sizze_28642[2]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + 1088));
                            time_start_28639 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->gpu_map_transpose_f32_low_height,
                                                                        3, NULL,
                                                                        global_work_sizze_28638,
                                                                        local_work_sizze_28642,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->gpu_map_transpose_f32_low_height_runs,
                                                                                                                  &ctx->gpu_map_transpose_f32_low_height_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_28640 = get_wall_time();
                            
                            long time_diff_28641 = time_end_28640 -
                                 time_start_28639;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "gpu_map_transpose_f32_low_height",
                                    time_diff_28641);
                        }
                    }
                } else {
                    if (sle32(x_elems_5, 8) && sle32(y_elems_6, 8)) {
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                0, 1, NULL));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                1,
                                                                sizeof(destoffset_1),
                                                                &destoffset_1));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                2,
                                                                sizeof(srcoffset_3),
                                                                &srcoffset_3));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                3,
                                                                sizeof(num_arrays_4),
                                                                &num_arrays_4));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                4,
                                                                sizeof(x_elems_5),
                                                                &x_elems_5));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                5,
                                                                sizeof(y_elems_6),
                                                                &y_elems_6));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                6,
                                                                sizeof(mulx_7),
                                                                &mulx_7));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                7,
                                                                sizeof(muly_8),
                                                                &muly_8));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                8,
                                                                sizeof(destmem_0.mem),
                                                                &destmem_0.mem));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                9,
                                                                sizeof(srcmem_2.mem),
                                                                &srcmem_2.mem));
                        if (1 * ((size_t) sdiv_up32(num_arrays_4 * x_elems_5 *
                                                    y_elems_6, 256) *
                                 (size_t) 256) != 0) {
                            const size_t global_work_sizze_28643[1] =
                                         {(size_t) sdiv_up32(num_arrays_4 *
                                                             x_elems_5 *
                                                             y_elems_6, 256) *
                                         (size_t) 256};
                            const size_t local_work_sizze_28647[1] = {256};
                            int64_t time_start_28644 = 0, time_end_28645 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(stderr,
                                        "Launching %s with global work size [",
                                        "gpu_map_transpose_f32_small");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_28643[0]);
                                fprintf(stderr, "] and local work size [");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_28647[0]);
                                fprintf(stderr,
                                        "]; local memory parameters sum to %d bytes.\n",
                                        (int) (0 + 1));
                                time_start_28644 = get_wall_time();
                            }
                            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                            ctx->gpu_map_transpose_f32_small,
                                                                            1,
                                                                            NULL,
                                                                            global_work_sizze_28643,
                                                                            local_work_sizze_28647,
                                                                            0,
                                                                            NULL,
                                                                            ctx->profiling_paused ||
                                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                      &ctx->gpu_map_transpose_f32_small_runs,
                                                                                                                      &ctx->gpu_map_transpose_f32_small_total_runtime)));
                            if (ctx->debugging) {
                                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                                time_end_28645 = get_wall_time();
                                
                                long time_diff_28646 = time_end_28645 -
                                     time_start_28644;
                                
                                fprintf(stderr, "kernel %s runtime: %ldus\n",
                                        "gpu_map_transpose_f32_small",
                                        time_diff_28646);
                            }
                        }
                    } else {
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                0, 4224, NULL));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                1,
                                                                sizeof(destoffset_1),
                                                                &destoffset_1));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                2,
                                                                sizeof(srcoffset_3),
                                                                &srcoffset_3));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                3,
                                                                sizeof(num_arrays_4),
                                                                &num_arrays_4));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                4,
                                                                sizeof(x_elems_5),
                                                                &x_elems_5));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                5,
                                                                sizeof(y_elems_6),
                                                                &y_elems_6));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                6,
                                                                sizeof(mulx_7),
                                                                &mulx_7));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                7,
                                                                sizeof(muly_8),
                                                                &muly_8));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                8,
                                                                sizeof(destmem_0.mem),
                                                                &destmem_0.mem));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                9,
                                                                sizeof(srcmem_2.mem),
                                                                &srcmem_2.mem));
                        if (1 * ((size_t) sdiv_up32(x_elems_5, 32) *
                                 (size_t) 32) * ((size_t) sdiv_up32(y_elems_6,
                                                                    32) *
                                                 (size_t) 8) *
                            ((size_t) num_arrays_4 * (size_t) 1) != 0) {
                            const size_t global_work_sizze_28648[3] =
                                         {(size_t) sdiv_up32(x_elems_5, 32) *
                                          (size_t) 32,
                                          (size_t) sdiv_up32(y_elems_6, 32) *
                                          (size_t) 8, (size_t) num_arrays_4 *
                                          (size_t) 1};
                            const size_t local_work_sizze_28652[3] = {32, 8, 1};
                            int64_t time_start_28649 = 0, time_end_28650 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(stderr,
                                        "Launching %s with global work size [",
                                        "gpu_map_transpose_f32");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_28648[0]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_28648[1]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_28648[2]);
                                fprintf(stderr, "] and local work size [");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_28652[0]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_28652[1]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_28652[2]);
                                fprintf(stderr,
                                        "]; local memory parameters sum to %d bytes.\n",
                                        (int) (0 + 4224));
                                time_start_28649 = get_wall_time();
                            }
                            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                            ctx->gpu_map_transpose_f32,
                                                                            3,
                                                                            NULL,
                                                                            global_work_sizze_28648,
                                                                            local_work_sizze_28652,
                                                                            0,
                                                                            NULL,
                                                                            ctx->profiling_paused ||
                                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                      &ctx->gpu_map_transpose_f32_runs,
                                                                                                                      &ctx->gpu_map_transpose_f32_total_runtime)));
                            if (ctx->debugging) {
                                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                                time_end_28650 = get_wall_time();
                                
                                long time_diff_28651 = time_end_28650 -
                                     time_start_28649;
                                
                                fprintf(stderr, "kernel %s runtime: %ldus\n",
                                        "gpu_map_transpose_f32",
                                        time_diff_28651);
                            }
                        }
                    }
                }
            }
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_builtinzhreplicate_f32(struct futhark_context *ctx,
                                         struct memblock_device mem_28456,
                                         int32_t num_elems_28457,
                                         float val_28458)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_28463;
    
    group_sizze_28463 = ctx->sizes.builtinzhreplicate_f32zigroup_sizze_28463;
    
    int64_t num_groups_28464;
    
    num_groups_28464 = sdiv_up64(num_elems_28457, group_sizze_28463);
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_f32zireplicate_28460,
                                            0, sizeof(mem_28456.mem),
                                            &mem_28456.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_f32zireplicate_28460,
                                            1, sizeof(num_elems_28457),
                                            &num_elems_28457));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_f32zireplicate_28460,
                                            2, sizeof(val_28458), &val_28458));
    if (1 * ((size_t) num_groups_28464 * (size_t) group_sizze_28463) != 0) {
        const size_t global_work_sizze_28653[1] = {(size_t) num_groups_28464 *
                     (size_t) group_sizze_28463};
        const size_t local_work_sizze_28657[1] = {group_sizze_28463};
        int64_t time_start_28654 = 0, time_end_28655 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "builtin#replicate_f32.replicate_28460");
            fprintf(stderr, "%zu", global_work_sizze_28653[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_28657[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_28654 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->builtinzhreplicate_f32zireplicate_28460,
                                                        1, NULL,
                                                        global_work_sizze_28653,
                                                        local_work_sizze_28657,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->builtinzhreplicate_f32zireplicate_28460_runs,
                                                                                                  &ctx->builtinzhreplicate_f32zireplicate_28460_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_28655 = get_wall_time();
            
            long time_diff_28656 = time_end_28655 - time_start_28654;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "builtin#replicate_f32.replicate_28460", time_diff_28656);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_builtinzhreplicate_i64(struct futhark_context *ctx,
                                         struct memblock_device mem_28047,
                                         int32_t num_elems_28048,
                                         int64_t val_28049)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_28054;
    
    group_sizze_28054 = ctx->sizes.builtinzhreplicate_i64zigroup_sizze_28054;
    
    int64_t num_groups_28055;
    
    num_groups_28055 = sdiv_up64(num_elems_28048, group_sizze_28054);
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_i64zireplicate_28051,
                                            0, sizeof(mem_28047.mem),
                                            &mem_28047.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_i64zireplicate_28051,
                                            1, sizeof(num_elems_28048),
                                            &num_elems_28048));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_i64zireplicate_28051,
                                            2, sizeof(val_28049), &val_28049));
    if (1 * ((size_t) num_groups_28055 * (size_t) group_sizze_28054) != 0) {
        const size_t global_work_sizze_28658[1] = {(size_t) num_groups_28055 *
                     (size_t) group_sizze_28054};
        const size_t local_work_sizze_28662[1] = {group_sizze_28054};
        int64_t time_start_28659 = 0, time_end_28660 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "builtin#replicate_i64.replicate_28051");
            fprintf(stderr, "%zu", global_work_sizze_28658[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_28662[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_28659 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->builtinzhreplicate_i64zireplicate_28051,
                                                        1, NULL,
                                                        global_work_sizze_28658,
                                                        local_work_sizze_28662,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->builtinzhreplicate_i64zireplicate_28051_runs,
                                                                                                  &ctx->builtinzhreplicate_i64zireplicate_28051_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_28660 = get_wall_time();
            
            long time_diff_28661 = time_end_28660 - time_start_28659;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "builtin#replicate_i64.replicate_28051", time_diff_28661);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_main(struct futhark_context *ctx, float *out_scalar_out_28663,
                       struct memblock_device *out_mem_p_28664,
                       int64_t *out_out_arrsizze_28665,
                       struct memblock_device swap_term_mem_27633,
                       struct memblock_device payments_mem_27634,
                       struct memblock_device notional_mem_27635,
                       int64_t n_23343, int64_t n_23344, int64_t n_23345,
                       int64_t paths_23346, int64_t steps_23347, float a_23351,
                       float b_23352, float sigma_23353, float r0_23354)
{
    (void) ctx;
    
    int err = 0;
    float scalar_out_27872;
    struct memblock_device out_mem_27873;
    
    out_mem_27873.references = NULL;
    
    int64_t out_arrsizze_27874;
    bool dim_match_23355 = n_23343 == n_23344;
    bool empty_or_match_cert_23356;
    
    if (!dim_match_23355) {
        ctx->error = msgprintf("Error: %s\n\nBacktrace:\n%s",
                               "function arguments of wrong shape",
                               "-> #0  cva3d.fut:100:1-146:20\n");
        if (memblock_unref_device(ctx, &out_mem_27873, "out_mem_27873") != 0)
            return 1;
        return 1;
    }
    
    int64_t segred_group_sizze_24268;
    
    segred_group_sizze_24268 = ctx->sizes.mainzisegred_group_sizze_24267;
    
    int64_t num_groups_24270;
    int32_t max_num_groups_27875;
    
    max_num_groups_27875 = ctx->sizes.mainzisegred_num_groups_24269;
    num_groups_24270 = sext_i64_i32(smax64(1, smin64(sdiv_up64(n_23343,
                                                               sext_i32_i64(segred_group_sizze_24268)),
                                                     sext_i32_i64(max_num_groups_27875))));
    
    struct memblock_device mem_27638;
    
    mem_27638.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27638, 4, "mem_27638")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mainzicounter_mem_27876 =
                           ctx->mainzicounter_mem_27876;
    struct memblock_device group_res_arr_mem_27878;
    
    group_res_arr_mem_27878.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_27878,
                              (int32_t) sizeof(float) *
                              (segred_group_sizze_24268 * num_groups_24270),
                              "group_res_arr_mem_27878")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_27880;
    
    num_threads_27880 = num_groups_24270 * segred_group_sizze_24268;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24275, 1,
                                            (int32_t) sizeof(float) *
                                            segred_group_sizze_24268, NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24275, 2,
                                            (int32_t) sizeof(bool), NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24275, 3,
                                            sizeof(n_23343), &n_23343));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24275, 4,
                                            sizeof(num_groups_24270),
                                            &num_groups_24270));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24275, 5,
                                            sizeof(swap_term_mem_27633.mem),
                                            &swap_term_mem_27633.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24275, 6,
                                            sizeof(payments_mem_27634.mem),
                                            &payments_mem_27634.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24275, 7,
                                            sizeof(mem_27638.mem),
                                            &mem_27638.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24275, 8,
                                            sizeof(mainzicounter_mem_27876.mem),
                                            &mainzicounter_mem_27876.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24275, 9,
                                            sizeof(group_res_arr_mem_27878.mem),
                                            &group_res_arr_mem_27878.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24275, 10,
                                            sizeof(num_threads_27880),
                                            &num_threads_27880));
    if (1 * ((size_t) num_groups_24270 * (size_t) segred_group_sizze_24268) !=
        0) {
        const size_t global_work_sizze_28667[1] = {(size_t) num_groups_24270 *
                     (size_t) segred_group_sizze_24268};
        const size_t local_work_sizze_28671[1] = {segred_group_sizze_24268};
        int64_t time_start_28668 = 0, time_end_28669 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segred_nonseg_24275");
            fprintf(stderr, "%zu", global_work_sizze_28667[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_28671[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) (0 + (int32_t) sizeof(float) *
                           segred_group_sizze_24268 + (int32_t) sizeof(bool)));
            time_start_28668 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegred_nonseg_24275,
                                                        1, NULL,
                                                        global_work_sizze_28667,
                                                        local_work_sizze_28671,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegred_nonseg_24275_runs,
                                                                                                  &ctx->mainzisegred_nonseg_24275_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_28669 = get_wall_time();
            
            long time_diff_28670 = time_end_28669 - time_start_28668;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "main.segred_nonseg_24275", time_diff_28670);
        }
    }
    
    float read_res_28672;
    
    OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                 mem_27638.mem,
                                                 ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                 0 * sizeof(float),
                                                 sizeof(float), &read_res_28672,
                                                 0, NULL,
                                                 ctx->profiling_paused ||
                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                           &ctx->copy_scalar_from_dev_runs,
                                                                                           &ctx->copy_scalar_from_dev_total_runtime)));
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
        return 1;
    
    float res_23360 = read_res_28672;
    
    if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
        return 1;
    
    float res_23368 = sitofp_i64_f32(steps_23347);
    float dt_23369 = res_23360 / res_23368;
    float x_23371 = fpow32(a_23351, 2.0F);
    float x_23372 = b_23352 * x_23371;
    float x_23373 = fpow32(sigma_23353, 2.0F);
    float y_23374 = x_23373 / 2.0F;
    float y_23375 = x_23372 - y_23374;
    float y_23376 = 4.0F * a_23351;
    bool suff_outer_par_24277;
    
    suff_outer_par_24277 = ctx->sizes.mainzisuff_outer_par_0 <= n_23343;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_outer_par_0",
                n_23343);
    
    int64_t segmap_group_sizze_24345;
    
    segmap_group_sizze_24345 = ctx->sizes.mainzisegmap_group_sizze_24281;
    
    int64_t segmap_group_sizze_24494;
    
    segmap_group_sizze_24494 = ctx->sizes.mainzisegmap_group_sizze_24430;
    
    int64_t bytes_27639 = 4 * n_23343;
    int64_t bytes_27641 = 8 * n_23343;
    struct memblock_device res_mem_27657;
    
    res_mem_27657.references = NULL;
    
    struct memblock_device res_mem_27658;
    
    res_mem_27658.references = NULL;
    
    struct memblock_device res_mem_27659;
    
    res_mem_27659.references = NULL;
    
    struct memblock_device res_mem_27660;
    
    res_mem_27660.references = NULL;
    
    int32_t local_memory_capacity_27918;
    
    local_memory_capacity_27918 = ctx->opencl.max_local_memory;
    if (sle64(0, sext_i32_i64(local_memory_capacity_27918)) &&
        suff_outer_par_24277) {
        int64_t segmap_usable_groups_24346 = sdiv_up64(n_23343,
                                                       segmap_group_sizze_24345);
        struct memblock_device mem_27640;
        
        mem_27640.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27640, bytes_27639, "mem_27640")) {
            err = 1;
            goto cleanup;
        }
        if (n_23343 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         swap_term_mem_27633.mem,
                                                         mem_27640.mem, 0, 0,
                                                         n_23343 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27642;
        
        mem_27642.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27642, bytes_27641, "mem_27642")) {
            err = 1;
            goto cleanup;
        }
        if (n_23343 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         payments_mem_27634.mem,
                                                         mem_27642.mem, 0, 0,
                                                         n_23343 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27644;
        
        mem_27644.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27644, bytes_27639, "mem_27644")) {
            err = 1;
            goto cleanup;
        }
        if (n_23343 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         notional_mem_27635.mem,
                                                         mem_27644.mem, 0, 0,
                                                         n_23343 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27647;
        
        mem_27647.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27647, bytes_27639, "mem_27647")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24279, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24279, 3,
                                                sizeof(n_23343), &n_23343));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24279, 4,
                                                sizeof(a_23351), &a_23351));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24279, 5,
                                                sizeof(r0_23354), &r0_23354));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24279, 6,
                                                sizeof(x_23371), &x_23371));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24279, 7,
                                                sizeof(x_23373), &x_23373));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24279, 8,
                                                sizeof(y_23375), &y_23375));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24279, 9,
                                                sizeof(y_23376), &y_23376));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24279, 10,
                                                sizeof(swap_term_mem_27633.mem),
                                                &swap_term_mem_27633.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24279, 11,
                                                sizeof(payments_mem_27634.mem),
                                                &payments_mem_27634.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24279, 12,
                                                sizeof(mem_27647.mem),
                                                &mem_27647.mem));
        if (1 * ((size_t) segmap_usable_groups_24346 *
                 (size_t) segmap_group_sizze_24345) != 0) {
            const size_t global_work_sizze_28673[1] =
                         {(size_t) segmap_usable_groups_24346 *
                         (size_t) segmap_group_sizze_24345};
            const size_t local_work_sizze_28677[1] = {segmap_group_sizze_24345};
            int64_t time_start_28674 = 0, time_end_28675 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_24279");
                fprintf(stderr, "%zu", global_work_sizze_28673[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28677[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28674 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_24279,
                                                            1, NULL,
                                                            global_work_sizze_28673,
                                                            local_work_sizze_28677,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_24279_runs,
                                                                                                      &ctx->mainzisegmap_24279_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28675 = get_wall_time();
                
                long time_diff_28676 = time_end_28675 - time_start_28674;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_24279", time_diff_28676);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_set_device(ctx, &res_mem_27657, &mem_27647, "mem_27647") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27658, &mem_27644, "mem_27644") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27659, &mem_27642, "mem_27642") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27660, &mem_27640, "mem_27640") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27647, "mem_27647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27644, "mem_27644") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27642, "mem_27642") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27640, "mem_27640") != 0)
            return 1;
    } else {
        int64_t segmap_usable_groups_24495 = sdiv_up64(n_23343,
                                                       segmap_group_sizze_24494);
        struct memblock_device mem_27649;
        
        mem_27649.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27649, bytes_27639, "mem_27649")) {
            err = 1;
            goto cleanup;
        }
        if (n_23343 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         swap_term_mem_27633.mem,
                                                         mem_27649.mem, 0, 0,
                                                         n_23343 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27651;
        
        mem_27651.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27651, bytes_27641, "mem_27651")) {
            err = 1;
            goto cleanup;
        }
        if (n_23343 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         payments_mem_27634.mem,
                                                         mem_27651.mem, 0, 0,
                                                         n_23343 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27653;
        
        mem_27653.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27653, bytes_27639, "mem_27653")) {
            err = 1;
            goto cleanup;
        }
        if (n_23343 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         notional_mem_27635.mem,
                                                         mem_27653.mem, 0, 0,
                                                         n_23343 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27656;
        
        mem_27656.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27656, bytes_27639, "mem_27656")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24428, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24428, 3,
                                                sizeof(n_23343), &n_23343));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24428, 4,
                                                sizeof(a_23351), &a_23351));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24428, 5,
                                                sizeof(r0_23354), &r0_23354));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24428, 6,
                                                sizeof(x_23371), &x_23371));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24428, 7,
                                                sizeof(x_23373), &x_23373));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24428, 8,
                                                sizeof(y_23375), &y_23375));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24428, 9,
                                                sizeof(y_23376), &y_23376));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24428, 10,
                                                sizeof(swap_term_mem_27633.mem),
                                                &swap_term_mem_27633.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24428, 11,
                                                sizeof(payments_mem_27634.mem),
                                                &payments_mem_27634.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24428, 12,
                                                sizeof(mem_27656.mem),
                                                &mem_27656.mem));
        if (1 * ((size_t) segmap_usable_groups_24495 *
                 (size_t) segmap_group_sizze_24494) != 0) {
            const size_t global_work_sizze_28678[1] =
                         {(size_t) segmap_usable_groups_24495 *
                         (size_t) segmap_group_sizze_24494};
            const size_t local_work_sizze_28682[1] = {segmap_group_sizze_24494};
            int64_t time_start_28679 = 0, time_end_28680 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_24428");
                fprintf(stderr, "%zu", global_work_sizze_28678[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28682[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28679 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_24428,
                                                            1, NULL,
                                                            global_work_sizze_28678,
                                                            local_work_sizze_28682,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_24428_runs,
                                                                                                      &ctx->mainzisegmap_24428_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28680 = get_wall_time();
                
                long time_diff_28681 = time_end_28680 - time_start_28679;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_24428", time_diff_28681);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_set_device(ctx, &res_mem_27657, &mem_27656, "mem_27656") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27658, &mem_27653, "mem_27653") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27659, &mem_27651, "mem_27651") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27660, &mem_27649, "mem_27649") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27656, "mem_27656") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27653, "mem_27653") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27651, "mem_27651") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27649, "mem_27649") != 0)
            return 1;
    }
    
    float sims_per_year_23441 = res_23368 / res_23360;
    bool bounds_invalid_upwards_23442 = slt64(steps_23347, 1);
    bool valid_23443 = !bounds_invalid_upwards_23442;
    bool range_valid_c_23444;
    
    if (!valid_23443) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 1, "..", 2, "...", steps_23347,
                               " is invalid.",
                               "-> #0  cva3d.fut:60:56-67\n   #1  cva3d.fut:111:17-44\n   #2  cva3d.fut:100:1-146:20\n");
        if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27659, "res_mem_27659") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27658, "res_mem_27658") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27657, "res_mem_27657") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27878,
                                  "group_res_arr_mem_27878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_27873, "out_mem_27873") != 0)
            return 1;
        return 1;
    }
    
    bool bounds_invalid_upwards_23450 = slt64(paths_23346, 0);
    bool valid_23451 = !bounds_invalid_upwards_23450;
    bool range_valid_c_23452;
    
    if (!valid_23451) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", paths_23346,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:126:11-16\n   #2  lib/github.com/diku-dk/cpprandom/random.fut:174:8-56\n   #3  cva3d.fut:115:19-49\n   #4  cva3d.fut:100:1-146:20\n");
        if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27659, "res_mem_27659") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27658, "res_mem_27658") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27657, "res_mem_27657") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27878,
                                  "group_res_arr_mem_27878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_27873, "out_mem_27873") != 0)
            return 1;
        return 1;
    }
    
    int64_t upper_bound_23455 = sub64(steps_23347, 1);
    float res_23456;
    
    res_23456 = futrts_sqrt32(dt_23369);
    
    int64_t one_intra_par_min_24642 = n_23343 * steps_23347;
    int64_t intra_avail_par_24644 = smin64(steps_23347,
                                           one_intra_par_min_24642);
    int64_t computed_group_sizze_24602 = smax64(steps_23347,
                                                one_intra_par_min_24642);
    int64_t max_group_sizze_24794;
    
    max_group_sizze_24794 = ctx->opencl.max_group_size;
    
    bool fits_24795 = sle64(computed_group_sizze_24602, max_group_sizze_24794);
    bool suff_intra_par_24793;
    
    suff_intra_par_24793 = ctx->sizes.mainzisuff_intra_par_3 <=
        intra_avail_par_24644;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_intra_par_3",
                intra_avail_par_24644);
    
    bool intra_suff_and_fits_24796 = suff_intra_par_24793 && fits_24795;
    int64_t segmap_group_sizze_25182;
    
    segmap_group_sizze_25182 = ctx->sizes.mainzisegmap_group_sizze_25165;
    
    int64_t nest_sizze_25206 = paths_23346 * steps_23347;
    int64_t segmap_group_sizze_25207;
    
    segmap_group_sizze_25207 = ctx->sizes.mainzisegmap_group_sizze_25102;
    
    int64_t segmap_group_sizze_25252;
    
    segmap_group_sizze_25252 = ctx->sizes.mainzisegmap_group_sizze_25003;
    
    int64_t num_groups_25253;
    int32_t max_num_groups_27919;
    
    max_num_groups_27919 = ctx->sizes.mainzisegmap_num_groups_25005;
    num_groups_25253 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_23346,
                                                               sext_i32_i64(segmap_group_sizze_25252)),
                                                     sext_i32_i64(max_num_groups_27919))));
    
    int64_t nest_sizze_25297 = paths_23346 * one_intra_par_min_24642;
    int64_t segmap_group_sizze_25298;
    
    segmap_group_sizze_25298 = ctx->sizes.mainzisegmap_group_sizze_24948;
    
    int64_t segmap_group_sizze_25316;
    
    segmap_group_sizze_25316 = ctx->sizes.mainzisegmap_group_sizze_24910;
    
    int64_t binop_x_27689 = n_23343 * nest_sizze_25206;
    int64_t bytes_27687 = 4 * binop_x_27689;
    int64_t bytes_27663 = 4 * steps_23347;
    int64_t bytes_27680 = 4 * one_intra_par_min_24642;
    int64_t bytes_27696 = 4 * paths_23346;
    int64_t bytes_27699 = 4 * nest_sizze_25206;
    int64_t num_threads_27830 = segmap_group_sizze_25252 * num_groups_25253;
    int64_t total_sizze_27831 = bytes_27663 * num_threads_27830;
    struct memblock_device res_mem_27733;
    
    res_mem_27733.references = NULL;
    
    struct memblock_device res_mem_27734;
    
    res_mem_27734.references = NULL;
    
    int32_t local_memory_capacity_27963;
    
    local_memory_capacity_27963 = ctx->opencl.max_local_memory;
    if (sle64(bytes_27663 + bytes_27663 + bytes_27680 + bytes_27680,
              sext_i32_i64(local_memory_capacity_27963)) &&
        intra_suff_and_fits_24796) {
        struct memblock_device mem_27690;
        
        mem_27690.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27690, bytes_27687, "mem_27690")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27694;
        
        mem_27694.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27694, bytes_27687, "mem_27694")) {
            err = 1;
            goto cleanup;
        }
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                3, bytes_27680, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                4, bytes_27680, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                5, bytes_27663, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                6, bytes_27663, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                7, sizeof(n_23343), &n_23343));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                8, sizeof(steps_23347),
                                                &steps_23347));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                9, sizeof(a_23351), &a_23351));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                10, sizeof(b_23352), &b_23352));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                11, sizeof(sigma_23353),
                                                &sigma_23353));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                12, sizeof(r0_23354),
                                                &r0_23354));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                13, sizeof(dt_23369),
                                                &dt_23369));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                14, sizeof(sims_per_year_23441),
                                                &sims_per_year_23441));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                15, sizeof(upper_bound_23455),
                                                &upper_bound_23455));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                16, sizeof(res_23456),
                                                &res_23456));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                17,
                                                sizeof(computed_group_sizze_24602),
                                                &computed_group_sizze_24602));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                18, sizeof(mem_27690.mem),
                                                &mem_27690.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24645,
                                                19, sizeof(mem_27694.mem),
                                                &mem_27694.mem));
        if (1 * ((size_t) paths_23346 * (size_t) computed_group_sizze_24602) !=
            0) {
            const size_t global_work_sizze_28683[1] = {(size_t) paths_23346 *
                         (size_t) computed_group_sizze_24602};
            const size_t local_work_sizze_28687[1] =
                         {computed_group_sizze_24602};
            int64_t time_start_28684 = 0, time_end_28685 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_intragroup_24645");
                fprintf(stderr, "%zu", global_work_sizze_28683[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28687[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + bytes_27680 + bytes_27680 + bytes_27663 +
                               bytes_27663));
                time_start_28684 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_intragroup_24645,
                                                            1, NULL,
                                                            global_work_sizze_28683,
                                                            local_work_sizze_28687,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_intragroup_24645_runs,
                                                                                                      &ctx->mainzisegmap_intragroup_24645_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28685 = get_wall_time();
                
                long time_diff_28686 = time_end_28685 - time_start_28684;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_intragroup_24645", time_diff_28686);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_set_device(ctx, &res_mem_27733, &mem_27690, "mem_27690") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27734, &mem_27694, "mem_27694") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27694, "mem_27694") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27690, "mem_27690") != 0)
            return 1;
    } else {
        int64_t segmap_usable_groups_25183 = sdiv_up64(paths_23346,
                                                       segmap_group_sizze_25182);
        struct memblock_device mem_27697;
        
        mem_27697.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27697, bytes_27696, "mem_27697")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25163, 1,
                                                sizeof(paths_23346),
                                                &paths_23346));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25163, 2,
                                                sizeof(mem_27697.mem),
                                                &mem_27697.mem));
        if (1 * ((size_t) segmap_usable_groups_25183 *
                 (size_t) segmap_group_sizze_25182) != 0) {
            const size_t global_work_sizze_28688[1] =
                         {(size_t) segmap_usable_groups_25183 *
                         (size_t) segmap_group_sizze_25182};
            const size_t local_work_sizze_28692[1] = {segmap_group_sizze_25182};
            int64_t time_start_28689 = 0, time_end_28690 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_25163");
                fprintf(stderr, "%zu", global_work_sizze_28688[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28692[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28689 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_25163,
                                                            1, NULL,
                                                            global_work_sizze_28688,
                                                            local_work_sizze_28692,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_25163_runs,
                                                                                                      &ctx->mainzisegmap_25163_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28690 = get_wall_time();
                
                long time_diff_28691 = time_end_28690 - time_start_28689;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_25163", time_diff_28691);
            }
        }
        
        int64_t segmap_usable_groups_25208 = sdiv_up64(nest_sizze_25206,
                                                       segmap_group_sizze_25207);
        struct memblock_device mem_27701;
        
        mem_27701.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27701, bytes_27699, "mem_27701")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25099, 1,
                                                sizeof(paths_23346),
                                                &paths_23346));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25099, 2,
                                                sizeof(steps_23347),
                                                &steps_23347));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25099, 3,
                                                sizeof(mem_27697.mem),
                                                &mem_27697.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25099, 4,
                                                sizeof(mem_27701.mem),
                                                &mem_27701.mem));
        if (1 * ((size_t) segmap_usable_groups_25208 *
                 (size_t) segmap_group_sizze_25207) != 0) {
            const size_t global_work_sizze_28693[1] =
                         {(size_t) segmap_usable_groups_25208 *
                         (size_t) segmap_group_sizze_25207};
            const size_t local_work_sizze_28697[1] = {segmap_group_sizze_25207};
            int64_t time_start_28694 = 0, time_end_28695 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_25099");
                fprintf(stderr, "%zu", global_work_sizze_28693[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28697[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28694 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_25099,
                                                            1, NULL,
                                                            global_work_sizze_28693,
                                                            local_work_sizze_28697,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_25099_runs,
                                                                                                      &ctx->mainzisegmap_25099_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28695 = get_wall_time();
                
                long time_diff_28696 = time_end_28695 - time_start_28694;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_25099", time_diff_28696);
            }
        }
        if (memblock_unref_device(ctx, &mem_27697, "mem_27697") != 0)
            return 1;
        
        struct memblock_device mem_27704;
        
        mem_27704.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27704, bytes_27699, "mem_27704")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27704, 0, mem_27701,
                                                  0, 1, steps_23347,
                                                  paths_23346) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_unref_device(ctx, &mem_27701, "mem_27701") != 0)
            return 1;
        
        struct memblock_device mem_27722;
        
        mem_27722.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27722, bytes_27699, "mem_27722")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27707;
        
        mem_27707.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27707, total_sizze_27831,
                                  "mem_27707")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25001, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25001, 3,
                                                sizeof(paths_23346),
                                                &paths_23346));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25001, 4,
                                                sizeof(steps_23347),
                                                &steps_23347));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25001, 5,
                                                sizeof(a_23351), &a_23351));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25001, 6,
                                                sizeof(b_23352), &b_23352));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25001, 7,
                                                sizeof(sigma_23353),
                                                &sigma_23353));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25001, 8,
                                                sizeof(r0_23354), &r0_23354));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25001, 9,
                                                sizeof(dt_23369), &dt_23369));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25001, 10,
                                                sizeof(upper_bound_23455),
                                                &upper_bound_23455));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25001, 11,
                                                sizeof(res_23456), &res_23456));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25001, 12,
                                                sizeof(num_groups_25253),
                                                &num_groups_25253));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25001, 13,
                                                sizeof(mem_27704.mem),
                                                &mem_27704.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25001, 14,
                                                sizeof(mem_27707.mem),
                                                &mem_27707.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25001, 15,
                                                sizeof(mem_27722.mem),
                                                &mem_27722.mem));
        if (1 * ((size_t) num_groups_25253 *
                 (size_t) segmap_group_sizze_25252) != 0) {
            const size_t global_work_sizze_28698[1] =
                         {(size_t) num_groups_25253 *
                         (size_t) segmap_group_sizze_25252};
            const size_t local_work_sizze_28702[1] = {segmap_group_sizze_25252};
            int64_t time_start_28699 = 0, time_end_28700 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_25001");
                fprintf(stderr, "%zu", global_work_sizze_28698[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28702[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28699 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_25001,
                                                            1, NULL,
                                                            global_work_sizze_28698,
                                                            local_work_sizze_28702,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_25001_runs,
                                                                                                      &ctx->mainzisegmap_25001_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28700 = get_wall_time();
                
                long time_diff_28701 = time_end_28700 - time_start_28699;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_25001", time_diff_28701);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_27704, "mem_27704") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27707, "mem_27707") != 0)
            return 1;
        
        int64_t segmap_usable_groups_25299 = sdiv_up64(nest_sizze_25297,
                                                       segmap_group_sizze_25298);
        struct memblock_device mem_27727;
        
        mem_27727.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27727, bytes_27687, "mem_27727")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24944, 1,
                                                sizeof(n_23343), &n_23343));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24944, 2,
                                                sizeof(paths_23346),
                                                &paths_23346));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24944, 3,
                                                sizeof(steps_23347),
                                                &steps_23347));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24944, 4,
                                                sizeof(mem_27722.mem),
                                                &mem_27722.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24944, 5,
                                                sizeof(mem_27727.mem),
                                                &mem_27727.mem));
        if (1 * ((size_t) segmap_usable_groups_25299 *
                 (size_t) segmap_group_sizze_25298) != 0) {
            const size_t global_work_sizze_28703[1] =
                         {(size_t) segmap_usable_groups_25299 *
                         (size_t) segmap_group_sizze_25298};
            const size_t local_work_sizze_28707[1] = {segmap_group_sizze_25298};
            int64_t time_start_28704 = 0, time_end_28705 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_24944");
                fprintf(stderr, "%zu", global_work_sizze_28703[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28707[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28704 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_24944,
                                                            1, NULL,
                                                            global_work_sizze_28703,
                                                            local_work_sizze_28707,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_24944_runs,
                                                                                                      &ctx->mainzisegmap_24944_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28705 = get_wall_time();
                
                long time_diff_28706 = time_end_28705 - time_start_28704;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_24944", time_diff_28706);
            }
        }
        if (memblock_unref_device(ctx, &mem_27722, "mem_27722") != 0)
            return 1;
        
        int64_t segmap_usable_groups_25317 = sdiv_up64(nest_sizze_25297,
                                                       segmap_group_sizze_25316);
        struct memblock_device mem_27732;
        
        mem_27732.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27732, bytes_27687, "mem_27732")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24906, 1,
                                                sizeof(n_23343), &n_23343));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24906, 2,
                                                sizeof(paths_23346),
                                                &paths_23346));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24906, 3,
                                                sizeof(steps_23347),
                                                &steps_23347));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24906, 4,
                                                sizeof(sims_per_year_23441),
                                                &sims_per_year_23441));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24906, 5,
                                                sizeof(mem_27732.mem),
                                                &mem_27732.mem));
        if (1 * ((size_t) segmap_usable_groups_25317 *
                 (size_t) segmap_group_sizze_25316) != 0) {
            const size_t global_work_sizze_28708[1] =
                         {(size_t) segmap_usable_groups_25317 *
                         (size_t) segmap_group_sizze_25316};
            const size_t local_work_sizze_28712[1] = {segmap_group_sizze_25316};
            int64_t time_start_28709 = 0, time_end_28710 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_24906");
                fprintf(stderr, "%zu", global_work_sizze_28708[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28712[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28709 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_24906,
                                                            1, NULL,
                                                            global_work_sizze_28708,
                                                            local_work_sizze_28712,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_24906_runs,
                                                                                                      &ctx->mainzisegmap_24906_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28710 = get_wall_time();
                
                long time_diff_28711 = time_end_28710 - time_start_28709;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_24906", time_diff_28711);
            }
        }
        if (memblock_set_device(ctx, &res_mem_27733, &mem_27727, "mem_27727") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27734, &mem_27732, "mem_27732") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27732, "mem_27732") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27727, "mem_27727") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27707, "mem_27707") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27722, "mem_27722") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27704, "mem_27704") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27701, "mem_27701") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27697, "mem_27697") != 0)
            return 1;
    }
    
    int64_t segscan_group_sizze_25328;
    
    segscan_group_sizze_25328 = ctx->sizes.mainzisegscan_group_sizze_25327;
    
    int64_t num_groups_25330;
    int32_t max_num_groups_27964;
    
    max_num_groups_27964 = ctx->sizes.mainzisegscan_num_groups_25329;
    num_groups_25330 = sext_i64_i32(smax64(1, smin64(sdiv_up64(binop_x_27689,
                                                               sext_i32_i64(segscan_group_sizze_25328)),
                                                     sext_i32_i64(max_num_groups_27964))));
    
    int64_t bytes_27736 = 8 * binop_x_27689;
    struct memblock_device mem_27737;
    
    mem_27737.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27737, bytes_27736, "mem_27737")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27739;
    
    mem_27739.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27739, bytes_27736, "mem_27739")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, binop_x_27689)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_27965;
        
        stage1_max_num_groups_27965 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_27966;
        
        stage1_num_groups_27966 = smin64(stage1_max_num_groups_27965,
                                         num_groups_25330);
        
        int32_t num_threads_27967;
        
        num_threads_27967 = sext_i64_i32(stage1_num_groups_27966 *
            segscan_group_sizze_25328);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25333, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_25328),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25333, 2,
                                                sizeof(n_23343), &n_23343));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25333, 3,
                                                sizeof(steps_23347),
                                                &steps_23347));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25333, 4,
                                                sizeof(one_intra_par_min_24642),
                                                &one_intra_par_min_24642));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25333, 5,
                                                sizeof(res_mem_27659.mem),
                                                &res_mem_27659.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25333, 6,
                                                sizeof(res_mem_27660.mem),
                                                &res_mem_27660.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25333, 7,
                                                sizeof(binop_x_27689),
                                                &binop_x_27689));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25333, 8,
                                                sizeof(res_mem_27734.mem),
                                                &res_mem_27734.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25333, 9,
                                                sizeof(mem_27737.mem),
                                                &mem_27737.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25333,
                                                10, sizeof(mem_27739.mem),
                                                &mem_27739.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25333,
                                                11, sizeof(num_threads_27967),
                                                &num_threads_27967));
        if (1 * ((size_t) stage1_num_groups_27966 *
                 (size_t) segscan_group_sizze_25328) != 0) {
            const size_t global_work_sizze_28713[1] =
                         {(size_t) stage1_num_groups_27966 *
                         (size_t) segscan_group_sizze_25328};
            const size_t local_work_sizze_28717[1] =
                         {segscan_group_sizze_25328};
            int64_t time_start_28714 = 0, time_end_28715 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage1_25333");
                fprintf(stderr, "%zu", global_work_sizze_28713[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28717[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_25328)));
                time_start_28714 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage1_25333,
                                                            1, NULL,
                                                            global_work_sizze_28713,
                                                            local_work_sizze_28717,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage1_25333_runs,
                                                                                                      &ctx->mainziscan_stage1_25333_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28715 = get_wall_time();
                
                long time_diff_28716 = time_end_28715 - time_start_28714;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage1_25333", time_diff_28716);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_25328 *
                                 sdiv_up64(binop_x_27689,
                                           sext_i32_i64(num_threads_27967))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25333, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_27966),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25333, 2,
                                                sizeof(binop_x_27689),
                                                &binop_x_27689));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25333, 3,
                                                sizeof(mem_27737.mem),
                                                &mem_27737.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25333, 4,
                                                sizeof(stage1_num_groups_27966),
                                                &stage1_num_groups_27966));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25333, 5,
                                                sizeof(num_threads_27967),
                                                &num_threads_27967));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_27966) != 0) {
            const size_t global_work_sizze_28718[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_27966};
            const size_t local_work_sizze_28722[1] = {stage1_num_groups_27966};
            int64_t time_start_28719 = 0, time_end_28720 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage2_25333");
                fprintf(stderr, "%zu", global_work_sizze_28718[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28722[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_27966)));
                time_start_28719 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage2_25333,
                                                            1, NULL,
                                                            global_work_sizze_28718,
                                                            local_work_sizze_28722,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage2_25333_runs,
                                                                                                      &ctx->mainziscan_stage2_25333_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28720 = get_wall_time();
                
                long time_diff_28721 = time_end_28720 - time_start_28719;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage2_25333", time_diff_28721);
            }
        }
        
        int32_t required_groups_28003;
        
        required_groups_28003 = sext_i64_i32(sdiv_up64(binop_x_27689,
                                                       segscan_group_sizze_25328));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25333, 1,
                                                sizeof(num_groups_25330),
                                                &num_groups_25330));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25333, 2,
                                                sizeof(binop_x_27689),
                                                &binop_x_27689));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25333, 3,
                                                sizeof(mem_27737.mem),
                                                &mem_27737.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25333, 4,
                                                sizeof(num_threads_27967),
                                                &num_threads_27967));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25333, 5,
                                                sizeof(required_groups_28003),
                                                &required_groups_28003));
        if (1 * ((size_t) num_groups_25330 *
                 (size_t) segscan_group_sizze_25328) != 0) {
            const size_t global_work_sizze_28723[1] =
                         {(size_t) num_groups_25330 *
                         (size_t) segscan_group_sizze_25328};
            const size_t local_work_sizze_28727[1] =
                         {segscan_group_sizze_25328};
            int64_t time_start_28724 = 0, time_end_28725 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage3_25333");
                fprintf(stderr, "%zu", global_work_sizze_28723[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28727[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28724 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage3_25333,
                                                            1, NULL,
                                                            global_work_sizze_28723,
                                                            local_work_sizze_28727,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage3_25333_runs,
                                                                                                      &ctx->mainziscan_stage3_25333_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28725 = get_wall_time();
                
                long time_diff_28726 = time_end_28725 - time_start_28724;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage3_25333", time_diff_28726);
            }
        }
    }
    
    int64_t segred_group_sizze_25336;
    
    segred_group_sizze_25336 = ctx->sizes.mainzisegred_group_sizze_25335;
    
    int64_t num_groups_25338;
    int32_t max_num_groups_28015;
    
    max_num_groups_28015 = ctx->sizes.mainzisegred_num_groups_25337;
    num_groups_25338 = sext_i64_i32(smax64(1, smin64(sdiv_up64(binop_x_27689,
                                                               sext_i32_i64(segred_group_sizze_25336)),
                                                     sext_i32_i64(max_num_groups_28015))));
    
    struct memblock_device mem_27742;
    
    mem_27742.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27742, 8, "mem_27742")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mainzicounter_mem_28016 =
                           ctx->mainzicounter_mem_28016;
    struct memblock_device group_res_arr_mem_28018;
    
    group_res_arr_mem_28018.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_28018,
                              (int32_t) sizeof(int64_t) *
                              (segred_group_sizze_25336 * num_groups_25338),
                              "group_res_arr_mem_28018")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_28020;
    
    num_threads_28020 = num_groups_25338 * segred_group_sizze_25336;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25343, 1,
                                            (int32_t) sizeof(int64_t) *
                                            segred_group_sizze_25336, NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25343, 2,
                                            (int32_t) sizeof(bool), NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25343, 3,
                                            sizeof(num_groups_25338),
                                            &num_groups_25338));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25343, 4,
                                            sizeof(binop_x_27689),
                                            &binop_x_27689));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25343, 5,
                                            sizeof(mem_27739.mem),
                                            &mem_27739.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25343, 6,
                                            sizeof(mem_27742.mem),
                                            &mem_27742.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25343, 7,
                                            sizeof(mainzicounter_mem_28016.mem),
                                            &mainzicounter_mem_28016.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25343, 8,
                                            sizeof(group_res_arr_mem_28018.mem),
                                            &group_res_arr_mem_28018.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25343, 9,
                                            sizeof(num_threads_28020),
                                            &num_threads_28020));
    if (1 * ((size_t) num_groups_25338 * (size_t) segred_group_sizze_25336) !=
        0) {
        const size_t global_work_sizze_28729[1] = {(size_t) num_groups_25338 *
                     (size_t) segred_group_sizze_25336};
        const size_t local_work_sizze_28733[1] = {segred_group_sizze_25336};
        int64_t time_start_28730 = 0, time_end_28731 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segred_nonseg_25343");
            fprintf(stderr, "%zu", global_work_sizze_28729[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_28733[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) (0 + (int32_t) sizeof(int64_t) *
                           segred_group_sizze_25336 + (int32_t) sizeof(bool)));
            time_start_28730 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegred_nonseg_25343,
                                                        1, NULL,
                                                        global_work_sizze_28729,
                                                        local_work_sizze_28733,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegred_nonseg_25343_runs,
                                                                                                  &ctx->mainzisegred_nonseg_25343_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_28731 = get_wall_time();
            
            long time_diff_28732 = time_end_28731 - time_start_28730;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "main.segred_nonseg_25343", time_diff_28732);
        }
    }
    if (memblock_unref_device(ctx, &mem_27739, "mem_27739") != 0)
        return 1;
    
    int64_t read_res_28734;
    
    OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                 mem_27742.mem,
                                                 ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                 0 * sizeof(int64_t),
                                                 sizeof(int64_t),
                                                 &read_res_28734, 0, NULL,
                                                 ctx->profiling_paused ||
                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                           &ctx->copy_scalar_from_dev_runs,
                                                                                           &ctx->copy_scalar_from_dev_total_runtime)));
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t res_23550 = read_res_28734;
    
    if (memblock_unref_device(ctx, &mem_27742, "mem_27742") != 0)
        return 1;
    
    bool bounds_invalid_upwards_23555 = slt64(res_23550, 0);
    bool valid_23556 = !bounds_invalid_upwards_23555;
    bool range_valid_c_23557;
    
    if (!valid_23556) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", res_23550,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:48:30-60\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:87:14-32\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva3d.fut:134:18-77\n   #6  cva3d.fut:100:1-146:20\n");
        if (memblock_unref_device(ctx, &group_res_arr_mem_28018,
                                  "group_res_arr_mem_28018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27742, "mem_27742") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27739, "mem_27739") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27737, "mem_27737") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27734, "res_mem_27734") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27733, "res_mem_27733") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27659, "res_mem_27659") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27658, "res_mem_27658") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27657, "res_mem_27657") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27878,
                                  "group_res_arr_mem_27878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_27873, "out_mem_27873") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_27743 = 8 * res_23550;
    struct memblock_device mem_27744;
    
    mem_27744.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27744, bytes_27743, "mem_27744")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_27744, res_23550, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t seghist_group_sizze_25346;
    
    seghist_group_sizze_25346 = ctx->sizes.mainziseghist_group_sizze_25345;
    
    int64_t num_groups_25348;
    int32_t max_num_groups_28055;
    
    max_num_groups_28055 = ctx->sizes.mainziseghist_num_groups_25347;
    num_groups_25348 = sext_i64_i32(smax64(1, smin64(sdiv_up64(binop_x_27689,
                                                               sext_i32_i64(seghist_group_sizze_25346)),
                                                     sext_i32_i64(max_num_groups_28055))));
    
    int32_t num_subhistos_28056;
    struct memblock_device res_subhistos_mem_28057;
    
    res_subhistos_mem_28057.references = NULL;
    
    int64_t h_28059;
    
    h_28059 = (int32_t) sizeof(int64_t) * res_23550;
    
    int64_t seg_h_28060;
    
    seg_h_28060 = (int32_t) sizeof(int64_t) * res_23550;
    if (!(seg_h_28060 == 0)) {
        int64_t hist_H_28061 = res_23550;
        int64_t hist_el_sizze_28062 = sdiv_up64(h_28059, hist_H_28061) + 4;
        int64_t hist_N_28063 = binop_x_27689;
        int64_t hist_RF_28064 = 1;
        
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegHist");
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Number of threads (T)",
                    (long long) sext_i64_i32(num_groups_25348 *
                    seghist_group_sizze_25346), '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Desired group size (B)",
                    (long long) seghist_group_sizze_25346, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                    (long long) hist_H_28061, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Input elements per histogram (N)",
                    (long long) hist_N_28063, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Number of segments", (long long) 1,
                    '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Histogram element size (el_size)",
                    (long long) hist_el_sizze_28062, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Race factor (RF)",
                    (long long) hist_RF_28064, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c",
                    "Memory per set of subhistograms per segment",
                    (long long) h_28059, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c",
                    "Memory per set of subhistograms times segments",
                    (long long) seg_h_28060, '\n');
        
        int32_t hist_L_28065;
        
        hist_L_28065 = ctx->opencl.max_local_memory;
        
        int32_t max_group_sizze_28066;
        
        max_group_sizze_28066 = ctx->opencl.max_group_size;
        
        int64_t num_groups_28067;
        
        num_groups_28067 =
            sdiv_up64(sext_i32_i64(sext_i64_i32(num_groups_25348 *
                      seghist_group_sizze_25346)), max_group_sizze_28066);
        
        double hist_m_prime_28068;
        
        hist_m_prime_28068 =
            sitofp_i64_f64(smin64(sext_i32_i64(squot32(hist_L_28065,
                                                       hist_el_sizze_28062)),
                                  sdiv_up64(hist_N_28063, num_groups_28067))) /
            sitofp_i64_f64(hist_H_28061);
        
        int64_t hist_M0_28069;
        
        hist_M0_28069 = smax64(1, smin64(fptosi_f64_i64(hist_m_prime_28068),
                                         max_group_sizze_28066));
        
        int64_t hist_Nout_28070;
        
        hist_Nout_28070 = 1;
        
        int64_t hist_Nin_28071;
        
        hist_Nin_28071 = binop_x_27689;
        
        int64_t work_asymp_M_max_28072;
        
        work_asymp_M_max_28072 = squot64(hist_Nout_28070 * hist_N_28063, 2 *
                                         num_groups_28067 * hist_H_28061);
        
        int32_t hist_M_28073;
        
        hist_M_28073 = sext_i64_i32(smin64(hist_M0_28069,
                                           work_asymp_M_max_28072));
        
        int64_t hist_C_28074;
        
        hist_C_28074 = sdiv_up64(max_group_sizze_28066, sext_i32_i64(smax32(1,
                                                                            hist_M_28073)));
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local hist_M0",
                    (long long) hist_M0_28069, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local work asymp M max",
                    (long long) work_asymp_M_max_28072, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local C", (long long) hist_C_28074,
                    '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local B",
                    (long long) max_group_sizze_28066, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local M", (long long) hist_M_28073,
                    '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local memory needed",
                    (long long) (hist_H_28061 * hist_el_sizze_28062 *
                                 sext_i32_i64(hist_M_28073)), '\n');
        
        int64_t local_mem_needed_28075;
        
        local_mem_needed_28075 = hist_el_sizze_28062 *
            sext_i32_i64(hist_M_28073);
        
        int32_t hist_S_28076;
        
        hist_S_28076 = sext_i64_i32(sdiv_up64(hist_H_28061 *
                                              local_mem_needed_28075,
                                              hist_L_28065));
        if (sle64(hist_H_28061, hist_Nin_28071) &&
            (sle64(local_mem_needed_28075, hist_L_28065) && (sle32(hist_S_28076,
                                                                   6) &&
                                                             (sle64(hist_C_28074,
                                                                    max_group_sizze_28066) &&
                                                              slt32(0,
                                                                    hist_M_28073))))) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "## Using local memory");
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                        (long long) hist_H_28061, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                        (long long) hist_M_28073, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Cooperation level (C)",
                        (long long) hist_C_28074, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                        (long long) hist_S_28076, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Number of local subhistograms per group",
                        (long long) hist_M_28073, '\n');
            
            int64_t num_segments_28077;
            
            num_segments_28077 = 1;
            num_subhistos_28056 = num_groups_28067 * num_segments_28077;
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Number of subhistograms in global memory",
                        (long long) num_subhistos_28056, '\n');
            if (num_subhistos_28056 == 1) {
                if (memblock_set_device(ctx, &res_subhistos_mem_28057,
                                        &mem_27744, "mem_27744") != 0)
                    return 1;
            } else {
                if (memblock_alloc_device(ctx, &res_subhistos_mem_28057,
                                          sext_i32_i64(num_subhistos_28056) *
                                          res_23550 * (int32_t) sizeof(int64_t),
                                          "res_subhistos_mem_28057")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, res_subhistos_mem_28057,
                                                  num_subhistos_28056 *
                                                  res_23550, 0) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (res_23550 * (int32_t) sizeof(int64_t) > 0) {
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                 mem_27744.mem,
                                                                 res_subhistos_mem_28057.mem,
                                                                 0, 0,
                                                                 res_23550 *
                                                                 (int32_t) sizeof(int64_t),
                                                                 0, NULL,
                                                                 ctx->profiling_paused ||
                                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                           &ctx->copy_dev_to_dev_runs,
                                                                                                           &ctx->copy_dev_to_dev_total_runtime)));
                    if (ctx->debugging)
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                }
            }
            for (int32_t chk_i_28078 = 0; chk_i_28078 < hist_S_28076;
                 chk_i_28078++) {
                int64_t num_segments_28079 = 1;
                int64_t hist_H_chk_28080 = sdiv_up64(res_23550,
                                                     sext_i32_i64(hist_S_28076));
                int64_t histo_sizze_28081 = hist_H_chk_28080;
                int32_t init_per_thread_28082 =
                        sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_28073) *
                                               histo_sizze_28081,
                                               max_group_sizze_28066));
                
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25351,
                                                        1,
                                                        (int32_t) sizeof(int32_t) *
                                                        (hist_M_28073 *
                                                         hist_H_chk_28080),
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25351,
                                                        2,
                                                        (int32_t) sizeof(int64_t) *
                                                        (hist_M_28073 *
                                                         hist_H_chk_28080),
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25351,
                                                        3, sizeof(res_23550),
                                                        &res_23550));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25351,
                                                        4,
                                                        sizeof(binop_x_27689),
                                                        &binop_x_27689));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25351,
                                                        5,
                                                        sizeof(mem_27737.mem),
                                                        &mem_27737.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25351,
                                                        6,
                                                        sizeof(res_subhistos_mem_28057.mem),
                                                        &res_subhistos_mem_28057.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25351,
                                                        7,
                                                        sizeof(max_group_sizze_28066),
                                                        &max_group_sizze_28066));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25351,
                                                        8,
                                                        sizeof(num_groups_28067),
                                                        &num_groups_28067));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25351,
                                                        9, sizeof(hist_M_28073),
                                                        &hist_M_28073));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25351,
                                                        10, sizeof(chk_i_28078),
                                                        &chk_i_28078));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25351,
                                                        11,
                                                        sizeof(num_segments_28079),
                                                        &num_segments_28079));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25351,
                                                        12,
                                                        sizeof(hist_H_chk_28080),
                                                        &hist_H_chk_28080));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25351,
                                                        13,
                                                        sizeof(histo_sizze_28081),
                                                        &histo_sizze_28081));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25351,
                                                        14,
                                                        sizeof(init_per_thread_28082),
                                                        &init_per_thread_28082));
                if (1 * ((size_t) num_groups_28067 *
                         (size_t) max_group_sizze_28066) != 0) {
                    const size_t global_work_sizze_28735[1] =
                                 {(size_t) num_groups_28067 *
                                 (size_t) max_group_sizze_28066};
                    const size_t local_work_sizze_28739[1] =
                                 {max_group_sizze_28066};
                    int64_t time_start_28736 = 0, time_end_28737 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.seghist_local_25351");
                        fprintf(stderr, "%zu", global_work_sizze_28735[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_28739[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(int32_t) *
                                       (hist_M_28073 * hist_H_chk_28080) +
                                       (int32_t) sizeof(int64_t) *
                                       (hist_M_28073 * hist_H_chk_28080)));
                        time_start_28736 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainziseghist_local_25351,
                                                                    1, NULL,
                                                                    global_work_sizze_28735,
                                                                    local_work_sizze_28739,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainziseghist_local_25351_runs,
                                                                                                              &ctx->mainziseghist_local_25351_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_28737 = get_wall_time();
                        
                        long time_diff_28738 = time_end_28737 -
                             time_start_28736;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.seghist_local_25351", time_diff_28738);
                    }
                }
            }
        } else {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "## Using global memory");
            
            int64_t hist_H_28114;
            
            hist_H_28114 = res_23550;
            
            double hist_RF_28115;
            
            hist_RF_28115 = (0.0 + sitofp_i32_f64(1)) / 1.0;
            
            int32_t hist_el_sizze_28116;
            
            hist_el_sizze_28116 =
                squot32(sext_i64_i32((int32_t) sizeof(int32_t) +
                        (int32_t) sizeof(int64_t)), 2);
            
            double hist_C_max_28117;
            
            hist_C_max_28117 =
                fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_25348 *
                       seghist_group_sizze_25346)),
                       sitofp_i32_f64(hist_H_28114) / 2.0);
            
            int32_t hist_M_min_28118;
            
            hist_M_min_28118 = smax32(1,
                                      sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_25348 *
                                      seghist_group_sizze_25346)) /
                                      hist_C_max_28117)));
            
            int32_t L2_sizze_28119;
            
            L2_sizze_28119 = ctx->sizes.mainziL2_sizze_28119;
            
            double hist_RACE_exp_28120;
            
            hist_RACE_exp_28120 = fmax64(1.0, 0.75 * hist_RF_28115 / (64.0 /
                                                                      sitofp_i32_f64(hist_el_sizze_28116)));
            
            int32_t hist_S_28121;
            
            if (slt64(binop_x_27689, hist_H_28114)) {
                hist_S_28121 = 1;
            } else {
                hist_S_28121 =
                    sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_min_28118) *
                                           hist_H_28114 *
                                           sext_i32_i64(hist_el_sizze_28116),
                                           fptosi_f64_i64(0.4 *
                                           sitofp_i32_f64(L2_sizze_28119) *
                                           hist_RACE_exp_28120)));
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %f%c", "Race expansion factor (RACE^exp)",
                        (double) hist_RACE_exp_28120, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                        (long long) hist_S_28121, '\n');
            
            int64_t hist_H_chk_28122;
            
            hist_H_chk_28122 = sdiv_up64(res_23550, sext_i32_i64(hist_S_28121));
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Chunk size (H_chk)",
                        (long long) hist_H_chk_28122, '\n');
            
            double hist_k_max_28123;
            
            hist_k_max_28123 = fmin64(0.4 * (sitofp_i32_f64(L2_sizze_28119) /
                                             sitofp_i32_f64(sext_i64_i32((int32_t) sizeof(int32_t) +
                                             (int32_t) sizeof(int64_t)))) *
                                      hist_RACE_exp_28120,
                                      sitofp_i32_f64(binop_x_27689)) /
                sitofp_i32_f64(sext_i64_i32(num_groups_25348 *
                seghist_group_sizze_25346));
            
            int64_t hist_u_28124;
            
            hist_u_28124 = 1;
            
            double hist_C_28125;
            
            hist_C_28125 = fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_25348 *
                                  seghist_group_sizze_25346)),
                                  sitofp_i32_f64(hist_u_28124 *
                                  hist_H_chk_28122) / hist_k_max_28123);
            
            int32_t hist_M_28126;
            
            hist_M_28126 = smax32(hist_M_min_28118,
                                  sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_25348 *
                                  seghist_group_sizze_25346)) / hist_C_28125)));
            if (ctx->debugging)
                fprintf(stderr, "%s: %f%c",
                        "Elements/thread in L2 cache (k_max)",
                        (double) hist_k_max_28123, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                        (long long) hist_M_28126, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %f%c", "Cooperation level (C)",
                        (double) hist_C_28125, '\n');
            num_subhistos_28056 = sext_i32_i64(hist_M_28126);
            if (hist_M_28126 == 1) {
                if (memblock_set_device(ctx, &res_subhistos_mem_28057,
                                        &mem_27744, "mem_27744") != 0)
                    return 1;
            } else {
                if (num_subhistos_28056 == 1) {
                    if (memblock_set_device(ctx, &res_subhistos_mem_28057,
                                            &mem_27744, "mem_27744") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &res_subhistos_mem_28057,
                                              sext_i32_i64(num_subhistos_28056) *
                                              res_23550 *
                                              (int32_t) sizeof(int64_t),
                                              "res_subhistos_mem_28057")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx,
                                                      res_subhistos_mem_28057,
                                                      num_subhistos_28056 *
                                                      res_23550, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (res_23550 * (int32_t) sizeof(int64_t) > 0) {
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                     mem_27744.mem,
                                                                     res_subhistos_mem_28057.mem,
                                                                     0, 0,
                                                                     res_23550 *
                                                                     (int32_t) sizeof(int64_t),
                                                                     0, NULL,
                                                                     ctx->profiling_paused ||
                                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
                        if (ctx->debugging)
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    }
                }
            }
            
            struct memblock_device mainzihist_locks_mem_28127 =
                                   ctx->mainzihist_locks_mem_28127;
            
            for (int32_t chk_i_28129 = 0; chk_i_28129 < hist_S_28121;
                 chk_i_28129++) {
                int64_t hist_H_chk_28130 = sdiv_up64(res_23550,
                                                     sext_i32_i64(hist_S_28121));
                
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25351,
                                                        1, sizeof(res_23550),
                                                        &res_23550));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25351,
                                                        2,
                                                        sizeof(num_groups_25348),
                                                        &num_groups_25348));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25351,
                                                        3,
                                                        sizeof(binop_x_27689),
                                                        &binop_x_27689));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25351,
                                                        4,
                                                        sizeof(mem_27737.mem),
                                                        &mem_27737.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25351,
                                                        5,
                                                        sizeof(num_subhistos_28056),
                                                        &num_subhistos_28056));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25351,
                                                        6,
                                                        sizeof(res_subhistos_mem_28057.mem),
                                                        &res_subhistos_mem_28057.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25351,
                                                        7,
                                                        sizeof(mainzihist_locks_mem_28127.mem),
                                                        &mainzihist_locks_mem_28127.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25351,
                                                        8, sizeof(chk_i_28129),
                                                        &chk_i_28129));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25351,
                                                        9,
                                                        sizeof(hist_H_chk_28130),
                                                        &hist_H_chk_28130));
                if (1 * ((size_t) num_groups_25348 *
                         (size_t) seghist_group_sizze_25346) != 0) {
                    const size_t global_work_sizze_28741[1] =
                                 {(size_t) num_groups_25348 *
                                 (size_t) seghist_group_sizze_25346};
                    const size_t local_work_sizze_28745[1] =
                                 {seghist_group_sizze_25346};
                    int64_t time_start_28742 = 0, time_end_28743 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.seghist_global_25351");
                        fprintf(stderr, "%zu", global_work_sizze_28741[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_28745[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_28742 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainziseghist_global_25351,
                                                                    1, NULL,
                                                                    global_work_sizze_28741,
                                                                    local_work_sizze_28745,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainziseghist_global_25351_runs,
                                                                                                              &ctx->mainziseghist_global_25351_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_28743 = get_wall_time();
                        
                        long time_diff_28744 = time_end_28743 -
                             time_start_28742;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.seghist_global_25351", time_diff_28744);
                    }
                }
            }
        }
        if (num_subhistos_28056 == 1) {
            if (memblock_set_device(ctx, &mem_27744, &res_subhistos_mem_28057,
                                    "res_subhistos_mem_28057") != 0)
                return 1;
        } else {
            if (slt64(num_subhistos_28056 * 2, seghist_group_sizze_25346)) {
                int64_t segment_sizze_nonzzero_28143 = smax64(1,
                                                              num_subhistos_28056);
                int64_t num_threads_28144 = num_groups_25348 *
                        seghist_group_sizze_25346;
                
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegRed-small");
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "num_segments",
                            (long long) res_23550, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "segment_size",
                            (long long) num_subhistos_28056, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "segments_per_group",
                            (long long) squot64(seghist_group_sizze_25346,
                                                segment_sizze_nonzzero_28143),
                            '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "required_groups",
                            (long long) sext_i64_i32(sdiv_up64(res_23550,
                                                               squot64(seghist_group_sizze_25346,
                                                                       segment_sizze_nonzzero_28143))),
                            '\n');
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28142,
                                                        1,
                                                        (int32_t) sizeof(int64_t) *
                                                        seghist_group_sizze_25346,
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28142,
                                                        2, sizeof(res_23550),
                                                        &res_23550));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28142,
                                                        3,
                                                        sizeof(num_groups_25348),
                                                        &num_groups_25348));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28142,
                                                        4,
                                                        sizeof(mem_27744.mem),
                                                        &mem_27744.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28142,
                                                        5,
                                                        sizeof(num_subhistos_28056),
                                                        &num_subhistos_28056));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28142,
                                                        6,
                                                        sizeof(res_subhistos_mem_28057.mem),
                                                        &res_subhistos_mem_28057.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28142,
                                                        7,
                                                        sizeof(segment_sizze_nonzzero_28143),
                                                        &segment_sizze_nonzzero_28143));
                if (1 * ((size_t) num_groups_25348 *
                         (size_t) seghist_group_sizze_25346) != 0) {
                    const size_t global_work_sizze_28746[1] =
                                 {(size_t) num_groups_25348 *
                                 (size_t) seghist_group_sizze_25346};
                    const size_t local_work_sizze_28750[1] =
                                 {seghist_group_sizze_25346};
                    int64_t time_start_28747 = 0, time_end_28748 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.segred_small_28142");
                        fprintf(stderr, "%zu", global_work_sizze_28746[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_28750[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(int64_t) *
                                       seghist_group_sizze_25346));
                        time_start_28747 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainzisegred_small_28142,
                                                                    1, NULL,
                                                                    global_work_sizze_28746,
                                                                    local_work_sizze_28750,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainzisegred_small_28142_runs,
                                                                                                              &ctx->mainzisegred_small_28142_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_28748 = get_wall_time();
                        
                        long time_diff_28749 = time_end_28748 -
                             time_start_28747;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.segred_small_28142", time_diff_28749);
                    }
                }
            } else {
                int64_t groups_per_segment_28164 = sdiv_up64(num_groups_25348,
                                                             smax64(1,
                                                                    res_23550));
                int64_t elements_per_thread_28165 =
                        sdiv_up64(num_subhistos_28056,
                                  seghist_group_sizze_25346 *
                                  groups_per_segment_28164);
                int64_t virt_num_groups_28166 = groups_per_segment_28164 *
                        res_23550;
                int64_t num_threads_28167 = num_groups_25348 *
                        seghist_group_sizze_25346;
                int64_t threads_per_segment_28168 = groups_per_segment_28164 *
                        seghist_group_sizze_25346;
                
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegRed-large");
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "num_segments",
                            (long long) res_23550, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "segment_size",
                            (long long) num_subhistos_28056, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                            (long long) virt_num_groups_28166, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "num_groups",
                            (long long) num_groups_25348, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "group_size",
                            (long long) seghist_group_sizze_25346, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                            (long long) elements_per_thread_28165, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                            (long long) groups_per_segment_28164, '\n');
                
                struct memblock_device group_res_arr_mem_28169;
                
                group_res_arr_mem_28169.references = NULL;
                if (memblock_alloc_device(ctx, &group_res_arr_mem_28169,
                                          (int32_t) sizeof(int64_t) *
                                          (seghist_group_sizze_25346 *
                                           virt_num_groups_28166),
                                          "group_res_arr_mem_28169")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mainzicounter_mem_28171 =
                                       ctx->mainzicounter_mem_28171;
                
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28142,
                                                        1,
                                                        (int32_t) sizeof(bool),
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28142,
                                                        2,
                                                        (int32_t) sizeof(int64_t) *
                                                        seghist_group_sizze_25346,
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28142,
                                                        3, sizeof(res_23550),
                                                        &res_23550));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28142,
                                                        4,
                                                        sizeof(num_groups_25348),
                                                        &num_groups_25348));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28142,
                                                        5,
                                                        sizeof(mem_27744.mem),
                                                        &mem_27744.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28142,
                                                        6,
                                                        sizeof(num_subhistos_28056),
                                                        &num_subhistos_28056));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28142,
                                                        7,
                                                        sizeof(res_subhistos_mem_28057.mem),
                                                        &res_subhistos_mem_28057.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28142,
                                                        8,
                                                        sizeof(groups_per_segment_28164),
                                                        &groups_per_segment_28164));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28142,
                                                        9,
                                                        sizeof(elements_per_thread_28165),
                                                        &elements_per_thread_28165));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28142,
                                                        10,
                                                        sizeof(virt_num_groups_28166),
                                                        &virt_num_groups_28166));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28142,
                                                        11,
                                                        sizeof(threads_per_segment_28168),
                                                        &threads_per_segment_28168));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28142,
                                                        12,
                                                        sizeof(group_res_arr_mem_28169.mem),
                                                        &group_res_arr_mem_28169.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28142,
                                                        13,
                                                        sizeof(mainzicounter_mem_28171.mem),
                                                        &mainzicounter_mem_28171.mem));
                if (1 * ((size_t) num_groups_25348 *
                         (size_t) seghist_group_sizze_25346) != 0) {
                    const size_t global_work_sizze_28752[1] =
                                 {(size_t) num_groups_25348 *
                                 (size_t) seghist_group_sizze_25346};
                    const size_t local_work_sizze_28756[1] =
                                 {seghist_group_sizze_25346};
                    int64_t time_start_28753 = 0, time_end_28754 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.segred_large_28142");
                        fprintf(stderr, "%zu", global_work_sizze_28752[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_28756[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(bool) +
                                       (int32_t) sizeof(int64_t) *
                                       seghist_group_sizze_25346));
                        time_start_28753 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainzisegred_large_28142,
                                                                    1, NULL,
                                                                    global_work_sizze_28752,
                                                                    local_work_sizze_28756,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainzisegred_large_28142_runs,
                                                                                                              &ctx->mainzisegred_large_28142_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_28754 = get_wall_time();
                        
                        long time_diff_28755 = time_end_28754 -
                             time_start_28753;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.segred_large_28142", time_diff_28755);
                    }
                }
                if (memblock_unref_device(ctx, &group_res_arr_mem_28169,
                                          "group_res_arr_mem_28169") != 0)
                    return 1;
            }
        }
    }
    if (memblock_unref_device(ctx, &mem_27737, "mem_27737") != 0)
        return 1;
    
    int64_t segscan_group_sizze_25361;
    
    segscan_group_sizze_25361 = ctx->sizes.mainzisegscan_group_sizze_25360;
    
    int64_t num_groups_25363;
    int32_t max_num_groups_28203;
    
    max_num_groups_28203 = ctx->sizes.mainzisegscan_num_groups_25362;
    num_groups_25363 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_23550,
                                                               sext_i32_i64(segscan_group_sizze_25361)),
                                                     sext_i32_i64(max_num_groups_28203))));
    
    struct memblock_device mem_27748;
    
    mem_27748.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27748, res_23550, "mem_27748")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27750;
    
    mem_27750.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27750, bytes_27743, "mem_27750")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_23550)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28204;
        
        stage1_max_num_groups_28204 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28205;
        
        stage1_num_groups_28205 = smin64(stage1_max_num_groups_28204,
                                         num_groups_25363);
        
        int32_t num_threads_28206;
        
        num_threads_28206 = sext_i64_i32(stage1_num_groups_28205 *
            segscan_group_sizze_25361);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25366, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_25361),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25366, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       segscan_group_sizze_25361),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25366, 3,
                                                sizeof(res_23550), &res_23550));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25366, 4,
                                                sizeof(mem_27744.mem),
                                                &mem_27744.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25366, 5,
                                                sizeof(mem_27748.mem),
                                                &mem_27748.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25366, 6,
                                                sizeof(mem_27750.mem),
                                                &mem_27750.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25366, 7,
                                                sizeof(num_threads_28206),
                                                &num_threads_28206));
        if (1 * ((size_t) stage1_num_groups_28205 *
                 (size_t) segscan_group_sizze_25361) != 0) {
            const size_t global_work_sizze_28757[1] =
                         {(size_t) stage1_num_groups_28205 *
                         (size_t) segscan_group_sizze_25361};
            const size_t local_work_sizze_28761[1] =
                         {segscan_group_sizze_25361};
            int64_t time_start_28758 = 0, time_end_28759 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage1_25366");
                fprintf(stderr, "%zu", global_work_sizze_28757[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28761[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_25361) + smax64(1,
                                                                              (int32_t) sizeof(bool) *
                                                                              segscan_group_sizze_25361)));
                time_start_28758 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage1_25366,
                                                            1, NULL,
                                                            global_work_sizze_28757,
                                                            local_work_sizze_28761,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage1_25366_runs,
                                                                                                      &ctx->mainziscan_stage1_25366_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28759 = get_wall_time();
                
                long time_diff_28760 = time_end_28759 - time_start_28758;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage1_25366", time_diff_28760);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_25361 *
                                 sdiv_up64(res_23550,
                                           sext_i32_i64(num_threads_28206))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25366, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_28205),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25366, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       stage1_num_groups_28205),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25366, 3,
                                                sizeof(res_23550), &res_23550));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25366, 4,
                                                sizeof(mem_27748.mem),
                                                &mem_27748.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25366, 5,
                                                sizeof(mem_27750.mem),
                                                &mem_27750.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25366, 6,
                                                sizeof(stage1_num_groups_28205),
                                                &stage1_num_groups_28205));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25366, 7,
                                                sizeof(num_threads_28206),
                                                &num_threads_28206));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28205) != 0) {
            const size_t global_work_sizze_28762[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28205};
            const size_t local_work_sizze_28766[1] = {stage1_num_groups_28205};
            int64_t time_start_28763 = 0, time_end_28764 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage2_25366");
                fprintf(stderr, "%zu", global_work_sizze_28762[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28766[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_28205) + smax64(1,
                                                                            (int32_t) sizeof(bool) *
                                                                            stage1_num_groups_28205)));
                time_start_28763 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage2_25366,
                                                            1, NULL,
                                                            global_work_sizze_28762,
                                                            local_work_sizze_28766,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage2_25366_runs,
                                                                                                      &ctx->mainziscan_stage2_25366_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28764 = get_wall_time();
                
                long time_diff_28765 = time_end_28764 - time_start_28763;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage2_25366", time_diff_28765);
            }
        }
        
        int32_t required_groups_28258;
        
        required_groups_28258 = sext_i64_i32(sdiv_up64(res_23550,
                                                       segscan_group_sizze_25361));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25366, 1,
                                                sizeof(res_23550), &res_23550));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25366, 2,
                                                sizeof(num_groups_25363),
                                                &num_groups_25363));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25366, 3,
                                                sizeof(mem_27748.mem),
                                                &mem_27748.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25366, 4,
                                                sizeof(mem_27750.mem),
                                                &mem_27750.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25366, 5,
                                                sizeof(num_threads_28206),
                                                &num_threads_28206));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25366, 6,
                                                sizeof(required_groups_28258),
                                                &required_groups_28258));
        if (1 * ((size_t) num_groups_25363 *
                 (size_t) segscan_group_sizze_25361) != 0) {
            const size_t global_work_sizze_28767[1] =
                         {(size_t) num_groups_25363 *
                         (size_t) segscan_group_sizze_25361};
            const size_t local_work_sizze_28771[1] =
                         {segscan_group_sizze_25361};
            int64_t time_start_28768 = 0, time_end_28769 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage3_25366");
                fprintf(stderr, "%zu", global_work_sizze_28767[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28771[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28768 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage3_25366,
                                                            1, NULL,
                                                            global_work_sizze_28767,
                                                            local_work_sizze_28771,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage3_25366_runs,
                                                                                                      &ctx->mainziscan_stage3_25366_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28769 = get_wall_time();
                
                long time_diff_28770 = time_end_28769 - time_start_28768;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage3_25366", time_diff_28770);
            }
        }
    }
    if (memblock_unref_device(ctx, &mem_27744, "mem_27744") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27748, "mem_27748") != 0)
        return 1;
    
    int64_t segscan_group_sizze_25369;
    
    segscan_group_sizze_25369 = ctx->sizes.mainzisegscan_group_sizze_25368;
    
    int64_t num_groups_25371;
    int32_t max_num_groups_28270;
    
    max_num_groups_28270 = ctx->sizes.mainzisegscan_num_groups_25370;
    num_groups_25371 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_23550,
                                                               sext_i32_i64(segscan_group_sizze_25369)),
                                                     sext_i32_i64(max_num_groups_28270))));
    
    struct memblock_device mem_27753;
    
    mem_27753.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27753, res_23550, "mem_27753")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27755;
    
    mem_27755.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27755, bytes_27743, "mem_27755")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27757;
    
    mem_27757.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27757, res_23550, "mem_27757")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_23550)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28271;
        
        stage1_max_num_groups_28271 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28272;
        
        stage1_num_groups_28272 = smin64(stage1_max_num_groups_28271,
                                         num_groups_25371);
        
        int32_t num_threads_28273;
        
        num_threads_28273 = sext_i64_i32(stage1_num_groups_28272 *
            segscan_group_sizze_25369);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25374, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_25369),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25374, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       segscan_group_sizze_25369),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25374, 3,
                                                sizeof(res_23550), &res_23550));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25374, 4,
                                                sizeof(mem_27750.mem),
                                                &mem_27750.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25374, 5,
                                                sizeof(mem_27753.mem),
                                                &mem_27753.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25374, 6,
                                                sizeof(mem_27755.mem),
                                                &mem_27755.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25374, 7,
                                                sizeof(mem_27757.mem),
                                                &mem_27757.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25374, 8,
                                                sizeof(num_threads_28273),
                                                &num_threads_28273));
        if (1 * ((size_t) stage1_num_groups_28272 *
                 (size_t) segscan_group_sizze_25369) != 0) {
            const size_t global_work_sizze_28772[1] =
                         {(size_t) stage1_num_groups_28272 *
                         (size_t) segscan_group_sizze_25369};
            const size_t local_work_sizze_28776[1] =
                         {segscan_group_sizze_25369};
            int64_t time_start_28773 = 0, time_end_28774 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage1_25374");
                fprintf(stderr, "%zu", global_work_sizze_28772[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28776[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_25369) + smax64(1,
                                                                              (int32_t) sizeof(bool) *
                                                                              segscan_group_sizze_25369)));
                time_start_28773 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage1_25374,
                                                            1, NULL,
                                                            global_work_sizze_28772,
                                                            local_work_sizze_28776,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage1_25374_runs,
                                                                                                      &ctx->mainziscan_stage1_25374_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28774 = get_wall_time();
                
                long time_diff_28775 = time_end_28774 - time_start_28773;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage1_25374", time_diff_28775);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_25369 *
                                 sdiv_up64(res_23550,
                                           sext_i32_i64(num_threads_28273))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25374, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_28272),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25374, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       stage1_num_groups_28272),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25374, 3,
                                                sizeof(res_23550), &res_23550));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25374, 4,
                                                sizeof(mem_27753.mem),
                                                &mem_27753.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25374, 5,
                                                sizeof(mem_27755.mem),
                                                &mem_27755.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25374, 6,
                                                sizeof(stage1_num_groups_28272),
                                                &stage1_num_groups_28272));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25374, 7,
                                                sizeof(num_threads_28273),
                                                &num_threads_28273));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28272) != 0) {
            const size_t global_work_sizze_28777[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28272};
            const size_t local_work_sizze_28781[1] = {stage1_num_groups_28272};
            int64_t time_start_28778 = 0, time_end_28779 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage2_25374");
                fprintf(stderr, "%zu", global_work_sizze_28777[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28781[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_28272) + smax64(1,
                                                                            (int32_t) sizeof(bool) *
                                                                            stage1_num_groups_28272)));
                time_start_28778 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage2_25374,
                                                            1, NULL,
                                                            global_work_sizze_28777,
                                                            local_work_sizze_28781,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage2_25374_runs,
                                                                                                      &ctx->mainziscan_stage2_25374_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28779 = get_wall_time();
                
                long time_diff_28780 = time_end_28779 - time_start_28778;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage2_25374", time_diff_28780);
            }
        }
        
        int32_t required_groups_28325;
        
        required_groups_28325 = sext_i64_i32(sdiv_up64(res_23550,
                                                       segscan_group_sizze_25369));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25374, 1,
                                                sizeof(res_23550), &res_23550));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25374, 2,
                                                sizeof(num_groups_25371),
                                                &num_groups_25371));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25374, 3,
                                                sizeof(mem_27753.mem),
                                                &mem_27753.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25374, 4,
                                                sizeof(mem_27755.mem),
                                                &mem_27755.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25374, 5,
                                                sizeof(num_threads_28273),
                                                &num_threads_28273));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25374, 6,
                                                sizeof(required_groups_28325),
                                                &required_groups_28325));
        if (1 * ((size_t) num_groups_25371 *
                 (size_t) segscan_group_sizze_25369) != 0) {
            const size_t global_work_sizze_28782[1] =
                         {(size_t) num_groups_25371 *
                         (size_t) segscan_group_sizze_25369};
            const size_t local_work_sizze_28786[1] =
                         {segscan_group_sizze_25369};
            int64_t time_start_28783 = 0, time_end_28784 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage3_25374");
                fprintf(stderr, "%zu", global_work_sizze_28782[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28786[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28783 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage3_25374,
                                                            1, NULL,
                                                            global_work_sizze_28782,
                                                            local_work_sizze_28786,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage3_25374_runs,
                                                                                                      &ctx->mainziscan_stage3_25374_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28784 = get_wall_time();
                
                long time_diff_28785 = time_end_28784 - time_start_28783;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage3_25374", time_diff_28785);
            }
        }
    }
    if (memblock_unref_device(ctx, &mem_27753, "mem_27753") != 0)
        return 1;
    
    int64_t segscan_group_sizze_25377;
    
    segscan_group_sizze_25377 = ctx->sizes.mainzisegscan_group_sizze_25376;
    
    int64_t num_groups_25379;
    int32_t max_num_groups_28337;
    
    max_num_groups_28337 = ctx->sizes.mainzisegscan_num_groups_25378;
    num_groups_25379 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_23550,
                                                               sext_i32_i64(segscan_group_sizze_25377)),
                                                     sext_i32_i64(max_num_groups_28337))));
    
    struct memblock_device mem_27760;
    
    mem_27760.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27760, res_23550, "mem_27760")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_27761 = 4 * res_23550;
    struct memblock_device mem_27762;
    
    mem_27762.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27762, bytes_27761, "mem_27762")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_23550)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28338;
        
        stage1_max_num_groups_28338 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28339;
        
        stage1_num_groups_28339 = smin64(stage1_max_num_groups_28338,
                                         num_groups_25379);
        
        int32_t num_threads_28340;
        
        num_threads_28340 = sext_i64_i32(stage1_num_groups_28339 *
            segscan_group_sizze_25377);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382, 3,
                                                smax64(1,
                                                       (int32_t) sizeof(float) *
                                                       segscan_group_sizze_25377),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382, 4,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       segscan_group_sizze_25377),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382, 5,
                                                sizeof(n_23343), &n_23343));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382, 6,
                                                sizeof(steps_23347),
                                                &steps_23347));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382, 7,
                                                sizeof(a_23351), &a_23351));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382, 8,
                                                sizeof(b_23352), &b_23352));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382, 9,
                                                sizeof(sigma_23353),
                                                &sigma_23353));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382,
                                                10, sizeof(res_23550),
                                                &res_23550));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382,
                                                11,
                                                sizeof(one_intra_par_min_24642),
                                                &one_intra_par_min_24642));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382,
                                                12, sizeof(res_mem_27657.mem),
                                                &res_mem_27657.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382,
                                                13, sizeof(res_mem_27658.mem),
                                                &res_mem_27658.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382,
                                                14, sizeof(res_mem_27659.mem),
                                                &res_mem_27659.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382,
                                                15, sizeof(res_mem_27660.mem),
                                                &res_mem_27660.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382,
                                                16, sizeof(binop_x_27689),
                                                &binop_x_27689));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382,
                                                17, sizeof(res_mem_27733.mem),
                                                &res_mem_27733.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382,
                                                18, sizeof(res_mem_27734.mem),
                                                &res_mem_27734.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382,
                                                19, sizeof(mem_27750.mem),
                                                &mem_27750.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382,
                                                20, sizeof(mem_27755.mem),
                                                &mem_27755.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382,
                                                21, sizeof(mem_27757.mem),
                                                &mem_27757.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382,
                                                22, sizeof(mem_27760.mem),
                                                &mem_27760.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382,
                                                23, sizeof(mem_27762.mem),
                                                &mem_27762.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25382,
                                                24, sizeof(num_threads_28340),
                                                &num_threads_28340));
        if (1 * ((size_t) stage1_num_groups_28339 *
                 (size_t) segscan_group_sizze_25377) != 0) {
            const size_t global_work_sizze_28787[1] =
                         {(size_t) stage1_num_groups_28339 *
                         (size_t) segscan_group_sizze_25377};
            const size_t local_work_sizze_28791[1] =
                         {segscan_group_sizze_25377};
            int64_t time_start_28788 = 0, time_end_28789 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage1_25382");
                fprintf(stderr, "%zu", global_work_sizze_28787[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28791[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                          segscan_group_sizze_25377) + smax64(1,
                                                                              (int32_t) sizeof(bool) *
                                                                              segscan_group_sizze_25377)));
                time_start_28788 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage1_25382,
                                                            1, NULL,
                                                            global_work_sizze_28787,
                                                            local_work_sizze_28791,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage1_25382_runs,
                                                                                                      &ctx->mainziscan_stage1_25382_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28789 = get_wall_time();
                
                long time_diff_28790 = time_end_28789 - time_start_28788;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage1_25382", time_diff_28790);
            }
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_25377 *
                                 sdiv_up64(res_23550,
                                           sext_i32_i64(num_threads_28340))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25382, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(float) *
                                                       stage1_num_groups_28339),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25382, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       stage1_num_groups_28339),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25382, 3,
                                                sizeof(res_23550), &res_23550));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25382, 4,
                                                sizeof(mem_27760.mem),
                                                &mem_27760.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25382, 5,
                                                sizeof(mem_27762.mem),
                                                &mem_27762.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25382, 6,
                                                sizeof(stage1_num_groups_28339),
                                                &stage1_num_groups_28339));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25382, 7,
                                                sizeof(num_threads_28340),
                                                &num_threads_28340));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28339) != 0) {
            const size_t global_work_sizze_28792[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28339};
            const size_t local_work_sizze_28796[1] = {stage1_num_groups_28339};
            int64_t time_start_28793 = 0, time_end_28794 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage2_25382");
                fprintf(stderr, "%zu", global_work_sizze_28792[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28796[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                          stage1_num_groups_28339) + smax64(1,
                                                                            (int32_t) sizeof(bool) *
                                                                            stage1_num_groups_28339)));
                time_start_28793 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage2_25382,
                                                            1, NULL,
                                                            global_work_sizze_28792,
                                                            local_work_sizze_28796,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage2_25382_runs,
                                                                                                      &ctx->mainziscan_stage2_25382_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28794 = get_wall_time();
                
                long time_diff_28795 = time_end_28794 - time_start_28793;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage2_25382", time_diff_28795);
            }
        }
        
        int32_t required_groups_28392;
        
        required_groups_28392 = sext_i64_i32(sdiv_up64(res_23550,
                                                       segscan_group_sizze_25377));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25382, 1,
                                                sizeof(res_23550), &res_23550));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25382, 2,
                                                sizeof(num_groups_25379),
                                                &num_groups_25379));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25382, 3,
                                                sizeof(mem_27760.mem),
                                                &mem_27760.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25382, 4,
                                                sizeof(mem_27762.mem),
                                                &mem_27762.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25382, 5,
                                                sizeof(num_threads_28340),
                                                &num_threads_28340));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25382, 6,
                                                sizeof(required_groups_28392),
                                                &required_groups_28392));
        if (1 * ((size_t) num_groups_25379 *
                 (size_t) segscan_group_sizze_25377) != 0) {
            const size_t global_work_sizze_28797[1] =
                         {(size_t) num_groups_25379 *
                         (size_t) segscan_group_sizze_25377};
            const size_t local_work_sizze_28801[1] =
                         {segscan_group_sizze_25377};
            int64_t time_start_28798 = 0, time_end_28799 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage3_25382");
                fprintf(stderr, "%zu", global_work_sizze_28797[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28801[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28798 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage3_25382,
                                                            1, NULL,
                                                            global_work_sizze_28797,
                                                            local_work_sizze_28801,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage3_25382_runs,
                                                                                                      &ctx->mainziscan_stage3_25382_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28799 = get_wall_time();
                
                long time_diff_28800 = time_end_28799 - time_start_28798;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage3_25382", time_diff_28800);
            }
        }
    }
    if (memblock_unref_device(ctx, &res_mem_27657, "res_mem_27657") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27658, "res_mem_27658") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27659, "res_mem_27659") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27733, "res_mem_27733") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27734, "res_mem_27734") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27750, "mem_27750") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27755, "mem_27755") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27760, "mem_27760") != 0)
        return 1;
    
    int64_t segscan_group_sizze_25429;
    
    segscan_group_sizze_25429 = ctx->sizes.mainzisegscan_group_sizze_25428;
    
    int64_t num_groups_25431;
    int32_t max_num_groups_28404;
    
    max_num_groups_28404 = ctx->sizes.mainzisegscan_num_groups_25430;
    num_groups_25431 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_23550,
                                                               sext_i32_i64(segscan_group_sizze_25429)),
                                                     sext_i32_i64(max_num_groups_28404))));
    
    struct memblock_device mem_27765;
    
    mem_27765.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27765, bytes_27743, "mem_27765")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_23550)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28405;
        
        stage1_max_num_groups_28405 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28406;
        
        stage1_num_groups_28406 = smin64(stage1_max_num_groups_28405,
                                         num_groups_25431);
        
        int32_t num_threads_28407;
        
        num_threads_28407 = sext_i64_i32(stage1_num_groups_28406 *
            segscan_group_sizze_25429);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25434, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_25429),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25434, 2,
                                                sizeof(res_23550), &res_23550));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25434, 3,
                                                sizeof(mem_27757.mem),
                                                &mem_27757.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25434, 4,
                                                sizeof(mem_27765.mem),
                                                &mem_27765.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25434, 5,
                                                sizeof(num_threads_28407),
                                                &num_threads_28407));
        if (1 * ((size_t) stage1_num_groups_28406 *
                 (size_t) segscan_group_sizze_25429) != 0) {
            const size_t global_work_sizze_28802[1] =
                         {(size_t) stage1_num_groups_28406 *
                         (size_t) segscan_group_sizze_25429};
            const size_t local_work_sizze_28806[1] =
                         {segscan_group_sizze_25429};
            int64_t time_start_28803 = 0, time_end_28804 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage1_25434");
                fprintf(stderr, "%zu", global_work_sizze_28802[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28806[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_25429)));
                time_start_28803 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage1_25434,
                                                            1, NULL,
                                                            global_work_sizze_28802,
                                                            local_work_sizze_28806,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage1_25434_runs,
                                                                                                      &ctx->mainziscan_stage1_25434_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28804 = get_wall_time();
                
                long time_diff_28805 = time_end_28804 - time_start_28803;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage1_25434", time_diff_28805);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_25429 *
                                 sdiv_up64(res_23550,
                                           sext_i32_i64(num_threads_28407))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25434, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_28406),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25434, 2,
                                                sizeof(res_23550), &res_23550));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25434, 3,
                                                sizeof(mem_27765.mem),
                                                &mem_27765.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25434, 4,
                                                sizeof(stage1_num_groups_28406),
                                                &stage1_num_groups_28406));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25434, 5,
                                                sizeof(num_threads_28407),
                                                &num_threads_28407));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28406) != 0) {
            const size_t global_work_sizze_28807[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28406};
            const size_t local_work_sizze_28811[1] = {stage1_num_groups_28406};
            int64_t time_start_28808 = 0, time_end_28809 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage2_25434");
                fprintf(stderr, "%zu", global_work_sizze_28807[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28811[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_28406)));
                time_start_28808 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage2_25434,
                                                            1, NULL,
                                                            global_work_sizze_28807,
                                                            local_work_sizze_28811,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage2_25434_runs,
                                                                                                      &ctx->mainziscan_stage2_25434_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28809 = get_wall_time();
                
                long time_diff_28810 = time_end_28809 - time_start_28808;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage2_25434", time_diff_28810);
            }
        }
        
        int32_t required_groups_28443;
        
        required_groups_28443 = sext_i64_i32(sdiv_up64(res_23550,
                                                       segscan_group_sizze_25429));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25434, 1,
                                                sizeof(res_23550), &res_23550));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25434, 2,
                                                sizeof(num_groups_25431),
                                                &num_groups_25431));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25434, 3,
                                                sizeof(mem_27765.mem),
                                                &mem_27765.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25434, 4,
                                                sizeof(num_threads_28407),
                                                &num_threads_28407));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25434, 5,
                                                sizeof(required_groups_28443),
                                                &required_groups_28443));
        if (1 * ((size_t) num_groups_25431 *
                 (size_t) segscan_group_sizze_25429) != 0) {
            const size_t global_work_sizze_28812[1] =
                         {(size_t) num_groups_25431 *
                         (size_t) segscan_group_sizze_25429};
            const size_t local_work_sizze_28816[1] =
                         {segscan_group_sizze_25429};
            int64_t time_start_28813 = 0, time_end_28814 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage3_25434");
                fprintf(stderr, "%zu", global_work_sizze_28812[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28816[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28813 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage3_25434,
                                                            1, NULL,
                                                            global_work_sizze_28812,
                                                            local_work_sizze_28816,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage3_25434_runs,
                                                                                                      &ctx->mainziscan_stage3_25434_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28814 = get_wall_time();
                
                long time_diff_28815 = time_end_28814 - time_start_28813;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage3_25434", time_diff_28815);
            }
        }
    }
    
    bool cond_23747 = slt64(0, res_23550);
    int64_t num_segments_23748;
    
    if (cond_23747) {
        int64_t i_23749 = sub64(res_23550, 1);
        bool x_23750 = sle64(0, i_23749);
        bool y_23751 = slt64(i_23749, res_23550);
        bool bounds_check_23752 = x_23750 && y_23751;
        bool index_certs_23753;
        
        if (!bounds_check_23752) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_23749,
                                   "] out of bounds for array of shape [",
                                   res_23550, "].",
                                   "-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:29:36-59\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #4  cva3d.fut:134:18-77\n   #5  cva3d.fut:100:1-146:20\n");
            if (memblock_unref_device(ctx, &mem_27765, "mem_27765") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27762, "mem_27762") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27760, "mem_27760") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27757, "mem_27757") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27755, "mem_27755") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27753, "mem_27753") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27750, "mem_27750") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27748, "mem_27748") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_subhistos_mem_28057,
                                      "res_subhistos_mem_28057") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27744, "mem_27744") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28018,
                                      "group_res_arr_mem_28018") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27742, "mem_27742") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27739, "mem_27739") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27737, "mem_27737") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27734, "res_mem_27734") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27733, "res_mem_27733") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27659, "res_mem_27659") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27658, "res_mem_27658") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27657, "res_mem_27657") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_27878,
                                      "group_res_arr_mem_27878") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_27873, "out_mem_27873") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_28817;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27765.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     i_23749 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_28817, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t res_23754 = read_res_28817;
        
        num_segments_23748 = res_23754;
    } else {
        num_segments_23748 = 0;
    }
    
    bool bounds_invalid_upwards_23755 = slt64(num_segments_23748, 0);
    bool valid_23756 = !bounds_invalid_upwards_23755;
    bool range_valid_c_23757;
    
    if (!valid_23756) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", num_segments_23748,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:33:17-41\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva3d.fut:134:18-77\n   #6  cva3d.fut:100:1-146:20\n");
        if (memblock_unref_device(ctx, &mem_27765, "mem_27765") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27762, "mem_27762") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27760, "mem_27760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27757, "mem_27757") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27755, "mem_27755") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27753, "mem_27753") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27750, "mem_27750") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27748, "mem_27748") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_subhistos_mem_28057,
                                  "res_subhistos_mem_28057") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27744, "mem_27744") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28018,
                                  "group_res_arr_mem_28018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27742, "mem_27742") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27739, "mem_27739") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27737, "mem_27737") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27734, "res_mem_27734") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27733, "res_mem_27733") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27659, "res_mem_27659") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27658, "res_mem_27658") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27657, "res_mem_27657") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27878,
                                  "group_res_arr_mem_27878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_27873, "out_mem_27873") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_27766 = 4 * num_segments_23748;
    struct memblock_device mem_27767;
    
    mem_27767.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27767, bytes_27766, "mem_27767")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f32(ctx, mem_27767, num_segments_23748,
                                      0.0F) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_25439;
    
    segmap_group_sizze_25439 = ctx->sizes.mainzisegmap_group_sizze_25438;
    
    int64_t segmap_usable_groups_25440 = sdiv_up64(res_23550,
                                                   segmap_group_sizze_25439);
    
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25436, 1,
                                            sizeof(res_23550), &res_23550));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25436, 2,
                                            sizeof(num_segments_23748),
                                            &num_segments_23748));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25436, 3,
                                            sizeof(mem_27757.mem),
                                            &mem_27757.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25436, 4,
                                            sizeof(mem_27762.mem),
                                            &mem_27762.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25436, 5,
                                            sizeof(mem_27765.mem),
                                            &mem_27765.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25436, 6,
                                            sizeof(mem_27767.mem),
                                            &mem_27767.mem));
    if (1 * ((size_t) segmap_usable_groups_25440 *
             (size_t) segmap_group_sizze_25439) != 0) {
        const size_t global_work_sizze_28818[1] =
                     {(size_t) segmap_usable_groups_25440 *
                     (size_t) segmap_group_sizze_25439};
        const size_t local_work_sizze_28822[1] = {segmap_group_sizze_25439};
        int64_t time_start_28819 = 0, time_end_28820 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segmap_25436");
            fprintf(stderr, "%zu", global_work_sizze_28818[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_28822[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_28819 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegmap_25436,
                                                        1, NULL,
                                                        global_work_sizze_28818,
                                                        local_work_sizze_28822,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegmap_25436_runs,
                                                                                                  &ctx->mainzisegmap_25436_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_28820 = get_wall_time();
            
            long time_diff_28821 = time_end_28820 - time_start_28819;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "main.segmap_25436",
                    time_diff_28821);
        }
    }
    if (memblock_unref_device(ctx, &mem_27757, "mem_27757") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27762, "mem_27762") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27765, "mem_27765") != 0)
        return 1;
    
    bool dim_match_23765 = binop_x_27689 == num_segments_23748;
    bool empty_or_match_cert_23766;
    
    if (!dim_match_23765) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Value of (core language) shape (",
                               num_segments_23748,
                               ") cannot match shape of type `[", binop_x_27689,
                               "]b`.",
                               "-> #0  lib/github.com/diku-dk/segmented/segmented.fut:103:6-45\n   #1  cva3d.fut:134:18-77\n   #2  cva3d.fut:100:1-146:20\n");
        if (memblock_unref_device(ctx, &mem_27767, "mem_27767") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27765, "mem_27765") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27762, "mem_27762") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27760, "mem_27760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27757, "mem_27757") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27755, "mem_27755") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27753, "mem_27753") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27750, "mem_27750") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27748, "mem_27748") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_subhistos_mem_28057,
                                  "res_subhistos_mem_28057") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27744, "mem_27744") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28018,
                                  "group_res_arr_mem_28018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27742, "mem_27742") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27739, "mem_27739") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27737, "mem_27737") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27734, "res_mem_27734") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27733, "res_mem_27733") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27659, "res_mem_27659") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27658, "res_mem_27658") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27657, "res_mem_27657") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27878,
                                  "group_res_arr_mem_27878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_27873, "out_mem_27873") != 0)
            return 1;
        return 1;
    }
    
    float res_23769 = sitofp_i64_f32(paths_23346);
    bool suff_outer_redomap_25442;
    
    suff_outer_redomap_25442 = ctx->sizes.mainzisuff_outer_redomap_10 <=
        steps_23347;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_outer_redomap_10",
                steps_23347);
    
    int64_t segred_group_sizze_25455;
    
    segred_group_sizze_25455 = ctx->sizes.mainzisegred_group_sizze_25444;
    
    int64_t num_groups_25456;
    int32_t max_num_groups_28469;
    
    max_num_groups_28469 = ctx->sizes.mainzisegred_num_groups_25446;
    num_groups_25456 = sext_i64_i32(smax64(1, smin64(sdiv_up64(steps_23347,
                                                               sext_i32_i64(segred_group_sizze_25455)),
                                                     sext_i32_i64(max_num_groups_28469))));
    
    bool suff_outer_par_25728;
    
    suff_outer_par_25728 = ctx->sizes.mainzisuff_outer_par_11 <= steps_23347;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_outer_par_11",
                steps_23347);
    
    bool fits_25732 = sle64(paths_23346, max_group_sizze_24794);
    bool suff_intra_par_25734;
    
    suff_intra_par_25734 = ctx->sizes.mainzisuff_intra_par_12 <= paths_23346;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_intra_par_12",
                paths_23346);
    
    bool intra_suff_and_fits_25735 = fits_25732 && suff_intra_par_25734;
    int64_t segmap_group_sizze_25739;
    
    segmap_group_sizze_25739 = ctx->sizes.mainzisegmap_group_sizze_25510;
    
    int64_t segred_group_sizze_25813;
    
    segred_group_sizze_25813 = ctx->sizes.mainzisegred_group_sizze_25652;
    
    int64_t num_groups_25814;
    int32_t max_num_groups_28470;
    
    max_num_groups_28470 = ctx->sizes.mainzisegred_num_groups_25654;
    num_groups_25814 = sext_i64_i32(smax64(1, smin64(sdiv_up64(nest_sizze_25206,
                                                               sext_i32_i64(segred_group_sizze_25813)),
                                                     sext_i32_i64(max_num_groups_28470))));
    
    int64_t segmap_group_sizze_25829;
    
    segmap_group_sizze_25829 = ctx->sizes.mainzisegmap_group_sizze_25625;
    
    int64_t segred_group_sizze_25857;
    
    segred_group_sizze_25857 = ctx->sizes.mainzisegred_group_sizze_25718;
    
    int64_t num_groups_25858;
    int32_t max_num_groups_28471;
    
    max_num_groups_28471 = ctx->sizes.mainzisegred_num_groups_25720;
    num_groups_25858 = sext_i64_i32(smax64(1, smin64(sdiv_up64(steps_23347,
                                                               sext_i32_i64(segred_group_sizze_25857)),
                                                     sext_i32_i64(max_num_groups_28471))));
    
    int64_t binop_x_27774 = n_23343 * paths_23346;
    int64_t binop_x_27775 = steps_23347 * binop_x_27774;
    int64_t bytes_27773 = 4 * binop_x_27775;
    struct memblock_device res_mem_27823;
    
    res_mem_27823.references = NULL;
    
    float res_23786;
    int32_t local_memory_capacity_28631;
    
    local_memory_capacity_28631 = ctx->opencl.max_local_memory;
    if ((sle64(0, sext_i32_i64(local_memory_capacity_28631)) &&
         sle64((int32_t) sizeof(bool) + (int32_t) sizeof(float) *
               segred_group_sizze_25455,
               sext_i32_i64(local_memory_capacity_28631))) &&
        suff_outer_redomap_25442) {
        struct memblock_device mem_27772;
        
        mem_27772.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27772, bytes_27687, "mem_27772")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t group_sizze_28475;
        
        group_sizze_28475 = ctx->sizes.mainzigroup_sizze_28475;
        
        int64_t num_groups_28476;
        
        num_groups_28476 = sdiv_up64(steps_23347 * paths_23346 * n_23343,
                                     group_sizze_28475);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28472, 0,
                                                sizeof(n_23343), &n_23343));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28472, 1,
                                                sizeof(paths_23346),
                                                &paths_23346));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28472, 2,
                                                sizeof(steps_23347),
                                                &steps_23347));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28472, 3,
                                                sizeof(mem_27767.mem),
                                                &mem_27767.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28472, 4,
                                                sizeof(mem_27772.mem),
                                                &mem_27772.mem));
        if (1 * ((size_t) num_groups_28476 * (size_t) group_sizze_28475) != 0) {
            const size_t global_work_sizze_28823[1] =
                         {(size_t) num_groups_28476 *
                         (size_t) group_sizze_28475};
            const size_t local_work_sizze_28827[1] = {group_sizze_28475};
            int64_t time_start_28824 = 0, time_end_28825 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.copy_28472");
                fprintf(stderr, "%zu", global_work_sizze_28823[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28827[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28824 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzicopy_28472,
                                                            1, NULL,
                                                            global_work_sizze_28823,
                                                            local_work_sizze_28827,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzicopy_28472_runs,
                                                                                                      &ctx->mainzicopy_28472_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28825 = get_wall_time();
                
                long time_diff_28826 = time_end_28825 - time_start_28824;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n", "main.copy_28472",
                        time_diff_28826);
            }
        }
        
        struct memblock_device mem_27776;
        
        mem_27776.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27776, bytes_27773, "mem_27776")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27776, 0, mem_27772,
                                                  0, 1, paths_23346 * n_23343,
                                                  steps_23347) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_unref_device(ctx, &mem_27772, "mem_27772") != 0)
            return 1;
        
        struct memblock_device mem_27779;
        
        mem_27779.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27779, 4, "mem_27779")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27781;
        
        mem_27781.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27781, bytes_27663, "mem_27781")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mainzicounter_mem_28477 =
                               ctx->mainzicounter_mem_28477;
        struct memblock_device group_res_arr_mem_28479;
        
        group_res_arr_mem_28479.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28479,
                                  (int32_t) sizeof(float) *
                                  (segred_group_sizze_25455 * num_groups_25456),
                                  "group_res_arr_mem_28479")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28481;
        
        num_threads_28481 = num_groups_25456 * segred_group_sizze_25455;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                1, (int32_t) sizeof(float) *
                                                segred_group_sizze_25455,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                3, sizeof(n_23343), &n_23343));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                4, sizeof(paths_23346),
                                                &paths_23346));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                5, sizeof(steps_23347),
                                                &steps_23347));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                6, sizeof(a_23351), &a_23351));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                7, sizeof(x_23371), &x_23371));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                8, sizeof(x_23373), &x_23373));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                9, sizeof(y_23375), &y_23375));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                10, sizeof(y_23376), &y_23376));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                11, sizeof(sims_per_year_23441),
                                                &sims_per_year_23441));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                12, sizeof(res_23769),
                                                &res_23769));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                13, sizeof(num_groups_25456),
                                                &num_groups_25456));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                14, sizeof(mem_27776.mem),
                                                &mem_27776.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                15, sizeof(mem_27779.mem),
                                                &mem_27779.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                16, sizeof(mem_27781.mem),
                                                &mem_27781.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                17,
                                                sizeof(mainzicounter_mem_28477.mem),
                                                &mainzicounter_mem_28477.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                18,
                                                sizeof(group_res_arr_mem_28479.mem),
                                                &group_res_arr_mem_28479.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25453,
                                                19, sizeof(num_threads_28481),
                                                &num_threads_28481));
        if (1 * ((size_t) num_groups_25456 *
                 (size_t) segred_group_sizze_25455) != 0) {
            const size_t global_work_sizze_28829[1] =
                         {(size_t) num_groups_25456 *
                         (size_t) segred_group_sizze_25455};
            const size_t local_work_sizze_28833[1] = {segred_group_sizze_25455};
            int64_t time_start_28830 = 0, time_end_28831 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segred_nonseg_25453");
                fprintf(stderr, "%zu", global_work_sizze_28829[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28833[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(float) *
                               segred_group_sizze_25455 +
                               (int32_t) sizeof(bool)));
                time_start_28830 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegred_nonseg_25453,
                                                            1, NULL,
                                                            global_work_sizze_28829,
                                                            local_work_sizze_28833,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegred_nonseg_25453_runs,
                                                                                                      &ctx->mainzisegred_nonseg_25453_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28831 = get_wall_time();
                
                long time_diff_28832 = time_end_28831 - time_start_28830;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segred_nonseg_25453", time_diff_28832);
            }
        }
        if (memblock_unref_device(ctx, &mem_27776, "mem_27776") != 0)
            return 1;
        
        float read_res_28834;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27779.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(float),
                                                     sizeof(float),
                                                     &read_res_28834, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        float res_25495 = read_res_28834;
        
        if (memblock_unref_device(ctx, &mem_27779, "mem_27779") != 0)
            return 1;
        
        struct memblock_device mem_27821;
        
        mem_27821.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27821, bytes_27663, "mem_27821")) {
            err = 1;
            goto cleanup;
        }
        if (steps_23347 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27781.mem,
                                                         mem_27821.mem, 0, 0,
                                                         steps_23347 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        if (memblock_unref_device(ctx, &mem_27781, "mem_27781") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27823, &mem_27821, "mem_27821") !=
            0)
            return 1;
        res_23786 = res_25495;
        if (memblock_unref_device(ctx, &mem_27821, "mem_27821") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28479,
                                  "group_res_arr_mem_28479") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27781, "mem_27781") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27779, "mem_27779") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27776, "mem_27776") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27772, "mem_27772") != 0)
            return 1;
    } else {
        struct memblock_device res_map_acc_mem_27815;
        
        res_map_acc_mem_27815.references = NULL;
        
        struct memblock_device res_mem_27816;
        
        res_mem_27816.references = NULL;
        
        int32_t local_memory_capacity_28600;
        
        local_memory_capacity_28600 = ctx->opencl.max_local_memory;
        if ((sle64(0, sext_i32_i64(local_memory_capacity_28600)) && sle64(0,
                                                                          sext_i32_i64(local_memory_capacity_28600))) &&
            suff_outer_par_25728) {
            int64_t segmap_usable_groups_25740 = sdiv_up64(steps_23347,
                                                           segmap_group_sizze_25739);
            struct memblock_device mem_27785;
            
            mem_27785.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27785, bytes_27687,
                                      "mem_27785")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t group_sizze_28512;
            
            group_sizze_28512 = ctx->sizes.mainzigroup_sizze_28512;
            
            int64_t num_groups_28513;
            
            num_groups_28513 = sdiv_up64(steps_23347 * paths_23346 * n_23343,
                                         group_sizze_28512);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28509, 0,
                                                    sizeof(n_23343), &n_23343));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28509, 1,
                                                    sizeof(paths_23346),
                                                    &paths_23346));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28509, 2,
                                                    sizeof(steps_23347),
                                                    &steps_23347));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28509, 3,
                                                    sizeof(mem_27767.mem),
                                                    &mem_27767.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28509, 4,
                                                    sizeof(mem_27785.mem),
                                                    &mem_27785.mem));
            if (1 * ((size_t) num_groups_28513 * (size_t) group_sizze_28512) !=
                0) {
                const size_t global_work_sizze_28835[1] =
                             {(size_t) num_groups_28513 *
                             (size_t) group_sizze_28512};
                const size_t local_work_sizze_28839[1] = {group_sizze_28512};
                int64_t time_start_28836 = 0, time_end_28837 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.copy_28509");
                    fprintf(stderr, "%zu", global_work_sizze_28835[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_28839[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_28836 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainzicopy_28509,
                                                                1, NULL,
                                                                global_work_sizze_28835,
                                                                local_work_sizze_28839,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainzicopy_28509_runs,
                                                                                                          &ctx->mainzicopy_28509_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_28837 = get_wall_time();
                    
                    long time_diff_28838 = time_end_28837 - time_start_28836;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.copy_28509", time_diff_28838);
                }
            }
            
            struct memblock_device mem_27789;
            
            mem_27789.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27789, bytes_27773,
                                      "mem_27789")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27789, 0,
                                                      mem_27785, 0, 1,
                                                      paths_23346 * n_23343,
                                                      steps_23347) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref_device(ctx, &mem_27785, "mem_27785") != 0)
                return 1;
            
            struct memblock_device mem_27792;
            
            mem_27792.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27792, bytes_27663,
                                      "mem_27792")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_27794;
            
            mem_27794.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27794, bytes_27663,
                                      "mem_27794")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegMap");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25508, 1,
                                                    sizeof(n_23343), &n_23343));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25508, 2,
                                                    sizeof(paths_23346),
                                                    &paths_23346));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25508, 3,
                                                    sizeof(steps_23347),
                                                    &steps_23347));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25508, 4,
                                                    sizeof(a_23351), &a_23351));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25508, 5,
                                                    sizeof(x_23371), &x_23371));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25508, 6,
                                                    sizeof(x_23373), &x_23373));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25508, 7,
                                                    sizeof(y_23375), &y_23375));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25508, 8,
                                                    sizeof(y_23376), &y_23376));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25508, 9,
                                                    sizeof(sims_per_year_23441),
                                                    &sims_per_year_23441));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25508, 10,
                                                    sizeof(res_23769),
                                                    &res_23769));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25508, 11,
                                                    sizeof(mem_27789.mem),
                                                    &mem_27789.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25508, 12,
                                                    sizeof(mem_27792.mem),
                                                    &mem_27792.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25508, 13,
                                                    sizeof(mem_27794.mem),
                                                    &mem_27794.mem));
            if (1 * ((size_t) segmap_usable_groups_25740 *
                     (size_t) segmap_group_sizze_25739) != 0) {
                const size_t global_work_sizze_28840[1] =
                             {(size_t) segmap_usable_groups_25740 *
                             (size_t) segmap_group_sizze_25739};
                const size_t local_work_sizze_28844[1] =
                             {segmap_group_sizze_25739};
                int64_t time_start_28841 = 0, time_end_28842 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.segmap_25508");
                    fprintf(stderr, "%zu", global_work_sizze_28840[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_28844[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_28841 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainzisegmap_25508,
                                                                1, NULL,
                                                                global_work_sizze_28840,
                                                                local_work_sizze_28844,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainzisegmap_25508_runs,
                                                                                                          &ctx->mainzisegmap_25508_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_28842 = get_wall_time();
                    
                    long time_diff_28843 = time_end_28842 - time_start_28841;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.segmap_25508", time_diff_28843);
                }
            }
            if (memblock_unref_device(ctx, &mem_27789, "mem_27789") != 0)
                return 1;
            if (memblock_set_device(ctx, &res_map_acc_mem_27815, &mem_27792,
                                    "mem_27792") != 0)
                return 1;
            if (memblock_set_device(ctx, &res_mem_27816, &mem_27794,
                                    "mem_27794") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27794, "mem_27794") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27792, "mem_27792") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27789, "mem_27789") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27785, "mem_27785") != 0)
                return 1;
        } else {
            struct memblock_device res_map_acc_mem_27813;
            
            res_map_acc_mem_27813.references = NULL;
            
            struct memblock_device res_mem_27814;
            
            res_mem_27814.references = NULL;
            
            int32_t local_memory_capacity_28599;
            
            local_memory_capacity_28599 = ctx->opencl.max_local_memory;
            if (sle64((int32_t) sizeof(float) * paths_23346,
                      sext_i32_i64(local_memory_capacity_28599)) &&
                intra_suff_and_fits_25735) {
                struct memblock_device mem_27798;
                
                mem_27798.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27798, bytes_27663,
                                          "mem_27798")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_27800;
                
                mem_27800.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27800, bytes_27663,
                                          "mem_27800")) {
                    err = 1;
                    goto cleanup;
                }
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25506,
                                                        1,
                                                        (int32_t) sizeof(float) *
                                                        paths_23346, NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25506,
                                                        2, sizeof(n_23343),
                                                        &n_23343));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25506,
                                                        3, sizeof(paths_23346),
                                                        &paths_23346));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25506,
                                                        4, sizeof(a_23351),
                                                        &a_23351));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25506,
                                                        5, sizeof(x_23371),
                                                        &x_23371));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25506,
                                                        6, sizeof(x_23373),
                                                        &x_23373));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25506,
                                                        7, sizeof(y_23375),
                                                        &y_23375));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25506,
                                                        8, sizeof(y_23376),
                                                        &y_23376));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25506,
                                                        9,
                                                        sizeof(sims_per_year_23441),
                                                        &sims_per_year_23441));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25506,
                                                        10, sizeof(res_23769),
                                                        &res_23769));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25506,
                                                        11,
                                                        sizeof(one_intra_par_min_24642),
                                                        &one_intra_par_min_24642));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25506,
                                                        12,
                                                        sizeof(mem_27767.mem),
                                                        &mem_27767.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25506,
                                                        13,
                                                        sizeof(mem_27798.mem),
                                                        &mem_27798.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25506,
                                                        14,
                                                        sizeof(mem_27800.mem),
                                                        &mem_27800.mem));
                if (1 * ((size_t) steps_23347 * (size_t) paths_23346) != 0) {
                    const size_t global_work_sizze_28845[1] =
                                 {(size_t) steps_23347 * (size_t) paths_23346};
                    const size_t local_work_sizze_28849[1] = {paths_23346};
                    int64_t time_start_28846 = 0, time_end_28847 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.segmap_intragroup_25506");
                        fprintf(stderr, "%zu", global_work_sizze_28845[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_28849[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(float) *
                                       paths_23346));
                        time_start_28846 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainzisegmap_intragroup_25506,
                                                                    1, NULL,
                                                                    global_work_sizze_28845,
                                                                    local_work_sizze_28849,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainzisegmap_intragroup_25506_runs,
                                                                                                              &ctx->mainzisegmap_intragroup_25506_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_28847 = get_wall_time();
                        
                        long time_diff_28848 = time_end_28847 -
                             time_start_28846;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.segmap_intragroup_25506",
                                time_diff_28848);
                    }
                }
                if (memblock_set_device(ctx, &res_map_acc_mem_27813, &mem_27798,
                                        "mem_27798") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_mem_27814, &mem_27800,
                                        "mem_27800") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27800, "mem_27800") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27798, "mem_27798") != 0)
                    return 1;
            } else {
                struct memblock_device mem_27804;
                
                mem_27804.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27804, bytes_27773,
                                          "mem_27804")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27804, 0,
                                                          mem_27767, 0, 1,
                                                          n_23343, paths_23346 *
                                                          steps_23347) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_27807;
                
                mem_27807.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27807, bytes_27663,
                                          "mem_27807")) {
                    err = 1;
                    goto cleanup;
                }
                if (slt64(paths_23346 * 2, segred_group_sizze_25813)) {
                    int64_t segment_sizze_nonzzero_28532 = smax64(1,
                                                                  paths_23346);
                    int64_t num_threads_28533 = num_groups_25814 *
                            segred_group_sizze_25813;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-small");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) steps_23347, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) paths_23346, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segments_per_group",
                                (long long) squot64(segred_group_sizze_25813,
                                                    segment_sizze_nonzzero_28532),
                                '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "required_groups",
                                (long long) sext_i64_i32(sdiv_up64(steps_23347,
                                                                   squot64(segred_group_sizze_25813,
                                                                           segment_sizze_nonzzero_28532))),
                                '\n');
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25658,
                                                            1,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_25813,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25658,
                                                            2, sizeof(n_23343),
                                                            &n_23343));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25658,
                                                            3,
                                                            sizeof(paths_23346),
                                                            &paths_23346));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25658,
                                                            4,
                                                            sizeof(steps_23347),
                                                            &steps_23347));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25658,
                                                            5,
                                                            sizeof(num_groups_25814),
                                                            &num_groups_25814));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25658,
                                                            6,
                                                            sizeof(mem_27804.mem),
                                                            &mem_27804.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25658,
                                                            7,
                                                            sizeof(mem_27807.mem),
                                                            &mem_27807.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25658,
                                                            8,
                                                            sizeof(segment_sizze_nonzzero_28532),
                                                            &segment_sizze_nonzzero_28532));
                    if (1 * ((size_t) num_groups_25814 *
                             (size_t) segred_group_sizze_25813) != 0) {
                        const size_t global_work_sizze_28850[1] =
                                     {(size_t) num_groups_25814 *
                                     (size_t) segred_group_sizze_25813};
                        const size_t local_work_sizze_28854[1] =
                                     {segred_group_sizze_25813};
                        int64_t time_start_28851 = 0, time_end_28852 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.segred_small_25658");
                            fprintf(stderr, "%zu", global_work_sizze_28850[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_28854[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(float) *
                                           segred_group_sizze_25813));
                            time_start_28851 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainzisegred_small_25658,
                                                                        1, NULL,
                                                                        global_work_sizze_28850,
                                                                        local_work_sizze_28854,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainzisegred_small_25658_runs,
                                                                                                                  &ctx->mainzisegred_small_25658_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_28852 = get_wall_time();
                            
                            long time_diff_28853 = time_end_28852 -
                                 time_start_28851;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.segred_small_25658", time_diff_28853);
                        }
                    }
                } else {
                    int64_t groups_per_segment_28554 =
                            sdiv_up64(num_groups_25814, smax64(1, steps_23347));
                    int64_t elements_per_thread_28555 = sdiv_up64(paths_23346,
                                                                  segred_group_sizze_25813 *
                                                                  groups_per_segment_28554);
                    int64_t virt_num_groups_28556 = groups_per_segment_28554 *
                            steps_23347;
                    int64_t num_threads_28557 = num_groups_25814 *
                            segred_group_sizze_25813;
                    int64_t threads_per_segment_28558 =
                            groups_per_segment_28554 * segred_group_sizze_25813;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-large");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) steps_23347, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) paths_23346, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                                (long long) virt_num_groups_28556, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_groups",
                                (long long) num_groups_25814, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "group_size",
                                (long long) segred_group_sizze_25813, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                                (long long) elements_per_thread_28555, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                                (long long) groups_per_segment_28554, '\n');
                    
                    struct memblock_device group_res_arr_mem_28559;
                    
                    group_res_arr_mem_28559.references = NULL;
                    if (memblock_alloc_device(ctx, &group_res_arr_mem_28559,
                                              (int32_t) sizeof(float) *
                                              (segred_group_sizze_25813 *
                                               virt_num_groups_28556),
                                              "group_res_arr_mem_28559")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device mainzicounter_mem_28561 =
                                           ctx->mainzicounter_mem_28561;
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25658,
                                                            1,
                                                            (int32_t) sizeof(bool),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25658,
                                                            2,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_25813,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25658,
                                                            3, sizeof(n_23343),
                                                            &n_23343));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25658,
                                                            4,
                                                            sizeof(paths_23346),
                                                            &paths_23346));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25658,
                                                            5,
                                                            sizeof(steps_23347),
                                                            &steps_23347));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25658,
                                                            6,
                                                            sizeof(num_groups_25814),
                                                            &num_groups_25814));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25658,
                                                            7,
                                                            sizeof(mem_27804.mem),
                                                            &mem_27804.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25658,
                                                            8,
                                                            sizeof(mem_27807.mem),
                                                            &mem_27807.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25658,
                                                            9,
                                                            sizeof(groups_per_segment_28554),
                                                            &groups_per_segment_28554));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25658,
                                                            10,
                                                            sizeof(elements_per_thread_28555),
                                                            &elements_per_thread_28555));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25658,
                                                            11,
                                                            sizeof(virt_num_groups_28556),
                                                            &virt_num_groups_28556));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25658,
                                                            12,
                                                            sizeof(threads_per_segment_28558),
                                                            &threads_per_segment_28558));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25658,
                                                            13,
                                                            sizeof(group_res_arr_mem_28559.mem),
                                                            &group_res_arr_mem_28559.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25658,
                                                            14,
                                                            sizeof(mainzicounter_mem_28561.mem),
                                                            &mainzicounter_mem_28561.mem));
                    if (1 * ((size_t) num_groups_25814 *
                             (size_t) segred_group_sizze_25813) != 0) {
                        const size_t global_work_sizze_28856[1] =
                                     {(size_t) num_groups_25814 *
                                     (size_t) segred_group_sizze_25813};
                        const size_t local_work_sizze_28860[1] =
                                     {segred_group_sizze_25813};
                        int64_t time_start_28857 = 0, time_end_28858 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.segred_large_25658");
                            fprintf(stderr, "%zu", global_work_sizze_28856[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_28860[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(bool) +
                                           (int32_t) sizeof(float) *
                                           segred_group_sizze_25813));
                            time_start_28857 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainzisegred_large_25658,
                                                                        1, NULL,
                                                                        global_work_sizze_28856,
                                                                        local_work_sizze_28860,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainzisegred_large_25658_runs,
                                                                                                                  &ctx->mainzisegred_large_25658_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_28858 = get_wall_time();
                            
                            long time_diff_28859 = time_end_28858 -
                                 time_start_28857;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.segred_large_25658", time_diff_28859);
                        }
                    }
                    if (memblock_unref_device(ctx, &group_res_arr_mem_28559,
                                              "group_res_arr_mem_28559") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_27804, "mem_27804") != 0)
                    return 1;
                
                int64_t segmap_usable_groups_25830 = sdiv_up64(steps_23347,
                                                               segmap_group_sizze_25829);
                struct memblock_device mem_27810;
                
                mem_27810.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27810, bytes_27663,
                                          "mem_27810")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_27812;
                
                mem_27812.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27812, bytes_27663,
                                          "mem_27812")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25623,
                                                        1, sizeof(steps_23347),
                                                        &steps_23347));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25623,
                                                        2, sizeof(a_23351),
                                                        &a_23351));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25623,
                                                        3, sizeof(x_23371),
                                                        &x_23371));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25623,
                                                        4, sizeof(x_23373),
                                                        &x_23373));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25623,
                                                        5, sizeof(y_23375),
                                                        &y_23375));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25623,
                                                        6, sizeof(y_23376),
                                                        &y_23376));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25623,
                                                        7,
                                                        sizeof(sims_per_year_23441),
                                                        &sims_per_year_23441));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25623,
                                                        8, sizeof(res_23769),
                                                        &res_23769));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25623,
                                                        9,
                                                        sizeof(mem_27807.mem),
                                                        &mem_27807.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25623,
                                                        10,
                                                        sizeof(mem_27810.mem),
                                                        &mem_27810.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25623,
                                                        11,
                                                        sizeof(mem_27812.mem),
                                                        &mem_27812.mem));
                if (1 * ((size_t) segmap_usable_groups_25830 *
                         (size_t) segmap_group_sizze_25829) != 0) {
                    const size_t global_work_sizze_28861[1] =
                                 {(size_t) segmap_usable_groups_25830 *
                                 (size_t) segmap_group_sizze_25829};
                    const size_t local_work_sizze_28865[1] =
                                 {segmap_group_sizze_25829};
                    int64_t time_start_28862 = 0, time_end_28863 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.segmap_25623");
                        fprintf(stderr, "%zu", global_work_sizze_28861[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_28865[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_28862 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainzisegmap_25623,
                                                                    1, NULL,
                                                                    global_work_sizze_28861,
                                                                    local_work_sizze_28865,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainzisegmap_25623_runs,
                                                                                                              &ctx->mainzisegmap_25623_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_28863 = get_wall_time();
                        
                        long time_diff_28864 = time_end_28863 -
                             time_start_28862;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.segmap_25623", time_diff_28864);
                    }
                }
                if (memblock_unref_device(ctx, &mem_27807, "mem_27807") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_27813, &mem_27810,
                                        "mem_27810") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_mem_27814, &mem_27812,
                                        "mem_27812") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27812, "mem_27812") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27810, "mem_27810") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27807, "mem_27807") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27804, "mem_27804") != 0)
                    return 1;
            }
            if (memblock_set_device(ctx, &res_map_acc_mem_27815,
                                    &res_map_acc_mem_27813,
                                    "res_map_acc_mem_27813") != 0)
                return 1;
            if (memblock_set_device(ctx, &res_mem_27816, &res_mem_27814,
                                    "res_mem_27814") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27814, "res_mem_27814") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_map_acc_mem_27813,
                                      "res_map_acc_mem_27813") != 0)
                return 1;
        }
        
        struct memblock_device mem_27819;
        
        mem_27819.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27819, 4, "mem_27819")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mainzicounter_mem_28601 =
                               ctx->mainzicounter_mem_28601;
        struct memblock_device group_res_arr_mem_28603;
        
        group_res_arr_mem_28603.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28603,
                                  (int32_t) sizeof(float) *
                                  (segred_group_sizze_25857 * num_groups_25858),
                                  "group_res_arr_mem_28603")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28605;
        
        num_threads_28605 = num_groups_25858 * segred_group_sizze_25857;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25726,
                                                1, (int32_t) sizeof(float) *
                                                segred_group_sizze_25857,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25726,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25726,
                                                3, sizeof(steps_23347),
                                                &steps_23347));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25726,
                                                4, sizeof(num_groups_25858),
                                                &num_groups_25858));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25726,
                                                5,
                                                sizeof(res_map_acc_mem_27815.mem),
                                                &res_map_acc_mem_27815.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25726,
                                                6, sizeof(mem_27819.mem),
                                                &mem_27819.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25726,
                                                7,
                                                sizeof(mainzicounter_mem_28601.mem),
                                                &mainzicounter_mem_28601.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25726,
                                                8,
                                                sizeof(group_res_arr_mem_28603.mem),
                                                &group_res_arr_mem_28603.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25726,
                                                9, sizeof(num_threads_28605),
                                                &num_threads_28605));
        if (1 * ((size_t) num_groups_25858 *
                 (size_t) segred_group_sizze_25857) != 0) {
            const size_t global_work_sizze_28867[1] =
                         {(size_t) num_groups_25858 *
                         (size_t) segred_group_sizze_25857};
            const size_t local_work_sizze_28871[1] = {segred_group_sizze_25857};
            int64_t time_start_28868 = 0, time_end_28869 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segred_nonseg_25726");
                fprintf(stderr, "%zu", global_work_sizze_28867[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28871[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(float) *
                               segred_group_sizze_25857 +
                               (int32_t) sizeof(bool)));
                time_start_28868 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegred_nonseg_25726,
                                                            1, NULL,
                                                            global_work_sizze_28867,
                                                            local_work_sizze_28871,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegred_nonseg_25726_runs,
                                                                                                      &ctx->mainzisegred_nonseg_25726_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28869 = get_wall_time();
                
                long time_diff_28870 = time_end_28869 - time_start_28868;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segred_nonseg_25726", time_diff_28870);
            }
        }
        if (memblock_unref_device(ctx, &res_map_acc_mem_27815,
                                  "res_map_acc_mem_27815") != 0)
            return 1;
        
        float read_res_28872;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27819.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(float),
                                                     sizeof(float),
                                                     &read_res_28872, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        float res_25865 = read_res_28872;
        
        if (memblock_unref_device(ctx, &mem_27819, "mem_27819") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27823, &res_mem_27816,
                                "res_mem_27816") != 0)
            return 1;
        res_23786 = res_25865;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28603,
                                  "group_res_arr_mem_28603") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27819, "mem_27819") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27816, "res_mem_27816") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_map_acc_mem_27815,
                                  "res_map_acc_mem_27815") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_27767, "mem_27767") != 0)
        return 1;
    
    float CVA_23825 = 6.0e-3F * res_23786;
    
    out_arrsizze_27874 = steps_23347;
    if (memblock_set_device(ctx, &out_mem_27873, &res_mem_27823,
                            "res_mem_27823") != 0)
        return 1;
    scalar_out_27872 = CVA_23825;
    *out_scalar_out_28663 = scalar_out_27872;
    (*out_mem_p_28664).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_28664, &out_mem_27873,
                            "out_mem_27873") != 0)
        return 1;
    *out_out_arrsizze_28665 = out_arrsizze_27874;
    if (memblock_unref_device(ctx, &res_mem_27823, "res_mem_27823") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27767, "mem_27767") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27765, "mem_27765") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27762, "mem_27762") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27760, "mem_27760") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27757, "mem_27757") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27755, "mem_27755") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27753, "mem_27753") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27750, "mem_27750") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27748, "mem_27748") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_subhistos_mem_28057,
                              "res_subhistos_mem_28057") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27744, "mem_27744") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_28018,
                              "group_res_arr_mem_28018") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27742, "mem_27742") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27739, "mem_27739") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27737, "mem_27737") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27734, "res_mem_27734") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27733, "res_mem_27733") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27659, "res_mem_27659") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27658, "res_mem_27658") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27657, "res_mem_27657") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_27878,
                              "group_res_arr_mem_27878") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_27873, "out_mem_27873") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
static int futrts_test(struct futhark_context *ctx, float *out_scalar_out_28873,
                       int64_t paths_23826, int64_t steps_23827)
{
    (void) ctx;
    
    int err = 0;
    float scalar_out_27872;
    struct memblock_device mem_27634;
    
    mem_27634.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27634, 180, "mem_27634")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzistatic_array_27873 =
                           ctx->testzistatic_array_27873;
    
    if (45 * (int32_t) sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     testzistatic_array_27873.mem,
                                                     mem_27634.mem, 0, 0, 45 *
                                                     (int32_t) sizeof(float), 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    
    struct memblock_device mem_27636;
    
    mem_27636.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27636, 360, "mem_27636")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzistatic_array_27874 =
                           ctx->testzistatic_array_27874;
    
    if (45 * (int32_t) sizeof(int64_t) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     testzistatic_array_27874.mem,
                                                     mem_27636.mem, 0, 0, 45 *
                                                     (int32_t) sizeof(int64_t),
                                                     0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    
    struct memblock_device mem_27638;
    
    mem_27638.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27638, 180, "mem_27638")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzistatic_array_27875 =
                           ctx->testzistatic_array_27875;
    
    if (45 * (int32_t) sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     testzistatic_array_27875.mem,
                                                     mem_27638.mem, 0, 0, 45 *
                                                     (int32_t) sizeof(float), 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    
    int64_t segred_group_sizze_25870;
    
    segred_group_sizze_25870 = ctx->sizes.testzisegred_group_sizze_25869;
    
    int64_t num_groups_25872;
    int32_t max_num_groups_27876;
    
    max_num_groups_27876 = ctx->sizes.testzisegred_num_groups_25871;
    num_groups_25872 = sext_i64_i32(smax64(1, smin64(sdiv_up64(45,
                                                               sext_i32_i64(segred_group_sizze_25870)),
                                                     sext_i32_i64(max_num_groups_27876))));
    
    struct memblock_device mem_27641;
    
    mem_27641.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27641, 4, "mem_27641")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzicounter_mem_27877 =
                           ctx->testzicounter_mem_27877;
    struct memblock_device group_res_arr_mem_27879;
    
    group_res_arr_mem_27879.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_27879,
                              (int32_t) sizeof(float) *
                              (segred_group_sizze_25870 * num_groups_25872),
                              "group_res_arr_mem_27879")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_27881;
    
    num_threads_27881 = num_groups_25872 * segred_group_sizze_25870;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25877, 1,
                                            (int32_t) sizeof(float) *
                                            segred_group_sizze_25870, NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25877, 2,
                                            (int32_t) sizeof(bool), NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25877, 3,
                                            sizeof(num_groups_25872),
                                            &num_groups_25872));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25877, 4,
                                            sizeof(mem_27636.mem),
                                            &mem_27636.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25877, 5,
                                            sizeof(mem_27638.mem),
                                            &mem_27638.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25877, 6,
                                            sizeof(mem_27641.mem),
                                            &mem_27641.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25877, 7,
                                            sizeof(testzicounter_mem_27877.mem),
                                            &testzicounter_mem_27877.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25877, 8,
                                            sizeof(group_res_arr_mem_27879.mem),
                                            &group_res_arr_mem_27879.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25877, 9,
                                            sizeof(num_threads_27881),
                                            &num_threads_27881));
    if (1 * ((size_t) num_groups_25872 * (size_t) segred_group_sizze_25870) !=
        0) {
        const size_t global_work_sizze_28878[1] = {(size_t) num_groups_25872 *
                     (size_t) segred_group_sizze_25870};
        const size_t local_work_sizze_28882[1] = {segred_group_sizze_25870};
        int64_t time_start_28879 = 0, time_end_28880 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segred_nonseg_25877");
            fprintf(stderr, "%zu", global_work_sizze_28878[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_28882[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) (0 + (int32_t) sizeof(float) *
                           segred_group_sizze_25870 + (int32_t) sizeof(bool)));
            time_start_28879 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegred_nonseg_25877,
                                                        1, NULL,
                                                        global_work_sizze_28878,
                                                        local_work_sizze_28882,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegred_nonseg_25877_runs,
                                                                                                  &ctx->testzisegred_nonseg_25877_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_28880 = get_wall_time();
            
            long time_diff_28881 = time_end_28880 - time_start_28879;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "test.segred_nonseg_25877", time_diff_28881);
        }
    }
    
    float read_res_28883;
    
    OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                 mem_27641.mem,
                                                 ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                 0 * sizeof(float),
                                                 sizeof(float), &read_res_28883,
                                                 0, NULL,
                                                 ctx->profiling_paused ||
                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                           &ctx->copy_scalar_from_dev_runs,
                                                                                           &ctx->copy_scalar_from_dev_total_runtime)));
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
        return 1;
    
    float res_23831 = read_res_28883;
    
    if (memblock_unref_device(ctx, &mem_27641, "mem_27641") != 0)
        return 1;
    
    float res_23839 = sitofp_i64_f32(steps_23827);
    float dt_23840 = res_23831 / res_23839;
    bool suff_outer_par_25879;
    
    suff_outer_par_25879 = ctx->sizes.testzisuff_outer_par_0 <= 45;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_outer_par_0", 45);
    
    int64_t segmap_group_sizze_25947;
    
    segmap_group_sizze_25947 = ctx->sizes.testzisegmap_group_sizze_25883;
    
    int64_t segmap_group_sizze_26096;
    
    segmap_group_sizze_26096 = ctx->sizes.testzisegmap_group_sizze_26032;
    
    struct memblock_device res_mem_27660;
    
    res_mem_27660.references = NULL;
    
    struct memblock_device res_mem_27661;
    
    res_mem_27661.references = NULL;
    
    struct memblock_device res_mem_27662;
    
    res_mem_27662.references = NULL;
    
    struct memblock_device res_mem_27663;
    
    res_mem_27663.references = NULL;
    
    int32_t local_memory_capacity_27919;
    
    local_memory_capacity_27919 = ctx->opencl.max_local_memory;
    if (sle64(0, sext_i32_i64(local_memory_capacity_27919)) &&
        suff_outer_par_25879) {
        int64_t segmap_usable_groups_25948 = sdiv_up64(45,
                                                       segmap_group_sizze_25947);
        struct memblock_device mem_27643;
        
        mem_27643.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27643, 180, "mem_27643")) {
            err = 1;
            goto cleanup;
        }
        if (45 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27638.mem,
                                                         mem_27643.mem, 0, 0,
                                                         45 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27645;
        
        mem_27645.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27645, 360, "mem_27645")) {
            err = 1;
            goto cleanup;
        }
        if (45 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27636.mem,
                                                         mem_27645.mem, 0, 0,
                                                         45 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27647;
        
        mem_27647.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27647, 180, "mem_27647")) {
            err = 1;
            goto cleanup;
        }
        if (45 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27634.mem,
                                                         mem_27647.mem, 0, 0,
                                                         45 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27650;
        
        mem_27650.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27650, 180, "mem_27650")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_25881, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_25881, 3,
                                                sizeof(mem_27636.mem),
                                                &mem_27636.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_25881, 4,
                                                sizeof(mem_27638.mem),
                                                &mem_27638.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_25881, 5,
                                                sizeof(mem_27650.mem),
                                                &mem_27650.mem));
        if (1 * ((size_t) segmap_usable_groups_25948 *
                 (size_t) segmap_group_sizze_25947) != 0) {
            const size_t global_work_sizze_28884[1] =
                         {(size_t) segmap_usable_groups_25948 *
                         (size_t) segmap_group_sizze_25947};
            const size_t local_work_sizze_28888[1] = {segmap_group_sizze_25947};
            int64_t time_start_28885 = 0, time_end_28886 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_25881");
                fprintf(stderr, "%zu", global_work_sizze_28884[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28888[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28885 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_25881,
                                                            1, NULL,
                                                            global_work_sizze_28884,
                                                            local_work_sizze_28888,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_25881_runs,
                                                                                                      &ctx->testzisegmap_25881_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28886 = get_wall_time();
                
                long time_diff_28887 = time_end_28886 - time_start_28885;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_25881", time_diff_28887);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_set_device(ctx, &res_mem_27660, &mem_27650, "mem_27650") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27661, &mem_27647, "mem_27647") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27662, &mem_27645, "mem_27645") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27663, &mem_27643, "mem_27643") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27650, "mem_27650") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27647, "mem_27647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27645, "mem_27645") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27643, "mem_27643") != 0)
            return 1;
    } else {
        int64_t segmap_usable_groups_26097 = sdiv_up64(45,
                                                       segmap_group_sizze_26096);
        struct memblock_device mem_27652;
        
        mem_27652.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27652, 180, "mem_27652")) {
            err = 1;
            goto cleanup;
        }
        if (45 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27638.mem,
                                                         mem_27652.mem, 0, 0,
                                                         45 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27654;
        
        mem_27654.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27654, 360, "mem_27654")) {
            err = 1;
            goto cleanup;
        }
        if (45 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27636.mem,
                                                         mem_27654.mem, 0, 0,
                                                         45 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27656;
        
        mem_27656.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27656, 180, "mem_27656")) {
            err = 1;
            goto cleanup;
        }
        if (45 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27634.mem,
                                                         mem_27656.mem, 0, 0,
                                                         45 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27659;
        
        mem_27659.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27659, 180, "mem_27659")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26030, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26030, 3,
                                                sizeof(mem_27636.mem),
                                                &mem_27636.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26030, 4,
                                                sizeof(mem_27638.mem),
                                                &mem_27638.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26030, 5,
                                                sizeof(mem_27659.mem),
                                                &mem_27659.mem));
        if (1 * ((size_t) segmap_usable_groups_26097 *
                 (size_t) segmap_group_sizze_26096) != 0) {
            const size_t global_work_sizze_28889[1] =
                         {(size_t) segmap_usable_groups_26097 *
                         (size_t) segmap_group_sizze_26096};
            const size_t local_work_sizze_28893[1] = {segmap_group_sizze_26096};
            int64_t time_start_28890 = 0, time_end_28891 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_26030");
                fprintf(stderr, "%zu", global_work_sizze_28889[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28893[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28890 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_26030,
                                                            1, NULL,
                                                            global_work_sizze_28889,
                                                            local_work_sizze_28893,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_26030_runs,
                                                                                                      &ctx->testzisegmap_26030_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28891 = get_wall_time();
                
                long time_diff_28892 = time_end_28891 - time_start_28890;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_26030", time_diff_28892);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_set_device(ctx, &res_mem_27660, &mem_27659, "mem_27659") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27661, &mem_27656, "mem_27656") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27662, &mem_27654, "mem_27654") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27663, &mem_27652, "mem_27652") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27659, "mem_27659") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27656, "mem_27656") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27654, "mem_27654") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27652, "mem_27652") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_27634, "mem_27634") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27636, "mem_27636") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
        return 1;
    
    float sims_per_year_23906 = res_23839 / res_23831;
    bool bounds_invalid_upwards_23907 = slt64(steps_23827, 1);
    bool valid_23908 = !bounds_invalid_upwards_23907;
    bool range_valid_c_23909;
    
    if (!valid_23908) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 1, "..", 2, "...", steps_23827,
                               " is invalid.",
                               "-> #0  cva3d.fut:60:56-67\n   #1  cva3d.fut:111:17-44\n   #2  cva3d.fut:154:3-156:129\n   #3  cva3d.fut:153:1-156:137\n");
        if (memblock_unref_device(ctx, &res_mem_27663, "res_mem_27663") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27662, "res_mem_27662") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27661, "res_mem_27661") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27879,
                                  "group_res_arr_mem_27879") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27641, "mem_27641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27636, "mem_27636") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27634, "mem_27634") != 0)
            return 1;
        return 1;
    }
    
    bool bounds_invalid_upwards_23915 = slt64(paths_23826, 0);
    bool valid_23916 = !bounds_invalid_upwards_23915;
    bool range_valid_c_23917;
    
    if (!valid_23916) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", paths_23826,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:126:11-16\n   #2  lib/github.com/diku-dk/cpprandom/random.fut:174:8-56\n   #3  cva3d.fut:115:19-49\n   #4  cva3d.fut:154:3-156:129\n   #5  cva3d.fut:153:1-156:137\n");
        if (memblock_unref_device(ctx, &res_mem_27663, "res_mem_27663") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27662, "res_mem_27662") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27661, "res_mem_27661") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27879,
                                  "group_res_arr_mem_27879") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27641, "mem_27641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27636, "mem_27636") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27634, "mem_27634") != 0)
            return 1;
        return 1;
    }
    
    int64_t upper_bound_23920 = sub64(steps_23827, 1);
    float res_23921;
    
    res_23921 = futrts_sqrt32(dt_23840);
    
    int64_t one_intra_par_min_26244 = 45 * steps_23827;
    int64_t intra_avail_par_26246 = smin64(steps_23827,
                                           one_intra_par_min_26244);
    int64_t computed_group_sizze_26204 = smax64(steps_23827,
                                                one_intra_par_min_26244);
    int64_t max_group_sizze_26396;
    
    max_group_sizze_26396 = ctx->opencl.max_group_size;
    
    bool fits_26397 = sle64(computed_group_sizze_26204, max_group_sizze_26396);
    bool suff_intra_par_26395;
    
    suff_intra_par_26395 = ctx->sizes.testzisuff_intra_par_3 <=
        intra_avail_par_26246;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_intra_par_3",
                intra_avail_par_26246);
    
    bool intra_suff_and_fits_26398 = suff_intra_par_26395 && fits_26397;
    int64_t segmap_group_sizze_26784;
    
    segmap_group_sizze_26784 = ctx->sizes.testzisegmap_group_sizze_26767;
    
    int64_t nest_sizze_26808 = paths_23826 * steps_23827;
    int64_t segmap_group_sizze_26809;
    
    segmap_group_sizze_26809 = ctx->sizes.testzisegmap_group_sizze_26704;
    
    int64_t segmap_group_sizze_26854;
    
    segmap_group_sizze_26854 = ctx->sizes.testzisegmap_group_sizze_26605;
    
    int64_t num_groups_26855;
    int32_t max_num_groups_27920;
    
    max_num_groups_27920 = ctx->sizes.testzisegmap_num_groups_26607;
    num_groups_26855 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_23826,
                                                               sext_i32_i64(segmap_group_sizze_26854)),
                                                     sext_i32_i64(max_num_groups_27920))));
    
    int64_t nest_sizze_26899 = paths_23826 * one_intra_par_min_26244;
    int64_t segmap_group_sizze_26900;
    
    segmap_group_sizze_26900 = ctx->sizes.testzisegmap_group_sizze_26550;
    
    int64_t segmap_group_sizze_26918;
    
    segmap_group_sizze_26918 = ctx->sizes.testzisegmap_group_sizze_26512;
    
    int64_t binop_x_27692 = 45 * nest_sizze_26808;
    int64_t bytes_27690 = 4 * binop_x_27692;
    int64_t bytes_27666 = 4 * steps_23827;
    int64_t bytes_27683 = 4 * one_intra_par_min_26244;
    int64_t bytes_27699 = 4 * paths_23826;
    int64_t bytes_27702 = 4 * nest_sizze_26808;
    int64_t num_threads_27854 = segmap_group_sizze_26854 * num_groups_26855;
    int64_t total_sizze_27855 = bytes_27666 * num_threads_27854;
    struct memblock_device res_mem_27736;
    
    res_mem_27736.references = NULL;
    
    struct memblock_device res_mem_27737;
    
    res_mem_27737.references = NULL;
    
    int32_t local_memory_capacity_27964;
    
    local_memory_capacity_27964 = ctx->opencl.max_local_memory;
    if (sle64(bytes_27666 + bytes_27666 + bytes_27683 + bytes_27683,
              sext_i32_i64(local_memory_capacity_27964)) &&
        intra_suff_and_fits_26398) {
        struct memblock_device mem_27693;
        
        mem_27693.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27693, bytes_27690, "mem_27693")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27697;
        
        mem_27697.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27697, bytes_27690, "mem_27697")) {
            err = 1;
            goto cleanup;
        }
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26247,
                                                1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26247,
                                                3, bytes_27683, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26247,
                                                4, bytes_27683, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26247,
                                                5, bytes_27666, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26247,
                                                6, bytes_27666, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26247,
                                                7, sizeof(steps_23827),
                                                &steps_23827));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26247,
                                                8, sizeof(dt_23840),
                                                &dt_23840));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26247,
                                                9, sizeof(sims_per_year_23906),
                                                &sims_per_year_23906));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26247,
                                                10, sizeof(upper_bound_23920),
                                                &upper_bound_23920));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26247,
                                                11, sizeof(res_23921),
                                                &res_23921));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26247,
                                                12,
                                                sizeof(computed_group_sizze_26204),
                                                &computed_group_sizze_26204));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26247,
                                                13, sizeof(mem_27693.mem),
                                                &mem_27693.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26247,
                                                14, sizeof(mem_27697.mem),
                                                &mem_27697.mem));
        if (1 * ((size_t) paths_23826 * (size_t) computed_group_sizze_26204) !=
            0) {
            const size_t global_work_sizze_28894[1] = {(size_t) paths_23826 *
                         (size_t) computed_group_sizze_26204};
            const size_t local_work_sizze_28898[1] =
                         {computed_group_sizze_26204};
            int64_t time_start_28895 = 0, time_end_28896 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_intragroup_26247");
                fprintf(stderr, "%zu", global_work_sizze_28894[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28898[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + bytes_27683 + bytes_27683 + bytes_27666 +
                               bytes_27666));
                time_start_28895 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_intragroup_26247,
                                                            1, NULL,
                                                            global_work_sizze_28894,
                                                            local_work_sizze_28898,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_intragroup_26247_runs,
                                                                                                      &ctx->testzisegmap_intragroup_26247_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28896 = get_wall_time();
                
                long time_diff_28897 = time_end_28896 - time_start_28895;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_intragroup_26247", time_diff_28897);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_set_device(ctx, &res_mem_27736, &mem_27693, "mem_27693") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27737, &mem_27697, "mem_27697") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27697, "mem_27697") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27693, "mem_27693") != 0)
            return 1;
    } else {
        int64_t segmap_usable_groups_26785 = sdiv_up64(paths_23826,
                                                       segmap_group_sizze_26784);
        struct memblock_device mem_27700;
        
        mem_27700.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27700, bytes_27699, "mem_27700")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26765, 1,
                                                sizeof(paths_23826),
                                                &paths_23826));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26765, 2,
                                                sizeof(mem_27700.mem),
                                                &mem_27700.mem));
        if (1 * ((size_t) segmap_usable_groups_26785 *
                 (size_t) segmap_group_sizze_26784) != 0) {
            const size_t global_work_sizze_28899[1] =
                         {(size_t) segmap_usable_groups_26785 *
                         (size_t) segmap_group_sizze_26784};
            const size_t local_work_sizze_28903[1] = {segmap_group_sizze_26784};
            int64_t time_start_28900 = 0, time_end_28901 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_26765");
                fprintf(stderr, "%zu", global_work_sizze_28899[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28903[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28900 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_26765,
                                                            1, NULL,
                                                            global_work_sizze_28899,
                                                            local_work_sizze_28903,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_26765_runs,
                                                                                                      &ctx->testzisegmap_26765_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28901 = get_wall_time();
                
                long time_diff_28902 = time_end_28901 - time_start_28900;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_26765", time_diff_28902);
            }
        }
        
        int64_t segmap_usable_groups_26810 = sdiv_up64(nest_sizze_26808,
                                                       segmap_group_sizze_26809);
        struct memblock_device mem_27704;
        
        mem_27704.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27704, bytes_27702, "mem_27704")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26701, 1,
                                                sizeof(paths_23826),
                                                &paths_23826));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26701, 2,
                                                sizeof(steps_23827),
                                                &steps_23827));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26701, 3,
                                                sizeof(mem_27700.mem),
                                                &mem_27700.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26701, 4,
                                                sizeof(mem_27704.mem),
                                                &mem_27704.mem));
        if (1 * ((size_t) segmap_usable_groups_26810 *
                 (size_t) segmap_group_sizze_26809) != 0) {
            const size_t global_work_sizze_28904[1] =
                         {(size_t) segmap_usable_groups_26810 *
                         (size_t) segmap_group_sizze_26809};
            const size_t local_work_sizze_28908[1] = {segmap_group_sizze_26809};
            int64_t time_start_28905 = 0, time_end_28906 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_26701");
                fprintf(stderr, "%zu", global_work_sizze_28904[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28908[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28905 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_26701,
                                                            1, NULL,
                                                            global_work_sizze_28904,
                                                            local_work_sizze_28908,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_26701_runs,
                                                                                                      &ctx->testzisegmap_26701_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28906 = get_wall_time();
                
                long time_diff_28907 = time_end_28906 - time_start_28905;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_26701", time_diff_28907);
            }
        }
        if (memblock_unref_device(ctx, &mem_27700, "mem_27700") != 0)
            return 1;
        
        struct memblock_device mem_27707;
        
        mem_27707.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27707, bytes_27702, "mem_27707")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27707, 0, mem_27704,
                                                  0, 1, steps_23827,
                                                  paths_23826) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_unref_device(ctx, &mem_27704, "mem_27704") != 0)
            return 1;
        
        struct memblock_device mem_27725;
        
        mem_27725.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27725, bytes_27702, "mem_27725")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27710;
        
        mem_27710.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27710, total_sizze_27855,
                                  "mem_27710")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26603, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26603, 3,
                                                sizeof(paths_23826),
                                                &paths_23826));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26603, 4,
                                                sizeof(steps_23827),
                                                &steps_23827));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26603, 5,
                                                sizeof(dt_23840), &dt_23840));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26603, 6,
                                                sizeof(upper_bound_23920),
                                                &upper_bound_23920));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26603, 7,
                                                sizeof(res_23921), &res_23921));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26603, 8,
                                                sizeof(num_groups_26855),
                                                &num_groups_26855));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26603, 9,
                                                sizeof(mem_27707.mem),
                                                &mem_27707.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26603, 10,
                                                sizeof(mem_27710.mem),
                                                &mem_27710.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26603, 11,
                                                sizeof(mem_27725.mem),
                                                &mem_27725.mem));
        if (1 * ((size_t) num_groups_26855 *
                 (size_t) segmap_group_sizze_26854) != 0) {
            const size_t global_work_sizze_28909[1] =
                         {(size_t) num_groups_26855 *
                         (size_t) segmap_group_sizze_26854};
            const size_t local_work_sizze_28913[1] = {segmap_group_sizze_26854};
            int64_t time_start_28910 = 0, time_end_28911 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_26603");
                fprintf(stderr, "%zu", global_work_sizze_28909[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28913[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28910 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_26603,
                                                            1, NULL,
                                                            global_work_sizze_28909,
                                                            local_work_sizze_28913,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_26603_runs,
                                                                                                      &ctx->testzisegmap_26603_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28911 = get_wall_time();
                
                long time_diff_28912 = time_end_28911 - time_start_28910;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_26603", time_diff_28912);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_27707, "mem_27707") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27710, "mem_27710") != 0)
            return 1;
        
        int64_t segmap_usable_groups_26901 = sdiv_up64(nest_sizze_26899,
                                                       segmap_group_sizze_26900);
        struct memblock_device mem_27730;
        
        mem_27730.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27730, bytes_27690, "mem_27730")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26546, 1,
                                                sizeof(paths_23826),
                                                &paths_23826));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26546, 2,
                                                sizeof(steps_23827),
                                                &steps_23827));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26546, 3,
                                                sizeof(mem_27725.mem),
                                                &mem_27725.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26546, 4,
                                                sizeof(mem_27730.mem),
                                                &mem_27730.mem));
        if (1 * ((size_t) segmap_usable_groups_26901 *
                 (size_t) segmap_group_sizze_26900) != 0) {
            const size_t global_work_sizze_28914[1] =
                         {(size_t) segmap_usable_groups_26901 *
                         (size_t) segmap_group_sizze_26900};
            const size_t local_work_sizze_28918[1] = {segmap_group_sizze_26900};
            int64_t time_start_28915 = 0, time_end_28916 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_26546");
                fprintf(stderr, "%zu", global_work_sizze_28914[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28918[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28915 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_26546,
                                                            1, NULL,
                                                            global_work_sizze_28914,
                                                            local_work_sizze_28918,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_26546_runs,
                                                                                                      &ctx->testzisegmap_26546_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28916 = get_wall_time();
                
                long time_diff_28917 = time_end_28916 - time_start_28915;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_26546", time_diff_28917);
            }
        }
        if (memblock_unref_device(ctx, &mem_27725, "mem_27725") != 0)
            return 1;
        
        int64_t segmap_usable_groups_26919 = sdiv_up64(nest_sizze_26899,
                                                       segmap_group_sizze_26918);
        struct memblock_device mem_27735;
        
        mem_27735.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27735, bytes_27690, "mem_27735")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26508, 1,
                                                sizeof(paths_23826),
                                                &paths_23826));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26508, 2,
                                                sizeof(steps_23827),
                                                &steps_23827));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26508, 3,
                                                sizeof(sims_per_year_23906),
                                                &sims_per_year_23906));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26508, 4,
                                                sizeof(mem_27735.mem),
                                                &mem_27735.mem));
        if (1 * ((size_t) segmap_usable_groups_26919 *
                 (size_t) segmap_group_sizze_26918) != 0) {
            const size_t global_work_sizze_28919[1] =
                         {(size_t) segmap_usable_groups_26919 *
                         (size_t) segmap_group_sizze_26918};
            const size_t local_work_sizze_28923[1] = {segmap_group_sizze_26918};
            int64_t time_start_28920 = 0, time_end_28921 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_26508");
                fprintf(stderr, "%zu", global_work_sizze_28919[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28923[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28920 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_26508,
                                                            1, NULL,
                                                            global_work_sizze_28919,
                                                            local_work_sizze_28923,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_26508_runs,
                                                                                                      &ctx->testzisegmap_26508_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28921 = get_wall_time();
                
                long time_diff_28922 = time_end_28921 - time_start_28920;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_26508", time_diff_28922);
            }
        }
        if (memblock_set_device(ctx, &res_mem_27736, &mem_27730, "mem_27730") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27737, &mem_27735, "mem_27735") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27735, "mem_27735") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27730, "mem_27730") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27710, "mem_27710") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27725, "mem_27725") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27707, "mem_27707") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27704, "mem_27704") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27700, "mem_27700") != 0)
            return 1;
    }
    
    int64_t segscan_group_sizze_26930;
    
    segscan_group_sizze_26930 = ctx->sizes.testzisegscan_group_sizze_26929;
    
    int64_t num_groups_26932;
    int32_t max_num_groups_27965;
    
    max_num_groups_27965 = ctx->sizes.testzisegscan_num_groups_26931;
    num_groups_26932 = sext_i64_i32(smax64(1, smin64(sdiv_up64(binop_x_27692,
                                                               sext_i32_i64(segscan_group_sizze_26930)),
                                                     sext_i32_i64(max_num_groups_27965))));
    
    int64_t bytes_27739 = 8 * binop_x_27692;
    struct memblock_device mem_27740;
    
    mem_27740.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27740, bytes_27739, "mem_27740")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27742;
    
    mem_27742.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27742, bytes_27739, "mem_27742")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, binop_x_27692)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_27966;
        
        stage1_max_num_groups_27966 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_27967;
        
        stage1_num_groups_27967 = smin64(stage1_max_num_groups_27966,
                                         num_groups_26932);
        
        int32_t num_threads_27968;
        
        num_threads_27968 = sext_i64_i32(stage1_num_groups_27967 *
            segscan_group_sizze_26930);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26935, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_26930),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26935, 2,
                                                sizeof(steps_23827),
                                                &steps_23827));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26935, 3,
                                                sizeof(one_intra_par_min_26244),
                                                &one_intra_par_min_26244));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26935, 4,
                                                sizeof(res_mem_27662.mem),
                                                &res_mem_27662.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26935, 5,
                                                sizeof(res_mem_27663.mem),
                                                &res_mem_27663.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26935, 6,
                                                sizeof(binop_x_27692),
                                                &binop_x_27692));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26935, 7,
                                                sizeof(res_mem_27737.mem),
                                                &res_mem_27737.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26935, 8,
                                                sizeof(mem_27740.mem),
                                                &mem_27740.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26935, 9,
                                                sizeof(mem_27742.mem),
                                                &mem_27742.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26935,
                                                10, sizeof(num_threads_27968),
                                                &num_threads_27968));
        if (1 * ((size_t) stage1_num_groups_27967 *
                 (size_t) segscan_group_sizze_26930) != 0) {
            const size_t global_work_sizze_28924[1] =
                         {(size_t) stage1_num_groups_27967 *
                         (size_t) segscan_group_sizze_26930};
            const size_t local_work_sizze_28928[1] =
                         {segscan_group_sizze_26930};
            int64_t time_start_28925 = 0, time_end_28926 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage1_26935");
                fprintf(stderr, "%zu", global_work_sizze_28924[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28928[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_26930)));
                time_start_28925 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage1_26935,
                                                            1, NULL,
                                                            global_work_sizze_28924,
                                                            local_work_sizze_28928,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage1_26935_runs,
                                                                                                      &ctx->testziscan_stage1_26935_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28926 = get_wall_time();
                
                long time_diff_28927 = time_end_28926 - time_start_28925;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage1_26935", time_diff_28927);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_26930 *
                                 sdiv_up64(binop_x_27692,
                                           sext_i32_i64(num_threads_27968))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26935, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_27967),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26935, 2,
                                                sizeof(binop_x_27692),
                                                &binop_x_27692));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26935, 3,
                                                sizeof(mem_27740.mem),
                                                &mem_27740.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26935, 4,
                                                sizeof(stage1_num_groups_27967),
                                                &stage1_num_groups_27967));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26935, 5,
                                                sizeof(num_threads_27968),
                                                &num_threads_27968));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_27967) != 0) {
            const size_t global_work_sizze_28929[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_27967};
            const size_t local_work_sizze_28933[1] = {stage1_num_groups_27967};
            int64_t time_start_28930 = 0, time_end_28931 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage2_26935");
                fprintf(stderr, "%zu", global_work_sizze_28929[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28933[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_27967)));
                time_start_28930 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage2_26935,
                                                            1, NULL,
                                                            global_work_sizze_28929,
                                                            local_work_sizze_28933,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage2_26935_runs,
                                                                                                      &ctx->testziscan_stage2_26935_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28931 = get_wall_time();
                
                long time_diff_28932 = time_end_28931 - time_start_28930;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage2_26935", time_diff_28932);
            }
        }
        
        int32_t required_groups_28004;
        
        required_groups_28004 = sext_i64_i32(sdiv_up64(binop_x_27692,
                                                       segscan_group_sizze_26930));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26935, 1,
                                                sizeof(num_groups_26932),
                                                &num_groups_26932));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26935, 2,
                                                sizeof(binop_x_27692),
                                                &binop_x_27692));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26935, 3,
                                                sizeof(mem_27740.mem),
                                                &mem_27740.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26935, 4,
                                                sizeof(num_threads_27968),
                                                &num_threads_27968));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26935, 5,
                                                sizeof(required_groups_28004),
                                                &required_groups_28004));
        if (1 * ((size_t) num_groups_26932 *
                 (size_t) segscan_group_sizze_26930) != 0) {
            const size_t global_work_sizze_28934[1] =
                         {(size_t) num_groups_26932 *
                         (size_t) segscan_group_sizze_26930};
            const size_t local_work_sizze_28938[1] =
                         {segscan_group_sizze_26930};
            int64_t time_start_28935 = 0, time_end_28936 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage3_26935");
                fprintf(stderr, "%zu", global_work_sizze_28934[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28938[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28935 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage3_26935,
                                                            1, NULL,
                                                            global_work_sizze_28934,
                                                            local_work_sizze_28938,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage3_26935_runs,
                                                                                                      &ctx->testziscan_stage3_26935_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28936 = get_wall_time();
                
                long time_diff_28937 = time_end_28936 - time_start_28935;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage3_26935", time_diff_28937);
            }
        }
    }
    
    int64_t segred_group_sizze_26938;
    
    segred_group_sizze_26938 = ctx->sizes.testzisegred_group_sizze_26937;
    
    int64_t num_groups_26940;
    int32_t max_num_groups_28016;
    
    max_num_groups_28016 = ctx->sizes.testzisegred_num_groups_26939;
    num_groups_26940 = sext_i64_i32(smax64(1, smin64(sdiv_up64(binop_x_27692,
                                                               sext_i32_i64(segred_group_sizze_26938)),
                                                     sext_i32_i64(max_num_groups_28016))));
    
    struct memblock_device mem_27745;
    
    mem_27745.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27745, 8, "mem_27745")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzicounter_mem_28017 =
                           ctx->testzicounter_mem_28017;
    struct memblock_device group_res_arr_mem_28019;
    
    group_res_arr_mem_28019.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_28019,
                              (int32_t) sizeof(int64_t) *
                              (segred_group_sizze_26938 * num_groups_26940),
                              "group_res_arr_mem_28019")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_28021;
    
    num_threads_28021 = num_groups_26940 * segred_group_sizze_26938;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26945, 1,
                                            (int32_t) sizeof(int64_t) *
                                            segred_group_sizze_26938, NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26945, 2,
                                            (int32_t) sizeof(bool), NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26945, 3,
                                            sizeof(num_groups_26940),
                                            &num_groups_26940));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26945, 4,
                                            sizeof(binop_x_27692),
                                            &binop_x_27692));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26945, 5,
                                            sizeof(mem_27742.mem),
                                            &mem_27742.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26945, 6,
                                            sizeof(mem_27745.mem),
                                            &mem_27745.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26945, 7,
                                            sizeof(testzicounter_mem_28017.mem),
                                            &testzicounter_mem_28017.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26945, 8,
                                            sizeof(group_res_arr_mem_28019.mem),
                                            &group_res_arr_mem_28019.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26945, 9,
                                            sizeof(num_threads_28021),
                                            &num_threads_28021));
    if (1 * ((size_t) num_groups_26940 * (size_t) segred_group_sizze_26938) !=
        0) {
        const size_t global_work_sizze_28940[1] = {(size_t) num_groups_26940 *
                     (size_t) segred_group_sizze_26938};
        const size_t local_work_sizze_28944[1] = {segred_group_sizze_26938};
        int64_t time_start_28941 = 0, time_end_28942 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segred_nonseg_26945");
            fprintf(stderr, "%zu", global_work_sizze_28940[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_28944[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) (0 + (int32_t) sizeof(int64_t) *
                           segred_group_sizze_26938 + (int32_t) sizeof(bool)));
            time_start_28941 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegred_nonseg_26945,
                                                        1, NULL,
                                                        global_work_sizze_28940,
                                                        local_work_sizze_28944,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegred_nonseg_26945_runs,
                                                                                                  &ctx->testzisegred_nonseg_26945_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_28942 = get_wall_time();
            
            long time_diff_28943 = time_end_28942 - time_start_28941;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "test.segred_nonseg_26945", time_diff_28943);
        }
    }
    if (memblock_unref_device(ctx, &mem_27742, "mem_27742") != 0)
        return 1;
    
    int64_t read_res_28945;
    
    OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                 mem_27745.mem,
                                                 ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                 0 * sizeof(int64_t),
                                                 sizeof(int64_t),
                                                 &read_res_28945, 0, NULL,
                                                 ctx->profiling_paused ||
                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                           &ctx->copy_scalar_from_dev_runs,
                                                                                           &ctx->copy_scalar_from_dev_total_runtime)));
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t res_24015 = read_res_28945;
    
    if (memblock_unref_device(ctx, &mem_27745, "mem_27745") != 0)
        return 1;
    
    bool bounds_invalid_upwards_24020 = slt64(res_24015, 0);
    bool valid_24021 = !bounds_invalid_upwards_24020;
    bool range_valid_c_24022;
    
    if (!valid_24021) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", res_24015,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:48:30-60\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:87:14-32\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva3d.fut:134:18-77\n   #6  cva3d.fut:154:3-156:129\n   #7  cva3d.fut:153:1-156:137\n");
        if (memblock_unref_device(ctx, &group_res_arr_mem_28019,
                                  "group_res_arr_mem_28019") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27745, "mem_27745") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27742, "mem_27742") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27740, "mem_27740") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27737, "res_mem_27737") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27736, "res_mem_27736") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27663, "res_mem_27663") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27662, "res_mem_27662") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27661, "res_mem_27661") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27879,
                                  "group_res_arr_mem_27879") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27641, "mem_27641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27636, "mem_27636") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27634, "mem_27634") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_27746 = 8 * res_24015;
    struct memblock_device mem_27747;
    
    mem_27747.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27747, bytes_27746, "mem_27747")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_27747, res_24015, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t seghist_group_sizze_26948;
    
    seghist_group_sizze_26948 = ctx->sizes.testziseghist_group_sizze_26947;
    
    int64_t num_groups_26950;
    int32_t max_num_groups_28056;
    
    max_num_groups_28056 = ctx->sizes.testziseghist_num_groups_26949;
    num_groups_26950 = sext_i64_i32(smax64(1, smin64(sdiv_up64(binop_x_27692,
                                                               sext_i32_i64(seghist_group_sizze_26948)),
                                                     sext_i32_i64(max_num_groups_28056))));
    
    int32_t num_subhistos_28057;
    struct memblock_device res_subhistos_mem_28058;
    
    res_subhistos_mem_28058.references = NULL;
    
    int64_t h_28060;
    
    h_28060 = (int32_t) sizeof(int64_t) * res_24015;
    
    int64_t seg_h_28061;
    
    seg_h_28061 = (int32_t) sizeof(int64_t) * res_24015;
    if (!(seg_h_28061 == 0)) {
        int64_t hist_H_28062 = res_24015;
        int64_t hist_el_sizze_28063 = sdiv_up64(h_28060, hist_H_28062) + 4;
        int64_t hist_N_28064 = binop_x_27692;
        int64_t hist_RF_28065 = 1;
        
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegHist");
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Number of threads (T)",
                    (long long) sext_i64_i32(num_groups_26950 *
                    seghist_group_sizze_26948), '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Desired group size (B)",
                    (long long) seghist_group_sizze_26948, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                    (long long) hist_H_28062, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Input elements per histogram (N)",
                    (long long) hist_N_28064, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Number of segments", (long long) 1,
                    '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Histogram element size (el_size)",
                    (long long) hist_el_sizze_28063, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Race factor (RF)",
                    (long long) hist_RF_28065, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c",
                    "Memory per set of subhistograms per segment",
                    (long long) h_28060, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c",
                    "Memory per set of subhistograms times segments",
                    (long long) seg_h_28061, '\n');
        
        int32_t hist_L_28066;
        
        hist_L_28066 = ctx->opencl.max_local_memory;
        
        int32_t max_group_sizze_28067;
        
        max_group_sizze_28067 = ctx->opencl.max_group_size;
        
        int64_t num_groups_28068;
        
        num_groups_28068 =
            sdiv_up64(sext_i32_i64(sext_i64_i32(num_groups_26950 *
                      seghist_group_sizze_26948)), max_group_sizze_28067);
        
        double hist_m_prime_28069;
        
        hist_m_prime_28069 =
            sitofp_i64_f64(smin64(sext_i32_i64(squot32(hist_L_28066,
                                                       hist_el_sizze_28063)),
                                  sdiv_up64(hist_N_28064, num_groups_28068))) /
            sitofp_i64_f64(hist_H_28062);
        
        int64_t hist_M0_28070;
        
        hist_M0_28070 = smax64(1, smin64(fptosi_f64_i64(hist_m_prime_28069),
                                         max_group_sizze_28067));
        
        int64_t hist_Nout_28071;
        
        hist_Nout_28071 = 1;
        
        int64_t hist_Nin_28072;
        
        hist_Nin_28072 = binop_x_27692;
        
        int64_t work_asymp_M_max_28073;
        
        work_asymp_M_max_28073 = squot64(hist_Nout_28071 * hist_N_28064, 2 *
                                         num_groups_28068 * hist_H_28062);
        
        int32_t hist_M_28074;
        
        hist_M_28074 = sext_i64_i32(smin64(hist_M0_28070,
                                           work_asymp_M_max_28073));
        
        int64_t hist_C_28075;
        
        hist_C_28075 = sdiv_up64(max_group_sizze_28067, sext_i32_i64(smax32(1,
                                                                            hist_M_28074)));
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local hist_M0",
                    (long long) hist_M0_28070, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local work asymp M max",
                    (long long) work_asymp_M_max_28073, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local C", (long long) hist_C_28075,
                    '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local B",
                    (long long) max_group_sizze_28067, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local M", (long long) hist_M_28074,
                    '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local memory needed",
                    (long long) (hist_H_28062 * hist_el_sizze_28063 *
                                 sext_i32_i64(hist_M_28074)), '\n');
        
        int64_t local_mem_needed_28076;
        
        local_mem_needed_28076 = hist_el_sizze_28063 *
            sext_i32_i64(hist_M_28074);
        
        int32_t hist_S_28077;
        
        hist_S_28077 = sext_i64_i32(sdiv_up64(hist_H_28062 *
                                              local_mem_needed_28076,
                                              hist_L_28066));
        if (sle64(hist_H_28062, hist_Nin_28072) &&
            (sle64(local_mem_needed_28076, hist_L_28066) && (sle32(hist_S_28077,
                                                                   6) &&
                                                             (sle64(hist_C_28075,
                                                                    max_group_sizze_28067) &&
                                                              slt32(0,
                                                                    hist_M_28074))))) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "## Using local memory");
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                        (long long) hist_H_28062, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                        (long long) hist_M_28074, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Cooperation level (C)",
                        (long long) hist_C_28075, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                        (long long) hist_S_28077, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Number of local subhistograms per group",
                        (long long) hist_M_28074, '\n');
            
            int64_t num_segments_28078;
            
            num_segments_28078 = 1;
            num_subhistos_28057 = num_groups_28068 * num_segments_28078;
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Number of subhistograms in global memory",
                        (long long) num_subhistos_28057, '\n');
            if (num_subhistos_28057 == 1) {
                if (memblock_set_device(ctx, &res_subhistos_mem_28058,
                                        &mem_27747, "mem_27747") != 0)
                    return 1;
            } else {
                if (memblock_alloc_device(ctx, &res_subhistos_mem_28058,
                                          sext_i32_i64(num_subhistos_28057) *
                                          res_24015 * (int32_t) sizeof(int64_t),
                                          "res_subhistos_mem_28058")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, res_subhistos_mem_28058,
                                                  num_subhistos_28057 *
                                                  res_24015, 0) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (res_24015 * (int32_t) sizeof(int64_t) > 0) {
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                 mem_27747.mem,
                                                                 res_subhistos_mem_28058.mem,
                                                                 0, 0,
                                                                 res_24015 *
                                                                 (int32_t) sizeof(int64_t),
                                                                 0, NULL,
                                                                 ctx->profiling_paused ||
                                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                           &ctx->copy_dev_to_dev_runs,
                                                                                                           &ctx->copy_dev_to_dev_total_runtime)));
                    if (ctx->debugging)
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                }
            }
            for (int32_t chk_i_28079 = 0; chk_i_28079 < hist_S_28077;
                 chk_i_28079++) {
                int64_t num_segments_28080 = 1;
                int64_t hist_H_chk_28081 = sdiv_up64(res_24015,
                                                     sext_i32_i64(hist_S_28077));
                int64_t histo_sizze_28082 = hist_H_chk_28081;
                int32_t init_per_thread_28083 =
                        sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_28074) *
                                               histo_sizze_28082,
                                               max_group_sizze_28067));
                
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_26953,
                                                        1,
                                                        (int32_t) sizeof(int32_t) *
                                                        (hist_M_28074 *
                                                         hist_H_chk_28081),
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_26953,
                                                        2,
                                                        (int32_t) sizeof(int64_t) *
                                                        (hist_M_28074 *
                                                         hist_H_chk_28081),
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_26953,
                                                        3, sizeof(res_24015),
                                                        &res_24015));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_26953,
                                                        4,
                                                        sizeof(binop_x_27692),
                                                        &binop_x_27692));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_26953,
                                                        5,
                                                        sizeof(mem_27740.mem),
                                                        &mem_27740.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_26953,
                                                        6,
                                                        sizeof(res_subhistos_mem_28058.mem),
                                                        &res_subhistos_mem_28058.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_26953,
                                                        7,
                                                        sizeof(max_group_sizze_28067),
                                                        &max_group_sizze_28067));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_26953,
                                                        8,
                                                        sizeof(num_groups_28068),
                                                        &num_groups_28068));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_26953,
                                                        9, sizeof(hist_M_28074),
                                                        &hist_M_28074));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_26953,
                                                        10, sizeof(chk_i_28079),
                                                        &chk_i_28079));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_26953,
                                                        11,
                                                        sizeof(num_segments_28080),
                                                        &num_segments_28080));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_26953,
                                                        12,
                                                        sizeof(hist_H_chk_28081),
                                                        &hist_H_chk_28081));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_26953,
                                                        13,
                                                        sizeof(histo_sizze_28082),
                                                        &histo_sizze_28082));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_26953,
                                                        14,
                                                        sizeof(init_per_thread_28083),
                                                        &init_per_thread_28083));
                if (1 * ((size_t) num_groups_28068 *
                         (size_t) max_group_sizze_28067) != 0) {
                    const size_t global_work_sizze_28946[1] =
                                 {(size_t) num_groups_28068 *
                                 (size_t) max_group_sizze_28067};
                    const size_t local_work_sizze_28950[1] =
                                 {max_group_sizze_28067};
                    int64_t time_start_28947 = 0, time_end_28948 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.seghist_local_26953");
                        fprintf(stderr, "%zu", global_work_sizze_28946[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_28950[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(int32_t) *
                                       (hist_M_28074 * hist_H_chk_28081) +
                                       (int32_t) sizeof(int64_t) *
                                       (hist_M_28074 * hist_H_chk_28081)));
                        time_start_28947 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testziseghist_local_26953,
                                                                    1, NULL,
                                                                    global_work_sizze_28946,
                                                                    local_work_sizze_28950,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testziseghist_local_26953_runs,
                                                                                                              &ctx->testziseghist_local_26953_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_28948 = get_wall_time();
                        
                        long time_diff_28949 = time_end_28948 -
                             time_start_28947;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.seghist_local_26953", time_diff_28949);
                    }
                }
            }
        } else {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "## Using global memory");
            
            int64_t hist_H_28115;
            
            hist_H_28115 = res_24015;
            
            double hist_RF_28116;
            
            hist_RF_28116 = (0.0 + sitofp_i32_f64(1)) / 1.0;
            
            int32_t hist_el_sizze_28117;
            
            hist_el_sizze_28117 =
                squot32(sext_i64_i32((int32_t) sizeof(int32_t) +
                        (int32_t) sizeof(int64_t)), 2);
            
            double hist_C_max_28118;
            
            hist_C_max_28118 =
                fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_26950 *
                       seghist_group_sizze_26948)),
                       sitofp_i32_f64(hist_H_28115) / 2.0);
            
            int32_t hist_M_min_28119;
            
            hist_M_min_28119 = smax32(1,
                                      sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_26950 *
                                      seghist_group_sizze_26948)) /
                                      hist_C_max_28118)));
            
            int32_t L2_sizze_28120;
            
            L2_sizze_28120 = ctx->sizes.testziL2_sizze_28120;
            
            double hist_RACE_exp_28121;
            
            hist_RACE_exp_28121 = fmax64(1.0, 0.75 * hist_RF_28116 / (64.0 /
                                                                      sitofp_i32_f64(hist_el_sizze_28117)));
            
            int32_t hist_S_28122;
            
            if (slt64(binop_x_27692, hist_H_28115)) {
                hist_S_28122 = 1;
            } else {
                hist_S_28122 =
                    sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_min_28119) *
                                           hist_H_28115 *
                                           sext_i32_i64(hist_el_sizze_28117),
                                           fptosi_f64_i64(0.4 *
                                           sitofp_i32_f64(L2_sizze_28120) *
                                           hist_RACE_exp_28121)));
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %f%c", "Race expansion factor (RACE^exp)",
                        (double) hist_RACE_exp_28121, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                        (long long) hist_S_28122, '\n');
            
            int64_t hist_H_chk_28123;
            
            hist_H_chk_28123 = sdiv_up64(res_24015, sext_i32_i64(hist_S_28122));
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Chunk size (H_chk)",
                        (long long) hist_H_chk_28123, '\n');
            
            double hist_k_max_28124;
            
            hist_k_max_28124 = fmin64(0.4 * (sitofp_i32_f64(L2_sizze_28120) /
                                             sitofp_i32_f64(sext_i64_i32((int32_t) sizeof(int32_t) +
                                             (int32_t) sizeof(int64_t)))) *
                                      hist_RACE_exp_28121,
                                      sitofp_i32_f64(binop_x_27692)) /
                sitofp_i32_f64(sext_i64_i32(num_groups_26950 *
                seghist_group_sizze_26948));
            
            int64_t hist_u_28125;
            
            hist_u_28125 = 1;
            
            double hist_C_28126;
            
            hist_C_28126 = fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_26950 *
                                  seghist_group_sizze_26948)),
                                  sitofp_i32_f64(hist_u_28125 *
                                  hist_H_chk_28123) / hist_k_max_28124);
            
            int32_t hist_M_28127;
            
            hist_M_28127 = smax32(hist_M_min_28119,
                                  sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_26950 *
                                  seghist_group_sizze_26948)) / hist_C_28126)));
            if (ctx->debugging)
                fprintf(stderr, "%s: %f%c",
                        "Elements/thread in L2 cache (k_max)",
                        (double) hist_k_max_28124, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                        (long long) hist_M_28127, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %f%c", "Cooperation level (C)",
                        (double) hist_C_28126, '\n');
            num_subhistos_28057 = sext_i32_i64(hist_M_28127);
            if (hist_M_28127 == 1) {
                if (memblock_set_device(ctx, &res_subhistos_mem_28058,
                                        &mem_27747, "mem_27747") != 0)
                    return 1;
            } else {
                if (num_subhistos_28057 == 1) {
                    if (memblock_set_device(ctx, &res_subhistos_mem_28058,
                                            &mem_27747, "mem_27747") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &res_subhistos_mem_28058,
                                              sext_i32_i64(num_subhistos_28057) *
                                              res_24015 *
                                              (int32_t) sizeof(int64_t),
                                              "res_subhistos_mem_28058")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx,
                                                      res_subhistos_mem_28058,
                                                      num_subhistos_28057 *
                                                      res_24015, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (res_24015 * (int32_t) sizeof(int64_t) > 0) {
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                     mem_27747.mem,
                                                                     res_subhistos_mem_28058.mem,
                                                                     0, 0,
                                                                     res_24015 *
                                                                     (int32_t) sizeof(int64_t),
                                                                     0, NULL,
                                                                     ctx->profiling_paused ||
                                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
                        if (ctx->debugging)
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    }
                }
            }
            
            struct memblock_device testzihist_locks_mem_28128 =
                                   ctx->testzihist_locks_mem_28128;
            
            for (int32_t chk_i_28130 = 0; chk_i_28130 < hist_S_28122;
                 chk_i_28130++) {
                int64_t hist_H_chk_28131 = sdiv_up64(res_24015,
                                                     sext_i32_i64(hist_S_28122));
                
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_26953,
                                                        1, sizeof(res_24015),
                                                        &res_24015));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_26953,
                                                        2,
                                                        sizeof(num_groups_26950),
                                                        &num_groups_26950));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_26953,
                                                        3,
                                                        sizeof(binop_x_27692),
                                                        &binop_x_27692));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_26953,
                                                        4,
                                                        sizeof(mem_27740.mem),
                                                        &mem_27740.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_26953,
                                                        5,
                                                        sizeof(num_subhistos_28057),
                                                        &num_subhistos_28057));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_26953,
                                                        6,
                                                        sizeof(res_subhistos_mem_28058.mem),
                                                        &res_subhistos_mem_28058.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_26953,
                                                        7,
                                                        sizeof(testzihist_locks_mem_28128.mem),
                                                        &testzihist_locks_mem_28128.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_26953,
                                                        8, sizeof(chk_i_28130),
                                                        &chk_i_28130));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_26953,
                                                        9,
                                                        sizeof(hist_H_chk_28131),
                                                        &hist_H_chk_28131));
                if (1 * ((size_t) num_groups_26950 *
                         (size_t) seghist_group_sizze_26948) != 0) {
                    const size_t global_work_sizze_28952[1] =
                                 {(size_t) num_groups_26950 *
                                 (size_t) seghist_group_sizze_26948};
                    const size_t local_work_sizze_28956[1] =
                                 {seghist_group_sizze_26948};
                    int64_t time_start_28953 = 0, time_end_28954 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.seghist_global_26953");
                        fprintf(stderr, "%zu", global_work_sizze_28952[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_28956[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_28953 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testziseghist_global_26953,
                                                                    1, NULL,
                                                                    global_work_sizze_28952,
                                                                    local_work_sizze_28956,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testziseghist_global_26953_runs,
                                                                                                              &ctx->testziseghist_global_26953_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_28954 = get_wall_time();
                        
                        long time_diff_28955 = time_end_28954 -
                             time_start_28953;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.seghist_global_26953", time_diff_28955);
                    }
                }
            }
        }
        if (num_subhistos_28057 == 1) {
            if (memblock_set_device(ctx, &mem_27747, &res_subhistos_mem_28058,
                                    "res_subhistos_mem_28058") != 0)
                return 1;
        } else {
            if (slt64(num_subhistos_28057 * 2, seghist_group_sizze_26948)) {
                int64_t segment_sizze_nonzzero_28144 = smax64(1,
                                                              num_subhistos_28057);
                int64_t num_threads_28145 = num_groups_26950 *
                        seghist_group_sizze_26948;
                
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegRed-small");
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "num_segments",
                            (long long) res_24015, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "segment_size",
                            (long long) num_subhistos_28057, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "segments_per_group",
                            (long long) squot64(seghist_group_sizze_26948,
                                                segment_sizze_nonzzero_28144),
                            '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "required_groups",
                            (long long) sext_i64_i32(sdiv_up64(res_24015,
                                                               squot64(seghist_group_sizze_26948,
                                                                       segment_sizze_nonzzero_28144))),
                            '\n');
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28143,
                                                        1,
                                                        (int32_t) sizeof(int64_t) *
                                                        seghist_group_sizze_26948,
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28143,
                                                        2, sizeof(res_24015),
                                                        &res_24015));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28143,
                                                        3,
                                                        sizeof(num_groups_26950),
                                                        &num_groups_26950));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28143,
                                                        4,
                                                        sizeof(mem_27747.mem),
                                                        &mem_27747.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28143,
                                                        5,
                                                        sizeof(num_subhistos_28057),
                                                        &num_subhistos_28057));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28143,
                                                        6,
                                                        sizeof(res_subhistos_mem_28058.mem),
                                                        &res_subhistos_mem_28058.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28143,
                                                        7,
                                                        sizeof(segment_sizze_nonzzero_28144),
                                                        &segment_sizze_nonzzero_28144));
                if (1 * ((size_t) num_groups_26950 *
                         (size_t) seghist_group_sizze_26948) != 0) {
                    const size_t global_work_sizze_28957[1] =
                                 {(size_t) num_groups_26950 *
                                 (size_t) seghist_group_sizze_26948};
                    const size_t local_work_sizze_28961[1] =
                                 {seghist_group_sizze_26948};
                    int64_t time_start_28958 = 0, time_end_28959 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.segred_small_28143");
                        fprintf(stderr, "%zu", global_work_sizze_28957[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_28961[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(int64_t) *
                                       seghist_group_sizze_26948));
                        time_start_28958 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testzisegred_small_28143,
                                                                    1, NULL,
                                                                    global_work_sizze_28957,
                                                                    local_work_sizze_28961,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testzisegred_small_28143_runs,
                                                                                                              &ctx->testzisegred_small_28143_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_28959 = get_wall_time();
                        
                        long time_diff_28960 = time_end_28959 -
                             time_start_28958;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.segred_small_28143", time_diff_28960);
                    }
                }
            } else {
                int64_t groups_per_segment_28165 = sdiv_up64(num_groups_26950,
                                                             smax64(1,
                                                                    res_24015));
                int64_t elements_per_thread_28166 =
                        sdiv_up64(num_subhistos_28057,
                                  seghist_group_sizze_26948 *
                                  groups_per_segment_28165);
                int64_t virt_num_groups_28167 = groups_per_segment_28165 *
                        res_24015;
                int64_t num_threads_28168 = num_groups_26950 *
                        seghist_group_sizze_26948;
                int64_t threads_per_segment_28169 = groups_per_segment_28165 *
                        seghist_group_sizze_26948;
                
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegRed-large");
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "num_segments",
                            (long long) res_24015, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "segment_size",
                            (long long) num_subhistos_28057, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                            (long long) virt_num_groups_28167, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "num_groups",
                            (long long) num_groups_26950, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "group_size",
                            (long long) seghist_group_sizze_26948, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                            (long long) elements_per_thread_28166, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                            (long long) groups_per_segment_28165, '\n');
                
                struct memblock_device group_res_arr_mem_28170;
                
                group_res_arr_mem_28170.references = NULL;
                if (memblock_alloc_device(ctx, &group_res_arr_mem_28170,
                                          (int32_t) sizeof(int64_t) *
                                          (seghist_group_sizze_26948 *
                                           virt_num_groups_28167),
                                          "group_res_arr_mem_28170")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device testzicounter_mem_28172 =
                                       ctx->testzicounter_mem_28172;
                
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28143,
                                                        1,
                                                        (int32_t) sizeof(bool),
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28143,
                                                        2,
                                                        (int32_t) sizeof(int64_t) *
                                                        seghist_group_sizze_26948,
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28143,
                                                        3, sizeof(res_24015),
                                                        &res_24015));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28143,
                                                        4,
                                                        sizeof(num_groups_26950),
                                                        &num_groups_26950));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28143,
                                                        5,
                                                        sizeof(mem_27747.mem),
                                                        &mem_27747.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28143,
                                                        6,
                                                        sizeof(num_subhistos_28057),
                                                        &num_subhistos_28057));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28143,
                                                        7,
                                                        sizeof(res_subhistos_mem_28058.mem),
                                                        &res_subhistos_mem_28058.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28143,
                                                        8,
                                                        sizeof(groups_per_segment_28165),
                                                        &groups_per_segment_28165));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28143,
                                                        9,
                                                        sizeof(elements_per_thread_28166),
                                                        &elements_per_thread_28166));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28143,
                                                        10,
                                                        sizeof(virt_num_groups_28167),
                                                        &virt_num_groups_28167));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28143,
                                                        11,
                                                        sizeof(threads_per_segment_28169),
                                                        &threads_per_segment_28169));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28143,
                                                        12,
                                                        sizeof(group_res_arr_mem_28170.mem),
                                                        &group_res_arr_mem_28170.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28143,
                                                        13,
                                                        sizeof(testzicounter_mem_28172.mem),
                                                        &testzicounter_mem_28172.mem));
                if (1 * ((size_t) num_groups_26950 *
                         (size_t) seghist_group_sizze_26948) != 0) {
                    const size_t global_work_sizze_28963[1] =
                                 {(size_t) num_groups_26950 *
                                 (size_t) seghist_group_sizze_26948};
                    const size_t local_work_sizze_28967[1] =
                                 {seghist_group_sizze_26948};
                    int64_t time_start_28964 = 0, time_end_28965 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.segred_large_28143");
                        fprintf(stderr, "%zu", global_work_sizze_28963[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_28967[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(bool) +
                                       (int32_t) sizeof(int64_t) *
                                       seghist_group_sizze_26948));
                        time_start_28964 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testzisegred_large_28143,
                                                                    1, NULL,
                                                                    global_work_sizze_28963,
                                                                    local_work_sizze_28967,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testzisegred_large_28143_runs,
                                                                                                              &ctx->testzisegred_large_28143_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_28965 = get_wall_time();
                        
                        long time_diff_28966 = time_end_28965 -
                             time_start_28964;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.segred_large_28143", time_diff_28966);
                    }
                }
                if (memblock_unref_device(ctx, &group_res_arr_mem_28170,
                                          "group_res_arr_mem_28170") != 0)
                    return 1;
            }
        }
    }
    if (memblock_unref_device(ctx, &mem_27740, "mem_27740") != 0)
        return 1;
    
    int64_t segscan_group_sizze_26963;
    
    segscan_group_sizze_26963 = ctx->sizes.testzisegscan_group_sizze_26962;
    
    int64_t num_groups_26965;
    int32_t max_num_groups_28204;
    
    max_num_groups_28204 = ctx->sizes.testzisegscan_num_groups_26964;
    num_groups_26965 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_24015,
                                                               sext_i32_i64(segscan_group_sizze_26963)),
                                                     sext_i32_i64(max_num_groups_28204))));
    
    struct memblock_device mem_27751;
    
    mem_27751.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27751, res_24015, "mem_27751")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27753;
    
    mem_27753.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27753, bytes_27746, "mem_27753")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_24015)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28205;
        
        stage1_max_num_groups_28205 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28206;
        
        stage1_num_groups_28206 = smin64(stage1_max_num_groups_28205,
                                         num_groups_26965);
        
        int32_t num_threads_28207;
        
        num_threads_28207 = sext_i64_i32(stage1_num_groups_28206 *
            segscan_group_sizze_26963);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26968, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_26963),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26968, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       segscan_group_sizze_26963),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26968, 3,
                                                sizeof(res_24015), &res_24015));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26968, 4,
                                                sizeof(mem_27747.mem),
                                                &mem_27747.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26968, 5,
                                                sizeof(mem_27751.mem),
                                                &mem_27751.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26968, 6,
                                                sizeof(mem_27753.mem),
                                                &mem_27753.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26968, 7,
                                                sizeof(num_threads_28207),
                                                &num_threads_28207));
        if (1 * ((size_t) stage1_num_groups_28206 *
                 (size_t) segscan_group_sizze_26963) != 0) {
            const size_t global_work_sizze_28968[1] =
                         {(size_t) stage1_num_groups_28206 *
                         (size_t) segscan_group_sizze_26963};
            const size_t local_work_sizze_28972[1] =
                         {segscan_group_sizze_26963};
            int64_t time_start_28969 = 0, time_end_28970 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage1_26968");
                fprintf(stderr, "%zu", global_work_sizze_28968[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28972[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_26963) + smax64(1,
                                                                              (int32_t) sizeof(bool) *
                                                                              segscan_group_sizze_26963)));
                time_start_28969 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage1_26968,
                                                            1, NULL,
                                                            global_work_sizze_28968,
                                                            local_work_sizze_28972,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage1_26968_runs,
                                                                                                      &ctx->testziscan_stage1_26968_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28970 = get_wall_time();
                
                long time_diff_28971 = time_end_28970 - time_start_28969;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage1_26968", time_diff_28971);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_26963 *
                                 sdiv_up64(res_24015,
                                           sext_i32_i64(num_threads_28207))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26968, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_28206),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26968, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       stage1_num_groups_28206),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26968, 3,
                                                sizeof(res_24015), &res_24015));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26968, 4,
                                                sizeof(mem_27751.mem),
                                                &mem_27751.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26968, 5,
                                                sizeof(mem_27753.mem),
                                                &mem_27753.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26968, 6,
                                                sizeof(stage1_num_groups_28206),
                                                &stage1_num_groups_28206));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26968, 7,
                                                sizeof(num_threads_28207),
                                                &num_threads_28207));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28206) != 0) {
            const size_t global_work_sizze_28973[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28206};
            const size_t local_work_sizze_28977[1] = {stage1_num_groups_28206};
            int64_t time_start_28974 = 0, time_end_28975 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage2_26968");
                fprintf(stderr, "%zu", global_work_sizze_28973[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28977[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_28206) + smax64(1,
                                                                            (int32_t) sizeof(bool) *
                                                                            stage1_num_groups_28206)));
                time_start_28974 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage2_26968,
                                                            1, NULL,
                                                            global_work_sizze_28973,
                                                            local_work_sizze_28977,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage2_26968_runs,
                                                                                                      &ctx->testziscan_stage2_26968_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28975 = get_wall_time();
                
                long time_diff_28976 = time_end_28975 - time_start_28974;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage2_26968", time_diff_28976);
            }
        }
        
        int32_t required_groups_28259;
        
        required_groups_28259 = sext_i64_i32(sdiv_up64(res_24015,
                                                       segscan_group_sizze_26963));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26968, 1,
                                                sizeof(res_24015), &res_24015));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26968, 2,
                                                sizeof(num_groups_26965),
                                                &num_groups_26965));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26968, 3,
                                                sizeof(mem_27751.mem),
                                                &mem_27751.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26968, 4,
                                                sizeof(mem_27753.mem),
                                                &mem_27753.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26968, 5,
                                                sizeof(num_threads_28207),
                                                &num_threads_28207));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26968, 6,
                                                sizeof(required_groups_28259),
                                                &required_groups_28259));
        if (1 * ((size_t) num_groups_26965 *
                 (size_t) segscan_group_sizze_26963) != 0) {
            const size_t global_work_sizze_28978[1] =
                         {(size_t) num_groups_26965 *
                         (size_t) segscan_group_sizze_26963};
            const size_t local_work_sizze_28982[1] =
                         {segscan_group_sizze_26963};
            int64_t time_start_28979 = 0, time_end_28980 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage3_26968");
                fprintf(stderr, "%zu", global_work_sizze_28978[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28982[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28979 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage3_26968,
                                                            1, NULL,
                                                            global_work_sizze_28978,
                                                            local_work_sizze_28982,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage3_26968_runs,
                                                                                                      &ctx->testziscan_stage3_26968_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28980 = get_wall_time();
                
                long time_diff_28981 = time_end_28980 - time_start_28979;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage3_26968", time_diff_28981);
            }
        }
    }
    if (memblock_unref_device(ctx, &mem_27747, "mem_27747") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27751, "mem_27751") != 0)
        return 1;
    
    int64_t segscan_group_sizze_26971;
    
    segscan_group_sizze_26971 = ctx->sizes.testzisegscan_group_sizze_26970;
    
    int64_t num_groups_26973;
    int32_t max_num_groups_28271;
    
    max_num_groups_28271 = ctx->sizes.testzisegscan_num_groups_26972;
    num_groups_26973 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_24015,
                                                               sext_i32_i64(segscan_group_sizze_26971)),
                                                     sext_i32_i64(max_num_groups_28271))));
    
    struct memblock_device mem_27756;
    
    mem_27756.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27756, res_24015, "mem_27756")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27758;
    
    mem_27758.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27758, bytes_27746, "mem_27758")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27760;
    
    mem_27760.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27760, res_24015, "mem_27760")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_24015)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28272;
        
        stage1_max_num_groups_28272 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28273;
        
        stage1_num_groups_28273 = smin64(stage1_max_num_groups_28272,
                                         num_groups_26973);
        
        int32_t num_threads_28274;
        
        num_threads_28274 = sext_i64_i32(stage1_num_groups_28273 *
            segscan_group_sizze_26971);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26976, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_26971),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26976, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       segscan_group_sizze_26971),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26976, 3,
                                                sizeof(res_24015), &res_24015));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26976, 4,
                                                sizeof(mem_27753.mem),
                                                &mem_27753.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26976, 5,
                                                sizeof(mem_27756.mem),
                                                &mem_27756.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26976, 6,
                                                sizeof(mem_27758.mem),
                                                &mem_27758.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26976, 7,
                                                sizeof(mem_27760.mem),
                                                &mem_27760.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26976, 8,
                                                sizeof(num_threads_28274),
                                                &num_threads_28274));
        if (1 * ((size_t) stage1_num_groups_28273 *
                 (size_t) segscan_group_sizze_26971) != 0) {
            const size_t global_work_sizze_28983[1] =
                         {(size_t) stage1_num_groups_28273 *
                         (size_t) segscan_group_sizze_26971};
            const size_t local_work_sizze_28987[1] =
                         {segscan_group_sizze_26971};
            int64_t time_start_28984 = 0, time_end_28985 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage1_26976");
                fprintf(stderr, "%zu", global_work_sizze_28983[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28987[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_26971) + smax64(1,
                                                                              (int32_t) sizeof(bool) *
                                                                              segscan_group_sizze_26971)));
                time_start_28984 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage1_26976,
                                                            1, NULL,
                                                            global_work_sizze_28983,
                                                            local_work_sizze_28987,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage1_26976_runs,
                                                                                                      &ctx->testziscan_stage1_26976_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28985 = get_wall_time();
                
                long time_diff_28986 = time_end_28985 - time_start_28984;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage1_26976", time_diff_28986);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_26971 *
                                 sdiv_up64(res_24015,
                                           sext_i32_i64(num_threads_28274))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26976, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_28273),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26976, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       stage1_num_groups_28273),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26976, 3,
                                                sizeof(res_24015), &res_24015));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26976, 4,
                                                sizeof(mem_27756.mem),
                                                &mem_27756.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26976, 5,
                                                sizeof(mem_27758.mem),
                                                &mem_27758.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26976, 6,
                                                sizeof(stage1_num_groups_28273),
                                                &stage1_num_groups_28273));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26976, 7,
                                                sizeof(num_threads_28274),
                                                &num_threads_28274));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28273) != 0) {
            const size_t global_work_sizze_28988[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28273};
            const size_t local_work_sizze_28992[1] = {stage1_num_groups_28273};
            int64_t time_start_28989 = 0, time_end_28990 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage2_26976");
                fprintf(stderr, "%zu", global_work_sizze_28988[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28992[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_28273) + smax64(1,
                                                                            (int32_t) sizeof(bool) *
                                                                            stage1_num_groups_28273)));
                time_start_28989 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage2_26976,
                                                            1, NULL,
                                                            global_work_sizze_28988,
                                                            local_work_sizze_28992,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage2_26976_runs,
                                                                                                      &ctx->testziscan_stage2_26976_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28990 = get_wall_time();
                
                long time_diff_28991 = time_end_28990 - time_start_28989;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage2_26976", time_diff_28991);
            }
        }
        
        int32_t required_groups_28326;
        
        required_groups_28326 = sext_i64_i32(sdiv_up64(res_24015,
                                                       segscan_group_sizze_26971));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26976, 1,
                                                sizeof(res_24015), &res_24015));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26976, 2,
                                                sizeof(num_groups_26973),
                                                &num_groups_26973));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26976, 3,
                                                sizeof(mem_27756.mem),
                                                &mem_27756.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26976, 4,
                                                sizeof(mem_27758.mem),
                                                &mem_27758.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26976, 5,
                                                sizeof(num_threads_28274),
                                                &num_threads_28274));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26976, 6,
                                                sizeof(required_groups_28326),
                                                &required_groups_28326));
        if (1 * ((size_t) num_groups_26973 *
                 (size_t) segscan_group_sizze_26971) != 0) {
            const size_t global_work_sizze_28993[1] =
                         {(size_t) num_groups_26973 *
                         (size_t) segscan_group_sizze_26971};
            const size_t local_work_sizze_28997[1] =
                         {segscan_group_sizze_26971};
            int64_t time_start_28994 = 0, time_end_28995 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage3_26976");
                fprintf(stderr, "%zu", global_work_sizze_28993[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28997[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28994 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage3_26976,
                                                            1, NULL,
                                                            global_work_sizze_28993,
                                                            local_work_sizze_28997,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage3_26976_runs,
                                                                                                      &ctx->testziscan_stage3_26976_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28995 = get_wall_time();
                
                long time_diff_28996 = time_end_28995 - time_start_28994;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage3_26976", time_diff_28996);
            }
        }
    }
    if (memblock_unref_device(ctx, &mem_27756, "mem_27756") != 0)
        return 1;
    
    int64_t segscan_group_sizze_26979;
    
    segscan_group_sizze_26979 = ctx->sizes.testzisegscan_group_sizze_26978;
    
    int64_t num_groups_26981;
    int32_t max_num_groups_28338;
    
    max_num_groups_28338 = ctx->sizes.testzisegscan_num_groups_26980;
    num_groups_26981 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_24015,
                                                               sext_i32_i64(segscan_group_sizze_26979)),
                                                     sext_i32_i64(max_num_groups_28338))));
    
    struct memblock_device mem_27763;
    
    mem_27763.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27763, res_24015, "mem_27763")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_27764 = 4 * res_24015;
    struct memblock_device mem_27765;
    
    mem_27765.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27765, bytes_27764, "mem_27765")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_24015)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28339;
        
        stage1_max_num_groups_28339 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28340;
        
        stage1_num_groups_28340 = smin64(stage1_max_num_groups_28339,
                                         num_groups_26981);
        
        int32_t num_threads_28341;
        
        num_threads_28341 = sext_i64_i32(stage1_num_groups_28340 *
            segscan_group_sizze_26979);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984, 3,
                                                smax64(1,
                                                       (int32_t) sizeof(float) *
                                                       segscan_group_sizze_26979),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984, 4,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       segscan_group_sizze_26979),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984, 5,
                                                sizeof(steps_23827),
                                                &steps_23827));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984, 6,
                                                sizeof(res_24015), &res_24015));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984, 7,
                                                sizeof(one_intra_par_min_26244),
                                                &one_intra_par_min_26244));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984, 8,
                                                sizeof(res_mem_27660.mem),
                                                &res_mem_27660.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984, 9,
                                                sizeof(res_mem_27661.mem),
                                                &res_mem_27661.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984,
                                                10, sizeof(res_mem_27662.mem),
                                                &res_mem_27662.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984,
                                                11, sizeof(res_mem_27663.mem),
                                                &res_mem_27663.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984,
                                                12, sizeof(binop_x_27692),
                                                &binop_x_27692));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984,
                                                13, sizeof(res_mem_27736.mem),
                                                &res_mem_27736.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984,
                                                14, sizeof(res_mem_27737.mem),
                                                &res_mem_27737.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984,
                                                15, sizeof(mem_27753.mem),
                                                &mem_27753.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984,
                                                16, sizeof(mem_27758.mem),
                                                &mem_27758.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984,
                                                17, sizeof(mem_27760.mem),
                                                &mem_27760.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984,
                                                18, sizeof(mem_27763.mem),
                                                &mem_27763.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984,
                                                19, sizeof(mem_27765.mem),
                                                &mem_27765.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_26984,
                                                20, sizeof(num_threads_28341),
                                                &num_threads_28341));
        if (1 * ((size_t) stage1_num_groups_28340 *
                 (size_t) segscan_group_sizze_26979) != 0) {
            const size_t global_work_sizze_28998[1] =
                         {(size_t) stage1_num_groups_28340 *
                         (size_t) segscan_group_sizze_26979};
            const size_t local_work_sizze_29002[1] =
                         {segscan_group_sizze_26979};
            int64_t time_start_28999 = 0, time_end_29000 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage1_26984");
                fprintf(stderr, "%zu", global_work_sizze_28998[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29002[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                          segscan_group_sizze_26979) + smax64(1,
                                                                              (int32_t) sizeof(bool) *
                                                                              segscan_group_sizze_26979)));
                time_start_28999 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage1_26984,
                                                            1, NULL,
                                                            global_work_sizze_28998,
                                                            local_work_sizze_29002,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage1_26984_runs,
                                                                                                      &ctx->testziscan_stage1_26984_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29000 = get_wall_time();
                
                long time_diff_29001 = time_end_29000 - time_start_28999;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage1_26984", time_diff_29001);
            }
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_26979 *
                                 sdiv_up64(res_24015,
                                           sext_i32_i64(num_threads_28341))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26984, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(float) *
                                                       stage1_num_groups_28340),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26984, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       stage1_num_groups_28340),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26984, 3,
                                                sizeof(res_24015), &res_24015));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26984, 4,
                                                sizeof(mem_27763.mem),
                                                &mem_27763.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26984, 5,
                                                sizeof(mem_27765.mem),
                                                &mem_27765.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26984, 6,
                                                sizeof(stage1_num_groups_28340),
                                                &stage1_num_groups_28340));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_26984, 7,
                                                sizeof(num_threads_28341),
                                                &num_threads_28341));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28340) != 0) {
            const size_t global_work_sizze_29003[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28340};
            const size_t local_work_sizze_29007[1] = {stage1_num_groups_28340};
            int64_t time_start_29004 = 0, time_end_29005 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage2_26984");
                fprintf(stderr, "%zu", global_work_sizze_29003[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29007[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                          stage1_num_groups_28340) + smax64(1,
                                                                            (int32_t) sizeof(bool) *
                                                                            stage1_num_groups_28340)));
                time_start_29004 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage2_26984,
                                                            1, NULL,
                                                            global_work_sizze_29003,
                                                            local_work_sizze_29007,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage2_26984_runs,
                                                                                                      &ctx->testziscan_stage2_26984_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29005 = get_wall_time();
                
                long time_diff_29006 = time_end_29005 - time_start_29004;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage2_26984", time_diff_29006);
            }
        }
        
        int32_t required_groups_28393;
        
        required_groups_28393 = sext_i64_i32(sdiv_up64(res_24015,
                                                       segscan_group_sizze_26979));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26984, 1,
                                                sizeof(res_24015), &res_24015));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26984, 2,
                                                sizeof(num_groups_26981),
                                                &num_groups_26981));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26984, 3,
                                                sizeof(mem_27763.mem),
                                                &mem_27763.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26984, 4,
                                                sizeof(mem_27765.mem),
                                                &mem_27765.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26984, 5,
                                                sizeof(num_threads_28341),
                                                &num_threads_28341));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_26984, 6,
                                                sizeof(required_groups_28393),
                                                &required_groups_28393));
        if (1 * ((size_t) num_groups_26981 *
                 (size_t) segscan_group_sizze_26979) != 0) {
            const size_t global_work_sizze_29008[1] =
                         {(size_t) num_groups_26981 *
                         (size_t) segscan_group_sizze_26979};
            const size_t local_work_sizze_29012[1] =
                         {segscan_group_sizze_26979};
            int64_t time_start_29009 = 0, time_end_29010 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage3_26984");
                fprintf(stderr, "%zu", global_work_sizze_29008[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29012[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29009 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage3_26984,
                                                            1, NULL,
                                                            global_work_sizze_29008,
                                                            local_work_sizze_29012,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage3_26984_runs,
                                                                                                      &ctx->testziscan_stage3_26984_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29010 = get_wall_time();
                
                long time_diff_29011 = time_end_29010 - time_start_29009;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage3_26984", time_diff_29011);
            }
        }
    }
    if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27661, "res_mem_27661") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27662, "res_mem_27662") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27663, "res_mem_27663") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27736, "res_mem_27736") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27737, "res_mem_27737") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27753, "mem_27753") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27758, "mem_27758") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27763, "mem_27763") != 0)
        return 1;
    
    int64_t segscan_group_sizze_27031;
    
    segscan_group_sizze_27031 = ctx->sizes.testzisegscan_group_sizze_27030;
    
    int64_t num_groups_27033;
    int32_t max_num_groups_28405;
    
    max_num_groups_28405 = ctx->sizes.testzisegscan_num_groups_27032;
    num_groups_27033 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_24015,
                                                               sext_i32_i64(segscan_group_sizze_27031)),
                                                     sext_i32_i64(max_num_groups_28405))));
    
    struct memblock_device mem_27768;
    
    mem_27768.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27768, bytes_27746, "mem_27768")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_24015)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28406;
        
        stage1_max_num_groups_28406 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28407;
        
        stage1_num_groups_28407 = smin64(stage1_max_num_groups_28406,
                                         num_groups_27033);
        
        int32_t num_threads_28408;
        
        num_threads_28408 = sext_i64_i32(stage1_num_groups_28407 *
            segscan_group_sizze_27031);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27036, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_27031),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27036, 2,
                                                sizeof(res_24015), &res_24015));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27036, 3,
                                                sizeof(mem_27760.mem),
                                                &mem_27760.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27036, 4,
                                                sizeof(mem_27768.mem),
                                                &mem_27768.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27036, 5,
                                                sizeof(num_threads_28408),
                                                &num_threads_28408));
        if (1 * ((size_t) stage1_num_groups_28407 *
                 (size_t) segscan_group_sizze_27031) != 0) {
            const size_t global_work_sizze_29013[1] =
                         {(size_t) stage1_num_groups_28407 *
                         (size_t) segscan_group_sizze_27031};
            const size_t local_work_sizze_29017[1] =
                         {segscan_group_sizze_27031};
            int64_t time_start_29014 = 0, time_end_29015 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage1_27036");
                fprintf(stderr, "%zu", global_work_sizze_29013[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29017[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_27031)));
                time_start_29014 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage1_27036,
                                                            1, NULL,
                                                            global_work_sizze_29013,
                                                            local_work_sizze_29017,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage1_27036_runs,
                                                                                                      &ctx->testziscan_stage1_27036_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29015 = get_wall_time();
                
                long time_diff_29016 = time_end_29015 - time_start_29014;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage1_27036", time_diff_29016);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_27031 *
                                 sdiv_up64(res_24015,
                                           sext_i32_i64(num_threads_28408))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27036, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_28407),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27036, 2,
                                                sizeof(res_24015), &res_24015));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27036, 3,
                                                sizeof(mem_27768.mem),
                                                &mem_27768.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27036, 4,
                                                sizeof(stage1_num_groups_28407),
                                                &stage1_num_groups_28407));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27036, 5,
                                                sizeof(num_threads_28408),
                                                &num_threads_28408));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28407) != 0) {
            const size_t global_work_sizze_29018[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28407};
            const size_t local_work_sizze_29022[1] = {stage1_num_groups_28407};
            int64_t time_start_29019 = 0, time_end_29020 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage2_27036");
                fprintf(stderr, "%zu", global_work_sizze_29018[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29022[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_28407)));
                time_start_29019 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage2_27036,
                                                            1, NULL,
                                                            global_work_sizze_29018,
                                                            local_work_sizze_29022,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage2_27036_runs,
                                                                                                      &ctx->testziscan_stage2_27036_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29020 = get_wall_time();
                
                long time_diff_29021 = time_end_29020 - time_start_29019;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage2_27036", time_diff_29021);
            }
        }
        
        int32_t required_groups_28444;
        
        required_groups_28444 = sext_i64_i32(sdiv_up64(res_24015,
                                                       segscan_group_sizze_27031));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27036, 1,
                                                sizeof(res_24015), &res_24015));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27036, 2,
                                                sizeof(num_groups_27033),
                                                &num_groups_27033));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27036, 3,
                                                sizeof(mem_27768.mem),
                                                &mem_27768.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27036, 4,
                                                sizeof(num_threads_28408),
                                                &num_threads_28408));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27036, 5,
                                                sizeof(required_groups_28444),
                                                &required_groups_28444));
        if (1 * ((size_t) num_groups_27033 *
                 (size_t) segscan_group_sizze_27031) != 0) {
            const size_t global_work_sizze_29023[1] =
                         {(size_t) num_groups_27033 *
                         (size_t) segscan_group_sizze_27031};
            const size_t local_work_sizze_29027[1] =
                         {segscan_group_sizze_27031};
            int64_t time_start_29024 = 0, time_end_29025 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage3_27036");
                fprintf(stderr, "%zu", global_work_sizze_29023[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29027[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29024 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage3_27036,
                                                            1, NULL,
                                                            global_work_sizze_29023,
                                                            local_work_sizze_29027,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage3_27036_runs,
                                                                                                      &ctx->testziscan_stage3_27036_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29025 = get_wall_time();
                
                long time_diff_29026 = time_end_29025 - time_start_29024;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage3_27036", time_diff_29026);
            }
        }
    }
    
    bool cond_24206 = slt64(0, res_24015);
    int64_t num_segments_24207;
    
    if (cond_24206) {
        int64_t i_24208 = sub64(res_24015, 1);
        bool x_24209 = sle64(0, i_24208);
        bool y_24210 = slt64(i_24208, res_24015);
        bool bounds_check_24211 = x_24209 && y_24210;
        bool index_certs_24212;
        
        if (!bounds_check_24211) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_24208,
                                   "] out of bounds for array of shape [",
                                   res_24015, "].",
                                   "-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:29:36-59\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #4  cva3d.fut:134:18-77\n   #5  cva3d.fut:154:3-156:129\n   #6  cva3d.fut:153:1-156:137\n");
            if (memblock_unref_device(ctx, &mem_27768, "mem_27768") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27765, "mem_27765") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27763, "mem_27763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27760, "mem_27760") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27758, "mem_27758") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27756, "mem_27756") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27753, "mem_27753") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27751, "mem_27751") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_subhistos_mem_28058,
                                      "res_subhistos_mem_28058") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27747, "mem_27747") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28019,
                                      "group_res_arr_mem_28019") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27745, "mem_27745") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27742, "mem_27742") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27740, "mem_27740") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27737, "res_mem_27737") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27736, "res_mem_27736") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27663, "res_mem_27663") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27662, "res_mem_27662") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27661, "res_mem_27661") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_27879,
                                      "group_res_arr_mem_27879") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27641, "mem_27641") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27636, "mem_27636") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27634, "mem_27634") != 0)
                return 1;
            return 1;
        }
        
        int64_t read_res_29028;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27768.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     i_24208 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_29028, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t res_24213 = read_res_29028;
        
        num_segments_24207 = res_24213;
    } else {
        num_segments_24207 = 0;
    }
    
    bool bounds_invalid_upwards_24214 = slt64(num_segments_24207, 0);
    bool valid_24215 = !bounds_invalid_upwards_24214;
    bool range_valid_c_24216;
    
    if (!valid_24215) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", num_segments_24207,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:33:17-41\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva3d.fut:134:18-77\n   #6  cva3d.fut:154:3-156:129\n   #7  cva3d.fut:153:1-156:137\n");
        if (memblock_unref_device(ctx, &mem_27768, "mem_27768") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27765, "mem_27765") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27763, "mem_27763") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27760, "mem_27760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27758, "mem_27758") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27756, "mem_27756") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27753, "mem_27753") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27751, "mem_27751") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_subhistos_mem_28058,
                                  "res_subhistos_mem_28058") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27747, "mem_27747") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28019,
                                  "group_res_arr_mem_28019") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27745, "mem_27745") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27742, "mem_27742") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27740, "mem_27740") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27737, "res_mem_27737") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27736, "res_mem_27736") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27663, "res_mem_27663") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27662, "res_mem_27662") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27661, "res_mem_27661") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27879,
                                  "group_res_arr_mem_27879") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27641, "mem_27641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27636, "mem_27636") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27634, "mem_27634") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_27769 = 4 * num_segments_24207;
    struct memblock_device mem_27770;
    
    mem_27770.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27770, bytes_27769, "mem_27770")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f32(ctx, mem_27770, num_segments_24207,
                                      0.0F) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_27041;
    
    segmap_group_sizze_27041 = ctx->sizes.testzisegmap_group_sizze_27040;
    
    int64_t segmap_usable_groups_27042 = sdiv_up64(res_24015,
                                                   segmap_group_sizze_27041);
    
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27038, 1,
                                            sizeof(res_24015), &res_24015));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27038, 2,
                                            sizeof(num_segments_24207),
                                            &num_segments_24207));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27038, 3,
                                            sizeof(mem_27760.mem),
                                            &mem_27760.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27038, 4,
                                            sizeof(mem_27765.mem),
                                            &mem_27765.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27038, 5,
                                            sizeof(mem_27768.mem),
                                            &mem_27768.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27038, 6,
                                            sizeof(mem_27770.mem),
                                            &mem_27770.mem));
    if (1 * ((size_t) segmap_usable_groups_27042 *
             (size_t) segmap_group_sizze_27041) != 0) {
        const size_t global_work_sizze_29029[1] =
                     {(size_t) segmap_usable_groups_27042 *
                     (size_t) segmap_group_sizze_27041};
        const size_t local_work_sizze_29033[1] = {segmap_group_sizze_27041};
        int64_t time_start_29030 = 0, time_end_29031 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segmap_27038");
            fprintf(stderr, "%zu", global_work_sizze_29029[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_29033[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_29030 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegmap_27038,
                                                        1, NULL,
                                                        global_work_sizze_29029,
                                                        local_work_sizze_29033,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegmap_27038_runs,
                                                                                                  &ctx->testzisegmap_27038_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_29031 = get_wall_time();
            
            long time_diff_29032 = time_end_29031 - time_start_29030;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "test.segmap_27038",
                    time_diff_29032);
        }
    }
    if (memblock_unref_device(ctx, &mem_27760, "mem_27760") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27765, "mem_27765") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27768, "mem_27768") != 0)
        return 1;
    
    bool dim_match_24224 = binop_x_27692 == num_segments_24207;
    bool empty_or_match_cert_24225;
    
    if (!dim_match_24224) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Value of (core language) shape (",
                               num_segments_24207,
                               ") cannot match shape of type `[", binop_x_27692,
                               "]b`.",
                               "-> #0  lib/github.com/diku-dk/segmented/segmented.fut:103:6-45\n   #1  cva3d.fut:134:18-77\n   #2  cva3d.fut:154:3-156:129\n   #3  cva3d.fut:153:1-156:137\n");
        if (memblock_unref_device(ctx, &mem_27770, "mem_27770") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27768, "mem_27768") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27765, "mem_27765") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27763, "mem_27763") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27760, "mem_27760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27758, "mem_27758") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27756, "mem_27756") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27753, "mem_27753") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27751, "mem_27751") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_subhistos_mem_28058,
                                  "res_subhistos_mem_28058") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27747, "mem_27747") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28019,
                                  "group_res_arr_mem_28019") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27745, "mem_27745") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27742, "mem_27742") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27740, "mem_27740") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27737, "res_mem_27737") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27736, "res_mem_27736") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27663, "res_mem_27663") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27662, "res_mem_27662") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27661, "res_mem_27661") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27879,
                                  "group_res_arr_mem_27879") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27641, "mem_27641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27636, "mem_27636") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27634, "mem_27634") != 0)
            return 1;
        return 1;
    }
    
    float res_24226 = sitofp_i64_f32(paths_23826);
    bool suff_outer_redomap_27044;
    
    suff_outer_redomap_27044 = ctx->sizes.testzisuff_outer_redomap_10 <=
        steps_23827;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_outer_redomap_10",
                steps_23827);
    
    int64_t segred_group_sizze_27056;
    
    segred_group_sizze_27056 = ctx->sizes.testzisegred_group_sizze_27046;
    
    int64_t num_groups_27057;
    int32_t max_num_groups_28470;
    
    max_num_groups_28470 = ctx->sizes.testzisegred_num_groups_27048;
    num_groups_27057 = sext_i64_i32(smax64(1, smin64(sdiv_up64(steps_23827,
                                                               sext_i32_i64(segred_group_sizze_27056)),
                                                     sext_i32_i64(max_num_groups_28470))));
    
    bool suff_outer_par_27322;
    
    suff_outer_par_27322 = ctx->sizes.testzisuff_outer_par_11 <= steps_23827;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_outer_par_11",
                steps_23827);
    
    bool fits_27326 = sle64(paths_23826, max_group_sizze_26396);
    bool suff_intra_par_27328;
    
    suff_intra_par_27328 = ctx->sizes.testzisuff_intra_par_12 <= paths_23826;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_intra_par_12",
                paths_23826);
    
    bool intra_suff_and_fits_27329 = fits_27326 && suff_intra_par_27328;
    int64_t segmap_group_sizze_27332;
    
    segmap_group_sizze_27332 = ctx->sizes.testzisegmap_group_sizze_27109;
    
    int64_t segred_group_sizze_27403;
    
    segred_group_sizze_27403 = ctx->sizes.testzisegred_group_sizze_27249;
    
    int64_t num_groups_27404;
    int32_t max_num_groups_28471;
    
    max_num_groups_28471 = ctx->sizes.testzisegred_num_groups_27251;
    num_groups_27404 = sext_i64_i32(smax64(1, smin64(sdiv_up64(nest_sizze_26808,
                                                               sext_i32_i64(segred_group_sizze_27403)),
                                                     sext_i32_i64(max_num_groups_28471))));
    
    int64_t segmap_group_sizze_27419;
    
    segmap_group_sizze_27419 = ctx->sizes.testzisegmap_group_sizze_27222;
    
    int64_t segred_group_sizze_27445;
    
    segred_group_sizze_27445 = ctx->sizes.testzisegred_group_sizze_27312;
    
    int64_t num_groups_27446;
    int32_t max_num_groups_28472;
    
    max_num_groups_28472 = ctx->sizes.testzisegred_num_groups_27314;
    num_groups_27446 = sext_i64_i32(smax64(1, smin64(sdiv_up64(steps_23827,
                                                               sext_i32_i64(segred_group_sizze_27445)),
                                                     sext_i32_i64(max_num_groups_28472))));
    
    int64_t binop_x_27777 = 45 * paths_23826;
    int64_t binop_x_27778 = steps_23827 * binop_x_27777;
    int64_t bytes_27776 = 4 * binop_x_27778;
    float res_24229;
    int32_t local_memory_capacity_28632;
    
    local_memory_capacity_28632 = ctx->opencl.max_local_memory;
    if ((sle64(0, sext_i32_i64(local_memory_capacity_28632)) &&
         sle64((int32_t) sizeof(bool) + (int32_t) sizeof(float) *
               segred_group_sizze_27056,
               sext_i32_i64(local_memory_capacity_28632))) &&
        suff_outer_redomap_27044) {
        struct memblock_device mem_27775;
        
        mem_27775.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27775, bytes_27690, "mem_27775")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t group_sizze_28476;
        
        group_sizze_28476 = ctx->sizes.testzigroup_sizze_28476;
        
        int64_t num_groups_28477;
        
        num_groups_28477 = sdiv_up64(steps_23827 * paths_23826 * 45,
                                     group_sizze_28476);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28473, 0,
                                                sizeof(paths_23826),
                                                &paths_23826));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28473, 1,
                                                sizeof(steps_23827),
                                                &steps_23827));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28473, 2,
                                                sizeof(mem_27770.mem),
                                                &mem_27770.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28473, 3,
                                                sizeof(mem_27775.mem),
                                                &mem_27775.mem));
        if (1 * ((size_t) num_groups_28477 * (size_t) group_sizze_28476) != 0) {
            const size_t global_work_sizze_29034[1] =
                         {(size_t) num_groups_28477 *
                         (size_t) group_sizze_28476};
            const size_t local_work_sizze_29038[1] = {group_sizze_28476};
            int64_t time_start_29035 = 0, time_end_29036 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.copy_28473");
                fprintf(stderr, "%zu", global_work_sizze_29034[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29038[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29035 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzicopy_28473,
                                                            1, NULL,
                                                            global_work_sizze_29034,
                                                            local_work_sizze_29038,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzicopy_28473_runs,
                                                                                                      &ctx->testzicopy_28473_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29036 = get_wall_time();
                
                long time_diff_29037 = time_end_29036 - time_start_29035;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n", "test.copy_28473",
                        time_diff_29037);
            }
        }
        
        struct memblock_device mem_27779;
        
        mem_27779.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27779, bytes_27776, "mem_27779")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27779, 0, mem_27775,
                                                  0, 1, paths_23826 * 45,
                                                  steps_23827) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_unref_device(ctx, &mem_27775, "mem_27775") != 0)
            return 1;
        
        struct memblock_device mem_27782;
        
        mem_27782.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27782, 4, "mem_27782")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device testzicounter_mem_28478 =
                               ctx->testzicounter_mem_28478;
        struct memblock_device group_res_arr_mem_28480;
        
        group_res_arr_mem_28480.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28480,
                                  (int32_t) sizeof(float) *
                                  (segred_group_sizze_27056 * num_groups_27057),
                                  "group_res_arr_mem_28480")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28482;
        
        num_threads_28482 = num_groups_27057 * segred_group_sizze_27056;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27054,
                                                1, (int32_t) sizeof(float) *
                                                segred_group_sizze_27056,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27054,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27054,
                                                3, sizeof(paths_23826),
                                                &paths_23826));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27054,
                                                4, sizeof(steps_23827),
                                                &steps_23827));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27054,
                                                5, sizeof(sims_per_year_23906),
                                                &sims_per_year_23906));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27054,
                                                6, sizeof(res_24226),
                                                &res_24226));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27054,
                                                7, sizeof(num_groups_27057),
                                                &num_groups_27057));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27054,
                                                8, sizeof(mem_27779.mem),
                                                &mem_27779.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27054,
                                                9, sizeof(mem_27782.mem),
                                                &mem_27782.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27054,
                                                10,
                                                sizeof(testzicounter_mem_28478.mem),
                                                &testzicounter_mem_28478.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27054,
                                                11,
                                                sizeof(group_res_arr_mem_28480.mem),
                                                &group_res_arr_mem_28480.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27054,
                                                12, sizeof(num_threads_28482),
                                                &num_threads_28482));
        if (1 * ((size_t) num_groups_27057 *
                 (size_t) segred_group_sizze_27056) != 0) {
            const size_t global_work_sizze_29040[1] =
                         {(size_t) num_groups_27057 *
                         (size_t) segred_group_sizze_27056};
            const size_t local_work_sizze_29044[1] = {segred_group_sizze_27056};
            int64_t time_start_29041 = 0, time_end_29042 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segred_nonseg_27054");
                fprintf(stderr, "%zu", global_work_sizze_29040[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29044[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(float) *
                               segred_group_sizze_27056 +
                               (int32_t) sizeof(bool)));
                time_start_29041 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegred_nonseg_27054,
                                                            1, NULL,
                                                            global_work_sizze_29040,
                                                            local_work_sizze_29044,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegred_nonseg_27054_runs,
                                                                                                      &ctx->testzisegred_nonseg_27054_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29042 = get_wall_time();
                
                long time_diff_29043 = time_end_29042 - time_start_29041;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segred_nonseg_27054", time_diff_29043);
            }
        }
        if (memblock_unref_device(ctx, &mem_27779, "mem_27779") != 0)
            return 1;
        
        float read_res_29045;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27782.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(float),
                                                     sizeof(float),
                                                     &read_res_29045, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        float res_27095 = read_res_29045;
        
        if (memblock_unref_device(ctx, &mem_27782, "mem_27782") != 0)
            return 1;
        res_24229 = res_27095;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28480,
                                  "group_res_arr_mem_28480") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27782, "mem_27782") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27779, "mem_27779") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27775, "mem_27775") != 0)
            return 1;
    } else {
        struct memblock_device res_map_acc_mem_27809;
        
        res_map_acc_mem_27809.references = NULL;
        
        int32_t local_memory_capacity_28601;
        
        local_memory_capacity_28601 = ctx->opencl.max_local_memory;
        if ((sle64(0, sext_i32_i64(local_memory_capacity_28601)) && sle64(0,
                                                                          sext_i32_i64(local_memory_capacity_28601))) &&
            suff_outer_par_27322) {
            int64_t segmap_usable_groups_27333 = sdiv_up64(steps_23827,
                                                           segmap_group_sizze_27332);
            struct memblock_device mem_27786;
            
            mem_27786.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27786, bytes_27690,
                                      "mem_27786")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t group_sizze_28513;
            
            group_sizze_28513 = ctx->sizes.testzigroup_sizze_28513;
            
            int64_t num_groups_28514;
            
            num_groups_28514 = sdiv_up64(steps_23827 * paths_23826 * 45,
                                         group_sizze_28513);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28510, 0,
                                                    sizeof(paths_23826),
                                                    &paths_23826));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28510, 1,
                                                    sizeof(steps_23827),
                                                    &steps_23827));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28510, 2,
                                                    sizeof(mem_27770.mem),
                                                    &mem_27770.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28510, 3,
                                                    sizeof(mem_27786.mem),
                                                    &mem_27786.mem));
            if (1 * ((size_t) num_groups_28514 * (size_t) group_sizze_28513) !=
                0) {
                const size_t global_work_sizze_29046[1] =
                             {(size_t) num_groups_28514 *
                             (size_t) group_sizze_28513};
                const size_t local_work_sizze_29050[1] = {group_sizze_28513};
                int64_t time_start_29047 = 0, time_end_29048 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.copy_28510");
                    fprintf(stderr, "%zu", global_work_sizze_29046[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29050[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29047 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testzicopy_28510,
                                                                1, NULL,
                                                                global_work_sizze_29046,
                                                                local_work_sizze_29050,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testzicopy_28510_runs,
                                                                                                          &ctx->testzicopy_28510_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29048 = get_wall_time();
                    
                    long time_diff_29049 = time_end_29048 - time_start_29047;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.copy_28510", time_diff_29049);
                }
            }
            
            struct memblock_device mem_27790;
            
            mem_27790.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27790, bytes_27776,
                                      "mem_27790")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27790, 0,
                                                      mem_27786, 0, 1,
                                                      paths_23826 * 45,
                                                      steps_23827) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref_device(ctx, &mem_27786, "mem_27786") != 0)
                return 1;
            
            struct memblock_device mem_27793;
            
            mem_27793.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27793, bytes_27666,
                                      "mem_27793")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegMap");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27107, 1,
                                                    sizeof(paths_23826),
                                                    &paths_23826));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27107, 2,
                                                    sizeof(steps_23827),
                                                    &steps_23827));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27107, 3,
                                                    sizeof(sims_per_year_23906),
                                                    &sims_per_year_23906));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27107, 4,
                                                    sizeof(res_24226),
                                                    &res_24226));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27107, 5,
                                                    sizeof(mem_27790.mem),
                                                    &mem_27790.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27107, 6,
                                                    sizeof(mem_27793.mem),
                                                    &mem_27793.mem));
            if (1 * ((size_t) segmap_usable_groups_27333 *
                     (size_t) segmap_group_sizze_27332) != 0) {
                const size_t global_work_sizze_29051[1] =
                             {(size_t) segmap_usable_groups_27333 *
                             (size_t) segmap_group_sizze_27332};
                const size_t local_work_sizze_29055[1] =
                             {segmap_group_sizze_27332};
                int64_t time_start_29052 = 0, time_end_29053 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.segmap_27107");
                    fprintf(stderr, "%zu", global_work_sizze_29051[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29055[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29052 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testzisegmap_27107,
                                                                1, NULL,
                                                                global_work_sizze_29051,
                                                                local_work_sizze_29055,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testzisegmap_27107_runs,
                                                                                                          &ctx->testzisegmap_27107_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29053 = get_wall_time();
                    
                    long time_diff_29054 = time_end_29053 - time_start_29052;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.segmap_27107", time_diff_29054);
                }
            }
            if (memblock_unref_device(ctx, &mem_27790, "mem_27790") != 0)
                return 1;
            if (memblock_set_device(ctx, &res_map_acc_mem_27809, &mem_27793,
                                    "mem_27793") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27793, "mem_27793") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27790, "mem_27790") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27786, "mem_27786") != 0)
                return 1;
        } else {
            struct memblock_device res_map_acc_mem_27808;
            
            res_map_acc_mem_27808.references = NULL;
            
            int32_t local_memory_capacity_28600;
            
            local_memory_capacity_28600 = ctx->opencl.max_local_memory;
            if (sle64((int32_t) sizeof(float) * paths_23826,
                      sext_i32_i64(local_memory_capacity_28600)) &&
                intra_suff_and_fits_27329) {
                struct memblock_device mem_27797;
                
                mem_27797.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27797, bytes_27666,
                                          "mem_27797")) {
                    err = 1;
                    goto cleanup;
                }
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_27105,
                                                        1,
                                                        (int32_t) sizeof(float) *
                                                        paths_23826, NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_27105,
                                                        2, sizeof(paths_23826),
                                                        &paths_23826));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_27105,
                                                        3,
                                                        sizeof(sims_per_year_23906),
                                                        &sims_per_year_23906));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_27105,
                                                        4, sizeof(res_24226),
                                                        &res_24226));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_27105,
                                                        5,
                                                        sizeof(one_intra_par_min_26244),
                                                        &one_intra_par_min_26244));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_27105,
                                                        6,
                                                        sizeof(mem_27770.mem),
                                                        &mem_27770.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_27105,
                                                        7,
                                                        sizeof(mem_27797.mem),
                                                        &mem_27797.mem));
                if (1 * ((size_t) steps_23827 * (size_t) paths_23826) != 0) {
                    const size_t global_work_sizze_29056[1] =
                                 {(size_t) steps_23827 * (size_t) paths_23826};
                    const size_t local_work_sizze_29060[1] = {paths_23826};
                    int64_t time_start_29057 = 0, time_end_29058 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.segmap_intragroup_27105");
                        fprintf(stderr, "%zu", global_work_sizze_29056[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29060[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(float) *
                                       paths_23826));
                        time_start_29057 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testzisegmap_intragroup_27105,
                                                                    1, NULL,
                                                                    global_work_sizze_29056,
                                                                    local_work_sizze_29060,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testzisegmap_intragroup_27105_runs,
                                                                                                              &ctx->testzisegmap_intragroup_27105_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29058 = get_wall_time();
                        
                        long time_diff_29059 = time_end_29058 -
                             time_start_29057;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.segmap_intragroup_27105",
                                time_diff_29059);
                    }
                }
                if (memblock_set_device(ctx, &res_map_acc_mem_27808, &mem_27797,
                                        "mem_27797") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27797, "mem_27797") != 0)
                    return 1;
            } else {
                struct memblock_device mem_27801;
                
                mem_27801.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27801, bytes_27776,
                                          "mem_27801")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27801, 0,
                                                          mem_27770, 0, 1, 45,
                                                          paths_23826 *
                                                          steps_23827) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_27804;
                
                mem_27804.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27804, bytes_27666,
                                          "mem_27804")) {
                    err = 1;
                    goto cleanup;
                }
                if (slt64(paths_23826 * 2, segred_group_sizze_27403)) {
                    int64_t segment_sizze_nonzzero_28533 = smax64(1,
                                                                  paths_23826);
                    int64_t num_threads_28534 = num_groups_27404 *
                            segred_group_sizze_27403;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-small");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) steps_23827, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) paths_23826, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segments_per_group",
                                (long long) squot64(segred_group_sizze_27403,
                                                    segment_sizze_nonzzero_28533),
                                '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "required_groups",
                                (long long) sext_i64_i32(sdiv_up64(steps_23827,
                                                                   squot64(segred_group_sizze_27403,
                                                                           segment_sizze_nonzzero_28533))),
                                '\n');
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_27255,
                                                            1,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_27403,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_27255,
                                                            2,
                                                            sizeof(paths_23826),
                                                            &paths_23826));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_27255,
                                                            3,
                                                            sizeof(steps_23827),
                                                            &steps_23827));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_27255,
                                                            4,
                                                            sizeof(num_groups_27404),
                                                            &num_groups_27404));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_27255,
                                                            5,
                                                            sizeof(mem_27801.mem),
                                                            &mem_27801.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_27255,
                                                            6,
                                                            sizeof(mem_27804.mem),
                                                            &mem_27804.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_27255,
                                                            7,
                                                            sizeof(segment_sizze_nonzzero_28533),
                                                            &segment_sizze_nonzzero_28533));
                    if (1 * ((size_t) num_groups_27404 *
                             (size_t) segred_group_sizze_27403) != 0) {
                        const size_t global_work_sizze_29061[1] =
                                     {(size_t) num_groups_27404 *
                                     (size_t) segred_group_sizze_27403};
                        const size_t local_work_sizze_29065[1] =
                                     {segred_group_sizze_27403};
                        int64_t time_start_29062 = 0, time_end_29063 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.segred_small_27255");
                            fprintf(stderr, "%zu", global_work_sizze_29061[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29065[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(float) *
                                           segred_group_sizze_27403));
                            time_start_29062 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testzisegred_small_27255,
                                                                        1, NULL,
                                                                        global_work_sizze_29061,
                                                                        local_work_sizze_29065,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testzisegred_small_27255_runs,
                                                                                                                  &ctx->testzisegred_small_27255_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29063 = get_wall_time();
                            
                            long time_diff_29064 = time_end_29063 -
                                 time_start_29062;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.segred_small_27255", time_diff_29064);
                        }
                    }
                } else {
                    int64_t groups_per_segment_28555 =
                            sdiv_up64(num_groups_27404, smax64(1, steps_23827));
                    int64_t elements_per_thread_28556 = sdiv_up64(paths_23826,
                                                                  segred_group_sizze_27403 *
                                                                  groups_per_segment_28555);
                    int64_t virt_num_groups_28557 = groups_per_segment_28555 *
                            steps_23827;
                    int64_t num_threads_28558 = num_groups_27404 *
                            segred_group_sizze_27403;
                    int64_t threads_per_segment_28559 =
                            groups_per_segment_28555 * segred_group_sizze_27403;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-large");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) steps_23827, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) paths_23826, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                                (long long) virt_num_groups_28557, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_groups",
                                (long long) num_groups_27404, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "group_size",
                                (long long) segred_group_sizze_27403, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                                (long long) elements_per_thread_28556, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                                (long long) groups_per_segment_28555, '\n');
                    
                    struct memblock_device group_res_arr_mem_28560;
                    
                    group_res_arr_mem_28560.references = NULL;
                    if (memblock_alloc_device(ctx, &group_res_arr_mem_28560,
                                              (int32_t) sizeof(float) *
                                              (segred_group_sizze_27403 *
                                               virt_num_groups_28557),
                                              "group_res_arr_mem_28560")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device testzicounter_mem_28562 =
                                           ctx->testzicounter_mem_28562;
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27255,
                                                            1,
                                                            (int32_t) sizeof(bool),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27255,
                                                            2,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_27403,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27255,
                                                            3,
                                                            sizeof(paths_23826),
                                                            &paths_23826));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27255,
                                                            4,
                                                            sizeof(steps_23827),
                                                            &steps_23827));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27255,
                                                            5,
                                                            sizeof(num_groups_27404),
                                                            &num_groups_27404));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27255,
                                                            6,
                                                            sizeof(mem_27801.mem),
                                                            &mem_27801.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27255,
                                                            7,
                                                            sizeof(mem_27804.mem),
                                                            &mem_27804.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27255,
                                                            8,
                                                            sizeof(groups_per_segment_28555),
                                                            &groups_per_segment_28555));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27255,
                                                            9,
                                                            sizeof(elements_per_thread_28556),
                                                            &elements_per_thread_28556));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27255,
                                                            10,
                                                            sizeof(virt_num_groups_28557),
                                                            &virt_num_groups_28557));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27255,
                                                            11,
                                                            sizeof(threads_per_segment_28559),
                                                            &threads_per_segment_28559));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27255,
                                                            12,
                                                            sizeof(group_res_arr_mem_28560.mem),
                                                            &group_res_arr_mem_28560.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27255,
                                                            13,
                                                            sizeof(testzicounter_mem_28562.mem),
                                                            &testzicounter_mem_28562.mem));
                    if (1 * ((size_t) num_groups_27404 *
                             (size_t) segred_group_sizze_27403) != 0) {
                        const size_t global_work_sizze_29067[1] =
                                     {(size_t) num_groups_27404 *
                                     (size_t) segred_group_sizze_27403};
                        const size_t local_work_sizze_29071[1] =
                                     {segred_group_sizze_27403};
                        int64_t time_start_29068 = 0, time_end_29069 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.segred_large_27255");
                            fprintf(stderr, "%zu", global_work_sizze_29067[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29071[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(bool) +
                                           (int32_t) sizeof(float) *
                                           segred_group_sizze_27403));
                            time_start_29068 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testzisegred_large_27255,
                                                                        1, NULL,
                                                                        global_work_sizze_29067,
                                                                        local_work_sizze_29071,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testzisegred_large_27255_runs,
                                                                                                                  &ctx->testzisegred_large_27255_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29069 = get_wall_time();
                            
                            long time_diff_29070 = time_end_29069 -
                                 time_start_29068;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.segred_large_27255", time_diff_29070);
                        }
                    }
                    if (memblock_unref_device(ctx, &group_res_arr_mem_28560,
                                              "group_res_arr_mem_28560") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_27801, "mem_27801") != 0)
                    return 1;
                
                int64_t segmap_usable_groups_27420 = sdiv_up64(steps_23827,
                                                               segmap_group_sizze_27419);
                struct memblock_device mem_27807;
                
                mem_27807.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27807, bytes_27666,
                                          "mem_27807")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27220,
                                                        1, sizeof(steps_23827),
                                                        &steps_23827));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27220,
                                                        2,
                                                        sizeof(sims_per_year_23906),
                                                        &sims_per_year_23906));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27220,
                                                        3, sizeof(res_24226),
                                                        &res_24226));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27220,
                                                        4,
                                                        sizeof(mem_27804.mem),
                                                        &mem_27804.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27220,
                                                        5,
                                                        sizeof(mem_27807.mem),
                                                        &mem_27807.mem));
                if (1 * ((size_t) segmap_usable_groups_27420 *
                         (size_t) segmap_group_sizze_27419) != 0) {
                    const size_t global_work_sizze_29072[1] =
                                 {(size_t) segmap_usable_groups_27420 *
                                 (size_t) segmap_group_sizze_27419};
                    const size_t local_work_sizze_29076[1] =
                                 {segmap_group_sizze_27419};
                    int64_t time_start_29073 = 0, time_end_29074 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.segmap_27220");
                        fprintf(stderr, "%zu", global_work_sizze_29072[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29076[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_29073 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testzisegmap_27220,
                                                                    1, NULL,
                                                                    global_work_sizze_29072,
                                                                    local_work_sizze_29076,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testzisegmap_27220_runs,
                                                                                                              &ctx->testzisegmap_27220_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29074 = get_wall_time();
                        
                        long time_diff_29075 = time_end_29074 -
                             time_start_29073;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.segmap_27220", time_diff_29075);
                    }
                }
                if (memblock_unref_device(ctx, &mem_27804, "mem_27804") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_27808, &mem_27807,
                                        "mem_27807") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27807, "mem_27807") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27804, "mem_27804") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27801, "mem_27801") != 0)
                    return 1;
            }
            if (memblock_set_device(ctx, &res_map_acc_mem_27809,
                                    &res_map_acc_mem_27808,
                                    "res_map_acc_mem_27808") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_map_acc_mem_27808,
                                      "res_map_acc_mem_27808") != 0)
                return 1;
        }
        
        struct memblock_device mem_27812;
        
        mem_27812.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27812, 4, "mem_27812")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device testzicounter_mem_28602 =
                               ctx->testzicounter_mem_28602;
        struct memblock_device group_res_arr_mem_28604;
        
        group_res_arr_mem_28604.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28604,
                                  (int32_t) sizeof(float) *
                                  (segred_group_sizze_27445 * num_groups_27446),
                                  "group_res_arr_mem_28604")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28606;
        
        num_threads_28606 = num_groups_27446 * segred_group_sizze_27445;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27320,
                                                1, (int32_t) sizeof(float) *
                                                segred_group_sizze_27445,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27320,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27320,
                                                3, sizeof(steps_23827),
                                                &steps_23827));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27320,
                                                4, sizeof(num_groups_27446),
                                                &num_groups_27446));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27320,
                                                5,
                                                sizeof(res_map_acc_mem_27809.mem),
                                                &res_map_acc_mem_27809.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27320,
                                                6, sizeof(mem_27812.mem),
                                                &mem_27812.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27320,
                                                7,
                                                sizeof(testzicounter_mem_28602.mem),
                                                &testzicounter_mem_28602.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27320,
                                                8,
                                                sizeof(group_res_arr_mem_28604.mem),
                                                &group_res_arr_mem_28604.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27320,
                                                9, sizeof(num_threads_28606),
                                                &num_threads_28606));
        if (1 * ((size_t) num_groups_27446 *
                 (size_t) segred_group_sizze_27445) != 0) {
            const size_t global_work_sizze_29078[1] =
                         {(size_t) num_groups_27446 *
                         (size_t) segred_group_sizze_27445};
            const size_t local_work_sizze_29082[1] = {segred_group_sizze_27445};
            int64_t time_start_29079 = 0, time_end_29080 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segred_nonseg_27320");
                fprintf(stderr, "%zu", global_work_sizze_29078[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29082[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(float) *
                               segred_group_sizze_27445 +
                               (int32_t) sizeof(bool)));
                time_start_29079 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegred_nonseg_27320,
                                                            1, NULL,
                                                            global_work_sizze_29078,
                                                            local_work_sizze_29082,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegred_nonseg_27320_runs,
                                                                                                      &ctx->testzisegred_nonseg_27320_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29080 = get_wall_time();
                
                long time_diff_29081 = time_end_29080 - time_start_29079;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segred_nonseg_27320", time_diff_29081);
            }
        }
        if (memblock_unref_device(ctx, &res_map_acc_mem_27809,
                                  "res_map_acc_mem_27809") != 0)
            return 1;
        
        float read_res_29083;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27812.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(float),
                                                     sizeof(float),
                                                     &read_res_29083, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        float res_27453 = read_res_29083;
        
        if (memblock_unref_device(ctx, &mem_27812, "mem_27812") != 0)
            return 1;
        res_24229 = res_27453;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28604,
                                  "group_res_arr_mem_28604") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27812, "mem_27812") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_map_acc_mem_27809,
                                  "res_map_acc_mem_27809") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_27770, "mem_27770") != 0)
        return 1;
    
    float CVA_24265 = 6.0e-3F * res_24229;
    
    scalar_out_27872 = CVA_24265;
    *out_scalar_out_28873 = scalar_out_27872;
    if (memblock_unref_device(ctx, &mem_27770, "mem_27770") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27768, "mem_27768") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27765, "mem_27765") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27763, "mem_27763") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27760, "mem_27760") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27758, "mem_27758") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27756, "mem_27756") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27753, "mem_27753") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27751, "mem_27751") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_subhistos_mem_28058,
                              "res_subhistos_mem_28058") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27747, "mem_27747") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_28019,
                              "group_res_arr_mem_28019") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27745, "mem_27745") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27742, "mem_27742") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27740, "mem_27740") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27737, "res_mem_27737") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27736, "res_mem_27736") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27663, "res_mem_27663") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27662, "res_mem_27662") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27661, "res_mem_27661") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27660, "res_mem_27660") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_27879,
                              "group_res_arr_mem_27879") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27641, "mem_27641") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27638, "mem_27638") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27636, "mem_27636") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27634, "mem_27634") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
struct futhark_i64_1d {
    struct memblock_device mem;
    int64_t shape[1];
} ;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const
                                          int64_t *data, int64_t dim0)
{
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr =
                          (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(int64_t),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(int64_t) > 0)
        OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                      arr->mem.mem, CL_TRUE, 0,
                                                      (size_t) dim0 *
                                                      sizeof(int64_t), data + 0,
                                                      0, NULL,
                                                      ctx->profiling_paused ||
                                                      !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                &ctx->copy_dev_to_host_runs,
                                                                                                &ctx->copy_dev_to_host_total_runtime)));
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0)
{
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr =
                          (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(int64_t),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(int64_t) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue, data,
                                                     arr->mem.mem, offset, 0,
                                                     (size_t) dim0 *
                                                     sizeof(int64_t), 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx,
                          struct futhark_i64_1d *arr, int64_t *data)
{
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * sizeof(int64_t) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     arr->mem.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0, (size_t) arr->shape[0] *
                                                     sizeof(int64_t), data + 0,
                                                     0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_host_to_dev_runs,
                                                                                               &ctx->copy_host_to_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
    }
    lock_unlock(&ctx->lock);
    return 0;
}
cl_mem futhark_values_raw_i64_1d(struct futhark_context *ctx,
                                 struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx,
                                    struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_1d {
    struct memblock_device mem;
    int64_t shape[1];
} ;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const
                                          float *data, int64_t dim0)
{
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr =
                          (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(float),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(float) > 0)
        OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                      arr->mem.mem, CL_TRUE, 0,
                                                      (size_t) dim0 *
                                                      sizeof(float), data + 0,
                                                      0, NULL,
                                                      ctx->profiling_paused ||
                                                      !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                &ctx->copy_dev_to_host_runs,
                                                                                                &ctx->copy_dev_to_host_total_runtime)));
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0)
{
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr =
                          (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(float),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue, data,
                                                     arr->mem.mem, offset, 0,
                                                     (size_t) dim0 *
                                                     sizeof(float), 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_1d(struct futhark_context *ctx,
                          struct futhark_f32_1d *arr, float *data)
{
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     arr->mem.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0, (size_t) arr->shape[0] *
                                                     sizeof(float), data + 0, 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_host_to_dev_runs,
                                                                                               &ctx->copy_host_to_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
    }
    lock_unlock(&ctx->lock);
    return 0;
}
cl_mem futhark_values_raw_f32_1d(struct futhark_context *ctx,
                                 struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx,
                                    struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
int futhark_entry_main(struct futhark_context *ctx, float *out0,
                       struct futhark_f32_1d **out1, const int64_t in0, const
                       int64_t in1, const struct futhark_f32_1d *in2, const
                       struct futhark_i64_1d *in3, const
                       struct futhark_f32_1d *in4, const float in5, const
                       float in6, const float in7, const float in8)
{
    struct memblock_device swap_term_mem_27633;
    
    swap_term_mem_27633.references = NULL;
    
    struct memblock_device payments_mem_27634;
    
    payments_mem_27634.references = NULL;
    
    struct memblock_device notional_mem_27635;
    
    notional_mem_27635.references = NULL;
    
    int64_t n_23343;
    int64_t n_23344;
    int64_t n_23345;
    int64_t paths_23346;
    int64_t steps_23347;
    float a_23351;
    float b_23352;
    float sigma_23353;
    float r0_23354;
    float scalar_out_27872;
    struct memblock_device out_mem_27873;
    
    out_mem_27873.references = NULL;
    
    int64_t out_arrsizze_27874;
    
    lock_lock(&ctx->lock);
    paths_23346 = in0;
    steps_23347 = in1;
    swap_term_mem_27633 = in2->mem;
    n_23343 = in2->shape[0];
    payments_mem_27634 = in3->mem;
    n_23344 = in3->shape[0];
    notional_mem_27635 = in4->mem;
    n_23345 = in4->shape[0];
    a_23351 = in5;
    b_23352 = in6;
    sigma_23353 = in7;
    r0_23354 = in8;
    
    int ret = futrts_main(ctx, &scalar_out_27872, &out_mem_27873,
                          &out_arrsizze_27874, swap_term_mem_27633,
                          payments_mem_27634, notional_mem_27635, n_23343,
                          n_23344, n_23345, paths_23346, steps_23347, a_23351,
                          b_23352, sigma_23353, r0_23354);
    
    if (ret == 0) {
        *out0 = scalar_out_27872;
        assert((*out1 =
                (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) !=
            NULL);
        (*out1)->mem = out_mem_27873;
        (*out1)->shape[0] = out_arrsizze_27874;
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_test(struct futhark_context *ctx, float *out0, const
                       int64_t in0, const int64_t in1)
{
    int64_t paths_23826;
    int64_t steps_23827;
    float scalar_out_27872;
    
    lock_lock(&ctx->lock);
    paths_23826 = in0;
    steps_23827 = in1;
    
    int ret = futrts_test(ctx, &scalar_out_27872, paths_23826, steps_23827);
    
    if (ret == 0) {
        *out0 = scalar_out_27872;
    }
    lock_unlock(&ctx->lock);
    return ret;
}
