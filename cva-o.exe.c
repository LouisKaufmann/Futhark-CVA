#ifdef __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#endif
#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#endif
// Headers

#define _GNU_SOURCE
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#define CL_TARGET_OPENCL_VERSION 120
#define CL_USE_DEPRECATED_OPENCL_1_2_APIS
#ifdef __APPLE__
#define CL_SILENCE_DEPRECATION
#include <OpenCL/cl.h>
#else
#include <CL/cl.h>
#endif


// Initialisation

int futhark_get_num_sizes(void);
const char *futhark_get_size_name(int);
const char *futhark_get_size_class(int);
struct futhark_context_config ;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
void futhark_context_config_add_build_option(struct futhark_context_config *cfg,
                                             const char *opt);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int flag);
void futhark_context_config_set_device(struct futhark_context_config *cfg, const
                                       char *s);
void futhark_context_config_set_platform(struct futhark_context_config *cfg,
                                         const char *s);
void
futhark_context_config_select_device_interactively(struct futhark_context_config *cfg);
void futhark_context_config_list_devices(struct futhark_context_config *cfg);
void futhark_context_config_dump_program_to(struct futhark_context_config *cfg,
                                            const char *path);
void
futhark_context_config_load_program_from(struct futhark_context_config *cfg,
                                         const char *path);
void futhark_context_config_dump_binary_to(struct futhark_context_config *cfg,
                                           const char *path);
void futhark_context_config_load_binary_from(struct futhark_context_config *cfg,
                                             const char *path);
void
futhark_context_config_set_default_group_size(struct futhark_context_config *cfg,
                                              int size);
void
futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg,
                                              int num);
void
futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg,
                                             int num);
void
futhark_context_config_set_default_threshold(struct futhark_context_config *cfg,
                                             int num);
int futhark_context_config_set_size(struct futhark_context_config *cfg, const
                                    char *size_name, size_t size_value);
struct futhark_context ;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
struct futhark_context
*futhark_context_new_with_command_queue(struct futhark_context_config *cfg,
                                        cl_command_queue queue);
void futhark_context_free(struct futhark_context *ctx);
cl_command_queue futhark_context_get_command_queue(struct futhark_context *ctx);

// Arrays

struct futhark_f32_1d ;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const
                                          float *data, int64_t dim0);
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0);
int futhark_free_f32_1d(struct futhark_context *ctx,
                        struct futhark_f32_1d *arr);
int futhark_values_f32_1d(struct futhark_context *ctx,
                          struct futhark_f32_1d *arr, float *data);
cl_mem futhark_values_raw_f32_1d(struct futhark_context *ctx,
                                 struct futhark_f32_1d *arr);
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx,
                                    struct futhark_f32_1d *arr);
struct futhark_i64_1d ;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const
                                          int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx,
                        struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx,
                          struct futhark_i64_1d *arr, int64_t *data);
cl_mem futhark_values_raw_i64_1d(struct futhark_context *ctx,
                                 struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx,
                                    struct futhark_i64_1d *arr);

// Opaque values


// Entry points

int futhark_entry_main(struct futhark_context *ctx, float *out0,
                       struct futhark_f32_1d **out1, const int64_t in0, const
                       int64_t in1, const struct futhark_f32_1d *in2, const
                       struct futhark_i64_1d *in3, const
                       struct futhark_f32_1d *in4, const float in5, const
                       float in6, const float in7, const float in8);
int futhark_entry_test(struct futhark_context *ctx, float *out0, const
                       int64_t in0, const int64_t in1);

// Miscellaneous

int futhark_context_sync(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
#define FUTHARK_BACKEND_opencl
#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}


static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                            const char *msg, ...)
{
  if (errval) {
    char str[256];
    char errnum[10];
    sprintf(errnum, "%d", errval);
    sprintf(str, "ERROR: %s in %s() at line %d with error code %s\n", msg, fun, line,
            sets_errno ? strerror(errno) : errnum);
    fprintf(stderr, "%s", str);
    exit(errval);
  }
}

#define CHECK_ERR(err, msg...) check_err(err, 0, __func__, __LINE__, msg)
#define CHECK_ERRNO(err, msg...) check_err(err, 1, __func__, __LINE__, msg)

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  unsigned char *s;
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  fseek(f, 0, SEEK_END);
  size_t src_size = ftell(f);
  fseek(f, 0, SEEK_SET);
  s = (unsigned char*) malloc(src_size + 1);
  if (fread(s, 1, src_size, f) != src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }
  fclose(f);

  if (size) {
    *size = src_size;
  }

  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

// End of util.h.

// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}


static inline uint64_t rdtsc() {
  unsigned int hi, lo;
  __asm__ __volatile__("rdtsc" : "=a"(lo), "=d"(hi));
  return  ((uint64_t) lo) | (((uint64_t) hi) << 32);
}

static inline void rdtsc_wait(uint64_t n) {
  const uint64_t start = rdtsc();
  while (rdtsc() < (start + n)) {
    __asm__("PAUSE");
  }
}
static inline void spin_for(uint64_t nb_cycles) {
  rdtsc_wait(nb_cycles);
}


#endif

// End of timing.h.

#include <string.h>
#include <inttypes.h>
#include <errno.h>
#include <ctype.h>
#include <errno.h>
#include <getopt.h>
// Start of values.h.

//// Text I/O

typedef int (*writer)(FILE*, const void*);
typedef int (*bin_reader)(void*);
typedef int (*str_reader)(const char *, void*);

struct array_reader {
  char* elems;
  int64_t n_elems_space;
  int64_t elem_size;
  int64_t n_elems_used;
  int64_t *shape;
  str_reader elem_reader;
};

static void skipspaces() {
  int c;
  do {
    c = getchar();
  } while (isspace(c));

  if (c != EOF) {
    ungetc(c, stdin);
  }
}

static int constituent(char c) {
  return isalnum(c) || c == '.' || c == '-' || c == '+' || c == '_';
}

// Produces an empty token only on EOF.
static void next_token(char *buf, int bufsize) {
 start:
  skipspaces();

  int i = 0;
  while (i < bufsize) {
    int c = getchar();
    buf[i] = (char)c;

    if (c == EOF) {
      buf[i] = 0;
      return;
    } else if (c == '-' && i == 1 && buf[0] == '-') {
      // Line comment, so skip to end of line and start over.
      for (; c != '\n' && c != EOF; c = getchar());
      goto start;
    } else if (!constituent((char)c)) {
      if (i == 0) {
        // We permit single-character tokens that are not
        // constituents; this lets things like ']' and ',' be
        // tokens.
        buf[i+1] = 0;
        return;
      } else {
        ungetc(c, stdin);
        buf[i] = 0;
        return;
      }
    }

    i++;
  }

  buf[bufsize-1] = 0;
}

static int next_token_is(char *buf, int bufsize, const char* expected) {
  next_token(buf, bufsize);
  return strcmp(buf, expected) == 0;
}

static void remove_underscores(char *buf) {
  char *w = buf;

  for (char *r = buf; *r; r++) {
    if (*r != '_') {
      *w++ = *r;
    }
  }

  *w++ = 0;
}

static int read_str_elem(char *buf, struct array_reader *reader) {
  int ret;
  if (reader->n_elems_used == reader->n_elems_space) {
    reader->n_elems_space *= 2;
    reader->elems = (char*) realloc(reader->elems,
                                    (size_t)(reader->n_elems_space * reader->elem_size));
  }

  ret = reader->elem_reader(buf, reader->elems + reader->n_elems_used * reader->elem_size);

  if (ret == 0) {
    reader->n_elems_used++;
  }

  return ret;
}

static int read_str_array_elems(char *buf, int bufsize,
                                struct array_reader *reader, int64_t dims) {
  int ret;
  int first = 1;
  char *knows_dimsize = (char*) calloc((size_t)dims, sizeof(char));
  int cur_dim = dims-1;
  int64_t *elems_read_in_dim = (int64_t*) calloc((size_t)dims, sizeof(int64_t));

  while (1) {
    next_token(buf, bufsize);

    if (strcmp(buf, "]") == 0) {
      if (knows_dimsize[cur_dim]) {
        if (reader->shape[cur_dim] != elems_read_in_dim[cur_dim]) {
          ret = 1;
          break;
        }
      } else {
        knows_dimsize[cur_dim] = 1;
        reader->shape[cur_dim] = elems_read_in_dim[cur_dim];
      }
      if (cur_dim == 0) {
        ret = 0;
        break;
      } else {
        cur_dim--;
        elems_read_in_dim[cur_dim]++;
      }
    } else if (strcmp(buf, ",") == 0) {
      next_token(buf, bufsize);
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        first = 1;
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else if (cur_dim == dims - 1) {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
      } else {
        ret = 1;
        break;
      }
    } else if (strlen(buf) == 0) {
      // EOF
      ret = 1;
      break;
    } else if (first) {
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
        first = 0;
      }
    } else {
      ret = 1;
      break;
    }
  }

  free(knows_dimsize);
  free(elems_read_in_dim);
  return ret;
}

static int read_str_empty_array(char *buf, int bufsize,
                                const char *type_name, int64_t *shape, int64_t dims) {
  if (strlen(buf) == 0) {
    // EOF
    return 1;
  }

  if (strcmp(buf, "empty") != 0) {
    return 1;
  }

  if (!next_token_is(buf, bufsize, "(")) {
    return 1;
  }

  for (int i = 0; i < dims; i++) {
    if (!next_token_is(buf, bufsize, "[")) {
      return 1;
    }

    next_token(buf, bufsize);

    if (sscanf(buf, "%"SCNu64, (uint64_t*)&shape[i]) != 1) {
      return 1;
    }

    if (!next_token_is(buf, bufsize, "]")) {
      return 1;
    }
  }

  if (!next_token_is(buf, bufsize, type_name)) {
    return 1;
  }


  if (!next_token_is(buf, bufsize, ")")) {
    return 1;
  }

  // Check whether the array really is empty.
  for (int i = 0; i < dims; i++) {
    if (shape[i] == 0) {
      return 0;
    }
  }

  // Not an empty array!
  return 1;
}

static int read_str_array(int64_t elem_size, str_reader elem_reader,
                          const char *type_name,
                          void **data, int64_t *shape, int64_t dims) {
  int ret;
  struct array_reader reader;
  char buf[100];

  int dims_seen;
  for (dims_seen = 0; dims_seen < dims; dims_seen++) {
    if (!next_token_is(buf, sizeof(buf), "[")) {
      break;
    }
  }

  if (dims_seen == 0) {
    return read_str_empty_array(buf, sizeof(buf), type_name, shape, dims);
  }

  if (dims_seen != dims) {
    return 1;
  }

  reader.shape = shape;
  reader.n_elems_used = 0;
  reader.elem_size = elem_size;
  reader.n_elems_space = 16;
  reader.elems = (char*) realloc(*data, (size_t)(elem_size*reader.n_elems_space));
  reader.elem_reader = elem_reader;

  ret = read_str_array_elems(buf, sizeof(buf), &reader, dims);

  *data = reader.elems;

  return ret;
}

#define READ_STR(MACRO, PTR, SUFFIX)                                   \
  remove_underscores(buf);                                              \
  int j;                                                                \
  if (sscanf(buf, "%"MACRO"%n", (PTR*)dest, &j) == 1) {                 \
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, SUFFIX) == 0);     \
  } else {                                                              \
    return 1;                                                           \
  }

static int read_str_i8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNi8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(int8_t*)dest = (int8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "i8") == 0);
  } else {
    return 1;
  }
}

static int read_str_u8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNu8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(uint8_t*)dest = (uint8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "u8") == 0);
  } else {
    return 1;
  }
}

static int read_str_i16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "i16");
}

static int read_str_u16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "u16");
}

static int read_str_i32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "i32");
}

static int read_str_u32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "u32");
}

static int read_str_i64(char *buf, void* dest) {
  READ_STR(SCNi64, int64_t, "i64");
}

static int read_str_u64(char *buf, void* dest) {
  // FIXME: This is not correct, as SCNu64 only permits decimal
  // literals.  However, SCNi64 does not handle very large numbers
  // correctly (it's really for signed numbers, so that's fair).
  READ_STR(SCNu64, uint64_t, "u64");
}

static int read_str_f32(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f32.nan") == 0) {
    *(float*)dest = NAN;
    return 0;
  } else if (strcmp(buf, "f32.inf") == 0) {
    *(float*)dest = INFINITY;
    return 0;
  } else if (strcmp(buf, "-f32.inf") == 0) {
    *(float*)dest = -INFINITY;
    return 0;
  } else {
    READ_STR("f", float, "f32");
  }
}

static int read_str_f64(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f64.nan") == 0) {
    *(double*)dest = NAN;
    return 0;
  } else if (strcmp(buf, "f64.inf") == 0) {
    *(double*)dest = INFINITY;
    return 0;
  } else if (strcmp(buf, "-f64.inf") == 0) {
    *(double*)dest = -INFINITY;
    return 0;
  } else {
    READ_STR("lf", double, "f64");
  }
}

static int read_str_bool(char *buf, void* dest) {
  if (strcmp(buf, "true") == 0) {
    *(char*)dest = 1;
    return 0;
  } else if (strcmp(buf, "false") == 0) {
    *(char*)dest = 0;
    return 0;
  } else {
    return 1;
  }
}

static int write_str_i8(FILE *out, int8_t *src) {
  return fprintf(out, "%hhdi8", *src);
}

static int write_str_u8(FILE *out, uint8_t *src) {
  return fprintf(out, "%hhuu8", *src);
}

static int write_str_i16(FILE *out, int16_t *src) {
  return fprintf(out, "%hdi16", *src);
}

static int write_str_u16(FILE *out, uint16_t *src) {
  return fprintf(out, "%huu16", *src);
}

static int write_str_i32(FILE *out, int32_t *src) {
  return fprintf(out, "%di32", *src);
}

static int write_str_u32(FILE *out, uint32_t *src) {
  return fprintf(out, "%uu32", *src);
}

static int write_str_i64(FILE *out, int64_t *src) {
  return fprintf(out, "%"PRIi64"i64", *src);
}

static int write_str_u64(FILE *out, uint64_t *src) {
  return fprintf(out, "%"PRIu64"u64", *src);
}

static int write_str_f32(FILE *out, float *src) {
  float x = *src;
  if (isnan(x)) {
    return fprintf(out, "f32.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f32.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f32.inf");
  } else {
    return fprintf(out, "%.6ff32", x);
  }
}

static int write_str_f64(FILE *out, double *src) {
  double x = *src;
  if (isnan(x)) {
    return fprintf(out, "f64.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f64.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f64.inf");
  } else {
    return fprintf(out, "%.6ff64", *src);
  }
}

static int write_str_bool(FILE *out, void *src) {
  return fprintf(out, *(char*)src ? "true" : "false");
}

//// Binary I/O

#define BINARY_FORMAT_VERSION 2
#define IS_BIG_ENDIAN (!*(unsigned char *)&(uint16_t){1})

static void flip_bytes(int elem_size, unsigned char *elem) {
  for (int j=0; j<elem_size/2; j++) {
    unsigned char head = elem[j];
    int tail_index = elem_size-1-j;
    elem[j] = elem[tail_index];
    elem[tail_index] = head;
  }
}

// On Windows we need to explicitly set the file mode to not mangle
// newline characters.  On *nix there is no difference.
#ifdef _WIN32
#include <io.h>
#include <fcntl.h>
static void set_binary_mode(FILE *f) {
  setmode(fileno(f), O_BINARY);
}
#else
static void set_binary_mode(FILE *f) {
  (void)f;
}
#endif

static int read_byte(void* dest) {
  int num_elems_read = fread(dest, 1, 1, stdin);
  return num_elems_read == 1 ? 0 : 1;
}

//// Types

struct primtype_info_t {
  const char binname[4]; // Used for parsing binary data.
  const char* type_name; // Same name as in Futhark.
  const int64_t size; // in bytes
  const writer write_str; // Write in text format.
  const str_reader read_str; // Read in text format.
};

static const struct primtype_info_t i8_info =
  {.binname = "  i8", .type_name = "i8",   .size = 1,
   .write_str = (writer)write_str_i8, .read_str = (str_reader)read_str_i8};
static const struct primtype_info_t i16_info =
  {.binname = " i16", .type_name = "i16",  .size = 2,
   .write_str = (writer)write_str_i16, .read_str = (str_reader)read_str_i16};
static const struct primtype_info_t i32_info =
  {.binname = " i32", .type_name = "i32",  .size = 4,
   .write_str = (writer)write_str_i32, .read_str = (str_reader)read_str_i32};
static const struct primtype_info_t i64_info =
  {.binname = " i64", .type_name = "i64",  .size = 8,
   .write_str = (writer)write_str_i64, .read_str = (str_reader)read_str_i64};
static const struct primtype_info_t u8_info =
  {.binname = "  u8", .type_name = "u8",   .size = 1,
   .write_str = (writer)write_str_u8, .read_str = (str_reader)read_str_u8};
static const struct primtype_info_t u16_info =
  {.binname = " u16", .type_name = "u16",  .size = 2,
   .write_str = (writer)write_str_u16, .read_str = (str_reader)read_str_u16};
static const struct primtype_info_t u32_info =
  {.binname = " u32", .type_name = "u32",  .size = 4,
   .write_str = (writer)write_str_u32, .read_str = (str_reader)read_str_u32};
static const struct primtype_info_t u64_info =
  {.binname = " u64", .type_name = "u64",  .size = 8,
   .write_str = (writer)write_str_u64, .read_str = (str_reader)read_str_u64};
static const struct primtype_info_t f32_info =
  {.binname = " f32", .type_name = "f32",  .size = 4,
   .write_str = (writer)write_str_f32, .read_str = (str_reader)read_str_f32};
static const struct primtype_info_t f64_info =
  {.binname = " f64", .type_name = "f64",  .size = 8,
   .write_str = (writer)write_str_f64, .read_str = (str_reader)read_str_f64};
static const struct primtype_info_t bool_info =
  {.binname = "bool", .type_name = "bool", .size = 1,
   .write_str = (writer)write_str_bool, .read_str = (str_reader)read_str_bool};

static const struct primtype_info_t* primtypes[] = {
  &i8_info, &i16_info, &i32_info, &i64_info,
  &u8_info, &u16_info, &u32_info, &u64_info,
  &f32_info, &f64_info,
  &bool_info,
  NULL // NULL-terminated
};

// General value interface.  All endian business taken care of at
// lower layers.

static int read_is_binary() {
  skipspaces();
  int c = getchar();
  if (c == 'b') {
    int8_t bin_version;
    int ret = read_byte(&bin_version);

    if (ret != 0) { futhark_panic(1, "binary-input: could not read version.\n"); }

    if (bin_version != BINARY_FORMAT_VERSION) {
      futhark_panic(1, "binary-input: File uses version %i, but I only understand version %i.\n",
            bin_version, BINARY_FORMAT_VERSION);
    }

    return 1;
  }
  ungetc(c, stdin);
  return 0;
}

static const struct primtype_info_t* read_bin_read_type_enum() {
  char read_binname[4];

  int num_matched = scanf("%4c", read_binname);
  if (num_matched != 1) { futhark_panic(1, "binary-input: Couldn't read element type.\n"); }

  const struct primtype_info_t **type = primtypes;

  for (; *type != NULL; type++) {
    // I compare the 4 characters manually instead of using strncmp because
    // this allows any value to be used, also NULL bytes
    if (memcmp(read_binname, (*type)->binname, 4) == 0) {
      return *type;
    }
  }
  futhark_panic(1, "binary-input: Did not recognize the type '%s'.\n", read_binname);
  return NULL;
}

static void read_bin_ensure_scalar(const struct primtype_info_t *expected_type) {
  int8_t bin_dims;
  int ret = read_byte(&bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != 0) {
    futhark_panic(1, "binary-input: Expected scalar (0 dimensions), but got array with %i dimensions.\n",
          bin_dims);
  }

  const struct primtype_info_t *bin_type = read_bin_read_type_enum();
  if (bin_type != expected_type) {
    futhark_panic(1, "binary-input: Expected scalar of type %s but got scalar of type %s.\n",
          expected_type->type_name,
          bin_type->type_name);
  }
}

//// High-level interface

static int read_bin_array(const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  int ret;

  int8_t bin_dims;
  ret = read_byte(&bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != dims) {
    futhark_panic(1, "binary-input: Expected %i dimensions, but got array with %i dimensions.\n",
          dims, bin_dims);
  }

  const struct primtype_info_t *bin_primtype = read_bin_read_type_enum();
  if (expected_type != bin_primtype) {
    futhark_panic(1, "binary-input: Expected %iD-array with element type '%s' but got %iD-array with element type '%s'.\n",
          dims, expected_type->type_name, dims, bin_primtype->type_name);
  }

  int64_t elem_count = 1;
  for (int i=0; i<dims; i++) {
    int64_t bin_shape;
    ret = fread(&bin_shape, sizeof(bin_shape), 1, stdin);
    if (ret != 1) {
      futhark_panic(1, "binary-input: Couldn't read size for dimension %i of array.\n", i);
    }
    if (IS_BIG_ENDIAN) {
      flip_bytes(sizeof(bin_shape), (unsigned char*) &bin_shape);
    }
    elem_count *= bin_shape;
    shape[i] = bin_shape;
  }

  int64_t elem_size = expected_type->size;
  void* tmp = realloc(*data, (size_t)(elem_count * elem_size));
  if (tmp == NULL) {
    futhark_panic(1, "binary-input: Failed to allocate array of size %i.\n",
          elem_count * elem_size);
  }
  *data = tmp;

  int64_t num_elems_read = (int64_t)fread(*data, (size_t)elem_size, (size_t)elem_count, stdin);
  if (num_elems_read != elem_count) {
    futhark_panic(1, "binary-input: tried to read %i elements of an array, but only got %i elements.\n",
          elem_count, num_elems_read);
  }

  // If we're on big endian platform we must change all multibyte elements
  // from using little endian to big endian
  if (IS_BIG_ENDIAN && elem_size != 1) {
    flip_bytes(elem_size, (unsigned char*) *data);
  }

  return 0;
}

static int read_array(const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  if (!read_is_binary()) {
    return read_str_array(expected_type->size, (str_reader)expected_type->read_str, expected_type->type_name, data, shape, dims);
  } else {
    return read_bin_array(expected_type, data, shape, dims);
  }
}

static int end_of_input() {
  skipspaces();
  char token[2];
  next_token(token, sizeof(token));
  if (strcmp(token, "") == 0) {
    return 0;
  } else {
    return 1;
  }
}

static int write_str_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  if (rank==0) {
    elem_type->write_str(out, (void*)data);
  } else {
    int64_t len = (int64_t)shape[0];
    int64_t slice_size = 1;

    int64_t elem_size = elem_type->size;
    for (int8_t i = 1; i < rank; i++) {
      slice_size *= shape[i];
    }

    if (len*slice_size == 0) {
      printf("empty(");
      for (int64_t i = 0; i < rank; i++) {
        printf("[%"PRIi64"]", shape[i]);
      }
      printf("%s", elem_type->type_name);
      printf(")");
    } else if (rank==1) {
      putchar('[');
      for (int64_t i = 0; i < len; i++) {
        elem_type->write_str(out, (void*) (data + i * elem_size));
        if (i != len-1) {
          printf(", ");
        }
      }
      putchar(']');
    } else {
      putchar('[');
      for (int64_t i = 0; i < len; i++) {
        write_str_array(out, elem_type, data + i * slice_size * elem_size, shape+1, rank-1);
        if (i != len-1) {
          printf(", ");
        }
      }
      putchar(']');
    }
  }
  return 0;
}

static int write_bin_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  int64_t num_elems = 1;
  for (int64_t i = 0; i < rank; i++) {
    num_elems *= shape[i];
  }

  fputc('b', out);
  fputc((char)BINARY_FORMAT_VERSION, out);
  fwrite(&rank, sizeof(int8_t), 1, out);
  fputs(elem_type->binname, out);
  if (shape != NULL) {
    fwrite(shape, sizeof(int64_t), (size_t)rank, out);
  }

  if (IS_BIG_ENDIAN) {
    for (int64_t i = 0; i < num_elems; i++) {
      const unsigned char *elem = data+i*elem_type->size;
      for (int64_t j = 0; j < elem_type->size; j++) {
        fwrite(&elem[elem_type->size-j], 1, 1, out);
      }
    }
  } else {
    fwrite(data, (size_t)elem_type->size, (size_t)num_elems, out);
  }

  return 0;
}

static int write_array(FILE *out, int write_binary,
                       const struct primtype_info_t *elem_type,
                       const void *data,
                       const int64_t *shape,
                       const int8_t rank) {
  if (write_binary) {
    return write_bin_array(out, elem_type, data, shape, rank);
  } else {
    return write_str_array(out, elem_type, data, shape, rank);
  }
}

static int read_scalar(const struct primtype_info_t *expected_type, void *dest) {
  if (!read_is_binary()) {
    char buf[100];
    next_token(buf, sizeof(buf));
    return expected_type->read_str(buf, dest);
  } else {
    read_bin_ensure_scalar(expected_type);
    int64_t elem_size = expected_type->size;
    int num_elems_read = fread(dest, (size_t)elem_size, 1, stdin);
    if (IS_BIG_ENDIAN) {
      flip_bytes(elem_size, (unsigned char*) dest);
    }
    return num_elems_read == 1 ? 0 : 1;
  }
}

static int write_scalar(FILE *out, int write_binary, const struct primtype_info_t *type, void *src) {
  if (write_binary) {
    return write_bin_array(out, type, src, NULL, 0);
  } else {
    return type->write_str(out, src);
  }
}

// End of values.h.

#define __private
static int binary_output = 0;
static FILE *runtime_file;
static int perform_warmup = 0;
static int num_runs = 1;
static const char *entry_point = "main";
// Start of tuning.h.

static char* load_tuning_file(const char *fname,
                              void *cfg,
                              int (*set_size)(void*, const char*, size_t)) {
  const int max_line_len = 1024;
  char* line = (char*) malloc(max_line_len);

  FILE *f = fopen(fname, "r");

  if (f == NULL) {
    snprintf(line, max_line_len, "Cannot open file: %s", strerror(errno));
    return line;
  }

  int lineno = 0;
  while (fgets(line, max_line_len, f) != NULL) {
    lineno++;
    char *eql = strstr(line, "=");
    if (eql) {
      *eql = 0;
      int value = atoi(eql+1);
      if (set_size(cfg, line, value) != 0) {
        strncpy(eql+1, line, max_line_len-strlen(line)-1);
        snprintf(line, max_line_len, "Unknown name '%s' on line %d.", eql+1, lineno);
        return line;
      }
    } else {
      snprintf(line, max_line_len, "Invalid line %d (must be of form 'name=int').",
               lineno);
      return line;
    }
  }

  free(line);

  return NULL;
}

// End of tuning.h.

int parse_options(struct futhark_context_config *cfg, int argc,
                  char *const argv[])
{
    int ch;
    static struct option long_options[] = {{"write-runtime-to",
                                            required_argument, NULL, 1},
                                           {"runs", required_argument, NULL, 2},
                                           {"debugging", no_argument, NULL, 3},
                                           {"log", no_argument, NULL, 4},
                                           {"entry-point", required_argument,
                                            NULL, 5}, {"binary-output",
                                                       no_argument, NULL, 6},
                                           {"help", no_argument, NULL, 7},
                                           {"device", required_argument, NULL,
                                            8}, {"default-group-size",
                                                 required_argument, NULL, 9},
                                           {"default-num-groups",
                                            required_argument, NULL, 10},
                                           {"default-tile-size",
                                            required_argument, NULL, 11},
                                           {"default-threshold",
                                            required_argument, NULL, 12},
                                           {"print-sizes", no_argument, NULL,
                                            13}, {"size", required_argument,
                                                  NULL, 14}, {"tuning",
                                                              required_argument,
                                                              NULL, 15},
                                           {"platform", required_argument, NULL,
                                            16}, {"dump-opencl",
                                                  required_argument, NULL, 17},
                                           {"load-opencl", required_argument,
                                            NULL, 18}, {"dump-opencl-binary",
                                                        required_argument, NULL,
                                                        19},
                                           {"load-opencl-binary",
                                            required_argument, NULL, 20},
                                           {"build-option", required_argument,
                                            NULL, 21}, {"profile", no_argument,
                                                        NULL, 22},
                                           {"list-devices", no_argument, NULL,
                                            23}, {0, 0, 0, 0}};
    static char *option_descriptions =
                "  -t/--write-runtime-to FILE Print the time taken to execute the program to the indicated file, an integral number of microseconds.\n  -r/--runs INT              Perform NUM runs of the program.\n  -D/--debugging             Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                   Print various low-overhead logging information to stderr while running.\n  -e/--entry-point NAME      The entry point to run. Defaults to main.\n  -b/--binary-output         Print the program result in the binary output format.\n  -h/--help                  Print help information and exit.\n  -d/--device NAME           Use the first OpenCL device whose name contains the given string.\n  --default-group-size INT   The default size of OpenCL workgroups that are launched.\n  --default-num-groups INT   The default number of OpenCL workgroups that are launched.\n  --default-tile-size INT    The default tile size used when performing two-dimensional tiling.\n  --default-threshold INT    The default parallelism threshold.\n  --print-sizes              Print all sizes that can be set with -size or --tuning.\n  --size ASSIGNMENT          Set a configurable run-time parameter to the given value.\n  --tuning FILE              Read size=value assignments from the given file.\n  -p/--platform NAME         Use the first OpenCL platform whose name contains the given string.\n  --dump-opencl FILE         Dump the embedded OpenCL program to the indicated file.\n  --load-opencl FILE         Instead of using the embedded OpenCL program, load it from the indicated file.\n  --dump-opencl-binary FILE  Dump the compiled version of the embedded OpenCL program to the indicated file.\n  --load-opencl-binary FILE  Load an OpenCL binary from the indicated file.\n  --build-option OPT         Add an additional build option to the string passed to clBuildProgram().\n  -P/--profile               Gather profiling data while executing and print out a summary at the end.\n  --list-devices             List all OpenCL devices and platforms available on the system.\n";
    
    while ((ch = getopt_long(argc, argv, ":t:r:DLe:bhd:p:P", long_options,
                             NULL)) != -1) {
        if (ch == 1 || ch == 't') {
            runtime_file = fopen(optarg, "w");
            if (runtime_file == NULL)
                futhark_panic(1, "Cannot open %s: %s\n", optarg,
                              strerror(errno));
        }
        if (ch == 2 || ch == 'r') {
            num_runs = atoi(optarg);
            perform_warmup = 1;
            if (num_runs <= 0)
                futhark_panic(1, "Need a positive number of runs, not %s\n",
                              optarg);
        }
        if (ch == 3 || ch == 'D')
            futhark_context_config_set_debugging(cfg, 1);
        if (ch == 4 || ch == 'L')
            futhark_context_config_set_logging(cfg, 1);
        if (ch == 5 || ch == 'e') {
            if (entry_point != NULL)
                entry_point = optarg;
        }
        if (ch == 6 || ch == 'b')
            binary_output = 1;
        if (ch == 7 || ch == 'h') {
            printf("Usage: %s [OPTION]...\nOptions:\n\n%s\nFor more information, consult the Futhark User's Guide or the man pages.\n",
                   fut_progname, option_descriptions);
            exit(0);
        }
        if (ch == 8 || ch == 'd')
            futhark_context_config_set_device(cfg, optarg);
        if (ch == 9)
            futhark_context_config_set_default_group_size(cfg, atoi(optarg));
        if (ch == 10)
            futhark_context_config_set_default_num_groups(cfg, atoi(optarg));
        if (ch == 11)
            futhark_context_config_set_default_tile_size(cfg, atoi(optarg));
        if (ch == 12)
            futhark_context_config_set_default_threshold(cfg, atoi(optarg));
        if (ch == 13) {
            int n = futhark_get_num_sizes();
            
            for (int i = 0; i < n; i++)
                printf("%s (%s)\n", futhark_get_size_name(i),
                       futhark_get_size_class(i));
            exit(0);
        }
        if (ch == 14) {
            char *name = optarg;
            char *equals = strstr(optarg, "=");
            char *value_str = equals != NULL ? equals + 1 : optarg;
            int value = atoi(value_str);
            
            if (equals != NULL) {
                *equals = 0;
                if (futhark_context_config_set_size(cfg, name, value) != 0)
                    futhark_panic(1, "Unknown size: %s\n", name);
            } else
                futhark_panic(1, "Invalid argument for size option: %s\n",
                              optarg);
        }
        if (ch == 15) {
            char *ret = load_tuning_file(optarg, cfg, (int (*)(void *, const
                                                               char *,
                                                               size_t)) futhark_context_config_set_size);
            
            if (ret != NULL)
                futhark_panic(1, "When loading tuning from '%s': %s\n", optarg,
                              ret);
        }
        if (ch == 16 || ch == 'p')
            futhark_context_config_set_platform(cfg, optarg);
        if (ch == 17) {
            futhark_context_config_dump_program_to(cfg, optarg);
            entry_point = NULL;
        }
        if (ch == 18)
            futhark_context_config_load_program_from(cfg, optarg);
        if (ch == 19) {
            futhark_context_config_dump_binary_to(cfg, optarg);
            entry_point = NULL;
        }
        if (ch == 20)
            futhark_context_config_load_binary_from(cfg, optarg);
        if (ch == 21)
            futhark_context_config_add_build_option(cfg, optarg);
        if (ch == 22 || ch == 'P')
            futhark_context_config_set_profiling(cfg, 1);
        if (ch == 23) {
            futhark_context_config_list_devices(cfg);
            entry_point = NULL;
        }
        if (ch == ':')
            futhark_panic(-1, "Missing argument for option %s\n", argv[optind -
                                                                       1]);
        if (ch == '?') {
            fprintf(stderr, "Usage: %s: %s\n", fut_progname,
                    "  -t/--write-runtime-to FILE Print the time taken to execute the program to the indicated file, an integral number of microseconds.\n  -r/--runs INT              Perform NUM runs of the program.\n  -D/--debugging             Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                   Print various low-overhead logging information to stderr while running.\n  -e/--entry-point NAME      The entry point to run. Defaults to main.\n  -b/--binary-output         Print the program result in the binary output format.\n  -h/--help                  Print help information and exit.\n  -d/--device NAME           Use the first OpenCL device whose name contains the given string.\n  --default-group-size INT   The default size of OpenCL workgroups that are launched.\n  --default-num-groups INT   The default number of OpenCL workgroups that are launched.\n  --default-tile-size INT    The default tile size used when performing two-dimensional tiling.\n  --default-threshold INT    The default parallelism threshold.\n  --print-sizes              Print all sizes that can be set with -size or --tuning.\n  --size ASSIGNMENT          Set a configurable run-time parameter to the given value.\n  --tuning FILE              Read size=value assignments from the given file.\n  -p/--platform NAME         Use the first OpenCL platform whose name contains the given string.\n  --dump-opencl FILE         Dump the embedded OpenCL program to the indicated file.\n  --load-opencl FILE         Instead of using the embedded OpenCL program, load it from the indicated file.\n  --dump-opencl-binary FILE  Dump the compiled version of the embedded OpenCL program to the indicated file.\n  --load-opencl-binary FILE  Load an OpenCL binary from the indicated file.\n  --build-option OPT         Add an additional build option to the string passed to clBuildProgram().\n  -P/--profile               Gather profiling data while executing and print out a summary at the end.\n  --list-devices             List all OpenCL devices and platforms available on the system.\n");
            futhark_panic(1, "Unknown option: %s\n", argv[optind - 1]);
        }
    }
    return optind;
}
static void futrts_cli_entry_main(struct futhark_context *ctx)
{
    int64_t t_start, t_end;
    int time_runs = 0, profile_run = 0;
    
    // We do not want to profile all the initialisation.
    futhark_context_pause_profiling(ctx);
    // Declare and read input.
    set_binary_mode(stdin);
    
    int64_t read_value_29701;
    
    if (read_scalar(&i64_info, &read_value_29701) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      0, i64_info.type_name, strerror(errno));
    
    int64_t read_value_29702;
    
    if (read_scalar(&i64_info, &read_value_29702) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      1, i64_info.type_name, strerror(errno));
    
    struct futhark_f32_1d *read_value_29703;
    int64_t read_shape_29704[1];
    float *read_arr_29705 = NULL;
    
    errno = 0;
    if (read_array(&f32_info, (void **) &read_arr_29705, read_shape_29704, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s%s (errno: %s).\n", 2,
                      "[]", f32_info.type_name, strerror(errno));
    
    struct futhark_i64_1d *read_value_29706;
    int64_t read_shape_29707[1];
    int64_t *read_arr_29708 = NULL;
    
    errno = 0;
    if (read_array(&i64_info, (void **) &read_arr_29708, read_shape_29707, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s%s (errno: %s).\n", 3,
                      "[]", i64_info.type_name, strerror(errno));
    
    struct futhark_f32_1d *read_value_29709;
    int64_t read_shape_29710[1];
    float *read_arr_29711 = NULL;
    
    errno = 0;
    if (read_array(&f32_info, (void **) &read_arr_29711, read_shape_29710, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s%s (errno: %s).\n", 4,
                      "[]", f32_info.type_name, strerror(errno));
    
    float read_value_29712;
    
    if (read_scalar(&f32_info, &read_value_29712) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      5, f32_info.type_name, strerror(errno));
    
    float read_value_29713;
    
    if (read_scalar(&f32_info, &read_value_29713) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      6, f32_info.type_name, strerror(errno));
    
    float read_value_29714;
    
    if (read_scalar(&f32_info, &read_value_29714) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      7, f32_info.type_name, strerror(errno));
    
    float read_value_29715;
    
    if (read_scalar(&f32_info, &read_value_29715) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      8, f32_info.type_name, strerror(errno));
    if (end_of_input() != 0)
        futhark_panic(1, "Expected EOF on stdin after reading input for %s.\n",
                      "\"main\"");
    
    float result_29716;
    struct futhark_f32_1d *result_29717;
    
    if (perform_warmup) {
        int r;
        
        ;
        ;
        assert((read_value_29703 = futhark_new_f32_1d(ctx, read_arr_29705,
                                                      read_shape_29704[0])) !=
            0);
        assert((read_value_29706 = futhark_new_i64_1d(ctx, read_arr_29708,
                                                      read_shape_29707[0])) !=
            0);
        assert((read_value_29709 = futhark_new_f32_1d(ctx, read_arr_29711,
                                                      read_shape_29710[0])) !=
            0);
        ;
        ;
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_main(ctx, &result_29716, &result_29717,
                               read_value_29701, read_value_29702,
                               read_value_29703, read_value_29706,
                               read_value_29709, read_value_29712,
                               read_value_29713, read_value_29714,
                               read_value_29715);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        assert(futhark_free_f32_1d(ctx, read_value_29703) == 0);
        assert(futhark_free_i64_1d(ctx, read_value_29706) == 0);
        assert(futhark_free_f32_1d(ctx, read_value_29709) == 0);
        ;
        ;
        ;
        ;
        ;
        assert(futhark_free_f32_1d(ctx, result_29717) == 0);
    }
    time_runs = 1;
    // Proper run.
    for (int run = 0; run < num_runs; run++) {
        // Only profile last run.
        profile_run = run == num_runs - 1;
        
        int r;
        
        ;
        ;
        assert((read_value_29703 = futhark_new_f32_1d(ctx, read_arr_29705,
                                                      read_shape_29704[0])) !=
            0);
        assert((read_value_29706 = futhark_new_i64_1d(ctx, read_arr_29708,
                                                      read_shape_29707[0])) !=
            0);
        assert((read_value_29709 = futhark_new_f32_1d(ctx, read_arr_29711,
                                                      read_shape_29710[0])) !=
            0);
        ;
        ;
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_main(ctx, &result_29716, &result_29717,
                               read_value_29701, read_value_29702,
                               read_value_29703, read_value_29706,
                               read_value_29709, read_value_29712,
                               read_value_29713, read_value_29714,
                               read_value_29715);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        assert(futhark_free_f32_1d(ctx, read_value_29703) == 0);
        assert(futhark_free_i64_1d(ctx, read_value_29706) == 0);
        assert(futhark_free_f32_1d(ctx, read_value_29709) == 0);
        ;
        ;
        ;
        ;
        if (run < num_runs - 1) {
            ;
            assert(futhark_free_f32_1d(ctx, result_29717) == 0);
        }
    }
    ;
    ;
    free(read_arr_29705);
    free(read_arr_29708);
    free(read_arr_29711);
    ;
    ;
    ;
    ;
    if (binary_output)
        set_binary_mode(stdout);
    write_scalar(stdout, binary_output, &f32_info, &result_29716);
    printf("\n");
    {
        float *arr = calloc(sizeof(float), futhark_shape_f32_1d(ctx,
                                                                result_29717)[0]);
        
        assert(arr != NULL);
        assert(futhark_values_f32_1d(ctx, result_29717, arr) == 0);
        write_array(stdout, binary_output, &f32_info, arr,
                    futhark_shape_f32_1d(ctx, result_29717), 1);
        free(arr);
    }
    printf("\n");
    ;
    assert(futhark_free_f32_1d(ctx, result_29717) == 0);
}
static void futrts_cli_entry_test(struct futhark_context *ctx)
{
    int64_t t_start, t_end;
    int time_runs = 0, profile_run = 0;
    
    // We do not want to profile all the initialisation.
    futhark_context_pause_profiling(ctx);
    // Declare and read input.
    set_binary_mode(stdin);
    
    int64_t read_value_29718;
    
    if (read_scalar(&i64_info, &read_value_29718) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      0, i64_info.type_name, strerror(errno));
    
    int64_t read_value_29719;
    
    if (read_scalar(&i64_info, &read_value_29719) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      1, i64_info.type_name, strerror(errno));
    if (end_of_input() != 0)
        futhark_panic(1, "Expected EOF on stdin after reading input for %s.\n",
                      "\"test\"");
    
    float result_29720;
    
    if (perform_warmup) {
        int r;
        
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_test(ctx, &result_29720, read_value_29718,
                               read_value_29719);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        ;
    }
    time_runs = 1;
    // Proper run.
    for (int run = 0; run < num_runs; run++) {
        // Only profile last run.
        profile_run = run == num_runs - 1;
        
        int r;
        
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_test(ctx, &result_29720, read_value_29718,
                               read_value_29719);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        if (run < num_runs - 1) {
            ;
        }
    }
    ;
    ;
    if (binary_output)
        set_binary_mode(stdout);
    write_scalar(stdout, binary_output, &f32_info, &result_29720);
    printf("\n");
    ;
}
typedef void entry_point_fun(struct futhark_context *);
struct entry_point_entry {
    const char *name;
    entry_point_fun *fun;
} ;
int main(int argc, char **argv)
{
    fut_progname = argv[0];
    
    struct entry_point_entry entry_points[] = {{.name ="main", .fun =
                                                futrts_cli_entry_main}, {.name =
                                                                         "test",
                                                                         .fun =
                                                                         futrts_cli_entry_test}};
    struct futhark_context_config *cfg = futhark_context_config_new();
    
    assert(cfg != NULL);
    
    int parsed_options = parse_options(cfg, argc, argv);
    
    argc -= parsed_options;
    argv += parsed_options;
    if (argc != 0)
        futhark_panic(1, "Excess non-option: %s\n", argv[0]);
    
    struct futhark_context *ctx = futhark_context_new(cfg);
    
    assert(ctx != NULL);
    
    char *error = futhark_context_get_error(ctx);
    
    if (error != NULL)
        futhark_panic(1, "%s", error);
    if (entry_point != NULL) {
        int num_entry_points = sizeof(entry_points) / sizeof(entry_points[0]);
        entry_point_fun *entry_point_fun = NULL;
        
        for (int i = 0; i < num_entry_points; i++) {
            if (strcmp(entry_points[i].name, entry_point) == 0) {
                entry_point_fun = entry_points[i].fun;
                break;
            }
        }
        if (entry_point_fun == NULL) {
            fprintf(stderr,
                    "No entry point '%s'.  Select another with --entry-point.  Options are:\n",
                    entry_point);
            for (int i = 0; i < num_entry_points; i++)
                fprintf(stderr, "%s\n", entry_points[i].name);
            return 1;
        }
        entry_point_fun(ctx);
        if (runtime_file != NULL)
            fclose(runtime_file);
        
        char *report = futhark_context_report(ctx);
        
        fputs(report, stderr);
        free(report);
    }
    futhark_context_free(ctx);
    futhark_context_config_free(cfg);
    return 0;
}
#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <inttypes.h>
#include <ctype.h>
#include <errno.h>
#include <assert.h>
#define CL_TARGET_OPENCL_VERSION 120
#define CL_USE_DEPRECATED_OPENCL_1_2_APIS
#ifdef __APPLE__
#define CL_SILENCE_DEPRECATION
#include <OpenCL/cl.h>
#else
#include <CL/cl.h>
#endif

// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.

static inline uint8_t add8(uint8_t x, uint8_t y)
{
    return x + y;
}
static inline uint16_t add16(uint16_t x, uint16_t y)
{
    return x + y;
}
static inline uint32_t add32(uint32_t x, uint32_t y)
{
    return x + y;
}
static inline uint64_t add64(uint64_t x, uint64_t y)
{
    return x + y;
}
static inline uint8_t sub8(uint8_t x, uint8_t y)
{
    return x - y;
}
static inline uint16_t sub16(uint16_t x, uint16_t y)
{
    return x - y;
}
static inline uint32_t sub32(uint32_t x, uint32_t y)
{
    return x - y;
}
static inline uint64_t sub64(uint64_t x, uint64_t y)
{
    return x - y;
}
static inline uint8_t mul8(uint8_t x, uint8_t y)
{
    return x * y;
}
static inline uint16_t mul16(uint16_t x, uint16_t y)
{
    return x * y;
}
static inline uint32_t mul32(uint32_t x, uint32_t y)
{
    return x * y;
}
static inline uint64_t mul64(uint64_t x, uint64_t y)
{
    return x * y;
}
static inline uint8_t udiv8(uint8_t x, uint8_t y)
{
    return x / y;
}
static inline uint16_t udiv16(uint16_t x, uint16_t y)
{
    return x / y;
}
static inline uint32_t udiv32(uint32_t x, uint32_t y)
{
    return x / y;
}
static inline uint64_t udiv64(uint64_t x, uint64_t y)
{
    return x / y;
}
static inline uint8_t udiv_up8(uint8_t x, uint8_t y)
{
    return (x + y - 1) / y;
}
static inline uint16_t udiv_up16(uint16_t x, uint16_t y)
{
    return (x + y - 1) / y;
}
static inline uint32_t udiv_up32(uint32_t x, uint32_t y)
{
    return (x + y - 1) / y;
}
static inline uint64_t udiv_up64(uint64_t x, uint64_t y)
{
    return (x + y - 1) / y;
}
static inline uint8_t umod8(uint8_t x, uint8_t y)
{
    return x % y;
}
static inline uint16_t umod16(uint16_t x, uint16_t y)
{
    return x % y;
}
static inline uint32_t umod32(uint32_t x, uint32_t y)
{
    return x % y;
}
static inline uint64_t umod64(uint64_t x, uint64_t y)
{
    return x % y;
}
static inline uint8_t udiv_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint16_t udiv_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint32_t udiv_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint64_t udiv_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint8_t umod_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint16_t umod_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint32_t umod_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint64_t umod_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int8_t sdiv8(int8_t x, int8_t y)
{
    int8_t q = x / y;
    int8_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int16_t sdiv16(int16_t x, int16_t y)
{
    int16_t q = x / y;
    int16_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int32_t sdiv32(int32_t x, int32_t y)
{
    int32_t q = x / y;
    int32_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int64_t sdiv64(int64_t x, int64_t y)
{
    int64_t q = x / y;
    int64_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int8_t sdiv_up8(int8_t x, int8_t y)
{
    return sdiv8(x + y - 1, y);
}
static inline int16_t sdiv_up16(int16_t x, int16_t y)
{
    return sdiv16(x + y - 1, y);
}
static inline int32_t sdiv_up32(int32_t x, int32_t y)
{
    return sdiv32(x + y - 1, y);
}
static inline int64_t sdiv_up64(int64_t x, int64_t y)
{
    return sdiv64(x + y - 1, y);
}
static inline int8_t smod8(int8_t x, int8_t y)
{
    int8_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int16_t smod16(int16_t x, int16_t y)
{
    int16_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int32_t smod32(int32_t x, int32_t y)
{
    int32_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int64_t smod64(int64_t x, int64_t y)
{
    int64_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int8_t sdiv_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : sdiv8(x, y);
}
static inline int16_t sdiv_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : sdiv16(x, y);
}
static inline int32_t sdiv_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : sdiv32(x, y);
}
static inline int64_t sdiv_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : sdiv64(x, y);
}
static inline int8_t sdiv_up_safe8(int8_t x, int8_t y)
{
    return sdiv_safe8(x + y - 1, y);
}
static inline int16_t sdiv_up_safe16(int16_t x, int16_t y)
{
    return sdiv_safe16(x + y - 1, y);
}
static inline int32_t sdiv_up_safe32(int32_t x, int32_t y)
{
    return sdiv_safe32(x + y - 1, y);
}
static inline int64_t sdiv_up_safe64(int64_t x, int64_t y)
{
    return sdiv_safe64(x + y - 1, y);
}
static inline int8_t smod_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : smod8(x, y);
}
static inline int16_t smod_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : smod16(x, y);
}
static inline int32_t smod_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : smod32(x, y);
}
static inline int64_t smod_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : smod64(x, y);
}
static inline int8_t squot8(int8_t x, int8_t y)
{
    return x / y;
}
static inline int16_t squot16(int16_t x, int16_t y)
{
    return x / y;
}
static inline int32_t squot32(int32_t x, int32_t y)
{
    return x / y;
}
static inline int64_t squot64(int64_t x, int64_t y)
{
    return x / y;
}
static inline int8_t srem8(int8_t x, int8_t y)
{
    return x % y;
}
static inline int16_t srem16(int16_t x, int16_t y)
{
    return x % y;
}
static inline int32_t srem32(int32_t x, int32_t y)
{
    return x % y;
}
static inline int64_t srem64(int64_t x, int64_t y)
{
    return x % y;
}
static inline int8_t squot_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int16_t squot_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int32_t squot_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int64_t squot_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int8_t srem_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int16_t srem_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int32_t srem_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int64_t srem_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int8_t smin8(int8_t x, int8_t y)
{
    return x < y ? x : y;
}
static inline int16_t smin16(int16_t x, int16_t y)
{
    return x < y ? x : y;
}
static inline int32_t smin32(int32_t x, int32_t y)
{
    return x < y ? x : y;
}
static inline int64_t smin64(int64_t x, int64_t y)
{
    return x < y ? x : y;
}
static inline uint8_t umin8(uint8_t x, uint8_t y)
{
    return x < y ? x : y;
}
static inline uint16_t umin16(uint16_t x, uint16_t y)
{
    return x < y ? x : y;
}
static inline uint32_t umin32(uint32_t x, uint32_t y)
{
    return x < y ? x : y;
}
static inline uint64_t umin64(uint64_t x, uint64_t y)
{
    return x < y ? x : y;
}
static inline int8_t smax8(int8_t x, int8_t y)
{
    return x < y ? y : x;
}
static inline int16_t smax16(int16_t x, int16_t y)
{
    return x < y ? y : x;
}
static inline int32_t smax32(int32_t x, int32_t y)
{
    return x < y ? y : x;
}
static inline int64_t smax64(int64_t x, int64_t y)
{
    return x < y ? y : x;
}
static inline uint8_t umax8(uint8_t x, uint8_t y)
{
    return x < y ? y : x;
}
static inline uint16_t umax16(uint16_t x, uint16_t y)
{
    return x < y ? y : x;
}
static inline uint32_t umax32(uint32_t x, uint32_t y)
{
    return x < y ? y : x;
}
static inline uint64_t umax64(uint64_t x, uint64_t y)
{
    return x < y ? y : x;
}
static inline uint8_t shl8(uint8_t x, uint8_t y)
{
    return x << y;
}
static inline uint16_t shl16(uint16_t x, uint16_t y)
{
    return x << y;
}
static inline uint32_t shl32(uint32_t x, uint32_t y)
{
    return x << y;
}
static inline uint64_t shl64(uint64_t x, uint64_t y)
{
    return x << y;
}
static inline uint8_t lshr8(uint8_t x, uint8_t y)
{
    return x >> y;
}
static inline uint16_t lshr16(uint16_t x, uint16_t y)
{
    return x >> y;
}
static inline uint32_t lshr32(uint32_t x, uint32_t y)
{
    return x >> y;
}
static inline uint64_t lshr64(uint64_t x, uint64_t y)
{
    return x >> y;
}
static inline int8_t ashr8(int8_t x, int8_t y)
{
    return x >> y;
}
static inline int16_t ashr16(int16_t x, int16_t y)
{
    return x >> y;
}
static inline int32_t ashr32(int32_t x, int32_t y)
{
    return x >> y;
}
static inline int64_t ashr64(int64_t x, int64_t y)
{
    return x >> y;
}
static inline uint8_t and8(uint8_t x, uint8_t y)
{
    return x & y;
}
static inline uint16_t and16(uint16_t x, uint16_t y)
{
    return x & y;
}
static inline uint32_t and32(uint32_t x, uint32_t y)
{
    return x & y;
}
static inline uint64_t and64(uint64_t x, uint64_t y)
{
    return x & y;
}
static inline uint8_t or8(uint8_t x, uint8_t y)
{
    return x | y;
}
static inline uint16_t or16(uint16_t x, uint16_t y)
{
    return x | y;
}
static inline uint32_t or32(uint32_t x, uint32_t y)
{
    return x | y;
}
static inline uint64_t or64(uint64_t x, uint64_t y)
{
    return x | y;
}
static inline uint8_t xor8(uint8_t x, uint8_t y)
{
    return x ^ y;
}
static inline uint16_t xor16(uint16_t x, uint16_t y)
{
    return x ^ y;
}
static inline uint32_t xor32(uint32_t x, uint32_t y)
{
    return x ^ y;
}
static inline uint64_t xor64(uint64_t x, uint64_t y)
{
    return x ^ y;
}
static inline bool ult8(uint8_t x, uint8_t y)
{
    return x < y;
}
static inline bool ult16(uint16_t x, uint16_t y)
{
    return x < y;
}
static inline bool ult32(uint32_t x, uint32_t y)
{
    return x < y;
}
static inline bool ult64(uint64_t x, uint64_t y)
{
    return x < y;
}
static inline bool ule8(uint8_t x, uint8_t y)
{
    return x <= y;
}
static inline bool ule16(uint16_t x, uint16_t y)
{
    return x <= y;
}
static inline bool ule32(uint32_t x, uint32_t y)
{
    return x <= y;
}
static inline bool ule64(uint64_t x, uint64_t y)
{
    return x <= y;
}
static inline bool slt8(int8_t x, int8_t y)
{
    return x < y;
}
static inline bool slt16(int16_t x, int16_t y)
{
    return x < y;
}
static inline bool slt32(int32_t x, int32_t y)
{
    return x < y;
}
static inline bool slt64(int64_t x, int64_t y)
{
    return x < y;
}
static inline bool sle8(int8_t x, int8_t y)
{
    return x <= y;
}
static inline bool sle16(int16_t x, int16_t y)
{
    return x <= y;
}
static inline bool sle32(int32_t x, int32_t y)
{
    return x <= y;
}
static inline bool sle64(int64_t x, int64_t y)
{
    return x <= y;
}
static inline int8_t pow8(int8_t x, int8_t y)
{
    int8_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int16_t pow16(int16_t x, int16_t y)
{
    int16_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int32_t pow32(int32_t x, int32_t y)
{
    int32_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int64_t pow64(int64_t x, int64_t y)
{
    int64_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline bool itob_i8_bool(int8_t x)
{
    return x;
}
static inline bool itob_i16_bool(int16_t x)
{
    return x;
}
static inline bool itob_i32_bool(int32_t x)
{
    return x;
}
static inline bool itob_i64_bool(int64_t x)
{
    return x;
}
static inline int8_t btoi_bool_i8(bool x)
{
    return x;
}
static inline int16_t btoi_bool_i16(bool x)
{
    return x;
}
static inline int32_t btoi_bool_i32(bool x)
{
    return x;
}
static inline int64_t btoi_bool_i64(bool x)
{
    return x;
}
#define sext_i8_i8(x) ((int8_t) (int8_t) x)
#define sext_i8_i16(x) ((int16_t) (int8_t) x)
#define sext_i8_i32(x) ((int32_t) (int8_t) x)
#define sext_i8_i64(x) ((int64_t) (int8_t) x)
#define sext_i16_i8(x) ((int8_t) (int16_t) x)
#define sext_i16_i16(x) ((int16_t) (int16_t) x)
#define sext_i16_i32(x) ((int32_t) (int16_t) x)
#define sext_i16_i64(x) ((int64_t) (int16_t) x)
#define sext_i32_i8(x) ((int8_t) (int32_t) x)
#define sext_i32_i16(x) ((int16_t) (int32_t) x)
#define sext_i32_i32(x) ((int32_t) (int32_t) x)
#define sext_i32_i64(x) ((int64_t) (int32_t) x)
#define sext_i64_i8(x) ((int8_t) (int64_t) x)
#define sext_i64_i16(x) ((int16_t) (int64_t) x)
#define sext_i64_i32(x) ((int32_t) (int64_t) x)
#define sext_i64_i64(x) ((int64_t) (int64_t) x)
#define zext_i8_i8(x) ((int8_t) (uint8_t) x)
#define zext_i8_i16(x) ((int16_t) (uint8_t) x)
#define zext_i8_i32(x) ((int32_t) (uint8_t) x)
#define zext_i8_i64(x) ((int64_t) (uint8_t) x)
#define zext_i16_i8(x) ((int8_t) (uint16_t) x)
#define zext_i16_i16(x) ((int16_t) (uint16_t) x)
#define zext_i16_i32(x) ((int32_t) (uint16_t) x)
#define zext_i16_i64(x) ((int64_t) (uint16_t) x)
#define zext_i32_i8(x) ((int8_t) (uint32_t) x)
#define zext_i32_i16(x) ((int16_t) (uint32_t) x)
#define zext_i32_i32(x) ((int32_t) (uint32_t) x)
#define zext_i32_i64(x) ((int64_t) (uint32_t) x)
#define zext_i64_i8(x) ((int8_t) (uint64_t) x)
#define zext_i64_i16(x) ((int16_t) (uint64_t) x)
#define zext_i64_i32(x) ((int32_t) (uint64_t) x)
#define zext_i64_i64(x) ((int64_t) (uint64_t) x)
#if defined(__OPENCL_VERSION__)
static int32_t futrts_popc8(int8_t x)
{
    return popcount(x);
}
static int32_t futrts_popc16(int16_t x)
{
    return popcount(x);
}
static int32_t futrts_popc32(int32_t x)
{
    return popcount(x);
}
static int32_t futrts_popc64(int64_t x)
{
    return popcount(x);
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_popc8(int8_t x)
{
    return __popc(zext_i8_i32(x));
}
static int32_t futrts_popc16(int16_t x)
{
    return __popc(zext_i16_i32(x));
}
static int32_t futrts_popc32(int32_t x)
{
    return __popc(x);
}
static int32_t futrts_popc64(int64_t x)
{
    return __popcll(x);
}
#else
static int32_t futrts_popc8(int8_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc16(int16_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc32(int32_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc64(int64_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
#endif
#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    return mul_hi(a, b);
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    return mul_hi(a, b);
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    return mul_hi(a, b);
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    return mul_hi(a, b);
}
#elif defined(__CUDA_ARCH__)
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    uint16_t aa = a;
    uint16_t bb = b;
    
    return aa * bb >> 8;
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    uint32_t aa = a;
    uint32_t bb = b;
    
    return aa * bb >> 16;
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    return mulhi(a, b);
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    return mul64hi(a, b);
}
#else
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    uint16_t aa = a;
    uint16_t bb = b;
    
    return aa * bb >> 8;
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    uint32_t aa = a;
    uint32_t bb = b;
    
    return aa * bb >> 16;
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    uint64_t aa = a;
    uint64_t bb = b;
    
    return aa * bb >> 32;
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    __uint128_t aa = a;
    __uint128_t bb = b;
    
    return aa * bb >> 64;
}
#endif
#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)
{
    return mad_hi(a, b, c);
}
static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)
{
    return mad_hi(a, b, c);
}
static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)
{
    return mad_hi(a, b, c);
}
static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)
{
    return mad_hi(a, b, c);
}
#else
static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)
{
    return futrts_mul_hi8(a, b) + c;
}
static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)
{
    return futrts_mul_hi16(a, b) + c;
}
static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)
{
    return futrts_mul_hi32(a, b) + c;
}
static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)
{
    return futrts_mul_hi64(a, b) + c;
}
#endif
#if defined(__OPENCL_VERSION__)
static int32_t futrts_clzz8(int8_t x)
{
    return clz(x);
}
static int32_t futrts_clzz16(int16_t x)
{
    return clz(x);
}
static int32_t futrts_clzz32(int32_t x)
{
    return clz(x);
}
static int32_t futrts_clzz64(int64_t x)
{
    return clz(x);
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_clzz8(int8_t x)
{
    return __clz(zext_i8_i32(x)) - 24;
}
static int32_t futrts_clzz16(int16_t x)
{
    return __clz(zext_i16_i32(x)) - 16;
}
static int32_t futrts_clzz32(int32_t x)
{
    return __clz(x);
}
static int32_t futrts_clzz64(int64_t x)
{
    return __clzll(x);
}
#else
static int32_t futrts_clzz8(int8_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz16(int16_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz32(int32_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz64(int64_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
#endif
#if defined(__OPENCL_VERSION__)
static int32_t futrts_ctzz8(int8_t x)
{
    int i = 0;
    
    for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz16(int16_t x)
{
    int i = 0;
    
    for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz32(int32_t x)
{
    int i = 0;
    
    for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz64(int64_t x)
{
    int i = 0;
    
    for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_ctzz8(int8_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 8 : y - 1;
}
static int32_t futrts_ctzz16(int16_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 16 : y - 1;
}
static int32_t futrts_ctzz32(int32_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 32 : y - 1;
}
static int32_t futrts_ctzz64(int64_t x)
{
    int y = __ffsll(x);
    
    return y == 0 ? 64 : y - 1;
}
#else
static int32_t futrts_ctzz8(int8_t x)
{
    return x == 0 ? 8 : __builtin_ctz((uint32_t) x);
}
static int32_t futrts_ctzz16(int16_t x)
{
    return x == 0 ? 16 : __builtin_ctz((uint32_t) x);
}
static int32_t futrts_ctzz32(int32_t x)
{
    return x == 0 ? 32 : __builtin_ctz(x);
}
static int32_t futrts_ctzz64(int64_t x)
{
    return x == 0 ? 64 : __builtin_ctzl(x);
}
#endif
static inline float fdiv32(float x, float y)
{
    return x / y;
}
static inline float fadd32(float x, float y)
{
    return x + y;
}
static inline float fsub32(float x, float y)
{
    return x - y;
}
static inline float fmul32(float x, float y)
{
    return x * y;
}
static inline float fmin32(float x, float y)
{
    return fmin(x, y);
}
static inline float fmax32(float x, float y)
{
    return fmax(x, y);
}
static inline float fpow32(float x, float y)
{
    return pow(x, y);
}
static inline bool cmplt32(float x, float y)
{
    return x < y;
}
static inline bool cmple32(float x, float y)
{
    return x <= y;
}
static inline float sitofp_i8_f32(int8_t x)
{
    return (float) x;
}
static inline float sitofp_i16_f32(int16_t x)
{
    return (float) x;
}
static inline float sitofp_i32_f32(int32_t x)
{
    return (float) x;
}
static inline float sitofp_i64_f32(int64_t x)
{
    return (float) x;
}
static inline float uitofp_i8_f32(uint8_t x)
{
    return (float) x;
}
static inline float uitofp_i16_f32(uint16_t x)
{
    return (float) x;
}
static inline float uitofp_i32_f32(uint32_t x)
{
    return (float) x;
}
static inline float uitofp_i64_f32(uint64_t x)
{
    return (float) x;
}
static inline int8_t fptosi_f32_i8(float x)
{
    return (int8_t) x;
}
static inline int16_t fptosi_f32_i16(float x)
{
    return (int16_t) x;
}
static inline int32_t fptosi_f32_i32(float x)
{
    return (int32_t) x;
}
static inline int64_t fptosi_f32_i64(float x)
{
    return (int64_t) x;
}
static inline uint8_t fptoui_f32_i8(float x)
{
    return (uint8_t) x;
}
static inline uint16_t fptoui_f32_i16(float x)
{
    return (uint16_t) x;
}
static inline uint32_t fptoui_f32_i32(float x)
{
    return (uint32_t) x;
}
static inline uint64_t fptoui_f32_i64(float x)
{
    return (uint64_t) x;
}
static inline double fdiv64(double x, double y)
{
    return x / y;
}
static inline double fadd64(double x, double y)
{
    return x + y;
}
static inline double fsub64(double x, double y)
{
    return x - y;
}
static inline double fmul64(double x, double y)
{
    return x * y;
}
static inline double fmin64(double x, double y)
{
    return fmin(x, y);
}
static inline double fmax64(double x, double y)
{
    return fmax(x, y);
}
static inline double fpow64(double x, double y)
{
    return pow(x, y);
}
static inline bool cmplt64(double x, double y)
{
    return x < y;
}
static inline bool cmple64(double x, double y)
{
    return x <= y;
}
static inline double sitofp_i8_f64(int8_t x)
{
    return (double) x;
}
static inline double sitofp_i16_f64(int16_t x)
{
    return (double) x;
}
static inline double sitofp_i32_f64(int32_t x)
{
    return (double) x;
}
static inline double sitofp_i64_f64(int64_t x)
{
    return (double) x;
}
static inline double uitofp_i8_f64(uint8_t x)
{
    return (double) x;
}
static inline double uitofp_i16_f64(uint16_t x)
{
    return (double) x;
}
static inline double uitofp_i32_f64(uint32_t x)
{
    return (double) x;
}
static inline double uitofp_i64_f64(uint64_t x)
{
    return (double) x;
}
static inline int8_t fptosi_f64_i8(double x)
{
    return (int8_t) x;
}
static inline int16_t fptosi_f64_i16(double x)
{
    return (int16_t) x;
}
static inline int32_t fptosi_f64_i32(double x)
{
    return (int32_t) x;
}
static inline int64_t fptosi_f64_i64(double x)
{
    return (int64_t) x;
}
static inline uint8_t fptoui_f64_i8(double x)
{
    return (uint8_t) x;
}
static inline uint16_t fptoui_f64_i16(double x)
{
    return (uint16_t) x;
}
static inline uint32_t fptoui_f64_i32(double x)
{
    return (uint32_t) x;
}
static inline uint64_t fptoui_f64_i64(double x)
{
    return (uint64_t) x;
}
static inline float fpconv_f32_f32(float x)
{
    return (float) x;
}
static inline double fpconv_f32_f64(float x)
{
    return (double) x;
}
static inline float fpconv_f64_f32(double x)
{
    return (float) x;
}
static inline double fpconv_f64_f64(double x)
{
    return (double) x;
}
static inline float futrts_log32(float x)
{
    return log(x);
}
static inline float futrts_log2_32(float x)
{
    return log2(x);
}
static inline float futrts_log10_32(float x)
{
    return log10(x);
}
static inline float futrts_sqrt32(float x)
{
    return sqrt(x);
}
static inline float futrts_exp32(float x)
{
    return exp(x);
}
static inline float futrts_cos32(float x)
{
    return cos(x);
}
static inline float futrts_sin32(float x)
{
    return sin(x);
}
static inline float futrts_tan32(float x)
{
    return tan(x);
}
static inline float futrts_acos32(float x)
{
    return acos(x);
}
static inline float futrts_asin32(float x)
{
    return asin(x);
}
static inline float futrts_atan32(float x)
{
    return atan(x);
}
static inline float futrts_cosh32(float x)
{
    return cosh(x);
}
static inline float futrts_sinh32(float x)
{
    return sinh(x);
}
static inline float futrts_tanh32(float x)
{
    return tanh(x);
}
static inline float futrts_acosh32(float x)
{
    return acosh(x);
}
static inline float futrts_asinh32(float x)
{
    return asinh(x);
}
static inline float futrts_atanh32(float x)
{
    return atanh(x);
}
static inline float futrts_atan2_32(float x, float y)
{
    return atan2(x, y);
}
static inline float futrts_gamma32(float x)
{
    return tgamma(x);
}
static inline float futrts_lgamma32(float x)
{
    return lgamma(x);
}
static inline bool futrts_isnan32(float x)
{
    return isnan(x);
}
static inline bool futrts_isinf32(float x)
{
    return isinf(x);
}
static inline int32_t futrts_to_bits32(float x)
{
    union {
        float f;
        int32_t t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline float futrts_from_bits32(int32_t x)
{
    union {
        int32_t f;
        float t;
    } p;
    
    p.f = x;
    return p.t;
}
#ifdef __OPENCL_VERSION__
static inline float fmod32(float x, float y)
{
    return fmod(x, y);
}
static inline float futrts_round32(float x)
{
    return rint(x);
}
static inline float futrts_floor32(float x)
{
    return floor(x);
}
static inline float futrts_ceil32(float x)
{
    return ceil(x);
}
static inline float futrts_lerp32(float v0, float v1, float t)
{
    return mix(v0, v1, t);
}
static inline float futrts_mad32(float a, float b, float c)
{
    return mad(a, b, c);
}
static inline float futrts_fma32(float a, float b, float c)
{
    return fma(a, b, c);
}
#else
static inline float fmod32(float x, float y)
{
    return fmodf(x, y);
}
static inline float futrts_round32(float x)
{
    return rintf(x);
}
static inline float futrts_floor32(float x)
{
    return floorf(x);
}
static inline float futrts_ceil32(float x)
{
    return ceilf(x);
}
static inline float futrts_lerp32(float v0, float v1, float t)
{
    return v0 + (v1 - v0) * t;
}
static inline float futrts_mad32(float a, float b, float c)
{
    return a * b + c;
}
static inline float futrts_fma32(float a, float b, float c)
{
    return fmaf(a, b, c);
}
#endif
static inline double futrts_log64(double x)
{
    return log(x);
}
static inline double futrts_log2_64(double x)
{
    return log2(x);
}
static inline double futrts_log10_64(double x)
{
    return log10(x);
}
static inline double futrts_sqrt64(double x)
{
    return sqrt(x);
}
static inline double futrts_exp64(double x)
{
    return exp(x);
}
static inline double futrts_cos64(double x)
{
    return cos(x);
}
static inline double futrts_sin64(double x)
{
    return sin(x);
}
static inline double futrts_tan64(double x)
{
    return tan(x);
}
static inline double futrts_acos64(double x)
{
    return acos(x);
}
static inline double futrts_asin64(double x)
{
    return asin(x);
}
static inline double futrts_atan64(double x)
{
    return atan(x);
}
static inline double futrts_cosh64(double x)
{
    return cosh(x);
}
static inline double futrts_sinh64(double x)
{
    return sinh(x);
}
static inline double futrts_tanh64(double x)
{
    return tanh(x);
}
static inline double futrts_acosh64(double x)
{
    return acosh(x);
}
static inline double futrts_asinh64(double x)
{
    return asinh(x);
}
static inline double futrts_atanh64(double x)
{
    return atanh(x);
}
static inline double futrts_atan2_64(double x, double y)
{
    return atan2(x, y);
}
static inline double futrts_gamma64(double x)
{
    return tgamma(x);
}
static inline double futrts_lgamma64(double x)
{
    return lgamma(x);
}
static inline double futrts_fma64(double a, double b, double c)
{
    return fma(a, b, c);
}
static inline double futrts_round64(double x)
{
    return rint(x);
}
static inline double futrts_ceil64(double x)
{
    return ceil(x);
}
static inline double futrts_floor64(double x)
{
    return floor(x);
}
static inline bool futrts_isnan64(double x)
{
    return isnan(x);
}
static inline bool futrts_isinf64(double x)
{
    return isinf(x);
}
static inline int64_t futrts_to_bits64(double x)
{
    union {
        double f;
        int64_t t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline double futrts_from_bits64(int64_t x)
{
    union {
        int64_t f;
        double t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline double fmod64(double x, double y)
{
    return fmod(x, y);
}
#ifdef __OPENCL_VERSION__
static inline double futrts_lerp64(double v0, double v1, double t)
{
    return mix(v0, v1, t);
}
static inline double futrts_mad64(double a, double b, double c)
{
    return mad(a, b, c);
}
#else
static inline double futrts_lerp64(double v0, double v1, double t)
{
    return v0 + (v1 - v0) * t;
}
static inline double futrts_mad64(double a, double b, double c)
{
    return a * b + c;
}
#endif
int init_constants(struct futhark_context *);
int free_constants(struct futhark_context *);
static int32_t mainzicounter_mem_realtype_29314[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_29321[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_29333[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_29375[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzihist_locks_mem_realtype_29387[100151];
static int32_t mainzicounter_mem_realtype_29398[10240];
static int32_t mainzicounter_mem_realtype_29470[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_29487[10240];
static int32_t mainzicounter_mem_realtype_29498[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static float testzistatic_array_realtype_29507[9] = {1.0F, -0.5F, 1.0F, 1.0F,
                                                     1.0F, 1.0F, 1.0F, 1.0F,
                                                     1.0F};
static int64_t testzistatic_array_realtype_29508[9] = {10, 20, 5, 5, 50, 20, 30,
                                                       15, 18};
static float testzistatic_array_realtype_29509[9] = {1.0F, 0.5F, 0.25F, 0.1F,
                                                     0.3F, 0.1F, 2.0F, 3.0F,
                                                     1.0F};
static int32_t testzicounter_mem_realtype_29510[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_29517[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_29529[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_29571[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzihist_locks_mem_realtype_29583[100151];
static int32_t testzicounter_mem_realtype_29594[10240];
static int32_t testzicounter_mem_realtype_29666[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_29683[10240];
static int32_t testzicounter_mem_realtype_29694[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
struct memblock_device {
    int *references;
    cl_mem mem;
    int64_t size;
    const char *desc;
} ;
struct memblock {
    int *references;
    char *mem;
    int64_t size;
    const char *desc;
} ;
typedef cl_mem fl_mem_t;
// Start of free_list.h.

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem_t mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries;        // Pointer to entries.
  int capacity;                           // Number of entries.
  int used;                               // Number of valid entries.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
}

static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem_t mem, const char *tag) {
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size,
                          size_t *size_out, fl_mem_t *mem_out) {
  int size_match = -1;
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid &&
        size <= l->entries[i].size &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    return 0;
  } else {
    return 1;
  }
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem_t *mem_out) {
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      return 0;
    }
  }

  return 1;
}

// End of free_list.h.

// Start of opencl.h.

#define OPENCL_SUCCEED_FATAL(e) opencl_succeed_fatal(e, #e, __FILE__, __LINE__)
#define OPENCL_SUCCEED_NONFATAL(e) opencl_succeed_nonfatal(e, #e, __FILE__, __LINE__)
// Take care not to override an existing error.
#define OPENCL_SUCCEED_OR_RETURN(e) {             \
    char *serror = OPENCL_SUCCEED_NONFATAL(e);    \
    if (serror) {                                 \
      if (!ctx->error) {                          \
        ctx->error = serror;                      \
        return bad;                               \
      } else {                                    \
        free(serror);                             \
      }                                           \
    }                                             \
  }

// OPENCL_SUCCEED_OR_RETURN returns the value of the variable 'bad' in
// scope.  By default, it will be this one.  Create a local variable
// of some other type if needed.  This is a bit of a hack, but it
// saves effort in the code generator.
static const int bad = 1;

struct opencl_config {
  int debugging;
  int profiling;
  int logging;
  int preferred_device_num;
  const char *preferred_platform;
  const char *preferred_device;
  int ignore_blacklist;

  const char* dump_program_to;
  const char* load_program_from;
  const char* dump_binary_to;
  const char* load_binary_from;

  size_t default_group_size;
  size_t default_num_groups;
  size_t default_tile_size;
  size_t default_threshold;

  int default_group_size_changed;
  int default_tile_size_changed;

  int num_sizes;
  const char **size_names;
  const char **size_vars;
  size_t *size_values;
  const char **size_classes;
};

static void opencl_config_init(struct opencl_config *cfg,
                               int num_sizes,
                               const char *size_names[],
                               const char *size_vars[],
                               size_t *size_values,
                               const char *size_classes[]) {
  cfg->debugging = 0;
  cfg->logging = 0;
  cfg->profiling = 0;
  cfg->preferred_device_num = 0;
  cfg->preferred_platform = "";
  cfg->preferred_device = "";
  cfg->ignore_blacklist = 0;
  cfg->dump_program_to = NULL;
  cfg->load_program_from = NULL;
  cfg->dump_binary_to = NULL;
  cfg->load_binary_from = NULL;

  // The following are dummy sizes that mean the concrete defaults
  // will be set during initialisation via hardware-inspection-based
  // heuristics.
  cfg->default_group_size = 0;
  cfg->default_num_groups = 0;
  cfg->default_tile_size = 0;
  cfg->default_threshold = 0;

  cfg->default_group_size_changed = 0;
  cfg->default_tile_size_changed = 0;

  cfg->num_sizes = num_sizes;
  cfg->size_names = size_names;
  cfg->size_vars = size_vars;
  cfg->size_values = size_values;
  cfg->size_classes = size_classes;
}

// A record of something that happened.
struct profiling_record {
  cl_event *event;
  int *runs;
  int64_t *runtime;
};

struct opencl_context {
  cl_device_id device;
  cl_context ctx;
  cl_command_queue queue;

  struct opencl_config cfg;

  struct free_list free_list;

  size_t max_group_size;
  size_t max_num_groups;
  size_t max_tile_size;
  size_t max_threshold;
  size_t max_local_memory;

  size_t lockstep_width;

  struct profiling_record *profiling_records;
  int profiling_records_capacity;
  int profiling_records_used;
};

struct opencl_device_option {
  cl_platform_id platform;
  cl_device_id device;
  cl_device_type device_type;
  char *platform_name;
  char *device_name;
};

// This function must be defined by the user.  It is invoked by
// setup_opencl() after the platform and device has been found, but
// before the program is loaded.  Its intended use is to tune
// constants based on the selected platform and device.
static void post_opencl_setup(struct opencl_context*, struct opencl_device_option*);

static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

static const char* opencl_error_string(cl_int err)
{
    switch (err) {
        case CL_SUCCESS:                            return "Success!";
        case CL_DEVICE_NOT_FOUND:                   return "Device not found.";
        case CL_DEVICE_NOT_AVAILABLE:               return "Device not available";
        case CL_COMPILER_NOT_AVAILABLE:             return "Compiler not available";
        case CL_MEM_OBJECT_ALLOCATION_FAILURE:      return "Memory object allocation failure";
        case CL_OUT_OF_RESOURCES:                   return "Out of resources";
        case CL_OUT_OF_HOST_MEMORY:                 return "Out of host memory";
        case CL_PROFILING_INFO_NOT_AVAILABLE:       return "Profiling information not available";
        case CL_MEM_COPY_OVERLAP:                   return "Memory copy overlap";
        case CL_IMAGE_FORMAT_MISMATCH:              return "Image format mismatch";
        case CL_IMAGE_FORMAT_NOT_SUPPORTED:         return "Image format not supported";
        case CL_BUILD_PROGRAM_FAILURE:              return "Program build failure";
        case CL_MAP_FAILURE:                        return "Map failure";
        case CL_INVALID_VALUE:                      return "Invalid value";
        case CL_INVALID_DEVICE_TYPE:                return "Invalid device type";
        case CL_INVALID_PLATFORM:                   return "Invalid platform";
        case CL_INVALID_DEVICE:                     return "Invalid device";
        case CL_INVALID_CONTEXT:                    return "Invalid context";
        case CL_INVALID_QUEUE_PROPERTIES:           return "Invalid queue properties";
        case CL_INVALID_COMMAND_QUEUE:              return "Invalid command queue";
        case CL_INVALID_HOST_PTR:                   return "Invalid host pointer";
        case CL_INVALID_MEM_OBJECT:                 return "Invalid memory object";
        case CL_INVALID_IMAGE_FORMAT_DESCRIPTOR:    return "Invalid image format descriptor";
        case CL_INVALID_IMAGE_SIZE:                 return "Invalid image size";
        case CL_INVALID_SAMPLER:                    return "Invalid sampler";
        case CL_INVALID_BINARY:                     return "Invalid binary";
        case CL_INVALID_BUILD_OPTIONS:              return "Invalid build options";
        case CL_INVALID_PROGRAM:                    return "Invalid program";
        case CL_INVALID_PROGRAM_EXECUTABLE:         return "Invalid program executable";
        case CL_INVALID_KERNEL_NAME:                return "Invalid kernel name";
        case CL_INVALID_KERNEL_DEFINITION:          return "Invalid kernel definition";
        case CL_INVALID_KERNEL:                     return "Invalid kernel";
        case CL_INVALID_ARG_INDEX:                  return "Invalid argument index";
        case CL_INVALID_ARG_VALUE:                  return "Invalid argument value";
        case CL_INVALID_ARG_SIZE:                   return "Invalid argument size";
        case CL_INVALID_KERNEL_ARGS:                return "Invalid kernel arguments";
        case CL_INVALID_WORK_DIMENSION:             return "Invalid work dimension";
        case CL_INVALID_WORK_GROUP_SIZE:            return "Invalid work group size";
        case CL_INVALID_WORK_ITEM_SIZE:             return "Invalid work item size";
        case CL_INVALID_GLOBAL_OFFSET:              return "Invalid global offset";
        case CL_INVALID_EVENT_WAIT_LIST:            return "Invalid event wait list";
        case CL_INVALID_EVENT:                      return "Invalid event";
        case CL_INVALID_OPERATION:                  return "Invalid operation";
        case CL_INVALID_GL_OBJECT:                  return "Invalid OpenGL object";
        case CL_INVALID_BUFFER_SIZE:                return "Invalid buffer size";
        case CL_INVALID_MIP_LEVEL:                  return "Invalid mip-map level";
        default:                                    return "Unknown";
    }
}

static void opencl_succeed_fatal(unsigned int ret,
                                 const char *call,
                                 const char *file,
                                 int line) {
  if (ret != CL_SUCCESS) {
    futhark_panic(-1, "%s:%d: OpenCL call\n  %s\nfailed with error code %d (%s)\n",
          file, line, call, ret, opencl_error_string(ret));
  }
}

static char* opencl_succeed_nonfatal(unsigned int ret,
                                     const char *call,
                                     const char *file,
                                     int line) {
  if (ret != CL_SUCCESS) {
    return msgprintf("%s:%d: OpenCL call\n  %s\nfailed with error code %d (%s)\n",
                     file, line, call, ret, opencl_error_string(ret));
  } else {
    return NULL;
  }
}

static void set_preferred_platform(struct opencl_config *cfg, const char *s) {
  cfg->preferred_platform = s;
  cfg->ignore_blacklist = 1;
}

static void set_preferred_device(struct opencl_config *cfg, const char *s) {
  int x = 0;
  if (*s == '#') {
    s++;
    while (isdigit(*s)) {
      x = x * 10 + (*s++)-'0';
    }
    // Skip trailing spaces.
    while (isspace(*s)) {
      s++;
    }
  }
  cfg->preferred_device = s;
  cfg->preferred_device_num = x;
  cfg->ignore_blacklist = 1;
}

static char* opencl_platform_info(cl_platform_id platform,
                                  cl_platform_info param) {
  size_t req_bytes;
  char *info;

  OPENCL_SUCCEED_FATAL(clGetPlatformInfo(platform, param, 0, NULL, &req_bytes));

  info = (char*) malloc(req_bytes);

  OPENCL_SUCCEED_FATAL(clGetPlatformInfo(platform, param, req_bytes, info, NULL));

  return info;
}

static char* opencl_device_info(cl_device_id device,
                                cl_device_info param) {
  size_t req_bytes;
  char *info;

  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device, param, 0, NULL, &req_bytes));

  info = (char*) malloc(req_bytes);

  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device, param, req_bytes, info, NULL));

  return info;
}

static void opencl_all_device_options(struct opencl_device_option **devices_out,
                                      size_t *num_devices_out) {
  size_t num_devices = 0, num_devices_added = 0;

  cl_platform_id *all_platforms;
  cl_uint *platform_num_devices;

  cl_uint num_platforms;

  // Find the number of platforms.
  OPENCL_SUCCEED_FATAL(clGetPlatformIDs(0, NULL, &num_platforms));

  // Make room for them.
  all_platforms = calloc(num_platforms, sizeof(cl_platform_id));
  platform_num_devices = calloc(num_platforms, sizeof(cl_uint));

  // Fetch all the platforms.
  OPENCL_SUCCEED_FATAL(clGetPlatformIDs(num_platforms, all_platforms, NULL));

  // Count the number of devices for each platform, as well as the
  // total number of devices.
  for (cl_uint i = 0; i < num_platforms; i++) {
    if (clGetDeviceIDs(all_platforms[i], CL_DEVICE_TYPE_ALL,
                       0, NULL, &platform_num_devices[i]) == CL_SUCCESS) {
      num_devices += platform_num_devices[i];
    } else {
      platform_num_devices[i] = 0;
    }
  }

  // Make room for all the device options.
  struct opencl_device_option *devices =
    calloc(num_devices, sizeof(struct opencl_device_option));

  // Loop through the platforms, getting information about their devices.
  for (cl_uint i = 0; i < num_platforms; i++) {
    cl_platform_id platform = all_platforms[i];
    cl_uint num_platform_devices = platform_num_devices[i];

    if (num_platform_devices == 0) {
      continue;
    }

    char *platform_name = opencl_platform_info(platform, CL_PLATFORM_NAME);
    cl_device_id *platform_devices =
      calloc(num_platform_devices, sizeof(cl_device_id));

    // Fetch all the devices.
    OPENCL_SUCCEED_FATAL(clGetDeviceIDs(platform, CL_DEVICE_TYPE_ALL,
                                  num_platform_devices, platform_devices, NULL));

    // Loop through the devices, adding them to the devices array.
    for (cl_uint i = 0; i < num_platform_devices; i++) {
      char *device_name = opencl_device_info(platform_devices[i], CL_DEVICE_NAME);
      devices[num_devices_added].platform = platform;
      devices[num_devices_added].device = platform_devices[i];
      OPENCL_SUCCEED_FATAL(clGetDeviceInfo(platform_devices[i], CL_DEVICE_TYPE,
                                     sizeof(cl_device_type),
                                     &devices[num_devices_added].device_type,
                                     NULL));
      // We don't want the structs to share memory, so copy the platform name.
      // Each device name is already unique.
      devices[num_devices_added].platform_name = strclone(platform_name);
      devices[num_devices_added].device_name = device_name;
      num_devices_added++;
    }
    free(platform_devices);
    free(platform_name);
  }
  free(all_platforms);
  free(platform_num_devices);

  *devices_out = devices;
  *num_devices_out = num_devices;
}

// Returns 0 on success.
static int list_devices(struct opencl_config *cfg) {
  struct opencl_device_option *devices;
  size_t num_devices;

  opencl_all_device_options(&devices, &num_devices);

  const char *cur_platform = "";
  for (size_t i = 0; i < num_devices; i++) {
    struct opencl_device_option device = devices[i];
    if (strcmp(cur_platform, device.platform_name) != 0) {
      printf("Platform: %s\n", device.platform_name);
      cur_platform = device.platform_name;
    }
    printf("[%d]: %s\n", (int)i, device.device_name);
  }

  // Free all the platform and device names.
  for (size_t j = 0; j < num_devices; j++) {
    free(devices[j].platform_name);
    free(devices[j].device_name);
  }
  free(devices);

  return 0;
}

// Returns 0 on success.
static int select_device_interactively(struct opencl_config *cfg) {
  struct opencl_device_option *devices;
  size_t num_devices;
  int ret = 1;

  opencl_all_device_options(&devices, &num_devices);

  printf("Choose OpenCL device:\n");
  const char *cur_platform = "";
  for (size_t i = 0; i < num_devices; i++) {
    struct opencl_device_option device = devices[i];
    if (strcmp(cur_platform, device.platform_name) != 0) {
      printf("Platform: %s\n", device.platform_name);
      cur_platform = device.platform_name;
    }
    printf("[%d] %s\n", (int)i, device.device_name);
  }

  int selection;
  printf("Choice: ");
  if (scanf("%d", &selection) == 1) {
    ret = 0;
    cfg->preferred_platform = "";
    cfg->preferred_device = "";
    cfg->preferred_device_num = selection;
    cfg->ignore_blacklist = 1;
  }

  // Free all the platform and device names.
  for (size_t j = 0; j < num_devices; j++) {
    free(devices[j].platform_name);
    free(devices[j].device_name);
  }
  free(devices);

  return ret;
}

static int is_blacklisted(const char *platform_name, const char *device_name,
                          const struct opencl_config *cfg) {
  if (strcmp(cfg->preferred_platform, "") != 0 ||
      strcmp(cfg->preferred_device, "") != 0) {
    return 0;
  } else if (strstr(platform_name, "Apple") != NULL &&
             strstr(device_name, "Intel(R) Core(TM)") != NULL) {
    return 1;
  } else {
    return 0;
  }
}

static struct opencl_device_option get_preferred_device(const struct opencl_config *cfg) {
  struct opencl_device_option *devices;
  size_t num_devices;

  opencl_all_device_options(&devices, &num_devices);

  int num_device_matches = 0;

  for (size_t i = 0; i < num_devices; i++) {
    struct opencl_device_option device = devices[i];
    if (strstr(device.platform_name, cfg->preferred_platform) != NULL &&
        strstr(device.device_name, cfg->preferred_device) != NULL &&
        (cfg->ignore_blacklist ||
         !is_blacklisted(device.platform_name, device.device_name, cfg)) &&
        num_device_matches++ == cfg->preferred_device_num) {
      // Free all the platform and device names, except the ones we have chosen.
      for (size_t j = 0; j < num_devices; j++) {
        if (j != i) {
          free(devices[j].platform_name);
          free(devices[j].device_name);
        }
      }
      free(devices);
      return device;
    }
  }

  futhark_panic(1, "Could not find acceptable OpenCL device.\n");
  exit(1); // Never reached
}

static void describe_device_option(struct opencl_device_option device) {
  fprintf(stderr, "Using platform: %s\n", device.platform_name);
  fprintf(stderr, "Using device: %s\n", device.device_name);
}

static cl_build_status build_opencl_program(cl_program program, cl_device_id device, const char* options) {
  cl_int clBuildProgram_error = clBuildProgram(program, 1, &device, options, NULL, NULL);

  // Avoid termination due to CL_BUILD_PROGRAM_FAILURE
  if (clBuildProgram_error != CL_SUCCESS &&
      clBuildProgram_error != CL_BUILD_PROGRAM_FAILURE) {
    OPENCL_SUCCEED_FATAL(clBuildProgram_error);
  }

  cl_build_status build_status;
  OPENCL_SUCCEED_FATAL(clGetProgramBuildInfo(program,
                                             device,
                                             CL_PROGRAM_BUILD_STATUS,
                                             sizeof(cl_build_status),
                                             &build_status,
                                             NULL));

  if (build_status != CL_SUCCESS) {
    char *build_log;
    size_t ret_val_size;
    OPENCL_SUCCEED_FATAL(clGetProgramBuildInfo(program, device, CL_PROGRAM_BUILD_LOG, 0, NULL, &ret_val_size));

    build_log = (char*) malloc(ret_val_size+1);
    OPENCL_SUCCEED_FATAL(clGetProgramBuildInfo(program, device, CL_PROGRAM_BUILD_LOG, ret_val_size, build_log, NULL));

    // The spec technically does not say whether the build log is zero-terminated, so let's be careful.
    build_log[ret_val_size] = '\0';

    fprintf(stderr, "Build log:\n%s\n", build_log);

    free(build_log);
  }

  return build_status;
}

// Fields in a bitmask indicating which types we must be sure are
// available.
enum opencl_required_type { OPENCL_F64 = 1 };

// We take as input several strings representing the program, because
// C does not guarantee that the compiler supports particularly large
// literals.  Notably, Visual C has a limit of 2048 characters.  The
// array must be NULL-terminated.
static cl_program setup_opencl_with_command_queue(struct opencl_context *ctx,
                                                  cl_command_queue queue,
                                                  const char *srcs[],
                                                  int required_types,
                                                  const char *extra_build_opts[]) {
  int error;

  free_list_init(&ctx->free_list);
  ctx->queue = queue;

  OPENCL_SUCCEED_FATAL(clGetCommandQueueInfo(ctx->queue, CL_QUEUE_CONTEXT, sizeof(cl_context), &ctx->ctx, NULL));

  // Fill out the device info.  This is redundant work if we are
  // called from setup_opencl() (which is the common case), but I
  // doubt it matters much.
  struct opencl_device_option device_option;
  OPENCL_SUCCEED_FATAL(clGetCommandQueueInfo(ctx->queue, CL_QUEUE_DEVICE,
                                       sizeof(cl_device_id),
                                       &device_option.device,
                                       NULL));
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_PLATFORM,
                                 sizeof(cl_platform_id),
                                 &device_option.platform,
                                 NULL));
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_TYPE,
                                 sizeof(cl_device_type),
                                 &device_option.device_type,
                                 NULL));
  device_option.platform_name = opencl_platform_info(device_option.platform, CL_PLATFORM_NAME);
  device_option.device_name = opencl_device_info(device_option.device, CL_DEVICE_NAME);

  ctx->device = device_option.device;

  if (required_types & OPENCL_F64) {
    cl_uint supported;
    OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_PREFERRED_VECTOR_WIDTH_DOUBLE,
                                   sizeof(cl_uint), &supported, NULL));
    if (!supported) {
      futhark_panic(1, "Program uses double-precision floats, but this is not supported on the chosen device: %s\n",
            device_option.device_name);
    }
  }

  size_t max_group_size;
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_MAX_WORK_GROUP_SIZE,
                                 sizeof(size_t), &max_group_size, NULL));

  size_t max_tile_size = sqrt(max_group_size);

  cl_ulong max_local_memory;
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_LOCAL_MEM_SIZE,
                                       sizeof(size_t), &max_local_memory, NULL));

  // Futhark reserves 4 bytes for bookkeeping information.
  max_local_memory -= 4;

  // The OpenCL implementation may reserve some local memory bytes for
  // various purposes.  In principle, we should use
  // clGetKernelWorkGroupInfo() to figure out for each kernel how much
  // is actually available, but our current code generator design
  // makes this infeasible.  Instead, we have this nasty hack where we
  // arbitrarily subtract some bytes, based on empirical measurements
  // (but which might be arbitrarily wrong).  Fortunately, we rarely
  // try to really push the local memory usage.
  if (strstr(device_option.platform_name, "NVIDIA CUDA") != NULL) {
    max_local_memory -= 12;
  } else if (strstr(device_option.platform_name, "AMD") != NULL) {
    max_local_memory -= 16;
  }

  // Make sure this function is defined.
  post_opencl_setup(ctx, &device_option);

  if (max_group_size < ctx->cfg.default_group_size) {
    if (ctx->cfg.default_group_size_changed) {
      fprintf(stderr, "Note: Device limits default group size to %zu (down from %zu).\n",
              max_group_size, ctx->cfg.default_group_size);
    }
    ctx->cfg.default_group_size = max_group_size;
  }

  if (max_tile_size < ctx->cfg.default_tile_size) {
    if (ctx->cfg.default_tile_size_changed) {
      fprintf(stderr, "Note: Device limits default tile size to %zu (down from %zu).\n",
              max_tile_size, ctx->cfg.default_tile_size);
    }
    ctx->cfg.default_tile_size = max_tile_size;
  }

  ctx->max_group_size = max_group_size;
  ctx->max_tile_size = max_tile_size; // No limit.
  ctx->max_threshold = ctx->max_num_groups = 0; // No limit.
  ctx->max_local_memory = max_local_memory;

  // Now we go through all the sizes, clamp them to the valid range,
  // or set them to the default.
  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    const char *size_class = ctx->cfg.size_classes[i];
    size_t *size_value = &ctx->cfg.size_values[i];
    const char* size_name = ctx->cfg.size_names[i];
    size_t max_value = 0, default_value = 0;
    if (strstr(size_class, "group_size") == size_class) {
      max_value = max_group_size;
      default_value = ctx->cfg.default_group_size;
    } else if (strstr(size_class, "num_groups") == size_class) {
      max_value = max_group_size; // Futhark assumes this constraint.
      default_value = ctx->cfg.default_num_groups;
      // XXX: as a quick and dirty hack, use twice as many threads for
      // histograms by default.  We really should just be smarter
      // about sizes somehow.
      if (strstr(size_name, ".seghist_") != NULL) {
        default_value *= 2;
      }
    } else if (strstr(size_class, "tile_size") == size_class) {
      max_value = sqrt(max_group_size);
      default_value = ctx->cfg.default_tile_size;
    } else if (strstr(size_class, "threshold") == size_class) {
      // Threshold can be as large as it takes.
      default_value = ctx->cfg.default_threshold;
    } else {
      // Bespoke sizes have no limit or default.
    }
    if (*size_value == 0) {
      *size_value = default_value;
    } else if (max_value > 0 && *size_value > max_value) {
      fprintf(stderr, "Note: Device limits %s to %d (down from %d)\n",
              size_name, (int)max_value, (int)*size_value);
      *size_value = max_value;
    }
  }

  if (ctx->lockstep_width == 0) {
    ctx->lockstep_width = 1;
  }

  if (ctx->cfg.logging) {
    fprintf(stderr, "Lockstep width: %d\n", (int)ctx->lockstep_width);
    fprintf(stderr, "Default group size: %d\n", (int)ctx->cfg.default_group_size);
    fprintf(stderr, "Default number of groups: %d\n", (int)ctx->cfg.default_num_groups);
  }

  char *fut_opencl_src = NULL;
  cl_program prog;
  error = CL_SUCCESS;

  if (ctx->cfg.load_binary_from == NULL) {
    size_t src_size = 0;

    // Maybe we have to read OpenCL source from somewhere else (used for debugging).
    if (ctx->cfg.load_program_from != NULL) {
      fut_opencl_src = slurp_file(ctx->cfg.load_program_from, NULL);
      assert(fut_opencl_src != NULL);
    } else {
      // Construct the OpenCL source concatenating all the fragments.
      for (const char **src = srcs; src && *src; src++) {
        src_size += strlen(*src);
      }

      fut_opencl_src = (char*) malloc(src_size + 1);

      size_t n, i;
      for (i = 0, n = 0; srcs && srcs[i]; i++) {
        strncpy(fut_opencl_src+n, srcs[i], src_size-n);
        n += strlen(srcs[i]);
      }
      fut_opencl_src[src_size] = 0;
    }

    if (ctx->cfg.dump_program_to != NULL) {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "Dumping OpenCL source to %s...\n", ctx->cfg.dump_program_to);
      }

      dump_file(ctx->cfg.dump_program_to, fut_opencl_src, strlen(fut_opencl_src));
    }

    if (ctx->cfg.debugging) {
      fprintf(stderr, "Creating OpenCL program...\n");
    }

    const char* src_ptr[] = {fut_opencl_src};
    prog = clCreateProgramWithSource(ctx->ctx, 1, src_ptr, &src_size, &error);
    OPENCL_SUCCEED_FATAL(error);
  } else {
    if (ctx->cfg.debugging) {
      fprintf(stderr, "Loading OpenCL binary from %s...\n", ctx->cfg.load_binary_from);
    }
    size_t binary_size;
    unsigned char *fut_opencl_bin =
      (unsigned char*) slurp_file(ctx->cfg.load_binary_from, &binary_size);
    assert(fut_opencl_bin != NULL);
    const unsigned char *binaries[1] = { fut_opencl_bin };
    cl_int status = 0;

    prog = clCreateProgramWithBinary(ctx->ctx, 1, &device_option.device,
                                     &binary_size, binaries,
                                     &status, &error);

    OPENCL_SUCCEED_FATAL(status);
    OPENCL_SUCCEED_FATAL(error);
  }

  int compile_opts_size = 1024;

  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    compile_opts_size += strlen(ctx->cfg.size_names[i]) + 20;
  }

  for (int i = 0; extra_build_opts[i] != NULL; i++) {
    compile_opts_size += strlen(extra_build_opts[i] + 1);
  }

  char *compile_opts = (char*) malloc(compile_opts_size);

  int w = snprintf(compile_opts, compile_opts_size,
                   "-DLOCKSTEP_WIDTH=%d ",
                   (int)ctx->lockstep_width);

  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    w += snprintf(compile_opts+w, compile_opts_size-w,
                  "-D%s=%d ",
                  ctx->cfg.size_vars[i],
                  (int)ctx->cfg.size_values[i]);
  }

  for (int i = 0; extra_build_opts[i] != NULL; i++) {
    w += snprintf(compile_opts+w, compile_opts_size-w,
                  "%s ", extra_build_opts[i]);
  }

  if (ctx->cfg.debugging) {
    fprintf(stderr, "OpenCL compiler options: %s\n", compile_opts);
    fprintf(stderr, "Building OpenCL program...\n");
  }
  OPENCL_SUCCEED_FATAL(build_opencl_program(prog, device_option.device, compile_opts));

  free(compile_opts);
  free(fut_opencl_src);

  if (ctx->cfg.dump_binary_to != NULL) {
    if (ctx->cfg.debugging) {
      fprintf(stderr, "Dumping OpenCL binary to %s...\n", ctx->cfg.dump_binary_to);
    }

    size_t binary_size;
    OPENCL_SUCCEED_FATAL(clGetProgramInfo(prog, CL_PROGRAM_BINARY_SIZES,
                                          sizeof(size_t), &binary_size, NULL));
    unsigned char *binary = (unsigned char*) malloc(binary_size);
    unsigned char *binaries[1] = { binary };
    OPENCL_SUCCEED_FATAL(clGetProgramInfo(prog, CL_PROGRAM_BINARIES,
                                          sizeof(unsigned char*), binaries, NULL));

    dump_file(ctx->cfg.dump_binary_to, binary, binary_size);
  }

  return prog;
}

static cl_program setup_opencl(struct opencl_context *ctx,
                               const char *srcs[],
                               int required_types,
                               const char *extra_build_opts[]) {

  ctx->lockstep_width = 0; // Real value set later.

  struct opencl_device_option device_option = get_preferred_device(&ctx->cfg);

  if (ctx->cfg.logging) {
    describe_device_option(device_option);
  }

  // Note that NVIDIA's OpenCL requires the platform property
  cl_context_properties properties[] = {
    CL_CONTEXT_PLATFORM,
    (cl_context_properties)device_option.platform,
    0
  };

  cl_int clCreateContext_error;
  ctx->ctx = clCreateContext(properties, 1, &device_option.device, NULL, NULL, &clCreateContext_error);
  OPENCL_SUCCEED_FATAL(clCreateContext_error);

  cl_int clCreateCommandQueue_error;
  cl_command_queue queue =
    clCreateCommandQueue(ctx->ctx,
                         device_option.device,
                         ctx->cfg.profiling ? CL_QUEUE_PROFILING_ENABLE : 0,
                         &clCreateCommandQueue_error);
  OPENCL_SUCCEED_FATAL(clCreateCommandQueue_error);

  return setup_opencl_with_command_queue(ctx, queue, srcs, required_types, extra_build_opts);
}

// Count up the runtime all the profiling_records that occured during execution.
// Also clears the buffer of profiling_records.
static cl_int opencl_tally_profiling_records(struct opencl_context *ctx) {
  cl_int err;
  for (int i = 0; i < ctx->profiling_records_used; i++) {
    struct profiling_record record = ctx->profiling_records[i];

    cl_ulong start_t, end_t;

    if ((err = clGetEventProfilingInfo(*record.event,
                                       CL_PROFILING_COMMAND_START,
                                       sizeof(start_t),
                                       &start_t,
                                       NULL)) != CL_SUCCESS) {
      return err;
    }

    if ((err = clGetEventProfilingInfo(*record.event,
                                       CL_PROFILING_COMMAND_END,
                                       sizeof(end_t),
                                       &end_t,
                                       NULL)) != CL_SUCCESS) {
      return err;
    }

    // OpenCL provides nanosecond resolution, but we want
    // microseconds.
    *record.runs += 1;
    *record.runtime += (end_t - start_t)/1000;

    if ((err = clReleaseEvent(*record.event)) != CL_SUCCESS) {
      return err;
    }
    free(record.event);
  }

  ctx->profiling_records_used = 0;

  return CL_SUCCESS;
}

// If profiling, produce an event associated with a profiling record.
static cl_event* opencl_get_event(struct opencl_context *ctx, int *runs, int64_t *runtime) {
    if (ctx->profiling_records_used == ctx->profiling_records_capacity) {
      ctx->profiling_records_capacity *= 2;
      ctx->profiling_records =
        realloc(ctx->profiling_records,
                ctx->profiling_records_capacity *
                sizeof(struct profiling_record));
    }
    cl_event *event = malloc(sizeof(cl_event));
    ctx->profiling_records[ctx->profiling_records_used].event = event;
    ctx->profiling_records[ctx->profiling_records_used].runs = runs;
    ctx->profiling_records[ctx->profiling_records_used].runtime = runtime;
    ctx->profiling_records_used++;
    return event;
}

// Allocate memory from driver. The problem is that OpenCL may perform
// lazy allocation, so we cannot know whether an allocation succeeded
// until the first time we try to use it.  Hence we immediately
// perform a write to see if the allocation succeeded.  This is slow,
// but the assumption is that this operation will be rare (most things
// will go through the free list).
static int opencl_alloc_actual(struct opencl_context *ctx, size_t size, cl_mem *mem_out) {
  int error;
  *mem_out = clCreateBuffer(ctx->ctx, CL_MEM_READ_WRITE, size, NULL, &error);

  if (error != CL_SUCCESS) {
    return error;
  }

  int x = 2;
  error = clEnqueueWriteBuffer(ctx->queue, *mem_out, 1, 0, sizeof(x), &x, 0, NULL, NULL);

  // No need to wait for completion here. clWaitForEvents() cannot
  // return mem object allocation failures. This implies that the
  // buffer is faulted onto the device on enqueue. (Observation by
  // Andreas Kloeckner.)

  return error;
}

static int opencl_alloc(struct opencl_context *ctx, size_t min_size, const char *tag, cl_mem *mem_out) {
  (void)tag;
  if (min_size < sizeof(int)) {
    min_size = sizeof(int);
  }

  size_t size;

  if (free_list_find(&ctx->free_list, min_size, &size, mem_out) == 0) {
    // Successfully found a free block.  Is it big enough?
    //
    // FIXME: we might also want to check whether the block is *too
    // big*, to avoid internal fragmentation.  However, this can
    // sharply impact performance on programs where arrays change size
    // frequently.  Fortunately, such allocations are usually fairly
    // short-lived, as they are necessarily within a loop, so the risk
    // of internal fragmentation resulting in an OOM situation is
    // limited.  However, it would be preferable if we could go back
    // and *shrink* oversize allocations when we encounter an OOM
    // condition.  That is technically feasible, since we do not
    // expose OpenCL pointer values directly to the application, but
    // instead rely on a level of indirection.
    if (size >= min_size) {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "No need to allocate: Found a block in the free list.\n");
      }

      return CL_SUCCESS;
    } else {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "Found a free block, but it was too small.\n");
      }

      // Not just right - free it.
      int error = clReleaseMemObject(*mem_out);
      if (error != CL_SUCCESS) {
        return error;
      }
    }
  }

  // We have to allocate a new block from the driver.  If the
  // allocation does not succeed, then we might be in an out-of-memory
  // situation.  We now start freeing things from the free list until
  // we think we have freed enough that the allocation will succeed.
  // Since we don't know how far the allocation is from fitting, we
  // have to check after every deallocation.  This might be pretty
  // expensive.  Let's hope that this case is hit rarely.

  if (ctx->cfg.debugging) {
    fprintf(stderr, "Actually allocating the desired block.\n");
  }

  int error = opencl_alloc_actual(ctx, min_size, mem_out);

  while (error == CL_MEM_OBJECT_ALLOCATION_FAILURE) {
    if (ctx->cfg.debugging) {
      fprintf(stderr, "Out of OpenCL memory: releasing entry from the free list...\n");
    }
    cl_mem mem;
    if (free_list_first(&ctx->free_list, &mem) == 0) {
      error = clReleaseMemObject(mem);
      if (error != CL_SUCCESS) {
        return error;
      }
    } else {
      break;
    }
    error = opencl_alloc_actual(ctx, min_size, mem_out);
  }

  return error;
}

static int opencl_free(struct opencl_context *ctx, cl_mem mem, const char *tag) {
  size_t size;
  cl_mem existing_mem;

  // If there is already a block with this tag, then remove it.
  if (free_list_find(&ctx->free_list, -1, &size, &existing_mem) == 0) {
    int error = clReleaseMemObject(existing_mem);
    if (error != CL_SUCCESS) {
      return error;
    }
  }

  int error = clGetMemObjectInfo(mem, CL_MEM_SIZE, sizeof(size_t), &size, NULL);

  if (error == CL_SUCCESS) {
    free_list_insert(&ctx->free_list, size, mem, tag);
  }

  return error;
}

static int opencl_free_all(struct opencl_context *ctx) {
  cl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, &mem) == 0) {
    int error = clReleaseMemObject(mem);
    if (error != CL_SUCCESS) {
      return error;
    }
  }

  return CL_SUCCESS;
}

// Free everything that belongs to 'ctx', but do not free 'ctx'
// itself.
static void teardown_opencl(struct opencl_context *ctx) {
  (void)opencl_tally_profiling_records(ctx);
  free(ctx->profiling_records);
  (void)opencl_free_all(ctx);
  (void)clReleaseCommandQueue(ctx->queue);
  (void)clReleaseContext(ctx->ctx);
}

// End of opencl.h.

static const char *opencl_program[] =
                  {"#ifdef cl_clang_storage_class_specifiers\n#pragma OPENCL EXTENSION cl_clang_storage_class_specifiers : enable\n#endif\n#pragma OPENCL EXTENSION cl_khr_byte_addressable_store : enable\n__kernel void dummy_kernel(__global unsigned char *dummy, int n)\n{\n    const int thread_gid = get_global_id(0);\n    \n    if (thread_gid >= n)\n        return;\n}\ntypedef char int8_t;\ntypedef short int16_t;\ntypedef int int32_t;\ntypedef long int64_t;\ntypedef uchar uint8_t;\ntypedef ushort uint16_t;\ntypedef uint uint32_t;\ntypedef ulong uint64_t;\n#ifdef cl_nv_pragma_unroll\nstatic inline void mem_fence_global()\n{\n    asm(\"membar.gl;\");\n}\n#else\nstatic inline void mem_fence_global()\n{\n    mem_fence(CLK_LOCAL_MEM_FENCE | CLK_GLOBAL_MEM_FENCE);\n}\n#endif\nstatic inline void mem_fence_local()\n{\n    mem_fence(CLK_LOCAL_MEM_FENCE);\n}\nstatic inline uint8_t add8(uint8_t x, uint8_t y)\n{\n    return x + y;\n}\nstatic inline uint16_t add16(uint16_t x, uint16_t y)\n{\n    return x + y;\n}\nstatic inline uint32_t add32(uint32_t x, uint32_t y)\n{\n    return x + y;\n}\nstatic inline uint64_t add64(uint64_t x, uint64_t y)\n{\n    return x + y;\n}\nstatic inline uint8_t sub8(uint8_t x, uint8_t y)\n{\n    return x - y;\n}\nstatic inline uint16_t sub16(uint16_t x, uint16_t y)\n{\n    return x - y;\n}\nstatic inline uint32_t sub32(uint32_t x, uint32_t y)\n{\n    return x - y;\n}\nstatic inline uint64_t sub64(uint64_t x, uint64_t y)\n{\n    return x - y;\n}\nstatic inline uint8_t mul8(uint8_t x, uint8_t y)\n{\n    return x * y;\n}\nstatic inline uint16_t mul16(uint16_t x, uint16_t y)\n{\n    return x * y;\n}\nstatic inline uint32_t mul32(uint32_t x, uint32_t y)\n{\n    return x * y;\n}\nstatic inline uint64_t mul64(uint64_t x, uint64_t y)\n{\n    return x * y;\n}\nstatic inline uint8_t udiv8(uint8_t x, uint8_t y)\n{\n    return x / y;\n}\nstatic inline uint16_t udiv16(uint16_t x, uint16_t y)\n{\n    return x / y;\n}\nstatic inline uint32_t udiv32(uint32_t x, uint32_t y)\n{\n    return x / y;\n}\nstatic inline uint64_t udiv64(uint64_t x, uint64_t y)\n{\n    return x / y;\n}\nstatic ",
                   "inline uint8_t udiv_up8(uint8_t x, uint8_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint16_t udiv_up16(uint16_t x, uint16_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint32_t udiv_up32(uint32_t x, uint32_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint64_t udiv_up64(uint64_t x, uint64_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint8_t umod8(uint8_t x, uint8_t y)\n{\n    return x % y;\n}\nstatic inline uint16_t umod16(uint16_t x, uint16_t y)\n{\n    return x % y;\n}\nstatic inline uint32_t umod32(uint32_t x, uint32_t y)\n{\n    return x % y;\n}\nstatic inline uint64_t umod64(uint64_t x, uint64_t y)\n{\n    return x % y;\n}\nstatic inline uint8_t udiv_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint16_t udiv_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint32_t udiv_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint64_t udiv_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint8_t umod_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint16_t umod_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint32_t umod_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint64_t umod_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int8_t sdiv8(int8_t x, int8_t y)\n{\n    int8_t q = x / y;\n    int8_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int16_t sdiv16(int16",
                   "_t x, int16_t y)\n{\n    int16_t q = x / y;\n    int16_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int32_t sdiv32(int32_t x, int32_t y)\n{\n    int32_t q = x / y;\n    int32_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int64_t sdiv64(int64_t x, int64_t y)\n{\n    int64_t q = x / y;\n    int64_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int8_t sdiv_up8(int8_t x, int8_t y)\n{\n    return sdiv8(x + y - 1, y);\n}\nstatic inline int16_t sdiv_up16(int16_t x, int16_t y)\n{\n    return sdiv16(x + y - 1, y);\n}\nstatic inline int32_t sdiv_up32(int32_t x, int32_t y)\n{\n    return sdiv32(x + y - 1, y);\n}\nstatic inline int64_t sdiv_up64(int64_t x, int64_t y)\n{\n    return sdiv64(x + y - 1, y);\n}\nstatic inline int8_t smod8(int8_t x, int8_t y)\n{\n    int8_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int16_t smod16(int16_t x, int16_t y)\n{\n    int16_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int32_t smod32(int32_t x, int32_t y)\n{\n    int32_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int64_t smod64(int64_t x, int64_t y)\n{\n    int64_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int8_t sdiv_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : sdiv8(x, y);\n}\nstatic inline int16_t sdiv_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : sdiv16(x, y);\n}\nstatic inline int32_t sdiv_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : sdiv32(x, y);\n}\nstatic inline int64_t sdiv_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : sdiv64(x, y);\n}\nstatic inline int8_t sdiv_up_safe8(int8_t x, int8_t y)\n{\n    return sdiv_safe8(x + y - 1, y);\n}\nstatic inline int16_t sdiv_up_safe16(int16_t x, int16_t y)\n{\n    return sdiv_safe16(x + y - 1, y",
                   ");\n}\nstatic inline int32_t sdiv_up_safe32(int32_t x, int32_t y)\n{\n    return sdiv_safe32(x + y - 1, y);\n}\nstatic inline int64_t sdiv_up_safe64(int64_t x, int64_t y)\n{\n    return sdiv_safe64(x + y - 1, y);\n}\nstatic inline int8_t smod_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : smod8(x, y);\n}\nstatic inline int16_t smod_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : smod16(x, y);\n}\nstatic inline int32_t smod_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : smod32(x, y);\n}\nstatic inline int64_t smod_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : smod64(x, y);\n}\nstatic inline int8_t squot8(int8_t x, int8_t y)\n{\n    return x / y;\n}\nstatic inline int16_t squot16(int16_t x, int16_t y)\n{\n    return x / y;\n}\nstatic inline int32_t squot32(int32_t x, int32_t y)\n{\n    return x / y;\n}\nstatic inline int64_t squot64(int64_t x, int64_t y)\n{\n    return x / y;\n}\nstatic inline int8_t srem8(int8_t x, int8_t y)\n{\n    return x % y;\n}\nstatic inline int16_t srem16(int16_t x, int16_t y)\n{\n    return x % y;\n}\nstatic inline int32_t srem32(int32_t x, int32_t y)\n{\n    return x % y;\n}\nstatic inline int64_t srem64(int64_t x, int64_t y)\n{\n    return x % y;\n}\nstatic inline int8_t squot_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int16_t squot_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int32_t squot_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int64_t squot_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int8_t srem_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int16_t srem_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int32_t srem_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int64_t srem_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int8_t smin8(int8_t x, int8_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int16_t smi",
                   "n16(int16_t x, int16_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int32_t smin32(int32_t x, int32_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int64_t smin64(int64_t x, int64_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint8_t umin8(uint8_t x, uint8_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint16_t umin16(uint16_t x, uint16_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint32_t umin32(uint32_t x, uint32_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint64_t umin64(uint64_t x, uint64_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int8_t smax8(int8_t x, int8_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int16_t smax16(int16_t x, int16_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int32_t smax32(int32_t x, int32_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int64_t smax64(int64_t x, int64_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint8_t umax8(uint8_t x, uint8_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint16_t umax16(uint16_t x, uint16_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint32_t umax32(uint32_t x, uint32_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint64_t umax64(uint64_t x, uint64_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint8_t shl8(uint8_t x, uint8_t y)\n{\n    return x << y;\n}\nstatic inline uint16_t shl16(uint16_t x, uint16_t y)\n{\n    return x << y;\n}\nstatic inline uint32_t shl32(uint32_t x, uint32_t y)\n{\n    return x << y;\n}\nstatic inline uint64_t shl64(uint64_t x, uint64_t y)\n{\n    return x << y;\n}\nstatic inline uint8_t lshr8(uint8_t x, uint8_t y)\n{\n    return x >> y;\n}\nstatic inline uint16_t lshr16(uint16_t x, uint16_t y)\n{\n    return x >> y;\n}\nstatic inline uint32_t lshr32(uint32_t x, uint32_t y)\n{\n    return x >> y;\n}\nstatic inline uint64_t lshr64(uint64_t x, uint64_t y)\n{\n    return x >> y;\n}\nstatic inline int8_t ashr8(int8_t x, int8_t y)\n{\n    return x >> y;\n}\nstatic inline int16_t ashr16(int16_t x, int16_t y)\n{\n    return x >> y;\n}\nstatic inline int32_t ashr32(int32_t x, int32_t y)",
                   "\n{\n    return x >> y;\n}\nstatic inline int64_t ashr64(int64_t x, int64_t y)\n{\n    return x >> y;\n}\nstatic inline uint8_t and8(uint8_t x, uint8_t y)\n{\n    return x & y;\n}\nstatic inline uint16_t and16(uint16_t x, uint16_t y)\n{\n    return x & y;\n}\nstatic inline uint32_t and32(uint32_t x, uint32_t y)\n{\n    return x & y;\n}\nstatic inline uint64_t and64(uint64_t x, uint64_t y)\n{\n    return x & y;\n}\nstatic inline uint8_t or8(uint8_t x, uint8_t y)\n{\n    return x | y;\n}\nstatic inline uint16_t or16(uint16_t x, uint16_t y)\n{\n    return x | y;\n}\nstatic inline uint32_t or32(uint32_t x, uint32_t y)\n{\n    return x | y;\n}\nstatic inline uint64_t or64(uint64_t x, uint64_t y)\n{\n    return x | y;\n}\nstatic inline uint8_t xor8(uint8_t x, uint8_t y)\n{\n    return x ^ y;\n}\nstatic inline uint16_t xor16(uint16_t x, uint16_t y)\n{\n    return x ^ y;\n}\nstatic inline uint32_t xor32(uint32_t x, uint32_t y)\n{\n    return x ^ y;\n}\nstatic inline uint64_t xor64(uint64_t x, uint64_t y)\n{\n    return x ^ y;\n}\nstatic inline bool ult8(uint8_t x, uint8_t y)\n{\n    return x < y;\n}\nstatic inline bool ult16(uint16_t x, uint16_t y)\n{\n    return x < y;\n}\nstatic inline bool ult32(uint32_t x, uint32_t y)\n{\n    return x < y;\n}\nstatic inline bool ult64(uint64_t x, uint64_t y)\n{\n    return x < y;\n}\nstatic inline bool ule8(uint8_t x, uint8_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule16(uint16_t x, uint16_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule32(uint32_t x, uint32_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule64(uint64_t x, uint64_t y)\n{\n    return x <= y;\n}\nstatic inline bool slt8(int8_t x, int8_t y)\n{\n    return x < y;\n}\nstatic inline bool slt16(int16_t x, int16_t y)\n{\n    return x < y;\n}\nstatic inline bool slt32(int32_t x, int32_t y)\n{\n    return x < y;\n}\nstatic inline bool slt64(int64_t x, int64_t y)\n{\n    return x < y;\n}\nstatic inline bool sle8(int8_t x, int8_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle16(int16_t x, int16_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle32(int32_t x, int32_",
                   "t y)\n{\n    return x <= y;\n}\nstatic inline bool sle64(int64_t x, int64_t y)\n{\n    return x <= y;\n}\nstatic inline int8_t pow8(int8_t x, int8_t y)\n{\n    int8_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int16_t pow16(int16_t x, int16_t y)\n{\n    int16_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int32_t pow32(int32_t x, int32_t y)\n{\n    int32_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int64_t pow64(int64_t x, int64_t y)\n{\n    int64_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline bool itob_i8_bool(int8_t x)\n{\n    return x;\n}\nstatic inline bool itob_i16_bool(int16_t x)\n{\n    return x;\n}\nstatic inline bool itob_i32_bool(int32_t x)\n{\n    return x;\n}\nstatic inline bool itob_i64_bool(int64_t x)\n{\n    return x;\n}\nstatic inline int8_t btoi_bool_i8(bool x)\n{\n    return x;\n}\nstatic inline int16_t btoi_bool_i16(bool x)\n{\n    return x;\n}\nstatic inline int32_t btoi_bool_i32(bool x)\n{\n    return x;\n}\nstatic inline int64_t btoi_bool_i64(bool x)\n{\n    return x;\n}\n#define sext_i8_i8(x) ((int8_t) (int8_t) x)\n#define sext_i8_i16(x) ((int16_t) (int8_t) x)\n#define sext_i8_i32(x) ((int32_t) (int8_t) x)\n#define sext_i8_i64(x) ((int64_t) (int8_t) x)\n#define sext_i16_i8(x) ((int8_t) (int16_t) x)\n#define sext_i16_i16(x) ((int16_t) (int16_t) x)\n#define sext_i16_i32(x) ((int32_t) (int16_t) x)\n#define sext_i16_i64(x) ((int64_t) (int16_t) x)\n#define sext_i32_i8(x) ((int8_t) (int32_t) x)\n#define sext_i32_i16(x) ((int16_t) (int32_t) x)\n#define sext_i32_i32(x) ((int32_t) (int32_t) x)\n#define sext_i32_i64(x) ((int64_t) (int32_t) x)\n#defi",
                   "ne sext_i64_i8(x) ((int8_t) (int64_t) x)\n#define sext_i64_i16(x) ((int16_t) (int64_t) x)\n#define sext_i64_i32(x) ((int32_t) (int64_t) x)\n#define sext_i64_i64(x) ((int64_t) (int64_t) x)\n#define zext_i8_i8(x) ((int8_t) (uint8_t) x)\n#define zext_i8_i16(x) ((int16_t) (uint8_t) x)\n#define zext_i8_i32(x) ((int32_t) (uint8_t) x)\n#define zext_i8_i64(x) ((int64_t) (uint8_t) x)\n#define zext_i16_i8(x) ((int8_t) (uint16_t) x)\n#define zext_i16_i16(x) ((int16_t) (uint16_t) x)\n#define zext_i16_i32(x) ((int32_t) (uint16_t) x)\n#define zext_i16_i64(x) ((int64_t) (uint16_t) x)\n#define zext_i32_i8(x) ((int8_t) (uint32_t) x)\n#define zext_i32_i16(x) ((int16_t) (uint32_t) x)\n#define zext_i32_i32(x) ((int32_t) (uint32_t) x)\n#define zext_i32_i64(x) ((int64_t) (uint32_t) x)\n#define zext_i64_i8(x) ((int8_t) (uint64_t) x)\n#define zext_i64_i16(x) ((int16_t) (uint64_t) x)\n#define zext_i64_i32(x) ((int32_t) (uint64_t) x)\n#define zext_i64_i64(x) ((int64_t) (uint64_t) x)\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_popc8(int8_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    return popcount(x);\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_popc8(int8_t x)\n{\n    return __popc(zext_i8_i32(x));\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    return __popc(zext_i16_i32(x));\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    return __popc(x);\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    return __popcll(x);\n}\n#else\nstatic int32_t futrts_popc8(int8_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    int c = 0;\n    \n    for ",
                   "(; x; ++c)\n        x &= x - 1;\n    return c;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    return mul_hi(a, b);\n}\n#elif defined(__CUDA_ARCH__)\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    uint16_t aa = a;\n    uint16_t bb = b;\n    \n    return aa * bb >> 8;\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    uint32_t aa = a;\n    uint32_t bb = b;\n    \n    return aa * bb >> 16;\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    return mulhi(a, b);\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    return mul64hi(a, b);\n}\n#else\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    uint16_t aa = a;\n    uint16_t bb = b;\n    \n    return aa * bb >> 8;\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    uint32_t aa = a;\n    uint32_t bb = b;\n    \n    return aa * bb >> 16;\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    uint64_t aa = a;\n    uint64_t bb = b;\n    \n    return aa * bb >> 32;\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    __uint128_t aa = a;\n    __uint128_t bb = b;\n    \n    return aa * bb >> 64;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)\n{\n    return mad_hi(a, b, c);\n}\n#else\nstatic uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)\n{\n    return futrts_mul_hi8(a, b) + c;\n}\nstatic uint16_t futrts_mad_hi16(uin",
                   "t16_t a, uint16_t b, uint16_t c)\n{\n    return futrts_mul_hi16(a, b) + c;\n}\nstatic uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)\n{\n    return futrts_mul_hi32(a, b) + c;\n}\nstatic uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)\n{\n    return futrts_mul_hi64(a, b) + c;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    return clz(x);\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    return __clz(zext_i8_i32(x)) - 24;\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    return __clz(zext_i16_i32(x)) - 16;\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    return __clz(x);\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    return __clzll(x);\n}\n#else\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    int i = 0;\n    \n    for (; i < 8 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz16(int16_t ",
                   "x)\n{\n    int i = 0;\n    \n    for (; i < 16 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    int i = 0;\n    \n    for (; i < 32 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    int i = 0;\n    \n    for (; i < 64 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 8 : y - 1;\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 16 : y - 1;\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 32 : y - 1;\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    int y = __ffsll(x);\n    \n    return y == 0 ? 64 : y - 1;\n}\n#else\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    return x == 0 ? 8 : __builtin_ctz((uint32_t) x);\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    return x == 0 ? 16 : __builtin_ctz((uint32_t) x);\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    return x == 0 ? 32 : __builtin_ctz(x);\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    return x == 0 ? 64 : __builtin_ctzl(x);\n}\n#endif\nstatic inline float fdiv32(float x, float y)\n{\n    return x / y;\n}\nstatic inline float fadd32(float x, float y)\n{\n    return x + y;\n}\nstatic inline float fsub32(float x, float y)\n{\n    return x - y;\n}\nstatic inline float fmul32(float x, float y)\n{\n    return x * y;\n}\nstatic inline float fmin32(float x, float y)\n{\n    return fmin(x, y);\n}\nstatic inline float fmax32(float x, float y)\n{\n    return fmax(x, y);\n}\nstatic inline float fpow32(float x, float y)\n{\n    return pow(x, y);\n}\nstatic inline bool cmplt32(float x, float y)\n{\n    return x < y;\n}\nstatic inline bool cmple32(float x, float y)\n{\n    return x <= y;\n}\nstatic inline float sitofp_i8_f32(int8_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i16_f32(int16_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i32_f32(int32_t x)",
                   "\n{\n    return (float) x;\n}\nstatic inline float sitofp_i64_f32(int64_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i8_f32(uint8_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i16_f32(uint16_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i32_f32(uint32_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i64_f32(uint64_t x)\n{\n    return (float) x;\n}\nstatic inline int8_t fptosi_f32_i8(float x)\n{\n    return (int8_t) x;\n}\nstatic inline int16_t fptosi_f32_i16(float x)\n{\n    return (int16_t) x;\n}\nstatic inline int32_t fptosi_f32_i32(float x)\n{\n    return (int32_t) x;\n}\nstatic inline int64_t fptosi_f32_i64(float x)\n{\n    return (int64_t) x;\n}\nstatic inline uint8_t fptoui_f32_i8(float x)\n{\n    return (uint8_t) x;\n}\nstatic inline uint16_t fptoui_f32_i16(float x)\n{\n    return (uint16_t) x;\n}\nstatic inline uint32_t fptoui_f32_i32(float x)\n{\n    return (uint32_t) x;\n}\nstatic inline uint64_t fptoui_f32_i64(float x)\n{\n    return (uint64_t) x;\n}\nstatic inline float futrts_log32(float x)\n{\n    return log(x);\n}\nstatic inline float futrts_log2_32(float x)\n{\n    return log2(x);\n}\nstatic inline float futrts_log10_32(float x)\n{\n    return log10(x);\n}\nstatic inline float futrts_sqrt32(float x)\n{\n    return sqrt(x);\n}\nstatic inline float futrts_exp32(float x)\n{\n    return exp(x);\n}\nstatic inline float futrts_cos32(float x)\n{\n    return cos(x);\n}\nstatic inline float futrts_sin32(float x)\n{\n    return sin(x);\n}\nstatic inline float futrts_tan32(float x)\n{\n    return tan(x);\n}\nstatic inline float futrts_acos32(float x)\n{\n    return acos(x);\n}\nstatic inline float futrts_asin32(float x)\n{\n    return asin(x);\n}\nstatic inline float futrts_atan32(float x)\n{\n    return atan(x);\n}\nstatic inline float futrts_cosh32(float x)\n{\n    return cosh(x);\n}\nstatic inline float futrts_sinh32(float x)\n{\n    return sinh(x);\n}\nstatic inline float futrts_tanh32(float x)\n{\n    return tanh(x);\n}\nstatic inline float futrts_acosh32(float x)\n{\n    return acosh(x);\n}\nstatic inline fl",
                   "oat futrts_asinh32(float x)\n{\n    return asinh(x);\n}\nstatic inline float futrts_atanh32(float x)\n{\n    return atanh(x);\n}\nstatic inline float futrts_atan2_32(float x, float y)\n{\n    return atan2(x, y);\n}\nstatic inline float futrts_gamma32(float x)\n{\n    return tgamma(x);\n}\nstatic inline float futrts_lgamma32(float x)\n{\n    return lgamma(x);\n}\nstatic inline bool futrts_isnan32(float x)\n{\n    return isnan(x);\n}\nstatic inline bool futrts_isinf32(float x)\n{\n    return isinf(x);\n}\nstatic inline int32_t futrts_to_bits32(float x)\n{\n    union {\n        float f;\n        int32_t t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\nstatic inline float futrts_from_bits32(int32_t x)\n{\n    union {\n        int32_t f;\n        float t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\n#ifdef __OPENCL_VERSION__\nstatic inline float fmod32(float x, float y)\n{\n    return fmod(x, y);\n}\nstatic inline float futrts_round32(float x)\n{\n    return rint(x);\n}\nstatic inline float futrts_floor32(float x)\n{\n    return floor(x);\n}\nstatic inline float futrts_ceil32(float x)\n{\n    return ceil(x);\n}\nstatic inline float futrts_lerp32(float v0, float v1, float t)\n{\n    return mix(v0, v1, t);\n}\nstatic inline float futrts_mad32(float a, float b, float c)\n{\n    return mad(a, b, c);\n}\nstatic inline float futrts_fma32(float a, float b, float c)\n{\n    return fma(a, b, c);\n}\n#else\nstatic inline float fmod32(float x, float y)\n{\n    return fmodf(x, y);\n}\nstatic inline float futrts_round32(float x)\n{\n    return rintf(x);\n}\nstatic inline float futrts_floor32(float x)\n{\n    return floorf(x);\n}\nstatic inline float futrts_ceil32(float x)\n{\n    return ceilf(x);\n}\nstatic inline float futrts_lerp32(float v0, float v1, float t)\n{\n    return v0 + (v1 - v0) * t;\n}\nstatic inline float futrts_mad32(float a, float b, float c)\n{\n    return a * b + c;\n}\nstatic inline float futrts_fma32(float a, float b, float c)\n{\n    return fmaf(a, b, c);\n}\n#endif\n// Start of atomics.h\n\ninline int32_t atomic_add_i32_global(volatile __global int32_t *p, ",
                   "int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\ninline int32_t atomic_add_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\ninline float atomic_fadd_f32_global(volatile __global float *p, float x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg((volatile __global int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\ninline float atomic_fadd_f32_local(volatile __local float *p, float x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg((volatile __local int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\ninline int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline int32_t atomic_smax_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline int32_t atomic_smin_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p",
                   ", x);\n#endif\n}\n\ninline uint32_t atomic_umax_i32_local(volatile __local uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline uint32_t atomic_umin_i32_local(volatile __local uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\ninline int32_t atomic_and_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\ninline int32_t atomic_or_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\ninline int32_t atomic_or_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\ninline int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xor_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xchg_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t",
                   " atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                         int32_t cmp, int32_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\ninline int32_t atomic_cmpxchg_i32_local(volatile __local int32_t *p,\n                                         int32_t cmp, int32_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\n// End of atomics.h\n\n\n\n\n__kernel void builtinzhreplicate_f32zireplicate_29137(__global\n                                                      unsigned char *mem_29133,\n                                                      int32_t num_elems_29134,\n                                                      float val_29135)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t replicate_gtid_29137;\n    int32_t replicate_ltid_29138;\n    int32_t replicate_gid_29139;\n    \n    replicate_gtid_29137 = get_global_id(0);\n    replicate_ltid_29138 = get_local_id(0);\n    replicate_gid_29139 = get_group_id(0);\n    if (slt64(replicate_gtid_29137, num_elems_29134)) {\n        ((__global float *) mem_29133)[sext_i32_i64(replicate_gtid_29137)] =\n            val_29135;\n    }\n    \n  error_0:\n    return;\n}\n__kernel void builtinzhreplicate_i64zireplicate_28729(__global\n                                                      unsigned char *mem_28725,\n                                                      int32_t num_elems_28726,\n                                                      int64_t val_28727)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t replicate_gtid_28729;\n    int32_t replicate_ltid_28730;\n    int32_t replicate_gid_28731;\n    \n    replicate_gtid_28729 = get_global_id(0);\n    replicate_ltid_28730 = get_local_id(0);\n    replicate_gid_28731 = get_group_id(0);\n    if (slt64(replicate_gtid_28729, nu",
                   "m_elems_28726)) {\n        ((__global int64_t *) mem_28725)[sext_i32_i64(replicate_gtid_28729)] =\n            val_28727;\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32(__local volatile\n                                    int64_t *block_9_backing_aligned_0,\n                                    int32_t destoffset_1, int32_t srcoffset_3,\n                                    int32_t num_arrays_4, int32_t x_elems_5,\n                                    int32_t y_elems_6, int32_t mulx_7,\n                                    int32_t muly_8, __global\n                                    unsigned char *destmem_0, __global\n                                    unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = get_group_id_2_42 * x_elems_5 * y_elems_6;\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t x_index_31 = get_global_id_0_37;\n    int32_t y_index_32 = get_group_id_1_41 * 32 + get_local_id_1_39;\n    \n    if (slt32(x_index_31, x_elems_5)) {\n        for (int32_t j_43 = 0; j_43 < 4; j_43++) {\n            int32",
                   "_t index_in_35 = (y_index_32 + j_43 * 8) * x_elems_5 +\n                    x_index_31;\n            \n            if (slt32(y_index_32 + j_43 * 8, y_elems_6)) {\n                ((__local float *) block_9)[sext_i32_i64((get_local_id_1_39 +\n                                                          j_43 * 8) * 33 +\n                                            get_local_id_0_38)] = ((__global\n                                                                    float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                                       index_in_35)];\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    x_index_31 = get_group_id_1_41 * 32 + get_local_id_0_38;\n    y_index_32 = get_group_id_0_40 * 32 + get_local_id_1_39;\n    if (slt32(x_index_31, y_elems_6)) {\n        for (int32_t j_43 = 0; j_43 < 4; j_43++) {\n            int32_t index_out_36 = (y_index_32 + j_43 * 8) * y_elems_6 +\n                    x_index_31;\n            \n            if (slt32(y_index_32 + j_43 * 8, x_elems_5)) {\n                ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                               index_out_36)] = ((__local\n                                                                  float *) block_9)[sext_i32_i64(get_local_id_0_38 *\n                                                                                    33 +\n                                                                                    get_local_id_1_39 +\n                                                                                    j_43 *\n                                                                                    8)];\n            }\n        }\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32_low_height(__local volatile\n                                               int64_t *block_9_backing_aligned_0,\n                                               int32_t destoffset_1,\n                   ",
                   "                            int32_t srcoffset_3,\n                                               int32_t num_arrays_4,\n                                               int32_t x_elems_5,\n                                               int32_t y_elems_6,\n                                               int32_t mulx_7, int32_t muly_8,\n                                               __global\n                                               unsigned char *destmem_0,\n                                               __global unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = get_group_id_2_42 * x_elems_5 * y_elems_6;\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t x_index_31 = get_group_id_0_40 * 16 * mulx_7 + get_local_id_0_38 +\n            srem32(get_local_id_1_39, mulx_7) * 16;\n    int32_t y_index_32 = get_group_id_1_41 * 16 + squot32(get_local_id_1_39,\n                                                          mulx_7);\n    int32_t index_in_35 = y_index_32 * x_elems_5 + x_index_31;\n    \n    if (slt32(x_index_31, x_elems_5) && slt32(",
                   "y_index_32, y_elems_6)) {\n        ((__local float *) block_9)[sext_i32_i64(get_local_id_1_39 * 17 +\n                                    get_local_id_0_38)] = ((__global\n                                                            float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                               index_in_35)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    x_index_31 = get_group_id_1_41 * 16 + squot32(get_local_id_0_38, mulx_7);\n    y_index_32 = get_group_id_0_40 * 16 * mulx_7 + get_local_id_1_39 +\n        srem32(get_local_id_0_38, mulx_7) * 16;\n    \n    int32_t index_out_36 = y_index_32 * y_elems_6 + x_index_31;\n    \n    if (slt32(x_index_31, y_elems_6) && slt32(y_index_32, x_elems_5)) {\n        ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                       index_out_36)] = ((__local\n                                                          float *) block_9)[sext_i32_i64(get_local_id_0_38 *\n                                                                            17 +\n                                                                            get_local_id_1_39)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32_low_width(__local volatile\n                                              int64_t *block_9_backing_aligned_0,\n                                              int32_t destoffset_1,\n                                              int32_t srcoffset_3,\n                                              int32_t num_arrays_4,\n                                              int32_t x_elems_5,\n                                              int32_t y_elems_6, int32_t mulx_7,\n                                              int32_t muly_8, __global\n                                              unsigned char *destmem_0, __global\n                                              unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    co",
                   "nst int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = get_group_id_2_42 * x_elems_5 * y_elems_6;\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t x_index_31 = get_group_id_0_40 * 16 + squot32(get_local_id_0_38,\n                                                          muly_8);\n    int32_t y_index_32 = get_group_id_1_41 * 16 * muly_8 + get_local_id_1_39 +\n            srem32(get_local_id_0_38, muly_8) * 16;\n    int32_t index_in_35 = y_index_32 * x_elems_5 + x_index_31;\n    \n    if (slt32(x_index_31, x_elems_5) && slt32(y_index_32, y_elems_6)) {\n        ((__local float *) block_9)[sext_i32_i64(get_local_id_1_39 * 17 +\n                                    get_local_id_0_38)] = ((__global\n                                                            float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                               index_in_35)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    x_index_31 = get_group_id_1_41 * 16 * muly_8 + get_local_id_0_38 +\n        srem32(get_local_id_1_39, muly_8) * 16;\n    y_index_32 = get_group_id_0_40 * 16 + squot32(get_local_id_1_39, muly_8",
                   ");\n    \n    int32_t index_out_36 = y_index_32 * y_elems_6 + x_index_31;\n    \n    if (slt32(x_index_31, y_elems_6) && slt32(y_index_32, x_elems_5)) {\n        ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                       index_out_36)] = ((__local\n                                                          float *) block_9)[sext_i32_i64(get_local_id_0_38 *\n                                                                            17 +\n                                                                            get_local_id_1_39)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32_small(__local volatile\n                                          int64_t *block_9_backing_aligned_0,\n                                          int32_t destoffset_1,\n                                          int32_t srcoffset_3,\n                                          int32_t num_arrays_4,\n                                          int32_t x_elems_5, int32_t y_elems_6,\n                                          int32_t mulx_7, int32_t muly_8,\n                                          __global unsigned char *destmem_0,\n                                          __global unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    ",
                   "\n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = squot32(get_global_id_0_37, y_elems_6 *\n                                          x_elems_5) * (y_elems_6 * x_elems_5);\n    int32_t x_index_31 = squot32(srem32(get_global_id_0_37, y_elems_6 *\n                                        x_elems_5), y_elems_6);\n    int32_t y_index_32 = srem32(get_global_id_0_37, y_elems_6);\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t index_in_35 = y_index_32 * x_elems_5 + x_index_31;\n    int32_t index_out_36 = x_index_31 * y_elems_6 + y_index_32;\n    \n    if (slt32(get_global_id_0_37, x_elems_5 * y_elems_6 * num_arrays_4)) {\n        ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                       index_out_36)] = ((__global\n                                                          float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                             index_in_35)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void mainziscan_stage1_26729(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28653_backing_aligned_0,\n                                      int64_t n_24721, int64_t flat_dim_24906,\n                                      float res_25171, __global\n                                      unsigned char *res_mem_28235, __global\n                                      unsigned char *res_mem_28236, __global\n                                      unsigned char *mem_28276, __global\n                                      unsigned char *mem_28278,\n                                      int32_t num_threads_28647)\n{\n    #define segscan_group_sizze_26724 (mainzisegscan_group_sizze_26723)\n    \n    const int block_dim0 = 0;\n    const in",
                   "t block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28653_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28653_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28648;\n    int32_t local_tid_28649;\n    int64_t group_sizze_28652;\n    int32_t wave_sizze_28651;\n    int32_t group_tid_28650;\n    \n    global_tid_28648 = get_global_id(0);\n    local_tid_28649 = get_local_id(0);\n    group_sizze_28652 = get_local_size(0);\n    wave_sizze_28651 = LOCKSTEP_WIDTH;\n    group_tid_28650 = get_group_id(0);\n    \n    int32_t phys_tid_26729;\n    \n    phys_tid_26729 = global_tid_28648;\n    \n    __local char *scan_arr_mem_28653;\n    \n    scan_arr_mem_28653 = (__local char *) scan_arr_mem_28653_backing_0;\n    \n    int64_t x_25177;\n    int64_t x_25178;\n    \n    x_25177 = 0;\n    for (int64_t j_28655 = 0; j_28655 < sdiv_up64(flat_dim_24906,\n                                                  sext_i32_i64(num_threads_28647));\n         j_28655++) {\n        int64_t chunk_offset_28656 = segscan_group_sizze_26724 * j_28655 +\n                sext_i32_i64(group_tid_28650) * (segscan_group_sizze_26724 *\n                                                 sdiv_up64(flat_dim_24906,\n                                                           sext_i32_i64(num_threads_28647)));\n        int64_t flat_idx_28657 = chunk_offset_28656 +\n                sext_i32_i64(local_tid_28649);\n        int64_t gtid_26728 = flat_idx_28657;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_26728, flat_dim_24906)) {\n                int64_t binop_x_28107 = squot64(gtid_26728, n_24721);\n                int64_t binop_y_28108 = n_24721 * binop_x_28107;\n                int64_t new_index_28109 = gtid_26728 - binop_y_28108;\n                int64_t x_25180 = ((__global\n                                    int64_t *) res_mem_28235)[new_index_28109];\n          ",
                   "      float x_25181 = ((__global\n                                  float *) res_mem_28236)[new_index_28109];\n                float x_25182 = res_25171 / x_25181;\n                float ceil_arg_25183 = x_25182 - 1.0F;\n                float res_25184;\n                \n                res_25184 = futrts_ceil32(ceil_arg_25183);\n                \n                int64_t res_25185 = fptosi_f32_i64(res_25184);\n                int64_t max_arg_25186 = sub64(x_25180, res_25185);\n                int64_t res_25187 = smax64(0, max_arg_25186);\n                bool cond_25188 = res_25187 == 0;\n                int64_t res_25189;\n                \n                if (cond_25188) {\n                    res_25189 = 1;\n                } else {\n                    res_25189 = res_25187;\n                }\n                // write to-scan values to parameters\n                {\n                    x_25178 = res_25189;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global int64_t *) mem_28278)[gtid_26728] = res_25189;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_26728, flat_dim_24906)) {\n                    x_25178 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_25179 = add64(x_25177, x_25178);\n                \n                ((__local\n                  int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)] =\n                    res_25179;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_28658;\n            int64_t x_28659;\n            int64_t x_28661;\n            int64_t x_28662;\n            bool ltid_in_bounds_28664;\n            \n            ltid_in_bounds_28664 = slt64(sext_i32_i64(local_tid_28649),\n   ",
                   "                                      segscan_group_sizze_26724);\n            \n            int32_t skip_threads_28665;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28664) {\n                    x_28659 = ((volatile __local\n                                int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)];\n                    if ((local_tid_28649 - squot32(local_tid_28649, 32) * 32) ==\n                        0) {\n                        x_28658 = x_28659;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28665 = 1;\n                while (slt32(skip_threads_28665, 32)) {\n                    if (sle32(skip_threads_28665, local_tid_28649 -\n                              squot32(local_tid_28649, 32) * 32) &&\n                        ltid_in_bounds_28664) {\n                        // read operands\n                        {\n                            x_28658 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649) -\n                                                                       sext_i32_i64(skip_threads_28665)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_28660 = add64(x_28658, x_28659);\n                            \n                            x_28658 = res_28660;\n                        }\n                    }\n                    if (sle32(wave_sizze_28651, skip_threads_28665)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28665, local_tid_28649 -\n                              squot32(local_tid_28649, 32) * 32) &&\n                        ltid_in_bounds_28664) {\n                        // write result\n                        {\n                            ((volat",
                   "ile __local\n                              int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)] =\n                                x_28658;\n                            x_28659 = x_28658;\n                        }\n                    }\n                    if (sle32(wave_sizze_28651, skip_threads_28665)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28665 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28649 - squot32(local_tid_28649, 32) * 32) ==\n                    31 && ltid_in_bounds_28664) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28653)[sext_i32_i64(squot32(local_tid_28649,\n                                                                          32))] =\n                        x_28658;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28666;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28649, 32) == 0 &&\n                        ltid_in_bounds_28664) {\n                        x_28662 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)];\n                        if ((local_tid_28649 - squot32(local_tid_28649, 32) *\n                             32) == 0) {\n                            x_28661 = x_28662;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28666 = 1;\n                    while (slt32(skip_threads_28666, 32)) {\n                        if (sle32(skip_threads",
                   "_28666, local_tid_28649 -\n                                  squot32(local_tid_28649, 32) * 32) &&\n                            (squot32(local_tid_28649, 32) == 0 &&\n                             ltid_in_bounds_28664)) {\n                            // read operands\n                            {\n                                x_28661 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649) -\n                                                                           sext_i32_i64(skip_threads_28666)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_28663 = add64(x_28661, x_28662);\n                                \n                                x_28661 = res_28663;\n                            }\n                        }\n                        if (sle32(wave_sizze_28651, skip_threads_28666)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28666, local_tid_28649 -\n                                  squot32(local_tid_28649, 32) * 32) &&\n                            (squot32(local_tid_28649, 32) == 0 &&\n                             ltid_in_bounds_28664)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)] =\n                                    x_28661;\n                                x_28662 = x_28661;\n                            }\n                        }\n                        if (sle32(wave_sizze_28651, skip_threads_28666)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28666 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);",
                   "\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28649, 32) == 0 ||\n                      !ltid_in_bounds_28664)) {\n                    // read operands\n                    {\n                        x_28659 = x_28658;\n                        x_28658 = ((__local\n                                    int64_t *) scan_arr_mem_28653)[sext_i32_i64(squot32(local_tid_28649,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28660 = add64(x_28658, x_28659);\n                        \n                        x_28658 = res_28660;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)] =\n                            x_28658;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28649, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)] =\n                        x_28659;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_26728, flat_dim_24906)) {\n                    ((__global int64_t *) mem_28276)[gtid_26728] = ((__local\n                                                                     int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteratio",
                   "n\n            {\n                bool crosses_segment_28667 = 0;\n                bool should_load_carry_28668 = local_tid_28649 == 0 &&\n                     !crosses_segment_28667;\n                \n                if (should_load_carry_28668) {\n                    x_25177 = ((__local\n                                int64_t *) scan_arr_mem_28653)[segscan_group_sizze_26724 -\n                                                               1];\n                }\n                if (!should_load_carry_28668) {\n                    x_25177 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_26724\n}\n__kernel void mainziscan_stage1_26762(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28892_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28890_backing_aligned_1,\n                                      int64_t res_25191, __global\n                                      unsigned char *mem_28283, __global\n                                      unsigned char *mem_28287, __global\n                                      unsigned char *mem_28289,\n                                      int32_t num_threads_28884)\n{\n    #define segscan_group_sizze_26757 (mainzisegscan_group_sizze_26756)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28892_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28892_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28890_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28890_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_t",
                   "id_28885;\n    int32_t local_tid_28886;\n    int64_t group_sizze_28889;\n    int32_t wave_sizze_28888;\n    int32_t group_tid_28887;\n    \n    global_tid_28885 = get_global_id(0);\n    local_tid_28886 = get_local_id(0);\n    group_sizze_28889 = get_local_size(0);\n    wave_sizze_28888 = LOCKSTEP_WIDTH;\n    group_tid_28887 = get_group_id(0);\n    \n    int32_t phys_tid_26762;\n    \n    phys_tid_26762 = global_tid_28885;\n    \n    __local char *scan_arr_mem_28890;\n    __local char *scan_arr_mem_28892;\n    \n    scan_arr_mem_28890 = (__local char *) scan_arr_mem_28890_backing_0;\n    scan_arr_mem_28892 = (__local char *) scan_arr_mem_28892_backing_1;\n    \n    bool x_25210;\n    int64_t x_25211;\n    bool x_25212;\n    int64_t x_25213;\n    \n    x_25210 = 0;\n    x_25211 = 0;\n    for (int64_t j_28894 = 0; j_28894 < sdiv_up64(res_25191,\n                                                  sext_i32_i64(num_threads_28884));\n         j_28894++) {\n        int64_t chunk_offset_28895 = segscan_group_sizze_26757 * j_28894 +\n                sext_i32_i64(group_tid_28887) * (segscan_group_sizze_26757 *\n                                                 sdiv_up64(res_25191,\n                                                           sext_i32_i64(num_threads_28884)));\n        int64_t flat_idx_28896 = chunk_offset_28895 +\n                sext_i32_i64(local_tid_28886);\n        int64_t gtid_26761 = flat_idx_28896;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_26761, res_25191)) {\n                int64_t x_25217 = ((__global int64_t *) mem_28283)[gtid_26761];\n                bool res_25218 = slt64(0, x_25217);\n                \n                // write to-scan values to parameters\n                {\n                    x_25212 = res_25218;\n                    x_25213 = x_25217;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // may",
                   "be restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_26761, res_25191)) {\n                    x_25212 = 0;\n                    x_25213 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_25214 = x_25210 || x_25212;\n                int64_t res_25215;\n                \n                if (x_25212) {\n                    res_25215 = x_25213;\n                } else {\n                    int64_t res_25216 = add64(x_25211, x_25213);\n                    \n                    res_25215 = res_25216;\n                }\n                ((__local\n                  bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)] =\n                    res_25214;\n                ((__local\n                  int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)] =\n                    res_25215;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28897;\n            int64_t x_28898;\n            bool x_28899;\n            int64_t x_28900;\n            bool x_28904;\n            int64_t x_28905;\n            bool x_28906;\n            int64_t x_28907;\n            bool ltid_in_bounds_28911;\n            \n            ltid_in_bounds_28911 = slt64(sext_i32_i64(local_tid_28886),\n                                         segscan_group_sizze_26757);\n            \n            int32_t skip_threads_28912;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28911) {\n                    x_28899 = ((volatile __local\n                                bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)];\n                    x_28900 = ((volatile __local\n                                int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)];\n                    if ((local_tid_28886 - squot32(local_tid_28886, 32) * 32) ==\n                        0) {\n                        x_2889",
                   "7 = x_28899;\n                        x_28898 = x_28900;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28912 = 1;\n                while (slt32(skip_threads_28912, 32)) {\n                    if (sle32(skip_threads_28912, local_tid_28886 -\n                              squot32(local_tid_28886, 32) * 32) &&\n                        ltid_in_bounds_28911) {\n                        // read operands\n                        {\n                            x_28897 = ((volatile __local\n                                        bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886) -\n                                                                    sext_i32_i64(skip_threads_28912)];\n                            x_28898 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886) -\n                                                                       sext_i32_i64(skip_threads_28912)];\n                        }\n                        // perform operation\n                        {\n                            bool res_28901 = x_28897 || x_28899;\n                            int64_t res_28902;\n                            \n                            if (x_28899) {\n                                res_28902 = x_28900;\n                            } else {\n                                int64_t res_28903 = add64(x_28898, x_28900);\n                                \n                                res_28902 = res_28903;\n                            }\n                            x_28897 = res_28901;\n                            x_28898 = res_28902;\n                        }\n                    }\n                    if (sle32(wave_sizze_28888, skip_threads_28912)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28912, local_tid_28886 -\n                ",
                   "              squot32(local_tid_28886, 32) * 32) &&\n                        ltid_in_bounds_28911) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)] =\n                                x_28897;\n                            x_28899 = x_28897;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)] =\n                                x_28898;\n                            x_28900 = x_28898;\n                        }\n                    }\n                    if (sle32(wave_sizze_28888, skip_threads_28912)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28912 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28886 - squot32(local_tid_28886, 32) * 32) ==\n                    31 && ltid_in_bounds_28911) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28890)[sext_i32_i64(squot32(local_tid_28886,\n                                                                       32))] =\n                        x_28897;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28892)[sext_i32_i64(squot32(local_tid_28886,\n                                                                          32))] =\n                        x_28898;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28913;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28886, 32) == 0 &",
                   "&\n                        ltid_in_bounds_28911) {\n                        x_28906 = ((volatile __local\n                                    bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)];\n                        x_28907 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)];\n                        if ((local_tid_28886 - squot32(local_tid_28886, 32) *\n                             32) == 0) {\n                            x_28904 = x_28906;\n                            x_28905 = x_28907;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28913 = 1;\n                    while (slt32(skip_threads_28913, 32)) {\n                        if (sle32(skip_threads_28913, local_tid_28886 -\n                                  squot32(local_tid_28886, 32) * 32) &&\n                            (squot32(local_tid_28886, 32) == 0 &&\n                             ltid_in_bounds_28911)) {\n                            // read operands\n                            {\n                                x_28904 = ((volatile __local\n                                            bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886) -\n                                                                        sext_i32_i64(skip_threads_28913)];\n                                x_28905 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886) -\n                                                                           sext_i32_i64(skip_threads_28913)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28908 = x_28904 || x_28906;\n                                int64_t res_28909;\n                                \n                                i",
                   "f (x_28906) {\n                                    res_28909 = x_28907;\n                                } else {\n                                    int64_t res_28910 = add64(x_28905, x_28907);\n                                    \n                                    res_28909 = res_28910;\n                                }\n                                x_28904 = res_28908;\n                                x_28905 = res_28909;\n                            }\n                        }\n                        if (sle32(wave_sizze_28888, skip_threads_28913)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28913, local_tid_28886 -\n                                  squot32(local_tid_28886, 32) * 32) &&\n                            (squot32(local_tid_28886, 32) == 0 &&\n                             ltid_in_bounds_28911)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)] =\n                                    x_28904;\n                                x_28906 = x_28904;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)] =\n                                    x_28905;\n                                x_28907 = x_28905;\n                            }\n                        }\n                        if (sle32(wave_sizze_28888, skip_threads_28913)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28913 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28886, 32) == 0 ||\n                      !ltid_in_bounds_289",
                   "11)) {\n                    // read operands\n                    {\n                        x_28899 = x_28897;\n                        x_28900 = x_28898;\n                        x_28897 = ((__local\n                                    bool *) scan_arr_mem_28890)[sext_i32_i64(squot32(local_tid_28886,\n                                                                                     32)) -\n                                                                1];\n                        x_28898 = ((__local\n                                    int64_t *) scan_arr_mem_28892)[sext_i32_i64(squot32(local_tid_28886,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        bool res_28901 = x_28897 || x_28899;\n                        int64_t res_28902;\n                        \n                        if (x_28899) {\n                            res_28902 = x_28900;\n                        } else {\n                            int64_t res_28903 = add64(x_28898, x_28900);\n                            \n                            res_28902 = res_28903;\n                        }\n                        x_28897 = res_28901;\n                        x_28898 = res_28902;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)] =\n                            x_28897;\n                        ((__local\n                          int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)] =\n                            x_28898;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28886, 32) == 0)",
                   " {\n                    ((__local\n                      bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)] =\n                        x_28899;\n                    ((__local\n                      int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)] =\n                        x_28900;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_26761, res_25191)) {\n                    ((__global bool *) mem_28287)[gtid_26761] = ((__local\n                                                                  bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)];\n                    ((__global int64_t *) mem_28289)[gtid_26761] = ((__local\n                                                                     int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28914 = 0;\n                bool should_load_carry_28915 = local_tid_28886 == 0 &&\n                     !crosses_segment_28914;\n                \n                if (should_load_carry_28915) {\n                    x_25210 = ((__local\n                                bool *) scan_arr_mem_28890)[segscan_group_sizze_26757 -\n                                                            1];\n                    x_25211 = ((__local\n                                int64_t *) scan_arr_mem_28892)[segscan_group_sizze_26757 -\n                                                               1];\n                }\n                if (!should_load_carry_28915) {\n                    x_25210 = 0;\n                    x_25211 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_26757\n}\n__kernel void mainzis",
                   "can_stage1_26770(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28959_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28957_backing_aligned_1,\n                                      int64_t res_25191, __global\n                                      unsigned char *mem_28289, __global\n                                      unsigned char *mem_28292, __global\n                                      unsigned char *mem_28294, __global\n                                      unsigned char *mem_28296,\n                                      int32_t num_threads_28951)\n{\n    #define segscan_group_sizze_26765 (mainzisegscan_group_sizze_26764)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28959_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28959_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28957_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28957_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28952;\n    int32_t local_tid_28953;\n    int64_t group_sizze_28956;\n    int32_t wave_sizze_28955;\n    int32_t group_tid_28954;\n    \n    global_tid_28952 = get_global_id(0);\n    local_tid_28953 = get_local_id(0);\n    group_sizze_28956 = get_local_size(0);\n    wave_sizze_28955 = LOCKSTEP_WIDTH;\n    group_tid_28954 = get_group_id(0);\n    \n    int32_t phys_tid_26770;\n    \n    phys_tid_26770 = global_tid_28952;\n    \n    __local char *scan_arr_mem_28957;\n    __local char *scan_arr_mem_28959;\n    \n    scan_arr_mem_28957 = (__local char *) scan_arr_mem_28957_backing_0;\n    scan_arr_mem_28959 = (__local char *) scan_arr_mem_28959_backing_1;\n    ",
                   "\n    bool x_25249;\n    int64_t x_25250;\n    bool x_25251;\n    int64_t x_25252;\n    \n    x_25249 = 0;\n    x_25250 = 0;\n    for (int64_t j_28961 = 0; j_28961 < sdiv_up64(res_25191,\n                                                  sext_i32_i64(num_threads_28951));\n         j_28961++) {\n        int64_t chunk_offset_28962 = segscan_group_sizze_26765 * j_28961 +\n                sext_i32_i64(group_tid_28954) * (segscan_group_sizze_26765 *\n                                                 sdiv_up64(res_25191,\n                                                           sext_i32_i64(num_threads_28951)));\n        int64_t flat_idx_28963 = chunk_offset_28962 +\n                sext_i32_i64(local_tid_28953);\n        int64_t gtid_26769 = flat_idx_28963;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_26769, res_25191)) {\n                int64_t x_25256 = ((__global int64_t *) mem_28289)[gtid_26769];\n                int64_t i_p_o_28118 = add64(-1, gtid_26769);\n                int64_t rot_i_28119 = smod64(i_p_o_28118, res_25191);\n                int64_t x_25257 = ((__global int64_t *) mem_28289)[rot_i_28119];\n                bool res_25259 = x_25256 == x_25257;\n                bool res_25260 = !res_25259;\n                \n                // write to-scan values to parameters\n                {\n                    x_25251 = res_25260;\n                    x_25252 = 1;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global bool *) mem_28296)[gtid_26769] = res_25260;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_26769, res_25191)) {\n                    x_25251 = 0;\n                    x_25252 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n  ",
                   "              bool res_25253 = x_25249 || x_25251;\n                int64_t res_25254;\n                \n                if (x_25251) {\n                    res_25254 = x_25252;\n                } else {\n                    int64_t res_25255 = add64(x_25250, x_25252);\n                    \n                    res_25254 = res_25255;\n                }\n                ((__local\n                  bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)] =\n                    res_25253;\n                ((__local\n                  int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953)] =\n                    res_25254;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28964;\n            int64_t x_28965;\n            bool x_28966;\n            int64_t x_28967;\n            bool x_28971;\n            int64_t x_28972;\n            bool x_28973;\n            int64_t x_28974;\n            bool ltid_in_bounds_28978;\n            \n            ltid_in_bounds_28978 = slt64(sext_i32_i64(local_tid_28953),\n                                         segscan_group_sizze_26765);\n            \n            int32_t skip_threads_28979;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28978) {\n                    x_28966 = ((volatile __local\n                                bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)];\n                    x_28967 = ((volatile __local\n                                int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953)];\n                    if ((local_tid_28953 - squot32(local_tid_28953, 32) * 32) ==\n                        0) {\n                        x_28964 = x_28966;\n                        x_28965 = x_28967;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28979 = 1;\n                while (slt32(skip_threads_28979, 32)) {\n                    if ",
                   "(sle32(skip_threads_28979, local_tid_28953 -\n                              squot32(local_tid_28953, 32) * 32) &&\n                        ltid_in_bounds_28978) {\n                        // read operands\n                        {\n                            x_28964 = ((volatile __local\n                                        bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953) -\n                                                                    sext_i32_i64(skip_threads_28979)];\n                            x_28965 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953) -\n                                                                       sext_i32_i64(skip_threads_28979)];\n                        }\n                        // perform operation\n                        {\n                            bool res_28968 = x_28964 || x_28966;\n                            int64_t res_28969;\n                            \n                            if (x_28966) {\n                                res_28969 = x_28967;\n                            } else {\n                                int64_t res_28970 = add64(x_28965, x_28967);\n                                \n                                res_28969 = res_28970;\n                            }\n                            x_28964 = res_28968;\n                            x_28965 = res_28969;\n                        }\n                    }\n                    if (sle32(wave_sizze_28955, skip_threads_28979)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28979, local_tid_28953 -\n                              squot32(local_tid_28953, 32) * 32) &&\n                        ltid_in_bounds_28978) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)] =",
                   "\n                                x_28964;\n                            x_28966 = x_28964;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953)] =\n                                x_28965;\n                            x_28967 = x_28965;\n                        }\n                    }\n                    if (sle32(wave_sizze_28955, skip_threads_28979)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28979 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28953 - squot32(local_tid_28953, 32) * 32) ==\n                    31 && ltid_in_bounds_28978) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28957)[sext_i32_i64(squot32(local_tid_28953,\n                                                                       32))] =\n                        x_28964;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28959)[sext_i32_i64(squot32(local_tid_28953,\n                                                                          32))] =\n                        x_28965;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28980;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28953, 32) == 0 &&\n                        ltid_in_bounds_28978) {\n                        x_28973 = ((volatile __local\n                                    bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)];\n                        x_28974 = ((volatile __local\n                                    int64_t *) scan",
                   "_arr_mem_28959)[sext_i32_i64(local_tid_28953)];\n                        if ((local_tid_28953 - squot32(local_tid_28953, 32) *\n                             32) == 0) {\n                            x_28971 = x_28973;\n                            x_28972 = x_28974;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28980 = 1;\n                    while (slt32(skip_threads_28980, 32)) {\n                        if (sle32(skip_threads_28980, local_tid_28953 -\n                                  squot32(local_tid_28953, 32) * 32) &&\n                            (squot32(local_tid_28953, 32) == 0 &&\n                             ltid_in_bounds_28978)) {\n                            // read operands\n                            {\n                                x_28971 = ((volatile __local\n                                            bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953) -\n                                                                        sext_i32_i64(skip_threads_28980)];\n                                x_28972 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953) -\n                                                                           sext_i32_i64(skip_threads_28980)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28975 = x_28971 || x_28973;\n                                int64_t res_28976;\n                                \n                                if (x_28973) {\n                                    res_28976 = x_28974;\n                                } else {\n                                    int64_t res_28977 = add64(x_28972, x_28974);\n                                    \n                                    res_28976 = res_28977;\n              ",
                   "                  }\n                                x_28971 = res_28975;\n                                x_28972 = res_28976;\n                            }\n                        }\n                        if (sle32(wave_sizze_28955, skip_threads_28980)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28980, local_tid_28953 -\n                                  squot32(local_tid_28953, 32) * 32) &&\n                            (squot32(local_tid_28953, 32) == 0 &&\n                             ltid_in_bounds_28978)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)] =\n                                    x_28971;\n                                x_28973 = x_28971;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953)] =\n                                    x_28972;\n                                x_28974 = x_28972;\n                            }\n                        }\n                        if (sle32(wave_sizze_28955, skip_threads_28980)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28980 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28953, 32) == 0 ||\n                      !ltid_in_bounds_28978)) {\n                    // read operands\n                    {\n                        x_28966 = x_28964;\n                        x_28967 = x_28965;\n                        x_28964 = ((__local\n                                    bool *) scan_arr_mem_28957)[sext_i32_i64(squot32(local_tid_28953,\n     ",
                   "                                                                                32)) -\n                                                                1];\n                        x_28965 = ((__local\n                                    int64_t *) scan_arr_mem_28959)[sext_i32_i64(squot32(local_tid_28953,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        bool res_28968 = x_28964 || x_28966;\n                        int64_t res_28969;\n                        \n                        if (x_28966) {\n                            res_28969 = x_28967;\n                        } else {\n                            int64_t res_28970 = add64(x_28965, x_28967);\n                            \n                            res_28969 = res_28970;\n                        }\n                        x_28964 = res_28968;\n                        x_28965 = res_28969;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)] =\n                            x_28964;\n                        ((__local\n                          int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953)] =\n                            x_28965;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28953, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)] =\n                        x_28966;\n                    ((__local\n                      int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953)] =\n                        x_28967;\n     ",
                   "           }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_26769, res_25191)) {\n                    ((__global bool *) mem_28292)[gtid_26769] = ((__local\n                                                                  bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)];\n                    ((__global int64_t *) mem_28294)[gtid_26769] = ((__local\n                                                                     int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28981 = 0;\n                bool should_load_carry_28982 = local_tid_28953 == 0 &&\n                     !crosses_segment_28981;\n                \n                if (should_load_carry_28982) {\n                    x_25249 = ((__local\n                                bool *) scan_arr_mem_28957)[segscan_group_sizze_26765 -\n                                                            1];\n                    x_25250 = ((__local\n                                int64_t *) scan_arr_mem_28959)[segscan_group_sizze_26765 -\n                                                               1];\n                }\n                if (!should_load_carry_28982) {\n                    x_25249 = 0;\n                    x_25250 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_26765\n}\n__kernel void mainziscan_stage1_26778(__global int *global_failure,\n                                      int failure_is_an_option, __global\n                                      int64_t *global_failure_args,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_",
                   "29026_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29024_backing_aligned_1,\n                                      int64_t n_24721, int64_t paths_24724,\n                                      float a_24729, float b_24730,\n                                      float sigma_24731, int64_t flat_dim_24906,\n                                      float res_25171, int64_t res_25191,\n                                      int64_t i_26654, __global\n                                      unsigned char *res_mem_28233, __global\n                                      unsigned char *res_mem_28234, __global\n                                      unsigned char *res_mem_28235, __global\n                                      unsigned char *res_mem_28236, __global\n                                      unsigned char *mem_28264, __global\n                                      unsigned char *mem_28289, __global\n                                      unsigned char *mem_28294, __global\n                                      unsigned char *mem_28296, __global\n                                      unsigned char *mem_28299, __global\n                                      unsigned char *mem_28301,\n                                      int32_t num_threads_29018)\n{\n    #define segscan_group_sizze_26773 (mainzisegscan_group_sizze_26772)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29026_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_29026_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29024_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29024_backing_aligned_1;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n   ",
                   "     if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29019;\n    int32_t local_tid_29020;\n    int64_t group_sizze_29023;\n    int32_t wave_sizze_29022;\n    int32_t group_tid_29021;\n    \n    global_tid_29019 = get_global_id(0);\n    local_tid_29020 = get_local_id(0);\n    group_sizze_29023 = get_local_size(0);\n    wave_sizze_29022 = LOCKSTEP_WIDTH;\n    group_tid_29021 = get_group_id(0);\n    \n    int32_t phys_tid_26778;\n    \n    phys_tid_26778 = global_tid_29019;\n    \n    __local char *scan_arr_mem_29024;\n    __local char *scan_arr_mem_29026;\n    \n    scan_arr_mem_29024 = (__local char *) scan_arr_mem_29024_backing_0;\n    scan_arr_mem_29026 = (__local char *) scan_arr_mem_29026_backing_1;\n    \n    bool x_25275;\n    float x_25276;\n    bool x_25277;\n    float x_25278;\n    \n    x_25275 = 0;\n    x_25276 = 0.0F;\n    for (int64_t j_29028 = 0; j_29028 < sdiv_up64(res_25191,\n                                                  sext_i32_i64(num_threads_29018));\n         j_29028++) {\n        int64_t chunk_offset_29029 = segscan_group_sizze_26773 * j_29028 +\n                sext_i32_i64(group_tid_29021) * (segscan_group_sizze_26773 *\n                                                 sdiv_up64(res_25191,\n                                                           sext_i32_i64(num_threads_29018)));\n        int64_t flat_idx_29030 = chunk_offset_29029 +\n                sext_i32_i64(local_tid_29020);\n        int64_t gtid_26777 = flat_idx_29030;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_26777, res_25191)) {\n                int64_t x_25283 = ((__global int64_t *) mem_28294)[gtid_26777];\n                int64_t x_25284 = ((__global int64_t *) mem_28289)[gtid_26777];\n                bool x_25285 = ((__global bool *) mem_28296)[gtid_26777];\n                int64_t res_25288 = sub64(x_25283, 1);\n                bool x_25289 = sle64(0, x_25284);\n                bool y_25290 = sl",
                   "t64(x_25284, flat_dim_24906);\n                bool bounds_check_25291 = x_25289 && y_25290;\n                bool index_certs_25292;\n                \n                if (!bounds_check_25291) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 8) ==\n                            -1) {\n                            global_failure_args[0] = x_25284;\n                            global_failure_args[1] = flat_dim_24906;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t new_index_25293 = squot64(x_25284, n_24721);\n                int64_t binop_y_25294 = n_24721 * new_index_25293;\n                int64_t new_index_25295 = x_25284 - binop_y_25294;\n                int64_t lifted_0_get_arg_25299 = ((__global\n                                                   int64_t *) res_mem_28235)[new_index_25295];\n                float lifted_0_get_arg_25300 = ((__global\n                                                 float *) res_mem_28236)[new_index_25295];\n                float x_25301 = res_25171 / lifted_0_get_arg_25300;\n                float ceil_arg_25302 = x_25301 - 1.0F;\n                float res_25303;\n                \n                res_25303 = futrts_ceil32(ceil_arg_25302);\n                \n                int64_t res_25304 = fptosi_f32_i64(res_25303);\n                int64_t max_arg_25305 = sub64(lifted_0_get_arg_25299,\n                                              res_25304);\n                int64_t res_25306 = smax64(0, max_arg_25305);\n                bool cond_25307 = res_25306 == 0;\n                float res_25308;\n                \n                if (cond_25307) {\n                    res_25308 = 0.0F;\n                } else {\n                    float lifted_0_get_arg_25296 = ((__global\n                                                     float *) mem_28264)[i_2",
                   "6654 *\n                                                                         paths_24724 +\n                                                                         new_index_25293];\n                    float lifted_0_get_arg_25297 = ((__global\n                                                     float *) res_mem_28233)[new_index_25295];\n                    float lifted_0_get_arg_25298 = ((__global\n                                                     float *) res_mem_28234)[new_index_25295];\n                    float res_25309;\n                    \n                    res_25309 = futrts_ceil32(x_25301);\n                    \n                    float start_25310 = lifted_0_get_arg_25300 * res_25309;\n                    float res_25311;\n                    \n                    res_25311 = futrts_ceil32(ceil_arg_25302);\n                    \n                    int64_t res_25312 = fptosi_f32_i64(res_25311);\n                    int64_t max_arg_25313 = sub64(lifted_0_get_arg_25299,\n                                                  res_25312);\n                    int64_t res_25314 = smax64(0, max_arg_25313);\n                    int64_t sizze_25315 = sub64(res_25314, 1);\n                    bool cond_25316 = res_25288 == 0;\n                    float res_25317;\n                    \n                    if (cond_25316) {\n                        res_25317 = 1.0F;\n                    } else {\n                        res_25317 = 0.0F;\n                    }\n                    \n                    bool cond_25318 = slt64(0, res_25288);\n                    float res_25319;\n                    \n                    if (cond_25318) {\n                        float y_25320 = lifted_0_get_arg_25297 *\n                              lifted_0_get_arg_25300;\n                        float res_25321 = res_25317 - y_25320;\n                        \n                        res_25319 = res_25321;\n                    } else {\n                        res_25319 = res_25317;\n                    }\n   ",
                   "                 \n                    bool cond_25322 = res_25288 == sizze_25315;\n                    float res_25323;\n                    \n                    if (cond_25322) {\n                        float res_25324 = res_25319 - 1.0F;\n                        \n                        res_25323 = res_25324;\n                    } else {\n                        res_25323 = res_25319;\n                    }\n                    \n                    float res_25325 = lifted_0_get_arg_25298 * res_25323;\n                    float res_25326 = sitofp_i64_f32(res_25288);\n                    float y_25327 = lifted_0_get_arg_25300 * res_25326;\n                    float bondprice_arg_25328 = start_25310 + y_25327;\n                    float y_25329 = bondprice_arg_25328 - res_25171;\n                    float negate_arg_25330 = a_24729 * y_25329;\n                    float exp_arg_25331 = 0.0F - negate_arg_25330;\n                    float res_25332 = fpow32(2.7182817F, exp_arg_25331);\n                    float x_25333 = 1.0F - res_25332;\n                    float B_25334 = x_25333 / a_24729;\n                    float x_25335 = B_25334 - bondprice_arg_25328;\n                    float x_25336 = res_25171 + x_25335;\n                    float x_25337 = fpow32(a_24729, 2.0F);\n                    float x_25338 = b_24730 * x_25337;\n                    float x_25339 = fpow32(sigma_24731, 2.0F);\n                    float y_25340 = x_25339 / 2.0F;\n                    float y_25341 = x_25338 - y_25340;\n                    float x_25342 = x_25336 * y_25341;\n                    float A1_25343 = x_25342 / x_25337;\n                    float y_25344 = fpow32(B_25334, 2.0F);\n                    float x_25345 = x_25339 * y_25344;\n                    float y_25346 = 4.0F * a_24729;\n                    float A2_25347 = x_25345 / y_25346;\n                    float exp_arg_25348 = A1_25343 - A2_25347;\n                    float res_25349 = fpow32(2.7182817F, exp_arg_25348);\n                    float nega",
                   "te_arg_25350 = lifted_0_get_arg_25296 * B_25334;\n                    float exp_arg_25351 = 0.0F - negate_arg_25350;\n                    float res_25352 = fpow32(2.7182817F, exp_arg_25351);\n                    float res_25353 = res_25349 * res_25352;\n                    float res_25354 = res_25325 * res_25353;\n                    \n                    res_25308 = res_25354;\n                }\n                // write to-scan values to parameters\n                {\n                    x_25277 = x_25285;\n                    x_25278 = res_25308;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_26777, res_25191)) {\n                    x_25277 = 0;\n                    x_25278 = 0.0F;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_25279 = x_25275 || x_25277;\n                float res_25280;\n                \n                if (x_25277) {\n                    res_25280 = x_25278;\n                } else {\n                    float res_25281 = x_25276 + x_25278;\n                    \n                    res_25280 = res_25281;\n                }\n                ((__local\n                  bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)] =\n                    res_25279;\n                ((__local\n                  float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)] =\n                    res_25280;\n            }\n            \n          error_0:\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_failure)\n                return;\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_29031;\n            float x_29032;\n            bool x_29033;\n            float x_29034;\n            bool x_29038;\n          ",
                   "  float x_29039;\n            bool x_29040;\n            float x_29041;\n            bool ltid_in_bounds_29045;\n            \n            ltid_in_bounds_29045 = slt64(sext_i32_i64(local_tid_29020),\n                                         segscan_group_sizze_26773);\n            \n            int32_t skip_threads_29046;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_29045) {\n                    x_29033 = ((volatile __local\n                                bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)];\n                    x_29034 = ((volatile __local\n                                float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)];\n                    if ((local_tid_29020 - squot32(local_tid_29020, 32) * 32) ==\n                        0) {\n                        x_29031 = x_29033;\n                        x_29032 = x_29034;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29046 = 1;\n                while (slt32(skip_threads_29046, 32)) {\n                    if (sle32(skip_threads_29046, local_tid_29020 -\n                              squot32(local_tid_29020, 32) * 32) &&\n                        ltid_in_bounds_29045) {\n                        // read operands\n                        {\n                            x_29031 = ((volatile __local\n                                        bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020) -\n                                                                    sext_i32_i64(skip_threads_29046)];\n                            x_29032 = ((volatile __local\n                                        float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020) -\n                                                                     sext_i32_i64(skip_threads_29046)];\n                        }\n                        // perform operation\n                      ",
                   "  {\n                            bool res_29035 = x_29031 || x_29033;\n                            float res_29036;\n                            \n                            if (x_29033) {\n                                res_29036 = x_29034;\n                            } else {\n                                float res_29037 = x_29032 + x_29034;\n                                \n                                res_29036 = res_29037;\n                            }\n                            x_29031 = res_29035;\n                            x_29032 = res_29036;\n                        }\n                    }\n                    if (sle32(wave_sizze_29022, skip_threads_29046)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29046, local_tid_29020 -\n                              squot32(local_tid_29020, 32) * 32) &&\n                        ltid_in_bounds_29045) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)] =\n                                x_29031;\n                            x_29033 = x_29031;\n                            ((volatile __local\n                              float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)] =\n                                x_29032;\n                            x_29034 = x_29032;\n                        }\n                    }\n                    if (sle32(wave_sizze_29022, skip_threads_29046)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29046 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_29020 - squot32(local_tid_29020, 32) * 32) ==\n                    31 && ltid_in_bounds_29045) {\n              ",
                   "      ((volatile __local\n                      bool *) scan_arr_mem_29024)[sext_i32_i64(squot32(local_tid_29020,\n                                                                       32))] =\n                        x_29031;\n                    ((volatile __local\n                      float *) scan_arr_mem_29026)[sext_i32_i64(squot32(local_tid_29020,\n                                                                        32))] =\n                        x_29032;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_29047;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_29020, 32) == 0 &&\n                        ltid_in_bounds_29045) {\n                        x_29040 = ((volatile __local\n                                    bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)];\n                        x_29041 = ((volatile __local\n                                    float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)];\n                        if ((local_tid_29020 - squot32(local_tid_29020, 32) *\n                             32) == 0) {\n                            x_29038 = x_29040;\n                            x_29039 = x_29041;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29047 = 1;\n                    while (slt32(skip_threads_29047, 32)) {\n                        if (sle32(skip_threads_29047, local_tid_29020 -\n                                  squot32(local_tid_29020, 32) * 32) &&\n                            (squot32(local_tid_29020, 32) == 0 &&\n                             ltid_in_bounds_29045)) {\n                            // read operands\n                            {\n             ",
                   "                   x_29038 = ((volatile __local\n                                            bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020) -\n                                                                        sext_i32_i64(skip_threads_29047)];\n                                x_29039 = ((volatile __local\n                                            float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020) -\n                                                                         sext_i32_i64(skip_threads_29047)];\n                            }\n                            // perform operation\n                            {\n                                bool res_29042 = x_29038 || x_29040;\n                                float res_29043;\n                                \n                                if (x_29040) {\n                                    res_29043 = x_29041;\n                                } else {\n                                    float res_29044 = x_29039 + x_29041;\n                                    \n                                    res_29043 = res_29044;\n                                }\n                                x_29038 = res_29042;\n                                x_29039 = res_29043;\n                            }\n                        }\n                        if (sle32(wave_sizze_29022, skip_threads_29047)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29047, local_tid_29020 -\n                                  squot32(local_tid_29020, 32) * 32) &&\n                            (squot32(local_tid_29020, 32) == 0 &&\n                             ltid_in_bounds_29045)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)] =\n                                    x_29038;\n         ",
                   "                       x_29040 = x_29038;\n                                ((volatile __local\n                                  float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)] =\n                                    x_29039;\n                                x_29041 = x_29039;\n                            }\n                        }\n                        if (sle32(wave_sizze_29022, skip_threads_29047)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29047 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_29020, 32) == 0 ||\n                      !ltid_in_bounds_29045)) {\n                    // read operands\n                    {\n                        x_29033 = x_29031;\n                        x_29034 = x_29032;\n                        x_29031 = ((__local\n                                    bool *) scan_arr_mem_29024)[sext_i32_i64(squot32(local_tid_29020,\n                                                                                     32)) -\n                                                                1];\n                        x_29032 = ((__local\n                                    float *) scan_arr_mem_29026)[sext_i32_i64(squot32(local_tid_29020,\n                                                                                      32)) -\n                                                                 1];\n                    }\n                    // perform operation\n                    {\n                        bool res_29035 = x_29031 || x_29033;\n                        float res_29036;\n                        \n                        if (x_29033) {\n                            res_29036 = x_29034;\n                        } else {\n                            float res_29037 = x_29032 + x_29034;\n                   ",
                   "         \n                            res_29036 = res_29037;\n                        }\n                        x_29031 = res_29035;\n                        x_29032 = res_29036;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)] =\n                            x_29031;\n                        ((__local\n                          float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)] =\n                            x_29032;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_29020, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)] =\n                        x_29033;\n                    ((__local\n                      float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)] =\n                        x_29034;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_26777, res_25191)) {\n                    ((__global bool *) mem_28299)[gtid_26777] = ((__local\n                                                                  bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)];\n                    ((__global float *) mem_28301)[gtid_26777] = ((__local\n                                                                   float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_29048 = 0;\n                bool should_load_carry_29049 = local_tid_29020 == 0 &&\n                   ",
                   "  !crosses_segment_29048;\n                \n                if (should_load_carry_29049) {\n                    x_25275 = ((__local\n                                bool *) scan_arr_mem_29024)[segscan_group_sizze_26773 -\n                                                            1];\n                    x_25276 = ((__local\n                                float *) scan_arr_mem_29026)[segscan_group_sizze_26773 -\n                                                             1];\n                }\n                if (!should_load_carry_29049) {\n                    x_25275 = 0;\n                    x_25276 = 0.0F;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_26773\n}\n__kernel void mainziscan_stage1_26830(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29091_backing_aligned_0,\n                                      int64_t res_25191, __global\n                                      unsigned char *mem_28296, __global\n                                      unsigned char *mem_28304,\n                                      int32_t num_threads_29085)\n{\n    #define segscan_group_sizze_26825 (mainzisegscan_group_sizze_26824)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29091_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29091_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29086;\n    int32_t local_tid_29087;\n    int64_t group_sizze_29090;\n    int32_t wave_sizze_29089;\n    int32_t group_tid_29088;\n    \n    global_tid_29086 = get_global_id(0);\n    local_tid_29087 = get_local_id(0);\n    group_sizze_29090 = get_local_size(0);\n    wave_sizze_29089 = LOCKSTEP_WIDTH;\n    group_tid_29088 = get_group",
                   "_id(0);\n    \n    int32_t phys_tid_26830;\n    \n    phys_tid_26830 = global_tid_29086;\n    \n    __local char *scan_arr_mem_29091;\n    \n    scan_arr_mem_29091 = (__local char *) scan_arr_mem_29091_backing_0;\n    \n    int64_t x_25378;\n    int64_t x_25379;\n    \n    x_25378 = 0;\n    for (int64_t j_29093 = 0; j_29093 < sdiv_up64(res_25191,\n                                                  sext_i32_i64(num_threads_29085));\n         j_29093++) {\n        int64_t chunk_offset_29094 = segscan_group_sizze_26825 * j_29093 +\n                sext_i32_i64(group_tid_29088) * (segscan_group_sizze_26825 *\n                                                 sdiv_up64(res_25191,\n                                                           sext_i32_i64(num_threads_29085)));\n        int64_t flat_idx_29095 = chunk_offset_29094 +\n                sext_i32_i64(local_tid_29087);\n        int64_t gtid_26829 = flat_idx_29095;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_26829, res_25191)) {\n                int64_t i_p_o_28120 = add64(1, gtid_26829);\n                int64_t rot_i_28121 = smod64(i_p_o_28120, res_25191);\n                bool x_25381 = ((__global bool *) mem_28296)[rot_i_28121];\n                int64_t res_25382 = btoi_bool_i64(x_25381);\n                \n                // write to-scan values to parameters\n                {\n                    x_25379 = res_25382;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_26829, res_25191)) {\n                    x_25379 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_25380 = add64(x_25378, x_25379);\n                \n                ((__local\n                  int64_",
                   "t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)] =\n                    res_25380;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_29096;\n            int64_t x_29097;\n            int64_t x_29099;\n            int64_t x_29100;\n            bool ltid_in_bounds_29102;\n            \n            ltid_in_bounds_29102 = slt64(sext_i32_i64(local_tid_29087),\n                                         segscan_group_sizze_26825);\n            \n            int32_t skip_threads_29103;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_29102) {\n                    x_29097 = ((volatile __local\n                                int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)];\n                    if ((local_tid_29087 - squot32(local_tid_29087, 32) * 32) ==\n                        0) {\n                        x_29096 = x_29097;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29103 = 1;\n                while (slt32(skip_threads_29103, 32)) {\n                    if (sle32(skip_threads_29103, local_tid_29087 -\n                              squot32(local_tid_29087, 32) * 32) &&\n                        ltid_in_bounds_29102) {\n                        // read operands\n                        {\n                            x_29096 = ((volatile __local\n                                        int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087) -\n                                                                       sext_i32_i64(skip_threads_29103)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_29098 = add64(x_29096, x_29097);\n                            \n                            x_29096 = res_29098;\n                        }\n                    }\n                    if (sle32(w",
                   "ave_sizze_29089, skip_threads_29103)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29103, local_tid_29087 -\n                              squot32(local_tid_29087, 32) * 32) &&\n                        ltid_in_bounds_29102) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)] =\n                                x_29096;\n                            x_29097 = x_29096;\n                        }\n                    }\n                    if (sle32(wave_sizze_29089, skip_threads_29103)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29103 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_29087 - squot32(local_tid_29087, 32) * 32) ==\n                    31 && ltid_in_bounds_29102) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29091)[sext_i32_i64(squot32(local_tid_29087,\n                                                                          32))] =\n                        x_29096;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_29104;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_29087, 32) == 0 &&\n                        ltid_in_bounds_29102) {\n                        x_29100 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)];\n                        if ((local_tid_29087 - squot32(local_ti",
                   "d_29087, 32) *\n                             32) == 0) {\n                            x_29099 = x_29100;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29104 = 1;\n                    while (slt32(skip_threads_29104, 32)) {\n                        if (sle32(skip_threads_29104, local_tid_29087 -\n                                  squot32(local_tid_29087, 32) * 32) &&\n                            (squot32(local_tid_29087, 32) == 0 &&\n                             ltid_in_bounds_29102)) {\n                            // read operands\n                            {\n                                x_29099 = ((volatile __local\n                                            int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087) -\n                                                                           sext_i32_i64(skip_threads_29104)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_29101 = add64(x_29099, x_29100);\n                                \n                                x_29099 = res_29101;\n                            }\n                        }\n                        if (sle32(wave_sizze_29089, skip_threads_29104)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29104, local_tid_29087 -\n                                  squot32(local_tid_29087, 32) * 32) &&\n                            (squot32(local_tid_29087, 32) == 0 &&\n                             ltid_in_bounds_29102)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)] =\n                                    x_29099;\n         ",
                   "                       x_29100 = x_29099;\n                            }\n                        }\n                        if (sle32(wave_sizze_29089, skip_threads_29104)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29104 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_29087, 32) == 0 ||\n                      !ltid_in_bounds_29102)) {\n                    // read operands\n                    {\n                        x_29097 = x_29096;\n                        x_29096 = ((__local\n                                    int64_t *) scan_arr_mem_29091)[sext_i32_i64(squot32(local_tid_29087,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_29098 = add64(x_29096, x_29097);\n                        \n                        x_29096 = res_29098;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)] =\n                            x_29096;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_29087, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)] =\n                        x_29097;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n               ",
                   " if (slt64(gtid_26829, res_25191)) {\n                    ((__global int64_t *) mem_28304)[gtid_26829] = ((__local\n                                                                     int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_29105 = 0;\n                bool should_load_carry_29106 = local_tid_29087 == 0 &&\n                     !crosses_segment_29105;\n                \n                if (should_load_carry_29106) {\n                    x_25378 = ((__local\n                                int64_t *) scan_arr_mem_29091)[segscan_group_sizze_26825 -\n                                                               1];\n                }\n                if (!should_load_carry_29106) {\n                    x_25378 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_26825\n}\n__kernel void mainziscan_stage2_26729(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28674_backing_aligned_0,\n                                      int64_t flat_dim_24906, __global\n                                      unsigned char *mem_28276,\n                                      int64_t stage1_num_groups_28646,\n                                      int32_t num_threads_28647)\n{\n    #define segscan_group_sizze_26724 (mainzisegscan_group_sizze_26723)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28674_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28674_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global",
                   "_tid_28669;\n    int32_t local_tid_28670;\n    int64_t group_sizze_28673;\n    int32_t wave_sizze_28672;\n    int32_t group_tid_28671;\n    \n    global_tid_28669 = get_global_id(0);\n    local_tid_28670 = get_local_id(0);\n    group_sizze_28673 = get_local_size(0);\n    wave_sizze_28672 = LOCKSTEP_WIDTH;\n    group_tid_28671 = get_group_id(0);\n    \n    int32_t phys_tid_26729;\n    \n    phys_tid_26729 = global_tid_28669;\n    \n    __local char *scan_arr_mem_28674;\n    \n    scan_arr_mem_28674 = (__local char *) scan_arr_mem_28674_backing_0;\n    \n    int64_t flat_idx_28676;\n    \n    flat_idx_28676 = (sext_i32_i64(local_tid_28670) + 1) *\n        (segscan_group_sizze_26724 * sdiv_up64(flat_dim_24906,\n                                               sext_i32_i64(num_threads_28647))) -\n        1;\n    \n    int64_t gtid_26728;\n    \n    gtid_26728 = flat_idx_28676;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_26728, flat_dim_24906)) {\n            ((__local\n              int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)] =\n                ((__global int64_t *) mem_28276)[gtid_26728];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_25177;\n    int64_t x_25178;\n    int64_t x_28677;\n    int64_t x_28678;\n    bool ltid_in_bounds_28680;\n    \n    ltid_in_bounds_28680 = slt64(sext_i32_i64(local_tid_28670),\n                                 stage1_num_groups_28646);\n    \n    int32_t skip_threads_28681;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28680) {\n            x_25178 = ((volatile __local\n                        int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)];\n            if ((local_tid_28670 - squot32(local_tid_28670, 32) * 32) == 0) {\n                x_25177 = x_25178;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n  ",
                   "  {\n        skip_threads_28681 = 1;\n        while (slt32(skip_threads_28681, 32)) {\n            if (sle32(skip_threads_28681, local_tid_28670 -\n                      squot32(local_tid_28670, 32) * 32) &&\n                ltid_in_bounds_28680) {\n                // read operands\n                {\n                    x_25177 = ((volatile __local\n                                int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670) -\n                                                               sext_i32_i64(skip_threads_28681)];\n                }\n                // perform operation\n                {\n                    int64_t res_25179 = add64(x_25177, x_25178);\n                    \n                    x_25177 = res_25179;\n                }\n            }\n            if (sle32(wave_sizze_28672, skip_threads_28681)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28681, local_tid_28670 -\n                      squot32(local_tid_28670, 32) * 32) &&\n                ltid_in_bounds_28680) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)] =\n                        x_25177;\n                    x_25178 = x_25177;\n                }\n            }\n            if (sle32(wave_sizze_28672, skip_threads_28681)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28681 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28670 - squot32(local_tid_28670, 32) * 32) == 31 &&\n            ltid_in_bounds_28680) {\n            ((volatile __local\n              int64_t *) scan_arr_mem_28674)[sext_i32_i64(squot32(local_tid_28670,\n                                                                  32))] =\n                x_25177;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the",
                   " first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28682;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28670, 32) == 0 && ltid_in_bounds_28680) {\n                x_28678 = ((volatile __local\n                            int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)];\n                if ((local_tid_28670 - squot32(local_tid_28670, 32) * 32) ==\n                    0) {\n                    x_28677 = x_28678;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28682 = 1;\n            while (slt32(skip_threads_28682, 32)) {\n                if (sle32(skip_threads_28682, local_tid_28670 -\n                          squot32(local_tid_28670, 32) * 32) &&\n                    (squot32(local_tid_28670, 32) == 0 &&\n                     ltid_in_bounds_28680)) {\n                    // read operands\n                    {\n                        x_28677 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670) -\n                                                                   sext_i32_i64(skip_threads_28682)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28679 = add64(x_28677, x_28678);\n                        \n                        x_28677 = res_28679;\n                    }\n                }\n                if (sle32(wave_sizze_28672, skip_threads_28682)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28682, local_tid_28670 -\n                          squot32(local_tid_28670, 32) * 32) &&\n                    (squot32(local_tid_28670, 32) == 0 &&\n                     ltid_in_bounds_28680)) {\n                    // write result\n                    {\n                        ((volatile __local\n ",
                   "                         int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)] =\n                            x_28677;\n                        x_28678 = x_28677;\n                    }\n                }\n                if (sle32(wave_sizze_28672, skip_threads_28682)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28682 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28670, 32) == 0 || !ltid_in_bounds_28680)) {\n            // read operands\n            {\n                x_25178 = x_25177;\n                x_25177 = ((__local\n                            int64_t *) scan_arr_mem_28674)[sext_i32_i64(squot32(local_tid_28670,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_25179 = add64(x_25177, x_25178);\n                \n                x_25177 = res_25179;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)] =\n                    x_25177;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28670, 32) == 0) {\n            ((__local\n              int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)] =\n                x_25178;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_26728, flat_dim_24906)) {\n            ((__global int64_t *) mem_28276)[gtid_26728] = ((__local\n                                                             int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)];\n        }\n    }\n    \n  error_0:\n    return;\n    ",
                   "#undef segscan_group_sizze_26724\n}\n__kernel void mainziscan_stage2_26762(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28923_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28921_backing_aligned_1,\n                                      int64_t res_25191, __global\n                                      unsigned char *mem_28287, __global\n                                      unsigned char *mem_28289,\n                                      int64_t stage1_num_groups_28883,\n                                      int32_t num_threads_28884)\n{\n    #define segscan_group_sizze_26757 (mainzisegscan_group_sizze_26756)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28923_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28923_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28921_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28921_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28916;\n    int32_t local_tid_28917;\n    int64_t group_sizze_28920;\n    int32_t wave_sizze_28919;\n    int32_t group_tid_28918;\n    \n    global_tid_28916 = get_global_id(0);\n    local_tid_28917 = get_local_id(0);\n    group_sizze_28920 = get_local_size(0);\n    wave_sizze_28919 = LOCKSTEP_WIDTH;\n    group_tid_28918 = get_group_id(0);\n    \n    int32_t phys_tid_26762;\n    \n    phys_tid_26762 = global_tid_28916;\n    \n    __local char *scan_arr_mem_28921;\n    __local char *scan_arr_mem_28923;\n    \n    scan_arr_mem_28921 = (__local char *) scan_arr_mem_28921_backing_0;\n    scan_arr_mem_28923 = (__local char *) scan_arr_mem_28923_backing_1;\n    \n    int64_t flat_i",
                   "dx_28925;\n    \n    flat_idx_28925 = (sext_i32_i64(local_tid_28917) + 1) *\n        (segscan_group_sizze_26757 * sdiv_up64(res_25191,\n                                               sext_i32_i64(num_threads_28884))) -\n        1;\n    \n    int64_t gtid_26761;\n    \n    gtid_26761 = flat_idx_28925;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_26761, res_25191)) {\n            ((__local\n              bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)] =\n                ((__global bool *) mem_28287)[gtid_26761];\n            ((__local\n              int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)] =\n                ((__global int64_t *) mem_28289)[gtid_26761];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_25210;\n    int64_t x_25211;\n    bool x_25212;\n    int64_t x_25213;\n    bool x_28926;\n    int64_t x_28927;\n    bool x_28928;\n    int64_t x_28929;\n    bool ltid_in_bounds_28933;\n    \n    ltid_in_bounds_28933 = slt64(sext_i32_i64(local_tid_28917),\n                                 stage1_num_groups_28883);\n    \n    int32_t skip_threads_28934;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28933) {\n            x_25212 = ((volatile __local\n                        bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)];\n            x_25213 = ((volatile __local\n                        int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)];\n            if ((local_tid_28917 - squot32(local_tid_28917, 32) * 32) == 0) {\n                x_25210 = x_25212;\n                x_25211 = x_25213;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28934 = 1;\n        while (slt32(skip_threads_28934, 32",
                   ")) {\n            if (sle32(skip_threads_28934, local_tid_28917 -\n                      squot32(local_tid_28917, 32) * 32) &&\n                ltid_in_bounds_28933) {\n                // read operands\n                {\n                    x_25210 = ((volatile __local\n                                bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917) -\n                                                            sext_i32_i64(skip_threads_28934)];\n                    x_25211 = ((volatile __local\n                                int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917) -\n                                                               sext_i32_i64(skip_threads_28934)];\n                }\n                // perform operation\n                {\n                    bool res_25214 = x_25210 || x_25212;\n                    int64_t res_25215;\n                    \n                    if (x_25212) {\n                        res_25215 = x_25213;\n                    } else {\n                        int64_t res_25216 = add64(x_25211, x_25213);\n                        \n                        res_25215 = res_25216;\n                    }\n                    x_25210 = res_25214;\n                    x_25211 = res_25215;\n                }\n            }\n            if (sle32(wave_sizze_28919, skip_threads_28934)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28934, local_tid_28917 -\n                      squot32(local_tid_28917, 32) * 32) &&\n                ltid_in_bounds_28933) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)] =\n                        x_25210;\n                    x_25212 = x_25210;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)] =\n                        x_25211;\n                    x_25213 = x_25211;\n      ",
                   "          }\n            }\n            if (sle32(wave_sizze_28919, skip_threads_28934)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28934 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28917 - squot32(local_tid_28917, 32) * 32) == 31 &&\n            ltid_in_bounds_28933) {\n            ((volatile __local\n              bool *) scan_arr_mem_28921)[sext_i32_i64(squot32(local_tid_28917,\n                                                               32))] = x_25210;\n            ((volatile __local\n              int64_t *) scan_arr_mem_28923)[sext_i32_i64(squot32(local_tid_28917,\n                                                                  32))] =\n                x_25211;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28935;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28917, 32) == 0 && ltid_in_bounds_28933) {\n                x_28928 = ((volatile __local\n                            bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)];\n                x_28929 = ((volatile __local\n                            int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)];\n                if ((local_tid_28917 - squot32(local_tid_28917, 32) * 32) ==\n                    0) {\n                    x_28926 = x_28928;\n                    x_28927 = x_28929;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28935 = 1;\n            while (slt32(skip_threads_28935, 32)) {\n                if (sle32(skip_threads_28935, local_tid_28917 -\n                          squot32(local_tid_28917, 32) * 32) &&\n                    (squot32(local_tid_28917, 32) == 0 &&\n                     ltid_in_bound",
                   "s_28933)) {\n                    // read operands\n                    {\n                        x_28926 = ((volatile __local\n                                    bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917) -\n                                                                sext_i32_i64(skip_threads_28935)];\n                        x_28927 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917) -\n                                                                   sext_i32_i64(skip_threads_28935)];\n                    }\n                    // perform operation\n                    {\n                        bool res_28930 = x_28926 || x_28928;\n                        int64_t res_28931;\n                        \n                        if (x_28928) {\n                            res_28931 = x_28929;\n                        } else {\n                            int64_t res_28932 = add64(x_28927, x_28929);\n                            \n                            res_28931 = res_28932;\n                        }\n                        x_28926 = res_28930;\n                        x_28927 = res_28931;\n                    }\n                }\n                if (sle32(wave_sizze_28919, skip_threads_28935)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28935, local_tid_28917 -\n                          squot32(local_tid_28917, 32) * 32) &&\n                    (squot32(local_tid_28917, 32) == 0 &&\n                     ltid_in_bounds_28933)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)] =\n                            x_28926;\n                        x_28928 = x_28926;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)] =\n               ",
                   "             x_28927;\n                        x_28929 = x_28927;\n                    }\n                }\n                if (sle32(wave_sizze_28919, skip_threads_28935)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28935 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28917, 32) == 0 || !ltid_in_bounds_28933)) {\n            // read operands\n            {\n                x_25212 = x_25210;\n                x_25213 = x_25211;\n                x_25210 = ((__local\n                            bool *) scan_arr_mem_28921)[sext_i32_i64(squot32(local_tid_28917,\n                                                                             32)) -\n                                                        1];\n                x_25211 = ((__local\n                            int64_t *) scan_arr_mem_28923)[sext_i32_i64(squot32(local_tid_28917,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_25214 = x_25210 || x_25212;\n                int64_t res_25215;\n                \n                if (x_25212) {\n                    res_25215 = x_25213;\n                } else {\n                    int64_t res_25216 = add64(x_25211, x_25213);\n                    \n                    res_25215 = res_25216;\n                }\n                x_25210 = res_25214;\n                x_25211 = res_25215;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)] =\n                    x_25210;\n                ((__local\n                  int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)] =\n                    x_25211;\n            }\n        }\n    }\n    ba",
                   "rrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28917, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)] =\n                x_25212;\n            ((__local\n              int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)] =\n                x_25213;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_26761, res_25191)) {\n            ((__global bool *) mem_28287)[gtid_26761] = ((__local\n                                                          bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)];\n            ((__global int64_t *) mem_28289)[gtid_26761] = ((__local\n                                                             int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26757\n}\n__kernel void mainziscan_stage2_26770(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28990_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28988_backing_aligned_1,\n                                      int64_t res_25191, __global\n                                      unsigned char *mem_28292, __global\n                                      unsigned char *mem_28294,\n                                      int64_t stage1_num_groups_28950,\n                                      int32_t num_threads_28951)\n{\n    #define segscan_group_sizze_26765 (mainzisegscan_group_sizze_26764)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28990_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28",
                   "990_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28988_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28988_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28983;\n    int32_t local_tid_28984;\n    int64_t group_sizze_28987;\n    int32_t wave_sizze_28986;\n    int32_t group_tid_28985;\n    \n    global_tid_28983 = get_global_id(0);\n    local_tid_28984 = get_local_id(0);\n    group_sizze_28987 = get_local_size(0);\n    wave_sizze_28986 = LOCKSTEP_WIDTH;\n    group_tid_28985 = get_group_id(0);\n    \n    int32_t phys_tid_26770;\n    \n    phys_tid_26770 = global_tid_28983;\n    \n    __local char *scan_arr_mem_28988;\n    __local char *scan_arr_mem_28990;\n    \n    scan_arr_mem_28988 = (__local char *) scan_arr_mem_28988_backing_0;\n    scan_arr_mem_28990 = (__local char *) scan_arr_mem_28990_backing_1;\n    \n    int64_t flat_idx_28992;\n    \n    flat_idx_28992 = (sext_i32_i64(local_tid_28984) + 1) *\n        (segscan_group_sizze_26765 * sdiv_up64(res_25191,\n                                               sext_i32_i64(num_threads_28951))) -\n        1;\n    \n    int64_t gtid_26769;\n    \n    gtid_26769 = flat_idx_28992;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_26769, res_25191)) {\n            ((__local\n              bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)] =\n                ((__global bool *) mem_28292)[gtid_26769];\n            ((__local\n              int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)] =\n                ((__global int64_t *) mem_28294)[gtid_26769];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_25249;\n    int64_t x_25250;\n    bool x_2",
                   "5251;\n    int64_t x_25252;\n    bool x_28993;\n    int64_t x_28994;\n    bool x_28995;\n    int64_t x_28996;\n    bool ltid_in_bounds_29000;\n    \n    ltid_in_bounds_29000 = slt64(sext_i32_i64(local_tid_28984),\n                                 stage1_num_groups_28950);\n    \n    int32_t skip_threads_29001;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29000) {\n            x_25251 = ((volatile __local\n                        bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)];\n            x_25252 = ((volatile __local\n                        int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)];\n            if ((local_tid_28984 - squot32(local_tid_28984, 32) * 32) == 0) {\n                x_25249 = x_25251;\n                x_25250 = x_25252;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_29001 = 1;\n        while (slt32(skip_threads_29001, 32)) {\n            if (sle32(skip_threads_29001, local_tid_28984 -\n                      squot32(local_tid_28984, 32) * 32) &&\n                ltid_in_bounds_29000) {\n                // read operands\n                {\n                    x_25249 = ((volatile __local\n                                bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984) -\n                                                            sext_i32_i64(skip_threads_29001)];\n                    x_25250 = ((volatile __local\n                                int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984) -\n                                                               sext_i32_i64(skip_threads_29001)];\n                }\n                // perform operation\n                {\n                    bool res_25253 = x_25249 || x_25251;\n                    int64_t res_25254;\n                    \n                    if (x_25251) {\n                        res_25254 = x_25252;\n                    } else {\n                        int64_t res_25255 = add64(x_25250, ",
                   "x_25252);\n                        \n                        res_25254 = res_25255;\n                    }\n                    x_25249 = res_25253;\n                    x_25250 = res_25254;\n                }\n            }\n            if (sle32(wave_sizze_28986, skip_threads_29001)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29001, local_tid_28984 -\n                      squot32(local_tid_28984, 32) * 32) &&\n                ltid_in_bounds_29000) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)] =\n                        x_25249;\n                    x_25251 = x_25249;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)] =\n                        x_25250;\n                    x_25252 = x_25250;\n                }\n            }\n            if (sle32(wave_sizze_28986, skip_threads_29001)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_29001 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28984 - squot32(local_tid_28984, 32) * 32) == 31 &&\n            ltid_in_bounds_29000) {\n            ((volatile __local\n              bool *) scan_arr_mem_28988)[sext_i32_i64(squot32(local_tid_28984,\n                                                               32))] = x_25249;\n            ((volatile __local\n              int64_t *) scan_arr_mem_28990)[sext_i32_i64(squot32(local_tid_28984,\n                                                                  32))] =\n                x_25250;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29002;\n        \n        // read input for in-block scan\n    ",
                   "    {\n            if (squot32(local_tid_28984, 32) == 0 && ltid_in_bounds_29000) {\n                x_28995 = ((volatile __local\n                            bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)];\n                x_28996 = ((volatile __local\n                            int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)];\n                if ((local_tid_28984 - squot32(local_tid_28984, 32) * 32) ==\n                    0) {\n                    x_28993 = x_28995;\n                    x_28994 = x_28996;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29002 = 1;\n            while (slt32(skip_threads_29002, 32)) {\n                if (sle32(skip_threads_29002, local_tid_28984 -\n                          squot32(local_tid_28984, 32) * 32) &&\n                    (squot32(local_tid_28984, 32) == 0 &&\n                     ltid_in_bounds_29000)) {\n                    // read operands\n                    {\n                        x_28993 = ((volatile __local\n                                    bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984) -\n                                                                sext_i32_i64(skip_threads_29002)];\n                        x_28994 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984) -\n                                                                   sext_i32_i64(skip_threads_29002)];\n                    }\n                    // perform operation\n                    {\n                        bool res_28997 = x_28993 || x_28995;\n                        int64_t res_28998;\n                        \n                        if (x_28995) {\n                            res_28998 = x_28996;\n                        } else {\n                            int64_t res_28999 = add64(x_28994, x_28996);\n                            \n                            res_28998 = re",
                   "s_28999;\n                        }\n                        x_28993 = res_28997;\n                        x_28994 = res_28998;\n                    }\n                }\n                if (sle32(wave_sizze_28986, skip_threads_29002)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29002, local_tid_28984 -\n                          squot32(local_tid_28984, 32) * 32) &&\n                    (squot32(local_tid_28984, 32) == 0 &&\n                     ltid_in_bounds_29000)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)] =\n                            x_28993;\n                        x_28995 = x_28993;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)] =\n                            x_28994;\n                        x_28996 = x_28994;\n                    }\n                }\n                if (sle32(wave_sizze_28986, skip_threads_29002)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29002 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28984, 32) == 0 || !ltid_in_bounds_29000)) {\n            // read operands\n            {\n                x_25251 = x_25249;\n                x_25252 = x_25250;\n                x_25249 = ((__local\n                            bool *) scan_arr_mem_28988)[sext_i32_i64(squot32(local_tid_28984,\n                                                                             32)) -\n                                                        1];\n                x_25250 = ((__local\n                            int64_t *) scan_arr_mem_28990)[sext_i32_i64(squot32(local_tid_28984,\n                                                       ",
                   "                         32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_25253 = x_25249 || x_25251;\n                int64_t res_25254;\n                \n                if (x_25251) {\n                    res_25254 = x_25252;\n                } else {\n                    int64_t res_25255 = add64(x_25250, x_25252);\n                    \n                    res_25254 = res_25255;\n                }\n                x_25249 = res_25253;\n                x_25250 = res_25254;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)] =\n                    x_25249;\n                ((__local\n                  int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)] =\n                    x_25250;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28984, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)] =\n                x_25251;\n            ((__local\n              int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)] =\n                x_25252;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_26769, res_25191)) {\n            ((__global bool *) mem_28292)[gtid_26769] = ((__local\n                                                          bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)];\n            ((__global int64_t *) mem_28294)[gtid_26769] = ((__local\n                                                             int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26765\n}\n__kernel void mainziscan_stage2_26778(__global int *global_failure,\n ",
                   "                                     __local volatile\n                                      int64_t *scan_arr_mem_29057_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29055_backing_aligned_1,\n                                      int64_t res_25191, __global\n                                      unsigned char *mem_28299, __global\n                                      unsigned char *mem_28301,\n                                      int64_t stage1_num_groups_29017,\n                                      int32_t num_threads_29018)\n{\n    #define segscan_group_sizze_26773 (mainzisegscan_group_sizze_26772)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29057_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_29057_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29055_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29055_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29050;\n    int32_t local_tid_29051;\n    int64_t group_sizze_29054;\n    int32_t wave_sizze_29053;\n    int32_t group_tid_29052;\n    \n    global_tid_29050 = get_global_id(0);\n    local_tid_29051 = get_local_id(0);\n    group_sizze_29054 = get_local_size(0);\n    wave_sizze_29053 = LOCKSTEP_WIDTH;\n    group_tid_29052 = get_group_id(0);\n    \n    int32_t phys_tid_26778;\n    \n    phys_tid_26778 = global_tid_29050;\n    \n    __local char *scan_arr_mem_29055;\n    __local char *scan_arr_mem_29057;\n    \n    scan_arr_mem_29055 = (__local char *) scan_arr_mem_29055_backing_0;\n    scan_arr_mem_29057 = (__local char *) scan_arr_mem_29057_backing_1;\n    \n    int64_t flat_idx_29059;\n    \n    flat_idx_29059 = (sext_i32_i64(local_tid_29051) + 1) *\n        (segscan_group_sizze_2",
                   "6773 * sdiv_up64(res_25191,\n                                               sext_i32_i64(num_threads_29018))) -\n        1;\n    \n    int64_t gtid_26777;\n    \n    gtid_26777 = flat_idx_29059;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_26777, res_25191)) {\n            ((__local\n              bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)] =\n                ((__global bool *) mem_28299)[gtid_26777];\n            ((__local\n              float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)] =\n                ((__global float *) mem_28301)[gtid_26777];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)] = 0;\n            ((__local\n              float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)] =\n                0.0F;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_25275;\n    float x_25276;\n    bool x_25277;\n    float x_25278;\n    bool x_29060;\n    float x_29061;\n    bool x_29062;\n    float x_29063;\n    bool ltid_in_bounds_29067;\n    \n    ltid_in_bounds_29067 = slt64(sext_i32_i64(local_tid_29051),\n                                 stage1_num_groups_29017);\n    \n    int32_t skip_threads_29068;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29067) {\n            x_25277 = ((volatile __local\n                        bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)];\n            x_25278 = ((volatile __local\n                        float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)];\n            if ((local_tid_29051 - squot32(local_tid_29051, 32) * 32) == 0) {\n                x_25275 = x_25277;\n                x_25276 = x_25278;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_29068 = 1;\n        while (slt32(skip_threads_29068, 32)) {\n            if (sle32(skip_threads_29068, local_tid_29051 -\n                      squot32(local_",
                   "tid_29051, 32) * 32) &&\n                ltid_in_bounds_29067) {\n                // read operands\n                {\n                    x_25275 = ((volatile __local\n                                bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051) -\n                                                            sext_i32_i64(skip_threads_29068)];\n                    x_25276 = ((volatile __local\n                                float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051) -\n                                                             sext_i32_i64(skip_threads_29068)];\n                }\n                // perform operation\n                {\n                    bool res_25279 = x_25275 || x_25277;\n                    float res_25280;\n                    \n                    if (x_25277) {\n                        res_25280 = x_25278;\n                    } else {\n                        float res_25281 = x_25276 + x_25278;\n                        \n                        res_25280 = res_25281;\n                    }\n                    x_25275 = res_25279;\n                    x_25276 = res_25280;\n                }\n            }\n            if (sle32(wave_sizze_29053, skip_threads_29068)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29068, local_tid_29051 -\n                      squot32(local_tid_29051, 32) * 32) &&\n                ltid_in_bounds_29067) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)] =\n                        x_25275;\n                    x_25277 = x_25275;\n                    ((volatile __local\n                      float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)] =\n                        x_25276;\n                    x_25278 = x_25276;\n                }\n            }\n            if (sle32(wave_sizze_29053, skip_threads_29068)) {\n                barrier(CLK_",
                   "LOCAL_MEM_FENCE);\n            }\n            skip_threads_29068 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_29051 - squot32(local_tid_29051, 32) * 32) == 31 &&\n            ltid_in_bounds_29067) {\n            ((volatile __local\n              bool *) scan_arr_mem_29055)[sext_i32_i64(squot32(local_tid_29051,\n                                                               32))] = x_25275;\n            ((volatile __local\n              float *) scan_arr_mem_29057)[sext_i32_i64(squot32(local_tid_29051,\n                                                                32))] = x_25276;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29069;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_29051, 32) == 0 && ltid_in_bounds_29067) {\n                x_29062 = ((volatile __local\n                            bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)];\n                x_29063 = ((volatile __local\n                            float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)];\n                if ((local_tid_29051 - squot32(local_tid_29051, 32) * 32) ==\n                    0) {\n                    x_29060 = x_29062;\n                    x_29061 = x_29063;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29069 = 1;\n            while (slt32(skip_threads_29069, 32)) {\n                if (sle32(skip_threads_29069, local_tid_29051 -\n                          squot32(local_tid_29051, 32) * 32) &&\n                    (squot32(local_tid_29051, 32) == 0 &&\n                     ltid_in_bounds_29067)) {\n                    // read operands\n                    {\n                        x_29060 = ((volatile __local\n               ",
                   "                     bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051) -\n                                                                sext_i32_i64(skip_threads_29069)];\n                        x_29061 = ((volatile __local\n                                    float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051) -\n                                                                 sext_i32_i64(skip_threads_29069)];\n                    }\n                    // perform operation\n                    {\n                        bool res_29064 = x_29060 || x_29062;\n                        float res_29065;\n                        \n                        if (x_29062) {\n                            res_29065 = x_29063;\n                        } else {\n                            float res_29066 = x_29061 + x_29063;\n                            \n                            res_29065 = res_29066;\n                        }\n                        x_29060 = res_29064;\n                        x_29061 = res_29065;\n                    }\n                }\n                if (sle32(wave_sizze_29053, skip_threads_29069)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29069, local_tid_29051 -\n                          squot32(local_tid_29051, 32) * 32) &&\n                    (squot32(local_tid_29051, 32) == 0 &&\n                     ltid_in_bounds_29067)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)] =\n                            x_29060;\n                        x_29062 = x_29060;\n                        ((volatile __local\n                          float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)] =\n                            x_29061;\n                        x_29063 = x_29061;\n                    }\n                }\n                if (sle32(wave_sizze_29053, skip_t",
                   "hreads_29069)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29069 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_29051, 32) == 0 || !ltid_in_bounds_29067)) {\n            // read operands\n            {\n                x_25277 = x_25275;\n                x_25278 = x_25276;\n                x_25275 = ((__local\n                            bool *) scan_arr_mem_29055)[sext_i32_i64(squot32(local_tid_29051,\n                                                                             32)) -\n                                                        1];\n                x_25276 = ((__local\n                            float *) scan_arr_mem_29057)[sext_i32_i64(squot32(local_tid_29051,\n                                                                              32)) -\n                                                         1];\n            }\n            // perform operation\n            {\n                bool res_25279 = x_25275 || x_25277;\n                float res_25280;\n                \n                if (x_25277) {\n                    res_25280 = x_25278;\n                } else {\n                    float res_25281 = x_25276 + x_25278;\n                    \n                    res_25280 = res_25281;\n                }\n                x_25275 = res_25279;\n                x_25276 = res_25280;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)] =\n                    x_25275;\n                ((__local\n                  float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)] =\n                    x_25276;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_29051, 32) == 0) {\n            ((__local\n              bool *) ",
                   "scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)] =\n                x_25277;\n            ((__local\n              float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)] =\n                x_25278;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_26777, res_25191)) {\n            ((__global bool *) mem_28299)[gtid_26777] = ((__local\n                                                          bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)];\n            ((__global float *) mem_28301)[gtid_26777] = ((__local\n                                                           float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26773\n}\n__kernel void mainziscan_stage2_26830(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29112_backing_aligned_0,\n                                      int64_t res_25191, __global\n                                      unsigned char *mem_28304,\n                                      int64_t stage1_num_groups_29084,\n                                      int32_t num_threads_29085)\n{\n    #define segscan_group_sizze_26825 (mainzisegscan_group_sizze_26824)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29112_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29112_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29107;\n    int32_t local_tid_29108;\n    int64_t group_sizze_29111;\n    int32_t wave_sizze_29110;\n    int32_t group_tid_29109;\n    \n    global_tid_29107 = get_global_id(0);\n    local_tid_29108 = get_local_id(0);\n    group_sizze_29111 = get_local_size(0);\n    wave_sizze_29110 = LOCKSTEP_WIDTH;",
                   "\n    group_tid_29109 = get_group_id(0);\n    \n    int32_t phys_tid_26830;\n    \n    phys_tid_26830 = global_tid_29107;\n    \n    __local char *scan_arr_mem_29112;\n    \n    scan_arr_mem_29112 = (__local char *) scan_arr_mem_29112_backing_0;\n    \n    int64_t flat_idx_29114;\n    \n    flat_idx_29114 = (sext_i32_i64(local_tid_29108) + 1) *\n        (segscan_group_sizze_26825 * sdiv_up64(res_25191,\n                                               sext_i32_i64(num_threads_29085))) -\n        1;\n    \n    int64_t gtid_26829;\n    \n    gtid_26829 = flat_idx_29114;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_26829, res_25191)) {\n            ((__local\n              int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)] =\n                ((__global int64_t *) mem_28304)[gtid_26829];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_25378;\n    int64_t x_25379;\n    int64_t x_29115;\n    int64_t x_29116;\n    bool ltid_in_bounds_29118;\n    \n    ltid_in_bounds_29118 = slt64(sext_i32_i64(local_tid_29108),\n                                 stage1_num_groups_29084);\n    \n    int32_t skip_threads_29119;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29118) {\n            x_25379 = ((volatile __local\n                        int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)];\n            if ((local_tid_29108 - squot32(local_tid_29108, 32) * 32) == 0) {\n                x_25378 = x_25379;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_29119 = 1;\n        while (slt32(skip_threads_29119, 32)) {\n            if (sle32(skip_threads_29119, local_tid_29108 -\n                      squot32(local_tid_29108, 32) * 32) &&\n                ltid_in_bounds_29118) {\n                // read operands\n                {\n            ",
                   "        x_25378 = ((volatile __local\n                                int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108) -\n                                                               sext_i32_i64(skip_threads_29119)];\n                }\n                // perform operation\n                {\n                    int64_t res_25380 = add64(x_25378, x_25379);\n                    \n                    x_25378 = res_25380;\n                }\n            }\n            if (sle32(wave_sizze_29110, skip_threads_29119)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29119, local_tid_29108 -\n                      squot32(local_tid_29108, 32) * 32) &&\n                ltid_in_bounds_29118) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)] =\n                        x_25378;\n                    x_25379 = x_25378;\n                }\n            }\n            if (sle32(wave_sizze_29110, skip_threads_29119)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_29119 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_29108 - squot32(local_tid_29108, 32) * 32) == 31 &&\n            ltid_in_bounds_29118) {\n            ((volatile __local\n              int64_t *) scan_arr_mem_29112)[sext_i32_i64(squot32(local_tid_29108,\n                                                                  32))] =\n                x_25378;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29120;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_29108, 32) == 0 && ltid_in_bounds_29118) {\n                x_29116 = ((volatile __local\n             ",
                   "               int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)];\n                if ((local_tid_29108 - squot32(local_tid_29108, 32) * 32) ==\n                    0) {\n                    x_29115 = x_29116;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29120 = 1;\n            while (slt32(skip_threads_29120, 32)) {\n                if (sle32(skip_threads_29120, local_tid_29108 -\n                          squot32(local_tid_29108, 32) * 32) &&\n                    (squot32(local_tid_29108, 32) == 0 &&\n                     ltid_in_bounds_29118)) {\n                    // read operands\n                    {\n                        x_29115 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108) -\n                                                                   sext_i32_i64(skip_threads_29120)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_29117 = add64(x_29115, x_29116);\n                        \n                        x_29115 = res_29117;\n                    }\n                }\n                if (sle32(wave_sizze_29110, skip_threads_29120)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29120, local_tid_29108 -\n                          squot32(local_tid_29108, 32) * 32) &&\n                    (squot32(local_tid_29108, 32) == 0 &&\n                     ltid_in_bounds_29118)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)] =\n                            x_29115;\n                        x_29116 = x_29115;\n                    }\n                }\n                if (sle32(wave_sizze_29110, skip_threads_29120)) {\n                    barrier(CLK",
                   "_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29120 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_29108, 32) == 0 || !ltid_in_bounds_29118)) {\n            // read operands\n            {\n                x_25379 = x_25378;\n                x_25378 = ((__local\n                            int64_t *) scan_arr_mem_29112)[sext_i32_i64(squot32(local_tid_29108,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_25380 = add64(x_25378, x_25379);\n                \n                x_25378 = res_25380;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)] =\n                    x_25378;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_29108, 32) == 0) {\n            ((__local\n              int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)] =\n                x_25379;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_26829, res_25191)) {\n            ((__global int64_t *) mem_28304)[gtid_26829] = ((__local\n                                                             int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26825\n}\n__kernel void mainziscan_stage3_26729(__global int *global_failure,\n                                      int64_t flat_dim_24906,\n                                      int64_t num_groups_26726, __global\n                                      unsigned char *mem_28276,\n          ",
                   "                            int32_t num_threads_28647,\n                                      int32_t required_groups_28683)\n{\n    #define segscan_group_sizze_26724 (mainzisegscan_group_sizze_26723)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28684;\n    int32_t local_tid_28685;\n    int64_t group_sizze_28688;\n    int32_t wave_sizze_28687;\n    int32_t group_tid_28686;\n    \n    global_tid_28684 = get_global_id(0);\n    local_tid_28685 = get_local_id(0);\n    group_sizze_28688 = get_local_size(0);\n    wave_sizze_28687 = LOCKSTEP_WIDTH;\n    group_tid_28686 = get_group_id(0);\n    \n    int32_t phys_tid_26729;\n    \n    phys_tid_26729 = global_tid_28684;\n    \n    int32_t phys_group_id_28689;\n    \n    phys_group_id_28689 = get_group_id(0);\n    for (int32_t i_28690 = 0; i_28690 < sdiv_up32(required_groups_28683 -\n                                                  phys_group_id_28689,\n                                                  sext_i64_i32(num_groups_26726));\n         i_28690++) {\n        int32_t virt_group_id_28691 = phys_group_id_28689 + i_28690 *\n                sext_i64_i32(num_groups_26726);\n        int64_t flat_idx_28692 = sext_i32_i64(virt_group_id_28691) *\n                segscan_group_sizze_26724 + sext_i32_i64(local_tid_28685);\n        int64_t gtid_26728 = flat_idx_28692;\n        int64_t orig_group_28693 = squot64(flat_idx_28692,\n                                           segscan_group_sizze_26724 *\n                                           sdiv_up64(flat_dim_24906,\n                                                     sext_i32_i64(num_threads_28647)));\n        int64_t carry_in_flat_idx_28694 = orig_group_28693 *\n                (segscan_group_sizze_26724 * sdiv_up64(flat_dim_24906,\n                                                       sext_i32_i64(num_threads_28647))) -\n                1;\n        \n        if (slt64(gtid_26728, flat_dim",
                   "_24906)) {\n            if (!(orig_group_28693 == 0 || flat_idx_28692 == (orig_group_28693 +\n                                                              1) *\n                  (segscan_group_sizze_26724 * sdiv_up64(flat_dim_24906,\n                                                         sext_i32_i64(num_threads_28647))) -\n                  1)) {\n                int64_t x_25177;\n                int64_t x_25178;\n                \n                x_25177 = ((__global\n                            int64_t *) mem_28276)[carry_in_flat_idx_28694];\n                x_25178 = ((__global int64_t *) mem_28276)[gtid_26728];\n                \n                int64_t res_25179;\n                \n                res_25179 = add64(x_25177, x_25178);\n                x_25177 = res_25179;\n                ((__global int64_t *) mem_28276)[gtid_26728] = x_25177;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26724\n}\n__kernel void mainziscan_stage3_26762(__global int *global_failure,\n                                      int64_t res_25191,\n                                      int64_t num_groups_26759, __global\n                                      unsigned char *mem_28287, __global\n                                      unsigned char *mem_28289,\n                                      int32_t num_threads_28884,\n                                      int32_t required_groups_28936)\n{\n    #define segscan_group_sizze_26757 (mainzisegscan_group_sizze_26756)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28937;\n    int32_t local_tid_28938;\n    int64_t group_sizze_28941;\n    int32_t wave_sizze_28940;\n    int32_t group_tid_28939;\n    \n    global_tid_28937 = get_global_id(0);\n    local_tid_28938 = get_local_id(0);\n    group_sizze_28941 = get_local_size(0);\n    wave_sizze_28940 = ",
                   "LOCKSTEP_WIDTH;\n    group_tid_28939 = get_group_id(0);\n    \n    int32_t phys_tid_26762;\n    \n    phys_tid_26762 = global_tid_28937;\n    \n    int32_t phys_group_id_28942;\n    \n    phys_group_id_28942 = get_group_id(0);\n    for (int32_t i_28943 = 0; i_28943 < sdiv_up32(required_groups_28936 -\n                                                  phys_group_id_28942,\n                                                  sext_i64_i32(num_groups_26759));\n         i_28943++) {\n        int32_t virt_group_id_28944 = phys_group_id_28942 + i_28943 *\n                sext_i64_i32(num_groups_26759);\n        int64_t flat_idx_28945 = sext_i32_i64(virt_group_id_28944) *\n                segscan_group_sizze_26757 + sext_i32_i64(local_tid_28938);\n        int64_t gtid_26761 = flat_idx_28945;\n        int64_t orig_group_28946 = squot64(flat_idx_28945,\n                                           segscan_group_sizze_26757 *\n                                           sdiv_up64(res_25191,\n                                                     sext_i32_i64(num_threads_28884)));\n        int64_t carry_in_flat_idx_28947 = orig_group_28946 *\n                (segscan_group_sizze_26757 * sdiv_up64(res_25191,\n                                                       sext_i32_i64(num_threads_28884))) -\n                1;\n        \n        if (slt64(gtid_26761, res_25191)) {\n            if (!(orig_group_28946 == 0 || flat_idx_28945 == (orig_group_28946 +\n                                                              1) *\n                  (segscan_group_sizze_26757 * sdiv_up64(res_25191,\n                                                         sext_i32_i64(num_threads_28884))) -\n                  1)) {\n                bool x_25210;\n                int64_t x_25211;\n                bool x_25212;\n                int64_t x_25213;\n                \n                x_25210 = ((__global\n                            bool *) mem_28287)[carry_in_flat_idx_28947];\n                x_25211 = ((__global\n                            in",
                   "t64_t *) mem_28289)[carry_in_flat_idx_28947];\n                x_25212 = ((__global bool *) mem_28287)[gtid_26761];\n                x_25213 = ((__global int64_t *) mem_28289)[gtid_26761];\n                \n                bool res_25214;\n                \n                res_25214 = x_25210 || x_25212;\n                \n                int64_t res_25215;\n                \n                if (x_25212) {\n                    res_25215 = x_25213;\n                } else {\n                    int64_t res_25216 = add64(x_25211, x_25213);\n                    \n                    res_25215 = res_25216;\n                }\n                x_25210 = res_25214;\n                x_25211 = res_25215;\n                ((__global bool *) mem_28287)[gtid_26761] = x_25210;\n                ((__global int64_t *) mem_28289)[gtid_26761] = x_25211;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26757\n}\n__kernel void mainziscan_stage3_26770(__global int *global_failure,\n                                      int64_t res_25191,\n                                      int64_t num_groups_26767, __global\n                                      unsigned char *mem_28292, __global\n                                      unsigned char *mem_28294,\n                                      int32_t num_threads_28951,\n                                      int32_t required_groups_29003)\n{\n    #define segscan_group_sizze_26765 (mainzisegscan_group_sizze_26764)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29004;\n    int32_t local_tid_29005;\n    int64_t group_sizze_29008;\n    int32_t wave_sizze_29007;\n    int32_t group_tid_29006;\n    \n    global_tid_29004 = get_global_id(0);\n    local_tid_29005 = get_local_id(0);\n    group_sizze_29008 = get_local_size(0);\n    wave_sizze_29007 = LOCKSTEP_WIDTH;\n   ",
                   " group_tid_29006 = get_group_id(0);\n    \n    int32_t phys_tid_26770;\n    \n    phys_tid_26770 = global_tid_29004;\n    \n    int32_t phys_group_id_29009;\n    \n    phys_group_id_29009 = get_group_id(0);\n    for (int32_t i_29010 = 0; i_29010 < sdiv_up32(required_groups_29003 -\n                                                  phys_group_id_29009,\n                                                  sext_i64_i32(num_groups_26767));\n         i_29010++) {\n        int32_t virt_group_id_29011 = phys_group_id_29009 + i_29010 *\n                sext_i64_i32(num_groups_26767);\n        int64_t flat_idx_29012 = sext_i32_i64(virt_group_id_29011) *\n                segscan_group_sizze_26765 + sext_i32_i64(local_tid_29005);\n        int64_t gtid_26769 = flat_idx_29012;\n        int64_t orig_group_29013 = squot64(flat_idx_29012,\n                                           segscan_group_sizze_26765 *\n                                           sdiv_up64(res_25191,\n                                                     sext_i32_i64(num_threads_28951)));\n        int64_t carry_in_flat_idx_29014 = orig_group_29013 *\n                (segscan_group_sizze_26765 * sdiv_up64(res_25191,\n                                                       sext_i32_i64(num_threads_28951))) -\n                1;\n        \n        if (slt64(gtid_26769, res_25191)) {\n            if (!(orig_group_29013 == 0 || flat_idx_29012 == (orig_group_29013 +\n                                                              1) *\n                  (segscan_group_sizze_26765 * sdiv_up64(res_25191,\n                                                         sext_i32_i64(num_threads_28951))) -\n                  1)) {\n                bool x_25249;\n                int64_t x_25250;\n                bool x_25251;\n                int64_t x_25252;\n                \n                x_25249 = ((__global\n                            bool *) mem_28292)[carry_in_flat_idx_29014];\n                x_25250 = ((__global\n                            int64_t *) mem_28294)",
                   "[carry_in_flat_idx_29014];\n                x_25251 = ((__global bool *) mem_28292)[gtid_26769];\n                x_25252 = ((__global int64_t *) mem_28294)[gtid_26769];\n                \n                bool res_25253;\n                \n                res_25253 = x_25249 || x_25251;\n                \n                int64_t res_25254;\n                \n                if (x_25251) {\n                    res_25254 = x_25252;\n                } else {\n                    int64_t res_25255 = add64(x_25250, x_25252);\n                    \n                    res_25254 = res_25255;\n                }\n                x_25249 = res_25253;\n                x_25250 = res_25254;\n                ((__global bool *) mem_28292)[gtid_26769] = x_25249;\n                ((__global int64_t *) mem_28294)[gtid_26769] = x_25250;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26765\n}\n__kernel void mainziscan_stage3_26778(__global int *global_failure,\n                                      int64_t res_25191,\n                                      int64_t num_groups_26775, __global\n                                      unsigned char *mem_28299, __global\n                                      unsigned char *mem_28301,\n                                      int32_t num_threads_29018,\n                                      int32_t required_groups_29070)\n{\n    #define segscan_group_sizze_26773 (mainzisegscan_group_sizze_26772)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29071;\n    int32_t local_tid_29072;\n    int64_t group_sizze_29075;\n    int32_t wave_sizze_29074;\n    int32_t group_tid_29073;\n    \n    global_tid_29071 = get_global_id(0);\n    local_tid_29072 = get_local_id(0);\n    group_sizze_29075 = get_local_size(0);\n    wave_sizze_29074 = LOCKSTEP_WIDTH;\n    group_tid_29073 = ",
                   "get_group_id(0);\n    \n    int32_t phys_tid_26778;\n    \n    phys_tid_26778 = global_tid_29071;\n    \n    int32_t phys_group_id_29076;\n    \n    phys_group_id_29076 = get_group_id(0);\n    for (int32_t i_29077 = 0; i_29077 < sdiv_up32(required_groups_29070 -\n                                                  phys_group_id_29076,\n                                                  sext_i64_i32(num_groups_26775));\n         i_29077++) {\n        int32_t virt_group_id_29078 = phys_group_id_29076 + i_29077 *\n                sext_i64_i32(num_groups_26775);\n        int64_t flat_idx_29079 = sext_i32_i64(virt_group_id_29078) *\n                segscan_group_sizze_26773 + sext_i32_i64(local_tid_29072);\n        int64_t gtid_26777 = flat_idx_29079;\n        int64_t orig_group_29080 = squot64(flat_idx_29079,\n                                           segscan_group_sizze_26773 *\n                                           sdiv_up64(res_25191,\n                                                     sext_i32_i64(num_threads_29018)));\n        int64_t carry_in_flat_idx_29081 = orig_group_29080 *\n                (segscan_group_sizze_26773 * sdiv_up64(res_25191,\n                                                       sext_i32_i64(num_threads_29018))) -\n                1;\n        \n        if (slt64(gtid_26777, res_25191)) {\n            if (!(orig_group_29080 == 0 || flat_idx_29079 == (orig_group_29080 +\n                                                              1) *\n                  (segscan_group_sizze_26773 * sdiv_up64(res_25191,\n                                                         sext_i32_i64(num_threads_29018))) -\n                  1)) {\n                bool x_25275;\n                float x_25276;\n                bool x_25277;\n                float x_25278;\n                \n                x_25275 = ((__global\n                            bool *) mem_28299)[carry_in_flat_idx_29081];\n                x_25276 = ((__global\n                            float *) mem_28301)[carry_in_flat_idx_29081]",
                   ";\n                x_25277 = ((__global bool *) mem_28299)[gtid_26777];\n                x_25278 = ((__global float *) mem_28301)[gtid_26777];\n                \n                bool res_25279;\n                \n                res_25279 = x_25275 || x_25277;\n                \n                float res_25280;\n                \n                if (x_25277) {\n                    res_25280 = x_25278;\n                } else {\n                    float res_25281 = x_25276 + x_25278;\n                    \n                    res_25280 = res_25281;\n                }\n                x_25275 = res_25279;\n                x_25276 = res_25280;\n                ((__global bool *) mem_28299)[gtid_26777] = x_25275;\n                ((__global float *) mem_28301)[gtid_26777] = x_25276;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26773\n}\n__kernel void mainziscan_stage3_26830(__global int *global_failure,\n                                      int64_t res_25191,\n                                      int64_t num_groups_26827, __global\n                                      unsigned char *mem_28304,\n                                      int32_t num_threads_29085,\n                                      int32_t required_groups_29121)\n{\n    #define segscan_group_sizze_26825 (mainzisegscan_group_sizze_26824)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29122;\n    int32_t local_tid_29123;\n    int64_t group_sizze_29126;\n    int32_t wave_sizze_29125;\n    int32_t group_tid_29124;\n    \n    global_tid_29122 = get_global_id(0);\n    local_tid_29123 = get_local_id(0);\n    group_sizze_29126 = get_local_size(0);\n    wave_sizze_29125 = LOCKSTEP_WIDTH;\n    group_tid_29124 = get_group_id(0);\n    \n    int32_t phys_tid_26830;\n    \n    phys_tid_26830 = global_tid_29122;\n    \n    int32_t p",
                   "hys_group_id_29127;\n    \n    phys_group_id_29127 = get_group_id(0);\n    for (int32_t i_29128 = 0; i_29128 < sdiv_up32(required_groups_29121 -\n                                                  phys_group_id_29127,\n                                                  sext_i64_i32(num_groups_26827));\n         i_29128++) {\n        int32_t virt_group_id_29129 = phys_group_id_29127 + i_29128 *\n                sext_i64_i32(num_groups_26827);\n        int64_t flat_idx_29130 = sext_i32_i64(virt_group_id_29129) *\n                segscan_group_sizze_26825 + sext_i32_i64(local_tid_29123);\n        int64_t gtid_26829 = flat_idx_29130;\n        int64_t orig_group_29131 = squot64(flat_idx_29130,\n                                           segscan_group_sizze_26825 *\n                                           sdiv_up64(res_25191,\n                                                     sext_i32_i64(num_threads_29085)));\n        int64_t carry_in_flat_idx_29132 = orig_group_29131 *\n                (segscan_group_sizze_26825 * sdiv_up64(res_25191,\n                                                       sext_i32_i64(num_threads_29085))) -\n                1;\n        \n        if (slt64(gtid_26829, res_25191)) {\n            if (!(orig_group_29131 == 0 || flat_idx_29130 == (orig_group_29131 +\n                                                              1) *\n                  (segscan_group_sizze_26825 * sdiv_up64(res_25191,\n                                                         sext_i32_i64(num_threads_29085))) -\n                  1)) {\n                int64_t x_25378;\n                int64_t x_25379;\n                \n                x_25378 = ((__global\n                            int64_t *) mem_28304)[carry_in_flat_idx_29132];\n                x_25379 = ((__global int64_t *) mem_28304)[gtid_26829];\n                \n                int64_t res_25380;\n                \n                res_25380 = add64(x_25378, x_25379);\n                x_25378 = res_25380;\n                ((__global int64_t *) mem_2",
                   "8304)[gtid_26829] = x_25378;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_26825\n}\n__kernel void mainziseghist_global_26747(__global int *global_failure,\n                                         int64_t flat_dim_24906,\n                                         int64_t res_25191,\n                                         int64_t num_groups_26744, __global\n                                         unsigned char *mem_28276,\n                                         int32_t num_subhistos_28734, __global\n                                         unsigned char *res_subhistos_mem_28735,\n                                         __global\n                                         unsigned char *mainzihist_locks_mem_28805,\n                                         int32_t chk_i_28807,\n                                         int64_t hist_H_chk_28808)\n{\n    #define seghist_group_sizze_26742 (mainziseghist_group_sizze_26741)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28809;\n    int32_t local_tid_28810;\n    int64_t group_sizze_28813;\n    int32_t wave_sizze_28812;\n    int32_t group_tid_28811;\n    \n    global_tid_28809 = get_global_id(0);\n    local_tid_28810 = get_local_id(0);\n    group_sizze_28813 = get_local_size(0);\n    wave_sizze_28812 = LOCKSTEP_WIDTH;\n    group_tid_28811 = get_group_id(0);\n    \n    int32_t phys_tid_26747;\n    \n    phys_tid_26747 = global_tid_28809;\n    \n    int32_t subhisto_ind_28814;\n    \n    subhisto_ind_28814 = squot32(global_tid_28809,\n                                 sdiv_up32(sext_i64_i32(seghist_group_sizze_26742 *\n                                           num_groups_26744),\n                                           num_subhistos_28734));\n    for (int64_t i_28815 = 0; i_28815 < sdiv_up64(flat_dim_24906 -\n                      ",
                   "                            sext_i32_i64(global_tid_28809),\n                                                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_26742 *\n                                                  num_groups_26744)));\n         i_28815++) {\n        int32_t gtid_26746 = sext_i64_i32(i_28815 *\n                sext_i32_i64(sext_i64_i32(seghist_group_sizze_26742 *\n                num_groups_26744)) + sext_i32_i64(global_tid_28809));\n        \n        if (slt64(i_28815 *\n                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_26742 *\n                  num_groups_26744)) + sext_i32_i64(global_tid_28809),\n                  flat_dim_24906)) {\n            int64_t i_p_o_28114 = add64(-1, gtid_26746);\n            int64_t rot_i_28115 = smod64(i_p_o_28114, flat_dim_24906);\n            bool cond_26753 = gtid_26746 == 0;\n            int64_t res_26754;\n            \n            if (cond_26753) {\n                res_26754 = 0;\n            } else {\n                int64_t x_26752 = ((__global int64_t *) mem_28276)[rot_i_28115];\n                \n                res_26754 = x_26752;\n            }\n            // save map-out results\n            { }\n            // perform atomic updates\n            {\n                if (sle64(sext_i32_i64(chk_i_28807) * hist_H_chk_28808,\n                          res_26754) && (slt64(res_26754,\n                                               sext_i32_i64(chk_i_28807) *\n                                               hist_H_chk_28808 +\n                                               hist_H_chk_28808) &&\n                                         slt64(res_26754, res_25191))) {\n                    int64_t x_26748;\n                    int64_t x_26749;\n                    \n                    x_26749 = gtid_26746;\n                    \n                    int32_t old_28816;\n                    volatile bool continue_28817;\n                    \n                    continue_28817 = 1;\n                    while (continue_28817) {\n               ",
                   "         old_28816 =\n                            atomic_cmpxchg_i32_global(&((volatile __global\n                                                         int *) mainzihist_locks_mem_28805)[srem64(sext_i32_i64(subhisto_ind_28814) *\n                                                                                                   res_25191 +\n                                                                                                   res_26754,\n                                                                                                   100151)],\n                                                      0, 1);\n                        if (old_28816 == 0) {\n                            int64_t x_26748;\n                            \n                            // bind lhs\n                            {\n                                x_26748 = ((volatile __global\n                                            int64_t *) res_subhistos_mem_28735)[sext_i32_i64(subhisto_ind_28814) *\n                                                                                res_25191 +\n                                                                                res_26754];\n                            }\n                            // execute operation\n                            {\n                                int64_t res_26750 = smax64(x_26748, x_26749);\n                                \n                                x_26748 = res_26750;\n                            }\n                            // update global result\n                            {\n                                ((volatile __global\n                                  int64_t *) res_subhistos_mem_28735)[sext_i32_i64(subhisto_ind_28814) *\n                                                                      res_25191 +\n                                                                      res_26754] =\n                                    x_26748;\n                            }\n                            mem_fence_global()",
                   ";\n                            old_28816 =\n                                atomic_cmpxchg_i32_global(&((volatile __global\n                                                             int *) mainzihist_locks_mem_28805)[srem64(sext_i32_i64(subhisto_ind_28814) *\n                                                                                                       res_25191 +\n                                                                                                       res_26754,\n                                                                                                       100151)],\n                                                          1, 0);\n                            continue_28817 = 0;\n                        }\n                        mem_fence_global();\n                    }\n                }\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef seghist_group_sizze_26742\n}\n__kernel void mainziseghist_local_26747(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *locks_mem_28775_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *subhistogram_local_mem_28773_backing_aligned_1,\n                                        int64_t flat_dim_24906,\n                                        int64_t res_25191, __global\n                                        unsigned char *mem_28276, __global\n                                        unsigned char *res_subhistos_mem_28735,\n                                        int32_t max_group_sizze_28744,\n                                        int64_t num_groups_28745,\n                                        int32_t hist_M_28751,\n                                        int32_t chk_i_28756,\n                                        int64_t num_segments_28757,\n                                        int64_t hist_H_chk_28758,\n                                 ",
                   "       int64_t histo_sizze_28759,\n                                        int32_t init_per_thread_28760)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict locks_mem_28775_backing_1 =\n                          (__local volatile\n                           char *) locks_mem_28775_backing_aligned_0;\n    __local volatile char *restrict subhistogram_local_mem_28773_backing_0 =\n                          (__local volatile\n                           char *) subhistogram_local_mem_28773_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28761;\n    int32_t local_tid_28762;\n    int64_t group_sizze_28765;\n    int32_t wave_sizze_28764;\n    int32_t group_tid_28763;\n    \n    global_tid_28761 = get_global_id(0);\n    local_tid_28762 = get_local_id(0);\n    group_sizze_28765 = get_local_size(0);\n    wave_sizze_28764 = LOCKSTEP_WIDTH;\n    group_tid_28763 = get_group_id(0);\n    \n    int32_t phys_tid_26747;\n    \n    phys_tid_26747 = global_tid_28761;\n    \n    int32_t phys_group_id_28766;\n    \n    phys_group_id_28766 = get_group_id(0);\n    for (int32_t i_28767 = 0; i_28767 <\n         sdiv_up32(sext_i64_i32(num_groups_28745 * num_segments_28757) -\n                   phys_group_id_28766, sext_i64_i32(num_groups_28745));\n         i_28767++) {\n        int32_t virt_group_id_28768 = phys_group_id_28766 + i_28767 *\n                sext_i64_i32(num_groups_28745);\n        int32_t flat_segment_id_28769 = squot32(virt_group_id_28768,\n                                                sext_i64_i32(num_groups_28745));\n        int32_t gid_in_segment_28770 = srem32(virt_group_id_28768,\n                                              sext_i64_i32(num_groups_28745));\n        int32_t pgtid_in_segment_28771 = gid_in_segment_28770 *\n                sext_i64_i32(max_group_sizze_28744) + local_tid_28762;\n        int32_t threads_per_segment_28772 = sext_i64_i32(num_groups_28745 *\n              ",
                   "  max_group_sizze_28744);\n        __local char *subhistogram_local_mem_28773;\n        \n        subhistogram_local_mem_28773 = (__local\n                                        char *) subhistogram_local_mem_28773_backing_0;\n        \n        __local char *locks_mem_28775;\n        \n        locks_mem_28775 = (__local char *) locks_mem_28775_backing_1;\n        // All locks start out unlocked\n        {\n            for (int64_t i_28777 = 0; i_28777 < sdiv_up64(hist_M_28751 *\n                                                          hist_H_chk_28758 -\n                                                          sext_i32_i64(local_tid_28762),\n                                                          max_group_sizze_28744);\n                 i_28777++) {\n                ((__local int32_t *) locks_mem_28775)[squot64(i_28777 *\n                                                              max_group_sizze_28744 +\n                                                              sext_i32_i64(local_tid_28762),\n                                                              hist_H_chk_28758) *\n                                                      hist_H_chk_28758 +\n                                                      (i_28777 *\n                                                       max_group_sizze_28744 +\n                                                       sext_i32_i64(local_tid_28762) -\n                                                       squot64(i_28777 *\n                                                               max_group_sizze_28744 +\n                                                               sext_i32_i64(local_tid_28762),\n                                                               hist_H_chk_28758) *\n                                                       hist_H_chk_28758)] = 0;\n            }\n        }\n        \n        int32_t thread_local_subhisto_i_28778;\n        \n        thread_local_subhisto_i_28778 = srem32(local_tid_28762, hist_M_28751);\n        // initialize histog",
                   "rams in local memory\n        {\n            for (int32_t local_i_28779 = 0; local_i_28779 <\n                 init_per_thread_28760; local_i_28779++) {\n                int32_t j_28780 = local_i_28779 *\n                        sext_i64_i32(max_group_sizze_28744) + local_tid_28762;\n                int32_t j_offset_28781 = hist_M_28751 *\n                        sext_i64_i32(histo_sizze_28759) * gid_in_segment_28770 +\n                        j_28780;\n                int32_t local_subhisto_i_28782 = squot32(j_28780,\n                                                         sext_i64_i32(histo_sizze_28759));\n                int32_t global_subhisto_i_28783 = squot32(j_offset_28781,\n                                                          sext_i64_i32(histo_sizze_28759));\n                \n                if (slt32(j_28780, hist_M_28751 *\n                          sext_i64_i32(histo_sizze_28759))) {\n                    // First subhistogram is initialised from global memory; others with neutral element.\n                    {\n                        if (global_subhisto_i_28783 == 0) {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_28773)[sext_i32_i64(local_subhisto_i_28782) *\n                                                                       hist_H_chk_28758 +\n                                                                       sext_i32_i64(srem32(j_28780,\n                                                                                           sext_i64_i32(histo_sizze_28759)))] =\n                                ((__global\n                                  int64_t *) res_subhistos_mem_28735)[sext_i32_i64(srem32(j_28780,\n                                                                                          sext_i64_i32(histo_sizze_28759))) +\n                                                                      sext_i32_i64(chk_i_28756) *\n                                                                      hist_H_ch",
                   "k_28758];\n                        } else {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_28773)[sext_i32_i64(local_subhisto_i_28782) *\n                                                                       hist_H_chk_28758 +\n                                                                       sext_i32_i64(srem32(j_28780,\n                                                                                           sext_i64_i32(histo_sizze_28759)))] =\n                                0;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_28784 = 0; i_28784 <\n             sdiv_up32(sext_i64_i32(flat_dim_24906) - pgtid_in_segment_28771,\n                       threads_per_segment_28772); i_28784++) {\n            int32_t gtid_26746 = i_28784 * threads_per_segment_28772 +\n                    pgtid_in_segment_28771;\n            int64_t i_p_o_28114 = add64(-1, gtid_26746);\n            int64_t rot_i_28115 = smod64(i_p_o_28114, flat_dim_24906);\n            bool cond_26753 = gtid_26746 == 0;\n            int64_t res_26754;\n            \n            if (cond_26753) {\n                res_26754 = 0;\n            } else {\n                int64_t x_26752 = ((__global int64_t *) mem_28276)[rot_i_28115];\n                \n                res_26754 = x_26752;\n            }\n            if (chk_i_28756 == 0) {\n                // save map-out results\n                { }\n            }\n            // perform atomic updates\n            {\n                if (slt64(res_26754, res_25191) &&\n                    (sle64(sext_i32_i64(chk_i_28756) * hist_H_chk_28758,\n                           res_26754) && slt64(res_26754,\n                                               sext_i32_i64(chk_i_28756) *\n                                               hist_H_chk_28758 +\n                                               hist_H_chk_28758))) {\n                    int",
                   "64_t x_26748;\n                    int64_t x_26749;\n                    \n                    x_26749 = gtid_26746;\n                    \n                    int32_t old_28785;\n                    volatile bool continue_28786;\n                    \n                    continue_28786 = 1;\n                    while (continue_28786) {\n                        old_28785 = atomic_cmpxchg_i32_local(&((volatile __local\n                                                                int *) locks_mem_28775)[sext_i32_i64(thread_local_subhisto_i_28778) *\n                                                                                        hist_H_chk_28758 +\n                                                                                        (res_26754 -\n                                                                                         sext_i32_i64(chk_i_28756) *\n                                                                                         hist_H_chk_28758)],\n                                                             0, 1);\n                        if (old_28785 == 0) {\n                            int64_t x_26748;\n                            \n                            // bind lhs\n                            {\n                                x_26748 = ((volatile __local\n                                            int64_t *) subhistogram_local_mem_28773)[sext_i32_i64(thread_local_subhisto_i_28778) *\n                                                                                     hist_H_chk_28758 +\n                                                                                     (res_26754 -\n                                                                                      sext_i32_i64(chk_i_28756) *\n                                                                                      hist_H_chk_28758)];\n                            }\n                            // execute operation\n                            {\n                                int64_t ",
                   "res_26750 = smax64(x_26748, x_26749);\n                                \n                                x_26748 = res_26750;\n                            }\n                            // update global result\n                            {\n                                ((volatile __local\n                                  int64_t *) subhistogram_local_mem_28773)[sext_i32_i64(thread_local_subhisto_i_28778) *\n                                                                           hist_H_chk_28758 +\n                                                                           (res_26754 -\n                                                                            sext_i32_i64(chk_i_28756) *\n                                                                            hist_H_chk_28758)] =\n                                    x_26748;\n                            }\n                            mem_fence_local();\n                            old_28785 =\n                                atomic_cmpxchg_i32_local(&((volatile __local\n                                                            int *) locks_mem_28775)[sext_i32_i64(thread_local_subhisto_i_28778) *\n                                                                                    hist_H_chk_28758 +\n                                                                                    (res_26754 -\n                                                                                     sext_i32_i64(chk_i_28756) *\n                                                                                     hist_H_chk_28758)],\n                                                         1, 0);\n                            continue_28786 = 0;\n                        }\n                        mem_fence_local();\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Compact the multiple local memory subhistograms to result in global memory\n        {\n            int64_t trunc_H_28787 = smin64(",
                   "hist_H_chk_28758, res_25191 -\n                                           sext_i32_i64(chk_i_28756) *\n                                           hist_H_chk_28758);\n            int32_t histo_sizze_28788 = sext_i64_i32(trunc_H_28787);\n            \n            for (int32_t local_i_28789 = 0; local_i_28789 <\n                 init_per_thread_28760; local_i_28789++) {\n                int32_t j_28790 = local_i_28789 *\n                        sext_i64_i32(max_group_sizze_28744) + local_tid_28762;\n                \n                if (slt32(j_28790, histo_sizze_28788)) {\n                    int64_t x_26748;\n                    int64_t x_26749;\n                    \n                    // Read values from subhistogram 0.\n                    {\n                        x_26748 = ((__local\n                                    int64_t *) subhistogram_local_mem_28773)[sext_i32_i64(j_28790)];\n                    }\n                    // Accumulate based on values in other subhistograms.\n                    {\n                        for (int32_t subhisto_id_28791 = 0; subhisto_id_28791 <\n                             hist_M_28751 - 1; subhisto_id_28791++) {\n                            x_26749 = ((__local\n                                        int64_t *) subhistogram_local_mem_28773)[(sext_i32_i64(subhisto_id_28791) +\n                                                                                  1) *\n                                                                                 hist_H_chk_28758 +\n                                                                                 sext_i32_i64(j_28790)];\n                            \n                            int64_t res_26750;\n                            \n                            res_26750 = smax64(x_26748, x_26749);\n                            x_26748 = res_26750;\n                        }\n                    }\n                    // Put final bucket value in global memory.\n                    {\n                        ((__global\n  ",
                   "                        int64_t *) res_subhistos_mem_28735)[srem64(sext_i32_i64(virt_group_id_28768),\n                                                                     num_groups_28745) *\n                                                              res_25191 +\n                                                              (sext_i32_i64(j_28790) +\n                                                               sext_i32_i64(chk_i_28756) *\n                                                               hist_H_chk_28758)] =\n                            x_26748;\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\n__kernel void mainzisegmap_25899(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, int64_t n_24721,\n                                 float a_24729, float r0_24732, float x_24749,\n                                 float x_24751, float y_24753, float y_24754,\n                                 __global unsigned char *swap_term_mem_28181,\n                                 __global unsigned char *payments_mem_28182,\n                                 __global unsigned char *mem_28195, __global\n                                 unsigned char *mem_28209,\n                                 int64_t num_threads_28343)\n{\n    #define segmap_group_sizze_25977 (mainzisegmap_group_sizze_25901)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28570;\n    int32_t local_tid_28571;\n    int64_t group_sizze_28574;\n    int32_t wave_sizze_28573;\n    int32_t group_tid_28572;\n    \n    global_tid_28570 = get_global_id(0);\n    local_tid_28571 = get_local_id(0);\n    group_sizze_28574 = get_local_size(0);\n    wave_sizze_28573 = LOCKSTEP_WIDTH;\n    group_tid_285",
                   "72 = get_group_id(0);\n    \n    int32_t phys_tid_25899;\n    \n    phys_tid_25899 = global_tid_28570;\n    \n    int64_t gtid_25898;\n    \n    gtid_25898 = sext_i32_i64(group_tid_28572) * segmap_group_sizze_25977 +\n        sext_i32_i64(local_tid_28571);\n    if (slt64(gtid_25898, n_24721)) {\n        float res_25988 = ((__global float *) swap_term_mem_28181)[gtid_25898];\n        int64_t res_25989 = ((__global\n                              int64_t *) payments_mem_28182)[gtid_25898];\n        int64_t range_end_25991 = sub64(res_25989, 1);\n        bool bounds_invalid_upwards_25992 = slt64(range_end_25991, 0);\n        bool valid_25993 = !bounds_invalid_upwards_25992;\n        bool range_valid_c_25994;\n        \n        if (!valid_25993) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 0) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = 1;\n                    global_failure_args[2] = range_end_25991;\n                    ;\n                }\n                return;\n            }\n        }\n        for (int64_t i_28159 = 0; i_28159 < res_25989; i_28159++) {\n            float res_25998 = sitofp_i64_f32(i_28159);\n            float res_25999 = res_25988 * res_25998;\n            \n            ((__global float *) mem_28195)[phys_tid_25899 + i_28159 *\n                                           num_threads_28343] = res_25999;\n        }\n        \n        bool y_26000 = slt64(0, res_25989);\n        bool index_certs_26001;\n        \n        if (!y_26000) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 1) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_25989;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_26002 = sitofp_i64_f32(range_end_25991);\n        float index_primexp_26003 = res_25988 * binop_y_26002;\n        float negate_arg_26004 = a_24729 * inde",
                   "x_primexp_26003;\n        float exp_arg_26005 = 0.0F - negate_arg_26004;\n        float res_26006 = fpow32(2.7182817F, exp_arg_26005);\n        float x_26007 = 1.0F - res_26006;\n        float B_26008 = x_26007 / a_24729;\n        float x_26009 = B_26008 - index_primexp_26003;\n        float x_26010 = y_24753 * x_26009;\n        float A1_26011 = x_26010 / x_24749;\n        float y_26012 = fpow32(B_26008, 2.0F);\n        float x_26013 = x_24751 * y_26012;\n        float A2_26014 = x_26013 / y_24754;\n        float exp_arg_26015 = A1_26011 - A2_26014;\n        float res_26016 = fpow32(2.7182817F, exp_arg_26015);\n        float negate_arg_26017 = r0_24732 * B_26008;\n        float exp_arg_26018 = 0.0F - negate_arg_26017;\n        float res_26019 = fpow32(2.7182817F, exp_arg_26018);\n        float res_26020 = res_26016 * res_26019;\n        bool empty_slice_26021 = range_end_25991 == 0;\n        bool zzero_leq_i_p_m_t_s_26022 = sle64(0, range_end_25991);\n        bool i_p_m_t_s_leq_w_26023 = slt64(range_end_25991, res_25989);\n        bool i_lte_j_26024 = sle64(1, res_25989);\n        bool y_26025 = zzero_leq_i_p_m_t_s_26022 && i_p_m_t_s_leq_w_26023;\n        bool y_26026 = i_lte_j_26024 && y_26025;\n        bool ok_or_empty_26027 = empty_slice_26021 || y_26026;\n        bool index_certs_26028;\n        \n        if (!ok_or_empty_26027) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 2) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = res_25989;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float res_26030;\n        float redout_28161 = 0.0F;\n        \n        for (int64_t i_28162 = 0; i_28162 < range_end_25991; i_28162++) {\n            int64_t slice_28175 = 1 + i_28162;\n            float x_26034 = ((__global float *) mem_28195)[phys_tid_25899 +\n                                                           slice_28175 *\n                                     ",
                   "                      num_threads_28343];\n            float negate_arg_26035 = a_24729 * x_26034;\n            float exp_arg_26036 = 0.0F - negate_arg_26035;\n            float res_26037 = fpow32(2.7182817F, exp_arg_26036);\n            float x_26038 = 1.0F - res_26037;\n            float B_26039 = x_26038 / a_24729;\n            float x_26040 = B_26039 - x_26034;\n            float x_26041 = y_24753 * x_26040;\n            float A1_26042 = x_26041 / x_24749;\n            float y_26043 = fpow32(B_26039, 2.0F);\n            float x_26044 = x_24751 * y_26043;\n            float A2_26045 = x_26044 / y_24754;\n            float exp_arg_26046 = A1_26042 - A2_26045;\n            float res_26047 = fpow32(2.7182817F, exp_arg_26046);\n            float negate_arg_26048 = r0_24732 * B_26039;\n            float exp_arg_26049 = 0.0F - negate_arg_26048;\n            float res_26050 = fpow32(2.7182817F, exp_arg_26049);\n            float res_26051 = res_26047 * res_26050;\n            float res_26033 = res_26051 + redout_28161;\n            float redout_tmp_28576 = res_26033;\n            \n            redout_28161 = redout_tmp_28576;\n        }\n        res_26030 = redout_28161;\n        \n        float x_26052 = 1.0F - res_26020;\n        float y_26053 = res_25988 * res_26030;\n        float res_26054 = x_26052 / y_26053;\n        \n        ((__global float *) mem_28209)[gtid_25898] = res_26054;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25977\n}\n__kernel void mainzisegmap_26075(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, int64_t n_24721,\n                                 float a_24729, float r0_24732, float x_24749,\n                                 float x_24751, float y_24753, float y_24754,\n                                 __global unsigned char *swap_term_mem_28181,\n                                 __global unsigned char *payments_mem_28182,\n                          ",
                   "       __global unsigned char *mem_28218, __global\n                                 unsigned char *mem_28232,\n                                 int64_t num_threads_28375)\n{\n    #define segmap_group_sizze_26153 (mainzisegmap_group_sizze_26077)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28607;\n    int32_t local_tid_28608;\n    int64_t group_sizze_28611;\n    int32_t wave_sizze_28610;\n    int32_t group_tid_28609;\n    \n    global_tid_28607 = get_global_id(0);\n    local_tid_28608 = get_local_id(0);\n    group_sizze_28611 = get_local_size(0);\n    wave_sizze_28610 = LOCKSTEP_WIDTH;\n    group_tid_28609 = get_group_id(0);\n    \n    int32_t phys_tid_26075;\n    \n    phys_tid_26075 = global_tid_28607;\n    \n    int64_t gtid_26074;\n    \n    gtid_26074 = sext_i32_i64(group_tid_28609) * segmap_group_sizze_26153 +\n        sext_i32_i64(local_tid_28608);\n    if (slt64(gtid_26074, n_24721)) {\n        float res_26164 = ((__global float *) swap_term_mem_28181)[gtid_26074];\n        int64_t res_26165 = ((__global\n                              int64_t *) payments_mem_28182)[gtid_26074];\n        int64_t range_end_26167 = sub64(res_26165, 1);\n        bool bounds_invalid_upwards_26168 = slt64(range_end_26167, 0);\n        bool valid_26169 = !bounds_invalid_upwards_26168;\n        bool range_valid_c_26170;\n        \n        if (!valid_26169) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 3) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = 1;\n                    global_failure_args[2] = range_end_26167;\n                    ;\n                }\n                return;\n            }\n        }\n        for (int64_t i_28165 = 0; i_28165 < res_26165; i_28165++) {\n            float res_26174 = sitofp_i64_f32(i_28165);\n            float res_26175 = res_26164 * res_26174;\n            \n            (",
                   "(__global float *) mem_28218)[phys_tid_26075 + i_28165 *\n                                           num_threads_28375] = res_26175;\n        }\n        \n        bool y_26176 = slt64(0, res_26165);\n        bool index_certs_26177;\n        \n        if (!y_26176) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 4) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_26165;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_26178 = sitofp_i64_f32(range_end_26167);\n        float index_primexp_26179 = res_26164 * binop_y_26178;\n        float negate_arg_26180 = a_24729 * index_primexp_26179;\n        float exp_arg_26181 = 0.0F - negate_arg_26180;\n        float res_26182 = fpow32(2.7182817F, exp_arg_26181);\n        float x_26183 = 1.0F - res_26182;\n        float B_26184 = x_26183 / a_24729;\n        float x_26185 = B_26184 - index_primexp_26179;\n        float x_26186 = y_24753 * x_26185;\n        float A1_26187 = x_26186 / x_24749;\n        float y_26188 = fpow32(B_26184, 2.0F);\n        float x_26189 = x_24751 * y_26188;\n        float A2_26190 = x_26189 / y_24754;\n        float exp_arg_26191 = A1_26187 - A2_26190;\n        float res_26192 = fpow32(2.7182817F, exp_arg_26191);\n        float negate_arg_26193 = r0_24732 * B_26184;\n        float exp_arg_26194 = 0.0F - negate_arg_26193;\n        float res_26195 = fpow32(2.7182817F, exp_arg_26194);\n        float res_26196 = res_26192 * res_26195;\n        bool empty_slice_26197 = range_end_26167 == 0;\n        bool zzero_leq_i_p_m_t_s_26198 = sle64(0, range_end_26167);\n        bool i_p_m_t_s_leq_w_26199 = slt64(range_end_26167, res_26165);\n        bool i_lte_j_26200 = sle64(1, res_26165);\n        bool y_26201 = zzero_leq_i_p_m_t_s_26198 && i_p_m_t_s_leq_w_26199;\n        bool y_26202 = i_lte_j_26200 && y_26201;\n        bool ok_or_empty_26203 = empty_slice_26197 || y_26202;\n        bool index",
                   "_certs_26204;\n        \n        if (!ok_or_empty_26203) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 5) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = res_26165;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float res_26206;\n        float redout_28167 = 0.0F;\n        \n        for (int64_t i_28168 = 0; i_28168 < range_end_26167; i_28168++) {\n            int64_t slice_28178 = 1 + i_28168;\n            float x_26210 = ((__global float *) mem_28218)[phys_tid_26075 +\n                                                           slice_28178 *\n                                                           num_threads_28375];\n            float negate_arg_26211 = a_24729 * x_26210;\n            float exp_arg_26212 = 0.0F - negate_arg_26211;\n            float res_26213 = fpow32(2.7182817F, exp_arg_26212);\n            float x_26214 = 1.0F - res_26213;\n            float B_26215 = x_26214 / a_24729;\n            float x_26216 = B_26215 - x_26210;\n            float x_26217 = y_24753 * x_26216;\n            float A1_26218 = x_26217 / x_24749;\n            float y_26219 = fpow32(B_26215, 2.0F);\n            float x_26220 = x_24751 * y_26219;\n            float A2_26221 = x_26220 / y_24754;\n            float exp_arg_26222 = A1_26218 - A2_26221;\n            float res_26223 = fpow32(2.7182817F, exp_arg_26222);\n            float negate_arg_26224 = r0_24732 * B_26215;\n            float exp_arg_26225 = 0.0F - negate_arg_26224;\n            float res_26226 = fpow32(2.7182817F, exp_arg_26225);\n            float res_26227 = res_26223 * res_26226;\n            float res_26209 = res_26227 + redout_28167;\n            float redout_tmp_28613 = res_26209;\n            \n            redout_28167 = redout_tmp_28613;\n        }\n        res_26206 = redout_28167;\n        \n        float x_26228 = 1.0F - res_26196;\n        float y_26229 = res_26164 * res_26206;\n        float",
                   " res_26230 = x_26228 / y_26229;\n        \n        ((__global float *) mem_28232)[gtid_26074] = res_26230;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26153\n}\n__kernel void mainzisegmap_26374(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args,\n                                 int64_t paths_24724, int64_t steps_24725,\n                                 float a_24729, float b_24730,\n                                 float sigma_24731, float r0_24732,\n                                 float dt_24747, int64_t upper_bound_24841,\n                                 float res_24842, int64_t num_groups_26626,\n                                 __global unsigned char *mem_28246, __global\n                                 unsigned char *mem_28249, __global\n                                 unsigned char *mem_28264)\n{\n    #define segmap_group_sizze_26625 (mainzisegmap_group_sizze_26376)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_28626;\n    int32_t local_tid_28627;\n    int64_t group_sizze_28630;\n    int32_t wave_sizze_28629;\n    int32_t group_tid_28628;\n    \n    global_tid_28626 = get_global_id(0);\n    local_tid_28627 = get_local_id(0);\n    group_sizze_28630 = get_local_size(0);\n    wave_sizze_28629 = LOCKSTEP_WIDTH;\n    group_tid_28628 = get_group_id(0);\n    \n    int32_t phys_tid_26374;\n    \n    phys_tid_26374 = global_tid_28626;\n    \n    int32_t phys_group_id_28631;\n    \n    phys_group_id_28631 = get_group_id(0);\n    for (int32_t i_28632 = 0; i_28632 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(paths_24724,\n                                          seg",
                   "map_group_sizze_26625)) -\n                   phys_group_id_28631, sext_i64_i32(num_groups_26626));\n         i_28632++) {\n        int32_t virt_group_id_28633 = phys_group_id_28631 + i_28632 *\n                sext_i64_i32(num_groups_26626);\n        int64_t gtid_26373 = sext_i32_i64(virt_group_id_28633) *\n                segmap_group_sizze_26625 + sext_i32_i64(local_tid_28627);\n        \n        if (slt64(gtid_26373, paths_24724)) {\n            for (int64_t i_28634 = 0; i_28634 < steps_24725; i_28634++) {\n                ((__global float *) mem_28249)[phys_tid_26374 + i_28634 *\n                                               (num_groups_26626 *\n                                                segmap_group_sizze_26625)] =\n                    r0_24732;\n            }\n            for (int64_t i_26632 = 0; i_26632 < upper_bound_24841; i_26632++) {\n                bool y_26634 = slt64(i_26632, steps_24725);\n                bool index_certs_26635;\n                \n                if (!y_26634) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 6) ==\n                            -1) {\n                            global_failure_args[0] = i_26632;\n                            global_failure_args[1] = steps_24725;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float shortstep_arg_26636 = ((__global\n                                              float *) mem_28246)[i_26632 *\n                                                                  paths_24724 +\n                                                                  gtid_26373];\n                float shortstep_arg_26637 = ((__global\n                                              float *) mem_28249)[phys_tid_26374 +\n                                                                  i_26632 *\n                                     ",
                   "                             (num_groups_26626 *\n                                                                   segmap_group_sizze_26625)];\n                float y_26638 = b_24730 - shortstep_arg_26637;\n                float x_26639 = a_24729 * y_26638;\n                float x_26640 = dt_24747 * x_26639;\n                float x_26641 = res_24842 * shortstep_arg_26636;\n                float y_26642 = sigma_24731 * x_26641;\n                float delta_r_26643 = x_26640 + y_26642;\n                float res_26644 = shortstep_arg_26637 + delta_r_26643;\n                int64_t i_26645 = add64(1, i_26632);\n                bool x_26646 = sle64(0, i_26645);\n                bool y_26647 = slt64(i_26645, steps_24725);\n                bool bounds_check_26648 = x_26646 && y_26647;\n                bool index_certs_26649;\n                \n                if (!bounds_check_26648) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 7) ==\n                            -1) {\n                            global_failure_args[0] = i_26645;\n                            global_failure_args[1] = steps_24725;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                ((__global float *) mem_28249)[phys_tid_26374 + i_26645 *\n                                               (num_groups_26626 *\n                                                segmap_group_sizze_26625)] =\n                    res_26644;\n            }\n            for (int64_t i_28636 = 0; i_28636 < steps_24725; i_28636++) {\n                ((__global float *) mem_28264)[i_28636 * paths_24724 +\n                                               gtid_26373] = ((__global\n                                                               float *) mem_28249)[phys_tid_26374 +\n                                                                                   i_28636 *\n",
                   "                                                                                   (num_groups_26626 *\n                                                                                    segmap_group_sizze_26625)];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26625\n}\n__kernel void mainzisegmap_26472(__global int *global_failure,\n                                 int64_t paths_24724, int64_t steps_24725,\n                                 __global unsigned char *mem_28239, __global\n                                 unsigned char *mem_28243)\n{\n    #define segmap_group_sizze_26580 (mainzisegmap_group_sizze_26475)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28620;\n    int32_t local_tid_28621;\n    int64_t group_sizze_28624;\n    int32_t wave_sizze_28623;\n    int32_t group_tid_28622;\n    \n    global_tid_28620 = get_global_id(0);\n    local_tid_28621 = get_local_id(0);\n    group_sizze_28624 = get_local_size(0);\n    wave_sizze_28623 = LOCKSTEP_WIDTH;\n    group_tid_28622 = get_group_id(0);\n    \n    int32_t phys_tid_26472;\n    \n    phys_tid_26472 = global_tid_28620;\n    \n    int64_t gtid_26470;\n    \n    gtid_26470 = squot64(sext_i32_i64(group_tid_28622) *\n                         segmap_group_sizze_26580 +\n                         sext_i32_i64(local_tid_28621), steps_24725);\n    \n    int64_t gtid_26471;\n    \n    gtid_26471 = sext_i32_i64(group_tid_28622) * segmap_group_sizze_26580 +\n        sext_i32_i64(local_tid_28621) - squot64(sext_i32_i64(group_tid_28622) *\n                                                segmap_group_sizze_26580 +\n                                                sext_i32_i64(local_tid_28621),\n                                                steps_24725) * steps_24725;\n    if (slt64(gtid_26470, paths_24724) && slt64(gtid_26471, steps_",
                   "24725)) {\n        int32_t unsign_arg_26583 = ((__global int32_t *) mem_28239)[gtid_26470];\n        int32_t res_26585 = sext_i64_i32(gtid_26471);\n        int32_t x_26586 = lshr32(res_26585, 16);\n        int32_t x_26587 = res_26585 ^ x_26586;\n        int32_t x_26588 = mul32(73244475, x_26587);\n        int32_t x_26589 = lshr32(x_26588, 16);\n        int32_t x_26590 = x_26588 ^ x_26589;\n        int32_t x_26591 = mul32(73244475, x_26590);\n        int32_t x_26592 = lshr32(x_26591, 16);\n        int32_t x_26593 = x_26591 ^ x_26592;\n        int32_t unsign_arg_26594 = unsign_arg_26583 ^ x_26593;\n        int32_t unsign_arg_26595 = mul32(48271, unsign_arg_26594);\n        int32_t unsign_arg_26596 = umod32(unsign_arg_26595, 2147483647);\n        int32_t unsign_arg_26597 = mul32(48271, unsign_arg_26596);\n        int32_t unsign_arg_26598 = umod32(unsign_arg_26597, 2147483647);\n        float res_26599 = uitofp_i32_f32(unsign_arg_26596);\n        float res_26600 = res_26599 / 2.1474836e9F;\n        float res_26601 = uitofp_i32_f32(unsign_arg_26598);\n        float res_26602 = res_26601 / 2.1474836e9F;\n        float res_26603;\n        \n        res_26603 = futrts_log32(res_26600);\n        \n        float res_26604 = -2.0F * res_26603;\n        float res_26605;\n        \n        res_26605 = futrts_sqrt32(res_26604);\n        \n        float res_26606 = 6.2831855F * res_26602;\n        float res_26607;\n        \n        res_26607 = futrts_cos32(res_26606);\n        \n        float res_26608 = res_26605 * res_26607;\n        \n        ((__global float *) mem_28243)[gtid_26470 * steps_24725 + gtid_26471] =\n            res_26608;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26580\n}\n__kernel void mainzisegmap_26536(__global int *global_failure,\n                                 int64_t paths_24724, __global\n                                 unsigned char *mem_28239)\n{\n    #define segmap_group_sizze_26555 (mainzisegmap_group_sizze_26538)\n    \n    const int block_dim0 = 0;\n    const int block",
                   "_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28615;\n    int32_t local_tid_28616;\n    int64_t group_sizze_28619;\n    int32_t wave_sizze_28618;\n    int32_t group_tid_28617;\n    \n    global_tid_28615 = get_global_id(0);\n    local_tid_28616 = get_local_id(0);\n    group_sizze_28619 = get_local_size(0);\n    wave_sizze_28618 = LOCKSTEP_WIDTH;\n    group_tid_28617 = get_group_id(0);\n    \n    int32_t phys_tid_26536;\n    \n    phys_tid_26536 = global_tid_28615;\n    \n    int64_t gtid_26535;\n    \n    gtid_26535 = sext_i32_i64(group_tid_28617) * segmap_group_sizze_26555 +\n        sext_i32_i64(local_tid_28616);\n    if (slt64(gtid_26535, paths_24724)) {\n        int32_t res_26559 = sext_i64_i32(gtid_26535);\n        int32_t x_26560 = lshr32(res_26559, 16);\n        int32_t x_26561 = res_26559 ^ x_26560;\n        int32_t x_26562 = mul32(73244475, x_26561);\n        int32_t x_26563 = lshr32(x_26562, 16);\n        int32_t x_26564 = x_26562 ^ x_26563;\n        int32_t x_26565 = mul32(73244475, x_26564);\n        int32_t x_26566 = lshr32(x_26565, 16);\n        int32_t x_26567 = x_26565 ^ x_26566;\n        int32_t unsign_arg_26568 = 777822902 ^ x_26567;\n        int32_t unsign_arg_26569 = mul32(48271, unsign_arg_26568);\n        int32_t unsign_arg_26570 = umod32(unsign_arg_26569, 2147483647);\n        \n        ((__global int32_t *) mem_28239)[gtid_26535] = unsign_arg_26570;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26555\n}\n__kernel void mainzisegmap_26832(__global int *global_failure,\n                                 int64_t res_25191, int64_t num_segments_25384,\n                                 __global unsigned char *mem_28296, __global\n                                 unsigned char *mem_28301, __global\n                                 unsigned char *mem_28304, __global\n                                 unsigned char *mem_28306)\n{\n    #define segmap_group_sizze_26835 (mainzisegmap_group_sizze_26834)\n    \n",
                   "    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29142;\n    int32_t local_tid_29143;\n    int64_t group_sizze_29146;\n    int32_t wave_sizze_29145;\n    int32_t group_tid_29144;\n    \n    global_tid_29142 = get_global_id(0);\n    local_tid_29143 = get_local_id(0);\n    group_sizze_29146 = get_local_size(0);\n    wave_sizze_29145 = LOCKSTEP_WIDTH;\n    group_tid_29144 = get_group_id(0);\n    \n    int32_t phys_tid_26832;\n    \n    phys_tid_26832 = global_tid_29142;\n    \n    int64_t write_i_26831;\n    \n    write_i_26831 = sext_i32_i64(group_tid_29144) * segmap_group_sizze_26835 +\n        sext_i32_i64(local_tid_29143);\n    if (slt64(write_i_26831, res_25191)) {\n        int64_t i_p_o_28122 = add64(1, write_i_26831);\n        int64_t rot_i_28123 = smod64(i_p_o_28122, res_25191);\n        bool x_25397 = ((__global bool *) mem_28296)[rot_i_28123];\n        float write_value_25398 = ((__global float *) mem_28301)[write_i_26831];\n        int64_t res_25399;\n        \n        if (x_25397) {\n            int64_t x_25396 = ((__global int64_t *) mem_28304)[write_i_26831];\n            int64_t res_25400 = sub64(x_25396, 1);\n            \n            res_25399 = res_25400;\n        } else {\n            res_25399 = -1;\n        }\n        if (sle64(0, res_25399) && slt64(res_25399, num_segments_25384)) {\n            ((__global float *) mem_28306)[res_25399] = write_value_25398;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26835\n}\n__kernel void mainzisegmap_26870(__global int *global_failure, int64_t n_24721,\n                                 int64_t paths_24724, __global\n                                 unsigned char *mem_28316, __global\n                                 unsigned char *mem_28319)\n{\n    #define segmap_group_sizze_26949 (mainzisegmap_group_sizze_26872)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2",
                   ";\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29178;\n    int32_t local_tid_29179;\n    int64_t group_sizze_29182;\n    int32_t wave_sizze_29181;\n    int32_t group_tid_29180;\n    \n    global_tid_29178 = get_global_id(0);\n    local_tid_29179 = get_local_id(0);\n    group_sizze_29182 = get_local_size(0);\n    wave_sizze_29181 = LOCKSTEP_WIDTH;\n    group_tid_29180 = get_group_id(0);\n    \n    int32_t phys_tid_26870;\n    \n    phys_tid_26870 = global_tid_29178;\n    \n    int64_t gtid_26869;\n    \n    gtid_26869 = sext_i32_i64(group_tid_29180) * segmap_group_sizze_26949 +\n        sext_i32_i64(local_tid_29179);\n    if (slt64(gtid_26869, paths_24724)) {\n        float res_26953;\n        float redout_28171 = 0.0F;\n        \n        for (int64_t i_28172 = 0; i_28172 < n_24721; i_28172++) {\n            float x_26957 = ((__global float *) mem_28316)[i_28172 *\n                                                           paths_24724 +\n                                                           gtid_26869];\n            float res_26956 = x_26957 + redout_28171;\n            float redout_tmp_29183 = res_26956;\n            \n            redout_28171 = redout_tmp_29183;\n        }\n        res_26953 = redout_28171;\n        \n        float res_26958 = fmax32(0.0F, res_26953);\n        \n        ((__global float *) mem_28319)[gtid_26869] = res_26958;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26949\n}\n__kernel void mainzisegmap_26895(__global int *global_failure,\n                                 int64_t paths_24724, __global\n                                 unsigned char *mem_28322, __global\n                                 unsigned char *mem_28325)\n{\n    #define segmap_group_sizze_26971 (mainzisegmap_group_sizze_26897)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29244;\n    int32_t local_tid_29245;\n    int64_t group_sizze_29",
                   "248;\n    int32_t wave_sizze_29247;\n    int32_t group_tid_29246;\n    \n    global_tid_29244 = get_global_id(0);\n    local_tid_29245 = get_local_id(0);\n    group_sizze_29248 = get_local_size(0);\n    wave_sizze_29247 = LOCKSTEP_WIDTH;\n    group_tid_29246 = get_group_id(0);\n    \n    int32_t phys_tid_26895;\n    \n    phys_tid_26895 = global_tid_29244;\n    \n    int64_t gtid_26894;\n    \n    gtid_26894 = sext_i32_i64(group_tid_29246) * segmap_group_sizze_26971 +\n        sext_i32_i64(local_tid_29245);\n    if (slt64(gtid_26894, paths_24724)) {\n        float res_26974 = ((__global float *) mem_28322)[gtid_26894];\n        float res_26975 = fmax32(0.0F, res_26974);\n        \n        ((__global float *) mem_28325)[gtid_26894] = res_26975;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26971\n}\n__kernel void mainzisegred_large_26911(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_29221_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_29219_backing_aligned_1,\n                                       int64_t n_24721,\n                                       int64_t num_groups_26962, __global\n                                       unsigned char *mem_28306, __global\n                                       unsigned char *mem_28322,\n                                       int64_t groups_per_segment_29205,\n                                       int64_t elements_per_thread_29206,\n                                       int64_t virt_num_groups_29207,\n                                       int64_t threads_per_segment_29209,\n                                       __global\n                                       unsigned char *group_res_arr_mem_29210,\n                                       __global\n                                       unsigned char *mainzicounter_mem_29212)\n{\n    #define segred_group_siz",
                   "ze_26961 (mainzisegred_group_sizze_26905)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_29221_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_29221_backing_aligned_0;\n    __local volatile char *restrict red_arr_mem_29219_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_29219_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29214;\n    int32_t local_tid_29215;\n    int64_t group_sizze_29218;\n    int32_t wave_sizze_29217;\n    int32_t group_tid_29216;\n    \n    global_tid_29214 = get_global_id(0);\n    local_tid_29215 = get_local_id(0);\n    group_sizze_29218 = get_local_size(0);\n    wave_sizze_29217 = LOCKSTEP_WIDTH;\n    group_tid_29216 = get_group_id(0);\n    \n    int32_t phys_tid_26911;\n    \n    phys_tid_26911 = global_tid_29214;\n    \n    __local char *red_arr_mem_29219;\n    \n    red_arr_mem_29219 = (__local char *) red_arr_mem_29219_backing_0;\n    \n    __local char *sync_arr_mem_29221;\n    \n    sync_arr_mem_29221 = (__local char *) sync_arr_mem_29221_backing_1;\n    \n    int32_t phys_group_id_29223;\n    \n    phys_group_id_29223 = get_group_id(0);\n    for (int32_t i_29224 = 0; i_29224 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_29207) - phys_group_id_29223,\n                   sext_i64_i32(num_groups_26962)); i_29224++) {\n        int32_t virt_group_id_29225 = phys_group_id_29223 + i_29224 *\n                sext_i64_i32(num_groups_26962);\n        int32_t flat_segment_id_29226 = squot32(virt_group_id_29225,\n                                                sext_i64_i32(groups_per_segment_29205));\n        int64_t global_tid_29227 = srem64(sext_i32_i64(virt_group_id_29225) *\n                                          segred_group_sizze_26961 +\n                                          sext_i32_i64(local_tid_29215),\n       ",
                   "                                   segred_group_sizze_26961 *\n                                          groups_per_segment_29205);\n        int64_t gtid_26902 = sext_i32_i64(flat_segment_id_29226);\n        int64_t gtid_26910;\n        float x_acc_29228;\n        int64_t chunk_sizze_29229;\n        \n        chunk_sizze_29229 = smin64(elements_per_thread_29206,\n                                   sdiv_up64(n_24721 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_29227)),\n                                             threads_per_segment_29209));\n        \n        float x_26965;\n        float x_26966;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_29228 = 0.0F;\n        }\n        for (int64_t i_29233 = 0; i_29233 < chunk_sizze_29229; i_29233++) {\n            gtid_26910 = sext_i32_i64(sext_i64_i32(global_tid_29227)) +\n                threads_per_segment_29209 * i_29233;\n            // apply map function\n            {\n                int64_t binop_x_28132 = n_24721 * gtid_26902;\n                int64_t new_index_28133 = gtid_26910 + binop_x_28132;\n                float x_26969 = ((__global float *) mem_28306)[new_index_28133];\n                \n                // save map-out results\n                { }\n                // load accumulator\n                {\n                    x_26965 = x_acc_29228;\n                }\n                // load new values\n                {\n                    x_26966 = x_26969;\n                }\n                // apply reduction operator\n                {\n                    float res_26967 = x_26965 + x_26966;\n                    \n                    // store in accumulator\n                    {\n                        x_acc_29228 = res_26967;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_26965 = x_acc_29228;\n            ((__local\n              float *) red_arr_mem_29219",
                   ")[sext_i32_i64(local_tid_29215)] =\n                x_26965;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_29234;\n        int32_t skip_waves_29235;\n        \n        skip_waves_29235 = 1;\n        \n        float x_29230;\n        float x_29231;\n        \n        offset_29234 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_29215,\n                      sext_i64_i32(segred_group_sizze_26961))) {\n                x_29230 = ((__local\n                            float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215 +\n                                                        offset_29234)];\n            }\n        }\n        offset_29234 = 1;\n        while (slt32(offset_29234, wave_sizze_29217)) {\n            if (slt32(local_tid_29215 + offset_29234,\n                      sext_i64_i32(segred_group_sizze_26961)) &&\n                ((local_tid_29215 - squot32(local_tid_29215, wave_sizze_29217) *\n                  wave_sizze_29217) & (2 * offset_29234 - 1)) == 0) {\n                // read array element\n                {\n                    x_29231 = ((volatile __local\n                                float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215 +\n                                                            offset_29234)];\n                }\n                // apply reduction operation\n                {\n                    float res_29232 = x_29230 + x_29231;\n                    \n                    x_29230 = res_29232;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215)] =\n                        x_29230;\n                }\n            }\n            offset_29234 *= 2;\n        }\n        while (slt32(skip_waves_29235,\n                     squot32(sext_i64_i32(segred_group_sizze_26961) +\n                             wave_sizze_29217 - 1, wave_s",
                   "izze_29217))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_29234 = skip_waves_29235 * wave_sizze_29217;\n            if (slt32(local_tid_29215 + offset_29234,\n                      sext_i64_i32(segred_group_sizze_26961)) &&\n                ((local_tid_29215 - squot32(local_tid_29215, wave_sizze_29217) *\n                  wave_sizze_29217) == 0 && (squot32(local_tid_29215,\n                                                     wave_sizze_29217) & (2 *\n                                                                          skip_waves_29235 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_29231 = ((__local\n                                float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215 +\n                                                            offset_29234)];\n                }\n                // apply reduction operation\n                {\n                    float res_29232 = x_29230 + x_29231;\n                    \n                    x_29230 = res_29232;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215)] =\n                        x_29230;\n                }\n            }\n            skip_waves_29235 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_29215) == 0) {\n                x_acc_29228 = x_29230;\n            }\n        }\n        if (groups_per_segment_29205 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_29215 == 0) {\n                    ((__global float *) mem_28322)[gtid_26902] = x_acc_29228;\n                }\n            }\n        } else {\n            int32_t old_counter_29236;\n          ",
                   "  \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_29215 == 0) {\n                    ((__global\n                      float *) group_res_arr_mem_29210)[sext_i32_i64(virt_group_id_29225) *\n                                                        segred_group_sizze_26961] =\n                        x_acc_29228;\n                    mem_fence_global();\n                    old_counter_29236 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_29212)[sext_i32_i64(srem32(flat_segment_id_29226,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_29221)[0] =\n                        old_counter_29236 == groups_per_segment_29205 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_29237;\n            \n            is_last_group_29237 = ((__local bool *) sync_arr_mem_29221)[0];\n            if (is_last_group_29237) {\n                if (local_tid_29215 == 0) {\n                    old_counter_29236 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_29212)[sext_i32_i64(srem32(flat_segment_id_29226,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_29205));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_29238 =\n                            sdiv_up64(groups_per_segment_29205,\n                                      segred_",
                   "group_sizze_26961);\n                    \n                    x_26965 = 0.0F;\n                    for (int64_t i_29239 = 0; i_29239 < read_per_thread_29238;\n                         i_29239++) {\n                        int64_t group_res_id_29240 =\n                                sext_i32_i64(local_tid_29215) *\n                                read_per_thread_29238 + i_29239;\n                        int64_t index_of_group_res_29241 =\n                                sext_i32_i64(flat_segment_id_29226) *\n                                groups_per_segment_29205 + group_res_id_29240;\n                        \n                        if (slt64(group_res_id_29240,\n                                  groups_per_segment_29205)) {\n                            x_26966 = ((__global\n                                        float *) group_res_arr_mem_29210)[index_of_group_res_29241 *\n                                                                          segred_group_sizze_26961];\n                            \n                            float res_26967;\n                            \n                            res_26967 = x_26965 + x_26966;\n                            x_26965 = res_26967;\n                        }\n                    }\n                }\n                ((__local\n                  float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215)] =\n                    x_26965;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_29242;\n                    int32_t skip_waves_29243;\n                    \n                    skip_waves_29243 = 1;\n                    \n                    float x_29230;\n                    float x_29231;\n                    \n                    offset_29242 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_29215,\n                                  sext_i64_i32(segred_gr",
                   "oup_sizze_26961))) {\n                            x_29230 = ((__local\n                                        float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215 +\n                                                                    offset_29242)];\n                        }\n                    }\n                    offset_29242 = 1;\n                    while (slt32(offset_29242, wave_sizze_29217)) {\n                        if (slt32(local_tid_29215 + offset_29242,\n                                  sext_i64_i32(segred_group_sizze_26961)) &&\n                            ((local_tid_29215 - squot32(local_tid_29215,\n                                                        wave_sizze_29217) *\n                              wave_sizze_29217) & (2 * offset_29242 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_29231 = ((volatile __local\n                                            float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215 +\n                                                                        offset_29242)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_29232 = x_29230 + x_29231;\n                                \n                                x_29230 = res_29232;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215)] =\n                                    x_29230;\n                            }\n                        }\n                        offset_29242 *= 2;\n                    }\n                    while (slt32(skip_waves_29243,\n                                 squot32(sext_i64_i32(segred_group_sizze_26961) +\n                          ",
                   "               wave_sizze_29217 - 1,\n                                         wave_sizze_29217))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_29242 = skip_waves_29243 * wave_sizze_29217;\n                        if (slt32(local_tid_29215 + offset_29242,\n                                  sext_i64_i32(segred_group_sizze_26961)) &&\n                            ((local_tid_29215 - squot32(local_tid_29215,\n                                                        wave_sizze_29217) *\n                              wave_sizze_29217) == 0 &&\n                             (squot32(local_tid_29215, wave_sizze_29217) & (2 *\n                                                                            skip_waves_29243 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_29231 = ((__local\n                                            float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215 +\n                                                                        offset_29242)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_29232 = x_29230 + x_29231;\n                                \n                                x_29230 = res_29232;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215)] =\n                                    x_29230;\n                            }\n                        }\n                        skip_waves_29243 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        ",
                   "if (local_tid_29215 == 0) {\n                            ((__global float *) mem_28322)[gtid_26902] =\n                                x_29230;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_26961\n}\n__kernel void mainzisegred_large_28820(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_28858_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_28856_backing_aligned_1,\n                                       int64_t res_25191,\n                                       int64_t num_groups_26744, __global\n                                       unsigned char *mem_28283,\n                                       int32_t num_subhistos_28734, __global\n                                       unsigned char *res_subhistos_mem_28735,\n                                       int64_t groups_per_segment_28842,\n                                       int64_t elements_per_thread_28843,\n                                       int64_t virt_num_groups_28844,\n                                       int64_t threads_per_segment_28846,\n                                       __global\n                                       unsigned char *group_res_arr_mem_28847,\n                                       __global\n                                       unsigned char *mainzicounter_mem_28849)\n{\n    #define seghist_group_sizze_26742 (mainziseghist_group_sizze_26741)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_28858_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_28858_backing_aligned_0;\n    __local volatile char *restr",
                   "ict red_arr_mem_28856_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28856_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28851;\n    int32_t local_tid_28852;\n    int64_t group_sizze_28855;\n    int32_t wave_sizze_28854;\n    int32_t group_tid_28853;\n    \n    global_tid_28851 = get_global_id(0);\n    local_tid_28852 = get_local_id(0);\n    group_sizze_28855 = get_local_size(0);\n    wave_sizze_28854 = LOCKSTEP_WIDTH;\n    group_tid_28853 = get_group_id(0);\n    \n    int32_t flat_gtid_28820;\n    \n    flat_gtid_28820 = global_tid_28851;\n    \n    __local char *red_arr_mem_28856;\n    \n    red_arr_mem_28856 = (__local char *) red_arr_mem_28856_backing_0;\n    \n    __local char *sync_arr_mem_28858;\n    \n    sync_arr_mem_28858 = (__local char *) sync_arr_mem_28858_backing_1;\n    \n    int32_t phys_group_id_28860;\n    \n    phys_group_id_28860 = get_group_id(0);\n    for (int32_t i_28861 = 0; i_28861 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_28844) - phys_group_id_28860,\n                   sext_i64_i32(num_groups_26744)); i_28861++) {\n        int32_t virt_group_id_28862 = phys_group_id_28860 + i_28861 *\n                sext_i64_i32(num_groups_26744);\n        int32_t flat_segment_id_28863 = squot32(virt_group_id_28862,\n                                                sext_i64_i32(groups_per_segment_28842));\n        int64_t global_tid_28864 = srem64(sext_i32_i64(virt_group_id_28862) *\n                                          seghist_group_sizze_26742 +\n                                          sext_i32_i64(local_tid_28852),\n                                          seghist_group_sizze_26742 *\n                                          groups_per_segment_28842);\n        int64_t bucket_id_28818 = sext_i32_i64(flat_segment_id_28863);\n        int64_t subhistogram_id_28819;\n        int64_t x_acc_28865;\n        int64_t chunk_sizze_28866;\n        \n        chunk_sizze_28866 = smin64(",
                   "elements_per_thread_28843,\n                                   sdiv_up64(num_subhistos_28734 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_28864)),\n                                             threads_per_segment_28846));\n        \n        int64_t x_26748;\n        int64_t x_26749;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_28865 = 0;\n        }\n        for (int64_t i_28870 = 0; i_28870 < chunk_sizze_28866; i_28870++) {\n            subhistogram_id_28819 =\n                sext_i32_i64(sext_i64_i32(global_tid_28864)) +\n                threads_per_segment_28846 * i_28870;\n            // apply map function\n            {\n                // load accumulator\n                {\n                    x_26748 = x_acc_28865;\n                }\n                // load new values\n                {\n                    x_26749 = ((__global\n                                int64_t *) res_subhistos_mem_28735)[subhistogram_id_28819 *\n                                                                    res_25191 +\n                                                                    bucket_id_28818];\n                }\n                // apply reduction operator\n                {\n                    int64_t res_26750 = smax64(x_26748, x_26749);\n                    \n                    // store in accumulator\n                    {\n                        x_acc_28865 = res_26750;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_26748 = x_acc_28865;\n            ((__local\n              int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852)] =\n                x_26748;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_28871;\n        int32_t skip_waves_28872;\n        \n        skip_waves_28872 = 1;\n        \n        int64_t x_28867;\n        int64_t x_28868;\n        \n        offset_28871 =",
                   " 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_28852,\n                      sext_i64_i32(seghist_group_sizze_26742))) {\n                x_28867 = ((__local\n                            int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852 +\n                                                          offset_28871)];\n            }\n        }\n        offset_28871 = 1;\n        while (slt32(offset_28871, wave_sizze_28854)) {\n            if (slt32(local_tid_28852 + offset_28871,\n                      sext_i64_i32(seghist_group_sizze_26742)) &&\n                ((local_tid_28852 - squot32(local_tid_28852, wave_sizze_28854) *\n                  wave_sizze_28854) & (2 * offset_28871 - 1)) == 0) {\n                // read array element\n                {\n                    x_28868 = ((volatile __local\n                                int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852 +\n                                                              offset_28871)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_28869 = smax64(x_28867, x_28868);\n                    \n                    x_28867 = res_28869;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852)] =\n                        x_28867;\n                }\n            }\n            offset_28871 *= 2;\n        }\n        while (slt32(skip_waves_28872,\n                     squot32(sext_i64_i32(seghist_group_sizze_26742) +\n                             wave_sizze_28854 - 1, wave_sizze_28854))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_28871 = skip_waves_28872 * wave_sizze_28854;\n            if (slt32(local_tid_28852 + offset_28871,\n                      sext_i64_i32(seghist_group_sizze_26742)) &&\n                ((local_tid_28852 - squot3",
                   "2(local_tid_28852, wave_sizze_28854) *\n                  wave_sizze_28854) == 0 && (squot32(local_tid_28852,\n                                                     wave_sizze_28854) & (2 *\n                                                                          skip_waves_28872 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_28868 = ((__local\n                                int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852 +\n                                                              offset_28871)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_28869 = smax64(x_28867, x_28868);\n                    \n                    x_28867 = res_28869;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852)] =\n                        x_28867;\n                }\n            }\n            skip_waves_28872 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_28852) == 0) {\n                x_acc_28865 = x_28867;\n            }\n        }\n        if (groups_per_segment_28842 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_28852 == 0) {\n                    ((__global int64_t *) mem_28283)[bucket_id_28818] =\n                        x_acc_28865;\n                }\n            }\n        } else {\n            int32_t old_counter_28873;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_28852 == 0) {\n                    ((__global\n                      int64_t *) group_res_arr_mem_28847)[sext_i32_i64(v",
                   "irt_group_id_28862) *\n                                                          seghist_group_sizze_26742] =\n                        x_acc_28865;\n                    mem_fence_global();\n                    old_counter_28873 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_28849)[sext_i32_i64(srem32(flat_segment_id_28863,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_28858)[0] =\n                        old_counter_28873 == groups_per_segment_28842 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_28874;\n            \n            is_last_group_28874 = ((__local bool *) sync_arr_mem_28858)[0];\n            if (is_last_group_28874) {\n                if (local_tid_28852 == 0) {\n                    old_counter_28873 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_28849)[sext_i32_i64(srem32(flat_segment_id_28863,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_28842));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_28875 =\n                            sdiv_up64(groups_per_segment_28842,\n                                      seghist_group_sizze_26742);\n                    \n                    x_26748 = 0;\n                    for (int64_t i_28876 = 0; i_28876 < read_per_thread_28875;\n                         i_28876++) {\n                        int64_t group_re",
                   "s_id_28877 =\n                                sext_i32_i64(local_tid_28852) *\n                                read_per_thread_28875 + i_28876;\n                        int64_t index_of_group_res_28878 =\n                                sext_i32_i64(flat_segment_id_28863) *\n                                groups_per_segment_28842 + group_res_id_28877;\n                        \n                        if (slt64(group_res_id_28877,\n                                  groups_per_segment_28842)) {\n                            x_26749 = ((__global\n                                        int64_t *) group_res_arr_mem_28847)[index_of_group_res_28878 *\n                                                                            seghist_group_sizze_26742];\n                            \n                            int64_t res_26750;\n                            \n                            res_26750 = smax64(x_26748, x_26749);\n                            x_26748 = res_26750;\n                        }\n                    }\n                }\n                ((__local\n                  int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852)] =\n                    x_26748;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_28879;\n                    int32_t skip_waves_28880;\n                    \n                    skip_waves_28880 = 1;\n                    \n                    int64_t x_28867;\n                    int64_t x_28868;\n                    \n                    offset_28879 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_28852,\n                                  sext_i64_i32(seghist_group_sizze_26742))) {\n                            x_28867 = ((__local\n                                        int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852 +\n                                           ",
                   "                           offset_28879)];\n                        }\n                    }\n                    offset_28879 = 1;\n                    while (slt32(offset_28879, wave_sizze_28854)) {\n                        if (slt32(local_tid_28852 + offset_28879,\n                                  sext_i64_i32(seghist_group_sizze_26742)) &&\n                            ((local_tid_28852 - squot32(local_tid_28852,\n                                                        wave_sizze_28854) *\n                              wave_sizze_28854) & (2 * offset_28879 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_28868 = ((volatile __local\n                                            int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852 +\n                                                                          offset_28879)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_28869 = smax64(x_28867, x_28868);\n                                \n                                x_28867 = res_28869;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852)] =\n                                    x_28867;\n                            }\n                        }\n                        offset_28879 *= 2;\n                    }\n                    while (slt32(skip_waves_28880,\n                                 squot32(sext_i64_i32(seghist_group_sizze_26742) +\n                                         wave_sizze_28854 - 1,\n                                         wave_sizze_28854))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_28879 =",
                   " skip_waves_28880 * wave_sizze_28854;\n                        if (slt32(local_tid_28852 + offset_28879,\n                                  sext_i64_i32(seghist_group_sizze_26742)) &&\n                            ((local_tid_28852 - squot32(local_tid_28852,\n                                                        wave_sizze_28854) *\n                              wave_sizze_28854) == 0 &&\n                             (squot32(local_tid_28852, wave_sizze_28854) & (2 *\n                                                                            skip_waves_28880 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_28868 = ((__local\n                                            int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852 +\n                                                                          offset_28879)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_28869 = smax64(x_28867, x_28868);\n                                \n                                x_28867 = res_28869;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852)] =\n                                    x_28867;\n                            }\n                        }\n                        skip_waves_28880 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_28852 == 0) {\n                            ((__global int64_t *) mem_28283)[bucket_id_28818] =\n                                x_28867;\n                        }\n ",
                   "                   }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_26742\n}\n__kernel void mainzisegred_nonseg_25885(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28522_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28520_backing_aligned_1,\n                                        int64_t n_24721,\n                                        int64_t num_groups_25880, __global\n                                        unsigned char *swap_term_mem_28181,\n                                        __global\n                                        unsigned char *payments_mem_28182,\n                                        __global unsigned char *mem_28186,\n                                        __global\n                                        unsigned char *mainzicounter_mem_28510,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28512,\n                                        int64_t num_threads_28514)\n{\n    #define segred_group_sizze_25878 (mainzisegred_group_sizze_25877)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28522_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28522_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28520_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28520_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28515;\n    int32_t local_tid_28516;\n    int64_t group_sizze_28519;\n    int32_t wave_sizze_28518;\n    i",
                   "nt32_t group_tid_28517;\n    \n    global_tid_28515 = get_global_id(0);\n    local_tid_28516 = get_local_id(0);\n    group_sizze_28519 = get_local_size(0);\n    wave_sizze_28518 = LOCKSTEP_WIDTH;\n    group_tid_28517 = get_group_id(0);\n    \n    int32_t phys_tid_25885;\n    \n    phys_tid_25885 = global_tid_28515;\n    \n    __local char *sync_arr_mem_28520;\n    \n    sync_arr_mem_28520 = (__local char *) sync_arr_mem_28520_backing_0;\n    \n    __local char *red_arr_mem_28522;\n    \n    red_arr_mem_28522 = (__local char *) red_arr_mem_28522_backing_1;\n    \n    int64_t dummy_25883;\n    \n    dummy_25883 = 0;\n    \n    int64_t gtid_25884;\n    \n    gtid_25884 = 0;\n    \n    float x_acc_28524;\n    int64_t chunk_sizze_28525;\n    \n    chunk_sizze_28525 = smin64(sdiv_up64(n_24721,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_25878 *\n                                         num_groups_25880))),\n                               sdiv_up64(n_24721 - sext_i32_i64(phys_tid_25885),\n                                         num_threads_28514));\n    \n    float x_24739;\n    float x_24740;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28524 = -INFINITY;\n    }\n    for (int64_t i_28529 = 0; i_28529 < chunk_sizze_28525; i_28529++) {\n        gtid_25884 = sext_i32_i64(phys_tid_25885) + num_threads_28514 * i_28529;\n        // apply map function\n        {\n            float x_24742 = ((__global\n                              float *) swap_term_mem_28181)[gtid_25884];\n            int64_t x_24743 = ((__global\n                                int64_t *) payments_mem_28182)[gtid_25884];\n            float res_24744 = sitofp_i64_f32(x_24743);\n            float res_24745 = x_24742 * res_24744;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_24739 = x_acc_28524;\n            }\n            // load new values\n            {\n                x_24740 = res_24745;\n            }\n         ",
                   "   // apply reduction operator\n            {\n                float res_24741 = fmax32(x_24739, x_24740);\n                \n                // store in accumulator\n                {\n                    x_acc_28524 = res_24741;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_24739 = x_acc_28524;\n        ((__local float *) red_arr_mem_28522)[sext_i32_i64(local_tid_28516)] =\n            x_24739;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28530;\n    int32_t skip_waves_28531;\n    \n    skip_waves_28531 = 1;\n    \n    float x_28526;\n    float x_28527;\n    \n    offset_28530 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28516, sext_i64_i32(segred_group_sizze_25878))) {\n            x_28526 = ((__local\n                        float *) red_arr_mem_28522)[sext_i32_i64(local_tid_28516 +\n                                                    offset_28530)];\n        }\n    }\n    offset_28530 = 1;\n    while (slt32(offset_28530, wave_sizze_28518)) {\n        if (slt32(local_tid_28516 + offset_28530,\n                  sext_i64_i32(segred_group_sizze_25878)) && ((local_tid_28516 -\n                                                               squot32(local_tid_28516,\n                                                                       wave_sizze_28518) *\n                                                               wave_sizze_28518) &\n                                                              (2 *\n                                                               offset_28530 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28527 = ((volatile __local\n                            float *) red_arr_mem_28522)[sext_i32_i64(local_tid_28516 +\n                                                        offset_28530)];\n            }\n            // apply reduction op",
                   "eration\n            {\n                float res_28528 = fmax32(x_28526, x_28527);\n                \n                x_28526 = res_28528;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_28522)[sext_i32_i64(local_tid_28516)] =\n                    x_28526;\n            }\n        }\n        offset_28530 *= 2;\n    }\n    while (slt32(skip_waves_28531,\n                 squot32(sext_i64_i32(segred_group_sizze_25878) +\n                         wave_sizze_28518 - 1, wave_sizze_28518))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28530 = skip_waves_28531 * wave_sizze_28518;\n        if (slt32(local_tid_28516 + offset_28530,\n                  sext_i64_i32(segred_group_sizze_25878)) && ((local_tid_28516 -\n                                                               squot32(local_tid_28516,\n                                                                       wave_sizze_28518) *\n                                                               wave_sizze_28518) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28516,\n                                                                       wave_sizze_28518) &\n                                                               (2 *\n                                                                skip_waves_28531 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28527 = ((__local\n                            float *) red_arr_mem_28522)[sext_i32_i64(local_tid_28516 +\n                                                        offset_28530)];\n            }\n            // apply reduction operation\n            {\n                float res_28528 = fmax32(x_28526, x_28527);\n                \n                x_28526 = res_28528;\n            }\n            // writ",
                   "e result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_28522)[sext_i32_i64(local_tid_28516)] =\n                    x_28526;\n            }\n        }\n        skip_waves_28531 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28516) == 0) {\n            x_acc_28524 = x_28526;\n        }\n    }\n    \n    int32_t old_counter_28532;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28516 == 0) {\n            ((__global\n              float *) group_res_arr_mem_28512)[sext_i32_i64(group_tid_28517) *\n                                                segred_group_sizze_25878] =\n                x_acc_28524;\n            mem_fence_global();\n            old_counter_28532 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28510)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28520)[0] = old_counter_28532 ==\n                num_groups_25880 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28533;\n    \n    is_last_group_28533 = ((__local bool *) sync_arr_mem_28520)[0];\n    if (is_last_group_28533) {\n        if (local_tid_28516 == 0) {\n            old_counter_28532 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28510)[0],\n                                                      (int) (0 -\n                                                             num_groups_25880));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28534 = sdiv_up64(num_groups_25880,\n                                                      segred_group_sizze_25878);\n            \n            x_24739 = -INFINITY;\n            for (int",
                   "64_t i_28535 = 0; i_28535 < read_per_thread_28534;\n                 i_28535++) {\n                int64_t group_res_id_28536 = sext_i32_i64(local_tid_28516) *\n                        read_per_thread_28534 + i_28535;\n                int64_t index_of_group_res_28537 = group_res_id_28536;\n                \n                if (slt64(group_res_id_28536, num_groups_25880)) {\n                    x_24740 = ((__global\n                                float *) group_res_arr_mem_28512)[index_of_group_res_28537 *\n                                                                  segred_group_sizze_25878];\n                    \n                    float res_24741;\n                    \n                    res_24741 = fmax32(x_24739, x_24740);\n                    x_24739 = res_24741;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_28522)[sext_i32_i64(local_tid_28516)] =\n            x_24739;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28538;\n            int32_t skip_waves_28539;\n            \n            skip_waves_28539 = 1;\n            \n            float x_28526;\n            float x_28527;\n            \n            offset_28538 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28516,\n                          sext_i64_i32(segred_group_sizze_25878))) {\n                    x_28526 = ((__local\n                                float *) red_arr_mem_28522)[sext_i32_i64(local_tid_28516 +\n                                                            offset_28538)];\n                }\n            }\n            offset_28538 = 1;\n            while (slt32(offset_28538, wave_sizze_28518)) {\n                if (slt32(local_tid_28516 + offset_28538,\n                          sext_i64_i32(segred_group_sizze_25878)) &&\n                    ((local_tid_28516 - squot32(local_tid_28516,\n                                                wave_sizz",
                   "e_28518) *\n                      wave_sizze_28518) & (2 * offset_28538 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28527 = ((volatile __local\n                                    float *) red_arr_mem_28522)[sext_i32_i64(local_tid_28516 +\n                                                                offset_28538)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28528 = fmax32(x_28526, x_28527);\n                        \n                        x_28526 = res_28528;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_28522)[sext_i32_i64(local_tid_28516)] =\n                            x_28526;\n                    }\n                }\n                offset_28538 *= 2;\n            }\n            while (slt32(skip_waves_28539,\n                         squot32(sext_i64_i32(segred_group_sizze_25878) +\n                                 wave_sizze_28518 - 1, wave_sizze_28518))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28538 = skip_waves_28539 * wave_sizze_28518;\n                if (slt32(local_tid_28516 + offset_28538,\n                          sext_i64_i32(segred_group_sizze_25878)) &&\n                    ((local_tid_28516 - squot32(local_tid_28516,\n                                                wave_sizze_28518) *\n                      wave_sizze_28518) == 0 && (squot32(local_tid_28516,\n                                                         wave_sizze_28518) &\n                                                 (2 * skip_waves_28539 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28527 = ((__local\n                                    float *) red_arr_mem_28522)[sext_i32_i64(local_tid_28516 +\n              ",
                   "                                                  offset_28538)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28528 = fmax32(x_28526, x_28527);\n                        \n                        x_28526 = res_28528;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_28522)[sext_i32_i64(local_tid_28516)] =\n                            x_28526;\n                    }\n                }\n                skip_waves_28539 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28516 == 0) {\n                    ((__global float *) mem_28186)[0] = x_28526;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_25878\n}\n__kernel void mainzisegred_nonseg_26739(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28707_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28705_backing_aligned_1,\n                                        int64_t flat_dim_24906,\n                                        int64_t num_groups_26734, __global\n                                        unsigned char *mem_28278, __global\n                                        unsigned char *mem_28281, __global\n                                        unsigned char *mainzicounter_mem_28695,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28697,\n                                        int64_t num_threads_28699)\n{\n    #define segred_group_sizze_26732 (mainzisegred_group_sizze_26731)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    con",
                   "st int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28707_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28707_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28705_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28705_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28700;\n    int32_t local_tid_28701;\n    int64_t group_sizze_28704;\n    int32_t wave_sizze_28703;\n    int32_t group_tid_28702;\n    \n    global_tid_28700 = get_global_id(0);\n    local_tid_28701 = get_local_id(0);\n    group_sizze_28704 = get_local_size(0);\n    wave_sizze_28703 = LOCKSTEP_WIDTH;\n    group_tid_28702 = get_group_id(0);\n    \n    int32_t phys_tid_26739;\n    \n    phys_tid_26739 = global_tid_28700;\n    \n    __local char *sync_arr_mem_28705;\n    \n    sync_arr_mem_28705 = (__local char *) sync_arr_mem_28705_backing_0;\n    \n    __local char *red_arr_mem_28707;\n    \n    red_arr_mem_28707 = (__local char *) red_arr_mem_28707_backing_1;\n    \n    int64_t dummy_26737;\n    \n    dummy_26737 = 0;\n    \n    int64_t gtid_26738;\n    \n    gtid_26738 = 0;\n    \n    int64_t x_acc_28709;\n    int64_t chunk_sizze_28710;\n    \n    chunk_sizze_28710 = smin64(sdiv_up64(flat_dim_24906,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_26732 *\n                                         num_groups_26734))),\n                               sdiv_up64(flat_dim_24906 -\n                                         sext_i32_i64(phys_tid_26739),\n                                         num_threads_28699));\n    \n    int64_t x_25192;\n    int64_t x_25193;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28709 = 0;\n    }\n    for (int64_t i_28714 = 0; i_28714 < chunk_sizze_28710; i_28714++) {\n        gtid_26738 = sext_i32_i64(phys_tid_26739) + num_threads_28699 * i_28714;\n        // apply map ",
                   "function\n        {\n            int64_t x_25195 = ((__global int64_t *) mem_28278)[gtid_26738];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_25192 = x_acc_28709;\n            }\n            // load new values\n            {\n                x_25193 = x_25195;\n            }\n            // apply reduction operator\n            {\n                int64_t res_25194 = add64(x_25192, x_25193);\n                \n                // store in accumulator\n                {\n                    x_acc_28709 = res_25194;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_25192 = x_acc_28709;\n        ((__local int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701)] =\n            x_25192;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28715;\n    int32_t skip_waves_28716;\n    \n    skip_waves_28716 = 1;\n    \n    int64_t x_28711;\n    int64_t x_28712;\n    \n    offset_28715 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28701, sext_i64_i32(segred_group_sizze_26732))) {\n            x_28711 = ((__local\n                        int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701 +\n                                                      offset_28715)];\n        }\n    }\n    offset_28715 = 1;\n    while (slt32(offset_28715, wave_sizze_28703)) {\n        if (slt32(local_tid_28701 + offset_28715,\n                  sext_i64_i32(segred_group_sizze_26732)) && ((local_tid_28701 -\n                                                               squot32(local_tid_28701,\n                                                                       wave_sizze_28703) *\n                                                               wave_sizze_28703) &\n                                                              (2 *\n                                                               offset_28715 -\n ",
                   "                                                              1)) == 0) {\n            // read array element\n            {\n                x_28712 = ((volatile __local\n                            int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701 +\n                                                          offset_28715)];\n            }\n            // apply reduction operation\n            {\n                int64_t res_28713 = add64(x_28711, x_28712);\n                \n                x_28711 = res_28713;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701)] =\n                    x_28711;\n            }\n        }\n        offset_28715 *= 2;\n    }\n    while (slt32(skip_waves_28716,\n                 squot32(sext_i64_i32(segred_group_sizze_26732) +\n                         wave_sizze_28703 - 1, wave_sizze_28703))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28715 = skip_waves_28716 * wave_sizze_28703;\n        if (slt32(local_tid_28701 + offset_28715,\n                  sext_i64_i32(segred_group_sizze_26732)) && ((local_tid_28701 -\n                                                               squot32(local_tid_28701,\n                                                                       wave_sizze_28703) *\n                                                               wave_sizze_28703) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28701,\n                                                                       wave_sizze_28703) &\n                                                               (2 *\n                                                                skip_waves_28716 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28712 = ((__l",
                   "ocal\n                            int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701 +\n                                                          offset_28715)];\n            }\n            // apply reduction operation\n            {\n                int64_t res_28713 = add64(x_28711, x_28712);\n                \n                x_28711 = res_28713;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701)] =\n                    x_28711;\n            }\n        }\n        skip_waves_28716 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28701) == 0) {\n            x_acc_28709 = x_28711;\n        }\n    }\n    \n    int32_t old_counter_28717;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28701 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_28697)[sext_i32_i64(group_tid_28702) *\n                                                  segred_group_sizze_26732] =\n                x_acc_28709;\n            mem_fence_global();\n            old_counter_28717 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28695)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28705)[0] = old_counter_28717 ==\n                num_groups_26734 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28718;\n    \n    is_last_group_28718 = ((__local bool *) sync_arr_mem_28705)[0];\n    if (is_last_group_28718) {\n        if (local_tid_28701 == 0) {\n            old_counter_28717 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28695)[0],\n                                   ",
                   "                   (int) (0 -\n                                                             num_groups_26734));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28719 = sdiv_up64(num_groups_26734,\n                                                      segred_group_sizze_26732);\n            \n            x_25192 = 0;\n            for (int64_t i_28720 = 0; i_28720 < read_per_thread_28719;\n                 i_28720++) {\n                int64_t group_res_id_28721 = sext_i32_i64(local_tid_28701) *\n                        read_per_thread_28719 + i_28720;\n                int64_t index_of_group_res_28722 = group_res_id_28721;\n                \n                if (slt64(group_res_id_28721, num_groups_26734)) {\n                    x_25193 = ((__global\n                                int64_t *) group_res_arr_mem_28697)[index_of_group_res_28722 *\n                                                                    segred_group_sizze_26732];\n                    \n                    int64_t res_25194;\n                    \n                    res_25194 = add64(x_25192, x_25193);\n                    x_25192 = res_25194;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701)] =\n            x_25192;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28723;\n            int32_t skip_waves_28724;\n            \n            skip_waves_28724 = 1;\n            \n            int64_t x_28711;\n            int64_t x_28712;\n            \n            offset_28723 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28701,\n                          sext_i64_i32(segred_group_sizze_26732))) {\n                    x_28711 = ((__local\n                                int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701 +\n                                                   ",
                   "           offset_28723)];\n                }\n            }\n            offset_28723 = 1;\n            while (slt32(offset_28723, wave_sizze_28703)) {\n                if (slt32(local_tid_28701 + offset_28723,\n                          sext_i64_i32(segred_group_sizze_26732)) &&\n                    ((local_tid_28701 - squot32(local_tid_28701,\n                                                wave_sizze_28703) *\n                      wave_sizze_28703) & (2 * offset_28723 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28712 = ((volatile __local\n                                    int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701 +\n                                                                  offset_28723)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_28713 = add64(x_28711, x_28712);\n                        \n                        x_28711 = res_28713;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701)] =\n                            x_28711;\n                    }\n                }\n                offset_28723 *= 2;\n            }\n            while (slt32(skip_waves_28724,\n                         squot32(sext_i64_i32(segred_group_sizze_26732) +\n                                 wave_sizze_28703 - 1, wave_sizze_28703))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28723 = skip_waves_28724 * wave_sizze_28703;\n                if (slt32(local_tid_28701 + offset_28723,\n                          sext_i64_i32(segred_group_sizze_26732)) &&\n                    ((local_tid_28701 - squot32(local_tid_28701,\n                                                wave_sizze_28703) *\n                      wave_sizze_28703) == 0 && (squot32(local_tid_287",
                   "01,\n                                                         wave_sizze_28703) &\n                                                 (2 * skip_waves_28724 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28712 = ((__local\n                                    int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701 +\n                                                                  offset_28723)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_28713 = add64(x_28711, x_28712);\n                        \n                        x_28711 = res_28713;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701)] =\n                            x_28711;\n                    }\n                }\n                skip_waves_28724 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28701 == 0) {\n                    ((__global int64_t *) mem_28281)[0] = x_28711;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_26732\n}\n__kernel void mainzisegred_nonseg_26848(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29159_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29157_backing_aligned_1,\n                                        int64_t n_24721, int64_t paths_24724,\n                                        int64_t num_groups_26851, __global\n                                        unsigned char *mem_28310, __global\n                                        unsigned char *mem_28313, _",
                   "_global\n                                        unsigned char *mainzicounter_mem_29147,\n                                        __global\n                                        unsigned char *group_res_arr_mem_29149,\n                                        int64_t num_threads_29151)\n{\n    #define segred_group_sizze_26850 (mainzisegred_group_sizze_26840)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29159_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_29159_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_29157_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29157_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29152;\n    int32_t local_tid_29153;\n    int64_t group_sizze_29156;\n    int32_t wave_sizze_29155;\n    int32_t group_tid_29154;\n    \n    global_tid_29152 = get_global_id(0);\n    local_tid_29153 = get_local_id(0);\n    group_sizze_29156 = get_local_size(0);\n    wave_sizze_29155 = LOCKSTEP_WIDTH;\n    group_tid_29154 = get_group_id(0);\n    \n    int32_t phys_tid_26848;\n    \n    phys_tid_26848 = global_tid_29152;\n    \n    __local char *sync_arr_mem_29157;\n    \n    sync_arr_mem_29157 = (__local char *) sync_arr_mem_29157_backing_0;\n    \n    __local char *red_arr_mem_29159;\n    \n    red_arr_mem_29159 = (__local char *) red_arr_mem_29159_backing_1;\n    \n    int64_t dummy_26846;\n    \n    dummy_26846 = 0;\n    \n    int64_t gtid_26847;\n    \n    gtid_26847 = 0;\n    \n    float x_acc_29161;\n    int64_t chunk_sizze_29162;\n    \n    chunk_sizze_29162 = smin64(sdiv_up64(paths_24724,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_26850 *\n                                         num_groups_26851))),\n                               sdiv_up64(paths_24724 -\n                   ",
                   "                      sext_i32_i64(phys_tid_26848),\n                                         num_threads_29151));\n    \n    float x_26854;\n    float x_26855;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29161 = 0.0F;\n    }\n    for (int64_t i_29166 = 0; i_29166 < chunk_sizze_29162; i_29166++) {\n        gtid_26847 = sext_i32_i64(phys_tid_26848) + num_threads_29151 * i_29166;\n        // apply map function\n        {\n            float res_26858;\n            float redout_28169 = 0.0F;\n            \n            for (int64_t i_28170 = 0; i_28170 < n_24721; i_28170++) {\n                float x_26862 = ((__global float *) mem_28310)[i_28170 *\n                                                               paths_24724 +\n                                                               gtid_26847];\n                float res_26861 = x_26862 + redout_28169;\n                float redout_tmp_29167 = res_26861;\n                \n                redout_28169 = redout_tmp_29167;\n            }\n            res_26858 = redout_28169;\n            \n            float res_26863 = fmax32(0.0F, res_26858);\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_26854 = x_acc_29161;\n            }\n            // load new values\n            {\n                x_26855 = res_26863;\n            }\n            // apply reduction operator\n            {\n                float res_26856 = x_26854 + x_26855;\n                \n                // store in accumulator\n                {\n                    x_acc_29161 = res_26856;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_26854 = x_acc_29161;\n        ((__local float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153)] =\n            x_26854;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29168;\n    int32_t skip_waves_29169;\n    \n    skip_waves_29169 = 1;\n    \n    float x_291",
                   "63;\n    float x_29164;\n    \n    offset_29168 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29153, sext_i64_i32(segred_group_sizze_26850))) {\n            x_29163 = ((__local\n                        float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153 +\n                                                    offset_29168)];\n        }\n    }\n    offset_29168 = 1;\n    while (slt32(offset_29168, wave_sizze_29155)) {\n        if (slt32(local_tid_29153 + offset_29168,\n                  sext_i64_i32(segred_group_sizze_26850)) && ((local_tid_29153 -\n                                                               squot32(local_tid_29153,\n                                                                       wave_sizze_29155) *\n                                                               wave_sizze_29155) &\n                                                              (2 *\n                                                               offset_29168 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_29164 = ((volatile __local\n                            float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153 +\n                                                        offset_29168)];\n            }\n            // apply reduction operation\n            {\n                float res_29165 = x_29163 + x_29164;\n                \n                x_29163 = res_29165;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153)] =\n                    x_29163;\n            }\n        }\n        offset_29168 *= 2;\n    }\n    while (slt32(skip_waves_29169,\n                 squot32(sext_i64_i32(segred_group_sizze_26850) +\n                         wave_sizze_29155 - 1, wave_sizze_29155))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29168 ",
                   "= skip_waves_29169 * wave_sizze_29155;\n        if (slt32(local_tid_29153 + offset_29168,\n                  sext_i64_i32(segred_group_sizze_26850)) && ((local_tid_29153 -\n                                                               squot32(local_tid_29153,\n                                                                       wave_sizze_29155) *\n                                                               wave_sizze_29155) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29153,\n                                                                       wave_sizze_29155) &\n                                                               (2 *\n                                                                skip_waves_29169 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_29164 = ((__local\n                            float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153 +\n                                                        offset_29168)];\n            }\n            // apply reduction operation\n            {\n                float res_29165 = x_29163 + x_29164;\n                \n                x_29163 = res_29165;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153)] =\n                    x_29163;\n            }\n        }\n        skip_waves_29169 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29153) == 0) {\n            x_acc_29161 = x_29163;\n        }\n    }\n    \n    int32_t old_counter_29170;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29153 == 0) {\n            ((__global\n              float *) group_res_arr_mem_29149",
                   ")[sext_i32_i64(group_tid_29154) *\n                                                segred_group_sizze_26850] =\n                x_acc_29161;\n            mem_fence_global();\n            old_counter_29170 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29147)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29157)[0] = old_counter_29170 ==\n                num_groups_26851 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29171;\n    \n    is_last_group_29171 = ((__local bool *) sync_arr_mem_29157)[0];\n    if (is_last_group_29171) {\n        if (local_tid_29153 == 0) {\n            old_counter_29170 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29147)[0],\n                                                      (int) (0 -\n                                                             num_groups_26851));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29172 = sdiv_up64(num_groups_26851,\n                                                      segred_group_sizze_26850);\n            \n            x_26854 = 0.0F;\n            for (int64_t i_29173 = 0; i_29173 < read_per_thread_29172;\n                 i_29173++) {\n                int64_t group_res_id_29174 = sext_i32_i64(local_tid_29153) *\n                        read_per_thread_29172 + i_29173;\n                int64_t index_of_group_res_29175 = group_res_id_29174;\n                \n                if (slt64(group_res_id_29174, num_groups_26851)) {\n                    x_26855 = ((__global\n                                float *) group_res_arr_mem_29149)[index_of_group_res_29175 *\n                                                                  segred_group_sizze_26850];\n                    \n                    float re",
                   "s_26856;\n                    \n                    res_26856 = x_26854 + x_26855;\n                    x_26854 = res_26856;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153)] =\n            x_26854;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29176;\n            int32_t skip_waves_29177;\n            \n            skip_waves_29177 = 1;\n            \n            float x_29163;\n            float x_29164;\n            \n            offset_29176 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29153,\n                          sext_i64_i32(segred_group_sizze_26850))) {\n                    x_29163 = ((__local\n                                float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153 +\n                                                            offset_29176)];\n                }\n            }\n            offset_29176 = 1;\n            while (slt32(offset_29176, wave_sizze_29155)) {\n                if (slt32(local_tid_29153 + offset_29176,\n                          sext_i64_i32(segred_group_sizze_26850)) &&\n                    ((local_tid_29153 - squot32(local_tid_29153,\n                                                wave_sizze_29155) *\n                      wave_sizze_29155) & (2 * offset_29176 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_29164 = ((volatile __local\n                                    float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153 +\n                                                                offset_29176)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29165 = x_29163 + x_29164;\n                        \n                        x_29163 = res_29165;\n                    }\n                    // write r",
                   "esult of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153)] =\n                            x_29163;\n                    }\n                }\n                offset_29176 *= 2;\n            }\n            while (slt32(skip_waves_29177,\n                         squot32(sext_i64_i32(segred_group_sizze_26850) +\n                                 wave_sizze_29155 - 1, wave_sizze_29155))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29176 = skip_waves_29177 * wave_sizze_29155;\n                if (slt32(local_tid_29153 + offset_29176,\n                          sext_i64_i32(segred_group_sizze_26850)) &&\n                    ((local_tid_29153 - squot32(local_tid_29153,\n                                                wave_sizze_29155) *\n                      wave_sizze_29155) == 0 && (squot32(local_tid_29153,\n                                                         wave_sizze_29155) &\n                                                 (2 * skip_waves_29177 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_29164 = ((__local\n                                    float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153 +\n                                                                offset_29176)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29165 = x_29163 + x_29164;\n                        \n                        x_29163 = res_29165;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153)] =\n                            x_29163;\n                    }\n                }\n                skip_waves_29177 *= 2;\n            }\n            // and back to",
                   " memory with the final result\n            {\n                if (local_tid_29153 == 0) {\n                    ((__global float *) mem_28313)[0] = x_29163;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_26850\n}\n__kernel void mainzisegred_nonseg_26944(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29262_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29260_backing_aligned_1,\n                                        int64_t paths_24724,\n                                        int64_t num_groups_26979, __global\n                                        unsigned char *res_map_acc_mem_28326,\n                                        __global unsigned char *mem_28329,\n                                        __global\n                                        unsigned char *mainzicounter_mem_29250,\n                                        __global\n                                        unsigned char *group_res_arr_mem_29252,\n                                        int64_t num_threads_29254)\n{\n    #define segred_group_sizze_26978 (mainzisegred_group_sizze_26936)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29262_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_29262_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_29260_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29260_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29255;\n    int32_t local_tid_29256;\n    int64_t group_sizze_29259;\n    int32_t wave_sizze_29258;\n    int32_t group_tid_29257;\n    \n    global_tid_2925",
                   "5 = get_global_id(0);\n    local_tid_29256 = get_local_id(0);\n    group_sizze_29259 = get_local_size(0);\n    wave_sizze_29258 = LOCKSTEP_WIDTH;\n    group_tid_29257 = get_group_id(0);\n    \n    int32_t phys_tid_26944;\n    \n    phys_tid_26944 = global_tid_29255;\n    \n    __local char *sync_arr_mem_29260;\n    \n    sync_arr_mem_29260 = (__local char *) sync_arr_mem_29260_backing_0;\n    \n    __local char *red_arr_mem_29262;\n    \n    red_arr_mem_29262 = (__local char *) red_arr_mem_29262_backing_1;\n    \n    int64_t dummy_26942;\n    \n    dummy_26942 = 0;\n    \n    int64_t gtid_26943;\n    \n    gtid_26943 = 0;\n    \n    float x_acc_29264;\n    int64_t chunk_sizze_29265;\n    \n    chunk_sizze_29265 = smin64(sdiv_up64(paths_24724,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_26978 *\n                                         num_groups_26979))),\n                               sdiv_up64(paths_24724 -\n                                         sext_i32_i64(phys_tid_26944),\n                                         num_threads_29254));\n    \n    float x_26982;\n    float x_26983;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29264 = 0.0F;\n    }\n    for (int64_t i_29269 = 0; i_29269 < chunk_sizze_29265; i_29269++) {\n        gtid_26943 = sext_i32_i64(phys_tid_26944) + num_threads_29254 * i_29269;\n        // apply map function\n        {\n            float x_26985 = ((__global\n                              float *) res_map_acc_mem_28326)[gtid_26943];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_26982 = x_acc_29264;\n            }\n            // load new values\n            {\n                x_26983 = x_26985;\n            }\n            // apply reduction operator\n            {\n                float res_26984 = x_26982 + x_26983;\n                \n                // store in accumulator\n                {\n                    x_acc_29264 = res_26984;\n         ",
                   "       }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_26982 = x_acc_29264;\n        ((__local float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256)] =\n            x_26982;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29270;\n    int32_t skip_waves_29271;\n    \n    skip_waves_29271 = 1;\n    \n    float x_29266;\n    float x_29267;\n    \n    offset_29270 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29256, sext_i64_i32(segred_group_sizze_26978))) {\n            x_29266 = ((__local\n                        float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256 +\n                                                    offset_29270)];\n        }\n    }\n    offset_29270 = 1;\n    while (slt32(offset_29270, wave_sizze_29258)) {\n        if (slt32(local_tid_29256 + offset_29270,\n                  sext_i64_i32(segred_group_sizze_26978)) && ((local_tid_29256 -\n                                                               squot32(local_tid_29256,\n                                                                       wave_sizze_29258) *\n                                                               wave_sizze_29258) &\n                                                              (2 *\n                                                               offset_29270 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_29267 = ((volatile __local\n                            float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256 +\n                                                        offset_29270)];\n            }\n            // apply reduction operation\n            {\n                float res_29268 = x_29266 + x_29267;\n                \n                x_29266 = res_29268;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n ",
                   "                 float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256)] =\n                    x_29266;\n            }\n        }\n        offset_29270 *= 2;\n    }\n    while (slt32(skip_waves_29271,\n                 squot32(sext_i64_i32(segred_group_sizze_26978) +\n                         wave_sizze_29258 - 1, wave_sizze_29258))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29270 = skip_waves_29271 * wave_sizze_29258;\n        if (slt32(local_tid_29256 + offset_29270,\n                  sext_i64_i32(segred_group_sizze_26978)) && ((local_tid_29256 -\n                                                               squot32(local_tid_29256,\n                                                                       wave_sizze_29258) *\n                                                               wave_sizze_29258) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29256,\n                                                                       wave_sizze_29258) &\n                                                               (2 *\n                                                                skip_waves_29271 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_29267 = ((__local\n                            float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256 +\n                                                        offset_29270)];\n            }\n            // apply reduction operation\n            {\n                float res_29268 = x_29266 + x_29267;\n                \n                x_29266 = res_29268;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256)] =\n                    x_29266;\n            }\n        }\n        skip_waves_29271 *= 2;\n    }\n    barrier(CLK_L",
                   "OCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29256) == 0) {\n            x_acc_29264 = x_29266;\n        }\n    }\n    \n    int32_t old_counter_29272;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29256 == 0) {\n            ((__global\n              float *) group_res_arr_mem_29252)[sext_i32_i64(group_tid_29257) *\n                                                segred_group_sizze_26978] =\n                x_acc_29264;\n            mem_fence_global();\n            old_counter_29272 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29250)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29260)[0] = old_counter_29272 ==\n                num_groups_26979 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29273;\n    \n    is_last_group_29273 = ((__local bool *) sync_arr_mem_29260)[0];\n    if (is_last_group_29273) {\n        if (local_tid_29256 == 0) {\n            old_counter_29272 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29250)[0],\n                                                      (int) (0 -\n                                                             num_groups_26979));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29274 = sdiv_up64(num_groups_26979,\n                                                      segred_group_sizze_26978);\n            \n            x_26982 = 0.0F;\n            for (int64_t i_29275 = 0; i_29275 < read_per_thread_29274;\n                 i_29275++) {\n                int64_t group_res_id_29276 = sext_i32_i64(local_tid_29256) *\n                        read_per_thread_29274 + i_29275;\n                int64_t index_of_group",
                   "_res_29277 = group_res_id_29276;\n                \n                if (slt64(group_res_id_29276, num_groups_26979)) {\n                    x_26983 = ((__global\n                                float *) group_res_arr_mem_29252)[index_of_group_res_29277 *\n                                                                  segred_group_sizze_26978];\n                    \n                    float res_26984;\n                    \n                    res_26984 = x_26982 + x_26983;\n                    x_26982 = res_26984;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256)] =\n            x_26982;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29278;\n            int32_t skip_waves_29279;\n            \n            skip_waves_29279 = 1;\n            \n            float x_29266;\n            float x_29267;\n            \n            offset_29278 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29256,\n                          sext_i64_i32(segred_group_sizze_26978))) {\n                    x_29266 = ((__local\n                                float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256 +\n                                                            offset_29278)];\n                }\n            }\n            offset_29278 = 1;\n            while (slt32(offset_29278, wave_sizze_29258)) {\n                if (slt32(local_tid_29256 + offset_29278,\n                          sext_i64_i32(segred_group_sizze_26978)) &&\n                    ((local_tid_29256 - squot32(local_tid_29256,\n                                                wave_sizze_29258) *\n                      wave_sizze_29258) & (2 * offset_29278 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_29267 = ((volatile __local\n                                    float *) red_arr_mem_2",
                   "9262)[sext_i32_i64(local_tid_29256 +\n                                                                offset_29278)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29268 = x_29266 + x_29267;\n                        \n                        x_29266 = res_29268;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256)] =\n                            x_29266;\n                    }\n                }\n                offset_29278 *= 2;\n            }\n            while (slt32(skip_waves_29279,\n                         squot32(sext_i64_i32(segred_group_sizze_26978) +\n                                 wave_sizze_29258 - 1, wave_sizze_29258))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29278 = skip_waves_29279 * wave_sizze_29258;\n                if (slt32(local_tid_29256 + offset_29278,\n                          sext_i64_i32(segred_group_sizze_26978)) &&\n                    ((local_tid_29256 - squot32(local_tid_29256,\n                                                wave_sizze_29258) *\n                      wave_sizze_29258) == 0 && (squot32(local_tid_29256,\n                                                         wave_sizze_29258) &\n                                                 (2 * skip_waves_29279 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_29267 = ((__local\n                                    float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256 +\n                                                                offset_29278)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29268 = x_29266 + x_29267;\n                        \n                      ",
                   "  x_29266 = res_29268;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256)] =\n                            x_29266;\n                    }\n                }\n                skip_waves_29279 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29256 == 0) {\n                    ((__global float *) mem_28329)[0] = x_29266;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_26978\n}\n__kernel void mainzisegred_nonseg_28359(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28552_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28550_backing_aligned_1,\n                                        int64_t n_24721, __global\n                                        unsigned char *payments_mem_28182,\n                                        __global unsigned char *mem_28371,\n                                        __global\n                                        unsigned char *mainzicounter_mem_28540,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28542,\n                                        int64_t num_threads_28544)\n{\n    #define segred_num_groups_28353 (mainzisegred_num_groups_28352)\n    #define segred_group_sizze_28355 (mainzisegred_group_sizze_28354)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28552_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28552_backing_aligned_0;\n    __local volatile char",
                   " *restrict sync_arr_mem_28550_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28550_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28545;\n    int32_t local_tid_28546;\n    int64_t group_sizze_28549;\n    int32_t wave_sizze_28548;\n    int32_t group_tid_28547;\n    \n    global_tid_28545 = get_global_id(0);\n    local_tid_28546 = get_local_id(0);\n    group_sizze_28549 = get_local_size(0);\n    wave_sizze_28548 = LOCKSTEP_WIDTH;\n    group_tid_28547 = get_group_id(0);\n    \n    int32_t phys_tid_28359;\n    \n    phys_tid_28359 = global_tid_28545;\n    \n    __local char *sync_arr_mem_28550;\n    \n    sync_arr_mem_28550 = (__local char *) sync_arr_mem_28550_backing_0;\n    \n    __local char *red_arr_mem_28552;\n    \n    red_arr_mem_28552 = (__local char *) red_arr_mem_28552_backing_1;\n    \n    int64_t dummy_28357;\n    \n    dummy_28357 = 0;\n    \n    int64_t gtid_28358;\n    \n    gtid_28358 = 0;\n    \n    int64_t x_acc_28554;\n    int64_t chunk_sizze_28555;\n    \n    chunk_sizze_28555 = smin64(sdiv_up64(n_24721,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_28355 *\n                                         segred_num_groups_28353))),\n                               sdiv_up64(n_24721 - sext_i32_i64(phys_tid_28359),\n                                         num_threads_28544));\n    \n    int64_t x_28360;\n    int64_t y_28361;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28554 = 0;\n    }\n    for (int64_t i_28559 = 0; i_28559 < chunk_sizze_28555; i_28559++) {\n        gtid_28358 = sext_i32_i64(phys_tid_28359) + num_threads_28544 * i_28559;\n        // apply map function\n        {\n            int64_t res_28364 = ((__global\n                                  int64_t *) payments_mem_28182)[gtid_28358];\n            int64_t bytes_28365 = 4 * res_28364;\n            \n            // save map-out results\n            { }\n            // load accu",
                   "mulator\n            {\n                x_28360 = x_acc_28554;\n            }\n            // load new values\n            {\n                y_28361 = bytes_28365;\n            }\n            // apply reduction operator\n            {\n                int64_t zz_28362 = smax64(x_28360, y_28361);\n                \n                // store in accumulator\n                {\n                    x_acc_28554 = zz_28362;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_28360 = x_acc_28554;\n        ((__local int64_t *) red_arr_mem_28552)[sext_i32_i64(local_tid_28546)] =\n            x_28360;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28560;\n    int32_t skip_waves_28561;\n    \n    skip_waves_28561 = 1;\n    \n    int64_t x_28556;\n    int64_t y_28557;\n    \n    offset_28560 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28546, sext_i64_i32(segred_group_sizze_28355))) {\n            x_28556 = ((__local\n                        int64_t *) red_arr_mem_28552)[sext_i32_i64(local_tid_28546 +\n                                                      offset_28560)];\n        }\n    }\n    offset_28560 = 1;\n    while (slt32(offset_28560, wave_sizze_28548)) {\n        if (slt32(local_tid_28546 + offset_28560,\n                  sext_i64_i32(segred_group_sizze_28355)) && ((local_tid_28546 -\n                                                               squot32(local_tid_28546,\n                                                                       wave_sizze_28548) *\n                                                               wave_sizze_28548) &\n                                                              (2 *\n                                                               offset_28560 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_28557 = ((volatile __local\n              ",
                   "              int64_t *) red_arr_mem_28552)[sext_i32_i64(local_tid_28546 +\n                                                          offset_28560)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_28558 = smax64(x_28556, y_28557);\n                \n                x_28556 = zz_28558;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_28552)[sext_i32_i64(local_tid_28546)] =\n                    x_28556;\n            }\n        }\n        offset_28560 *= 2;\n    }\n    while (slt32(skip_waves_28561,\n                 squot32(sext_i64_i32(segred_group_sizze_28355) +\n                         wave_sizze_28548 - 1, wave_sizze_28548))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28560 = skip_waves_28561 * wave_sizze_28548;\n        if (slt32(local_tid_28546 + offset_28560,\n                  sext_i64_i32(segred_group_sizze_28355)) && ((local_tid_28546 -\n                                                               squot32(local_tid_28546,\n                                                                       wave_sizze_28548) *\n                                                               wave_sizze_28548) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28546,\n                                                                       wave_sizze_28548) &\n                                                               (2 *\n                                                                skip_waves_28561 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                y_28557 = ((__local\n                            int64_t *) red_arr_mem_28552)[sext_i32_i64(local_tid_28546 +\n                                                          offset_28560)];\n            }\n",
                   "            // apply reduction operation\n            {\n                int64_t zz_28558 = smax64(x_28556, y_28557);\n                \n                x_28556 = zz_28558;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_28552)[sext_i32_i64(local_tid_28546)] =\n                    x_28556;\n            }\n        }\n        skip_waves_28561 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28546) == 0) {\n            x_acc_28554 = x_28556;\n        }\n    }\n    \n    int32_t old_counter_28562;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28546 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_28542)[sext_i32_i64(group_tid_28547) *\n                                                  segred_group_sizze_28355] =\n                x_acc_28554;\n            mem_fence_global();\n            old_counter_28562 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28540)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28550)[0] = old_counter_28562 ==\n                segred_num_groups_28353 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28563;\n    \n    is_last_group_28563 = ((__local bool *) sync_arr_mem_28550)[0];\n    if (is_last_group_28563) {\n        if (local_tid_28546 == 0) {\n            old_counter_28562 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28540)[0],\n                                                      (int) (0 -\n                                                             segred_num_groups_28353));\n        }\n        // read in the per-group-results\n       ",
                   " {\n            int64_t read_per_thread_28564 = sdiv_up64(segred_num_groups_28353,\n                                                      segred_group_sizze_28355);\n            \n            x_28360 = 0;\n            for (int64_t i_28565 = 0; i_28565 < read_per_thread_28564;\n                 i_28565++) {\n                int64_t group_res_id_28566 = sext_i32_i64(local_tid_28546) *\n                        read_per_thread_28564 + i_28565;\n                int64_t index_of_group_res_28567 = group_res_id_28566;\n                \n                if (slt64(group_res_id_28566, segred_num_groups_28353)) {\n                    y_28361 = ((__global\n                                int64_t *) group_res_arr_mem_28542)[index_of_group_res_28567 *\n                                                                    segred_group_sizze_28355];\n                    \n                    int64_t zz_28362;\n                    \n                    zz_28362 = smax64(x_28360, y_28361);\n                    x_28360 = zz_28362;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_28552)[sext_i32_i64(local_tid_28546)] =\n            x_28360;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28568;\n            int32_t skip_waves_28569;\n            \n            skip_waves_28569 = 1;\n            \n            int64_t x_28556;\n            int64_t y_28557;\n            \n            offset_28568 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28546,\n                          sext_i64_i32(segred_group_sizze_28355))) {\n                    x_28556 = ((__local\n                                int64_t *) red_arr_mem_28552)[sext_i32_i64(local_tid_28546 +\n                                                              offset_28568)];\n                }\n            }\n            offset_28568 = 1;\n            while (slt32(offset_28568, wave_sizze_28548)) {\n        ",
                   "        if (slt32(local_tid_28546 + offset_28568,\n                          sext_i64_i32(segred_group_sizze_28355)) &&\n                    ((local_tid_28546 - squot32(local_tid_28546,\n                                                wave_sizze_28548) *\n                      wave_sizze_28548) & (2 * offset_28568 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_28557 = ((volatile __local\n                                    int64_t *) red_arr_mem_28552)[sext_i32_i64(local_tid_28546 +\n                                                                  offset_28568)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_28558 = smax64(x_28556, y_28557);\n                        \n                        x_28556 = zz_28558;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28552)[sext_i32_i64(local_tid_28546)] =\n                            x_28556;\n                    }\n                }\n                offset_28568 *= 2;\n            }\n            while (slt32(skip_waves_28569,\n                         squot32(sext_i64_i32(segred_group_sizze_28355) +\n                                 wave_sizze_28548 - 1, wave_sizze_28548))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28568 = skip_waves_28569 * wave_sizze_28548;\n                if (slt32(local_tid_28546 + offset_28568,\n                          sext_i64_i32(segred_group_sizze_28355)) &&\n                    ((local_tid_28546 - squot32(local_tid_28546,\n                                                wave_sizze_28548) *\n                      wave_sizze_28548) == 0 && (squot32(local_tid_28546,\n                                                         wave_sizze_28548) &\n                                                 (2 * skip_waves_28569 - 1)) ",
                   "==\n                     0)) {\n                    // read array element\n                    {\n                        y_28557 = ((__local\n                                    int64_t *) red_arr_mem_28552)[sext_i32_i64(local_tid_28546 +\n                                                                  offset_28568)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_28558 = smax64(x_28556, y_28557);\n                        \n                        x_28556 = zz_28558;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_28552)[sext_i32_i64(local_tid_28546)] =\n                            x_28556;\n                    }\n                }\n                skip_waves_28569 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28546 == 0) {\n                    ((__global int64_t *) mem_28371)[0] = x_28556;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_28353\n    #undef segred_group_sizze_28355\n}\n__kernel void mainzisegred_nonseg_28391(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28589_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28587_backing_aligned_1,\n                                        int64_t n_24721, __global\n                                        unsigned char *payments_mem_28182,\n                                        __global unsigned char *mem_28403,\n                                        __global\n                                        unsigned char *mainzicounter_mem_28577,\n                                        __global\n                         ",
                   "               unsigned char *group_res_arr_mem_28579,\n                                        int64_t num_threads_28581)\n{\n    #define segred_num_groups_28385 (mainzisegred_num_groups_28384)\n    #define segred_group_sizze_28387 (mainzisegred_group_sizze_28386)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28589_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28589_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28587_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28587_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28582;\n    int32_t local_tid_28583;\n    int64_t group_sizze_28586;\n    int32_t wave_sizze_28585;\n    int32_t group_tid_28584;\n    \n    global_tid_28582 = get_global_id(0);\n    local_tid_28583 = get_local_id(0);\n    group_sizze_28586 = get_local_size(0);\n    wave_sizze_28585 = LOCKSTEP_WIDTH;\n    group_tid_28584 = get_group_id(0);\n    \n    int32_t phys_tid_28391;\n    \n    phys_tid_28391 = global_tid_28582;\n    \n    __local char *sync_arr_mem_28587;\n    \n    sync_arr_mem_28587 = (__local char *) sync_arr_mem_28587_backing_0;\n    \n    __local char *red_arr_mem_28589;\n    \n    red_arr_mem_28589 = (__local char *) red_arr_mem_28589_backing_1;\n    \n    int64_t dummy_28389;\n    \n    dummy_28389 = 0;\n    \n    int64_t gtid_28390;\n    \n    gtid_28390 = 0;\n    \n    int64_t x_acc_28591;\n    int64_t chunk_sizze_28592;\n    \n    chunk_sizze_28592 = smin64(sdiv_up64(n_24721,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_28387 *\n                                         segred_num_groups_28385))),\n                               sdiv_up64(n_24721 - sext_i32_i64(phys_tid_28391),\n                                         num_threads_28581));\n    \n    int64_t x_2",
                   "8392;\n    int64_t y_28393;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28591 = 0;\n    }\n    for (int64_t i_28596 = 0; i_28596 < chunk_sizze_28592; i_28596++) {\n        gtid_28390 = sext_i32_i64(phys_tid_28391) + num_threads_28581 * i_28596;\n        // apply map function\n        {\n            int64_t res_28396 = ((__global\n                                  int64_t *) payments_mem_28182)[gtid_28390];\n            int64_t bytes_28397 = 4 * res_28396;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_28392 = x_acc_28591;\n            }\n            // load new values\n            {\n                y_28393 = bytes_28397;\n            }\n            // apply reduction operator\n            {\n                int64_t zz_28394 = smax64(x_28392, y_28393);\n                \n                // store in accumulator\n                {\n                    x_acc_28591 = zz_28394;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_28392 = x_acc_28591;\n        ((__local int64_t *) red_arr_mem_28589)[sext_i32_i64(local_tid_28583)] =\n            x_28392;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28597;\n    int32_t skip_waves_28598;\n    \n    skip_waves_28598 = 1;\n    \n    int64_t x_28593;\n    int64_t y_28594;\n    \n    offset_28597 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28583, sext_i64_i32(segred_group_sizze_28387))) {\n            x_28593 = ((__local\n                        int64_t *) red_arr_mem_28589)[sext_i32_i64(local_tid_28583 +\n                                                      offset_28597)];\n        }\n    }\n    offset_28597 = 1;\n    while (slt32(offset_28597, wave_sizze_28585)) {\n        if (slt32(local_tid_28583 + offset_28597,\n                  sext_i64_i32(segred_group_sizze_28387)) && ((local_tid_28583 -\n                         ",
                   "                                      squot32(local_tid_28583,\n                                                                       wave_sizze_28585) *\n                                                               wave_sizze_28585) &\n                                                              (2 *\n                                                               offset_28597 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_28594 = ((volatile __local\n                            int64_t *) red_arr_mem_28589)[sext_i32_i64(local_tid_28583 +\n                                                          offset_28597)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_28595 = smax64(x_28593, y_28594);\n                \n                x_28593 = zz_28595;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_28589)[sext_i32_i64(local_tid_28583)] =\n                    x_28593;\n            }\n        }\n        offset_28597 *= 2;\n    }\n    while (slt32(skip_waves_28598,\n                 squot32(sext_i64_i32(segred_group_sizze_28387) +\n                         wave_sizze_28585 - 1, wave_sizze_28585))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28597 = skip_waves_28598 * wave_sizze_28585;\n        if (slt32(local_tid_28583 + offset_28597,\n                  sext_i64_i32(segred_group_sizze_28387)) && ((local_tid_28583 -\n                                                               squot32(local_tid_28583,\n                                                                       wave_sizze_28585) *\n                                                               wave_sizze_28585) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28583,\n                ",
                   "                                                       wave_sizze_28585) &\n                                                               (2 *\n                                                                skip_waves_28598 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                y_28594 = ((__local\n                            int64_t *) red_arr_mem_28589)[sext_i32_i64(local_tid_28583 +\n                                                          offset_28597)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_28595 = smax64(x_28593, y_28594);\n                \n                x_28593 = zz_28595;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_28589)[sext_i32_i64(local_tid_28583)] =\n                    x_28593;\n            }\n        }\n        skip_waves_28598 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28583) == 0) {\n            x_acc_28591 = x_28593;\n        }\n    }\n    \n    int32_t old_counter_28599;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28583 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_28579)[sext_i32_i64(group_tid_28584) *\n                                                  segred_group_sizze_28387] =\n                x_acc_28591;\n            mem_fence_global();\n            old_counter_28599 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28577)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28587)[0] = old_counter_28599 ==\n                segred_num_groups_28385 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_ME",
                   "M_FENCE);\n    \n    bool is_last_group_28600;\n    \n    is_last_group_28600 = ((__local bool *) sync_arr_mem_28587)[0];\n    if (is_last_group_28600) {\n        if (local_tid_28583 == 0) {\n            old_counter_28599 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28577)[0],\n                                                      (int) (0 -\n                                                             segred_num_groups_28385));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28601 = sdiv_up64(segred_num_groups_28385,\n                                                      segred_group_sizze_28387);\n            \n            x_28392 = 0;\n            for (int64_t i_28602 = 0; i_28602 < read_per_thread_28601;\n                 i_28602++) {\n                int64_t group_res_id_28603 = sext_i32_i64(local_tid_28583) *\n                        read_per_thread_28601 + i_28602;\n                int64_t index_of_group_res_28604 = group_res_id_28603;\n                \n                if (slt64(group_res_id_28603, segred_num_groups_28385)) {\n                    y_28393 = ((__global\n                                int64_t *) group_res_arr_mem_28579)[index_of_group_res_28604 *\n                                                                    segred_group_sizze_28387];\n                    \n                    int64_t zz_28394;\n                    \n                    zz_28394 = smax64(x_28392, y_28393);\n                    x_28392 = zz_28394;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_28589)[sext_i32_i64(local_tid_28583)] =\n            x_28392;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28605;\n            int32_t skip_waves_28606;\n            \n            skip_waves_28606 = 1;\n            \n            int64_t x_28593;\n            int64_t y_28594;\n        ",
                   "    \n            offset_28605 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28583,\n                          sext_i64_i32(segred_group_sizze_28387))) {\n                    x_28593 = ((__local\n                                int64_t *) red_arr_mem_28589)[sext_i32_i64(local_tid_28583 +\n                                                              offset_28605)];\n                }\n            }\n            offset_28605 = 1;\n            while (slt32(offset_28605, wave_sizze_28585)) {\n                if (slt32(local_tid_28583 + offset_28605,\n                          sext_i64_i32(segred_group_sizze_28387)) &&\n                    ((local_tid_28583 - squot32(local_tid_28583,\n                                                wave_sizze_28585) *\n                      wave_sizze_28585) & (2 * offset_28605 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_28594 = ((volatile __local\n                                    int64_t *) red_arr_mem_28589)[sext_i32_i64(local_tid_28583 +\n                                                                  offset_28605)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_28595 = smax64(x_28593, y_28594);\n                        \n                        x_28593 = zz_28595;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28589)[sext_i32_i64(local_tid_28583)] =\n                            x_28593;\n                    }\n                }\n                offset_28605 *= 2;\n            }\n            while (slt32(skip_waves_28606,\n                         squot32(sext_i64_i32(segred_group_sizze_28387) +\n                                 wave_sizze_28585 - 1, wave_sizze_28585))) {\n                barrier(CLK_LOCAL_MEM_",
                   "FENCE);\n                offset_28605 = skip_waves_28606 * wave_sizze_28585;\n                if (slt32(local_tid_28583 + offset_28605,\n                          sext_i64_i32(segred_group_sizze_28387)) &&\n                    ((local_tid_28583 - squot32(local_tid_28583,\n                                                wave_sizze_28585) *\n                      wave_sizze_28585) == 0 && (squot32(local_tid_28583,\n                                                         wave_sizze_28585) &\n                                                 (2 * skip_waves_28606 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        y_28594 = ((__local\n                                    int64_t *) red_arr_mem_28589)[sext_i32_i64(local_tid_28583 +\n                                                                  offset_28605)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_28595 = smax64(x_28593, y_28594);\n                        \n                        x_28593 = zz_28595;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_28589)[sext_i32_i64(local_tid_28583)] =\n                            x_28593;\n                    }\n                }\n                skip_waves_28606 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28583 == 0) {\n                    ((__global int64_t *) mem_28403)[0] = x_28593;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_28385\n    #undef segred_group_sizze_28387\n}\n__kernel void mainzisegred_small_26911(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *red_arr_mem_29191_backing_aligned_0,\n  ",
                   "                                     int64_t n_24721, int64_t paths_24724,\n                                       int64_t num_groups_26962, __global\n                                       unsigned char *mem_28306, __global\n                                       unsigned char *mem_28322,\n                                       int64_t segment_sizze_nonzzero_29184)\n{\n    #define segred_group_sizze_26961 (mainzisegred_group_sizze_26905)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29191_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_29191_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29186;\n    int32_t local_tid_29187;\n    int64_t group_sizze_29190;\n    int32_t wave_sizze_29189;\n    int32_t group_tid_29188;\n    \n    global_tid_29186 = get_global_id(0);\n    local_tid_29187 = get_local_id(0);\n    group_sizze_29190 = get_local_size(0);\n    wave_sizze_29189 = LOCKSTEP_WIDTH;\n    group_tid_29188 = get_group_id(0);\n    \n    int32_t phys_tid_26911;\n    \n    phys_tid_26911 = global_tid_29186;\n    \n    __local char *red_arr_mem_29191;\n    \n    red_arr_mem_29191 = (__local char *) red_arr_mem_29191_backing_0;\n    \n    int32_t phys_group_id_29193;\n    \n    phys_group_id_29193 = get_group_id(0);\n    for (int32_t i_29194 = 0; i_29194 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(paths_24724,\n                                          squot64(segred_group_sizze_26961,\n                                                  segment_sizze_nonzzero_29184))) -\n                   phys_group_id_29193, sext_i64_i32(num_groups_26962));\n         i_29194++) {\n        int32_t virt_group_id_29195 = phys_group_id_29193 + i_29194 *\n                sext_i64_i32(num_groups_26962);\n        int64_t gtid_26902 = squot64(sext_i32_i64(local_tid_29187),\n                                     segment_sizze_nonzzero",
                   "_29184) +\n                sext_i32_i64(virt_group_id_29195) *\n                squot64(segred_group_sizze_26961, segment_sizze_nonzzero_29184);\n        int64_t gtid_26910 = srem64(sext_i32_i64(local_tid_29187), n_24721);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, n_24721) && (slt64(gtid_26902, paths_24724) &&\n                                      slt64(sext_i32_i64(local_tid_29187),\n                                            n_24721 *\n                                            squot64(segred_group_sizze_26961,\n                                                    segment_sizze_nonzzero_29184)))) {\n                int64_t binop_x_28132 = n_24721 * gtid_26902;\n                int64_t new_index_28133 = gtid_26910 + binop_x_28132;\n                float x_26969 = ((__global float *) mem_28306)[new_index_28133];\n                \n                // save map-out results\n                { }\n                // save results to be reduced\n                {\n                    ((__local\n                      float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)] =\n                        x_26969;\n                }\n            } else {\n                ((__local\n                  float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)] =\n                    0.0F;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, n_24721)) {\n            // perform segmented scan to imitate reduction\n            {\n                float x_26965;\n                float x_26966;\n                float x_29196;\n                float x_29197;\n                bool ltid_in_bounds_29199;\n                \n                ltid_in_bounds_29199 = slt64(sext_i32_i64(local_tid_29187),\n                                             n_24721 *\n                                             squot64(segred_group_sizze_26961,\n                                                     segment_sizze_nonzzero_29184));\n                \n                in",
                   "t32_t skip_threads_29200;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_29199) {\n                        x_26966 = ((volatile __local\n                                    float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)];\n                        if ((local_tid_29187 - squot32(local_tid_29187, 32) *\n                             32) == 0) {\n                            x_26965 = x_26966;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29200 = 1;\n                    while (slt32(skip_threads_29200, 32)) {\n                        if (sle32(skip_threads_29200, local_tid_29187 -\n                                  squot32(local_tid_29187, 32) * 32) &&\n                            ltid_in_bounds_29199) {\n                            // read operands\n                            {\n                                x_26965 = ((volatile __local\n                                            float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187) -\n                                                                        sext_i32_i64(skip_threads_29200)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_29201 =\n                                     slt64(srem64(sext_i32_i64(local_tid_29187),\n                                                  n_24721),\n                                           sext_i32_i64(local_tid_29187) -\n                                           sext_i32_i64(local_tid_29187 -\n                                           skip_threads_29200));\n                                \n                                if (inactive_29201) {\n                                    x_26965 = x_26966;\n                                }\n                                if (!in",
                   "active_29201) {\n                                    float res_26967 = x_26965 + x_26966;\n                                    \n                                    x_26965 = res_26967;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_29189, skip_threads_29200)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29200, local_tid_29187 -\n                                  squot32(local_tid_29187, 32) * 32) &&\n                            ltid_in_bounds_29199) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)] =\n                                    x_26965;\n                                x_26966 = x_26965;\n                            }\n                        }\n                        if (sle32(wave_sizze_29189, skip_threads_29200)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29200 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_29187 - squot32(local_tid_29187, 32) * 32) ==\n                        31 && ltid_in_bounds_29199) {\n                        ((volatile __local\n                          float *) red_arr_mem_29191)[sext_i32_i64(squot32(local_tid_29187,\n                                                                           32))] =\n                            x_26965;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    ",
                   "int32_t skip_threads_29202;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_29187, 32) == 0 &&\n                            ltid_in_bounds_29199) {\n                            x_29197 = ((volatile __local\n                                        float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)];\n                            if ((local_tid_29187 - squot32(local_tid_29187,\n                                                           32) * 32) == 0) {\n                                x_29196 = x_29197;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_29202 = 1;\n                        while (slt32(skip_threads_29202, 32)) {\n                            if (sle32(skip_threads_29202, local_tid_29187 -\n                                      squot32(local_tid_29187, 32) * 32) &&\n                                (squot32(local_tid_29187, 32) == 0 &&\n                                 ltid_in_bounds_29199)) {\n                                // read operands\n                                {\n                                    x_29196 = ((volatile __local\n                                                float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187) -\n                                                                            sext_i32_i64(skip_threads_29202)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_29203 =\n                                         slt64(srem64(sext_i32_i64(local_tid_29187 *\n                                                      32 + 32 - 1), n_24721),\n                                               sext_i32_i64(local_tid_29187 *\n                                               32 + ",
                   "32 - 1) -\n                                               sext_i32_i64((local_tid_29187 -\n                                                             skip_threads_29202) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_29203) {\n                                        x_29196 = x_29197;\n                                    }\n                                    if (!inactive_29203) {\n                                        float res_29198 = x_29196 + x_29197;\n                                        \n                                        x_29196 = res_29198;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_29189, skip_threads_29202)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_29202, local_tid_29187 -\n                                      squot32(local_tid_29187, 32) * 32) &&\n                                (squot32(local_tid_29187, 32) == 0 &&\n                                 ltid_in_bounds_29199)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)] =\n                                        x_29196;\n                                    x_29197 = x_29196;\n                                }\n                            }\n                            if (sle32(wave_sizze_29189, skip_threads_29202)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_29202 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block",
                   " except the first\n                {\n                    if (!(squot32(local_tid_29187, 32) == 0 ||\n                          !ltid_in_bounds_29199)) {\n                        // read operands\n                        {\n                            x_26966 = x_26965;\n                            x_26965 = ((__local\n                                        float *) red_arr_mem_29191)[sext_i32_i64(squot32(local_tid_29187,\n                                                                                         32)) -\n                                                                    1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_29204 =\n                                 slt64(srem64(sext_i32_i64(local_tid_29187),\n                                              n_24721),\n                                       sext_i32_i64(local_tid_29187) -\n                                       sext_i32_i64(squot32(local_tid_29187,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_29204) {\n                                x_26965 = x_26966;\n                            }\n                            if (!inactive_29204) {\n                                float res_26967 = x_26965 + x_26966;\n                                \n                                x_26965 = res_26967;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)] =\n                                x_26965;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_29187, 32) == 0",
                   ") {\n                        ((__local\n                          float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)] =\n                            x_26966;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_29195) *\n                      squot64(segred_group_sizze_26961,\n                              segment_sizze_nonzzero_29184) +\n                      sext_i32_i64(local_tid_29187), paths_24724) &&\n                slt64(sext_i32_i64(local_tid_29187),\n                      squot64(segred_group_sizze_26961,\n                              segment_sizze_nonzzero_29184))) {\n                ((__global\n                  float *) mem_28322)[sext_i32_i64(virt_group_id_29195) *\n                                      squot64(segred_group_sizze_26961,\n                                              segment_sizze_nonzzero_29184) +\n                                      sext_i32_i64(local_tid_29187)] = ((__local\n                                                                         float *) red_arr_mem_29191)[(sext_i32_i64(local_tid_29187) +\n                                                                                                      1) *\n                                                                                                     segment_sizze_nonzzero_29184 -\n                                                                                                     1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_26961\n}\n__kernel void mainzisegred_small_28820(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *red_arr_mem_28828_backing_aligned_0,\n      ",
                   "                                 int64_t res_25191,\n                                       int64_t num_groups_26744, __global\n                                       unsigned char *mem_28283,\n                                       int32_t num_subhistos_28734, __global\n                                       unsigned char *res_subhistos_mem_28735,\n                                       int64_t segment_sizze_nonzzero_28821)\n{\n    #define seghist_group_sizze_26742 (mainziseghist_group_sizze_26741)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28828_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28828_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28823;\n    int32_t local_tid_28824;\n    int64_t group_sizze_28827;\n    int32_t wave_sizze_28826;\n    int32_t group_tid_28825;\n    \n    global_tid_28823 = get_global_id(0);\n    local_tid_28824 = get_local_id(0);\n    group_sizze_28827 = get_local_size(0);\n    wave_sizze_28826 = LOCKSTEP_WIDTH;\n    group_tid_28825 = get_group_id(0);\n    \n    int32_t flat_gtid_28820;\n    \n    flat_gtid_28820 = global_tid_28823;\n    \n    __local char *red_arr_mem_28828;\n    \n    red_arr_mem_28828 = (__local char *) red_arr_mem_28828_backing_0;\n    \n    int32_t phys_group_id_28830;\n    \n    phys_group_id_28830 = get_group_id(0);\n    for (int32_t i_28831 = 0; i_28831 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(res_25191,\n                                          squot64(seghist_group_sizze_26742,\n                                                  segment_sizze_nonzzero_28821))) -\n                   phys_group_id_28830, sext_i64_i32(num_groups_26744));\n         i_28831++) {\n        int32_t virt_group_id_28832 = phys_group_id_28830 + i_28831 *\n                sext_i64_i32(num_groups_26744);\n        int64_t bucket_id_28818 = squot64(sext_i32_i64(local_tid_",
                   "28824),\n                                          segment_sizze_nonzzero_28821) +\n                sext_i32_i64(virt_group_id_28832) *\n                squot64(seghist_group_sizze_26742,\n                        segment_sizze_nonzzero_28821);\n        int64_t subhistogram_id_28819 = srem64(sext_i32_i64(local_tid_28824),\n                                               num_subhistos_28734);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, num_subhistos_28734) && (slt64(bucket_id_28818,\n                                                        res_25191) &&\n                                                  slt64(sext_i32_i64(local_tid_28824),\n                                                        num_subhistos_28734 *\n                                                        squot64(seghist_group_sizze_26742,\n                                                                segment_sizze_nonzzero_28821)))) {\n                // save results to be reduced\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824)] =\n                        ((__global\n                          int64_t *) res_subhistos_mem_28735)[subhistogram_id_28819 *\n                                                              res_25191 +\n                                                              bucket_id_28818];\n                }\n            } else {\n                ((__local\n                  int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824)] =\n                    0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, num_subhistos_28734)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t x_26748;\n                int64_t x_26749;\n                int64_t x_28833;\n                int64_t x_28834;\n                bool ltid_in_bounds_28836;\n                \n                ltid_in_bounds_28836 = slt64(sext_i32_i64(",
                   "local_tid_28824),\n                                             num_subhistos_28734 *\n                                             squot64(seghist_group_sizze_26742,\n                                                     segment_sizze_nonzzero_28821));\n                \n                int32_t skip_threads_28837;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_28836) {\n                        x_26749 = ((volatile __local\n                                    int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824)];\n                        if ((local_tid_28824 - squot32(local_tid_28824, 32) *\n                             32) == 0) {\n                            x_26748 = x_26749;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28837 = 1;\n                    while (slt32(skip_threads_28837, 32)) {\n                        if (sle32(skip_threads_28837, local_tid_28824 -\n                                  squot32(local_tid_28824, 32) * 32) &&\n                            ltid_in_bounds_28836) {\n                            // read operands\n                            {\n                                x_26748 = ((volatile __local\n                                            int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824) -\n                                                                          sext_i32_i64(skip_threads_28837)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_28838 =\n                                     slt64(srem64(sext_i32_i64(local_tid_28824),\n                                                  num_subhistos_28734),\n                                           sext_i32_i64(local_tid_28824) -\n                                           sext_i32",
                   "_i64(local_tid_28824 -\n                                           skip_threads_28837));\n                                \n                                if (inactive_28838) {\n                                    x_26748 = x_26749;\n                                }\n                                if (!inactive_28838) {\n                                    int64_t res_26750 = smax64(x_26748,\n                                                               x_26749);\n                                    \n                                    x_26748 = res_26750;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_28826, skip_threads_28837)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28837, local_tid_28824 -\n                                  squot32(local_tid_28824, 32) * 32) &&\n                            ltid_in_bounds_28836) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824)] =\n                                    x_26748;\n                                x_26749 = x_26748;\n                            }\n                        }\n                        if (sle32(wave_sizze_28826, skip_threads_28837)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28837 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_28824 - squot32(local_tid_28824, 32) * 32) ==\n                        31 && ltid_in_bounds_28836) {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28828)[s",
                   "ext_i32_i64(squot32(local_tid_28824,\n                                                                             32))] =\n                            x_26748;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_28839;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_28824, 32) == 0 &&\n                            ltid_in_bounds_28836) {\n                            x_28834 = ((volatile __local\n                                        int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824)];\n                            if ((local_tid_28824 - squot32(local_tid_28824,\n                                                           32) * 32) == 0) {\n                                x_28833 = x_28834;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_28839 = 1;\n                        while (slt32(skip_threads_28839, 32)) {\n                            if (sle32(skip_threads_28839, local_tid_28824 -\n                                      squot32(local_tid_28824, 32) * 32) &&\n                                (squot32(local_tid_28824, 32) == 0 &&\n                                 ltid_in_bounds_28836)) {\n                                // read operands\n                                {\n                                    x_28833 = ((volatile __local\n                                                int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824) -\n                                                                              sext_i32_i64(skip_threads_28839)];\n                                }\n                                // perform operatio",
                   "n\n                                {\n                                    bool inactive_28840 =\n                                         slt64(srem64(sext_i32_i64(local_tid_28824 *\n                                                      32 + 32 - 1),\n                                                      num_subhistos_28734),\n                                               sext_i32_i64(local_tid_28824 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_28824 -\n                                                             skip_threads_28839) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_28840) {\n                                        x_28833 = x_28834;\n                                    }\n                                    if (!inactive_28840) {\n                                        int64_t res_28835 = smax64(x_28833,\n                                                                   x_28834);\n                                        \n                                        x_28833 = res_28835;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_28826, skip_threads_28839)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_28839, local_tid_28824 -\n                                      squot32(local_tid_28824, 32) * 32) &&\n                                (squot32(local_tid_28824, 32) == 0 &&\n                                 ltid_in_bounds_28836)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824)] =\n                ",
                   "                        x_28833;\n                                    x_28834 = x_28833;\n                                }\n                            }\n                            if (sle32(wave_sizze_28826, skip_threads_28839)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_28839 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_28824, 32) == 0 ||\n                          !ltid_in_bounds_28836)) {\n                        // read operands\n                        {\n                            x_26749 = x_26748;\n                            x_26748 = ((__local\n                                        int64_t *) red_arr_mem_28828)[sext_i32_i64(squot32(local_tid_28824,\n                                                                                           32)) -\n                                                                      1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_28841 =\n                                 slt64(srem64(sext_i32_i64(local_tid_28824),\n                                              num_subhistos_28734),\n                                       sext_i32_i64(local_tid_28824) -\n                                       sext_i32_i64(squot32(local_tid_28824,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_28841) {\n                                x_26748 = x_26749;\n                            }\n                            if (!inactive_28841) {\n                                int64_t res_26750 = smax64(x_26748, x_26749);\n                                \n                                x_2674",
                   "8 = res_26750;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824)] =\n                                x_26748;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_28824, 32) == 0) {\n                        ((__local\n                          int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824)] =\n                            x_26749;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_28832) *\n                      squot64(seghist_group_sizze_26742,\n                              segment_sizze_nonzzero_28821) +\n                      sext_i32_i64(local_tid_28824), res_25191) &&\n                slt64(sext_i32_i64(local_tid_28824),\n                      squot64(seghist_group_sizze_26742,\n                              segment_sizze_nonzzero_28821))) {\n                ((__global\n                  int64_t *) mem_28283)[sext_i32_i64(virt_group_id_28832) *\n                                        squot64(seghist_group_sizze_26742,\n                                                segment_sizze_nonzzero_28821) +\n                                        sext_i32_i64(local_tid_28824)] =\n                    ((__local\n                      int64_t *) red_arr_mem_28828)[(sext_i32_i64(local_tid_28824) +\n                                                     1) *\n                                                    segment_sizze_nonzzero_28821 -\n                                                    1];\n            }\n  ",
                   "      }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_26742\n}\n__kernel void testziscan_stage1_27838(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28653_backing_aligned_0,\n                                      int64_t flat_dim_25605, float res_25618,\n                                      __global unsigned char *res_mem_28238,\n                                      __global unsigned char *res_mem_28239,\n                                      __global unsigned char *mem_28270,\n                                      __global unsigned char *mem_28272,\n                                      int32_t num_threads_28647)\n{\n    #define segscan_group_sizze_27833 (testzisegscan_group_sizze_27832)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28653_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28653_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28648;\n    int32_t local_tid_28649;\n    int64_t group_sizze_28652;\n    int32_t wave_sizze_28651;\n    int32_t group_tid_28650;\n    \n    global_tid_28648 = get_global_id(0);\n    local_tid_28649 = get_local_id(0);\n    group_sizze_28652 = get_local_size(0);\n    wave_sizze_28651 = LOCKSTEP_WIDTH;\n    group_tid_28650 = get_group_id(0);\n    \n    int32_t phys_tid_27838;\n    \n    phys_tid_27838 = global_tid_28648;\n    \n    __local char *scan_arr_mem_28653;\n    \n    scan_arr_mem_28653 = (__local char *) scan_arr_mem_28653_backing_0;\n    \n    int64_t x_25624;\n    int64_t x_25625;\n    \n    x_25624 = 0;\n    for (int64_t j_28655 = 0; j_28655 < sdiv_up64(flat_dim_25605,\n                                                  sext_i32_i64(num_threa",
                   "ds_28647));\n         j_28655++) {\n        int64_t chunk_offset_28656 = segscan_group_sizze_27833 * j_28655 +\n                sext_i32_i64(group_tid_28650) * (segscan_group_sizze_27833 *\n                                                 sdiv_up64(flat_dim_25605,\n                                                           sext_i32_i64(num_threads_28647)));\n        int64_t flat_idx_28657 = chunk_offset_28656 +\n                sext_i32_i64(local_tid_28649);\n        int64_t gtid_27837 = flat_idx_28657;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27837, flat_dim_25605)) {\n                int64_t binop_x_28107 = squot64(gtid_27837, 9);\n                int64_t binop_y_28108 = 9 * binop_x_28107;\n                int64_t new_index_28109 = gtid_27837 - binop_y_28108;\n                int64_t x_25627 = ((__global\n                                    int64_t *) res_mem_28238)[new_index_28109];\n                float x_25628 = ((__global\n                                  float *) res_mem_28239)[new_index_28109];\n                float x_25629 = res_25618 / x_25628;\n                float ceil_arg_25630 = x_25629 - 1.0F;\n                float res_25631;\n                \n                res_25631 = futrts_ceil32(ceil_arg_25630);\n                \n                int64_t res_25632 = fptosi_f32_i64(res_25631);\n                int64_t max_arg_25633 = sub64(x_25627, res_25632);\n                int64_t res_25634 = smax64(0, max_arg_25633);\n                bool cond_25635 = res_25634 == 0;\n                int64_t res_25636;\n                \n                if (cond_25635) {\n                    res_25636 = 1;\n                } else {\n                    res_25636 = res_25634;\n                }\n                // write to-scan values to parameters\n                {\n                    x_25625 = res_25636;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global int64_t *) mem_28272)[g",
                   "tid_27837] = res_25636;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27837, flat_dim_25605)) {\n                    x_25625 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_25626 = add64(x_25624, x_25625);\n                \n                ((__local\n                  int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)] =\n                    res_25626;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_28658;\n            int64_t x_28659;\n            int64_t x_28661;\n            int64_t x_28662;\n            bool ltid_in_bounds_28664;\n            \n            ltid_in_bounds_28664 = slt64(sext_i32_i64(local_tid_28649),\n                                         segscan_group_sizze_27833);\n            \n            int32_t skip_threads_28665;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28664) {\n                    x_28659 = ((volatile __local\n                                int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)];\n                    if ((local_tid_28649 - squot32(local_tid_28649, 32) * 32) ==\n                        0) {\n                        x_28658 = x_28659;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28665 = 1;\n                while (slt32(skip_threads_28665, 32)) {\n                    if (sle32(skip_threads_28665, local_tid_28649 -\n                              squot32(local_tid_28649, 32) * 32) &&\n                        ltid_in_bounds_28664) {\n                        // read operands\n                        {\n                            x_28658 = ((volatile __lo",
                   "cal\n                                        int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649) -\n                                                                       sext_i32_i64(skip_threads_28665)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_28660 = add64(x_28658, x_28659);\n                            \n                            x_28658 = res_28660;\n                        }\n                    }\n                    if (sle32(wave_sizze_28651, skip_threads_28665)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28665, local_tid_28649 -\n                              squot32(local_tid_28649, 32) * 32) &&\n                        ltid_in_bounds_28664) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)] =\n                                x_28658;\n                            x_28659 = x_28658;\n                        }\n                    }\n                    if (sle32(wave_sizze_28651, skip_threads_28665)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28665 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28649 - squot32(local_tid_28649, 32) * 32) ==\n                    31 && ltid_in_bounds_28664) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28653)[sext_i32_i64(squot32(local_tid_28649,\n                                                                          32))] =\n                        x_28658;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan",
                   " the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28666;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28649, 32) == 0 &&\n                        ltid_in_bounds_28664) {\n                        x_28662 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)];\n                        if ((local_tid_28649 - squot32(local_tid_28649, 32) *\n                             32) == 0) {\n                            x_28661 = x_28662;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28666 = 1;\n                    while (slt32(skip_threads_28666, 32)) {\n                        if (sle32(skip_threads_28666, local_tid_28649 -\n                                  squot32(local_tid_28649, 32) * 32) &&\n                            (squot32(local_tid_28649, 32) == 0 &&\n                             ltid_in_bounds_28664)) {\n                            // read operands\n                            {\n                                x_28661 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649) -\n                                                                           sext_i32_i64(skip_threads_28666)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_28663 = add64(x_28661, x_28662);\n                                \n                                x_28661 = res_28663;\n                            }\n                        }\n                        if (sle32(wave_sizze_28651, skip_threads_28666)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n ",
                   "                       if (sle32(skip_threads_28666, local_tid_28649 -\n                                  squot32(local_tid_28649, 32) * 32) &&\n                            (squot32(local_tid_28649, 32) == 0 &&\n                             ltid_in_bounds_28664)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)] =\n                                    x_28661;\n                                x_28662 = x_28661;\n                            }\n                        }\n                        if (sle32(wave_sizze_28651, skip_threads_28666)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28666 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28649, 32) == 0 ||\n                      !ltid_in_bounds_28664)) {\n                    // read operands\n                    {\n                        x_28659 = x_28658;\n                        x_28658 = ((__local\n                                    int64_t *) scan_arr_mem_28653)[sext_i32_i64(squot32(local_tid_28649,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28660 = add64(x_28658, x_28659);\n                        \n                        x_28658 = res_28660;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)] =\n                            x",
                   "_28658;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28649, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)] =\n                        x_28659;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_27837, flat_dim_25605)) {\n                    ((__global int64_t *) mem_28270)[gtid_27837] = ((__local\n                                                                     int64_t *) scan_arr_mem_28653)[sext_i32_i64(local_tid_28649)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28667 = 0;\n                bool should_load_carry_28668 = local_tid_28649 == 0 &&\n                     !crosses_segment_28667;\n                \n                if (should_load_carry_28668) {\n                    x_25624 = ((__local\n                                int64_t *) scan_arr_mem_28653)[segscan_group_sizze_27833 -\n                                                               1];\n                }\n                if (!should_load_carry_28668) {\n                    x_25624 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27833\n}\n__kernel void testziscan_stage1_27871(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28892_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28890_backing_aligned_1,\n             ",
                   "                         int64_t res_25638, __global\n                                      unsigned char *mem_28277, __global\n                                      unsigned char *mem_28281, __global\n                                      unsigned char *mem_28283,\n                                      int32_t num_threads_28884)\n{\n    #define segscan_group_sizze_27866 (testzisegscan_group_sizze_27865)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28892_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28892_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28890_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28890_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28885;\n    int32_t local_tid_28886;\n    int64_t group_sizze_28889;\n    int32_t wave_sizze_28888;\n    int32_t group_tid_28887;\n    \n    global_tid_28885 = get_global_id(0);\n    local_tid_28886 = get_local_id(0);\n    group_sizze_28889 = get_local_size(0);\n    wave_sizze_28888 = LOCKSTEP_WIDTH;\n    group_tid_28887 = get_group_id(0);\n    \n    int32_t phys_tid_27871;\n    \n    phys_tid_27871 = global_tid_28885;\n    \n    __local char *scan_arr_mem_28890;\n    __local char *scan_arr_mem_28892;\n    \n    scan_arr_mem_28890 = (__local char *) scan_arr_mem_28890_backing_0;\n    scan_arr_mem_28892 = (__local char *) scan_arr_mem_28892_backing_1;\n    \n    bool x_25657;\n    int64_t x_25658;\n    bool x_25659;\n    int64_t x_25660;\n    \n    x_25657 = 0;\n    x_25658 = 0;\n    for (int64_t j_28894 = 0; j_28894 < sdiv_up64(res_25638,\n                                                  sext_i32_i64(num_threads_28884));\n         j_28894++) {\n        int64_t chunk_offset_28895 = segscan_group_sizze_27866 * j_28894 +\n                sext_i32_i64(group_tid_28887) * (segs",
                   "can_group_sizze_27866 *\n                                                 sdiv_up64(res_25638,\n                                                           sext_i32_i64(num_threads_28884)));\n        int64_t flat_idx_28896 = chunk_offset_28895 +\n                sext_i32_i64(local_tid_28886);\n        int64_t gtid_27870 = flat_idx_28896;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27870, res_25638)) {\n                int64_t x_25664 = ((__global int64_t *) mem_28277)[gtid_27870];\n                bool res_25665 = slt64(0, x_25664);\n                \n                // write to-scan values to parameters\n                {\n                    x_25659 = res_25665;\n                    x_25660 = x_25664;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27870, res_25638)) {\n                    x_25659 = 0;\n                    x_25660 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_25661 = x_25657 || x_25659;\n                int64_t res_25662;\n                \n                if (x_25659) {\n                    res_25662 = x_25660;\n                } else {\n                    int64_t res_25663 = add64(x_25658, x_25660);\n                    \n                    res_25662 = res_25663;\n                }\n                ((__local\n                  bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)] =\n                    res_25661;\n                ((__local\n                  int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)] =\n                    res_25662;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28897;\n            int64_t x_28898;\n          ",
                   "  bool x_28899;\n            int64_t x_28900;\n            bool x_28904;\n            int64_t x_28905;\n            bool x_28906;\n            int64_t x_28907;\n            bool ltid_in_bounds_28911;\n            \n            ltid_in_bounds_28911 = slt64(sext_i32_i64(local_tid_28886),\n                                         segscan_group_sizze_27866);\n            \n            int32_t skip_threads_28912;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28911) {\n                    x_28899 = ((volatile __local\n                                bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)];\n                    x_28900 = ((volatile __local\n                                int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)];\n                    if ((local_tid_28886 - squot32(local_tid_28886, 32) * 32) ==\n                        0) {\n                        x_28897 = x_28899;\n                        x_28898 = x_28900;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28912 = 1;\n                while (slt32(skip_threads_28912, 32)) {\n                    if (sle32(skip_threads_28912, local_tid_28886 -\n                              squot32(local_tid_28886, 32) * 32) &&\n                        ltid_in_bounds_28911) {\n                        // read operands\n                        {\n                            x_28897 = ((volatile __local\n                                        bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886) -\n                                                                    sext_i32_i64(skip_threads_28912)];\n                            x_28898 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886) -\n                                                                       sext_i32_i64(skip_threads_28912)];\n  ",
                   "                      }\n                        // perform operation\n                        {\n                            bool res_28901 = x_28897 || x_28899;\n                            int64_t res_28902;\n                            \n                            if (x_28899) {\n                                res_28902 = x_28900;\n                            } else {\n                                int64_t res_28903 = add64(x_28898, x_28900);\n                                \n                                res_28902 = res_28903;\n                            }\n                            x_28897 = res_28901;\n                            x_28898 = res_28902;\n                        }\n                    }\n                    if (sle32(wave_sizze_28888, skip_threads_28912)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28912, local_tid_28886 -\n                              squot32(local_tid_28886, 32) * 32) &&\n                        ltid_in_bounds_28911) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)] =\n                                x_28897;\n                            x_28899 = x_28897;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)] =\n                                x_28898;\n                            x_28900 = x_28898;\n                        }\n                    }\n                    if (sle32(wave_sizze_28888, skip_threads_28912)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28912 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28886 -",
                   " squot32(local_tid_28886, 32) * 32) ==\n                    31 && ltid_in_bounds_28911) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28890)[sext_i32_i64(squot32(local_tid_28886,\n                                                                       32))] =\n                        x_28897;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28892)[sext_i32_i64(squot32(local_tid_28886,\n                                                                          32))] =\n                        x_28898;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28913;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28886, 32) == 0 &&\n                        ltid_in_bounds_28911) {\n                        x_28906 = ((volatile __local\n                                    bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)];\n                        x_28907 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)];\n                        if ((local_tid_28886 - squot32(local_tid_28886, 32) *\n                             32) == 0) {\n                            x_28904 = x_28906;\n                            x_28905 = x_28907;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28913 = 1;\n                    while (slt32(skip_threads_28913, 32)) {\n                        if (sle32(skip_threads_28913, local_tid_28886 -\n                                  squot32(local_tid_28886, 32) * 32) &&\n                            (squot32(local_tid_28886, 32) == 0 &&\n                             ltid",
                   "_in_bounds_28911)) {\n                            // read operands\n                            {\n                                x_28904 = ((volatile __local\n                                            bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886) -\n                                                                        sext_i32_i64(skip_threads_28913)];\n                                x_28905 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886) -\n                                                                           sext_i32_i64(skip_threads_28913)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28908 = x_28904 || x_28906;\n                                int64_t res_28909;\n                                \n                                if (x_28906) {\n                                    res_28909 = x_28907;\n                                } else {\n                                    int64_t res_28910 = add64(x_28905, x_28907);\n                                    \n                                    res_28909 = res_28910;\n                                }\n                                x_28904 = res_28908;\n                                x_28905 = res_28909;\n                            }\n                        }\n                        if (sle32(wave_sizze_28888, skip_threads_28913)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28913, local_tid_28886 -\n                                  squot32(local_tid_28886, 32) * 32) &&\n                            (squot32(local_tid_28886, 32) == 0 &&\n                             ltid_in_bounds_28911)) {\n                            // write result\n                            {\n                                ((volatile __local\n                          ",
                   "        bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)] =\n                                    x_28904;\n                                x_28906 = x_28904;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)] =\n                                    x_28905;\n                                x_28907 = x_28905;\n                            }\n                        }\n                        if (sle32(wave_sizze_28888, skip_threads_28913)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28913 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28886, 32) == 0 ||\n                      !ltid_in_bounds_28911)) {\n                    // read operands\n                    {\n                        x_28899 = x_28897;\n                        x_28900 = x_28898;\n                        x_28897 = ((__local\n                                    bool *) scan_arr_mem_28890)[sext_i32_i64(squot32(local_tid_28886,\n                                                                                     32)) -\n                                                                1];\n                        x_28898 = ((__local\n                                    int64_t *) scan_arr_mem_28892)[sext_i32_i64(squot32(local_tid_28886,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        bool res_28901 = x_28897 || x_28899;\n                        int64_t res_28902;\n                        \n                        if (x_28899) {\n                            res_2",
                   "8902 = x_28900;\n                        } else {\n                            int64_t res_28903 = add64(x_28898, x_28900);\n                            \n                            res_28902 = res_28903;\n                        }\n                        x_28897 = res_28901;\n                        x_28898 = res_28902;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)] =\n                            x_28897;\n                        ((__local\n                          int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)] =\n                            x_28898;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28886, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)] =\n                        x_28899;\n                    ((__local\n                      int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)] =\n                        x_28900;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_27870, res_25638)) {\n                    ((__global bool *) mem_28281)[gtid_27870] = ((__local\n                                                                  bool *) scan_arr_mem_28890)[sext_i32_i64(local_tid_28886)];\n                    ((__global int64_t *) mem_28283)[gtid_27870] = ((__local\n                                                                     int64_t *) scan_arr_mem_28892)[sext_i32_i64(local_tid_28886)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n ",
                   "           {\n                bool crosses_segment_28914 = 0;\n                bool should_load_carry_28915 = local_tid_28886 == 0 &&\n                     !crosses_segment_28914;\n                \n                if (should_load_carry_28915) {\n                    x_25657 = ((__local\n                                bool *) scan_arr_mem_28890)[segscan_group_sizze_27866 -\n                                                            1];\n                    x_25658 = ((__local\n                                int64_t *) scan_arr_mem_28892)[segscan_group_sizze_27866 -\n                                                               1];\n                }\n                if (!should_load_carry_28915) {\n                    x_25657 = 0;\n                    x_25658 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27866\n}\n__kernel void testziscan_stage1_27879(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28959_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28957_backing_aligned_1,\n                                      int64_t res_25638, __global\n                                      unsigned char *mem_28283, __global\n                                      unsigned char *mem_28286, __global\n                                      unsigned char *mem_28288, __global\n                                      unsigned char *mem_28290,\n                                      int32_t num_threads_28951)\n{\n    #define segscan_group_sizze_27874 (testzisegscan_group_sizze_27873)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28959_backing_1 =\n                          (__local volatile\n                           char *) sca",
                   "n_arr_mem_28959_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28957_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28957_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28952;\n    int32_t local_tid_28953;\n    int64_t group_sizze_28956;\n    int32_t wave_sizze_28955;\n    int32_t group_tid_28954;\n    \n    global_tid_28952 = get_global_id(0);\n    local_tid_28953 = get_local_id(0);\n    group_sizze_28956 = get_local_size(0);\n    wave_sizze_28955 = LOCKSTEP_WIDTH;\n    group_tid_28954 = get_group_id(0);\n    \n    int32_t phys_tid_27879;\n    \n    phys_tid_27879 = global_tid_28952;\n    \n    __local char *scan_arr_mem_28957;\n    __local char *scan_arr_mem_28959;\n    \n    scan_arr_mem_28957 = (__local char *) scan_arr_mem_28957_backing_0;\n    scan_arr_mem_28959 = (__local char *) scan_arr_mem_28959_backing_1;\n    \n    bool x_25696;\n    int64_t x_25697;\n    bool x_25698;\n    int64_t x_25699;\n    \n    x_25696 = 0;\n    x_25697 = 0;\n    for (int64_t j_28961 = 0; j_28961 < sdiv_up64(res_25638,\n                                                  sext_i32_i64(num_threads_28951));\n         j_28961++) {\n        int64_t chunk_offset_28962 = segscan_group_sizze_27874 * j_28961 +\n                sext_i32_i64(group_tid_28954) * (segscan_group_sizze_27874 *\n                                                 sdiv_up64(res_25638,\n                                                           sext_i32_i64(num_threads_28951)));\n        int64_t flat_idx_28963 = chunk_offset_28962 +\n                sext_i32_i64(local_tid_28953);\n        int64_t gtid_27878 = flat_idx_28963;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27878, res_25638)) {\n                int64_t x_25703 = ((__global int64_t *) mem_28283)[gtid_27878];\n                int64_t i_p_o_28118 = add64(-1, gtid_27878);\n                int64_t rot_i_28119 = smod64(i_p_o_28118, res_25",
                   "638);\n                int64_t x_25704 = ((__global int64_t *) mem_28283)[rot_i_28119];\n                bool res_25706 = x_25703 == x_25704;\n                bool res_25707 = !res_25706;\n                \n                // write to-scan values to parameters\n                {\n                    x_25698 = res_25707;\n                    x_25699 = 1;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global bool *) mem_28290)[gtid_27878] = res_25707;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27878, res_25638)) {\n                    x_25698 = 0;\n                    x_25699 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_25700 = x_25696 || x_25698;\n                int64_t res_25701;\n                \n                if (x_25698) {\n                    res_25701 = x_25699;\n                } else {\n                    int64_t res_25702 = add64(x_25697, x_25699);\n                    \n                    res_25701 = res_25702;\n                }\n                ((__local\n                  bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)] =\n                    res_25700;\n                ((__local\n                  int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953)] =\n                    res_25701;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28964;\n            int64_t x_28965;\n            bool x_28966;\n            int64_t x_28967;\n            bool x_28971;\n            int64_t x_28972;\n            bool x_28973;\n            int64_t x_28974;\n            bool ltid_in_bounds_28978;\n            \n            ltid_in_bounds_28978 = slt64(sext_i32_i64(local_tid_28953),\n                        ",
                   "                 segscan_group_sizze_27874);\n            \n            int32_t skip_threads_28979;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28978) {\n                    x_28966 = ((volatile __local\n                                bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)];\n                    x_28967 = ((volatile __local\n                                int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953)];\n                    if ((local_tid_28953 - squot32(local_tid_28953, 32) * 32) ==\n                        0) {\n                        x_28964 = x_28966;\n                        x_28965 = x_28967;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28979 = 1;\n                while (slt32(skip_threads_28979, 32)) {\n                    if (sle32(skip_threads_28979, local_tid_28953 -\n                              squot32(local_tid_28953, 32) * 32) &&\n                        ltid_in_bounds_28978) {\n                        // read operands\n                        {\n                            x_28964 = ((volatile __local\n                                        bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953) -\n                                                                    sext_i32_i64(skip_threads_28979)];\n                            x_28965 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953) -\n                                                                       sext_i32_i64(skip_threads_28979)];\n                        }\n                        // perform operation\n                        {\n                            bool res_28968 = x_28964 || x_28966;\n                            int64_t res_28969;\n                            \n                            if (x_28966) {\n                        ",
                   "        res_28969 = x_28967;\n                            } else {\n                                int64_t res_28970 = add64(x_28965, x_28967);\n                                \n                                res_28969 = res_28970;\n                            }\n                            x_28964 = res_28968;\n                            x_28965 = res_28969;\n                        }\n                    }\n                    if (sle32(wave_sizze_28955, skip_threads_28979)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28979, local_tid_28953 -\n                              squot32(local_tid_28953, 32) * 32) &&\n                        ltid_in_bounds_28978) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)] =\n                                x_28964;\n                            x_28966 = x_28964;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953)] =\n                                x_28965;\n                            x_28967 = x_28965;\n                        }\n                    }\n                    if (sle32(wave_sizze_28955, skip_threads_28979)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28979 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28953 - squot32(local_tid_28953, 32) * 32) ==\n                    31 && ltid_in_bounds_28978) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28957)[sext_i32_i64(squot32(local_tid_28953,\n                                                                       32))] =\n        ",
                   "                x_28964;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28959)[sext_i32_i64(squot32(local_tid_28953,\n                                                                          32))] =\n                        x_28965;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28980;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28953, 32) == 0 &&\n                        ltid_in_bounds_28978) {\n                        x_28973 = ((volatile __local\n                                    bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)];\n                        x_28974 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953)];\n                        if ((local_tid_28953 - squot32(local_tid_28953, 32) *\n                             32) == 0) {\n                            x_28971 = x_28973;\n                            x_28972 = x_28974;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28980 = 1;\n                    while (slt32(skip_threads_28980, 32)) {\n                        if (sle32(skip_threads_28980, local_tid_28953 -\n                                  squot32(local_tid_28953, 32) * 32) &&\n                            (squot32(local_tid_28953, 32) == 0 &&\n                             ltid_in_bounds_28978)) {\n                            // read operands\n                            {\n                                x_28971 = ((volatile __local\n                                            bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953) -\n                                          ",
                   "                              sext_i32_i64(skip_threads_28980)];\n                                x_28972 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953) -\n                                                                           sext_i32_i64(skip_threads_28980)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28975 = x_28971 || x_28973;\n                                int64_t res_28976;\n                                \n                                if (x_28973) {\n                                    res_28976 = x_28974;\n                                } else {\n                                    int64_t res_28977 = add64(x_28972, x_28974);\n                                    \n                                    res_28976 = res_28977;\n                                }\n                                x_28971 = res_28975;\n                                x_28972 = res_28976;\n                            }\n                        }\n                        if (sle32(wave_sizze_28955, skip_threads_28980)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28980, local_tid_28953 -\n                                  squot32(local_tid_28953, 32) * 32) &&\n                            (squot32(local_tid_28953, 32) == 0 &&\n                             ltid_in_bounds_28978)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)] =\n                                    x_28971;\n                                x_28973 = x_28971;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid",
                   "_28953)] =\n                                    x_28972;\n                                x_28974 = x_28972;\n                            }\n                        }\n                        if (sle32(wave_sizze_28955, skip_threads_28980)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28980 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28953, 32) == 0 ||\n                      !ltid_in_bounds_28978)) {\n                    // read operands\n                    {\n                        x_28966 = x_28964;\n                        x_28967 = x_28965;\n                        x_28964 = ((__local\n                                    bool *) scan_arr_mem_28957)[sext_i32_i64(squot32(local_tid_28953,\n                                                                                     32)) -\n                                                                1];\n                        x_28965 = ((__local\n                                    int64_t *) scan_arr_mem_28959)[sext_i32_i64(squot32(local_tid_28953,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        bool res_28968 = x_28964 || x_28966;\n                        int64_t res_28969;\n                        \n                        if (x_28966) {\n                            res_28969 = x_28967;\n                        } else {\n                            int64_t res_28970 = add64(x_28965, x_28967);\n                            \n                            res_28969 = res_28970;\n                        }\n                        x_28964 = res_28968;\n                        x_2896",
                   "5 = res_28969;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)] =\n                            x_28964;\n                        ((__local\n                          int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953)] =\n                            x_28965;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28953, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)] =\n                        x_28966;\n                    ((__local\n                      int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953)] =\n                        x_28967;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_27878, res_25638)) {\n                    ((__global bool *) mem_28286)[gtid_27878] = ((__local\n                                                                  bool *) scan_arr_mem_28957)[sext_i32_i64(local_tid_28953)];\n                    ((__global int64_t *) mem_28288)[gtid_27878] = ((__local\n                                                                     int64_t *) scan_arr_mem_28959)[sext_i32_i64(local_tid_28953)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28981 = 0;\n                bool should_load_carry_28982 = local_tid_28953 == 0 &&\n                     !crosses_segment_28981;\n                \n                if (should_load_carry_28982) {\n                    x_25696 = ((__local\n                      ",
                   "          bool *) scan_arr_mem_28957)[segscan_group_sizze_27874 -\n                                                            1];\n                    x_25697 = ((__local\n                                int64_t *) scan_arr_mem_28959)[segscan_group_sizze_27874 -\n                                                               1];\n                }\n                if (!should_load_carry_28982) {\n                    x_25696 = 0;\n                    x_25697 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27874\n}\n__kernel void testziscan_stage1_27887(__global int *global_failure,\n                                      int failure_is_an_option, __global\n                                      int64_t *global_failure_args,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29026_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29024_backing_aligned_1,\n                                      int64_t paths_25438,\n                                      int64_t flat_dim_25605, float res_25618,\n                                      int64_t res_25638, int64_t i_27764,\n                                      __global unsigned char *res_mem_28236,\n                                      __global unsigned char *res_mem_28237,\n                                      __global unsigned char *res_mem_28238,\n                                      __global unsigned char *res_mem_28239,\n                                      __global unsigned char *mem_28267,\n                                      __global unsigned char *mem_28283,\n                                      __global unsigned char *mem_28288,\n                                      __global unsigned char *mem_28290,\n                                      __global unsigned char *mem_28293,\n         ",
                   "                             __global unsigned char *mem_28295,\n                                      int32_t num_threads_29018)\n{\n    #define segscan_group_sizze_27882 (testzisegscan_group_sizze_27881)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29026_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_29026_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29024_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29024_backing_aligned_1;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29019;\n    int32_t local_tid_29020;\n    int64_t group_sizze_29023;\n    int32_t wave_sizze_29022;\n    int32_t group_tid_29021;\n    \n    global_tid_29019 = get_global_id(0);\n    local_tid_29020 = get_local_id(0);\n    group_sizze_29023 = get_local_size(0);\n    wave_sizze_29022 = LOCKSTEP_WIDTH;\n    group_tid_29021 = get_group_id(0);\n    \n    int32_t phys_tid_27887;\n    \n    phys_tid_27887 = global_tid_29019;\n    \n    __local char *scan_arr_mem_29024;\n    __local char *scan_arr_mem_29026;\n    \n    scan_arr_mem_29024 = (__local char *) scan_arr_mem_29024_backing_0;\n    scan_arr_mem_29026 = (__local char *) scan_arr_mem_29026_backing_1;\n    \n    bool x_25722;\n    float x_25723;\n    bool x_25724;\n    float x_25725;\n    \n    x_25722 = 0;\n    x_25723 = 0.0F;\n    for (int64_t j_29028 = 0; j_29028 < sdiv_up64(res_25638,\n                                                  sext_i32_i64(num_threads_29018));\n         j_29028++) {\n        int64_t chunk_offset_29029 = segscan_group_sizze_27882 * j_29028 +\n                sext_i32_i64(group_tid_29021) * (segscan_group_sizz",
                   "e_27882 *\n                                                 sdiv_up64(res_25638,\n                                                           sext_i32_i64(num_threads_29018)));\n        int64_t flat_idx_29030 = chunk_offset_29029 +\n                sext_i32_i64(local_tid_29020);\n        int64_t gtid_27886 = flat_idx_29030;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27886, res_25638)) {\n                int64_t x_25730 = ((__global int64_t *) mem_28288)[gtid_27886];\n                int64_t x_25731 = ((__global int64_t *) mem_28283)[gtid_27886];\n                bool x_25732 = ((__global bool *) mem_28290)[gtid_27886];\n                int64_t res_25735 = sub64(x_25730, 1);\n                bool x_25736 = sle64(0, x_25731);\n                bool y_25737 = slt64(x_25731, flat_dim_25605);\n                bool bounds_check_25738 = x_25736 && y_25737;\n                bool index_certs_25739;\n                \n                if (!bounds_check_25738) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 17) ==\n                            -1) {\n                            global_failure_args[0] = x_25731;\n                            global_failure_args[1] = flat_dim_25605;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t new_index_25740 = squot64(x_25731, 9);\n                int64_t binop_y_25741 = 9 * new_index_25740;\n                int64_t new_index_25742 = x_25731 - binop_y_25741;\n                int64_t lifted_0_get_arg_25746 = ((__global\n                                                   int64_t *) res_mem_28238)[new_index_25742];\n                float lifted_0_get_arg_25747 = ((__global\n                                                 float *) res_mem_28239)[new_index_25742];\n                float x_25748 = res_25618 / lifte",
                   "d_0_get_arg_25747;\n                float ceil_arg_25749 = x_25748 - 1.0F;\n                float res_25750;\n                \n                res_25750 = futrts_ceil32(ceil_arg_25749);\n                \n                int64_t res_25751 = fptosi_f32_i64(res_25750);\n                int64_t max_arg_25752 = sub64(lifted_0_get_arg_25746,\n                                              res_25751);\n                int64_t res_25753 = smax64(0, max_arg_25752);\n                bool cond_25754 = res_25753 == 0;\n                float res_25755;\n                \n                if (cond_25754) {\n                    res_25755 = 0.0F;\n                } else {\n                    float lifted_0_get_arg_25743 = ((__global\n                                                     float *) mem_28267)[i_27764 *\n                                                                         paths_25438 +\n                                                                         new_index_25740];\n                    float lifted_0_get_arg_25744 = ((__global\n                                                     float *) res_mem_28236)[new_index_25742];\n                    float lifted_0_get_arg_25745 = ((__global\n                                                     float *) res_mem_28237)[new_index_25742];\n                    float res_25756;\n                    \n                    res_25756 = futrts_ceil32(x_25748);\n                    \n                    float start_25757 = lifted_0_get_arg_25747 * res_25756;\n                    float res_25758;\n                    \n                    res_25758 = futrts_ceil32(ceil_arg_25749);\n                    \n                    int64_t res_25759 = fptosi_f32_i64(res_25758);\n                    int64_t max_arg_25760 = sub64(lifted_0_get_arg_25746,\n                                                  res_25759);\n                    int64_t res_25761 = smax64(0, max_arg_25760);\n                    int64_t sizze_25762 = sub64(res_25761, 1);\n                    bool con",
                   "d_25763 = res_25735 == 0;\n                    float res_25764;\n                    \n                    if (cond_25763) {\n                        res_25764 = 1.0F;\n                    } else {\n                        res_25764 = 0.0F;\n                    }\n                    \n                    bool cond_25765 = slt64(0, res_25735);\n                    float res_25766;\n                    \n                    if (cond_25765) {\n                        float y_25767 = lifted_0_get_arg_25744 *\n                              lifted_0_get_arg_25747;\n                        float res_25768 = res_25764 - y_25767;\n                        \n                        res_25766 = res_25768;\n                    } else {\n                        res_25766 = res_25764;\n                    }\n                    \n                    bool cond_25769 = res_25735 == sizze_25762;\n                    float res_25770;\n                    \n                    if (cond_25769) {\n                        float res_25771 = res_25766 - 1.0F;\n                        \n                        res_25770 = res_25771;\n                    } else {\n                        res_25770 = res_25766;\n                    }\n                    \n                    float res_25772 = lifted_0_get_arg_25745 * res_25770;\n                    float res_25773 = sitofp_i64_f32(res_25735);\n                    float y_25774 = lifted_0_get_arg_25747 * res_25773;\n                    float bondprice_arg_25775 = start_25757 + y_25774;\n                    float y_25776 = bondprice_arg_25775 - res_25618;\n                    float negate_arg_25777 = 1.0e-2F * y_25776;\n                    float exp_arg_25778 = 0.0F - negate_arg_25777;\n                    float res_25779 = fpow32(2.7182817F, exp_arg_25778);\n                    float x_25780 = 1.0F - res_25779;\n                    float B_25781 = x_25780 / 1.0e-2F;\n                    float x_25782 = B_25781 - bondprice_arg_25775;\n                    float x_25783 = res_25618 + x_25",
                   "782;\n                    float x_25784 = 4.4999997e-6F * x_25783;\n                    float A1_25785 = x_25784 / 1.0e-4F;\n                    float y_25786 = fpow32(B_25781, 2.0F);\n                    float x_25787 = 1.0000001e-6F * y_25786;\n                    float A2_25788 = x_25787 / 4.0e-2F;\n                    float exp_arg_25789 = A1_25785 - A2_25788;\n                    float res_25790 = fpow32(2.7182817F, exp_arg_25789);\n                    float negate_arg_25791 = lifted_0_get_arg_25743 * B_25781;\n                    float exp_arg_25792 = 0.0F - negate_arg_25791;\n                    float res_25793 = fpow32(2.7182817F, exp_arg_25792);\n                    float res_25794 = res_25790 * res_25793;\n                    float res_25795 = res_25772 * res_25794;\n                    \n                    res_25755 = res_25795;\n                }\n                // write to-scan values to parameters\n                {\n                    x_25724 = x_25732;\n                    x_25725 = res_25755;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27886, res_25638)) {\n                    x_25724 = 0;\n                    x_25725 = 0.0F;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_25726 = x_25722 || x_25724;\n                float res_25727;\n                \n                if (x_25724) {\n                    res_25727 = x_25725;\n                } else {\n                    float res_25728 = x_25723 + x_25725;\n                    \n                    res_25727 = res_25728;\n                }\n                ((__local\n                  bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)] =\n                    res_25726;\n             ",
                   "   ((__local\n                  float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)] =\n                    res_25727;\n            }\n            \n          error_0:\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_failure)\n                return;\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_29031;\n            float x_29032;\n            bool x_29033;\n            float x_29034;\n            bool x_29038;\n            float x_29039;\n            bool x_29040;\n            float x_29041;\n            bool ltid_in_bounds_29045;\n            \n            ltid_in_bounds_29045 = slt64(sext_i32_i64(local_tid_29020),\n                                         segscan_group_sizze_27882);\n            \n            int32_t skip_threads_29046;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_29045) {\n                    x_29033 = ((volatile __local\n                                bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)];\n                    x_29034 = ((volatile __local\n                                float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)];\n                    if ((local_tid_29020 - squot32(local_tid_29020, 32) * 32) ==\n                        0) {\n                        x_29031 = x_29033;\n                        x_29032 = x_29034;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29046 = 1;\n                while (slt32(skip_threads_29046, 32)) {\n                    if (sle32(skip_threads_29046, local_tid_29020 -\n                              squot32(local_tid_29020, 32) * 32) &&\n                        ltid_in_bounds_29045) {\n                        // read operands\n                        {\n                            x_29031 = ((volatile __local\n                                        bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_290",
                   "20) -\n                                                                    sext_i32_i64(skip_threads_29046)];\n                            x_29032 = ((volatile __local\n                                        float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020) -\n                                                                     sext_i32_i64(skip_threads_29046)];\n                        }\n                        // perform operation\n                        {\n                            bool res_29035 = x_29031 || x_29033;\n                            float res_29036;\n                            \n                            if (x_29033) {\n                                res_29036 = x_29034;\n                            } else {\n                                float res_29037 = x_29032 + x_29034;\n                                \n                                res_29036 = res_29037;\n                            }\n                            x_29031 = res_29035;\n                            x_29032 = res_29036;\n                        }\n                    }\n                    if (sle32(wave_sizze_29022, skip_threads_29046)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29046, local_tid_29020 -\n                              squot32(local_tid_29020, 32) * 32) &&\n                        ltid_in_bounds_29045) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)] =\n                                x_29031;\n                            x_29033 = x_29031;\n                            ((volatile __local\n                              float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)] =\n                                x_29032;\n                            x_29034 = x_29032;\n                        }\n                    }\n                    if (sle32",
                   "(wave_sizze_29022, skip_threads_29046)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29046 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_29020 - squot32(local_tid_29020, 32) * 32) ==\n                    31 && ltid_in_bounds_29045) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_29024)[sext_i32_i64(squot32(local_tid_29020,\n                                                                       32))] =\n                        x_29031;\n                    ((volatile __local\n                      float *) scan_arr_mem_29026)[sext_i32_i64(squot32(local_tid_29020,\n                                                                        32))] =\n                        x_29032;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_29047;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_29020, 32) == 0 &&\n                        ltid_in_bounds_29045) {\n                        x_29040 = ((volatile __local\n                                    bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)];\n                        x_29041 = ((volatile __local\n                                    float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)];\n                        if ((local_tid_29020 - squot32(local_tid_29020, 32) *\n                             32) == 0) {\n                            x_29038 = x_29040;\n                            x_29039 = x_29041;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n          ",
                   "      {\n                    skip_threads_29047 = 1;\n                    while (slt32(skip_threads_29047, 32)) {\n                        if (sle32(skip_threads_29047, local_tid_29020 -\n                                  squot32(local_tid_29020, 32) * 32) &&\n                            (squot32(local_tid_29020, 32) == 0 &&\n                             ltid_in_bounds_29045)) {\n                            // read operands\n                            {\n                                x_29038 = ((volatile __local\n                                            bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020) -\n                                                                        sext_i32_i64(skip_threads_29047)];\n                                x_29039 = ((volatile __local\n                                            float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020) -\n                                                                         sext_i32_i64(skip_threads_29047)];\n                            }\n                            // perform operation\n                            {\n                                bool res_29042 = x_29038 || x_29040;\n                                float res_29043;\n                                \n                                if (x_29040) {\n                                    res_29043 = x_29041;\n                                } else {\n                                    float res_29044 = x_29039 + x_29041;\n                                    \n                                    res_29043 = res_29044;\n                                }\n                                x_29038 = res_29042;\n                                x_29039 = res_29043;\n                            }\n                        }\n                        if (sle32(wave_sizze_29022, skip_threads_29047)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29047, local_tid_29020 -\n  ",
                   "                                squot32(local_tid_29020, 32) * 32) &&\n                            (squot32(local_tid_29020, 32) == 0 &&\n                             ltid_in_bounds_29045)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)] =\n                                    x_29038;\n                                x_29040 = x_29038;\n                                ((volatile __local\n                                  float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)] =\n                                    x_29039;\n                                x_29041 = x_29039;\n                            }\n                        }\n                        if (sle32(wave_sizze_29022, skip_threads_29047)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29047 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_29020, 32) == 0 ||\n                      !ltid_in_bounds_29045)) {\n                    // read operands\n                    {\n                        x_29033 = x_29031;\n                        x_29034 = x_29032;\n                        x_29031 = ((__local\n                                    bool *) scan_arr_mem_29024)[sext_i32_i64(squot32(local_tid_29020,\n                                                                                     32)) -\n                                                                1];\n                        x_29032 = ((__local\n                                    float *) scan_arr_mem_29026)[sext_i32_i64(squot32(local_tid_29020,\n                                                                                      32)) -\n                      ",
                   "                                           1];\n                    }\n                    // perform operation\n                    {\n                        bool res_29035 = x_29031 || x_29033;\n                        float res_29036;\n                        \n                        if (x_29033) {\n                            res_29036 = x_29034;\n                        } else {\n                            float res_29037 = x_29032 + x_29034;\n                            \n                            res_29036 = res_29037;\n                        }\n                        x_29031 = res_29035;\n                        x_29032 = res_29036;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)] =\n                            x_29031;\n                        ((__local\n                          float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)] =\n                            x_29032;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_29020, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)] =\n                        x_29033;\n                    ((__local\n                      float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)] =\n                        x_29034;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_27886, res_25638)) {\n                    ((__global bool *) mem_28293)[gtid_27886] = ((__local\n                                                                  bool *) scan_arr_mem_29024)[sext_i32_i64(local_tid_29020)];\n                    ((__global float *) mem",
                   "_28295)[gtid_27886] = ((__local\n                                                                   float *) scan_arr_mem_29026)[sext_i32_i64(local_tid_29020)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_29048 = 0;\n                bool should_load_carry_29049 = local_tid_29020 == 0 &&\n                     !crosses_segment_29048;\n                \n                if (should_load_carry_29049) {\n                    x_25722 = ((__local\n                                bool *) scan_arr_mem_29024)[segscan_group_sizze_27882 -\n                                                            1];\n                    x_25723 = ((__local\n                                float *) scan_arr_mem_29026)[segscan_group_sizze_27882 -\n                                                             1];\n                }\n                if (!should_load_carry_29049) {\n                    x_25722 = 0;\n                    x_25723 = 0.0F;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27882\n}\n__kernel void testziscan_stage1_27939(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29091_backing_aligned_0,\n                                      int64_t res_25638, __global\n                                      unsigned char *mem_28290, __global\n                                      unsigned char *mem_28298,\n                                      int32_t num_threads_29085)\n{\n    #define segscan_group_sizze_27934 (testzisegscan_group_sizze_27933)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29091_backing_0 =\n                          (__local volatile\n            ",
                   "               char *) scan_arr_mem_29091_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29086;\n    int32_t local_tid_29087;\n    int64_t group_sizze_29090;\n    int32_t wave_sizze_29089;\n    int32_t group_tid_29088;\n    \n    global_tid_29086 = get_global_id(0);\n    local_tid_29087 = get_local_id(0);\n    group_sizze_29090 = get_local_size(0);\n    wave_sizze_29089 = LOCKSTEP_WIDTH;\n    group_tid_29088 = get_group_id(0);\n    \n    int32_t phys_tid_27939;\n    \n    phys_tid_27939 = global_tid_29086;\n    \n    __local char *scan_arr_mem_29091;\n    \n    scan_arr_mem_29091 = (__local char *) scan_arr_mem_29091_backing_0;\n    \n    int64_t x_25819;\n    int64_t x_25820;\n    \n    x_25819 = 0;\n    for (int64_t j_29093 = 0; j_29093 < sdiv_up64(res_25638,\n                                                  sext_i32_i64(num_threads_29085));\n         j_29093++) {\n        int64_t chunk_offset_29094 = segscan_group_sizze_27934 * j_29093 +\n                sext_i32_i64(group_tid_29088) * (segscan_group_sizze_27934 *\n                                                 sdiv_up64(res_25638,\n                                                           sext_i32_i64(num_threads_29085)));\n        int64_t flat_idx_29095 = chunk_offset_29094 +\n                sext_i32_i64(local_tid_29087);\n        int64_t gtid_27938 = flat_idx_29095;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27938, res_25638)) {\n                int64_t i_p_o_28120 = add64(1, gtid_27938);\n                int64_t rot_i_28121 = smod64(i_p_o_28120, res_25638);\n                bool x_25822 = ((__global bool *) mem_28290)[rot_i_28121];\n                int64_t res_25823 = btoi_bool_i64(x_25822);\n                \n                // write to-scan values to parameters\n                {\n                    x_25820 = res_25823;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n     ",
                   "   // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27938, res_25638)) {\n                    x_25820 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_25821 = add64(x_25819, x_25820);\n                \n                ((__local\n                  int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)] =\n                    res_25821;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_29096;\n            int64_t x_29097;\n            int64_t x_29099;\n            int64_t x_29100;\n            bool ltid_in_bounds_29102;\n            \n            ltid_in_bounds_29102 = slt64(sext_i32_i64(local_tid_29087),\n                                         segscan_group_sizze_27934);\n            \n            int32_t skip_threads_29103;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_29102) {\n                    x_29097 = ((volatile __local\n                                int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)];\n                    if ((local_tid_29087 - squot32(local_tid_29087, 32) * 32) ==\n                        0) {\n                        x_29096 = x_29097;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29103 = 1;\n                while (slt32(skip_threads_29103, 32)) {\n                    if (sle32(skip_threads_29103, local_tid_29087 -\n                              squot32(local_tid_29087, 32) * 32) &&\n                        ltid_in_bounds_29102) {\n                        // read operands\n                        {\n                            x_29096 = ((volatile __local\n                                        int64_t *) scan_arr_mem_29091)[s",
                   "ext_i32_i64(local_tid_29087) -\n                                                                       sext_i32_i64(skip_threads_29103)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_29098 = add64(x_29096, x_29097);\n                            \n                            x_29096 = res_29098;\n                        }\n                    }\n                    if (sle32(wave_sizze_29089, skip_threads_29103)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29103, local_tid_29087 -\n                              squot32(local_tid_29087, 32) * 32) &&\n                        ltid_in_bounds_29102) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)] =\n                                x_29096;\n                            x_29097 = x_29096;\n                        }\n                    }\n                    if (sle32(wave_sizze_29089, skip_threads_29103)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29103 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_29087 - squot32(local_tid_29087, 32) * 32) ==\n                    31 && ltid_in_bounds_29102) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29091)[sext_i32_i64(squot32(local_tid_29087,\n                                                                          32))] =\n                        x_29096;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n ",
                   "           {\n                int32_t skip_threads_29104;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_29087, 32) == 0 &&\n                        ltid_in_bounds_29102) {\n                        x_29100 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)];\n                        if ((local_tid_29087 - squot32(local_tid_29087, 32) *\n                             32) == 0) {\n                            x_29099 = x_29100;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29104 = 1;\n                    while (slt32(skip_threads_29104, 32)) {\n                        if (sle32(skip_threads_29104, local_tid_29087 -\n                                  squot32(local_tid_29087, 32) * 32) &&\n                            (squot32(local_tid_29087, 32) == 0 &&\n                             ltid_in_bounds_29102)) {\n                            // read operands\n                            {\n                                x_29099 = ((volatile __local\n                                            int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087) -\n                                                                           sext_i32_i64(skip_threads_29104)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_29101 = add64(x_29099, x_29100);\n                                \n                                x_29099 = res_29101;\n                            }\n                        }\n                        if (sle32(wave_sizze_29089, skip_threads_29104)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29104, local_tid_29087 -\n     ",
                   "                             squot32(local_tid_29087, 32) * 32) &&\n                            (squot32(local_tid_29087, 32) == 0 &&\n                             ltid_in_bounds_29102)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)] =\n                                    x_29099;\n                                x_29100 = x_29099;\n                            }\n                        }\n                        if (sle32(wave_sizze_29089, skip_threads_29104)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29104 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_29087, 32) == 0 ||\n                      !ltid_in_bounds_29102)) {\n                    // read operands\n                    {\n                        x_29097 = x_29096;\n                        x_29096 = ((__local\n                                    int64_t *) scan_arr_mem_29091)[sext_i32_i64(squot32(local_tid_29087,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_29098 = add64(x_29096, x_29097);\n                        \n                        x_29096 = res_29098;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)] =\n                            x_29096;\n                    }\n                }\n            }\n            ba",
                   "rrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_29087, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)] =\n                        x_29097;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_27938, res_25638)) {\n                    ((__global int64_t *) mem_28298)[gtid_27938] = ((__local\n                                                                     int64_t *) scan_arr_mem_29091)[sext_i32_i64(local_tid_29087)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_29105 = 0;\n                bool should_load_carry_29106 = local_tid_29087 == 0 &&\n                     !crosses_segment_29105;\n                \n                if (should_load_carry_29106) {\n                    x_25819 = ((__local\n                                int64_t *) scan_arr_mem_29091)[segscan_group_sizze_27934 -\n                                                               1];\n                }\n                if (!should_load_carry_29106) {\n                    x_25819 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27934\n}\n__kernel void testziscan_stage2_27838(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28674_backing_aligned_0,\n                                      int64_t flat_dim_25605, __global\n                                      unsigned char *mem_28270,\n                                      int64_t stage1_num_groups_28646,\n                            ",
                   "          int32_t num_threads_28647)\n{\n    #define segscan_group_sizze_27833 (testzisegscan_group_sizze_27832)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28674_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28674_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28669;\n    int32_t local_tid_28670;\n    int64_t group_sizze_28673;\n    int32_t wave_sizze_28672;\n    int32_t group_tid_28671;\n    \n    global_tid_28669 = get_global_id(0);\n    local_tid_28670 = get_local_id(0);\n    group_sizze_28673 = get_local_size(0);\n    wave_sizze_28672 = LOCKSTEP_WIDTH;\n    group_tid_28671 = get_group_id(0);\n    \n    int32_t phys_tid_27838;\n    \n    phys_tid_27838 = global_tid_28669;\n    \n    __local char *scan_arr_mem_28674;\n    \n    scan_arr_mem_28674 = (__local char *) scan_arr_mem_28674_backing_0;\n    \n    int64_t flat_idx_28676;\n    \n    flat_idx_28676 = (sext_i32_i64(local_tid_28670) + 1) *\n        (segscan_group_sizze_27833 * sdiv_up64(flat_dim_25605,\n                                               sext_i32_i64(num_threads_28647))) -\n        1;\n    \n    int64_t gtid_27837;\n    \n    gtid_27837 = flat_idx_28676;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27837, flat_dim_25605)) {\n            ((__local\n              int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)] =\n                ((__global int64_t *) mem_28270)[gtid_27837];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_25624;\n    int64_t x_25625;\n    int64_t x_28677;\n    int64_t x_28678;\n    bool ltid_in_bounds_28680;\n    \n    ltid_in_bounds_28680 = slt64(sext_i32_i64(local_tid_28670),\n                                 stage1_",
                   "num_groups_28646);\n    \n    int32_t skip_threads_28681;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28680) {\n            x_25625 = ((volatile __local\n                        int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)];\n            if ((local_tid_28670 - squot32(local_tid_28670, 32) * 32) == 0) {\n                x_25624 = x_25625;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28681 = 1;\n        while (slt32(skip_threads_28681, 32)) {\n            if (sle32(skip_threads_28681, local_tid_28670 -\n                      squot32(local_tid_28670, 32) * 32) &&\n                ltid_in_bounds_28680) {\n                // read operands\n                {\n                    x_25624 = ((volatile __local\n                                int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670) -\n                                                               sext_i32_i64(skip_threads_28681)];\n                }\n                // perform operation\n                {\n                    int64_t res_25626 = add64(x_25624, x_25625);\n                    \n                    x_25624 = res_25626;\n                }\n            }\n            if (sle32(wave_sizze_28672, skip_threads_28681)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28681, local_tid_28670 -\n                      squot32(local_tid_28670, 32) * 32) &&\n                ltid_in_bounds_28680) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)] =\n                        x_25624;\n                    x_25625 = x_25624;\n                }\n            }\n            if (sle32(wave_sizze_28672, skip_threads_28681)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28681 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FEN",
                   "CE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28670 - squot32(local_tid_28670, 32) * 32) == 31 &&\n            ltid_in_bounds_28680) {\n            ((volatile __local\n              int64_t *) scan_arr_mem_28674)[sext_i32_i64(squot32(local_tid_28670,\n                                                                  32))] =\n                x_25624;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28682;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28670, 32) == 0 && ltid_in_bounds_28680) {\n                x_28678 = ((volatile __local\n                            int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)];\n                if ((local_tid_28670 - squot32(local_tid_28670, 32) * 32) ==\n                    0) {\n                    x_28677 = x_28678;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28682 = 1;\n            while (slt32(skip_threads_28682, 32)) {\n                if (sle32(skip_threads_28682, local_tid_28670 -\n                          squot32(local_tid_28670, 32) * 32) &&\n                    (squot32(local_tid_28670, 32) == 0 &&\n                     ltid_in_bounds_28680)) {\n                    // read operands\n                    {\n                        x_28677 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670) -\n                                                                   sext_i32_i64(skip_threads_28682)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28679 = add64(x_28677, x_28678);\n                        \n                        x_28677 = res_28679;\n                    }\n                }\n     ",
                   "           if (sle32(wave_sizze_28672, skip_threads_28682)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28682, local_tid_28670 -\n                          squot32(local_tid_28670, 32) * 32) &&\n                    (squot32(local_tid_28670, 32) == 0 &&\n                     ltid_in_bounds_28680)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)] =\n                            x_28677;\n                        x_28678 = x_28677;\n                    }\n                }\n                if (sle32(wave_sizze_28672, skip_threads_28682)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28682 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28670, 32) == 0 || !ltid_in_bounds_28680)) {\n            // read operands\n            {\n                x_25625 = x_25624;\n                x_25624 = ((__local\n                            int64_t *) scan_arr_mem_28674)[sext_i32_i64(squot32(local_tid_28670,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_25626 = add64(x_25624, x_25625);\n                \n                x_25624 = res_25626;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)] =\n                    x_25624;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28670, 32) == 0) {\n            ((__local\n              int64_t *) scan_ar",
                   "r_mem_28674)[sext_i32_i64(local_tid_28670)] =\n                x_25625;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_27837, flat_dim_25605)) {\n            ((__global int64_t *) mem_28270)[gtid_27837] = ((__local\n                                                             int64_t *) scan_arr_mem_28674)[sext_i32_i64(local_tid_28670)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27833\n}\n__kernel void testziscan_stage2_27871(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28923_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28921_backing_aligned_1,\n                                      int64_t res_25638, __global\n                                      unsigned char *mem_28281, __global\n                                      unsigned char *mem_28283,\n                                      int64_t stage1_num_groups_28883,\n                                      int32_t num_threads_28884)\n{\n    #define segscan_group_sizze_27866 (testzisegscan_group_sizze_27865)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28923_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28923_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28921_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28921_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28916;\n    int32_t local_tid_28917;\n    int64_t group_sizze_28920;\n    int32_t wave_sizze_28919;\n    int32_t group_tid_28918;\n    \n    global_tid_28916 = get_global_id(0);\n    local_tid_28917 = get_",
                   "local_id(0);\n    group_sizze_28920 = get_local_size(0);\n    wave_sizze_28919 = LOCKSTEP_WIDTH;\n    group_tid_28918 = get_group_id(0);\n    \n    int32_t phys_tid_27871;\n    \n    phys_tid_27871 = global_tid_28916;\n    \n    __local char *scan_arr_mem_28921;\n    __local char *scan_arr_mem_28923;\n    \n    scan_arr_mem_28921 = (__local char *) scan_arr_mem_28921_backing_0;\n    scan_arr_mem_28923 = (__local char *) scan_arr_mem_28923_backing_1;\n    \n    int64_t flat_idx_28925;\n    \n    flat_idx_28925 = (sext_i32_i64(local_tid_28917) + 1) *\n        (segscan_group_sizze_27866 * sdiv_up64(res_25638,\n                                               sext_i32_i64(num_threads_28884))) -\n        1;\n    \n    int64_t gtid_27870;\n    \n    gtid_27870 = flat_idx_28925;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27870, res_25638)) {\n            ((__local\n              bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)] =\n                ((__global bool *) mem_28281)[gtid_27870];\n            ((__local\n              int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)] =\n                ((__global int64_t *) mem_28283)[gtid_27870];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_25657;\n    int64_t x_25658;\n    bool x_25659;\n    int64_t x_25660;\n    bool x_28926;\n    int64_t x_28927;\n    bool x_28928;\n    int64_t x_28929;\n    bool ltid_in_bounds_28933;\n    \n    ltid_in_bounds_28933 = slt64(sext_i32_i64(local_tid_28917),\n                                 stage1_num_groups_28883);\n    \n    int32_t skip_threads_28934;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28933) {\n            x_25659 = ((volatile __local\n                        bool *) scan_arr_mem_28921)[sext_i3",
                   "2_i64(local_tid_28917)];\n            x_25660 = ((volatile __local\n                        int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)];\n            if ((local_tid_28917 - squot32(local_tid_28917, 32) * 32) == 0) {\n                x_25657 = x_25659;\n                x_25658 = x_25660;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28934 = 1;\n        while (slt32(skip_threads_28934, 32)) {\n            if (sle32(skip_threads_28934, local_tid_28917 -\n                      squot32(local_tid_28917, 32) * 32) &&\n                ltid_in_bounds_28933) {\n                // read operands\n                {\n                    x_25657 = ((volatile __local\n                                bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917) -\n                                                            sext_i32_i64(skip_threads_28934)];\n                    x_25658 = ((volatile __local\n                                int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917) -\n                                                               sext_i32_i64(skip_threads_28934)];\n                }\n                // perform operation\n                {\n                    bool res_25661 = x_25657 || x_25659;\n                    int64_t res_25662;\n                    \n                    if (x_25659) {\n                        res_25662 = x_25660;\n                    } else {\n                        int64_t res_25663 = add64(x_25658, x_25660);\n                        \n                        res_25662 = res_25663;\n                    }\n                    x_25657 = res_25661;\n                    x_25658 = res_25662;\n                }\n            }\n            if (sle32(wave_sizze_28919, skip_threads_28934)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28934, local_tid_28917 -\n                      squot32(local_tid_28917, 32) * 32) &&\n                ltid_in",
                   "_bounds_28933) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)] =\n                        x_25657;\n                    x_25659 = x_25657;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)] =\n                        x_25658;\n                    x_25660 = x_25658;\n                }\n            }\n            if (sle32(wave_sizze_28919, skip_threads_28934)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28934 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28917 - squot32(local_tid_28917, 32) * 32) == 31 &&\n            ltid_in_bounds_28933) {\n            ((volatile __local\n              bool *) scan_arr_mem_28921)[sext_i32_i64(squot32(local_tid_28917,\n                                                               32))] = x_25657;\n            ((volatile __local\n              int64_t *) scan_arr_mem_28923)[sext_i32_i64(squot32(local_tid_28917,\n                                                                  32))] =\n                x_25658;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28935;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28917, 32) == 0 && ltid_in_bounds_28933) {\n                x_28928 = ((volatile __local\n                            bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)];\n                x_28929 = ((volatile __local\n                            int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)];\n                if ((local_tid_28917 - squot32(local_tid_28917, 32) * 32) ==\n                    0) {\n                    x_28926 = ",
                   "x_28928;\n                    x_28927 = x_28929;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28935 = 1;\n            while (slt32(skip_threads_28935, 32)) {\n                if (sle32(skip_threads_28935, local_tid_28917 -\n                          squot32(local_tid_28917, 32) * 32) &&\n                    (squot32(local_tid_28917, 32) == 0 &&\n                     ltid_in_bounds_28933)) {\n                    // read operands\n                    {\n                        x_28926 = ((volatile __local\n                                    bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917) -\n                                                                sext_i32_i64(skip_threads_28935)];\n                        x_28927 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917) -\n                                                                   sext_i32_i64(skip_threads_28935)];\n                    }\n                    // perform operation\n                    {\n                        bool res_28930 = x_28926 || x_28928;\n                        int64_t res_28931;\n                        \n                        if (x_28928) {\n                            res_28931 = x_28929;\n                        } else {\n                            int64_t res_28932 = add64(x_28927, x_28929);\n                            \n                            res_28931 = res_28932;\n                        }\n                        x_28926 = res_28930;\n                        x_28927 = res_28931;\n                    }\n                }\n                if (sle32(wave_sizze_28919, skip_threads_28935)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28935, local_tid_28917 -\n                          squot32(local_tid_28917, 32) * 32) &&\n                    (squot32(local_tid_28917, 32) == 0 &",
                   "&\n                     ltid_in_bounds_28933)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)] =\n                            x_28926;\n                        x_28928 = x_28926;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)] =\n                            x_28927;\n                        x_28929 = x_28927;\n                    }\n                }\n                if (sle32(wave_sizze_28919, skip_threads_28935)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28935 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28917, 32) == 0 || !ltid_in_bounds_28933)) {\n            // read operands\n            {\n                x_25659 = x_25657;\n                x_25660 = x_25658;\n                x_25657 = ((__local\n                            bool *) scan_arr_mem_28921)[sext_i32_i64(squot32(local_tid_28917,\n                                                                             32)) -\n                                                        1];\n                x_25658 = ((__local\n                            int64_t *) scan_arr_mem_28923)[sext_i32_i64(squot32(local_tid_28917,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_25661 = x_25657 || x_25659;\n                int64_t res_25662;\n                \n                if (x_25659) {\n                    res_25662 = x_25660;\n                } else {\n                    int64_t res_25663 = add64(x_25658, x_25660);\n                    \n                    res_25662 = res_2566",
                   "3;\n                }\n                x_25657 = res_25661;\n                x_25658 = res_25662;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)] =\n                    x_25657;\n                ((__local\n                  int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)] =\n                    x_25658;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28917, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)] =\n                x_25659;\n            ((__local\n              int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)] =\n                x_25660;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_27870, res_25638)) {\n            ((__global bool *) mem_28281)[gtid_27870] = ((__local\n                                                          bool *) scan_arr_mem_28921)[sext_i32_i64(local_tid_28917)];\n            ((__global int64_t *) mem_28283)[gtid_27870] = ((__local\n                                                             int64_t *) scan_arr_mem_28923)[sext_i32_i64(local_tid_28917)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27866\n}\n__kernel void testziscan_stage2_27879(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28990_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28988_backing_aligned_1,\n                                      int64_t res_25638, __global\n                                      unsigned char *mem_28286, __global\n                                      unsigned char *mem_28288,\n  ",
                   "                                    int64_t stage1_num_groups_28950,\n                                      int32_t num_threads_28951)\n{\n    #define segscan_group_sizze_27874 (testzisegscan_group_sizze_27873)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28990_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28990_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28988_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28988_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28983;\n    int32_t local_tid_28984;\n    int64_t group_sizze_28987;\n    int32_t wave_sizze_28986;\n    int32_t group_tid_28985;\n    \n    global_tid_28983 = get_global_id(0);\n    local_tid_28984 = get_local_id(0);\n    group_sizze_28987 = get_local_size(0);\n    wave_sizze_28986 = LOCKSTEP_WIDTH;\n    group_tid_28985 = get_group_id(0);\n    \n    int32_t phys_tid_27879;\n    \n    phys_tid_27879 = global_tid_28983;\n    \n    __local char *scan_arr_mem_28988;\n    __local char *scan_arr_mem_28990;\n    \n    scan_arr_mem_28988 = (__local char *) scan_arr_mem_28988_backing_0;\n    scan_arr_mem_28990 = (__local char *) scan_arr_mem_28990_backing_1;\n    \n    int64_t flat_idx_28992;\n    \n    flat_idx_28992 = (sext_i32_i64(local_tid_28984) + 1) *\n        (segscan_group_sizze_27874 * sdiv_up64(res_25638,\n                                               sext_i32_i64(num_threads_28951))) -\n        1;\n    \n    int64_t gtid_27878;\n    \n    gtid_27878 = flat_idx_28992;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27878, res_25638)) {\n            ((__local\n              bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)] =\n                ((__global bool *) mem_28286)[gtid_27878];\n            ((__local\n  ",
                   "            int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)] =\n                ((__global int64_t *) mem_28288)[gtid_27878];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_25696;\n    int64_t x_25697;\n    bool x_25698;\n    int64_t x_25699;\n    bool x_28993;\n    int64_t x_28994;\n    bool x_28995;\n    int64_t x_28996;\n    bool ltid_in_bounds_29000;\n    \n    ltid_in_bounds_29000 = slt64(sext_i32_i64(local_tid_28984),\n                                 stage1_num_groups_28950);\n    \n    int32_t skip_threads_29001;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29000) {\n            x_25698 = ((volatile __local\n                        bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)];\n            x_25699 = ((volatile __local\n                        int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)];\n            if ((local_tid_28984 - squot32(local_tid_28984, 32) * 32) == 0) {\n                x_25696 = x_25698;\n                x_25697 = x_25699;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_29001 = 1;\n        while (slt32(skip_threads_29001, 32)) {\n            if (sle32(skip_threads_29001, local_tid_28984 -\n                      squot32(local_tid_28984, 32) * 32) &&\n                ltid_in_bounds_29000) {\n                // read operands\n                {\n                    x_25696 = ((volatile __local\n                                bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984) -\n                                                            sext_i32_i64(skip_threads_29001)];\n                    x_25697 = ((volatile __local\n                                int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_2",
                   "8984) -\n                                                               sext_i32_i64(skip_threads_29001)];\n                }\n                // perform operation\n                {\n                    bool res_25700 = x_25696 || x_25698;\n                    int64_t res_25701;\n                    \n                    if (x_25698) {\n                        res_25701 = x_25699;\n                    } else {\n                        int64_t res_25702 = add64(x_25697, x_25699);\n                        \n                        res_25701 = res_25702;\n                    }\n                    x_25696 = res_25700;\n                    x_25697 = res_25701;\n                }\n            }\n            if (sle32(wave_sizze_28986, skip_threads_29001)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29001, local_tid_28984 -\n                      squot32(local_tid_28984, 32) * 32) &&\n                ltid_in_bounds_29000) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)] =\n                        x_25696;\n                    x_25698 = x_25696;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)] =\n                        x_25697;\n                    x_25699 = x_25697;\n                }\n            }\n            if (sle32(wave_sizze_28986, skip_threads_29001)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_29001 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28984 - squot32(local_tid_28984, 32) * 32) == 31 &&\n            ltid_in_bounds_29000) {\n            ((volatile __local\n              bool *) scan_arr_mem_28988)[sext_i32_i64(squot32(local_tid_28984,\n                                                            ",
                   "   32))] = x_25696;\n            ((volatile __local\n              int64_t *) scan_arr_mem_28990)[sext_i32_i64(squot32(local_tid_28984,\n                                                                  32))] =\n                x_25697;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29002;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28984, 32) == 0 && ltid_in_bounds_29000) {\n                x_28995 = ((volatile __local\n                            bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)];\n                x_28996 = ((volatile __local\n                            int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)];\n                if ((local_tid_28984 - squot32(local_tid_28984, 32) * 32) ==\n                    0) {\n                    x_28993 = x_28995;\n                    x_28994 = x_28996;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29002 = 1;\n            while (slt32(skip_threads_29002, 32)) {\n                if (sle32(skip_threads_29002, local_tid_28984 -\n                          squot32(local_tid_28984, 32) * 32) &&\n                    (squot32(local_tid_28984, 32) == 0 &&\n                     ltid_in_bounds_29000)) {\n                    // read operands\n                    {\n                        x_28993 = ((volatile __local\n                                    bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984) -\n                                                                sext_i32_i64(skip_threads_29002)];\n                        x_28994 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984) -\n                                                                   sext_i32_i64(skip_threads_29002)];\n               ",
                   "     }\n                    // perform operation\n                    {\n                        bool res_28997 = x_28993 || x_28995;\n                        int64_t res_28998;\n                        \n                        if (x_28995) {\n                            res_28998 = x_28996;\n                        } else {\n                            int64_t res_28999 = add64(x_28994, x_28996);\n                            \n                            res_28998 = res_28999;\n                        }\n                        x_28993 = res_28997;\n                        x_28994 = res_28998;\n                    }\n                }\n                if (sle32(wave_sizze_28986, skip_threads_29002)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29002, local_tid_28984 -\n                          squot32(local_tid_28984, 32) * 32) &&\n                    (squot32(local_tid_28984, 32) == 0 &&\n                     ltid_in_bounds_29000)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)] =\n                            x_28993;\n                        x_28995 = x_28993;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)] =\n                            x_28994;\n                        x_28996 = x_28994;\n                    }\n                }\n                if (sle32(wave_sizze_28986, skip_threads_29002)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29002 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28984, 32) == 0 || !ltid_in_bounds_29000)) {\n            // read operands\n            {\n                x_25698 = x_25696;\n                x_25699 = x_25697",
                   ";\n                x_25696 = ((__local\n                            bool *) scan_arr_mem_28988)[sext_i32_i64(squot32(local_tid_28984,\n                                                                             32)) -\n                                                        1];\n                x_25697 = ((__local\n                            int64_t *) scan_arr_mem_28990)[sext_i32_i64(squot32(local_tid_28984,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_25700 = x_25696 || x_25698;\n                int64_t res_25701;\n                \n                if (x_25698) {\n                    res_25701 = x_25699;\n                } else {\n                    int64_t res_25702 = add64(x_25697, x_25699);\n                    \n                    res_25701 = res_25702;\n                }\n                x_25696 = res_25700;\n                x_25697 = res_25701;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)] =\n                    x_25696;\n                ((__local\n                  int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)] =\n                    x_25697;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28984, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)] =\n                x_25698;\n            ((__local\n              int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)] =\n                x_25699;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_27878, res_25638)) {\n            ((__global bool *) mem_28286)[gtid_27878] = ((__local",
                   "\n                                                          bool *) scan_arr_mem_28988)[sext_i32_i64(local_tid_28984)];\n            ((__global int64_t *) mem_28288)[gtid_27878] = ((__local\n                                                             int64_t *) scan_arr_mem_28990)[sext_i32_i64(local_tid_28984)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27874\n}\n__kernel void testziscan_stage2_27887(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29057_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29055_backing_aligned_1,\n                                      int64_t res_25638, __global\n                                      unsigned char *mem_28293, __global\n                                      unsigned char *mem_28295,\n                                      int64_t stage1_num_groups_29017,\n                                      int32_t num_threads_29018)\n{\n    #define segscan_group_sizze_27882 (testzisegscan_group_sizze_27881)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29057_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_29057_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29055_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29055_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29050;\n    int32_t local_tid_29051;\n    int64_t group_sizze_29054;\n    int32_t wave_sizze_29053;\n    int32_t group_tid_29052;\n    \n    global_tid_29050 = get_global_id(0);\n    local_tid_29051 = get_local_id(0);\n    group_sizze_29054 = get_local_size(0);\n    wave_sizze_29053 = LOCKSTEP_WIDTH;\n    group",
                   "_tid_29052 = get_group_id(0);\n    \n    int32_t phys_tid_27887;\n    \n    phys_tid_27887 = global_tid_29050;\n    \n    __local char *scan_arr_mem_29055;\n    __local char *scan_arr_mem_29057;\n    \n    scan_arr_mem_29055 = (__local char *) scan_arr_mem_29055_backing_0;\n    scan_arr_mem_29057 = (__local char *) scan_arr_mem_29057_backing_1;\n    \n    int64_t flat_idx_29059;\n    \n    flat_idx_29059 = (sext_i32_i64(local_tid_29051) + 1) *\n        (segscan_group_sizze_27882 * sdiv_up64(res_25638,\n                                               sext_i32_i64(num_threads_29018))) -\n        1;\n    \n    int64_t gtid_27886;\n    \n    gtid_27886 = flat_idx_29059;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27886, res_25638)) {\n            ((__local\n              bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)] =\n                ((__global bool *) mem_28293)[gtid_27886];\n            ((__local\n              float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)] =\n                ((__global float *) mem_28295)[gtid_27886];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)] = 0;\n            ((__local\n              float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)] =\n                0.0F;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_25722;\n    float x_25723;\n    bool x_25724;\n    float x_25725;\n    bool x_29060;\n    float x_29061;\n    bool x_29062;\n    float x_29063;\n    bool ltid_in_bounds_29067;\n    \n    ltid_in_bounds_29067 = slt64(sext_i32_i64(local_tid_29051),\n                                 stage1_num_groups_29017);\n    \n    int32_t skip_threads_29068;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29067) {\n            x_25724 = ((volatile __local\n                        bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)];\n            x_25725 = ((volatile __local\n                        float *) ",
                   "scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)];\n            if ((local_tid_29051 - squot32(local_tid_29051, 32) * 32) == 0) {\n                x_25722 = x_25724;\n                x_25723 = x_25725;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_29068 = 1;\n        while (slt32(skip_threads_29068, 32)) {\n            if (sle32(skip_threads_29068, local_tid_29051 -\n                      squot32(local_tid_29051, 32) * 32) &&\n                ltid_in_bounds_29067) {\n                // read operands\n                {\n                    x_25722 = ((volatile __local\n                                bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051) -\n                                                            sext_i32_i64(skip_threads_29068)];\n                    x_25723 = ((volatile __local\n                                float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051) -\n                                                             sext_i32_i64(skip_threads_29068)];\n                }\n                // perform operation\n                {\n                    bool res_25726 = x_25722 || x_25724;\n                    float res_25727;\n                    \n                    if (x_25724) {\n                        res_25727 = x_25725;\n                    } else {\n                        float res_25728 = x_25723 + x_25725;\n                        \n                        res_25727 = res_25728;\n                    }\n                    x_25722 = res_25726;\n                    x_25723 = res_25727;\n                }\n            }\n            if (sle32(wave_sizze_29053, skip_threads_29068)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29068, local_tid_29051 -\n                      squot32(local_tid_29051, 32) * 32) &&\n                ltid_in_bounds_29067) {\n                // write result\n                {\n                    ((volatile __local\n         ",
                   "             bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)] =\n                        x_25722;\n                    x_25724 = x_25722;\n                    ((volatile __local\n                      float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)] =\n                        x_25723;\n                    x_25725 = x_25723;\n                }\n            }\n            if (sle32(wave_sizze_29053, skip_threads_29068)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_29068 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_29051 - squot32(local_tid_29051, 32) * 32) == 31 &&\n            ltid_in_bounds_29067) {\n            ((volatile __local\n              bool *) scan_arr_mem_29055)[sext_i32_i64(squot32(local_tid_29051,\n                                                               32))] = x_25722;\n            ((volatile __local\n              float *) scan_arr_mem_29057)[sext_i32_i64(squot32(local_tid_29051,\n                                                                32))] = x_25723;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29069;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_29051, 32) == 0 && ltid_in_bounds_29067) {\n                x_29062 = ((volatile __local\n                            bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)];\n                x_29063 = ((volatile __local\n                            float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)];\n                if ((local_tid_29051 - squot32(local_tid_29051, 32) * 32) ==\n                    0) {\n                    x_29060 = x_29062;\n                    x_29061 = x_29063;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers n",
                   "eeded)\n        {\n            skip_threads_29069 = 1;\n            while (slt32(skip_threads_29069, 32)) {\n                if (sle32(skip_threads_29069, local_tid_29051 -\n                          squot32(local_tid_29051, 32) * 32) &&\n                    (squot32(local_tid_29051, 32) == 0 &&\n                     ltid_in_bounds_29067)) {\n                    // read operands\n                    {\n                        x_29060 = ((volatile __local\n                                    bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051) -\n                                                                sext_i32_i64(skip_threads_29069)];\n                        x_29061 = ((volatile __local\n                                    float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051) -\n                                                                 sext_i32_i64(skip_threads_29069)];\n                    }\n                    // perform operation\n                    {\n                        bool res_29064 = x_29060 || x_29062;\n                        float res_29065;\n                        \n                        if (x_29062) {\n                            res_29065 = x_29063;\n                        } else {\n                            float res_29066 = x_29061 + x_29063;\n                            \n                            res_29065 = res_29066;\n                        }\n                        x_29060 = res_29064;\n                        x_29061 = res_29065;\n                    }\n                }\n                if (sle32(wave_sizze_29053, skip_threads_29069)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29069, local_tid_29051 -\n                          squot32(local_tid_29051, 32) * 32) &&\n                    (squot32(local_tid_29051, 32) == 0 &&\n                     ltid_in_bounds_29067)) {\n                    // write result\n                    {\n                        ((volatile __local\n    ",
                   "                      bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)] =\n                            x_29060;\n                        x_29062 = x_29060;\n                        ((volatile __local\n                          float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)] =\n                            x_29061;\n                        x_29063 = x_29061;\n                    }\n                }\n                if (sle32(wave_sizze_29053, skip_threads_29069)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29069 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_29051, 32) == 0 || !ltid_in_bounds_29067)) {\n            // read operands\n            {\n                x_25724 = x_25722;\n                x_25725 = x_25723;\n                x_25722 = ((__local\n                            bool *) scan_arr_mem_29055)[sext_i32_i64(squot32(local_tid_29051,\n                                                                             32)) -\n                                                        1];\n                x_25723 = ((__local\n                            float *) scan_arr_mem_29057)[sext_i32_i64(squot32(local_tid_29051,\n                                                                              32)) -\n                                                         1];\n            }\n            // perform operation\n            {\n                bool res_25726 = x_25722 || x_25724;\n                float res_25727;\n                \n                if (x_25724) {\n                    res_25727 = x_25725;\n                } else {\n                    float res_25728 = x_25723 + x_25725;\n                    \n                    res_25727 = res_25728;\n                }\n                x_25722 = res_25726;\n                x_25723 = res_25727;\n            }\n            // write final result\n            {\n              ",
                   "  ((__local\n                  bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)] =\n                    x_25722;\n                ((__local\n                  float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)] =\n                    x_25723;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_29051, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)] =\n                x_25724;\n            ((__local\n              float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)] =\n                x_25725;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_27886, res_25638)) {\n            ((__global bool *) mem_28293)[gtid_27886] = ((__local\n                                                          bool *) scan_arr_mem_29055)[sext_i32_i64(local_tid_29051)];\n            ((__global float *) mem_28295)[gtid_27886] = ((__local\n                                                           float *) scan_arr_mem_29057)[sext_i32_i64(local_tid_29051)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27882\n}\n__kernel void testziscan_stage2_27939(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29112_backing_aligned_0,\n                                      int64_t res_25638, __global\n                                      unsigned char *mem_28298,\n                                      int64_t stage1_num_groups_29084,\n                                      int32_t num_threads_29085)\n{\n    #define segscan_group_sizze_27934 (testzisegscan_group_sizze_27933)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29112_backing_0 =\n                        ",
                   "  (__local volatile\n                           char *) scan_arr_mem_29112_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29107;\n    int32_t local_tid_29108;\n    int64_t group_sizze_29111;\n    int32_t wave_sizze_29110;\n    int32_t group_tid_29109;\n    \n    global_tid_29107 = get_global_id(0);\n    local_tid_29108 = get_local_id(0);\n    group_sizze_29111 = get_local_size(0);\n    wave_sizze_29110 = LOCKSTEP_WIDTH;\n    group_tid_29109 = get_group_id(0);\n    \n    int32_t phys_tid_27939;\n    \n    phys_tid_27939 = global_tid_29107;\n    \n    __local char *scan_arr_mem_29112;\n    \n    scan_arr_mem_29112 = (__local char *) scan_arr_mem_29112_backing_0;\n    \n    int64_t flat_idx_29114;\n    \n    flat_idx_29114 = (sext_i32_i64(local_tid_29108) + 1) *\n        (segscan_group_sizze_27934 * sdiv_up64(res_25638,\n                                               sext_i32_i64(num_threads_29085))) -\n        1;\n    \n    int64_t gtid_27938;\n    \n    gtid_27938 = flat_idx_29114;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27938, res_25638)) {\n            ((__local\n              int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)] =\n                ((__global int64_t *) mem_28298)[gtid_27938];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_25819;\n    int64_t x_25820;\n    int64_t x_29115;\n    int64_t x_29116;\n    bool ltid_in_bounds_29118;\n    \n    ltid_in_bounds_29118 = slt64(sext_i32_i64(local_tid_29108),\n                                 stage1_num_groups_29084);\n    \n    int32_t skip_threads_29119;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29118) {\n            x_25820 = ((volatile __local\n                        int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)];\n            if ((local_tid_29108 - squot",
                   "32(local_tid_29108, 32) * 32) == 0) {\n                x_25819 = x_25820;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_29119 = 1;\n        while (slt32(skip_threads_29119, 32)) {\n            if (sle32(skip_threads_29119, local_tid_29108 -\n                      squot32(local_tid_29108, 32) * 32) &&\n                ltid_in_bounds_29118) {\n                // read operands\n                {\n                    x_25819 = ((volatile __local\n                                int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108) -\n                                                               sext_i32_i64(skip_threads_29119)];\n                }\n                // perform operation\n                {\n                    int64_t res_25821 = add64(x_25819, x_25820);\n                    \n                    x_25819 = res_25821;\n                }\n            }\n            if (sle32(wave_sizze_29110, skip_threads_29119)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29119, local_tid_29108 -\n                      squot32(local_tid_29108, 32) * 32) &&\n                ltid_in_bounds_29118) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)] =\n                        x_25819;\n                    x_25820 = x_25819;\n                }\n            }\n            if (sle32(wave_sizze_29110, skip_threads_29119)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_29119 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_29108 - squot32(local_tid_29108, 32) * 32) == 31 &&\n            ltid_in_bounds_29118) {\n            ((volatile __local\n              int64_t *) scan_arr_mem_29112)[sext_i32_i64(squot32(local_tid_29108,\n       ",
                   "                                                           32))] =\n                x_25819;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29120;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_29108, 32) == 0 && ltid_in_bounds_29118) {\n                x_29116 = ((volatile __local\n                            int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)];\n                if ((local_tid_29108 - squot32(local_tid_29108, 32) * 32) ==\n                    0) {\n                    x_29115 = x_29116;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29120 = 1;\n            while (slt32(skip_threads_29120, 32)) {\n                if (sle32(skip_threads_29120, local_tid_29108 -\n                          squot32(local_tid_29108, 32) * 32) &&\n                    (squot32(local_tid_29108, 32) == 0 &&\n                     ltid_in_bounds_29118)) {\n                    // read operands\n                    {\n                        x_29115 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108) -\n                                                                   sext_i32_i64(skip_threads_29120)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_29117 = add64(x_29115, x_29116);\n                        \n                        x_29115 = res_29117;\n                    }\n                }\n                if (sle32(wave_sizze_29110, skip_threads_29120)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29120, local_tid_29108 -\n                          squot32(local_tid_29108, 32) * 32) &&\n                    (squot32(local_tid_29108, 32)",
                   " == 0 &&\n                     ltid_in_bounds_29118)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)] =\n                            x_29115;\n                        x_29116 = x_29115;\n                    }\n                }\n                if (sle32(wave_sizze_29110, skip_threads_29120)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29120 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_29108, 32) == 0 || !ltid_in_bounds_29118)) {\n            // read operands\n            {\n                x_25820 = x_25819;\n                x_25819 = ((__local\n                            int64_t *) scan_arr_mem_29112)[sext_i32_i64(squot32(local_tid_29108,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_25821 = add64(x_25819, x_25820);\n                \n                x_25819 = res_25821;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)] =\n                    x_25819;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_29108, 32) == 0) {\n            ((__local\n              int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)] =\n                x_25820;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_27938, res_25638)) {\n            ((__global int64_t *) mem_28298)[gtid_27938] = ((__local\n                    ",
                   "                                         int64_t *) scan_arr_mem_29112)[sext_i32_i64(local_tid_29108)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27934\n}\n__kernel void testziscan_stage3_27838(__global int *global_failure,\n                                      int64_t flat_dim_25605,\n                                      int64_t num_groups_27835, __global\n                                      unsigned char *mem_28270,\n                                      int32_t num_threads_28647,\n                                      int32_t required_groups_28683)\n{\n    #define segscan_group_sizze_27833 (testzisegscan_group_sizze_27832)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28684;\n    int32_t local_tid_28685;\n    int64_t group_sizze_28688;\n    int32_t wave_sizze_28687;\n    int32_t group_tid_28686;\n    \n    global_tid_28684 = get_global_id(0);\n    local_tid_28685 = get_local_id(0);\n    group_sizze_28688 = get_local_size(0);\n    wave_sizze_28687 = LOCKSTEP_WIDTH;\n    group_tid_28686 = get_group_id(0);\n    \n    int32_t phys_tid_27838;\n    \n    phys_tid_27838 = global_tid_28684;\n    \n    int32_t phys_group_id_28689;\n    \n    phys_group_id_28689 = get_group_id(0);\n    for (int32_t i_28690 = 0; i_28690 < sdiv_up32(required_groups_28683 -\n                                                  phys_group_id_28689,\n                                                  sext_i64_i32(num_groups_27835));\n         i_28690++) {\n        int32_t virt_group_id_28691 = phys_group_id_28689 + i_28690 *\n                sext_i64_i32(num_groups_27835);\n        int64_t flat_idx_28692 = sext_i32_i64(virt_group_id_28691) *\n                segscan_group_sizze_27833 + sext_i32_i64(local_tid_28685);\n        int64_t gtid_27837 = flat_idx_28692;\n        int64_t orig_group_28693 = squot64(flat_idx_28692,\n                                           segscan_gr",
                   "oup_sizze_27833 *\n                                           sdiv_up64(flat_dim_25605,\n                                                     sext_i32_i64(num_threads_28647)));\n        int64_t carry_in_flat_idx_28694 = orig_group_28693 *\n                (segscan_group_sizze_27833 * sdiv_up64(flat_dim_25605,\n                                                       sext_i32_i64(num_threads_28647))) -\n                1;\n        \n        if (slt64(gtid_27837, flat_dim_25605)) {\n            if (!(orig_group_28693 == 0 || flat_idx_28692 == (orig_group_28693 +\n                                                              1) *\n                  (segscan_group_sizze_27833 * sdiv_up64(flat_dim_25605,\n                                                         sext_i32_i64(num_threads_28647))) -\n                  1)) {\n                int64_t x_25624;\n                int64_t x_25625;\n                \n                x_25624 = ((__global\n                            int64_t *) mem_28270)[carry_in_flat_idx_28694];\n                x_25625 = ((__global int64_t *) mem_28270)[gtid_27837];\n                \n                int64_t res_25626;\n                \n                res_25626 = add64(x_25624, x_25625);\n                x_25624 = res_25626;\n                ((__global int64_t *) mem_28270)[gtid_27837] = x_25624;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27833\n}\n__kernel void testziscan_stage3_27871(__global int *global_failure,\n                                      int64_t res_25638,\n                                      int64_t num_groups_27868, __global\n                                      unsigned char *mem_28281, __global\n                                      unsigned char *mem_28283,\n                                      int32_t num_threads_28884,\n                                      int32_t required_groups_28936)\n{\n    #define segscan_group_sizze_27866 (testzisegscan_group_",
                   "sizze_27865)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28937;\n    int32_t local_tid_28938;\n    int64_t group_sizze_28941;\n    int32_t wave_sizze_28940;\n    int32_t group_tid_28939;\n    \n    global_tid_28937 = get_global_id(0);\n    local_tid_28938 = get_local_id(0);\n    group_sizze_28941 = get_local_size(0);\n    wave_sizze_28940 = LOCKSTEP_WIDTH;\n    group_tid_28939 = get_group_id(0);\n    \n    int32_t phys_tid_27871;\n    \n    phys_tid_27871 = global_tid_28937;\n    \n    int32_t phys_group_id_28942;\n    \n    phys_group_id_28942 = get_group_id(0);\n    for (int32_t i_28943 = 0; i_28943 < sdiv_up32(required_groups_28936 -\n                                                  phys_group_id_28942,\n                                                  sext_i64_i32(num_groups_27868));\n         i_28943++) {\n        int32_t virt_group_id_28944 = phys_group_id_28942 + i_28943 *\n                sext_i64_i32(num_groups_27868);\n        int64_t flat_idx_28945 = sext_i32_i64(virt_group_id_28944) *\n                segscan_group_sizze_27866 + sext_i32_i64(local_tid_28938);\n        int64_t gtid_27870 = flat_idx_28945;\n        int64_t orig_group_28946 = squot64(flat_idx_28945,\n                                           segscan_group_sizze_27866 *\n                                           sdiv_up64(res_25638,\n                                                     sext_i32_i64(num_threads_28884)));\n        int64_t carry_in_flat_idx_28947 = orig_group_28946 *\n                (segscan_group_sizze_27866 * sdiv_up64(res_25638,\n                                                       sext_i32_i64(num_threads_28884))) -\n                1;\n        \n        if (slt64(gtid_27870, res_25638)) {\n            if (!(orig_group_28946 == 0 || flat_idx_28945 == (orig_group_28946 +\n                                                              1) *\n                  (segscan_group_sizze_27",
                   "866 * sdiv_up64(res_25638,\n                                                         sext_i32_i64(num_threads_28884))) -\n                  1)) {\n                bool x_25657;\n                int64_t x_25658;\n                bool x_25659;\n                int64_t x_25660;\n                \n                x_25657 = ((__global\n                            bool *) mem_28281)[carry_in_flat_idx_28947];\n                x_25658 = ((__global\n                            int64_t *) mem_28283)[carry_in_flat_idx_28947];\n                x_25659 = ((__global bool *) mem_28281)[gtid_27870];\n                x_25660 = ((__global int64_t *) mem_28283)[gtid_27870];\n                \n                bool res_25661;\n                \n                res_25661 = x_25657 || x_25659;\n                \n                int64_t res_25662;\n                \n                if (x_25659) {\n                    res_25662 = x_25660;\n                } else {\n                    int64_t res_25663 = add64(x_25658, x_25660);\n                    \n                    res_25662 = res_25663;\n                }\n                x_25657 = res_25661;\n                x_25658 = res_25662;\n                ((__global bool *) mem_28281)[gtid_27870] = x_25657;\n                ((__global int64_t *) mem_28283)[gtid_27870] = x_25658;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27866\n}\n__kernel void testziscan_stage3_27879(__global int *global_failure,\n                                      int64_t res_25638,\n                                      int64_t num_groups_27876, __global\n                                      unsigned char *mem_28286, __global\n                                      unsigned char *mem_28288,\n                                      int32_t num_threads_28951,\n                                      int32_t required_groups_29003)\n{\n    #define segscan_group_sizze_27874 (testzisegscan_group_sizze_27873)\n    \n ",
                   "   const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29004;\n    int32_t local_tid_29005;\n    int64_t group_sizze_29008;\n    int32_t wave_sizze_29007;\n    int32_t group_tid_29006;\n    \n    global_tid_29004 = get_global_id(0);\n    local_tid_29005 = get_local_id(0);\n    group_sizze_29008 = get_local_size(0);\n    wave_sizze_29007 = LOCKSTEP_WIDTH;\n    group_tid_29006 = get_group_id(0);\n    \n    int32_t phys_tid_27879;\n    \n    phys_tid_27879 = global_tid_29004;\n    \n    int32_t phys_group_id_29009;\n    \n    phys_group_id_29009 = get_group_id(0);\n    for (int32_t i_29010 = 0; i_29010 < sdiv_up32(required_groups_29003 -\n                                                  phys_group_id_29009,\n                                                  sext_i64_i32(num_groups_27876));\n         i_29010++) {\n        int32_t virt_group_id_29011 = phys_group_id_29009 + i_29010 *\n                sext_i64_i32(num_groups_27876);\n        int64_t flat_idx_29012 = sext_i32_i64(virt_group_id_29011) *\n                segscan_group_sizze_27874 + sext_i32_i64(local_tid_29005);\n        int64_t gtid_27878 = flat_idx_29012;\n        int64_t orig_group_29013 = squot64(flat_idx_29012,\n                                           segscan_group_sizze_27874 *\n                                           sdiv_up64(res_25638,\n                                                     sext_i32_i64(num_threads_28951)));\n        int64_t carry_in_flat_idx_29014 = orig_group_29013 *\n                (segscan_group_sizze_27874 * sdiv_up64(res_25638,\n                                                       sext_i32_i64(num_threads_28951))) -\n                1;\n        \n        if (slt64(gtid_27878, res_25638)) {\n            if (!(orig_group_29013 == 0 || flat_idx_29012 == (orig_group_29013 +\n                                                              1) *\n                  (segscan_group_sizze_27874 * sdiv_up64(res",
                   "_25638,\n                                                         sext_i32_i64(num_threads_28951))) -\n                  1)) {\n                bool x_25696;\n                int64_t x_25697;\n                bool x_25698;\n                int64_t x_25699;\n                \n                x_25696 = ((__global\n                            bool *) mem_28286)[carry_in_flat_idx_29014];\n                x_25697 = ((__global\n                            int64_t *) mem_28288)[carry_in_flat_idx_29014];\n                x_25698 = ((__global bool *) mem_28286)[gtid_27878];\n                x_25699 = ((__global int64_t *) mem_28288)[gtid_27878];\n                \n                bool res_25700;\n                \n                res_25700 = x_25696 || x_25698;\n                \n                int64_t res_25701;\n                \n                if (x_25698) {\n                    res_25701 = x_25699;\n                } else {\n                    int64_t res_25702 = add64(x_25697, x_25699);\n                    \n                    res_25701 = res_25702;\n                }\n                x_25696 = res_25700;\n                x_25697 = res_25701;\n                ((__global bool *) mem_28286)[gtid_27878] = x_25696;\n                ((__global int64_t *) mem_28288)[gtid_27878] = x_25697;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27874\n}\n__kernel void testziscan_stage3_27887(__global int *global_failure,\n                                      int64_t res_25638,\n                                      int64_t num_groups_27884, __global\n                                      unsigned char *mem_28293, __global\n                                      unsigned char *mem_28295,\n                                      int32_t num_threads_29018,\n                                      int32_t required_groups_29070)\n{\n    #define segscan_group_sizze_27882 (testzisegscan_group_sizze_27881)\n    \n    const int block_",
                   "dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29071;\n    int32_t local_tid_29072;\n    int64_t group_sizze_29075;\n    int32_t wave_sizze_29074;\n    int32_t group_tid_29073;\n    \n    global_tid_29071 = get_global_id(0);\n    local_tid_29072 = get_local_id(0);\n    group_sizze_29075 = get_local_size(0);\n    wave_sizze_29074 = LOCKSTEP_WIDTH;\n    group_tid_29073 = get_group_id(0);\n    \n    int32_t phys_tid_27887;\n    \n    phys_tid_27887 = global_tid_29071;\n    \n    int32_t phys_group_id_29076;\n    \n    phys_group_id_29076 = get_group_id(0);\n    for (int32_t i_29077 = 0; i_29077 < sdiv_up32(required_groups_29070 -\n                                                  phys_group_id_29076,\n                                                  sext_i64_i32(num_groups_27884));\n         i_29077++) {\n        int32_t virt_group_id_29078 = phys_group_id_29076 + i_29077 *\n                sext_i64_i32(num_groups_27884);\n        int64_t flat_idx_29079 = sext_i32_i64(virt_group_id_29078) *\n                segscan_group_sizze_27882 + sext_i32_i64(local_tid_29072);\n        int64_t gtid_27886 = flat_idx_29079;\n        int64_t orig_group_29080 = squot64(flat_idx_29079,\n                                           segscan_group_sizze_27882 *\n                                           sdiv_up64(res_25638,\n                                                     sext_i32_i64(num_threads_29018)));\n        int64_t carry_in_flat_idx_29081 = orig_group_29080 *\n                (segscan_group_sizze_27882 * sdiv_up64(res_25638,\n                                                       sext_i32_i64(num_threads_29018))) -\n                1;\n        \n        if (slt64(gtid_27886, res_25638)) {\n            if (!(orig_group_29080 == 0 || flat_idx_29079 == (orig_group_29080 +\n                                                              1) *\n                  (segscan_group_sizze_27882 * sdiv_up64(res_25638,\n           ",
                   "                                              sext_i32_i64(num_threads_29018))) -\n                  1)) {\n                bool x_25722;\n                float x_25723;\n                bool x_25724;\n                float x_25725;\n                \n                x_25722 = ((__global\n                            bool *) mem_28293)[carry_in_flat_idx_29081];\n                x_25723 = ((__global\n                            float *) mem_28295)[carry_in_flat_idx_29081];\n                x_25724 = ((__global bool *) mem_28293)[gtid_27886];\n                x_25725 = ((__global float *) mem_28295)[gtid_27886];\n                \n                bool res_25726;\n                \n                res_25726 = x_25722 || x_25724;\n                \n                float res_25727;\n                \n                if (x_25724) {\n                    res_25727 = x_25725;\n                } else {\n                    float res_25728 = x_25723 + x_25725;\n                    \n                    res_25727 = res_25728;\n                }\n                x_25722 = res_25726;\n                x_25723 = res_25727;\n                ((__global bool *) mem_28293)[gtid_27886] = x_25722;\n                ((__global float *) mem_28295)[gtid_27886] = x_25723;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27882\n}\n__kernel void testziscan_stage3_27939(__global int *global_failure,\n                                      int64_t res_25638,\n                                      int64_t num_groups_27936, __global\n                                      unsigned char *mem_28298,\n                                      int32_t num_threads_29085,\n                                      int32_t required_groups_29121)\n{\n    #define segscan_group_sizze_27934 (testzisegscan_group_sizze_27933)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n       ",
                   " return;\n    \n    int32_t global_tid_29122;\n    int32_t local_tid_29123;\n    int64_t group_sizze_29126;\n    int32_t wave_sizze_29125;\n    int32_t group_tid_29124;\n    \n    global_tid_29122 = get_global_id(0);\n    local_tid_29123 = get_local_id(0);\n    group_sizze_29126 = get_local_size(0);\n    wave_sizze_29125 = LOCKSTEP_WIDTH;\n    group_tid_29124 = get_group_id(0);\n    \n    int32_t phys_tid_27939;\n    \n    phys_tid_27939 = global_tid_29122;\n    \n    int32_t phys_group_id_29127;\n    \n    phys_group_id_29127 = get_group_id(0);\n    for (int32_t i_29128 = 0; i_29128 < sdiv_up32(required_groups_29121 -\n                                                  phys_group_id_29127,\n                                                  sext_i64_i32(num_groups_27936));\n         i_29128++) {\n        int32_t virt_group_id_29129 = phys_group_id_29127 + i_29128 *\n                sext_i64_i32(num_groups_27936);\n        int64_t flat_idx_29130 = sext_i32_i64(virt_group_id_29129) *\n                segscan_group_sizze_27934 + sext_i32_i64(local_tid_29123);\n        int64_t gtid_27938 = flat_idx_29130;\n        int64_t orig_group_29131 = squot64(flat_idx_29130,\n                                           segscan_group_sizze_27934 *\n                                           sdiv_up64(res_25638,\n                                                     sext_i32_i64(num_threads_29085)));\n        int64_t carry_in_flat_idx_29132 = orig_group_29131 *\n                (segscan_group_sizze_27934 * sdiv_up64(res_25638,\n                                                       sext_i32_i64(num_threads_29085))) -\n                1;\n        \n        if (slt64(gtid_27938, res_25638)) {\n            if (!(orig_group_29131 == 0 || flat_idx_29130 == (orig_group_29131 +\n                                                              1) *\n                  (segscan_group_sizze_27934 * sdiv_up64(res_25638,\n                                                         sext_i32_i64(num_threads_29085))) -\n                  1)) {\n      ",
                   "          int64_t x_25819;\n                int64_t x_25820;\n                \n                x_25819 = ((__global\n                            int64_t *) mem_28298)[carry_in_flat_idx_29132];\n                x_25820 = ((__global int64_t *) mem_28298)[gtid_27938];\n                \n                int64_t res_25821;\n                \n                res_25821 = add64(x_25819, x_25820);\n                x_25819 = res_25821;\n                ((__global int64_t *) mem_28298)[gtid_27938] = x_25819;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27934\n}\n__kernel void testziseghist_global_27856(__global int *global_failure,\n                                         int64_t flat_dim_25605,\n                                         int64_t res_25638,\n                                         int64_t num_groups_27853, __global\n                                         unsigned char *mem_28270,\n                                         int32_t num_subhistos_28734, __global\n                                         unsigned char *res_subhistos_mem_28735,\n                                         __global\n                                         unsigned char *testzihist_locks_mem_28805,\n                                         int32_t chk_i_28807,\n                                         int64_t hist_H_chk_28808)\n{\n    #define seghist_group_sizze_27851 (testziseghist_group_sizze_27850)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28809;\n    int32_t local_tid_28810;\n    int64_t group_sizze_28813;\n    int32_t wave_sizze_28812;\n    int32_t group_tid_28811;\n    \n    global_tid_28809 = get_global_id(0);\n    local_tid_28810 = get_local_id(0);\n    group_sizze_28813 = get_local_size(0);\n    wave_sizze_28812 = LOCKSTEP_WIDTH;\n    group_tid_28811 = get_group_id(0);\n    \n  ",
                   "  int32_t phys_tid_27856;\n    \n    phys_tid_27856 = global_tid_28809;\n    \n    int32_t subhisto_ind_28814;\n    \n    subhisto_ind_28814 = squot32(global_tid_28809,\n                                 sdiv_up32(sext_i64_i32(seghist_group_sizze_27851 *\n                                           num_groups_27853),\n                                           num_subhistos_28734));\n    for (int64_t i_28815 = 0; i_28815 < sdiv_up64(flat_dim_25605 -\n                                                  sext_i32_i64(global_tid_28809),\n                                                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_27851 *\n                                                  num_groups_27853)));\n         i_28815++) {\n        int32_t gtid_27855 = sext_i64_i32(i_28815 *\n                sext_i32_i64(sext_i64_i32(seghist_group_sizze_27851 *\n                num_groups_27853)) + sext_i32_i64(global_tid_28809));\n        \n        if (slt64(i_28815 *\n                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_27851 *\n                  num_groups_27853)) + sext_i32_i64(global_tid_28809),\n                  flat_dim_25605)) {\n            int64_t i_p_o_28114 = add64(-1, gtid_27855);\n            int64_t rot_i_28115 = smod64(i_p_o_28114, flat_dim_25605);\n            bool cond_27862 = gtid_27855 == 0;\n            int64_t res_27863;\n            \n            if (cond_27862) {\n                res_27863 = 0;\n            } else {\n                int64_t x_27861 = ((__global int64_t *) mem_28270)[rot_i_28115];\n                \n                res_27863 = x_27861;\n            }\n            // save map-out results\n            { }\n            // perform atomic updates\n            {\n                if (sle64(sext_i32_i64(chk_i_28807) * hist_H_chk_28808,\n                          res_27863) && (slt64(res_27863,\n                                               sext_i32_i64(chk_i_28807) *\n                                               hist_H_chk_28808 +\n                                             ",
                   "  hist_H_chk_28808) &&\n                                         slt64(res_27863, res_25638))) {\n                    int64_t x_27857;\n                    int64_t x_27858;\n                    \n                    x_27858 = gtid_27855;\n                    \n                    int32_t old_28816;\n                    volatile bool continue_28817;\n                    \n                    continue_28817 = 1;\n                    while (continue_28817) {\n                        old_28816 =\n                            atomic_cmpxchg_i32_global(&((volatile __global\n                                                         int *) testzihist_locks_mem_28805)[srem64(sext_i32_i64(subhisto_ind_28814) *\n                                                                                                   res_25638 +\n                                                                                                   res_27863,\n                                                                                                   100151)],\n                                                      0, 1);\n                        if (old_28816 == 0) {\n                            int64_t x_27857;\n                            \n                            // bind lhs\n                            {\n                                x_27857 = ((volatile __global\n                                            int64_t *) res_subhistos_mem_28735)[sext_i32_i64(subhisto_ind_28814) *\n                                                                                res_25638 +\n                                                                                res_27863];\n                            }\n                            // execute operation\n                            {\n                                int64_t res_27859 = smax64(x_27857, x_27858);\n                                \n                                x_27857 = res_27859;\n                            }\n                            // update global result\n         ",
                   "                   {\n                                ((volatile __global\n                                  int64_t *) res_subhistos_mem_28735)[sext_i32_i64(subhisto_ind_28814) *\n                                                                      res_25638 +\n                                                                      res_27863] =\n                                    x_27857;\n                            }\n                            mem_fence_global();\n                            old_28816 =\n                                atomic_cmpxchg_i32_global(&((volatile __global\n                                                             int *) testzihist_locks_mem_28805)[srem64(sext_i32_i64(subhisto_ind_28814) *\n                                                                                                       res_25638 +\n                                                                                                       res_27863,\n                                                                                                       100151)],\n                                                          1, 0);\n                            continue_28817 = 0;\n                        }\n                        mem_fence_global();\n                    }\n                }\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef seghist_group_sizze_27851\n}\n__kernel void testziseghist_local_27856(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *locks_mem_28775_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *subhistogram_local_mem_28773_backing_aligned_1,\n                                        int64_t flat_dim_25605,\n                                        int64_t res_25638, __global\n                                        unsigned char *mem_28270, __global\n                                        uns",
                   "igned char *res_subhistos_mem_28735,\n                                        int32_t max_group_sizze_28744,\n                                        int64_t num_groups_28745,\n                                        int32_t hist_M_28751,\n                                        int32_t chk_i_28756,\n                                        int64_t num_segments_28757,\n                                        int64_t hist_H_chk_28758,\n                                        int64_t histo_sizze_28759,\n                                        int32_t init_per_thread_28760)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict locks_mem_28775_backing_1 =\n                          (__local volatile\n                           char *) locks_mem_28775_backing_aligned_0;\n    __local volatile char *restrict subhistogram_local_mem_28773_backing_0 =\n                          (__local volatile\n                           char *) subhistogram_local_mem_28773_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28761;\n    int32_t local_tid_28762;\n    int64_t group_sizze_28765;\n    int32_t wave_sizze_28764;\n    int32_t group_tid_28763;\n    \n    global_tid_28761 = get_global_id(0);\n    local_tid_28762 = get_local_id(0);\n    group_sizze_28765 = get_local_size(0);\n    wave_sizze_28764 = LOCKSTEP_WIDTH;\n    group_tid_28763 = get_group_id(0);\n    \n    int32_t phys_tid_27856;\n    \n    phys_tid_27856 = global_tid_28761;\n    \n    int32_t phys_group_id_28766;\n    \n    phys_group_id_28766 = get_group_id(0);\n    for (int32_t i_28767 = 0; i_28767 <\n         sdiv_up32(sext_i64_i32(num_groups_28745 * num_segments_28757) -\n                   phys_group_id_28766, sext_i64_i32(num_groups_28745));\n         i_28767++) {\n        int32_t virt_group_id_28768 = phys_group_id_28766 + i_28767 *\n                sext_i64_i32(num_groups_28745);\n        int32_t flat_segment_id_28769 = squot32(virt_grou",
                   "p_id_28768,\n                                                sext_i64_i32(num_groups_28745));\n        int32_t gid_in_segment_28770 = srem32(virt_group_id_28768,\n                                              sext_i64_i32(num_groups_28745));\n        int32_t pgtid_in_segment_28771 = gid_in_segment_28770 *\n                sext_i64_i32(max_group_sizze_28744) + local_tid_28762;\n        int32_t threads_per_segment_28772 = sext_i64_i32(num_groups_28745 *\n                max_group_sizze_28744);\n        __local char *subhistogram_local_mem_28773;\n        \n        subhistogram_local_mem_28773 = (__local\n                                        char *) subhistogram_local_mem_28773_backing_0;\n        \n        __local char *locks_mem_28775;\n        \n        locks_mem_28775 = (__local char *) locks_mem_28775_backing_1;\n        // All locks start out unlocked\n        {\n            for (int64_t i_28777 = 0; i_28777 < sdiv_up64(hist_M_28751 *\n                                                          hist_H_chk_28758 -\n                                                          sext_i32_i64(local_tid_28762),\n                                                          max_group_sizze_28744);\n                 i_28777++) {\n                ((__local int32_t *) locks_mem_28775)[squot64(i_28777 *\n                                                              max_group_sizze_28744 +\n                                                              sext_i32_i64(local_tid_28762),\n                                                              hist_H_chk_28758) *\n                                                      hist_H_chk_28758 +\n                                                      (i_28777 *\n                                                       max_group_sizze_28744 +\n                                                       sext_i32_i64(local_tid_28762) -\n                                                       squot64(i_28777 *\n                                                               max_group_si",
                   "zze_28744 +\n                                                               sext_i32_i64(local_tid_28762),\n                                                               hist_H_chk_28758) *\n                                                       hist_H_chk_28758)] = 0;\n            }\n        }\n        \n        int32_t thread_local_subhisto_i_28778;\n        \n        thread_local_subhisto_i_28778 = srem32(local_tid_28762, hist_M_28751);\n        // initialize histograms in local memory\n        {\n            for (int32_t local_i_28779 = 0; local_i_28779 <\n                 init_per_thread_28760; local_i_28779++) {\n                int32_t j_28780 = local_i_28779 *\n                        sext_i64_i32(max_group_sizze_28744) + local_tid_28762;\n                int32_t j_offset_28781 = hist_M_28751 *\n                        sext_i64_i32(histo_sizze_28759) * gid_in_segment_28770 +\n                        j_28780;\n                int32_t local_subhisto_i_28782 = squot32(j_28780,\n                                                         sext_i64_i32(histo_sizze_28759));\n                int32_t global_subhisto_i_28783 = squot32(j_offset_28781,\n                                                          sext_i64_i32(histo_sizze_28759));\n                \n                if (slt32(j_28780, hist_M_28751 *\n                          sext_i64_i32(histo_sizze_28759))) {\n                    // First subhistogram is initialised from global memory; others with neutral element.\n                    {\n                        if (global_subhisto_i_28783 == 0) {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_28773)[sext_i32_i64(local_subhisto_i_28782) *\n                                                                       hist_H_chk_28758 +\n                                                                       sext_i32_i64(srem32(j_28780,\n                                                                                           sext_i64_i32(histo",
                   "_sizze_28759)))] =\n                                ((__global\n                                  int64_t *) res_subhistos_mem_28735)[sext_i32_i64(srem32(j_28780,\n                                                                                          sext_i64_i32(histo_sizze_28759))) +\n                                                                      sext_i32_i64(chk_i_28756) *\n                                                                      hist_H_chk_28758];\n                        } else {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_28773)[sext_i32_i64(local_subhisto_i_28782) *\n                                                                       hist_H_chk_28758 +\n                                                                       sext_i32_i64(srem32(j_28780,\n                                                                                           sext_i64_i32(histo_sizze_28759)))] =\n                                0;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_28784 = 0; i_28784 <\n             sdiv_up32(sext_i64_i32(flat_dim_25605) - pgtid_in_segment_28771,\n                       threads_per_segment_28772); i_28784++) {\n            int32_t gtid_27855 = i_28784 * threads_per_segment_28772 +\n                    pgtid_in_segment_28771;\n            int64_t i_p_o_28114 = add64(-1, gtid_27855);\n            int64_t rot_i_28115 = smod64(i_p_o_28114, flat_dim_25605);\n            bool cond_27862 = gtid_27855 == 0;\n            int64_t res_27863;\n            \n            if (cond_27862) {\n                res_27863 = 0;\n            } else {\n                int64_t x_27861 = ((__global int64_t *) mem_28270)[rot_i_28115];\n                \n                res_27863 = x_27861;\n            }\n            if (chk_i_28756 == 0) {\n                // save map-out results\n                { }\n            }\n   ",
                   "         // perform atomic updates\n            {\n                if (slt64(res_27863, res_25638) &&\n                    (sle64(sext_i32_i64(chk_i_28756) * hist_H_chk_28758,\n                           res_27863) && slt64(res_27863,\n                                               sext_i32_i64(chk_i_28756) *\n                                               hist_H_chk_28758 +\n                                               hist_H_chk_28758))) {\n                    int64_t x_27857;\n                    int64_t x_27858;\n                    \n                    x_27858 = gtid_27855;\n                    \n                    int32_t old_28785;\n                    volatile bool continue_28786;\n                    \n                    continue_28786 = 1;\n                    while (continue_28786) {\n                        old_28785 = atomic_cmpxchg_i32_local(&((volatile __local\n                                                                int *) locks_mem_28775)[sext_i32_i64(thread_local_subhisto_i_28778) *\n                                                                                        hist_H_chk_28758 +\n                                                                                        (res_27863 -\n                                                                                         sext_i32_i64(chk_i_28756) *\n                                                                                         hist_H_chk_28758)],\n                                                             0, 1);\n                        if (old_28785 == 0) {\n                            int64_t x_27857;\n                            \n                            // bind lhs\n                            {\n                                x_27857 = ((volatile __local\n                                            int64_t *) subhistogram_local_mem_28773)[sext_i32_i64(thread_local_subhisto_i_28778) *\n                                                                                     hist_H_chk_28758 +\n   ",
                   "                                                                                  (res_27863 -\n                                                                                      sext_i32_i64(chk_i_28756) *\n                                                                                      hist_H_chk_28758)];\n                            }\n                            // execute operation\n                            {\n                                int64_t res_27859 = smax64(x_27857, x_27858);\n                                \n                                x_27857 = res_27859;\n                            }\n                            // update global result\n                            {\n                                ((volatile __local\n                                  int64_t *) subhistogram_local_mem_28773)[sext_i32_i64(thread_local_subhisto_i_28778) *\n                                                                           hist_H_chk_28758 +\n                                                                           (res_27863 -\n                                                                            sext_i32_i64(chk_i_28756) *\n                                                                            hist_H_chk_28758)] =\n                                    x_27857;\n                            }\n                            mem_fence_local();\n                            old_28785 =\n                                atomic_cmpxchg_i32_local(&((volatile __local\n                                                            int *) locks_mem_28775)[sext_i32_i64(thread_local_subhisto_i_28778) *\n                                                                                    hist_H_chk_28758 +\n                                                                                    (res_27863 -\n                                                                                     sext_i32_i64(chk_i_28756) *\n                                                               ",
                   "                      hist_H_chk_28758)],\n                                                         1, 0);\n                            continue_28786 = 0;\n                        }\n                        mem_fence_local();\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Compact the multiple local memory subhistograms to result in global memory\n        {\n            int64_t trunc_H_28787 = smin64(hist_H_chk_28758, res_25638 -\n                                           sext_i32_i64(chk_i_28756) *\n                                           hist_H_chk_28758);\n            int32_t histo_sizze_28788 = sext_i64_i32(trunc_H_28787);\n            \n            for (int32_t local_i_28789 = 0; local_i_28789 <\n                 init_per_thread_28760; local_i_28789++) {\n                int32_t j_28790 = local_i_28789 *\n                        sext_i64_i32(max_group_sizze_28744) + local_tid_28762;\n                \n                if (slt32(j_28790, histo_sizze_28788)) {\n                    int64_t x_27857;\n                    int64_t x_27858;\n                    \n                    // Read values from subhistogram 0.\n                    {\n                        x_27857 = ((__local\n                                    int64_t *) subhistogram_local_mem_28773)[sext_i32_i64(j_28790)];\n                    }\n                    // Accumulate based on values in other subhistograms.\n                    {\n                        for (int32_t subhisto_id_28791 = 0; subhisto_id_28791 <\n                             hist_M_28751 - 1; subhisto_id_28791++) {\n                            x_27858 = ((__local\n                                        int64_t *) subhistogram_local_mem_28773)[(sext_i32_i64(subhisto_id_28791) +\n                                                                                  1) *\n                                                                                 hist_H_chk_28758 +\n                                ",
                   "                                                 sext_i32_i64(j_28790)];\n                            \n                            int64_t res_27859;\n                            \n                            res_27859 = smax64(x_27857, x_27858);\n                            x_27857 = res_27859;\n                        }\n                    }\n                    // Put final bucket value in global memory.\n                    {\n                        ((__global\n                          int64_t *) res_subhistos_mem_28735)[srem64(sext_i32_i64(virt_group_id_28768),\n                                                                     num_groups_28745) *\n                                                              res_25638 +\n                                                              (sext_i32_i64(j_28790) +\n                                                               sext_i32_i64(chk_i_28756) *\n                                                               hist_H_chk_28758)] =\n                            x_27857;\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\n__kernel void testzisegmap_27011(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, __global\n                                 unsigned char *mem_28184, __global\n                                 unsigned char *mem_28186, __global\n                                 unsigned char *mem_28198, __global\n                                 unsigned char *mem_28212)\n{\n    #define segmap_group_sizze_27089 (testzisegmap_group_sizze_27013)\n    #define num_threads_28425 (testzisegmap_group_sizze_27013 * sdiv_up64(9, testzisegmap_group_sizze_27013))\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t ",
                   "global_tid_28571;\n    int32_t local_tid_28572;\n    int64_t group_sizze_28575;\n    int32_t wave_sizze_28574;\n    int32_t group_tid_28573;\n    \n    global_tid_28571 = get_global_id(0);\n    local_tid_28572 = get_local_id(0);\n    group_sizze_28575 = get_local_size(0);\n    wave_sizze_28574 = LOCKSTEP_WIDTH;\n    group_tid_28573 = get_group_id(0);\n    \n    int32_t phys_tid_27011;\n    \n    phys_tid_27011 = global_tid_28571;\n    \n    int64_t gtid_27010;\n    \n    gtid_27010 = sext_i32_i64(group_tid_28573) * segmap_group_sizze_27089 +\n        sext_i32_i64(local_tid_28572);\n    if (slt64(gtid_27010, 9)) {\n        float res_27100 = ((__global float *) mem_28186)[gtid_27010];\n        int64_t res_27101 = ((__global int64_t *) mem_28184)[gtid_27010];\n        int64_t range_end_27103 = sub64(res_27101, 1);\n        bool bounds_invalid_upwards_27104 = slt64(range_end_27103, 0);\n        bool valid_27105 = !bounds_invalid_upwards_27104;\n        bool range_valid_c_27106;\n        \n        if (!valid_27105) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 9) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = 1;\n                    global_failure_args[2] = range_end_27103;\n                    ;\n                }\n                return;\n            }\n        }\n        for (int64_t i_28159 = 0; i_28159 < res_27101; i_28159++) {\n            float res_27110 = sitofp_i64_f32(i_28159);\n            float res_27111 = res_27100 * res_27110;\n            \n            ((__global float *) mem_28198)[phys_tid_27011 + i_28159 *\n                                           num_threads_28425] = res_27111;\n        }\n        \n        bool y_27112 = slt64(0, res_27101);\n        bool index_certs_27113;\n        \n        if (!y_27112) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 10) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_27101;\n   ",
                   "                 ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_27114 = sitofp_i64_f32(range_end_27103);\n        float index_primexp_27115 = res_27100 * binop_y_27114;\n        float negate_arg_27116 = 1.0e-2F * index_primexp_27115;\n        float exp_arg_27117 = 0.0F - negate_arg_27116;\n        float res_27118 = fpow32(2.7182817F, exp_arg_27117);\n        float x_27119 = 1.0F - res_27118;\n        float B_27120 = x_27119 / 1.0e-2F;\n        float x_27121 = B_27120 - index_primexp_27115;\n        float x_27122 = 4.4999997e-6F * x_27121;\n        float A1_27123 = x_27122 / 1.0e-4F;\n        float y_27124 = fpow32(B_27120, 2.0F);\n        float x_27125 = 1.0000001e-6F * y_27124;\n        float A2_27126 = x_27125 / 4.0e-2F;\n        float exp_arg_27127 = A1_27123 - A2_27126;\n        float res_27128 = fpow32(2.7182817F, exp_arg_27127);\n        float negate_arg_27129 = 5.0e-2F * B_27120;\n        float exp_arg_27130 = 0.0F - negate_arg_27129;\n        float res_27131 = fpow32(2.7182817F, exp_arg_27130);\n        float res_27132 = res_27128 * res_27131;\n        bool empty_slice_27133 = range_end_27103 == 0;\n        bool zzero_leq_i_p_m_t_s_27134 = sle64(0, range_end_27103);\n        bool i_p_m_t_s_leq_w_27135 = slt64(range_end_27103, res_27101);\n        bool i_lte_j_27136 = sle64(1, res_27101);\n        bool y_27137 = zzero_leq_i_p_m_t_s_27134 && i_p_m_t_s_leq_w_27135;\n        bool y_27138 = i_lte_j_27136 && y_27137;\n        bool ok_or_empty_27139 = empty_slice_27133 || y_27138;\n        bool index_certs_27140;\n        \n        if (!ok_or_empty_27139) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 11) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = res_27101;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float res_27142;\n        float redout_28161 = 0.0F;\n        \n        for (int64_t i_28162",
                   " = 0; i_28162 < range_end_27103; i_28162++) {\n            int64_t slice_28175 = 1 + i_28162;\n            float x_27146 = ((__global float *) mem_28198)[phys_tid_27011 +\n                                                           slice_28175 *\n                                                           num_threads_28425];\n            float negate_arg_27147 = 1.0e-2F * x_27146;\n            float exp_arg_27148 = 0.0F - negate_arg_27147;\n            float res_27149 = fpow32(2.7182817F, exp_arg_27148);\n            float x_27150 = 1.0F - res_27149;\n            float B_27151 = x_27150 / 1.0e-2F;\n            float x_27152 = B_27151 - x_27146;\n            float x_27153 = 4.4999997e-6F * x_27152;\n            float A1_27154 = x_27153 / 1.0e-4F;\n            float y_27155 = fpow32(B_27151, 2.0F);\n            float x_27156 = 1.0000001e-6F * y_27155;\n            float A2_27157 = x_27156 / 4.0e-2F;\n            float exp_arg_27158 = A1_27154 - A2_27157;\n            float res_27159 = fpow32(2.7182817F, exp_arg_27158);\n            float negate_arg_27160 = 5.0e-2F * B_27151;\n            float exp_arg_27161 = 0.0F - negate_arg_27160;\n            float res_27162 = fpow32(2.7182817F, exp_arg_27161);\n            float res_27163 = res_27159 * res_27162;\n            float res_27145 = res_27163 + redout_28161;\n            float redout_tmp_28577 = res_27145;\n            \n            redout_28161 = redout_tmp_28577;\n        }\n        res_27142 = redout_28161;\n        \n        float x_27164 = 1.0F - res_27132;\n        float y_27165 = res_27100 * res_27142;\n        float res_27166 = x_27164 / y_27165;\n        \n        ((__global float *) mem_28212)[gtid_27010] = res_27166;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27089\n    #undef num_threads_28425\n}\n__kernel void testzisegmap_27187(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, __global\n                           ",
                   "      unsigned char *mem_28184, __global\n                                 unsigned char *mem_28186, __global\n                                 unsigned char *mem_28221, __global\n                                 unsigned char *mem_28235)\n{\n    #define segmap_group_sizze_27265 (testzisegmap_group_sizze_27189)\n    #define num_threads_28457 (testzisegmap_group_sizze_27189 * sdiv_up64(9, testzisegmap_group_sizze_27189))\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28608;\n    int32_t local_tid_28609;\n    int64_t group_sizze_28612;\n    int32_t wave_sizze_28611;\n    int32_t group_tid_28610;\n    \n    global_tid_28608 = get_global_id(0);\n    local_tid_28609 = get_local_id(0);\n    group_sizze_28612 = get_local_size(0);\n    wave_sizze_28611 = LOCKSTEP_WIDTH;\n    group_tid_28610 = get_group_id(0);\n    \n    int32_t phys_tid_27187;\n    \n    phys_tid_27187 = global_tid_28608;\n    \n    int64_t gtid_27186;\n    \n    gtid_27186 = sext_i32_i64(group_tid_28610) * segmap_group_sizze_27265 +\n        sext_i32_i64(local_tid_28609);\n    if (slt64(gtid_27186, 9)) {\n        float res_27276 = ((__global float *) mem_28186)[gtid_27186];\n        int64_t res_27277 = ((__global int64_t *) mem_28184)[gtid_27186];\n        int64_t range_end_27279 = sub64(res_27277, 1);\n        bool bounds_invalid_upwards_27280 = slt64(range_end_27279, 0);\n        bool valid_27281 = !bounds_invalid_upwards_27280;\n        bool range_valid_c_27282;\n        \n        if (!valid_27281) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 12) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = 1;\n                    global_failure_args[2] = range_end_27279;\n                    ;\n                }\n                return;\n            }\n        }\n        for (int64_t i_28165 = 0; i_28165 < res_27277; i_28165++) {\n            ",
                   "float res_27286 = sitofp_i64_f32(i_28165);\n            float res_27287 = res_27276 * res_27286;\n            \n            ((__global float *) mem_28221)[phys_tid_27187 + i_28165 *\n                                           num_threads_28457] = res_27287;\n        }\n        \n        bool y_27288 = slt64(0, res_27277);\n        bool index_certs_27289;\n        \n        if (!y_27288) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 13) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_27277;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_27290 = sitofp_i64_f32(range_end_27279);\n        float index_primexp_27291 = res_27276 * binop_y_27290;\n        float negate_arg_27292 = 1.0e-2F * index_primexp_27291;\n        float exp_arg_27293 = 0.0F - negate_arg_27292;\n        float res_27294 = fpow32(2.7182817F, exp_arg_27293);\n        float x_27295 = 1.0F - res_27294;\n        float B_27296 = x_27295 / 1.0e-2F;\n        float x_27297 = B_27296 - index_primexp_27291;\n        float x_27298 = 4.4999997e-6F * x_27297;\n        float A1_27299 = x_27298 / 1.0e-4F;\n        float y_27300 = fpow32(B_27296, 2.0F);\n        float x_27301 = 1.0000001e-6F * y_27300;\n        float A2_27302 = x_27301 / 4.0e-2F;\n        float exp_arg_27303 = A1_27299 - A2_27302;\n        float res_27304 = fpow32(2.7182817F, exp_arg_27303);\n        float negate_arg_27305 = 5.0e-2F * B_27296;\n        float exp_arg_27306 = 0.0F - negate_arg_27305;\n        float res_27307 = fpow32(2.7182817F, exp_arg_27306);\n        float res_27308 = res_27304 * res_27307;\n        bool empty_slice_27309 = range_end_27279 == 0;\n        bool zzero_leq_i_p_m_t_s_27310 = sle64(0, range_end_27279);\n        bool i_p_m_t_s_leq_w_27311 = slt64(range_end_27279, res_27277);\n        bool i_lte_j_27312 = sle64(1, res_27277);\n        bool y_27313 = zzero_leq_i_p_m_t_s_27310 && i_p_m_t_s_leq_w_273",
                   "11;\n        bool y_27314 = i_lte_j_27312 && y_27313;\n        bool ok_or_empty_27315 = empty_slice_27309 || y_27314;\n        bool index_certs_27316;\n        \n        if (!ok_or_empty_27315) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 14) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = res_27277;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float res_27318;\n        float redout_28167 = 0.0F;\n        \n        for (int64_t i_28168 = 0; i_28168 < range_end_27279; i_28168++) {\n            int64_t slice_28178 = 1 + i_28168;\n            float x_27322 = ((__global float *) mem_28221)[phys_tid_27187 +\n                                                           slice_28178 *\n                                                           num_threads_28457];\n            float negate_arg_27323 = 1.0e-2F * x_27322;\n            float exp_arg_27324 = 0.0F - negate_arg_27323;\n            float res_27325 = fpow32(2.7182817F, exp_arg_27324);\n            float x_27326 = 1.0F - res_27325;\n            float B_27327 = x_27326 / 1.0e-2F;\n            float x_27328 = B_27327 - x_27322;\n            float x_27329 = 4.4999997e-6F * x_27328;\n            float A1_27330 = x_27329 / 1.0e-4F;\n            float y_27331 = fpow32(B_27327, 2.0F);\n            float x_27332 = 1.0000001e-6F * y_27331;\n            float A2_27333 = x_27332 / 4.0e-2F;\n            float exp_arg_27334 = A1_27330 - A2_27333;\n            float res_27335 = fpow32(2.7182817F, exp_arg_27334);\n            float negate_arg_27336 = 5.0e-2F * B_27327;\n            float exp_arg_27337 = 0.0F - negate_arg_27336;\n            float res_27338 = fpow32(2.7182817F, exp_arg_27337);\n            float res_27339 = res_27335 * res_27338;\n            float res_27321 = res_27339 + redout_28167;\n            float redout_tmp_28614 = res_27321;\n            \n            redout_28167 = redout_tmp_28614;\n        }",
                   "\n        res_27318 = redout_28167;\n        \n        float x_27340 = 1.0F - res_27308;\n        float y_27341 = res_27276 * res_27318;\n        float res_27342 = x_27340 / y_27341;\n        \n        ((__global float *) mem_28235)[gtid_27186] = res_27342;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27265\n    #undef num_threads_28457\n}\n__kernel void testzisegmap_27486(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args,\n                                 int64_t paths_25438, int64_t steps_25439,\n                                 float dt_25452, int64_t upper_bound_25540,\n                                 float res_25541, int64_t num_groups_27738,\n                                 __global unsigned char *mem_28249, __global\n                                 unsigned char *mem_28252, __global\n                                 unsigned char *mem_28267)\n{\n    #define segmap_group_sizze_27737 (testzisegmap_group_sizze_27488)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_28627;\n    int32_t local_tid_28628;\n    int64_t group_sizze_28631;\n    int32_t wave_sizze_28630;\n    int32_t group_tid_28629;\n    \n    global_tid_28627 = get_global_id(0);\n    local_tid_28628 = get_local_id(0);\n    group_sizze_28631 = get_local_size(0);\n    wave_sizze_28630 = LOCKSTEP_WIDTH;\n    group_tid_28629 = get_group_id(0);\n    \n    int32_t phys_tid_27486;\n    \n    phys_tid_27486 = global_tid_28627;\n    \n    int32_t phys_group_id_28632;\n    \n    phys_group_id_28632 = get_group_id(0);\n    for (int32_t i_28633 = 0; i_28633 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(paths_25438,\n ",
                   "                                         segmap_group_sizze_27737)) -\n                   phys_group_id_28632, sext_i64_i32(num_groups_27738));\n         i_28633++) {\n        int32_t virt_group_id_28634 = phys_group_id_28632 + i_28633 *\n                sext_i64_i32(num_groups_27738);\n        int64_t gtid_27485 = sext_i32_i64(virt_group_id_28634) *\n                segmap_group_sizze_27737 + sext_i32_i64(local_tid_28628);\n        \n        if (slt64(gtid_27485, paths_25438)) {\n            for (int64_t i_28635 = 0; i_28635 < steps_25439; i_28635++) {\n                ((__global float *) mem_28252)[phys_tid_27486 + i_28635 *\n                                               (num_groups_27738 *\n                                                segmap_group_sizze_27737)] =\n                    5.0e-2F;\n            }\n            for (int64_t i_27744 = 0; i_27744 < upper_bound_25540; i_27744++) {\n                bool y_27746 = slt64(i_27744, steps_25439);\n                bool index_certs_27747;\n                \n                if (!y_27746) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 15) ==\n                            -1) {\n                            global_failure_args[0] = i_27744;\n                            global_failure_args[1] = steps_25439;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float shortstep_arg_27748 = ((__global\n                                              float *) mem_28249)[i_27744 *\n                                                                  paths_25438 +\n                                                                  gtid_27485];\n                float shortstep_arg_27749 = ((__global\n                                              float *) mem_28252)[phys_tid_27486 +\n                                                                  i_2",
                   "7744 *\n                                                                  (num_groups_27738 *\n                                                                   segmap_group_sizze_27737)];\n                float y_27750 = 5.0e-2F - shortstep_arg_27749;\n                float x_27751 = 1.0e-2F * y_27750;\n                float x_27752 = dt_25452 * x_27751;\n                float x_27753 = res_25541 * shortstep_arg_27748;\n                float y_27754 = 1.0e-3F * x_27753;\n                float delta_r_27755 = x_27752 + y_27754;\n                float res_27756 = shortstep_arg_27749 + delta_r_27755;\n                int64_t i_27757 = add64(1, i_27744);\n                bool x_27758 = sle64(0, i_27757);\n                bool y_27759 = slt64(i_27757, steps_25439);\n                bool bounds_check_27760 = x_27758 && y_27759;\n                bool index_certs_27761;\n                \n                if (!bounds_check_27760) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 16) ==\n                            -1) {\n                            global_failure_args[0] = i_27757;\n                            global_failure_args[1] = steps_25439;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                ((__global float *) mem_28252)[phys_tid_27486 + i_27757 *\n                                               (num_groups_27738 *\n                                                segmap_group_sizze_27737)] =\n                    res_27756;\n            }\n            for (int64_t i_28637 = 0; i_28637 < steps_25439; i_28637++) {\n                ((__global float *) mem_28267)[i_28637 * paths_25438 +\n                                               gtid_27485] = ((__global\n                                                               float *) mem_28252)[phys_tid_27486 +\n                                                    ",
                   "                               i_28637 *\n                                                                                   (num_groups_27738 *\n                                                                                    segmap_group_sizze_27737)];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27737\n}\n__kernel void testzisegmap_27584(__global int *global_failure,\n                                 int64_t paths_25438, int64_t steps_25439,\n                                 __global unsigned char *mem_28242, __global\n                                 unsigned char *mem_28246)\n{\n    #define segmap_group_sizze_27692 (testzisegmap_group_sizze_27587)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28621;\n    int32_t local_tid_28622;\n    int64_t group_sizze_28625;\n    int32_t wave_sizze_28624;\n    int32_t group_tid_28623;\n    \n    global_tid_28621 = get_global_id(0);\n    local_tid_28622 = get_local_id(0);\n    group_sizze_28625 = get_local_size(0);\n    wave_sizze_28624 = LOCKSTEP_WIDTH;\n    group_tid_28623 = get_group_id(0);\n    \n    int32_t phys_tid_27584;\n    \n    phys_tid_27584 = global_tid_28621;\n    \n    int64_t gtid_27582;\n    \n    gtid_27582 = squot64(sext_i32_i64(group_tid_28623) *\n                         segmap_group_sizze_27692 +\n                         sext_i32_i64(local_tid_28622), steps_25439);\n    \n    int64_t gtid_27583;\n    \n    gtid_27583 = sext_i32_i64(group_tid_28623) * segmap_group_sizze_27692 +\n        sext_i32_i64(local_tid_28622) - squot64(sext_i32_i64(group_tid_28623) *\n                                                segmap_group_sizze_27692 +\n                                                sext_i32_i64(local_tid_28622),\n                                                steps_25439) * steps_25439;\n    if (slt64(gtid_27582,",
                   " paths_25438) && slt64(gtid_27583, steps_25439)) {\n        int32_t unsign_arg_27695 = ((__global int32_t *) mem_28242)[gtid_27582];\n        int32_t res_27697 = sext_i64_i32(gtid_27583);\n        int32_t x_27698 = lshr32(res_27697, 16);\n        int32_t x_27699 = res_27697 ^ x_27698;\n        int32_t x_27700 = mul32(73244475, x_27699);\n        int32_t x_27701 = lshr32(x_27700, 16);\n        int32_t x_27702 = x_27700 ^ x_27701;\n        int32_t x_27703 = mul32(73244475, x_27702);\n        int32_t x_27704 = lshr32(x_27703, 16);\n        int32_t x_27705 = x_27703 ^ x_27704;\n        int32_t unsign_arg_27706 = unsign_arg_27695 ^ x_27705;\n        int32_t unsign_arg_27707 = mul32(48271, unsign_arg_27706);\n        int32_t unsign_arg_27708 = umod32(unsign_arg_27707, 2147483647);\n        int32_t unsign_arg_27709 = mul32(48271, unsign_arg_27708);\n        int32_t unsign_arg_27710 = umod32(unsign_arg_27709, 2147483647);\n        float res_27711 = uitofp_i32_f32(unsign_arg_27708);\n        float res_27712 = res_27711 / 2.1474836e9F;\n        float res_27713 = uitofp_i32_f32(unsign_arg_27710);\n        float res_27714 = res_27713 / 2.1474836e9F;\n        float res_27715;\n        \n        res_27715 = futrts_log32(res_27712);\n        \n        float res_27716 = -2.0F * res_27715;\n        float res_27717;\n        \n        res_27717 = futrts_sqrt32(res_27716);\n        \n        float res_27718 = 6.2831855F * res_27714;\n        float res_27719;\n        \n        res_27719 = futrts_cos32(res_27718);\n        \n        float res_27720 = res_27717 * res_27719;\n        \n        ((__global float *) mem_28246)[gtid_27582 * steps_25439 + gtid_27583] =\n            res_27720;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27692\n}\n__kernel void testzisegmap_27648(__global int *global_failure,\n                                 int64_t paths_25438, __global\n                                 unsigned char *mem_28242)\n{\n    #define segmap_group_sizze_27667 (testzisegmap_group_sizze_27650)\n    \n    cons",
                   "t int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28616;\n    int32_t local_tid_28617;\n    int64_t group_sizze_28620;\n    int32_t wave_sizze_28619;\n    int32_t group_tid_28618;\n    \n    global_tid_28616 = get_global_id(0);\n    local_tid_28617 = get_local_id(0);\n    group_sizze_28620 = get_local_size(0);\n    wave_sizze_28619 = LOCKSTEP_WIDTH;\n    group_tid_28618 = get_group_id(0);\n    \n    int32_t phys_tid_27648;\n    \n    phys_tid_27648 = global_tid_28616;\n    \n    int64_t gtid_27647;\n    \n    gtid_27647 = sext_i32_i64(group_tid_28618) * segmap_group_sizze_27667 +\n        sext_i32_i64(local_tid_28617);\n    if (slt64(gtid_27647, paths_25438)) {\n        int32_t res_27671 = sext_i64_i32(gtid_27647);\n        int32_t x_27672 = lshr32(res_27671, 16);\n        int32_t x_27673 = res_27671 ^ x_27672;\n        int32_t x_27674 = mul32(73244475, x_27673);\n        int32_t x_27675 = lshr32(x_27674, 16);\n        int32_t x_27676 = x_27674 ^ x_27675;\n        int32_t x_27677 = mul32(73244475, x_27676);\n        int32_t x_27678 = lshr32(x_27677, 16);\n        int32_t x_27679 = x_27677 ^ x_27678;\n        int32_t unsign_arg_27680 = 777822902 ^ x_27679;\n        int32_t unsign_arg_27681 = mul32(48271, unsign_arg_27680);\n        int32_t unsign_arg_27682 = umod32(unsign_arg_27681, 2147483647);\n        \n        ((__global int32_t *) mem_28242)[gtid_27647] = unsign_arg_27682;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27667\n}\n__kernel void testzisegmap_27941(__global int *global_failure,\n                                 int64_t res_25638, int64_t num_segments_25825,\n                                 __global unsigned char *mem_28290, __global\n                                 unsigned char *mem_28295, __global\n                                 unsigned char *mem_28298, __global\n                                 unsigned char *mem_28300)\n{\n    #define segmap_group_sizze_279",
                   "44 (testzisegmap_group_sizze_27943)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29142;\n    int32_t local_tid_29143;\n    int64_t group_sizze_29146;\n    int32_t wave_sizze_29145;\n    int32_t group_tid_29144;\n    \n    global_tid_29142 = get_global_id(0);\n    local_tid_29143 = get_local_id(0);\n    group_sizze_29146 = get_local_size(0);\n    wave_sizze_29145 = LOCKSTEP_WIDTH;\n    group_tid_29144 = get_group_id(0);\n    \n    int32_t phys_tid_27941;\n    \n    phys_tid_27941 = global_tid_29142;\n    \n    int64_t write_i_27940;\n    \n    write_i_27940 = sext_i32_i64(group_tid_29144) * segmap_group_sizze_27944 +\n        sext_i32_i64(local_tid_29143);\n    if (slt64(write_i_27940, res_25638)) {\n        int64_t i_p_o_28122 = add64(1, write_i_27940);\n        int64_t rot_i_28123 = smod64(i_p_o_28122, res_25638);\n        bool x_25838 = ((__global bool *) mem_28290)[rot_i_28123];\n        float write_value_25839 = ((__global float *) mem_28295)[write_i_27940];\n        int64_t res_25840;\n        \n        if (x_25838) {\n            int64_t x_25837 = ((__global int64_t *) mem_28298)[write_i_27940];\n            int64_t res_25841 = sub64(x_25837, 1);\n            \n            res_25840 = res_25841;\n        } else {\n            res_25840 = -1;\n        }\n        if (sle64(0, res_25840) && slt64(res_25840, num_segments_25825)) {\n            ((__global float *) mem_28300)[res_25840] = write_value_25839;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27944\n}\n__kernel void testzisegmap_27979(__global int *global_failure,\n                                 int64_t paths_25438, __global\n                                 unsigned char *mem_28310, __global\n                                 unsigned char *mem_28313)\n{\n    #define segmap_group_sizze_28058 (testzisegmap_group_sizze_27981)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    ",
                   "const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29178;\n    int32_t local_tid_29179;\n    int64_t group_sizze_29182;\n    int32_t wave_sizze_29181;\n    int32_t group_tid_29180;\n    \n    global_tid_29178 = get_global_id(0);\n    local_tid_29179 = get_local_id(0);\n    group_sizze_29182 = get_local_size(0);\n    wave_sizze_29181 = LOCKSTEP_WIDTH;\n    group_tid_29180 = get_group_id(0);\n    \n    int32_t phys_tid_27979;\n    \n    phys_tid_27979 = global_tid_29178;\n    \n    int64_t gtid_27978;\n    \n    gtid_27978 = sext_i32_i64(group_tid_29180) * segmap_group_sizze_28058 +\n        sext_i32_i64(local_tid_29179);\n    if (slt64(gtid_27978, paths_25438)) {\n        float res_28062;\n        float redout_28171 = 0.0F;\n        \n        for (int32_t i_28180 = 0; i_28180 < 9; i_28180++) {\n            int64_t i_28172 = sext_i32_i64(i_28180);\n            float x_28066 = ((__global float *) mem_28310)[i_28172 *\n                                                           paths_25438 +\n                                                           gtid_27978];\n            float res_28065 = x_28066 + redout_28171;\n            float redout_tmp_29183 = res_28065;\n            \n            redout_28171 = redout_tmp_29183;\n        }\n        res_28062 = redout_28171;\n        \n        float res_28067 = fmax32(0.0F, res_28062);\n        \n        ((__global float *) mem_28313)[gtid_27978] = res_28067;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_28058\n}\n__kernel void testzisegmap_28004(__global int *global_failure,\n                                 int64_t paths_25438, __global\n                                 unsigned char *mem_28316, __global\n                                 unsigned char *mem_28319)\n{\n    #define segmap_group_sizze_28080 (testzisegmap_group_sizze_28006)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t gl",
                   "obal_tid_29244;\n    int32_t local_tid_29245;\n    int64_t group_sizze_29248;\n    int32_t wave_sizze_29247;\n    int32_t group_tid_29246;\n    \n    global_tid_29244 = get_global_id(0);\n    local_tid_29245 = get_local_id(0);\n    group_sizze_29248 = get_local_size(0);\n    wave_sizze_29247 = LOCKSTEP_WIDTH;\n    group_tid_29246 = get_group_id(0);\n    \n    int32_t phys_tid_28004;\n    \n    phys_tid_28004 = global_tid_29244;\n    \n    int64_t gtid_28003;\n    \n    gtid_28003 = sext_i32_i64(group_tid_29246) * segmap_group_sizze_28080 +\n        sext_i32_i64(local_tid_29245);\n    if (slt64(gtid_28003, paths_25438)) {\n        float res_28083 = ((__global float *) mem_28316)[gtid_28003];\n        float res_28084 = fmax32(0.0F, res_28083);\n        \n        ((__global float *) mem_28319)[gtid_28003] = res_28084;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_28080\n}\n__kernel void testzisegred_large_28020(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_29221_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_29219_backing_aligned_1,\n                                       int64_t num_groups_28071, __global\n                                       unsigned char *mem_28300, __global\n                                       unsigned char *mem_28316,\n                                       int64_t groups_per_segment_29205,\n                                       int64_t elements_per_thread_29206,\n                                       int64_t virt_num_groups_29207,\n                                       int64_t threads_per_segment_29209,\n                                       __global\n                                       unsigned char *group_res_arr_mem_29210,\n                                       __global\n                                       unsigned char *testzicounter_mem_29212)\n{\n    #define s",
                   "egred_group_sizze_28070 (testzisegred_group_sizze_28014)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_29221_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_29221_backing_aligned_0;\n    __local volatile char *restrict red_arr_mem_29219_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_29219_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29214;\n    int32_t local_tid_29215;\n    int64_t group_sizze_29218;\n    int32_t wave_sizze_29217;\n    int32_t group_tid_29216;\n    \n    global_tid_29214 = get_global_id(0);\n    local_tid_29215 = get_local_id(0);\n    group_sizze_29218 = get_local_size(0);\n    wave_sizze_29217 = LOCKSTEP_WIDTH;\n    group_tid_29216 = get_group_id(0);\n    \n    int32_t phys_tid_28020;\n    \n    phys_tid_28020 = global_tid_29214;\n    \n    __local char *red_arr_mem_29219;\n    \n    red_arr_mem_29219 = (__local char *) red_arr_mem_29219_backing_0;\n    \n    __local char *sync_arr_mem_29221;\n    \n    sync_arr_mem_29221 = (__local char *) sync_arr_mem_29221_backing_1;\n    \n    int32_t phys_group_id_29223;\n    \n    phys_group_id_29223 = get_group_id(0);\n    for (int32_t i_29224 = 0; i_29224 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_29207) - phys_group_id_29223,\n                   sext_i64_i32(num_groups_28071)); i_29224++) {\n        int32_t virt_group_id_29225 = phys_group_id_29223 + i_29224 *\n                sext_i64_i32(num_groups_28071);\n        int32_t flat_segment_id_29226 = squot32(virt_group_id_29225,\n                                                sext_i64_i32(groups_per_segment_29205));\n        int64_t global_tid_29227 = srem64(sext_i32_i64(virt_group_id_29225) *\n                                          segred_group_sizze_28070 +\n                                          sext_i32_i64(local_tid_",
                   "29215),\n                                          segred_group_sizze_28070 *\n                                          groups_per_segment_29205);\n        int64_t gtid_28011 = sext_i32_i64(flat_segment_id_29226);\n        int64_t gtid_28019;\n        float x_acc_29228;\n        int64_t chunk_sizze_29229;\n        \n        chunk_sizze_29229 = smin64(elements_per_thread_29206, sdiv_up64(9 -\n                                                                        sext_i32_i64(sext_i64_i32(global_tid_29227)),\n                                                                        threads_per_segment_29209));\n        \n        float x_28074;\n        float x_28075;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_29228 = 0.0F;\n        }\n        for (int64_t i_29233 = 0; i_29233 < chunk_sizze_29229; i_29233++) {\n            gtid_28019 = sext_i32_i64(sext_i64_i32(global_tid_29227)) +\n                threads_per_segment_29209 * i_29233;\n            // apply map function\n            {\n                int64_t binop_x_28132 = 9 * gtid_28011;\n                int64_t new_index_28133 = gtid_28019 + binop_x_28132;\n                float x_28078 = ((__global float *) mem_28300)[new_index_28133];\n                \n                // save map-out results\n                { }\n                // load accumulator\n                {\n                    x_28074 = x_acc_29228;\n                }\n                // load new values\n                {\n                    x_28075 = x_28078;\n                }\n                // apply reduction operator\n                {\n                    float res_28076 = x_28074 + x_28075;\n                    \n                    // store in accumulator\n                    {\n                        x_acc_29228 = res_28076;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_28074 = x_acc_29228;\n            ((__local\n              floa",
                   "t *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215)] =\n                x_28074;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_29234;\n        int32_t skip_waves_29235;\n        \n        skip_waves_29235 = 1;\n        \n        float x_29230;\n        float x_29231;\n        \n        offset_29234 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_29215,\n                      sext_i64_i32(segred_group_sizze_28070))) {\n                x_29230 = ((__local\n                            float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215 +\n                                                        offset_29234)];\n            }\n        }\n        offset_29234 = 1;\n        while (slt32(offset_29234, wave_sizze_29217)) {\n            if (slt32(local_tid_29215 + offset_29234,\n                      sext_i64_i32(segred_group_sizze_28070)) &&\n                ((local_tid_29215 - squot32(local_tid_29215, wave_sizze_29217) *\n                  wave_sizze_29217) & (2 * offset_29234 - 1)) == 0) {\n                // read array element\n                {\n                    x_29231 = ((volatile __local\n                                float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215 +\n                                                            offset_29234)];\n                }\n                // apply reduction operation\n                {\n                    float res_29232 = x_29230 + x_29231;\n                    \n                    x_29230 = res_29232;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215)] =\n                        x_29230;\n                }\n            }\n            offset_29234 *= 2;\n        }\n        while (slt32(skip_waves_29235,\n                     squot32(sext_i64_i32(segred_group_sizze_28070) +\n                             wave_s",
                   "izze_29217 - 1, wave_sizze_29217))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_29234 = skip_waves_29235 * wave_sizze_29217;\n            if (slt32(local_tid_29215 + offset_29234,\n                      sext_i64_i32(segred_group_sizze_28070)) &&\n                ((local_tid_29215 - squot32(local_tid_29215, wave_sizze_29217) *\n                  wave_sizze_29217) == 0 && (squot32(local_tid_29215,\n                                                     wave_sizze_29217) & (2 *\n                                                                          skip_waves_29235 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_29231 = ((__local\n                                float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215 +\n                                                            offset_29234)];\n                }\n                // apply reduction operation\n                {\n                    float res_29232 = x_29230 + x_29231;\n                    \n                    x_29230 = res_29232;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215)] =\n                        x_29230;\n                }\n            }\n            skip_waves_29235 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_29215) == 0) {\n                x_acc_29228 = x_29230;\n            }\n        }\n        if (groups_per_segment_29205 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_29215 == 0) {\n                    ((__global float *) mem_28316)[gtid_28011] = x_acc_29228;\n                }\n            }\n        } else {\n            int32_t old_cou",
                   "nter_29236;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_29215 == 0) {\n                    ((__global\n                      float *) group_res_arr_mem_29210)[sext_i32_i64(virt_group_id_29225) *\n                                                        segred_group_sizze_28070] =\n                        x_acc_29228;\n                    mem_fence_global();\n                    old_counter_29236 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_29212)[sext_i32_i64(srem32(flat_segment_id_29226,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_29221)[0] =\n                        old_counter_29236 == groups_per_segment_29205 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_29237;\n            \n            is_last_group_29237 = ((__local bool *) sync_arr_mem_29221)[0];\n            if (is_last_group_29237) {\n                if (local_tid_29215 == 0) {\n                    old_counter_29236 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_29212)[sext_i32_i64(srem32(flat_segment_id_29226,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_29205));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_29238 =\n                            sdiv_up64(groups_per_segment_29205,\n                       ",
                   "               segred_group_sizze_28070);\n                    \n                    x_28074 = 0.0F;\n                    for (int64_t i_29239 = 0; i_29239 < read_per_thread_29238;\n                         i_29239++) {\n                        int64_t group_res_id_29240 =\n                                sext_i32_i64(local_tid_29215) *\n                                read_per_thread_29238 + i_29239;\n                        int64_t index_of_group_res_29241 =\n                                sext_i32_i64(flat_segment_id_29226) *\n                                groups_per_segment_29205 + group_res_id_29240;\n                        \n                        if (slt64(group_res_id_29240,\n                                  groups_per_segment_29205)) {\n                            x_28075 = ((__global\n                                        float *) group_res_arr_mem_29210)[index_of_group_res_29241 *\n                                                                          segred_group_sizze_28070];\n                            \n                            float res_28076;\n                            \n                            res_28076 = x_28074 + x_28075;\n                            x_28074 = res_28076;\n                        }\n                    }\n                }\n                ((__local\n                  float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215)] =\n                    x_28074;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_29242;\n                    int32_t skip_waves_29243;\n                    \n                    skip_waves_29243 = 1;\n                    \n                    float x_29230;\n                    float x_29231;\n                    \n                    offset_29242 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_29215,\n                                  ",
                   "sext_i64_i32(segred_group_sizze_28070))) {\n                            x_29230 = ((__local\n                                        float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215 +\n                                                                    offset_29242)];\n                        }\n                    }\n                    offset_29242 = 1;\n                    while (slt32(offset_29242, wave_sizze_29217)) {\n                        if (slt32(local_tid_29215 + offset_29242,\n                                  sext_i64_i32(segred_group_sizze_28070)) &&\n                            ((local_tid_29215 - squot32(local_tid_29215,\n                                                        wave_sizze_29217) *\n                              wave_sizze_29217) & (2 * offset_29242 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_29231 = ((volatile __local\n                                            float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215 +\n                                                                        offset_29242)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_29232 = x_29230 + x_29231;\n                                \n                                x_29230 = res_29232;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215)] =\n                                    x_29230;\n                            }\n                        }\n                        offset_29242 *= 2;\n                    }\n                    while (slt32(skip_waves_29243,\n                                 squot32(sext_i64_i32(segred_group_sizze_28070) +\n    ",
                   "                                     wave_sizze_29217 - 1,\n                                         wave_sizze_29217))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_29242 = skip_waves_29243 * wave_sizze_29217;\n                        if (slt32(local_tid_29215 + offset_29242,\n                                  sext_i64_i32(segred_group_sizze_28070)) &&\n                            ((local_tid_29215 - squot32(local_tid_29215,\n                                                        wave_sizze_29217) *\n                              wave_sizze_29217) == 0 &&\n                             (squot32(local_tid_29215, wave_sizze_29217) & (2 *\n                                                                            skip_waves_29243 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_29231 = ((__local\n                                            float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215 +\n                                                                        offset_29242)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_29232 = x_29230 + x_29231;\n                                \n                                x_29230 = res_29232;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29215)] =\n                                    x_29230;\n                            }\n                        }\n                        skip_waves_29243 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n  ",
                   "                      if (local_tid_29215 == 0) {\n                            ((__global float *) mem_28316)[gtid_28011] =\n                                x_29230;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_28070\n}\n__kernel void testzisegred_large_28820(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_28858_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_28856_backing_aligned_1,\n                                       int64_t res_25638,\n                                       int64_t num_groups_27853, __global\n                                       unsigned char *mem_28277,\n                                       int32_t num_subhistos_28734, __global\n                                       unsigned char *res_subhistos_mem_28735,\n                                       int64_t groups_per_segment_28842,\n                                       int64_t elements_per_thread_28843,\n                                       int64_t virt_num_groups_28844,\n                                       int64_t threads_per_segment_28846,\n                                       __global\n                                       unsigned char *group_res_arr_mem_28847,\n                                       __global\n                                       unsigned char *testzicounter_mem_28849)\n{\n    #define seghist_group_sizze_27851 (testziseghist_group_sizze_27850)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_28858_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_28858_backing_aligned_0;\n    __loca",
                   "l volatile char *restrict red_arr_mem_28856_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28856_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28851;\n    int32_t local_tid_28852;\n    int64_t group_sizze_28855;\n    int32_t wave_sizze_28854;\n    int32_t group_tid_28853;\n    \n    global_tid_28851 = get_global_id(0);\n    local_tid_28852 = get_local_id(0);\n    group_sizze_28855 = get_local_size(0);\n    wave_sizze_28854 = LOCKSTEP_WIDTH;\n    group_tid_28853 = get_group_id(0);\n    \n    int32_t flat_gtid_28820;\n    \n    flat_gtid_28820 = global_tid_28851;\n    \n    __local char *red_arr_mem_28856;\n    \n    red_arr_mem_28856 = (__local char *) red_arr_mem_28856_backing_0;\n    \n    __local char *sync_arr_mem_28858;\n    \n    sync_arr_mem_28858 = (__local char *) sync_arr_mem_28858_backing_1;\n    \n    int32_t phys_group_id_28860;\n    \n    phys_group_id_28860 = get_group_id(0);\n    for (int32_t i_28861 = 0; i_28861 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_28844) - phys_group_id_28860,\n                   sext_i64_i32(num_groups_27853)); i_28861++) {\n        int32_t virt_group_id_28862 = phys_group_id_28860 + i_28861 *\n                sext_i64_i32(num_groups_27853);\n        int32_t flat_segment_id_28863 = squot32(virt_group_id_28862,\n                                                sext_i64_i32(groups_per_segment_28842));\n        int64_t global_tid_28864 = srem64(sext_i32_i64(virt_group_id_28862) *\n                                          seghist_group_sizze_27851 +\n                                          sext_i32_i64(local_tid_28852),\n                                          seghist_group_sizze_27851 *\n                                          groups_per_segment_28842);\n        int64_t bucket_id_28818 = sext_i32_i64(flat_segment_id_28863);\n        int64_t subhistogram_id_28819;\n        int64_t x_acc_28865;\n        int64_t chunk_sizze_28866;\n        \n        chunk",
                   "_sizze_28866 = smin64(elements_per_thread_28843,\n                                   sdiv_up64(num_subhistos_28734 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_28864)),\n                                             threads_per_segment_28846));\n        \n        int64_t x_27857;\n        int64_t x_27858;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_28865 = 0;\n        }\n        for (int64_t i_28870 = 0; i_28870 < chunk_sizze_28866; i_28870++) {\n            subhistogram_id_28819 =\n                sext_i32_i64(sext_i64_i32(global_tid_28864)) +\n                threads_per_segment_28846 * i_28870;\n            // apply map function\n            {\n                // load accumulator\n                {\n                    x_27857 = x_acc_28865;\n                }\n                // load new values\n                {\n                    x_27858 = ((__global\n                                int64_t *) res_subhistos_mem_28735)[subhistogram_id_28819 *\n                                                                    res_25638 +\n                                                                    bucket_id_28818];\n                }\n                // apply reduction operator\n                {\n                    int64_t res_27859 = smax64(x_27857, x_27858);\n                    \n                    // store in accumulator\n                    {\n                        x_acc_28865 = res_27859;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_27857 = x_acc_28865;\n            ((__local\n              int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852)] =\n                x_27857;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_28871;\n        int32_t skip_waves_28872;\n        \n        skip_waves_28872 = 1;\n        \n        int64_t x_28867;\n        int64_t x_28868;\n        \n",
                   "        offset_28871 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_28852,\n                      sext_i64_i32(seghist_group_sizze_27851))) {\n                x_28867 = ((__local\n                            int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852 +\n                                                          offset_28871)];\n            }\n        }\n        offset_28871 = 1;\n        while (slt32(offset_28871, wave_sizze_28854)) {\n            if (slt32(local_tid_28852 + offset_28871,\n                      sext_i64_i32(seghist_group_sizze_27851)) &&\n                ((local_tid_28852 - squot32(local_tid_28852, wave_sizze_28854) *\n                  wave_sizze_28854) & (2 * offset_28871 - 1)) == 0) {\n                // read array element\n                {\n                    x_28868 = ((volatile __local\n                                int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852 +\n                                                              offset_28871)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_28869 = smax64(x_28867, x_28868);\n                    \n                    x_28867 = res_28869;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852)] =\n                        x_28867;\n                }\n            }\n            offset_28871 *= 2;\n        }\n        while (slt32(skip_waves_28872,\n                     squot32(sext_i64_i32(seghist_group_sizze_27851) +\n                             wave_sizze_28854 - 1, wave_sizze_28854))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_28871 = skip_waves_28872 * wave_sizze_28854;\n            if (slt32(local_tid_28852 + offset_28871,\n                      sext_i64_i32(seghist_group_sizze_27851)) &&\n                ((lo",
                   "cal_tid_28852 - squot32(local_tid_28852, wave_sizze_28854) *\n                  wave_sizze_28854) == 0 && (squot32(local_tid_28852,\n                                                     wave_sizze_28854) & (2 *\n                                                                          skip_waves_28872 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_28868 = ((__local\n                                int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852 +\n                                                              offset_28871)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_28869 = smax64(x_28867, x_28868);\n                    \n                    x_28867 = res_28869;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852)] =\n                        x_28867;\n                }\n            }\n            skip_waves_28872 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_28852) == 0) {\n                x_acc_28865 = x_28867;\n            }\n        }\n        if (groups_per_segment_28842 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_28852 == 0) {\n                    ((__global int64_t *) mem_28277)[bucket_id_28818] =\n                        x_acc_28865;\n                }\n            }\n        } else {\n            int32_t old_counter_28873;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_28852 == 0) {\n                    ((__global\n                      int64_t *) group_res_arr_mem",
                   "_28847)[sext_i32_i64(virt_group_id_28862) *\n                                                          seghist_group_sizze_27851] =\n                        x_acc_28865;\n                    mem_fence_global();\n                    old_counter_28873 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_28849)[sext_i32_i64(srem32(flat_segment_id_28863,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_28858)[0] =\n                        old_counter_28873 == groups_per_segment_28842 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_28874;\n            \n            is_last_group_28874 = ((__local bool *) sync_arr_mem_28858)[0];\n            if (is_last_group_28874) {\n                if (local_tid_28852 == 0) {\n                    old_counter_28873 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_28849)[sext_i32_i64(srem32(flat_segment_id_28863,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_28842));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_28875 =\n                            sdiv_up64(groups_per_segment_28842,\n                                      seghist_group_sizze_27851);\n                    \n                    x_27857 = 0;\n                    for (int64_t i_28876 = 0; i_28876 < read_per_thread_28875;\n                         i_28876++) {\n                  ",
                   "      int64_t group_res_id_28877 =\n                                sext_i32_i64(local_tid_28852) *\n                                read_per_thread_28875 + i_28876;\n                        int64_t index_of_group_res_28878 =\n                                sext_i32_i64(flat_segment_id_28863) *\n                                groups_per_segment_28842 + group_res_id_28877;\n                        \n                        if (slt64(group_res_id_28877,\n                                  groups_per_segment_28842)) {\n                            x_27858 = ((__global\n                                        int64_t *) group_res_arr_mem_28847)[index_of_group_res_28878 *\n                                                                            seghist_group_sizze_27851];\n                            \n                            int64_t res_27859;\n                            \n                            res_27859 = smax64(x_27857, x_27858);\n                            x_27857 = res_27859;\n                        }\n                    }\n                }\n                ((__local\n                  int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852)] =\n                    x_27857;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_28879;\n                    int32_t skip_waves_28880;\n                    \n                    skip_waves_28880 = 1;\n                    \n                    int64_t x_28867;\n                    int64_t x_28868;\n                    \n                    offset_28879 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_28852,\n                                  sext_i64_i32(seghist_group_sizze_27851))) {\n                            x_28867 = ((__local\n                                        int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852 +\n                     ",
                   "                                                 offset_28879)];\n                        }\n                    }\n                    offset_28879 = 1;\n                    while (slt32(offset_28879, wave_sizze_28854)) {\n                        if (slt32(local_tid_28852 + offset_28879,\n                                  sext_i64_i32(seghist_group_sizze_27851)) &&\n                            ((local_tid_28852 - squot32(local_tid_28852,\n                                                        wave_sizze_28854) *\n                              wave_sizze_28854) & (2 * offset_28879 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_28868 = ((volatile __local\n                                            int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852 +\n                                                                          offset_28879)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_28869 = smax64(x_28867, x_28868);\n                                \n                                x_28867 = res_28869;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852)] =\n                                    x_28867;\n                            }\n                        }\n                        offset_28879 *= 2;\n                    }\n                    while (slt32(skip_waves_28880,\n                                 squot32(sext_i64_i32(seghist_group_sizze_27851) +\n                                         wave_sizze_28854 - 1,\n                                         wave_sizze_28854))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                ",
                   "        offset_28879 = skip_waves_28880 * wave_sizze_28854;\n                        if (slt32(local_tid_28852 + offset_28879,\n                                  sext_i64_i32(seghist_group_sizze_27851)) &&\n                            ((local_tid_28852 - squot32(local_tid_28852,\n                                                        wave_sizze_28854) *\n                              wave_sizze_28854) == 0 &&\n                             (squot32(local_tid_28852, wave_sizze_28854) & (2 *\n                                                                            skip_waves_28880 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_28868 = ((__local\n                                            int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852 +\n                                                                          offset_28879)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_28869 = smax64(x_28867, x_28868);\n                                \n                                x_28867 = res_28869;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  int64_t *) red_arr_mem_28856)[sext_i32_i64(local_tid_28852)] =\n                                    x_28867;\n                            }\n                        }\n                        skip_waves_28880 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_28852 == 0) {\n                            ((__global int64_t *) mem_28277)[bucket_id_28818] =\n                                x_28867;\n     ",
                   "                   }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_27851\n}\n__kernel void testzisegred_nonseg_26997(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28523_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28521_backing_aligned_1,\n                                        int64_t num_groups_26992, __global\n                                        unsigned char *mem_28184, __global\n                                        unsigned char *mem_28186, __global\n                                        unsigned char *mem_28189, __global\n                                        unsigned char *testzicounter_mem_28511,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28513,\n                                        int64_t num_threads_28515)\n{\n    #define segred_group_sizze_26990 (testzisegred_group_sizze_26989)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28523_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28523_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28521_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28521_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28516;\n    int32_t local_tid_28517;\n    int64_t group_sizze_28520;\n    int32_t wave_sizze_28519;\n    int32_t group_tid_28518;\n    \n    global_tid_28516 = get_global_id(0);\n    local_tid_28517 = get_local_id(0);\n    group_sizze_28520 = g",
                   "et_local_size(0);\n    wave_sizze_28519 = LOCKSTEP_WIDTH;\n    group_tid_28518 = get_group_id(0);\n    \n    int32_t phys_tid_26997;\n    \n    phys_tid_26997 = global_tid_28516;\n    \n    __local char *sync_arr_mem_28521;\n    \n    sync_arr_mem_28521 = (__local char *) sync_arr_mem_28521_backing_0;\n    \n    __local char *red_arr_mem_28523;\n    \n    red_arr_mem_28523 = (__local char *) red_arr_mem_28523_backing_1;\n    \n    int64_t dummy_26995;\n    \n    dummy_26995 = 0;\n    \n    int64_t gtid_26996;\n    \n    gtid_26996 = 0;\n    \n    float x_acc_28525;\n    int64_t chunk_sizze_28526;\n    \n    chunk_sizze_28526 = smin64(sdiv_up64(9,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_26990 *\n                                         num_groups_26992))), sdiv_up64(9 -\n                                                                        sext_i32_i64(phys_tid_26997),\n                                                                        num_threads_28515));\n    \n    float x_25444;\n    float x_25445;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28525 = -INFINITY;\n    }\n    for (int64_t i_28530 = 0; i_28530 < chunk_sizze_28526; i_28530++) {\n        gtid_26996 = sext_i32_i64(phys_tid_26997) + num_threads_28515 * i_28530;\n        // apply map function\n        {\n            float x_25447 = ((__global float *) mem_28186)[gtid_26996];\n            int64_t x_25448 = ((__global int64_t *) mem_28184)[gtid_26996];\n            float res_25449 = sitofp_i64_f32(x_25448);\n            float res_25450 = x_25447 * res_25449;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_25444 = x_acc_28525;\n            }\n            // load new values\n            {\n                x_25445 = res_25450;\n            }\n            // apply reduction operator\n            {\n                float res_25446 = fmax32(x_25444, x_25445);\n                \n                // store in accum",
                   "ulator\n                {\n                    x_acc_28525 = res_25446;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_25444 = x_acc_28525;\n        ((__local float *) red_arr_mem_28523)[sext_i32_i64(local_tid_28517)] =\n            x_25444;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28531;\n    int32_t skip_waves_28532;\n    \n    skip_waves_28532 = 1;\n    \n    float x_28527;\n    float x_28528;\n    \n    offset_28531 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28517, sext_i64_i32(segred_group_sizze_26990))) {\n            x_28527 = ((__local\n                        float *) red_arr_mem_28523)[sext_i32_i64(local_tid_28517 +\n                                                    offset_28531)];\n        }\n    }\n    offset_28531 = 1;\n    while (slt32(offset_28531, wave_sizze_28519)) {\n        if (slt32(local_tid_28517 + offset_28531,\n                  sext_i64_i32(segred_group_sizze_26990)) && ((local_tid_28517 -\n                                                               squot32(local_tid_28517,\n                                                                       wave_sizze_28519) *\n                                                               wave_sizze_28519) &\n                                                              (2 *\n                                                               offset_28531 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28528 = ((volatile __local\n                            float *) red_arr_mem_28523)[sext_i32_i64(local_tid_28517 +\n                                                        offset_28531)];\n            }\n            // apply reduction operation\n            {\n                float res_28529 = fmax32(x_28527, x_28528);\n                \n                x_28527 = res_28529;\n            }\n     ",
                   "       // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_28523)[sext_i32_i64(local_tid_28517)] =\n                    x_28527;\n            }\n        }\n        offset_28531 *= 2;\n    }\n    while (slt32(skip_waves_28532,\n                 squot32(sext_i64_i32(segred_group_sizze_26990) +\n                         wave_sizze_28519 - 1, wave_sizze_28519))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28531 = skip_waves_28532 * wave_sizze_28519;\n        if (slt32(local_tid_28517 + offset_28531,\n                  sext_i64_i32(segred_group_sizze_26990)) && ((local_tid_28517 -\n                                                               squot32(local_tid_28517,\n                                                                       wave_sizze_28519) *\n                                                               wave_sizze_28519) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28517,\n                                                                       wave_sizze_28519) &\n                                                               (2 *\n                                                                skip_waves_28532 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28528 = ((__local\n                            float *) red_arr_mem_28523)[sext_i32_i64(local_tid_28517 +\n                                                        offset_28531)];\n            }\n            // apply reduction operation\n            {\n                float res_28529 = fmax32(x_28527, x_28528);\n                \n                x_28527 = res_28529;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_28523)[sext_i32_i64(local_tid_28517)] =\n              ",
                   "      x_28527;\n            }\n        }\n        skip_waves_28532 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28517) == 0) {\n            x_acc_28525 = x_28527;\n        }\n    }\n    \n    int32_t old_counter_28533;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28517 == 0) {\n            ((__global\n              float *) group_res_arr_mem_28513)[sext_i32_i64(group_tid_28518) *\n                                                segred_group_sizze_26990] =\n                x_acc_28525;\n            mem_fence_global();\n            old_counter_28533 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28511)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28521)[0] = old_counter_28533 ==\n                num_groups_26992 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28534;\n    \n    is_last_group_28534 = ((__local bool *) sync_arr_mem_28521)[0];\n    if (is_last_group_28534) {\n        if (local_tid_28517 == 0) {\n            old_counter_28533 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28511)[0],\n                                                      (int) (0 -\n                                                             num_groups_26992));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28535 = sdiv_up64(num_groups_26992,\n                                                      segred_group_sizze_26990);\n            \n            x_25444 = -INFINITY;\n            for (int64_t i_28536 = 0; i_28536 < read_per_thread_28535;\n                 i_28536++) {\n                int64_t group_res_id_28537 = sext_i32_i64(local_tid_28517)",
                   " *\n                        read_per_thread_28535 + i_28536;\n                int64_t index_of_group_res_28538 = group_res_id_28537;\n                \n                if (slt64(group_res_id_28537, num_groups_26992)) {\n                    x_25445 = ((__global\n                                float *) group_res_arr_mem_28513)[index_of_group_res_28538 *\n                                                                  segred_group_sizze_26990];\n                    \n                    float res_25446;\n                    \n                    res_25446 = fmax32(x_25444, x_25445);\n                    x_25444 = res_25446;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_28523)[sext_i32_i64(local_tid_28517)] =\n            x_25444;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28539;\n            int32_t skip_waves_28540;\n            \n            skip_waves_28540 = 1;\n            \n            float x_28527;\n            float x_28528;\n            \n            offset_28539 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28517,\n                          sext_i64_i32(segred_group_sizze_26990))) {\n                    x_28527 = ((__local\n                                float *) red_arr_mem_28523)[sext_i32_i64(local_tid_28517 +\n                                                            offset_28539)];\n                }\n            }\n            offset_28539 = 1;\n            while (slt32(offset_28539, wave_sizze_28519)) {\n                if (slt32(local_tid_28517 + offset_28539,\n                          sext_i64_i32(segred_group_sizze_26990)) &&\n                    ((local_tid_28517 - squot32(local_tid_28517,\n                                                wave_sizze_28519) *\n                      wave_sizze_28519) & (2 * offset_28539 - 1)) == 0) {\n                    // read array element\n                    {\n      ",
                   "                  x_28528 = ((volatile __local\n                                    float *) red_arr_mem_28523)[sext_i32_i64(local_tid_28517 +\n                                                                offset_28539)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28529 = fmax32(x_28527, x_28528);\n                        \n                        x_28527 = res_28529;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_28523)[sext_i32_i64(local_tid_28517)] =\n                            x_28527;\n                    }\n                }\n                offset_28539 *= 2;\n            }\n            while (slt32(skip_waves_28540,\n                         squot32(sext_i64_i32(segred_group_sizze_26990) +\n                                 wave_sizze_28519 - 1, wave_sizze_28519))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28539 = skip_waves_28540 * wave_sizze_28519;\n                if (slt32(local_tid_28517 + offset_28539,\n                          sext_i64_i32(segred_group_sizze_26990)) &&\n                    ((local_tid_28517 - squot32(local_tid_28517,\n                                                wave_sizze_28519) *\n                      wave_sizze_28519) == 0 && (squot32(local_tid_28517,\n                                                         wave_sizze_28519) &\n                                                 (2 * skip_waves_28540 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28528 = ((__local\n                                    float *) red_arr_mem_28523)[sext_i32_i64(local_tid_28517 +\n                                                                offset_28539)];\n                    }\n                    // apply reduction operation\n                  ",
                   "  {\n                        float res_28529 = fmax32(x_28527, x_28528);\n                        \n                        x_28527 = res_28529;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_28523)[sext_i32_i64(local_tid_28517)] =\n                            x_28527;\n                    }\n                }\n                skip_waves_28540 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28517 == 0) {\n                    ((__global float *) mem_28189)[0] = x_28527;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_26990\n}\n__kernel void testzisegred_nonseg_27848(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28707_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28705_backing_aligned_1,\n                                        int64_t flat_dim_25605,\n                                        int64_t num_groups_27843, __global\n                                        unsigned char *mem_28272, __global\n                                        unsigned char *mem_28275, __global\n                                        unsigned char *testzicounter_mem_28695,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28697,\n                                        int64_t num_threads_28699)\n{\n    #define segred_group_sizze_27841 (testzisegred_group_sizze_27840)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28707_backing_1 =\n                          (__local volatile\n                      ",
                   "     char *) red_arr_mem_28707_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28705_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28705_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28700;\n    int32_t local_tid_28701;\n    int64_t group_sizze_28704;\n    int32_t wave_sizze_28703;\n    int32_t group_tid_28702;\n    \n    global_tid_28700 = get_global_id(0);\n    local_tid_28701 = get_local_id(0);\n    group_sizze_28704 = get_local_size(0);\n    wave_sizze_28703 = LOCKSTEP_WIDTH;\n    group_tid_28702 = get_group_id(0);\n    \n    int32_t phys_tid_27848;\n    \n    phys_tid_27848 = global_tid_28700;\n    \n    __local char *sync_arr_mem_28705;\n    \n    sync_arr_mem_28705 = (__local char *) sync_arr_mem_28705_backing_0;\n    \n    __local char *red_arr_mem_28707;\n    \n    red_arr_mem_28707 = (__local char *) red_arr_mem_28707_backing_1;\n    \n    int64_t dummy_27846;\n    \n    dummy_27846 = 0;\n    \n    int64_t gtid_27847;\n    \n    gtid_27847 = 0;\n    \n    int64_t x_acc_28709;\n    int64_t chunk_sizze_28710;\n    \n    chunk_sizze_28710 = smin64(sdiv_up64(flat_dim_25605,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_27841 *\n                                         num_groups_27843))),\n                               sdiv_up64(flat_dim_25605 -\n                                         sext_i32_i64(phys_tid_27848),\n                                         num_threads_28699));\n    \n    int64_t x_25639;\n    int64_t x_25640;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28709 = 0;\n    }\n    for (int64_t i_28714 = 0; i_28714 < chunk_sizze_28710; i_28714++) {\n        gtid_27847 = sext_i32_i64(phys_tid_27848) + num_threads_28699 * i_28714;\n        // apply map function\n        {\n            int64_t x_25642 = ((__global int64_t *) mem_28272)[gtid_27847];\n            \n            // save map-out results\n           ",
                   " { }\n            // load accumulator\n            {\n                x_25639 = x_acc_28709;\n            }\n            // load new values\n            {\n                x_25640 = x_25642;\n            }\n            // apply reduction operator\n            {\n                int64_t res_25641 = add64(x_25639, x_25640);\n                \n                // store in accumulator\n                {\n                    x_acc_28709 = res_25641;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_25639 = x_acc_28709;\n        ((__local int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701)] =\n            x_25639;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28715;\n    int32_t skip_waves_28716;\n    \n    skip_waves_28716 = 1;\n    \n    int64_t x_28711;\n    int64_t x_28712;\n    \n    offset_28715 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28701, sext_i64_i32(segred_group_sizze_27841))) {\n            x_28711 = ((__local\n                        int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701 +\n                                                      offset_28715)];\n        }\n    }\n    offset_28715 = 1;\n    while (slt32(offset_28715, wave_sizze_28703)) {\n        if (slt32(local_tid_28701 + offset_28715,\n                  sext_i64_i32(segred_group_sizze_27841)) && ((local_tid_28701 -\n                                                               squot32(local_tid_28701,\n                                                                       wave_sizze_28703) *\n                                                               wave_sizze_28703) &\n                                                              (2 *\n                                                               offset_28715 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28712 = ((volat",
                   "ile __local\n                            int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701 +\n                                                          offset_28715)];\n            }\n            // apply reduction operation\n            {\n                int64_t res_28713 = add64(x_28711, x_28712);\n                \n                x_28711 = res_28713;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701)] =\n                    x_28711;\n            }\n        }\n        offset_28715 *= 2;\n    }\n    while (slt32(skip_waves_28716,\n                 squot32(sext_i64_i32(segred_group_sizze_27841) +\n                         wave_sizze_28703 - 1, wave_sizze_28703))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28715 = skip_waves_28716 * wave_sizze_28703;\n        if (slt32(local_tid_28701 + offset_28715,\n                  sext_i64_i32(segred_group_sizze_27841)) && ((local_tid_28701 -\n                                                               squot32(local_tid_28701,\n                                                                       wave_sizze_28703) *\n                                                               wave_sizze_28703) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28701,\n                                                                       wave_sizze_28703) &\n                                                               (2 *\n                                                                skip_waves_28716 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28712 = ((__local\n                            int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701 +\n                                                          off",
                   "set_28715)];\n            }\n            // apply reduction operation\n            {\n                int64_t res_28713 = add64(x_28711, x_28712);\n                \n                x_28711 = res_28713;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701)] =\n                    x_28711;\n            }\n        }\n        skip_waves_28716 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28701) == 0) {\n            x_acc_28709 = x_28711;\n        }\n    }\n    \n    int32_t old_counter_28717;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28701 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_28697)[sext_i32_i64(group_tid_28702) *\n                                                  segred_group_sizze_27841] =\n                x_acc_28709;\n            mem_fence_global();\n            old_counter_28717 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28695)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28705)[0] = old_counter_28717 ==\n                num_groups_27843 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28718;\n    \n    is_last_group_28718 = ((__local bool *) sync_arr_mem_28705)[0];\n    if (is_last_group_28718) {\n        if (local_tid_28701 == 0) {\n            old_counter_28717 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28695)[0],\n                                                      (int) (0 -\n                                                             num_groups_27843));\n        }\n        // read in the per-group-r",
                   "esults\n        {\n            int64_t read_per_thread_28719 = sdiv_up64(num_groups_27843,\n                                                      segred_group_sizze_27841);\n            \n            x_25639 = 0;\n            for (int64_t i_28720 = 0; i_28720 < read_per_thread_28719;\n                 i_28720++) {\n                int64_t group_res_id_28721 = sext_i32_i64(local_tid_28701) *\n                        read_per_thread_28719 + i_28720;\n                int64_t index_of_group_res_28722 = group_res_id_28721;\n                \n                if (slt64(group_res_id_28721, num_groups_27843)) {\n                    x_25640 = ((__global\n                                int64_t *) group_res_arr_mem_28697)[index_of_group_res_28722 *\n                                                                    segred_group_sizze_27841];\n                    \n                    int64_t res_25641;\n                    \n                    res_25641 = add64(x_25639, x_25640);\n                    x_25639 = res_25641;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701)] =\n            x_25639;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28723;\n            int32_t skip_waves_28724;\n            \n            skip_waves_28724 = 1;\n            \n            int64_t x_28711;\n            int64_t x_28712;\n            \n            offset_28723 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28701,\n                          sext_i64_i32(segred_group_sizze_27841))) {\n                    x_28711 = ((__local\n                                int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701 +\n                                                              offset_28723)];\n                }\n            }\n            offset_28723 = 1;\n            while (slt32(offset_28723, wave_sizze_28703)) {\n      ",
                   "          if (slt32(local_tid_28701 + offset_28723,\n                          sext_i64_i32(segred_group_sizze_27841)) &&\n                    ((local_tid_28701 - squot32(local_tid_28701,\n                                                wave_sizze_28703) *\n                      wave_sizze_28703) & (2 * offset_28723 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28712 = ((volatile __local\n                                    int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701 +\n                                                                  offset_28723)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_28713 = add64(x_28711, x_28712);\n                        \n                        x_28711 = res_28713;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701)] =\n                            x_28711;\n                    }\n                }\n                offset_28723 *= 2;\n            }\n            while (slt32(skip_waves_28724,\n                         squot32(sext_i64_i32(segred_group_sizze_27841) +\n                                 wave_sizze_28703 - 1, wave_sizze_28703))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28723 = skip_waves_28724 * wave_sizze_28703;\n                if (slt32(local_tid_28701 + offset_28723,\n                          sext_i64_i32(segred_group_sizze_27841)) &&\n                    ((local_tid_28701 - squot32(local_tid_28701,\n                                                wave_sizze_28703) *\n                      wave_sizze_28703) == 0 && (squot32(local_tid_28701,\n                                                         wave_sizze_28703) &\n                                                 (2 * skip_waves_28724 - 1",
                   ")) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28712 = ((__local\n                                    int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701 +\n                                                                  offset_28723)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_28713 = add64(x_28711, x_28712);\n                        \n                        x_28711 = res_28713;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_28707)[sext_i32_i64(local_tid_28701)] =\n                            x_28711;\n                    }\n                }\n                skip_waves_28724 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28701 == 0) {\n                    ((__global int64_t *) mem_28275)[0] = x_28711;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27841\n}\n__kernel void testzisegred_nonseg_27957(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29159_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29157_backing_aligned_1,\n                                        int64_t paths_25438,\n                                        int64_t num_groups_27960, __global\n                                        unsigned char *mem_28304, __global\n                                        unsigned char *mem_28307, __global\n                                        unsigned char *testzicounter_mem_29147,\n                                        __global\n                                   ",
                   "     unsigned char *group_res_arr_mem_29149,\n                                        int64_t num_threads_29151)\n{\n    #define segred_group_sizze_27959 (testzisegred_group_sizze_27949)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29159_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_29159_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_29157_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29157_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29152;\n    int32_t local_tid_29153;\n    int64_t group_sizze_29156;\n    int32_t wave_sizze_29155;\n    int32_t group_tid_29154;\n    \n    global_tid_29152 = get_global_id(0);\n    local_tid_29153 = get_local_id(0);\n    group_sizze_29156 = get_local_size(0);\n    wave_sizze_29155 = LOCKSTEP_WIDTH;\n    group_tid_29154 = get_group_id(0);\n    \n    int32_t phys_tid_27957;\n    \n    phys_tid_27957 = global_tid_29152;\n    \n    __local char *sync_arr_mem_29157;\n    \n    sync_arr_mem_29157 = (__local char *) sync_arr_mem_29157_backing_0;\n    \n    __local char *red_arr_mem_29159;\n    \n    red_arr_mem_29159 = (__local char *) red_arr_mem_29159_backing_1;\n    \n    int64_t dummy_27955;\n    \n    dummy_27955 = 0;\n    \n    int64_t gtid_27956;\n    \n    gtid_27956 = 0;\n    \n    float x_acc_29161;\n    int64_t chunk_sizze_29162;\n    \n    chunk_sizze_29162 = smin64(sdiv_up64(paths_25438,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_27959 *\n                                         num_groups_27960))),\n                               sdiv_up64(paths_25438 -\n                                         sext_i32_i64(phys_tid_27957),\n                                         num_threads_29151));\n    \n    float x_27963;\n    float x_27964;\n    \n    // neu",
                   "tral-initialise the accumulators\n    {\n        x_acc_29161 = 0.0F;\n    }\n    for (int64_t i_29166 = 0; i_29166 < chunk_sizze_29162; i_29166++) {\n        gtid_27956 = sext_i32_i64(phys_tid_27957) + num_threads_29151 * i_29166;\n        // apply map function\n        {\n            float res_27967;\n            float redout_28169 = 0.0F;\n            \n            for (int32_t i_28179 = 0; i_28179 < 9; i_28179++) {\n                int64_t i_28170 = sext_i32_i64(i_28179);\n                float x_27971 = ((__global float *) mem_28304)[i_28170 *\n                                                               paths_25438 +\n                                                               gtid_27956];\n                float res_27970 = x_27971 + redout_28169;\n                float redout_tmp_29167 = res_27970;\n                \n                redout_28169 = redout_tmp_29167;\n            }\n            res_27967 = redout_28169;\n            \n            float res_27972 = fmax32(0.0F, res_27967);\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_27963 = x_acc_29161;\n            }\n            // load new values\n            {\n                x_27964 = res_27972;\n            }\n            // apply reduction operator\n            {\n                float res_27965 = x_27963 + x_27964;\n                \n                // store in accumulator\n                {\n                    x_acc_29161 = res_27965;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_27963 = x_acc_29161;\n        ((__local float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153)] =\n            x_27963;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29168;\n    int32_t skip_waves_29169;\n    \n    skip_waves_29169 = 1;\n    \n    float x_29163;\n    float x_29164;\n    \n    offset_29168 = 0;\n    // participating threads read initial accumulator\n    {\n        if ",
                   "(slt32(local_tid_29153, sext_i64_i32(segred_group_sizze_27959))) {\n            x_29163 = ((__local\n                        float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153 +\n                                                    offset_29168)];\n        }\n    }\n    offset_29168 = 1;\n    while (slt32(offset_29168, wave_sizze_29155)) {\n        if (slt32(local_tid_29153 + offset_29168,\n                  sext_i64_i32(segred_group_sizze_27959)) && ((local_tid_29153 -\n                                                               squot32(local_tid_29153,\n                                                                       wave_sizze_29155) *\n                                                               wave_sizze_29155) &\n                                                              (2 *\n                                                               offset_29168 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_29164 = ((volatile __local\n                            float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153 +\n                                                        offset_29168)];\n            }\n            // apply reduction operation\n            {\n                float res_29165 = x_29163 + x_29164;\n                \n                x_29163 = res_29165;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153)] =\n                    x_29163;\n            }\n        }\n        offset_29168 *= 2;\n    }\n    while (slt32(skip_waves_29169,\n                 squot32(sext_i64_i32(segred_group_sizze_27959) +\n                         wave_sizze_29155 - 1, wave_sizze_29155))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29168 = skip_waves_29169 * wave_sizze_29155;\n        if (slt32(local_tid_29153 + offset_29168,\n                  sext_i64_i32(s",
                   "egred_group_sizze_27959)) && ((local_tid_29153 -\n                                                               squot32(local_tid_29153,\n                                                                       wave_sizze_29155) *\n                                                               wave_sizze_29155) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29153,\n                                                                       wave_sizze_29155) &\n                                                               (2 *\n                                                                skip_waves_29169 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_29164 = ((__local\n                            float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153 +\n                                                        offset_29168)];\n            }\n            // apply reduction operation\n            {\n                float res_29165 = x_29163 + x_29164;\n                \n                x_29163 = res_29165;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153)] =\n                    x_29163;\n            }\n        }\n        skip_waves_29169 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29153) == 0) {\n            x_acc_29161 = x_29163;\n        }\n    }\n    \n    int32_t old_counter_29170;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29153 == 0) {\n            ((__global\n              float *) group_res_arr_mem_29149)[sext_i32_i64(group_tid_29154) *\n                                                segred_group_sizze_27959] =\n           ",
                   "     x_acc_29161;\n            mem_fence_global();\n            old_counter_29170 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29147)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29157)[0] = old_counter_29170 ==\n                num_groups_27960 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29171;\n    \n    is_last_group_29171 = ((__local bool *) sync_arr_mem_29157)[0];\n    if (is_last_group_29171) {\n        if (local_tid_29153 == 0) {\n            old_counter_29170 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29147)[0],\n                                                      (int) (0 -\n                                                             num_groups_27960));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29172 = sdiv_up64(num_groups_27960,\n                                                      segred_group_sizze_27959);\n            \n            x_27963 = 0.0F;\n            for (int64_t i_29173 = 0; i_29173 < read_per_thread_29172;\n                 i_29173++) {\n                int64_t group_res_id_29174 = sext_i32_i64(local_tid_29153) *\n                        read_per_thread_29172 + i_29173;\n                int64_t index_of_group_res_29175 = group_res_id_29174;\n                \n                if (slt64(group_res_id_29174, num_groups_27960)) {\n                    x_27964 = ((__global\n                                float *) group_res_arr_mem_29149)[index_of_group_res_29175 *\n                                                                  segred_group_sizze_27959];\n                    \n                    float res_27965;\n                    \n                    res_27965 = x_27963 + x_27964;\n                    x_27963 = res_27965;",
                   "\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153)] =\n            x_27963;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29176;\n            int32_t skip_waves_29177;\n            \n            skip_waves_29177 = 1;\n            \n            float x_29163;\n            float x_29164;\n            \n            offset_29176 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29153,\n                          sext_i64_i32(segred_group_sizze_27959))) {\n                    x_29163 = ((__local\n                                float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153 +\n                                                            offset_29176)];\n                }\n            }\n            offset_29176 = 1;\n            while (slt32(offset_29176, wave_sizze_29155)) {\n                if (slt32(local_tid_29153 + offset_29176,\n                          sext_i64_i32(segred_group_sizze_27959)) &&\n                    ((local_tid_29153 - squot32(local_tid_29153,\n                                                wave_sizze_29155) *\n                      wave_sizze_29155) & (2 * offset_29176 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_29164 = ((volatile __local\n                                    float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153 +\n                                                                offset_29176)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29165 = x_29163 + x_29164;\n                        \n                        x_29163 = res_29165;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) re",
                   "d_arr_mem_29159)[sext_i32_i64(local_tid_29153)] =\n                            x_29163;\n                    }\n                }\n                offset_29176 *= 2;\n            }\n            while (slt32(skip_waves_29177,\n                         squot32(sext_i64_i32(segred_group_sizze_27959) +\n                                 wave_sizze_29155 - 1, wave_sizze_29155))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29176 = skip_waves_29177 * wave_sizze_29155;\n                if (slt32(local_tid_29153 + offset_29176,\n                          sext_i64_i32(segred_group_sizze_27959)) &&\n                    ((local_tid_29153 - squot32(local_tid_29153,\n                                                wave_sizze_29155) *\n                      wave_sizze_29155) == 0 && (squot32(local_tid_29153,\n                                                         wave_sizze_29155) &\n                                                 (2 * skip_waves_29177 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_29164 = ((__local\n                                    float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153 +\n                                                                offset_29176)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29165 = x_29163 + x_29164;\n                        \n                        x_29163 = res_29165;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_29159)[sext_i32_i64(local_tid_29153)] =\n                            x_29163;\n                    }\n                }\n                skip_waves_29177 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29153 == 0) {\n                    ((__global fl",
                   "oat *) mem_28307)[0] = x_29163;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27959\n}\n__kernel void testzisegred_nonseg_28053(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29262_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29260_backing_aligned_1,\n                                        int64_t paths_25438,\n                                        int64_t num_groups_28088, __global\n                                        unsigned char *res_map_acc_mem_28320,\n                                        __global unsigned char *mem_28323,\n                                        __global\n                                        unsigned char *testzicounter_mem_29250,\n                                        __global\n                                        unsigned char *group_res_arr_mem_29252,\n                                        int64_t num_threads_29254)\n{\n    #define segred_group_sizze_28087 (testzisegred_group_sizze_28045)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29262_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_29262_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_29260_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29260_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29255;\n    int32_t local_tid_29256;\n    int64_t group_sizze_29259;\n    int32_t wave_sizze_29258;\n    int32_t group_tid_29257;\n    \n    global_tid_29255 = get_global_id(0);\n    local_tid_29256 = get_local_id(0);\n    group_sizze_29259 = get_local_size(0);\n    wave_sizze_29",
                   "258 = LOCKSTEP_WIDTH;\n    group_tid_29257 = get_group_id(0);\n    \n    int32_t phys_tid_28053;\n    \n    phys_tid_28053 = global_tid_29255;\n    \n    __local char *sync_arr_mem_29260;\n    \n    sync_arr_mem_29260 = (__local char *) sync_arr_mem_29260_backing_0;\n    \n    __local char *red_arr_mem_29262;\n    \n    red_arr_mem_29262 = (__local char *) red_arr_mem_29262_backing_1;\n    \n    int64_t dummy_28051;\n    \n    dummy_28051 = 0;\n    \n    int64_t gtid_28052;\n    \n    gtid_28052 = 0;\n    \n    float x_acc_29264;\n    int64_t chunk_sizze_29265;\n    \n    chunk_sizze_29265 = smin64(sdiv_up64(paths_25438,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_28087 *\n                                         num_groups_28088))),\n                               sdiv_up64(paths_25438 -\n                                         sext_i32_i64(phys_tid_28053),\n                                         num_threads_29254));\n    \n    float x_28091;\n    float x_28092;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29264 = 0.0F;\n    }\n    for (int64_t i_29269 = 0; i_29269 < chunk_sizze_29265; i_29269++) {\n        gtid_28052 = sext_i32_i64(phys_tid_28053) + num_threads_29254 * i_29269;\n        // apply map function\n        {\n            float x_28094 = ((__global\n                              float *) res_map_acc_mem_28320)[gtid_28052];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_28091 = x_acc_29264;\n            }\n            // load new values\n            {\n                x_28092 = x_28094;\n            }\n            // apply reduction operator\n            {\n                float res_28093 = x_28091 + x_28092;\n                \n                // store in accumulator\n                {\n                    x_acc_29264 = res_28093;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_2",
                   "8091 = x_acc_29264;\n        ((__local float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256)] =\n            x_28091;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29270;\n    int32_t skip_waves_29271;\n    \n    skip_waves_29271 = 1;\n    \n    float x_29266;\n    float x_29267;\n    \n    offset_29270 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29256, sext_i64_i32(segred_group_sizze_28087))) {\n            x_29266 = ((__local\n                        float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256 +\n                                                    offset_29270)];\n        }\n    }\n    offset_29270 = 1;\n    while (slt32(offset_29270, wave_sizze_29258)) {\n        if (slt32(local_tid_29256 + offset_29270,\n                  sext_i64_i32(segred_group_sizze_28087)) && ((local_tid_29256 -\n                                                               squot32(local_tid_29256,\n                                                                       wave_sizze_29258) *\n                                                               wave_sizze_29258) &\n                                                              (2 *\n                                                               offset_29270 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_29267 = ((volatile __local\n                            float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256 +\n                                                        offset_29270)];\n            }\n            // apply reduction operation\n            {\n                float res_29268 = x_29266 + x_29267;\n                \n                x_29266 = res_29268;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256)] =\n                    x_29266;\n            }\n",
                   "        }\n        offset_29270 *= 2;\n    }\n    while (slt32(skip_waves_29271,\n                 squot32(sext_i64_i32(segred_group_sizze_28087) +\n                         wave_sizze_29258 - 1, wave_sizze_29258))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29270 = skip_waves_29271 * wave_sizze_29258;\n        if (slt32(local_tid_29256 + offset_29270,\n                  sext_i64_i32(segred_group_sizze_28087)) && ((local_tid_29256 -\n                                                               squot32(local_tid_29256,\n                                                                       wave_sizze_29258) *\n                                                               wave_sizze_29258) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29256,\n                                                                       wave_sizze_29258) &\n                                                               (2 *\n                                                                skip_waves_29271 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_29267 = ((__local\n                            float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256 +\n                                                        offset_29270)];\n            }\n            // apply reduction operation\n            {\n                float res_29268 = x_29266 + x_29267;\n                \n                x_29266 = res_29268;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256)] =\n                    x_29266;\n            }\n        }\n        skip_waves_29271 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29256) == 0",
                   ") {\n            x_acc_29264 = x_29266;\n        }\n    }\n    \n    int32_t old_counter_29272;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29256 == 0) {\n            ((__global\n              float *) group_res_arr_mem_29252)[sext_i32_i64(group_tid_29257) *\n                                                segred_group_sizze_28087] =\n                x_acc_29264;\n            mem_fence_global();\n            old_counter_29272 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29250)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29260)[0] = old_counter_29272 ==\n                num_groups_28088 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29273;\n    \n    is_last_group_29273 = ((__local bool *) sync_arr_mem_29260)[0];\n    if (is_last_group_29273) {\n        if (local_tid_29256 == 0) {\n            old_counter_29272 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29250)[0],\n                                                      (int) (0 -\n                                                             num_groups_28088));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29274 = sdiv_up64(num_groups_28088,\n                                                      segred_group_sizze_28087);\n            \n            x_28091 = 0.0F;\n            for (int64_t i_29275 = 0; i_29275 < read_per_thread_29274;\n                 i_29275++) {\n                int64_t group_res_id_29276 = sext_i32_i64(local_tid_29256) *\n                        read_per_thread_29274 + i_29275;\n                int64_t index_of_group_res_29277 = group_res_id_29276;\n                \n                if (slt64(group_res_id_29276, num_groups_28088)) {\n    ",
                   "                x_28092 = ((__global\n                                float *) group_res_arr_mem_29252)[index_of_group_res_29277 *\n                                                                  segred_group_sizze_28087];\n                    \n                    float res_28093;\n                    \n                    res_28093 = x_28091 + x_28092;\n                    x_28091 = res_28093;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256)] =\n            x_28091;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29278;\n            int32_t skip_waves_29279;\n            \n            skip_waves_29279 = 1;\n            \n            float x_29266;\n            float x_29267;\n            \n            offset_29278 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29256,\n                          sext_i64_i32(segred_group_sizze_28087))) {\n                    x_29266 = ((__local\n                                float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256 +\n                                                            offset_29278)];\n                }\n            }\n            offset_29278 = 1;\n            while (slt32(offset_29278, wave_sizze_29258)) {\n                if (slt32(local_tid_29256 + offset_29278,\n                          sext_i64_i32(segred_group_sizze_28087)) &&\n                    ((local_tid_29256 - squot32(local_tid_29256,\n                                                wave_sizze_29258) *\n                      wave_sizze_29258) & (2 * offset_29278 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_29267 = ((volatile __local\n                                    float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256 +\n                                                                offset_29278)];\n    ",
                   "                }\n                    // apply reduction operation\n                    {\n                        float res_29268 = x_29266 + x_29267;\n                        \n                        x_29266 = res_29268;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256)] =\n                            x_29266;\n                    }\n                }\n                offset_29278 *= 2;\n            }\n            while (slt32(skip_waves_29279,\n                         squot32(sext_i64_i32(segred_group_sizze_28087) +\n                                 wave_sizze_29258 - 1, wave_sizze_29258))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29278 = skip_waves_29279 * wave_sizze_29258;\n                if (slt32(local_tid_29256 + offset_29278,\n                          sext_i64_i32(segred_group_sizze_28087)) &&\n                    ((local_tid_29256 - squot32(local_tid_29256,\n                                                wave_sizze_29258) *\n                      wave_sizze_29258) == 0 && (squot32(local_tid_29256,\n                                                         wave_sizze_29258) &\n                                                 (2 * skip_waves_29279 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_29267 = ((__local\n                                    float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256 +\n                                                                offset_29278)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29268 = x_29266 + x_29267;\n                        \n                        x_29266 = res_29268;\n                    }\n                    // write result of operation\n                    {\n     ",
                   "                   ((__local\n                          float *) red_arr_mem_29262)[sext_i32_i64(local_tid_29256)] =\n                            x_29266;\n                    }\n                }\n                skip_waves_29279 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29256 == 0) {\n                    ((__global float *) mem_28323)[0] = x_29266;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_28087\n}\n__kernel void testzisegred_nonseg_28441(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28553_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28551_backing_aligned_1,\n                                        __global unsigned char *mem_28184,\n                                        __global unsigned char *mem_28453,\n                                        __global\n                                        unsigned char *testzicounter_mem_28541,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28543,\n                                        int64_t num_threads_28545)\n{\n    #define segred_num_groups_28435 (testzisegred_num_groups_28434)\n    #define segred_group_sizze_28437 (testzisegred_group_sizze_28436)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28553_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28553_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28551_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28551_backing_aligned_1;\n    \n    if (*global_failure",
                   " >= 0)\n        return;\n    \n    int32_t global_tid_28546;\n    int32_t local_tid_28547;\n    int64_t group_sizze_28550;\n    int32_t wave_sizze_28549;\n    int32_t group_tid_28548;\n    \n    global_tid_28546 = get_global_id(0);\n    local_tid_28547 = get_local_id(0);\n    group_sizze_28550 = get_local_size(0);\n    wave_sizze_28549 = LOCKSTEP_WIDTH;\n    group_tid_28548 = get_group_id(0);\n    \n    int32_t phys_tid_28441;\n    \n    phys_tid_28441 = global_tid_28546;\n    \n    __local char *sync_arr_mem_28551;\n    \n    sync_arr_mem_28551 = (__local char *) sync_arr_mem_28551_backing_0;\n    \n    __local char *red_arr_mem_28553;\n    \n    red_arr_mem_28553 = (__local char *) red_arr_mem_28553_backing_1;\n    \n    int64_t dummy_28439;\n    \n    dummy_28439 = 0;\n    \n    int64_t gtid_28440;\n    \n    gtid_28440 = 0;\n    \n    int64_t x_acc_28555;\n    int64_t chunk_sizze_28556;\n    \n    chunk_sizze_28556 = smin64(sdiv_up64(9,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_28437 *\n                                         segred_num_groups_28435))),\n                               sdiv_up64(9 - sext_i32_i64(phys_tid_28441),\n                                         num_threads_28545));\n    \n    int64_t x_28442;\n    int64_t y_28443;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28555 = 0;\n    }\n    for (int64_t i_28560 = 0; i_28560 < chunk_sizze_28556; i_28560++) {\n        gtid_28440 = sext_i32_i64(phys_tid_28441) + num_threads_28545 * i_28560;\n        // apply map function\n        {\n            int64_t res_28446 = ((__global int64_t *) mem_28184)[gtid_28440];\n            int64_t bytes_28447 = 4 * res_28446;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_28442 = x_acc_28555;\n            }\n            // load new values\n            {\n                y_28443 = bytes_28447;\n            }\n            // apply reduction operator\n            {\n               ",
                   " int64_t zz_28444 = smax64(x_28442, y_28443);\n                \n                // store in accumulator\n                {\n                    x_acc_28555 = zz_28444;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_28442 = x_acc_28555;\n        ((__local int64_t *) red_arr_mem_28553)[sext_i32_i64(local_tid_28547)] =\n            x_28442;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28561;\n    int32_t skip_waves_28562;\n    \n    skip_waves_28562 = 1;\n    \n    int64_t x_28557;\n    int64_t y_28558;\n    \n    offset_28561 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28547, sext_i64_i32(segred_group_sizze_28437))) {\n            x_28557 = ((__local\n                        int64_t *) red_arr_mem_28553)[sext_i32_i64(local_tid_28547 +\n                                                      offset_28561)];\n        }\n    }\n    offset_28561 = 1;\n    while (slt32(offset_28561, wave_sizze_28549)) {\n        if (slt32(local_tid_28547 + offset_28561,\n                  sext_i64_i32(segred_group_sizze_28437)) && ((local_tid_28547 -\n                                                               squot32(local_tid_28547,\n                                                                       wave_sizze_28549) *\n                                                               wave_sizze_28549) &\n                                                              (2 *\n                                                               offset_28561 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_28558 = ((volatile __local\n                            int64_t *) red_arr_mem_28553)[sext_i32_i64(local_tid_28547 +\n                                                          offset_28561)];\n            }\n            // apply reduction operation\n            {\n                int64_t ",
                   "zz_28559 = smax64(x_28557, y_28558);\n                \n                x_28557 = zz_28559;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_28553)[sext_i32_i64(local_tid_28547)] =\n                    x_28557;\n            }\n        }\n        offset_28561 *= 2;\n    }\n    while (slt32(skip_waves_28562,\n                 squot32(sext_i64_i32(segred_group_sizze_28437) +\n                         wave_sizze_28549 - 1, wave_sizze_28549))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28561 = skip_waves_28562 * wave_sizze_28549;\n        if (slt32(local_tid_28547 + offset_28561,\n                  sext_i64_i32(segred_group_sizze_28437)) && ((local_tid_28547 -\n                                                               squot32(local_tid_28547,\n                                                                       wave_sizze_28549) *\n                                                               wave_sizze_28549) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28547,\n                                                                       wave_sizze_28549) &\n                                                               (2 *\n                                                                skip_waves_28562 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                y_28558 = ((__local\n                            int64_t *) red_arr_mem_28553)[sext_i32_i64(local_tid_28547 +\n                                                          offset_28561)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_28559 = smax64(x_28557, y_28558);\n                \n                x_28557 = zz_28559;\n            }\n            // write result of operation\n            {\n    ",
                   "            ((__local\n                  int64_t *) red_arr_mem_28553)[sext_i32_i64(local_tid_28547)] =\n                    x_28557;\n            }\n        }\n        skip_waves_28562 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28547) == 0) {\n            x_acc_28555 = x_28557;\n        }\n    }\n    \n    int32_t old_counter_28563;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28547 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_28543)[sext_i32_i64(group_tid_28548) *\n                                                  segred_group_sizze_28437] =\n                x_acc_28555;\n            mem_fence_global();\n            old_counter_28563 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28541)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28551)[0] = old_counter_28563 ==\n                segred_num_groups_28435 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28564;\n    \n    is_last_group_28564 = ((__local bool *) sync_arr_mem_28551)[0];\n    if (is_last_group_28564) {\n        if (local_tid_28547 == 0) {\n            old_counter_28563 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28541)[0],\n                                                      (int) (0 -\n                                                             segred_num_groups_28435));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28565 = sdiv_up64(segred_num_groups_28435,\n                                                      segred_group_sizze_28437);\n            \n            x_28442 = 0;\n            for (int64_t i_28566 = 0; i_2",
                   "8566 < read_per_thread_28565;\n                 i_28566++) {\n                int64_t group_res_id_28567 = sext_i32_i64(local_tid_28547) *\n                        read_per_thread_28565 + i_28566;\n                int64_t index_of_group_res_28568 = group_res_id_28567;\n                \n                if (slt64(group_res_id_28567, segred_num_groups_28435)) {\n                    y_28443 = ((__global\n                                int64_t *) group_res_arr_mem_28543)[index_of_group_res_28568 *\n                                                                    segred_group_sizze_28437];\n                    \n                    int64_t zz_28444;\n                    \n                    zz_28444 = smax64(x_28442, y_28443);\n                    x_28442 = zz_28444;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_28553)[sext_i32_i64(local_tid_28547)] =\n            x_28442;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28569;\n            int32_t skip_waves_28570;\n            \n            skip_waves_28570 = 1;\n            \n            int64_t x_28557;\n            int64_t y_28558;\n            \n            offset_28569 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28547,\n                          sext_i64_i32(segred_group_sizze_28437))) {\n                    x_28557 = ((__local\n                                int64_t *) red_arr_mem_28553)[sext_i32_i64(local_tid_28547 +\n                                                              offset_28569)];\n                }\n            }\n            offset_28569 = 1;\n            while (slt32(offset_28569, wave_sizze_28549)) {\n                if (slt32(local_tid_28547 + offset_28569,\n                          sext_i64_i32(segred_group_sizze_28437)) &&\n                    ((local_tid_28547 - squot32(local_tid_28547,\n                                                wave_sizze",
                   "_28549) *\n                      wave_sizze_28549) & (2 * offset_28569 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_28558 = ((volatile __local\n                                    int64_t *) red_arr_mem_28553)[sext_i32_i64(local_tid_28547 +\n                                                                  offset_28569)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_28559 = smax64(x_28557, y_28558);\n                        \n                        x_28557 = zz_28559;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28553)[sext_i32_i64(local_tid_28547)] =\n                            x_28557;\n                    }\n                }\n                offset_28569 *= 2;\n            }\n            while (slt32(skip_waves_28570,\n                         squot32(sext_i64_i32(segred_group_sizze_28437) +\n                                 wave_sizze_28549 - 1, wave_sizze_28549))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28569 = skip_waves_28570 * wave_sizze_28549;\n                if (slt32(local_tid_28547 + offset_28569,\n                          sext_i64_i32(segred_group_sizze_28437)) &&\n                    ((local_tid_28547 - squot32(local_tid_28547,\n                                                wave_sizze_28549) *\n                      wave_sizze_28549) == 0 && (squot32(local_tid_28547,\n                                                         wave_sizze_28549) &\n                                                 (2 * skip_waves_28570 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        y_28558 = ((__local\n                                    int64_t *) red_arr_mem_28553)[sext_i32_i64(local_tid_28547 +\n       ",
                   "                                                           offset_28569)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_28559 = smax64(x_28557, y_28558);\n                        \n                        x_28557 = zz_28559;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_28553)[sext_i32_i64(local_tid_28547)] =\n                            x_28557;\n                    }\n                }\n                skip_waves_28570 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28547 == 0) {\n                    ((__global int64_t *) mem_28453)[0] = x_28557;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_28435\n    #undef segred_group_sizze_28437\n}\n__kernel void testzisegred_nonseg_28473(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28590_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28588_backing_aligned_1,\n                                        __global unsigned char *mem_28184,\n                                        __global unsigned char *mem_28485,\n                                        __global\n                                        unsigned char *testzicounter_mem_28578,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28580,\n                                        int64_t num_threads_28582)\n{\n    #define segred_num_groups_28467 (testzisegred_num_groups_28466)\n    #define segred_group_sizze_28469 (testzisegred_group_sizze_28468)\n    \n    const int block_dim0 = 0;\n    const i",
                   "nt block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28590_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28590_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28588_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28588_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28583;\n    int32_t local_tid_28584;\n    int64_t group_sizze_28587;\n    int32_t wave_sizze_28586;\n    int32_t group_tid_28585;\n    \n    global_tid_28583 = get_global_id(0);\n    local_tid_28584 = get_local_id(0);\n    group_sizze_28587 = get_local_size(0);\n    wave_sizze_28586 = LOCKSTEP_WIDTH;\n    group_tid_28585 = get_group_id(0);\n    \n    int32_t phys_tid_28473;\n    \n    phys_tid_28473 = global_tid_28583;\n    \n    __local char *sync_arr_mem_28588;\n    \n    sync_arr_mem_28588 = (__local char *) sync_arr_mem_28588_backing_0;\n    \n    __local char *red_arr_mem_28590;\n    \n    red_arr_mem_28590 = (__local char *) red_arr_mem_28590_backing_1;\n    \n    int64_t dummy_28471;\n    \n    dummy_28471 = 0;\n    \n    int64_t gtid_28472;\n    \n    gtid_28472 = 0;\n    \n    int64_t x_acc_28592;\n    int64_t chunk_sizze_28593;\n    \n    chunk_sizze_28593 = smin64(sdiv_up64(9,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_28469 *\n                                         segred_num_groups_28467))),\n                               sdiv_up64(9 - sext_i32_i64(phys_tid_28473),\n                                         num_threads_28582));\n    \n    int64_t x_28474;\n    int64_t y_28475;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28592 = 0;\n    }\n    for (int64_t i_28597 = 0; i_28597 < chunk_sizze_28593; i_28597++) {\n        gtid_28472 = sext_i32_i64(phys_tid_28473) + num_threads_28582 * i_28597;\n        // apply map function\n        {\n            int",
                   "64_t res_28478 = ((__global int64_t *) mem_28184)[gtid_28472];\n            int64_t bytes_28479 = 4 * res_28478;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_28474 = x_acc_28592;\n            }\n            // load new values\n            {\n                y_28475 = bytes_28479;\n            }\n            // apply reduction operator\n            {\n                int64_t zz_28476 = smax64(x_28474, y_28475);\n                \n                // store in accumulator\n                {\n                    x_acc_28592 = zz_28476;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_28474 = x_acc_28592;\n        ((__local int64_t *) red_arr_mem_28590)[sext_i32_i64(local_tid_28584)] =\n            x_28474;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28598;\n    int32_t skip_waves_28599;\n    \n    skip_waves_28599 = 1;\n    \n    int64_t x_28594;\n    int64_t y_28595;\n    \n    offset_28598 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28584, sext_i64_i32(segred_group_sizze_28469))) {\n            x_28594 = ((__local\n                        int64_t *) red_arr_mem_28590)[sext_i32_i64(local_tid_28584 +\n                                                      offset_28598)];\n        }\n    }\n    offset_28598 = 1;\n    while (slt32(offset_28598, wave_sizze_28586)) {\n        if (slt32(local_tid_28584 + offset_28598,\n                  sext_i64_i32(segred_group_sizze_28469)) && ((local_tid_28584 -\n                                                               squot32(local_tid_28584,\n                                                                       wave_sizze_28586) *\n                                                               wave_sizze_28586) &\n                                                              (2 *\n                                                           ",
                   "    offset_28598 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_28595 = ((volatile __local\n                            int64_t *) red_arr_mem_28590)[sext_i32_i64(local_tid_28584 +\n                                                          offset_28598)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_28596 = smax64(x_28594, y_28595);\n                \n                x_28594 = zz_28596;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_28590)[sext_i32_i64(local_tid_28584)] =\n                    x_28594;\n            }\n        }\n        offset_28598 *= 2;\n    }\n    while (slt32(skip_waves_28599,\n                 squot32(sext_i64_i32(segred_group_sizze_28469) +\n                         wave_sizze_28586 - 1, wave_sizze_28586))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28598 = skip_waves_28599 * wave_sizze_28586;\n        if (slt32(local_tid_28584 + offset_28598,\n                  sext_i64_i32(segred_group_sizze_28469)) && ((local_tid_28584 -\n                                                               squot32(local_tid_28584,\n                                                                       wave_sizze_28586) *\n                                                               wave_sizze_28586) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28584,\n                                                                       wave_sizze_28586) &\n                                                               (2 *\n                                                                skip_waves_28599 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n            ",
                   "    y_28595 = ((__local\n                            int64_t *) red_arr_mem_28590)[sext_i32_i64(local_tid_28584 +\n                                                          offset_28598)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_28596 = smax64(x_28594, y_28595);\n                \n                x_28594 = zz_28596;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_28590)[sext_i32_i64(local_tid_28584)] =\n                    x_28594;\n            }\n        }\n        skip_waves_28599 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28584) == 0) {\n            x_acc_28592 = x_28594;\n        }\n    }\n    \n    int32_t old_counter_28600;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28584 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_28580)[sext_i32_i64(group_tid_28585) *\n                                                  segred_group_sizze_28469] =\n                x_acc_28592;\n            mem_fence_global();\n            old_counter_28600 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28578)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28588)[0] = old_counter_28600 ==\n                segred_num_groups_28467 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28601;\n    \n    is_last_group_28601 = ((__local bool *) sync_arr_mem_28588)[0];\n    if (is_last_group_28601) {\n        if (local_tid_28584 == 0) {\n            old_counter_28600 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28578)[0],\n          ",
                   "                                            (int) (0 -\n                                                             segred_num_groups_28467));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28602 = sdiv_up64(segred_num_groups_28467,\n                                                      segred_group_sizze_28469);\n            \n            x_28474 = 0;\n            for (int64_t i_28603 = 0; i_28603 < read_per_thread_28602;\n                 i_28603++) {\n                int64_t group_res_id_28604 = sext_i32_i64(local_tid_28584) *\n                        read_per_thread_28602 + i_28603;\n                int64_t index_of_group_res_28605 = group_res_id_28604;\n                \n                if (slt64(group_res_id_28604, segred_num_groups_28467)) {\n                    y_28475 = ((__global\n                                int64_t *) group_res_arr_mem_28580)[index_of_group_res_28605 *\n                                                                    segred_group_sizze_28469];\n                    \n                    int64_t zz_28476;\n                    \n                    zz_28476 = smax64(x_28474, y_28475);\n                    x_28474 = zz_28476;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_28590)[sext_i32_i64(local_tid_28584)] =\n            x_28474;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28606;\n            int32_t skip_waves_28607;\n            \n            skip_waves_28607 = 1;\n            \n            int64_t x_28594;\n            int64_t y_28595;\n            \n            offset_28606 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28584,\n                          sext_i64_i32(segred_group_sizze_28469))) {\n                    x_28594 = ((__local\n                                int64_t *) red_arr_mem_28590)[sext_i32_i64(local_tid_28584 +\n       ",
                   "                                                       offset_28606)];\n                }\n            }\n            offset_28606 = 1;\n            while (slt32(offset_28606, wave_sizze_28586)) {\n                if (slt32(local_tid_28584 + offset_28606,\n                          sext_i64_i32(segred_group_sizze_28469)) &&\n                    ((local_tid_28584 - squot32(local_tid_28584,\n                                                wave_sizze_28586) *\n                      wave_sizze_28586) & (2 * offset_28606 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_28595 = ((volatile __local\n                                    int64_t *) red_arr_mem_28590)[sext_i32_i64(local_tid_28584 +\n                                                                  offset_28606)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_28596 = smax64(x_28594, y_28595);\n                        \n                        x_28594 = zz_28596;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28590)[sext_i32_i64(local_tid_28584)] =\n                            x_28594;\n                    }\n                }\n                offset_28606 *= 2;\n            }\n            while (slt32(skip_waves_28607,\n                         squot32(sext_i64_i32(segred_group_sizze_28469) +\n                                 wave_sizze_28586 - 1, wave_sizze_28586))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28606 = skip_waves_28607 * wave_sizze_28586;\n                if (slt32(local_tid_28584 + offset_28606,\n                          sext_i64_i32(segred_group_sizze_28469)) &&\n                    ((local_tid_28584 - squot32(local_tid_28584,\n                                                wave_sizze_28586) *\n                      wave_",
                   "sizze_28586) == 0 && (squot32(local_tid_28584,\n                                                         wave_sizze_28586) &\n                                                 (2 * skip_waves_28607 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        y_28595 = ((__local\n                                    int64_t *) red_arr_mem_28590)[sext_i32_i64(local_tid_28584 +\n                                                                  offset_28606)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_28596 = smax64(x_28594, y_28595);\n                        \n                        x_28594 = zz_28596;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_28590)[sext_i32_i64(local_tid_28584)] =\n                            x_28594;\n                    }\n                }\n                skip_waves_28607 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28584 == 0) {\n                    ((__global int64_t *) mem_28485)[0] = x_28594;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_28467\n    #undef segred_group_sizze_28469\n}\n__kernel void testzisegred_small_28020(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *red_arr_mem_29191_backing_aligned_0,\n                                       int64_t paths_25438,\n                                       int64_t num_groups_28071, __global\n                                       unsigned char *mem_28300, __global\n                                       unsigned char *mem_28316,\n                                       int64_t segment_sizze_nonzzero_29184)\n{\n    #define s",
                   "egred_group_sizze_28070 (testzisegred_group_sizze_28014)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29191_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_29191_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29186;\n    int32_t local_tid_29187;\n    int64_t group_sizze_29190;\n    int32_t wave_sizze_29189;\n    int32_t group_tid_29188;\n    \n    global_tid_29186 = get_global_id(0);\n    local_tid_29187 = get_local_id(0);\n    group_sizze_29190 = get_local_size(0);\n    wave_sizze_29189 = LOCKSTEP_WIDTH;\n    group_tid_29188 = get_group_id(0);\n    \n    int32_t phys_tid_28020;\n    \n    phys_tid_28020 = global_tid_29186;\n    \n    __local char *red_arr_mem_29191;\n    \n    red_arr_mem_29191 = (__local char *) red_arr_mem_29191_backing_0;\n    \n    int32_t phys_group_id_29193;\n    \n    phys_group_id_29193 = get_group_id(0);\n    for (int32_t i_29194 = 0; i_29194 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(paths_25438,\n                                          squot64(segred_group_sizze_28070,\n                                                  segment_sizze_nonzzero_29184))) -\n                   phys_group_id_29193, sext_i64_i32(num_groups_28071));\n         i_29194++) {\n        int32_t virt_group_id_29195 = phys_group_id_29193 + i_29194 *\n                sext_i64_i32(num_groups_28071);\n        int64_t gtid_28011 = squot64(sext_i32_i64(local_tid_29187),\n                                     segment_sizze_nonzzero_29184) +\n                sext_i32_i64(virt_group_id_29195) *\n                squot64(segred_group_sizze_28070, segment_sizze_nonzzero_29184);\n        int64_t gtid_28019 = srem64(sext_i32_i64(local_tid_29187), 9);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, 9) && (slt64(gtid_28011, paths_25438) &&\n                                slt64(",
                   "sext_i32_i64(local_tid_29187), 9 *\n                                      squot64(segred_group_sizze_28070,\n                                              segment_sizze_nonzzero_29184)))) {\n                int64_t binop_x_28132 = 9 * gtid_28011;\n                int64_t new_index_28133 = gtid_28019 + binop_x_28132;\n                float x_28078 = ((__global float *) mem_28300)[new_index_28133];\n                \n                // save map-out results\n                { }\n                // save results to be reduced\n                {\n                    ((__local\n                      float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)] =\n                        x_28078;\n                }\n            } else {\n                ((__local\n                  float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)] =\n                    0.0F;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, 9)) {\n            // perform segmented scan to imitate reduction\n            {\n                float x_28074;\n                float x_28075;\n                float x_29196;\n                float x_29197;\n                bool ltid_in_bounds_29199;\n                \n                ltid_in_bounds_29199 = slt64(sext_i32_i64(local_tid_29187), 9 *\n                                             squot64(segred_group_sizze_28070,\n                                                     segment_sizze_nonzzero_29184));\n                \n                int32_t skip_threads_29200;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_29199) {\n                        x_28075 = ((volatile __local\n                                    float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)];\n                        if ((local_tid_29187 - squot32(local_tid_29187, 32) *\n                             32) == 0) {\n                            x_28074 = x_28075;\n                        }\n                    }\n   ",
                   "             }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29200 = 1;\n                    while (slt32(skip_threads_29200, 32)) {\n                        if (sle32(skip_threads_29200, local_tid_29187 -\n                                  squot32(local_tid_29187, 32) * 32) &&\n                            ltid_in_bounds_29199) {\n                            // read operands\n                            {\n                                x_28074 = ((volatile __local\n                                            float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187) -\n                                                                        sext_i32_i64(skip_threads_29200)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_29201 =\n                                     slt64(srem64(sext_i32_i64(local_tid_29187),\n                                                  9),\n                                           sext_i32_i64(local_tid_29187) -\n                                           sext_i32_i64(local_tid_29187 -\n                                           skip_threads_29200));\n                                \n                                if (inactive_29201) {\n                                    x_28074 = x_28075;\n                                }\n                                if (!inactive_29201) {\n                                    float res_28076 = x_28074 + x_28075;\n                                    \n                                    x_28074 = res_28076;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_29189, skip_threads_29200)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29200, local_tid_29187 -\n                         ",
                   "         squot32(local_tid_29187, 32) * 32) &&\n                            ltid_in_bounds_29199) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)] =\n                                    x_28074;\n                                x_28075 = x_28074;\n                            }\n                        }\n                        if (sle32(wave_sizze_29189, skip_threads_29200)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29200 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_29187 - squot32(local_tid_29187, 32) * 32) ==\n                        31 && ltid_in_bounds_29199) {\n                        ((volatile __local\n                          float *) red_arr_mem_29191)[sext_i32_i64(squot32(local_tid_29187,\n                                                                           32))] =\n                            x_28074;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_29202;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_29187, 32) == 0 &&\n                            ltid_in_bounds_29199) {\n                            x_29197 = ((volatile __local\n                                        float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)];\n                            if ((local_tid_29187 - squot32(local_tid_29187,\n                                                        ",
                   "   32) * 32) == 0) {\n                                x_29196 = x_29197;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_29202 = 1;\n                        while (slt32(skip_threads_29202, 32)) {\n                            if (sle32(skip_threads_29202, local_tid_29187 -\n                                      squot32(local_tid_29187, 32) * 32) &&\n                                (squot32(local_tid_29187, 32) == 0 &&\n                                 ltid_in_bounds_29199)) {\n                                // read operands\n                                {\n                                    x_29196 = ((volatile __local\n                                                float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187) -\n                                                                            sext_i32_i64(skip_threads_29202)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_29203 =\n                                         slt64(srem64(sext_i32_i64(local_tid_29187 *\n                                                      32 + 32 - 1), 9),\n                                               sext_i32_i64(local_tid_29187 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_29187 -\n                                                             skip_threads_29202) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_29203) {\n                                        x_29196 = x_29197;\n                                    }\n                                    if (!inactive_29203) {\n                                        float res_",
                   "29198 = x_29196 + x_29197;\n                                        \n                                        x_29196 = res_29198;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_29189, skip_threads_29202)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_29202, local_tid_29187 -\n                                      squot32(local_tid_29187, 32) * 32) &&\n                                (squot32(local_tid_29187, 32) == 0 &&\n                                 ltid_in_bounds_29199)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)] =\n                                        x_29196;\n                                    x_29197 = x_29196;\n                                }\n                            }\n                            if (sle32(wave_sizze_29189, skip_threads_29202)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_29202 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_29187, 32) == 0 ||\n                          !ltid_in_bounds_29199)) {\n                        // read operands\n                        {\n                            x_28075 = x_28074;\n                            x_28074 = ((__local\n                                        float *) red_arr_mem_29191)[sext_i32_i64(squot32(local_tid_29187,\n                                                                                         32)) -\n                    ",
                   "                                                1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_29204 =\n                                 slt64(srem64(sext_i32_i64(local_tid_29187), 9),\n                                       sext_i32_i64(local_tid_29187) -\n                                       sext_i32_i64(squot32(local_tid_29187,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_29204) {\n                                x_28074 = x_28075;\n                            }\n                            if (!inactive_29204) {\n                                float res_28076 = x_28074 + x_28075;\n                                \n                                x_28074 = res_28076;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)] =\n                                x_28074;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_29187, 32) == 0) {\n                        ((__local\n                          float *) red_arr_mem_29191)[sext_i32_i64(local_tid_29187)] =\n                            x_28075;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_29195) *\n                      squot64(segred_group_sizze_28070,\n                              segment_sizze_nonzzero_29184) +\n                      sext_i32_i64(local_tid_29187",
                   "), paths_25438) &&\n                slt64(sext_i32_i64(local_tid_29187),\n                      squot64(segred_group_sizze_28070,\n                              segment_sizze_nonzzero_29184))) {\n                ((__global\n                  float *) mem_28316)[sext_i32_i64(virt_group_id_29195) *\n                                      squot64(segred_group_sizze_28070,\n                                              segment_sizze_nonzzero_29184) +\n                                      sext_i32_i64(local_tid_29187)] = ((__local\n                                                                         float *) red_arr_mem_29191)[(sext_i32_i64(local_tid_29187) +\n                                                                                                      1) *\n                                                                                                     segment_sizze_nonzzero_29184 -\n                                                                                                     1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_28070\n}\n__kernel void testzisegred_small_28820(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *red_arr_mem_28828_backing_aligned_0,\n                                       int64_t res_25638,\n                                       int64_t num_groups_27853, __global\n                                       unsigned char *mem_28277,\n                                       int32_t num_subhistos_28734, __global\n                                       unsigned char *res_subhistos_mem_28735,\n                                       int64_t segment_sizze_nonzzero_28821)\n{\n    #define seghist_group_sizze_27851 (testziseghist_group_sizze_27850)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2",
                   " = 2;\n    __local volatile char *restrict red_arr_mem_28828_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28828_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28823;\n    int32_t local_tid_28824;\n    int64_t group_sizze_28827;\n    int32_t wave_sizze_28826;\n    int32_t group_tid_28825;\n    \n    global_tid_28823 = get_global_id(0);\n    local_tid_28824 = get_local_id(0);\n    group_sizze_28827 = get_local_size(0);\n    wave_sizze_28826 = LOCKSTEP_WIDTH;\n    group_tid_28825 = get_group_id(0);\n    \n    int32_t flat_gtid_28820;\n    \n    flat_gtid_28820 = global_tid_28823;\n    \n    __local char *red_arr_mem_28828;\n    \n    red_arr_mem_28828 = (__local char *) red_arr_mem_28828_backing_0;\n    \n    int32_t phys_group_id_28830;\n    \n    phys_group_id_28830 = get_group_id(0);\n    for (int32_t i_28831 = 0; i_28831 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(res_25638,\n                                          squot64(seghist_group_sizze_27851,\n                                                  segment_sizze_nonzzero_28821))) -\n                   phys_group_id_28830, sext_i64_i32(num_groups_27853));\n         i_28831++) {\n        int32_t virt_group_id_28832 = phys_group_id_28830 + i_28831 *\n                sext_i64_i32(num_groups_27853);\n        int64_t bucket_id_28818 = squot64(sext_i32_i64(local_tid_28824),\n                                          segment_sizze_nonzzero_28821) +\n                sext_i32_i64(virt_group_id_28832) *\n                squot64(seghist_group_sizze_27851,\n                        segment_sizze_nonzzero_28821);\n        int64_t subhistogram_id_28819 = srem64(sext_i32_i64(local_tid_28824),\n                                               num_subhistos_28734);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, num_subhistos_28734) && (slt64(bucket_id_28818,\n                                                        res_25638",
                   ") &&\n                                                  slt64(sext_i32_i64(local_tid_28824),\n                                                        num_subhistos_28734 *\n                                                        squot64(seghist_group_sizze_27851,\n                                                                segment_sizze_nonzzero_28821)))) {\n                // save results to be reduced\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824)] =\n                        ((__global\n                          int64_t *) res_subhistos_mem_28735)[subhistogram_id_28819 *\n                                                              res_25638 +\n                                                              bucket_id_28818];\n                }\n            } else {\n                ((__local\n                  int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824)] =\n                    0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, num_subhistos_28734)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t x_27857;\n                int64_t x_27858;\n                int64_t x_28833;\n                int64_t x_28834;\n                bool ltid_in_bounds_28836;\n                \n                ltid_in_bounds_28836 = slt64(sext_i32_i64(local_tid_28824),\n                                             num_subhistos_28734 *\n                                             squot64(seghist_group_sizze_27851,\n                                                     segment_sizze_nonzzero_28821));\n                \n                int32_t skip_threads_28837;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_28836) {\n                        x_27858 = ((volatile __local\n                                    int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_288",
                   "24)];\n                        if ((local_tid_28824 - squot32(local_tid_28824, 32) *\n                             32) == 0) {\n                            x_27857 = x_27858;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28837 = 1;\n                    while (slt32(skip_threads_28837, 32)) {\n                        if (sle32(skip_threads_28837, local_tid_28824 -\n                                  squot32(local_tid_28824, 32) * 32) &&\n                            ltid_in_bounds_28836) {\n                            // read operands\n                            {\n                                x_27857 = ((volatile __local\n                                            int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824) -\n                                                                          sext_i32_i64(skip_threads_28837)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_28838 =\n                                     slt64(srem64(sext_i32_i64(local_tid_28824),\n                                                  num_subhistos_28734),\n                                           sext_i32_i64(local_tid_28824) -\n                                           sext_i32_i64(local_tid_28824 -\n                                           skip_threads_28837));\n                                \n                                if (inactive_28838) {\n                                    x_27857 = x_27858;\n                                }\n                                if (!inactive_28838) {\n                                    int64_t res_27859 = smax64(x_27857,\n                                                               x_27858);\n                                    \n                                    x_27857 = res_27859;\n                             ",
                   "   }\n                            }\n                        }\n                        if (sle32(wave_sizze_28826, skip_threads_28837)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28837, local_tid_28824 -\n                                  squot32(local_tid_28824, 32) * 32) &&\n                            ltid_in_bounds_28836) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824)] =\n                                    x_27857;\n                                x_27858 = x_27857;\n                            }\n                        }\n                        if (sle32(wave_sizze_28826, skip_threads_28837)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28837 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_28824 - squot32(local_tid_28824, 32) * 32) ==\n                        31 && ltid_in_bounds_28836) {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28828)[sext_i32_i64(squot32(local_tid_28824,\n                                                                             32))] =\n                            x_27857;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_28839;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_28824, 32) == 0 &&\n                  ",
                   "          ltid_in_bounds_28836) {\n                            x_28834 = ((volatile __local\n                                        int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824)];\n                            if ((local_tid_28824 - squot32(local_tid_28824,\n                                                           32) * 32) == 0) {\n                                x_28833 = x_28834;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_28839 = 1;\n                        while (slt32(skip_threads_28839, 32)) {\n                            if (sle32(skip_threads_28839, local_tid_28824 -\n                                      squot32(local_tid_28824, 32) * 32) &&\n                                (squot32(local_tid_28824, 32) == 0 &&\n                                 ltid_in_bounds_28836)) {\n                                // read operands\n                                {\n                                    x_28833 = ((volatile __local\n                                                int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824) -\n                                                                              sext_i32_i64(skip_threads_28839)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_28840 =\n                                         slt64(srem64(sext_i32_i64(local_tid_28824 *\n                                                      32 + 32 - 1),\n                                                      num_subhistos_28734),\n                                               sext_i32_i64(local_tid_28824 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_28824 -\n                                             ",
                   "                skip_threads_28839) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_28840) {\n                                        x_28833 = x_28834;\n                                    }\n                                    if (!inactive_28840) {\n                                        int64_t res_28835 = smax64(x_28833,\n                                                                   x_28834);\n                                        \n                                        x_28833 = res_28835;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_28826, skip_threads_28839)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_28839, local_tid_28824 -\n                                      squot32(local_tid_28824, 32) * 32) &&\n                                (squot32(local_tid_28824, 32) == 0 &&\n                                 ltid_in_bounds_28836)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824)] =\n                                        x_28833;\n                                    x_28834 = x_28833;\n                                }\n                            }\n                            if (sle32(wave_sizze_28826, skip_threads_28839)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_28839 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    ",
                   "if (!(squot32(local_tid_28824, 32) == 0 ||\n                          !ltid_in_bounds_28836)) {\n                        // read operands\n                        {\n                            x_27858 = x_27857;\n                            x_27857 = ((__local\n                                        int64_t *) red_arr_mem_28828)[sext_i32_i64(squot32(local_tid_28824,\n                                                                                           32)) -\n                                                                      1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_28841 =\n                                 slt64(srem64(sext_i32_i64(local_tid_28824),\n                                              num_subhistos_28734),\n                                       sext_i32_i64(local_tid_28824) -\n                                       sext_i32_i64(squot32(local_tid_28824,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_28841) {\n                                x_27857 = x_27858;\n                            }\n                            if (!inactive_28841) {\n                                int64_t res_27859 = smax64(x_27857, x_27858);\n                                \n                                x_27857 = res_27859;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824)] =\n                                x_27857;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_28824, 32) == 0) {\n                       ",
                   " ((__local\n                          int64_t *) red_arr_mem_28828)[sext_i32_i64(local_tid_28824)] =\n                            x_27858;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_28832) *\n                      squot64(seghist_group_sizze_27851,\n                              segment_sizze_nonzzero_28821) +\n                      sext_i32_i64(local_tid_28824), res_25638) &&\n                slt64(sext_i32_i64(local_tid_28824),\n                      squot64(seghist_group_sizze_27851,\n                              segment_sizze_nonzzero_28821))) {\n                ((__global\n                  int64_t *) mem_28277)[sext_i32_i64(virt_group_id_28832) *\n                                        squot64(seghist_group_sizze_27851,\n                                                segment_sizze_nonzzero_28821) +\n                                        sext_i32_i64(local_tid_28824)] =\n                    ((__local\n                      int64_t *) red_arr_mem_28828)[(sext_i32_i64(local_tid_28824) +\n                                                     1) *\n                                                    segment_sizze_nonzzero_28821 -\n                                                    1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_27851\n}\n",
                   NULL};
static const char *size_names[] = {"builtin#replicate_f32.group_size_29140",
                                   "builtin#replicate_i64.group_size_28732",
                                   "main.L2_size_28797",
                                   "main.seghist_group_size_26741",
                                   "main.seghist_num_groups_26743",
                                   "main.segmap_group_size_25901",
                                   "main.segmap_group_size_26077",
                                   "main.segmap_group_size_26376",
                                   "main.segmap_group_size_26475",
                                   "main.segmap_group_size_26538",
                                   "main.segmap_group_size_26834",
                                   "main.segmap_group_size_26872",
                                   "main.segmap_group_size_26897",
                                   "main.segmap_num_groups_26378",
                                   "main.segred_group_size_25877",
                                   "main.segred_group_size_26731",
                                   "main.segred_group_size_26840",
                                   "main.segred_group_size_26905",
                                   "main.segred_group_size_26936",
                                   "main.segred_group_size_28354",
                                   "main.segred_group_size_28386",
                                   "main.segred_num_groups_25879",
                                   "main.segred_num_groups_26733",
                                   "main.segred_num_groups_26842",
                                   "main.segred_num_groups_26907",
                                   "main.segred_num_groups_26938",
                                   "main.segred_num_groups_28352",
                                   "main.segred_num_groups_28384",
                                   "main.segscan_group_size_26723",
                                   "main.segscan_group_size_26756",
                                   "main.segscan_group_size_26764",
                                   "main.segscan_group_size_26772",
                                   "main.segscan_group_size_26824",
                                   "main.segscan_num_groups_26725",
                                   "main.segscan_num_groups_26758",
                                   "main.segscan_num_groups_26766",
                                   "main.segscan_num_groups_26774",
                                   "main.segscan_num_groups_26826",
                                   "main.suff_outer_par_0",
                                   "main.suff_outer_par_8",
                                   "main.suff_outer_redomap_7",
                                   "test.L2_size_28797",
                                   "test.seghist_group_size_27850",
                                   "test.seghist_num_groups_27852",
                                   "test.segmap_group_size_27013",
                                   "test.segmap_group_size_27189",
                                   "test.segmap_group_size_27488",
                                   "test.segmap_group_size_27587",
                                   "test.segmap_group_size_27650",
                                   "test.segmap_group_size_27943",
                                   "test.segmap_group_size_27981",
                                   "test.segmap_group_size_28006",
                                   "test.segmap_num_groups_27490",
                                   "test.segred_group_size_26989",
                                   "test.segred_group_size_27840",
                                   "test.segred_group_size_27949",
                                   "test.segred_group_size_28014",
                                   "test.segred_group_size_28045",
                                   "test.segred_group_size_28436",
                                   "test.segred_group_size_28468",
                                   "test.segred_num_groups_26991",
                                   "test.segred_num_groups_27842",
                                   "test.segred_num_groups_27951",
                                   "test.segred_num_groups_28016",
                                   "test.segred_num_groups_28047",
                                   "test.segred_num_groups_28434",
                                   "test.segred_num_groups_28466",
                                   "test.segscan_group_size_27832",
                                   "test.segscan_group_size_27865",
                                   "test.segscan_group_size_27873",
                                   "test.segscan_group_size_27881",
                                   "test.segscan_group_size_27933",
                                   "test.segscan_num_groups_27834",
                                   "test.segscan_num_groups_27867",
                                   "test.segscan_num_groups_27875",
                                   "test.segscan_num_groups_27883",
                                   "test.segscan_num_groups_27935",
                                   "test.suff_outer_par_0",
                                   "test.suff_outer_par_8",
                                   "test.suff_outer_redomap_7"};
static const char *size_vars[] = {"builtinzhreplicate_f32zigroup_sizze_29140",
                                  "builtinzhreplicate_i64zigroup_sizze_28732",
                                  "mainziL2_sizze_28797",
                                  "mainziseghist_group_sizze_26741",
                                  "mainziseghist_num_groups_26743",
                                  "mainzisegmap_group_sizze_25901",
                                  "mainzisegmap_group_sizze_26077",
                                  "mainzisegmap_group_sizze_26376",
                                  "mainzisegmap_group_sizze_26475",
                                  "mainzisegmap_group_sizze_26538",
                                  "mainzisegmap_group_sizze_26834",
                                  "mainzisegmap_group_sizze_26872",
                                  "mainzisegmap_group_sizze_26897",
                                  "mainzisegmap_num_groups_26378",
                                  "mainzisegred_group_sizze_25877",
                                  "mainzisegred_group_sizze_26731",
                                  "mainzisegred_group_sizze_26840",
                                  "mainzisegred_group_sizze_26905",
                                  "mainzisegred_group_sizze_26936",
                                  "mainzisegred_group_sizze_28354",
                                  "mainzisegred_group_sizze_28386",
                                  "mainzisegred_num_groups_25879",
                                  "mainzisegred_num_groups_26733",
                                  "mainzisegred_num_groups_26842",
                                  "mainzisegred_num_groups_26907",
                                  "mainzisegred_num_groups_26938",
                                  "mainzisegred_num_groups_28352",
                                  "mainzisegred_num_groups_28384",
                                  "mainzisegscan_group_sizze_26723",
                                  "mainzisegscan_group_sizze_26756",
                                  "mainzisegscan_group_sizze_26764",
                                  "mainzisegscan_group_sizze_26772",
                                  "mainzisegscan_group_sizze_26824",
                                  "mainzisegscan_num_groups_26725",
                                  "mainzisegscan_num_groups_26758",
                                  "mainzisegscan_num_groups_26766",
                                  "mainzisegscan_num_groups_26774",
                                  "mainzisegscan_num_groups_26826",
                                  "mainzisuff_outer_par_0",
                                  "mainzisuff_outer_par_8",
                                  "mainzisuff_outer_redomap_7",
                                  "testziL2_sizze_28797",
                                  "testziseghist_group_sizze_27850",
                                  "testziseghist_num_groups_27852",
                                  "testzisegmap_group_sizze_27013",
                                  "testzisegmap_group_sizze_27189",
                                  "testzisegmap_group_sizze_27488",
                                  "testzisegmap_group_sizze_27587",
                                  "testzisegmap_group_sizze_27650",
                                  "testzisegmap_group_sizze_27943",
                                  "testzisegmap_group_sizze_27981",
                                  "testzisegmap_group_sizze_28006",
                                  "testzisegmap_num_groups_27490",
                                  "testzisegred_group_sizze_26989",
                                  "testzisegred_group_sizze_27840",
                                  "testzisegred_group_sizze_27949",
                                  "testzisegred_group_sizze_28014",
                                  "testzisegred_group_sizze_28045",
                                  "testzisegred_group_sizze_28436",
                                  "testzisegred_group_sizze_28468",
                                  "testzisegred_num_groups_26991",
                                  "testzisegred_num_groups_27842",
                                  "testzisegred_num_groups_27951",
                                  "testzisegred_num_groups_28016",
                                  "testzisegred_num_groups_28047",
                                  "testzisegred_num_groups_28434",
                                  "testzisegred_num_groups_28466",
                                  "testzisegscan_group_sizze_27832",
                                  "testzisegscan_group_sizze_27865",
                                  "testzisegscan_group_sizze_27873",
                                  "testzisegscan_group_sizze_27881",
                                  "testzisegscan_group_sizze_27933",
                                  "testzisegscan_num_groups_27834",
                                  "testzisegscan_num_groups_27867",
                                  "testzisegscan_num_groups_27875",
                                  "testzisegscan_num_groups_27883",
                                  "testzisegscan_num_groups_27935",
                                  "testzisuff_outer_par_0",
                                  "testzisuff_outer_par_8",
                                  "testzisuff_outer_redomap_7"};
static const char *size_classes[] = {"group_size", "group_size",
                                     "L2_for_histogram", "group_size",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "threshold ()",
                                     "threshold (!main.suff_outer_redomap_7)",
                                     "threshold ()", "L2_for_histogram",
                                     "group_size", "num_groups", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "num_groups", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "threshold ()",
                                     "threshold (!test.suff_outer_redomap_7)",
                                     "threshold ()"};
int futhark_get_num_sizes(void)
{
    return 80;
}
const char *futhark_get_size_name(int i)
{
    return size_names[i];
}
const char *futhark_get_size_class(int i)
{
    return size_classes[i];
}
struct sizes {
    size_t builtinzhreplicate_f32zigroup_sizze_29140;
    size_t builtinzhreplicate_i64zigroup_sizze_28732;
    size_t mainziL2_sizze_28797;
    size_t mainziseghist_group_sizze_26741;
    size_t mainziseghist_num_groups_26743;
    size_t mainzisegmap_group_sizze_25901;
    size_t mainzisegmap_group_sizze_26077;
    size_t mainzisegmap_group_sizze_26376;
    size_t mainzisegmap_group_sizze_26475;
    size_t mainzisegmap_group_sizze_26538;
    size_t mainzisegmap_group_sizze_26834;
    size_t mainzisegmap_group_sizze_26872;
    size_t mainzisegmap_group_sizze_26897;
    size_t mainzisegmap_num_groups_26378;
    size_t mainzisegred_group_sizze_25877;
    size_t mainzisegred_group_sizze_26731;
    size_t mainzisegred_group_sizze_26840;
    size_t mainzisegred_group_sizze_26905;
    size_t mainzisegred_group_sizze_26936;
    size_t mainzisegred_group_sizze_28354;
    size_t mainzisegred_group_sizze_28386;
    size_t mainzisegred_num_groups_25879;
    size_t mainzisegred_num_groups_26733;
    size_t mainzisegred_num_groups_26842;
    size_t mainzisegred_num_groups_26907;
    size_t mainzisegred_num_groups_26938;
    size_t mainzisegred_num_groups_28352;
    size_t mainzisegred_num_groups_28384;
    size_t mainzisegscan_group_sizze_26723;
    size_t mainzisegscan_group_sizze_26756;
    size_t mainzisegscan_group_sizze_26764;
    size_t mainzisegscan_group_sizze_26772;
    size_t mainzisegscan_group_sizze_26824;
    size_t mainzisegscan_num_groups_26725;
    size_t mainzisegscan_num_groups_26758;
    size_t mainzisegscan_num_groups_26766;
    size_t mainzisegscan_num_groups_26774;
    size_t mainzisegscan_num_groups_26826;
    size_t mainzisuff_outer_par_0;
    size_t mainzisuff_outer_par_8;
    size_t mainzisuff_outer_redomap_7;
    size_t testziL2_sizze_28797;
    size_t testziseghist_group_sizze_27850;
    size_t testziseghist_num_groups_27852;
    size_t testzisegmap_group_sizze_27013;
    size_t testzisegmap_group_sizze_27189;
    size_t testzisegmap_group_sizze_27488;
    size_t testzisegmap_group_sizze_27587;
    size_t testzisegmap_group_sizze_27650;
    size_t testzisegmap_group_sizze_27943;
    size_t testzisegmap_group_sizze_27981;
    size_t testzisegmap_group_sizze_28006;
    size_t testzisegmap_num_groups_27490;
    size_t testzisegred_group_sizze_26989;
    size_t testzisegred_group_sizze_27840;
    size_t testzisegred_group_sizze_27949;
    size_t testzisegred_group_sizze_28014;
    size_t testzisegred_group_sizze_28045;
    size_t testzisegred_group_sizze_28436;
    size_t testzisegred_group_sizze_28468;
    size_t testzisegred_num_groups_26991;
    size_t testzisegred_num_groups_27842;
    size_t testzisegred_num_groups_27951;
    size_t testzisegred_num_groups_28016;
    size_t testzisegred_num_groups_28047;
    size_t testzisegred_num_groups_28434;
    size_t testzisegred_num_groups_28466;
    size_t testzisegscan_group_sizze_27832;
    size_t testzisegscan_group_sizze_27865;
    size_t testzisegscan_group_sizze_27873;
    size_t testzisegscan_group_sizze_27881;
    size_t testzisegscan_group_sizze_27933;
    size_t testzisegscan_num_groups_27834;
    size_t testzisegscan_num_groups_27867;
    size_t testzisegscan_num_groups_27875;
    size_t testzisegscan_num_groups_27883;
    size_t testzisegscan_num_groups_27935;
    size_t testzisuff_outer_par_0;
    size_t testzisuff_outer_par_8;
    size_t testzisuff_outer_redomap_7;
} ;
struct futhark_context_config {
    struct opencl_config opencl;
    size_t sizes[80];
    int num_build_opts;
    const char **build_opts;
} ;
struct futhark_context_config *futhark_context_config_new(void)
{
    struct futhark_context_config *cfg =
                                  (struct futhark_context_config *) malloc(sizeof(struct futhark_context_config));
    
    if (cfg == NULL)
        return NULL;
    cfg->num_build_opts = 0;
    cfg->build_opts = (const char **) malloc(sizeof(const char *));
    cfg->build_opts[0] = NULL;
    cfg->sizes[0] = 0;
    cfg->sizes[1] = 0;
    cfg->sizes[2] = 4194304;
    cfg->sizes[3] = 0;
    cfg->sizes[4] = 0;
    cfg->sizes[5] = 0;
    cfg->sizes[6] = 0;
    cfg->sizes[7] = 0;
    cfg->sizes[8] = 0;
    cfg->sizes[9] = 0;
    cfg->sizes[10] = 0;
    cfg->sizes[11] = 0;
    cfg->sizes[12] = 0;
    cfg->sizes[13] = 0;
    cfg->sizes[14] = 0;
    cfg->sizes[15] = 0;
    cfg->sizes[16] = 0;
    cfg->sizes[17] = 0;
    cfg->sizes[18] = 0;
    cfg->sizes[19] = 0;
    cfg->sizes[20] = 0;
    cfg->sizes[21] = 0;
    cfg->sizes[22] = 0;
    cfg->sizes[23] = 0;
    cfg->sizes[24] = 0;
    cfg->sizes[25] = 0;
    cfg->sizes[26] = 0;
    cfg->sizes[27] = 0;
    cfg->sizes[28] = 0;
    cfg->sizes[29] = 0;
    cfg->sizes[30] = 0;
    cfg->sizes[31] = 0;
    cfg->sizes[32] = 0;
    cfg->sizes[33] = 0;
    cfg->sizes[34] = 0;
    cfg->sizes[35] = 0;
    cfg->sizes[36] = 0;
    cfg->sizes[37] = 0;
    cfg->sizes[38] = 0;
    cfg->sizes[39] = 0;
    cfg->sizes[40] = 0;
    cfg->sizes[41] = 4194304;
    cfg->sizes[42] = 0;
    cfg->sizes[43] = 0;
    cfg->sizes[44] = 0;
    cfg->sizes[45] = 0;
    cfg->sizes[46] = 0;
    cfg->sizes[47] = 0;
    cfg->sizes[48] = 0;
    cfg->sizes[49] = 0;
    cfg->sizes[50] = 0;
    cfg->sizes[51] = 0;
    cfg->sizes[52] = 0;
    cfg->sizes[53] = 0;
    cfg->sizes[54] = 0;
    cfg->sizes[55] = 0;
    cfg->sizes[56] = 0;
    cfg->sizes[57] = 0;
    cfg->sizes[58] = 0;
    cfg->sizes[59] = 0;
    cfg->sizes[60] = 0;
    cfg->sizes[61] = 0;
    cfg->sizes[62] = 0;
    cfg->sizes[63] = 0;
    cfg->sizes[64] = 0;
    cfg->sizes[65] = 0;
    cfg->sizes[66] = 0;
    cfg->sizes[67] = 0;
    cfg->sizes[68] = 0;
    cfg->sizes[69] = 0;
    cfg->sizes[70] = 0;
    cfg->sizes[71] = 0;
    cfg->sizes[72] = 0;
    cfg->sizes[73] = 0;
    cfg->sizes[74] = 0;
    cfg->sizes[75] = 0;
    cfg->sizes[76] = 0;
    cfg->sizes[77] = 0;
    cfg->sizes[78] = 0;
    cfg->sizes[79] = 0;
    opencl_config_init(&cfg->opencl, 80, size_names, size_vars, cfg->sizes,
                       size_classes);
    return cfg;
}
void futhark_context_config_free(struct futhark_context_config *cfg)
{
    free(cfg->build_opts);
    free(cfg);
}
void futhark_context_config_add_build_option(struct futhark_context_config *cfg,
                                             const char *opt)
{
    cfg->build_opts[cfg->num_build_opts] = opt;
    cfg->num_build_opts++;
    cfg->build_opts = (const char **) realloc(cfg->build_opts,
                                              (cfg->num_build_opts + 1) *
                                              sizeof(const char *));
    cfg->build_opts[cfg->num_build_opts] = NULL;
}
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int flag)
{
    cfg->opencl.profiling = cfg->opencl.logging = cfg->opencl.debugging = flag;
}
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag)
{
    cfg->opencl.profiling = flag;
}
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int flag)
{
    cfg->opencl.logging = flag;
}
void futhark_context_config_set_device(struct futhark_context_config *cfg, const
                                       char *s)
{
    set_preferred_device(&cfg->opencl, s);
}
void futhark_context_config_set_platform(struct futhark_context_config *cfg,
                                         const char *s)
{
    set_preferred_platform(&cfg->opencl, s);
}
void futhark_context_config_select_device_interactively(struct futhark_context_config *cfg)
{
    select_device_interactively(&cfg->opencl);
}
void futhark_context_config_list_devices(struct futhark_context_config *cfg)
{
    list_devices(&cfg->opencl);
}
void futhark_context_config_dump_program_to(struct futhark_context_config *cfg,
                                            const char *path)
{
    cfg->opencl.dump_program_to = path;
}
void futhark_context_config_load_program_from(struct futhark_context_config *cfg,
                                              const char *path)
{
    cfg->opencl.load_program_from = path;
}
void futhark_context_config_dump_binary_to(struct futhark_context_config *cfg,
                                           const char *path)
{
    cfg->opencl.dump_binary_to = path;
}
void futhark_context_config_load_binary_from(struct futhark_context_config *cfg,
                                             const char *path)
{
    cfg->opencl.load_binary_from = path;
}
void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg,
                                                   int size)
{
    cfg->opencl.default_group_size = size;
    cfg->opencl.default_group_size_changed = 1;
}
void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg,
                                                   int num)
{
    cfg->opencl.default_num_groups = num;
}
void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg,
                                                  int size)
{
    cfg->opencl.default_tile_size = size;
    cfg->opencl.default_tile_size_changed = 1;
}
void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg,
                                                  int size)
{
    cfg->opencl.default_threshold = size;
}
int futhark_context_config_set_size(struct futhark_context_config *cfg, const
                                    char *size_name, size_t size_value)
{
    for (int i = 0; i < 80; i++) {
        if (strcmp(size_name, size_names[i]) == 0) {
            cfg->sizes[i] = size_value;
            return 0;
        }
    }
    if (strcmp(size_name, "default_group_size") == 0) {
        cfg->opencl.default_group_size = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_num_groups") == 0) {
        cfg->opencl.default_num_groups = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_threshold") == 0) {
        cfg->opencl.default_threshold = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_tile_size") == 0) {
        cfg->opencl.default_tile_size = size_value;
        return 0;
    }
    return 1;
}
struct futhark_context {
    int detail_memory;
    int debugging;
    int profiling;
    int profiling_paused;
    int logging;
    lock_t lock;
    char *error;
    int64_t peak_mem_usage_device;
    int64_t cur_mem_usage_device;
    int64_t peak_mem_usage_default;
    int64_t cur_mem_usage_default;
    struct {
        int dummy;
    } constants;
    struct memblock_device mainzicounter_mem_28510;
    struct memblock_device mainzicounter_mem_28540;
    struct memblock_device mainzicounter_mem_28577;
    struct memblock_device mainzicounter_mem_28695;
    struct memblock_device mainzihist_locks_mem_28805;
    struct memblock_device mainzicounter_mem_28849;
    struct memblock_device mainzicounter_mem_29147;
    struct memblock_device mainzicounter_mem_29212;
    struct memblock_device mainzicounter_mem_29250;
    struct memblock_device testzistatic_array_28507;
    struct memblock_device testzistatic_array_28508;
    struct memblock_device testzistatic_array_28509;
    struct memblock_device testzicounter_mem_28511;
    struct memblock_device testzicounter_mem_28541;
    struct memblock_device testzicounter_mem_28578;
    struct memblock_device testzicounter_mem_28695;
    struct memblock_device testzihist_locks_mem_28805;
    struct memblock_device testzicounter_mem_28849;
    struct memblock_device testzicounter_mem_29147;
    struct memblock_device testzicounter_mem_29212;
    struct memblock_device testzicounter_mem_29250;
    int total_runs;
    long total_runtime;
    cl_kernel builtinzhreplicate_f32zireplicate_29137;
    cl_kernel builtinzhreplicate_i64zireplicate_28729;
    cl_kernel gpu_map_transpose_f32;
    cl_kernel gpu_map_transpose_f32_low_height;
    cl_kernel gpu_map_transpose_f32_low_width;
    cl_kernel gpu_map_transpose_f32_small;
    cl_kernel mainziscan_stage1_26729;
    cl_kernel mainziscan_stage1_26762;
    cl_kernel mainziscan_stage1_26770;
    cl_kernel mainziscan_stage1_26778;
    cl_kernel mainziscan_stage1_26830;
    cl_kernel mainziscan_stage2_26729;
    cl_kernel mainziscan_stage2_26762;
    cl_kernel mainziscan_stage2_26770;
    cl_kernel mainziscan_stage2_26778;
    cl_kernel mainziscan_stage2_26830;
    cl_kernel mainziscan_stage3_26729;
    cl_kernel mainziscan_stage3_26762;
    cl_kernel mainziscan_stage3_26770;
    cl_kernel mainziscan_stage3_26778;
    cl_kernel mainziscan_stage3_26830;
    cl_kernel mainziseghist_global_26747;
    cl_kernel mainziseghist_local_26747;
    cl_kernel mainzisegmap_25899;
    cl_kernel mainzisegmap_26075;
    cl_kernel mainzisegmap_26374;
    cl_kernel mainzisegmap_26472;
    cl_kernel mainzisegmap_26536;
    cl_kernel mainzisegmap_26832;
    cl_kernel mainzisegmap_26870;
    cl_kernel mainzisegmap_26895;
    cl_kernel mainzisegred_large_26911;
    cl_kernel mainzisegred_large_28820;
    cl_kernel mainzisegred_nonseg_25885;
    cl_kernel mainzisegred_nonseg_26739;
    cl_kernel mainzisegred_nonseg_26848;
    cl_kernel mainzisegred_nonseg_26944;
    cl_kernel mainzisegred_nonseg_28359;
    cl_kernel mainzisegred_nonseg_28391;
    cl_kernel mainzisegred_small_26911;
    cl_kernel mainzisegred_small_28820;
    cl_kernel testziscan_stage1_27838;
    cl_kernel testziscan_stage1_27871;
    cl_kernel testziscan_stage1_27879;
    cl_kernel testziscan_stage1_27887;
    cl_kernel testziscan_stage1_27939;
    cl_kernel testziscan_stage2_27838;
    cl_kernel testziscan_stage2_27871;
    cl_kernel testziscan_stage2_27879;
    cl_kernel testziscan_stage2_27887;
    cl_kernel testziscan_stage2_27939;
    cl_kernel testziscan_stage3_27838;
    cl_kernel testziscan_stage3_27871;
    cl_kernel testziscan_stage3_27879;
    cl_kernel testziscan_stage3_27887;
    cl_kernel testziscan_stage3_27939;
    cl_kernel testziseghist_global_27856;
    cl_kernel testziseghist_local_27856;
    cl_kernel testzisegmap_27011;
    cl_kernel testzisegmap_27187;
    cl_kernel testzisegmap_27486;
    cl_kernel testzisegmap_27584;
    cl_kernel testzisegmap_27648;
    cl_kernel testzisegmap_27941;
    cl_kernel testzisegmap_27979;
    cl_kernel testzisegmap_28004;
    cl_kernel testzisegred_large_28020;
    cl_kernel testzisegred_large_28820;
    cl_kernel testzisegred_nonseg_26997;
    cl_kernel testzisegred_nonseg_27848;
    cl_kernel testzisegred_nonseg_27957;
    cl_kernel testzisegred_nonseg_28053;
    cl_kernel testzisegred_nonseg_28441;
    cl_kernel testzisegred_nonseg_28473;
    cl_kernel testzisegred_small_28020;
    cl_kernel testzisegred_small_28820;
    int64_t copy_dev_to_dev_total_runtime;
    int copy_dev_to_dev_runs;
    int64_t copy_dev_to_host_total_runtime;
    int copy_dev_to_host_runs;
    int64_t copy_host_to_dev_total_runtime;
    int copy_host_to_dev_runs;
    int64_t copy_scalar_to_dev_total_runtime;
    int copy_scalar_to_dev_runs;
    int64_t copy_scalar_from_dev_total_runtime;
    int copy_scalar_from_dev_runs;
    int64_t builtinzhreplicate_f32zireplicate_29137_total_runtime;
    int builtinzhreplicate_f32zireplicate_29137_runs;
    int64_t builtinzhreplicate_i64zireplicate_28729_total_runtime;
    int builtinzhreplicate_i64zireplicate_28729_runs;
    int64_t gpu_map_transpose_f32_total_runtime;
    int gpu_map_transpose_f32_runs;
    int64_t gpu_map_transpose_f32_low_height_total_runtime;
    int gpu_map_transpose_f32_low_height_runs;
    int64_t gpu_map_transpose_f32_low_width_total_runtime;
    int gpu_map_transpose_f32_low_width_runs;
    int64_t gpu_map_transpose_f32_small_total_runtime;
    int gpu_map_transpose_f32_small_runs;
    int64_t mainziscan_stage1_26729_total_runtime;
    int mainziscan_stage1_26729_runs;
    int64_t mainziscan_stage1_26762_total_runtime;
    int mainziscan_stage1_26762_runs;
    int64_t mainziscan_stage1_26770_total_runtime;
    int mainziscan_stage1_26770_runs;
    int64_t mainziscan_stage1_26778_total_runtime;
    int mainziscan_stage1_26778_runs;
    int64_t mainziscan_stage1_26830_total_runtime;
    int mainziscan_stage1_26830_runs;
    int64_t mainziscan_stage2_26729_total_runtime;
    int mainziscan_stage2_26729_runs;
    int64_t mainziscan_stage2_26762_total_runtime;
    int mainziscan_stage2_26762_runs;
    int64_t mainziscan_stage2_26770_total_runtime;
    int mainziscan_stage2_26770_runs;
    int64_t mainziscan_stage2_26778_total_runtime;
    int mainziscan_stage2_26778_runs;
    int64_t mainziscan_stage2_26830_total_runtime;
    int mainziscan_stage2_26830_runs;
    int64_t mainziscan_stage3_26729_total_runtime;
    int mainziscan_stage3_26729_runs;
    int64_t mainziscan_stage3_26762_total_runtime;
    int mainziscan_stage3_26762_runs;
    int64_t mainziscan_stage3_26770_total_runtime;
    int mainziscan_stage3_26770_runs;
    int64_t mainziscan_stage3_26778_total_runtime;
    int mainziscan_stage3_26778_runs;
    int64_t mainziscan_stage3_26830_total_runtime;
    int mainziscan_stage3_26830_runs;
    int64_t mainziseghist_global_26747_total_runtime;
    int mainziseghist_global_26747_runs;
    int64_t mainziseghist_local_26747_total_runtime;
    int mainziseghist_local_26747_runs;
    int64_t mainzisegmap_25899_total_runtime;
    int mainzisegmap_25899_runs;
    int64_t mainzisegmap_26075_total_runtime;
    int mainzisegmap_26075_runs;
    int64_t mainzisegmap_26374_total_runtime;
    int mainzisegmap_26374_runs;
    int64_t mainzisegmap_26472_total_runtime;
    int mainzisegmap_26472_runs;
    int64_t mainzisegmap_26536_total_runtime;
    int mainzisegmap_26536_runs;
    int64_t mainzisegmap_26832_total_runtime;
    int mainzisegmap_26832_runs;
    int64_t mainzisegmap_26870_total_runtime;
    int mainzisegmap_26870_runs;
    int64_t mainzisegmap_26895_total_runtime;
    int mainzisegmap_26895_runs;
    int64_t mainzisegred_large_26911_total_runtime;
    int mainzisegred_large_26911_runs;
    int64_t mainzisegred_large_28820_total_runtime;
    int mainzisegred_large_28820_runs;
    int64_t mainzisegred_nonseg_25885_total_runtime;
    int mainzisegred_nonseg_25885_runs;
    int64_t mainzisegred_nonseg_26739_total_runtime;
    int mainzisegred_nonseg_26739_runs;
    int64_t mainzisegred_nonseg_26848_total_runtime;
    int mainzisegred_nonseg_26848_runs;
    int64_t mainzisegred_nonseg_26944_total_runtime;
    int mainzisegred_nonseg_26944_runs;
    int64_t mainzisegred_nonseg_28359_total_runtime;
    int mainzisegred_nonseg_28359_runs;
    int64_t mainzisegred_nonseg_28391_total_runtime;
    int mainzisegred_nonseg_28391_runs;
    int64_t mainzisegred_small_26911_total_runtime;
    int mainzisegred_small_26911_runs;
    int64_t mainzisegred_small_28820_total_runtime;
    int mainzisegred_small_28820_runs;
    int64_t testziscan_stage1_27838_total_runtime;
    int testziscan_stage1_27838_runs;
    int64_t testziscan_stage1_27871_total_runtime;
    int testziscan_stage1_27871_runs;
    int64_t testziscan_stage1_27879_total_runtime;
    int testziscan_stage1_27879_runs;
    int64_t testziscan_stage1_27887_total_runtime;
    int testziscan_stage1_27887_runs;
    int64_t testziscan_stage1_27939_total_runtime;
    int testziscan_stage1_27939_runs;
    int64_t testziscan_stage2_27838_total_runtime;
    int testziscan_stage2_27838_runs;
    int64_t testziscan_stage2_27871_total_runtime;
    int testziscan_stage2_27871_runs;
    int64_t testziscan_stage2_27879_total_runtime;
    int testziscan_stage2_27879_runs;
    int64_t testziscan_stage2_27887_total_runtime;
    int testziscan_stage2_27887_runs;
    int64_t testziscan_stage2_27939_total_runtime;
    int testziscan_stage2_27939_runs;
    int64_t testziscan_stage3_27838_total_runtime;
    int testziscan_stage3_27838_runs;
    int64_t testziscan_stage3_27871_total_runtime;
    int testziscan_stage3_27871_runs;
    int64_t testziscan_stage3_27879_total_runtime;
    int testziscan_stage3_27879_runs;
    int64_t testziscan_stage3_27887_total_runtime;
    int testziscan_stage3_27887_runs;
    int64_t testziscan_stage3_27939_total_runtime;
    int testziscan_stage3_27939_runs;
    int64_t testziseghist_global_27856_total_runtime;
    int testziseghist_global_27856_runs;
    int64_t testziseghist_local_27856_total_runtime;
    int testziseghist_local_27856_runs;
    int64_t testzisegmap_27011_total_runtime;
    int testzisegmap_27011_runs;
    int64_t testzisegmap_27187_total_runtime;
    int testzisegmap_27187_runs;
    int64_t testzisegmap_27486_total_runtime;
    int testzisegmap_27486_runs;
    int64_t testzisegmap_27584_total_runtime;
    int testzisegmap_27584_runs;
    int64_t testzisegmap_27648_total_runtime;
    int testzisegmap_27648_runs;
    int64_t testzisegmap_27941_total_runtime;
    int testzisegmap_27941_runs;
    int64_t testzisegmap_27979_total_runtime;
    int testzisegmap_27979_runs;
    int64_t testzisegmap_28004_total_runtime;
    int testzisegmap_28004_runs;
    int64_t testzisegred_large_28020_total_runtime;
    int testzisegred_large_28020_runs;
    int64_t testzisegred_large_28820_total_runtime;
    int testzisegred_large_28820_runs;
    int64_t testzisegred_nonseg_26997_total_runtime;
    int testzisegred_nonseg_26997_runs;
    int64_t testzisegred_nonseg_27848_total_runtime;
    int testzisegred_nonseg_27848_runs;
    int64_t testzisegred_nonseg_27957_total_runtime;
    int testzisegred_nonseg_27957_runs;
    int64_t testzisegred_nonseg_28053_total_runtime;
    int testzisegred_nonseg_28053_runs;
    int64_t testzisegred_nonseg_28441_total_runtime;
    int testzisegred_nonseg_28441_runs;
    int64_t testzisegred_nonseg_28473_total_runtime;
    int testzisegred_nonseg_28473_runs;
    int64_t testzisegred_small_28020_total_runtime;
    int testzisegred_small_28020_runs;
    int64_t testzisegred_small_28820_total_runtime;
    int testzisegred_small_28820_runs;
    cl_mem global_failure;
    cl_mem global_failure_args;
    struct opencl_context opencl;
    struct sizes sizes;
    cl_int failure_is_an_option;
} ;
void post_opencl_setup(struct opencl_context *ctx,
                       struct opencl_device_option *option)
{
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name,
                                            "NVIDIA CUDA") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_GPU) == CL_DEVICE_TYPE_GPU) {
        ctx->lockstep_width = 32;
    }
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name,
                                            "AMD Accelerated Parallel Processing") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->lockstep_width = 32;
    }
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->lockstep_width = 1;
    }
    if ((ctx->cfg.default_num_groups == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_GPU) == CL_DEVICE_TYPE_GPU) {
        size_t MAX_COMPUTE_UNITS_val = 0;
        
        clGetDeviceInfo(ctx->device, CL_DEVICE_MAX_COMPUTE_UNITS,
                        sizeof(MAX_COMPUTE_UNITS_val), &MAX_COMPUTE_UNITS_val,
                        NULL);
        ctx->cfg.default_num_groups = 4 * MAX_COMPUTE_UNITS_val;
    }
    if ((ctx->cfg.default_group_size == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_GPU) == CL_DEVICE_TYPE_GPU) {
        ctx->cfg.default_group_size = 256;
    }
    if ((ctx->cfg.default_tile_size == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->cfg.default_tile_size = 32;
    }
    if ((ctx->cfg.default_threshold == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->cfg.default_threshold = 32768;
    }
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_CPU) ==
        CL_DEVICE_TYPE_CPU) {
        ctx->lockstep_width = 1;
    }
    if ((ctx->cfg.default_num_groups == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_CPU) == CL_DEVICE_TYPE_CPU) {
        size_t MAX_COMPUTE_UNITS_val = 0;
        
        clGetDeviceInfo(ctx->device, CL_DEVICE_MAX_COMPUTE_UNITS,
                        sizeof(MAX_COMPUTE_UNITS_val), &MAX_COMPUTE_UNITS_val,
                        NULL);
        ctx->cfg.default_num_groups = MAX_COMPUTE_UNITS_val;
    }
    if ((ctx->cfg.default_group_size == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_CPU) == CL_DEVICE_TYPE_CPU) {
        ctx->cfg.default_group_size = 32;
    }
    if ((ctx->cfg.default_tile_size == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_CPU) ==
        CL_DEVICE_TYPE_CPU) {
        ctx->cfg.default_tile_size = 4;
    }
    if ((ctx->cfg.default_threshold == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_CPU) ==
        CL_DEVICE_TYPE_CPU) {
        size_t MAX_COMPUTE_UNITS_val = 0;
        
        clGetDeviceInfo(ctx->device, CL_DEVICE_MAX_COMPUTE_UNITS,
                        sizeof(MAX_COMPUTE_UNITS_val), &MAX_COMPUTE_UNITS_val,
                        NULL);
        ctx->cfg.default_threshold = MAX_COMPUTE_UNITS_val;
    }
}
static void init_context_early(struct futhark_context_config *cfg,
                               struct futhark_context *ctx)
{
    ctx->opencl.cfg = cfg->opencl;
    ctx->detail_memory = cfg->opencl.debugging;
    ctx->debugging = cfg->opencl.debugging;
    ctx->profiling = cfg->opencl.profiling;
    ctx->profiling_paused = 0;
    ctx->logging = cfg->opencl.logging;
    ctx->error = NULL;
    ctx->opencl.profiling_records_capacity = 200;
    ctx->opencl.profiling_records_used = 0;
    ctx->opencl.profiling_records =
        malloc(ctx->opencl.profiling_records_capacity *
        sizeof(struct profiling_record));
    create_lock(&ctx->lock);
    ctx->failure_is_an_option = 0;
    ctx->peak_mem_usage_device = 0;
    ctx->cur_mem_usage_device = 0;
    ctx->peak_mem_usage_default = 0;
    ctx->cur_mem_usage_default = 0;
    ctx->total_runs = 0;
    ctx->total_runtime = 0;
    ctx->copy_dev_to_dev_total_runtime = 0;
    ctx->copy_dev_to_dev_runs = 0;
    ctx->copy_dev_to_host_total_runtime = 0;
    ctx->copy_dev_to_host_runs = 0;
    ctx->copy_host_to_dev_total_runtime = 0;
    ctx->copy_host_to_dev_runs = 0;
    ctx->copy_scalar_to_dev_total_runtime = 0;
    ctx->copy_scalar_to_dev_runs = 0;
    ctx->copy_scalar_from_dev_total_runtime = 0;
    ctx->copy_scalar_from_dev_runs = 0;
    ctx->builtinzhreplicate_f32zireplicate_29137_total_runtime = 0;
    ctx->builtinzhreplicate_f32zireplicate_29137_runs = 0;
    ctx->builtinzhreplicate_i64zireplicate_28729_total_runtime = 0;
    ctx->builtinzhreplicate_i64zireplicate_28729_runs = 0;
    ctx->gpu_map_transpose_f32_total_runtime = 0;
    ctx->gpu_map_transpose_f32_runs = 0;
    ctx->gpu_map_transpose_f32_low_height_total_runtime = 0;
    ctx->gpu_map_transpose_f32_low_height_runs = 0;
    ctx->gpu_map_transpose_f32_low_width_total_runtime = 0;
    ctx->gpu_map_transpose_f32_low_width_runs = 0;
    ctx->gpu_map_transpose_f32_small_total_runtime = 0;
    ctx->gpu_map_transpose_f32_small_runs = 0;
    ctx->mainziscan_stage1_26729_total_runtime = 0;
    ctx->mainziscan_stage1_26729_runs = 0;
    ctx->mainziscan_stage1_26762_total_runtime = 0;
    ctx->mainziscan_stage1_26762_runs = 0;
    ctx->mainziscan_stage1_26770_total_runtime = 0;
    ctx->mainziscan_stage1_26770_runs = 0;
    ctx->mainziscan_stage1_26778_total_runtime = 0;
    ctx->mainziscan_stage1_26778_runs = 0;
    ctx->mainziscan_stage1_26830_total_runtime = 0;
    ctx->mainziscan_stage1_26830_runs = 0;
    ctx->mainziscan_stage2_26729_total_runtime = 0;
    ctx->mainziscan_stage2_26729_runs = 0;
    ctx->mainziscan_stage2_26762_total_runtime = 0;
    ctx->mainziscan_stage2_26762_runs = 0;
    ctx->mainziscan_stage2_26770_total_runtime = 0;
    ctx->mainziscan_stage2_26770_runs = 0;
    ctx->mainziscan_stage2_26778_total_runtime = 0;
    ctx->mainziscan_stage2_26778_runs = 0;
    ctx->mainziscan_stage2_26830_total_runtime = 0;
    ctx->mainziscan_stage2_26830_runs = 0;
    ctx->mainziscan_stage3_26729_total_runtime = 0;
    ctx->mainziscan_stage3_26729_runs = 0;
    ctx->mainziscan_stage3_26762_total_runtime = 0;
    ctx->mainziscan_stage3_26762_runs = 0;
    ctx->mainziscan_stage3_26770_total_runtime = 0;
    ctx->mainziscan_stage3_26770_runs = 0;
    ctx->mainziscan_stage3_26778_total_runtime = 0;
    ctx->mainziscan_stage3_26778_runs = 0;
    ctx->mainziscan_stage3_26830_total_runtime = 0;
    ctx->mainziscan_stage3_26830_runs = 0;
    ctx->mainziseghist_global_26747_total_runtime = 0;
    ctx->mainziseghist_global_26747_runs = 0;
    ctx->mainziseghist_local_26747_total_runtime = 0;
    ctx->mainziseghist_local_26747_runs = 0;
    ctx->mainzisegmap_25899_total_runtime = 0;
    ctx->mainzisegmap_25899_runs = 0;
    ctx->mainzisegmap_26075_total_runtime = 0;
    ctx->mainzisegmap_26075_runs = 0;
    ctx->mainzisegmap_26374_total_runtime = 0;
    ctx->mainzisegmap_26374_runs = 0;
    ctx->mainzisegmap_26472_total_runtime = 0;
    ctx->mainzisegmap_26472_runs = 0;
    ctx->mainzisegmap_26536_total_runtime = 0;
    ctx->mainzisegmap_26536_runs = 0;
    ctx->mainzisegmap_26832_total_runtime = 0;
    ctx->mainzisegmap_26832_runs = 0;
    ctx->mainzisegmap_26870_total_runtime = 0;
    ctx->mainzisegmap_26870_runs = 0;
    ctx->mainzisegmap_26895_total_runtime = 0;
    ctx->mainzisegmap_26895_runs = 0;
    ctx->mainzisegred_large_26911_total_runtime = 0;
    ctx->mainzisegred_large_26911_runs = 0;
    ctx->mainzisegred_large_28820_total_runtime = 0;
    ctx->mainzisegred_large_28820_runs = 0;
    ctx->mainzisegred_nonseg_25885_total_runtime = 0;
    ctx->mainzisegred_nonseg_25885_runs = 0;
    ctx->mainzisegred_nonseg_26739_total_runtime = 0;
    ctx->mainzisegred_nonseg_26739_runs = 0;
    ctx->mainzisegred_nonseg_26848_total_runtime = 0;
    ctx->mainzisegred_nonseg_26848_runs = 0;
    ctx->mainzisegred_nonseg_26944_total_runtime = 0;
    ctx->mainzisegred_nonseg_26944_runs = 0;
    ctx->mainzisegred_nonseg_28359_total_runtime = 0;
    ctx->mainzisegred_nonseg_28359_runs = 0;
    ctx->mainzisegred_nonseg_28391_total_runtime = 0;
    ctx->mainzisegred_nonseg_28391_runs = 0;
    ctx->mainzisegred_small_26911_total_runtime = 0;
    ctx->mainzisegred_small_26911_runs = 0;
    ctx->mainzisegred_small_28820_total_runtime = 0;
    ctx->mainzisegred_small_28820_runs = 0;
    ctx->testziscan_stage1_27838_total_runtime = 0;
    ctx->testziscan_stage1_27838_runs = 0;
    ctx->testziscan_stage1_27871_total_runtime = 0;
    ctx->testziscan_stage1_27871_runs = 0;
    ctx->testziscan_stage1_27879_total_runtime = 0;
    ctx->testziscan_stage1_27879_runs = 0;
    ctx->testziscan_stage1_27887_total_runtime = 0;
    ctx->testziscan_stage1_27887_runs = 0;
    ctx->testziscan_stage1_27939_total_runtime = 0;
    ctx->testziscan_stage1_27939_runs = 0;
    ctx->testziscan_stage2_27838_total_runtime = 0;
    ctx->testziscan_stage2_27838_runs = 0;
    ctx->testziscan_stage2_27871_total_runtime = 0;
    ctx->testziscan_stage2_27871_runs = 0;
    ctx->testziscan_stage2_27879_total_runtime = 0;
    ctx->testziscan_stage2_27879_runs = 0;
    ctx->testziscan_stage2_27887_total_runtime = 0;
    ctx->testziscan_stage2_27887_runs = 0;
    ctx->testziscan_stage2_27939_total_runtime = 0;
    ctx->testziscan_stage2_27939_runs = 0;
    ctx->testziscan_stage3_27838_total_runtime = 0;
    ctx->testziscan_stage3_27838_runs = 0;
    ctx->testziscan_stage3_27871_total_runtime = 0;
    ctx->testziscan_stage3_27871_runs = 0;
    ctx->testziscan_stage3_27879_total_runtime = 0;
    ctx->testziscan_stage3_27879_runs = 0;
    ctx->testziscan_stage3_27887_total_runtime = 0;
    ctx->testziscan_stage3_27887_runs = 0;
    ctx->testziscan_stage3_27939_total_runtime = 0;
    ctx->testziscan_stage3_27939_runs = 0;
    ctx->testziseghist_global_27856_total_runtime = 0;
    ctx->testziseghist_global_27856_runs = 0;
    ctx->testziseghist_local_27856_total_runtime = 0;
    ctx->testziseghist_local_27856_runs = 0;
    ctx->testzisegmap_27011_total_runtime = 0;
    ctx->testzisegmap_27011_runs = 0;
    ctx->testzisegmap_27187_total_runtime = 0;
    ctx->testzisegmap_27187_runs = 0;
    ctx->testzisegmap_27486_total_runtime = 0;
    ctx->testzisegmap_27486_runs = 0;
    ctx->testzisegmap_27584_total_runtime = 0;
    ctx->testzisegmap_27584_runs = 0;
    ctx->testzisegmap_27648_total_runtime = 0;
    ctx->testzisegmap_27648_runs = 0;
    ctx->testzisegmap_27941_total_runtime = 0;
    ctx->testzisegmap_27941_runs = 0;
    ctx->testzisegmap_27979_total_runtime = 0;
    ctx->testzisegmap_27979_runs = 0;
    ctx->testzisegmap_28004_total_runtime = 0;
    ctx->testzisegmap_28004_runs = 0;
    ctx->testzisegred_large_28020_total_runtime = 0;
    ctx->testzisegred_large_28020_runs = 0;
    ctx->testzisegred_large_28820_total_runtime = 0;
    ctx->testzisegred_large_28820_runs = 0;
    ctx->testzisegred_nonseg_26997_total_runtime = 0;
    ctx->testzisegred_nonseg_26997_runs = 0;
    ctx->testzisegred_nonseg_27848_total_runtime = 0;
    ctx->testzisegred_nonseg_27848_runs = 0;
    ctx->testzisegred_nonseg_27957_total_runtime = 0;
    ctx->testzisegred_nonseg_27957_runs = 0;
    ctx->testzisegred_nonseg_28053_total_runtime = 0;
    ctx->testzisegred_nonseg_28053_runs = 0;
    ctx->testzisegred_nonseg_28441_total_runtime = 0;
    ctx->testzisegred_nonseg_28441_runs = 0;
    ctx->testzisegred_nonseg_28473_total_runtime = 0;
    ctx->testzisegred_nonseg_28473_runs = 0;
    ctx->testzisegred_small_28020_total_runtime = 0;
    ctx->testzisegred_small_28020_runs = 0;
    ctx->testzisegred_small_28820_total_runtime = 0;
    ctx->testzisegred_small_28820_runs = 0;
}
static int init_context_late(struct futhark_context_config *cfg,
                             struct futhark_context *ctx, cl_program prog)
{
    cl_int error;
    cl_int no_error = -1;
    
    ctx->global_failure = clCreateBuffer(ctx->opencl.ctx, CL_MEM_READ_WRITE |
                                         CL_MEM_COPY_HOST_PTR, sizeof(cl_int),
                                         &no_error, &error);
    OPENCL_SUCCEED_OR_RETURN(error);
    // The +1 is to avoid zero-byte allocations.
    ctx->global_failure_args = clCreateBuffer(ctx->opencl.ctx,
                                              CL_MEM_READ_WRITE,
                                              sizeof(int64_t) * (3 + 1), NULL,
                                              &error);
    OPENCL_SUCCEED_OR_RETURN(error);
    {
        ctx->builtinzhreplicate_f32zireplicate_29137 = clCreateKernel(prog,
                                                                      "builtinzhreplicate_f32zireplicate_29137",
                                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "builtin#replicate_f32.replicate_29137");
    }
    {
        ctx->builtinzhreplicate_i64zireplicate_28729 = clCreateKernel(prog,
                                                                      "builtinzhreplicate_i64zireplicate_28729",
                                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "builtin#replicate_i64.replicate_28729");
    }
    {
        ctx->gpu_map_transpose_f32 = clCreateKernel(prog,
                                                    "gpu_map_transpose_f32",
                                                    &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "gpu_map_transpose_f32");
    }
    {
        ctx->gpu_map_transpose_f32_low_height = clCreateKernel(prog,
                                                               "gpu_map_transpose_f32_low_height",
                                                               &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "gpu_map_transpose_f32_low_height");
    }
    {
        ctx->gpu_map_transpose_f32_low_width = clCreateKernel(prog,
                                                              "gpu_map_transpose_f32_low_width",
                                                              &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "gpu_map_transpose_f32_low_width");
    }
    {
        ctx->gpu_map_transpose_f32_small = clCreateKernel(prog,
                                                          "gpu_map_transpose_f32_small",
                                                          &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "gpu_map_transpose_f32_small");
    }
    {
        ctx->mainziscan_stage1_26729 = clCreateKernel(prog,
                                                      "mainziscan_stage1_26729",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_26729, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_26729");
    }
    {
        ctx->mainziscan_stage1_26762 = clCreateKernel(prog,
                                                      "mainziscan_stage1_26762",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_26762, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_26762");
    }
    {
        ctx->mainziscan_stage1_26770 = clCreateKernel(prog,
                                                      "mainziscan_stage1_26770",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_26770, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_26770");
    }
    {
        ctx->mainziscan_stage1_26778 = clCreateKernel(prog,
                                                      "mainziscan_stage1_26778",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_26778, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_26778, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_26778");
    }
    {
        ctx->mainziscan_stage1_26830 = clCreateKernel(prog,
                                                      "mainziscan_stage1_26830",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_26830, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_26830");
    }
    {
        ctx->mainziscan_stage2_26729 = clCreateKernel(prog,
                                                      "mainziscan_stage2_26729",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_26729, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_26729");
    }
    {
        ctx->mainziscan_stage2_26762 = clCreateKernel(prog,
                                                      "mainziscan_stage2_26762",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_26762, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_26762");
    }
    {
        ctx->mainziscan_stage2_26770 = clCreateKernel(prog,
                                                      "mainziscan_stage2_26770",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_26770, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_26770");
    }
    {
        ctx->mainziscan_stage2_26778 = clCreateKernel(prog,
                                                      "mainziscan_stage2_26778",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_26778, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_26778");
    }
    {
        ctx->mainziscan_stage2_26830 = clCreateKernel(prog,
                                                      "mainziscan_stage2_26830",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_26830, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_26830");
    }
    {
        ctx->mainziscan_stage3_26729 = clCreateKernel(prog,
                                                      "mainziscan_stage3_26729",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_26729, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_26729");
    }
    {
        ctx->mainziscan_stage3_26762 = clCreateKernel(prog,
                                                      "mainziscan_stage3_26762",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_26762, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_26762");
    }
    {
        ctx->mainziscan_stage3_26770 = clCreateKernel(prog,
                                                      "mainziscan_stage3_26770",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_26770, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_26770");
    }
    {
        ctx->mainziscan_stage3_26778 = clCreateKernel(prog,
                                                      "mainziscan_stage3_26778",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_26778, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_26778");
    }
    {
        ctx->mainziscan_stage3_26830 = clCreateKernel(prog,
                                                      "mainziscan_stage3_26830",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_26830, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_26830");
    }
    {
        ctx->mainziseghist_global_26747 = clCreateKernel(prog,
                                                         "mainziseghist_global_26747",
                                                         &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziseghist_global_26747, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "main.seghist_global_26747");
    }
    {
        ctx->mainziseghist_local_26747 = clCreateKernel(prog,
                                                        "mainziseghist_local_26747",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziseghist_local_26747, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.seghist_local_26747");
    }
    {
        ctx->mainzisegmap_25899 = clCreateKernel(prog, "mainzisegmap_25899",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25899, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25899, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_25899");
    }
    {
        ctx->mainzisegmap_26075 = clCreateKernel(prog, "mainzisegmap_26075",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_26075, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_26075, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_26075");
    }
    {
        ctx->mainzisegmap_26374 = clCreateKernel(prog, "mainzisegmap_26374",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_26374, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_26374, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_26374");
    }
    {
        ctx->mainzisegmap_26472 = clCreateKernel(prog, "mainzisegmap_26472",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_26472, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_26472");
    }
    {
        ctx->mainzisegmap_26536 = clCreateKernel(prog, "mainzisegmap_26536",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_26536, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_26536");
    }
    {
        ctx->mainzisegmap_26832 = clCreateKernel(prog, "mainzisegmap_26832",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_26832, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_26832");
    }
    {
        ctx->mainzisegmap_26870 = clCreateKernel(prog, "mainzisegmap_26870",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_26870, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_26870");
    }
    {
        ctx->mainzisegmap_26895 = clCreateKernel(prog, "mainzisegmap_26895",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_26895, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_26895");
    }
    {
        ctx->mainzisegred_large_26911 = clCreateKernel(prog,
                                                       "mainzisegred_large_26911",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_large_26911, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_large_26911");
    }
    {
        ctx->mainzisegred_large_28820 = clCreateKernel(prog,
                                                       "mainzisegred_large_28820",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_large_28820, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_large_28820");
    }
    {
        ctx->mainzisegred_nonseg_25885 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_25885",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_25885, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_25885");
    }
    {
        ctx->mainzisegred_nonseg_26739 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_26739",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_26739, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_26739");
    }
    {
        ctx->mainzisegred_nonseg_26848 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_26848",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_26848, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_26848");
    }
    {
        ctx->mainzisegred_nonseg_26944 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_26944",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_26944, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_26944");
    }
    {
        ctx->mainzisegred_nonseg_28359 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_28359",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_28359, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_28359");
    }
    {
        ctx->mainzisegred_nonseg_28391 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_28391",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_28391, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_28391");
    }
    {
        ctx->mainzisegred_small_26911 = clCreateKernel(prog,
                                                       "mainzisegred_small_26911",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_small_26911, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_small_26911");
    }
    {
        ctx->mainzisegred_small_28820 = clCreateKernel(prog,
                                                       "mainzisegred_small_28820",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_small_28820, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_small_28820");
    }
    {
        ctx->testziscan_stage1_27838 = clCreateKernel(prog,
                                                      "testziscan_stage1_27838",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_27838, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_27838");
    }
    {
        ctx->testziscan_stage1_27871 = clCreateKernel(prog,
                                                      "testziscan_stage1_27871",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_27871, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_27871");
    }
    {
        ctx->testziscan_stage1_27879 = clCreateKernel(prog,
                                                      "testziscan_stage1_27879",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_27879, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_27879");
    }
    {
        ctx->testziscan_stage1_27887 = clCreateKernel(prog,
                                                      "testziscan_stage1_27887",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_27887, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_27887, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_27887");
    }
    {
        ctx->testziscan_stage1_27939 = clCreateKernel(prog,
                                                      "testziscan_stage1_27939",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_27939, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_27939");
    }
    {
        ctx->testziscan_stage2_27838 = clCreateKernel(prog,
                                                      "testziscan_stage2_27838",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_27838, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_27838");
    }
    {
        ctx->testziscan_stage2_27871 = clCreateKernel(prog,
                                                      "testziscan_stage2_27871",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_27871, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_27871");
    }
    {
        ctx->testziscan_stage2_27879 = clCreateKernel(prog,
                                                      "testziscan_stage2_27879",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_27879, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_27879");
    }
    {
        ctx->testziscan_stage2_27887 = clCreateKernel(prog,
                                                      "testziscan_stage2_27887",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_27887, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_27887");
    }
    {
        ctx->testziscan_stage2_27939 = clCreateKernel(prog,
                                                      "testziscan_stage2_27939",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_27939, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_27939");
    }
    {
        ctx->testziscan_stage3_27838 = clCreateKernel(prog,
                                                      "testziscan_stage3_27838",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_27838, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_27838");
    }
    {
        ctx->testziscan_stage3_27871 = clCreateKernel(prog,
                                                      "testziscan_stage3_27871",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_27871, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_27871");
    }
    {
        ctx->testziscan_stage3_27879 = clCreateKernel(prog,
                                                      "testziscan_stage3_27879",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_27879, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_27879");
    }
    {
        ctx->testziscan_stage3_27887 = clCreateKernel(prog,
                                                      "testziscan_stage3_27887",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_27887, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_27887");
    }
    {
        ctx->testziscan_stage3_27939 = clCreateKernel(prog,
                                                      "testziscan_stage3_27939",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_27939, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_27939");
    }
    {
        ctx->testziseghist_global_27856 = clCreateKernel(prog,
                                                         "testziseghist_global_27856",
                                                         &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziseghist_global_27856, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "test.seghist_global_27856");
    }
    {
        ctx->testziseghist_local_27856 = clCreateKernel(prog,
                                                        "testziseghist_local_27856",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziseghist_local_27856, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.seghist_local_27856");
    }
    {
        ctx->testzisegmap_27011 = clCreateKernel(prog, "testzisegmap_27011",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27011, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27011, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_27011");
    }
    {
        ctx->testzisegmap_27187 = clCreateKernel(prog, "testzisegmap_27187",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27187, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27187, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_27187");
    }
    {
        ctx->testzisegmap_27486 = clCreateKernel(prog, "testzisegmap_27486",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27486, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27486, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_27486");
    }
    {
        ctx->testzisegmap_27584 = clCreateKernel(prog, "testzisegmap_27584",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27584, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_27584");
    }
    {
        ctx->testzisegmap_27648 = clCreateKernel(prog, "testzisegmap_27648",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27648, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_27648");
    }
    {
        ctx->testzisegmap_27941 = clCreateKernel(prog, "testzisegmap_27941",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27941, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_27941");
    }
    {
        ctx->testzisegmap_27979 = clCreateKernel(prog, "testzisegmap_27979",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27979, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_27979");
    }
    {
        ctx->testzisegmap_28004 = clCreateKernel(prog, "testzisegmap_28004",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_28004, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_28004");
    }
    {
        ctx->testzisegred_large_28020 = clCreateKernel(prog,
                                                       "testzisegred_large_28020",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_large_28020, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_large_28020");
    }
    {
        ctx->testzisegred_large_28820 = clCreateKernel(prog,
                                                       "testzisegred_large_28820",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_large_28820, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_large_28820");
    }
    {
        ctx->testzisegred_nonseg_26997 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_26997",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_26997, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_26997");
    }
    {
        ctx->testzisegred_nonseg_27848 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_27848",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_27848, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_27848");
    }
    {
        ctx->testzisegred_nonseg_27957 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_27957",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_27957, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_27957");
    }
    {
        ctx->testzisegred_nonseg_28053 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_28053",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_28053, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_28053");
    }
    {
        ctx->testzisegred_nonseg_28441 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_28441",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_28441, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_28441");
    }
    {
        ctx->testzisegred_nonseg_28473 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_28473",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_28473, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_28473");
    }
    {
        ctx->testzisegred_small_28020 = clCreateKernel(prog,
                                                       "testzisegred_small_28020",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_small_28020, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_small_28020");
    }
    {
        ctx->testzisegred_small_28820 = clCreateKernel(prog,
                                                       "testzisegred_small_28820",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_small_28820, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_small_28820");
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28510.references = NULL;
        ctx->mainzicounter_mem_28510.size = 0;
        ctx->mainzicounter_mem_28510.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28510.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_29314,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28540.references = NULL;
        ctx->mainzicounter_mem_28540.size = 0;
        ctx->mainzicounter_mem_28540.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28540.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_29321,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28577.references = NULL;
        ctx->mainzicounter_mem_28577.size = 0;
        ctx->mainzicounter_mem_28577.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28577.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_29333,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28695.references = NULL;
        ctx->mainzicounter_mem_28695.size = 0;
        ctx->mainzicounter_mem_28695.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28695.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_29375,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzihist_locks_mem_28805.references = NULL;
        ctx->mainzihist_locks_mem_28805.size = 0;
        ctx->mainzihist_locks_mem_28805.mem = clCreateBuffer(ctx->opencl.ctx,
                                                             CL_MEM_READ_WRITE,
                                                             (100151 >
                                                              0 ? 100151 : 1) *
                                                             sizeof(int32_t),
                                                             NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (100151 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzihist_locks_mem_28805.mem,
                                                          CL_TRUE, 0, 100151 *
                                                          sizeof(int32_t),
                                                          mainzihist_locks_mem_realtype_29387,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28849.references = NULL;
        ctx->mainzicounter_mem_28849.size = 0;
        ctx->mainzicounter_mem_28849.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28849.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_29398,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_29147.references = NULL;
        ctx->mainzicounter_mem_29147.size = 0;
        ctx->mainzicounter_mem_29147.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_29147.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_29470,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_29212.references = NULL;
        ctx->mainzicounter_mem_29212.size = 0;
        ctx->mainzicounter_mem_29212.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_29212.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_29487,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_29250.references = NULL;
        ctx->mainzicounter_mem_29250.size = 0;
        ctx->mainzicounter_mem_29250.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_29250.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_29498,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzistatic_array_28507.references = NULL;
        ctx->testzistatic_array_28507.size = 0;
        ctx->testzistatic_array_28507.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (9 > 0 ? 9 : 1) *
                                                           sizeof(float), NULL,
                                                           &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (9 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzistatic_array_28507.mem,
                                                          CL_TRUE, 0, 9 *
                                                          sizeof(float),
                                                          testzistatic_array_realtype_29507,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzistatic_array_28508.references = NULL;
        ctx->testzistatic_array_28508.size = 0;
        ctx->testzistatic_array_28508.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (9 > 0 ? 9 : 1) *
                                                           sizeof(int64_t),
                                                           NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (9 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzistatic_array_28508.mem,
                                                          CL_TRUE, 0, 9 *
                                                          sizeof(int64_t),
                                                          testzistatic_array_realtype_29508,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzistatic_array_28509.references = NULL;
        ctx->testzistatic_array_28509.size = 0;
        ctx->testzistatic_array_28509.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (9 > 0 ? 9 : 1) *
                                                           sizeof(float), NULL,
                                                           &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (9 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzistatic_array_28509.mem,
                                                          CL_TRUE, 0, 9 *
                                                          sizeof(float),
                                                          testzistatic_array_realtype_29509,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28511.references = NULL;
        ctx->testzicounter_mem_28511.size = 0;
        ctx->testzicounter_mem_28511.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28511.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29510,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28541.references = NULL;
        ctx->testzicounter_mem_28541.size = 0;
        ctx->testzicounter_mem_28541.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28541.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29517,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28578.references = NULL;
        ctx->testzicounter_mem_28578.size = 0;
        ctx->testzicounter_mem_28578.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28578.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29529,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28695.references = NULL;
        ctx->testzicounter_mem_28695.size = 0;
        ctx->testzicounter_mem_28695.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28695.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29571,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzihist_locks_mem_28805.references = NULL;
        ctx->testzihist_locks_mem_28805.size = 0;
        ctx->testzihist_locks_mem_28805.mem = clCreateBuffer(ctx->opencl.ctx,
                                                             CL_MEM_READ_WRITE,
                                                             (100151 >
                                                              0 ? 100151 : 1) *
                                                             sizeof(int32_t),
                                                             NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (100151 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzihist_locks_mem_28805.mem,
                                                          CL_TRUE, 0, 100151 *
                                                          sizeof(int32_t),
                                                          testzihist_locks_mem_realtype_29583,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28849.references = NULL;
        ctx->testzicounter_mem_28849.size = 0;
        ctx->testzicounter_mem_28849.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28849.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29594,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_29147.references = NULL;
        ctx->testzicounter_mem_29147.size = 0;
        ctx->testzicounter_mem_29147.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_29147.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29666,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_29212.references = NULL;
        ctx->testzicounter_mem_29212.size = 0;
        ctx->testzicounter_mem_29212.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_29212.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29683,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_29250.references = NULL;
        ctx->testzicounter_mem_29250.size = 0;
        ctx->testzicounter_mem_29250.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_29250.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29694,
                                                          0, NULL, NULL));
    }
    ctx->sizes.builtinzhreplicate_f32zigroup_sizze_29140 = cfg->sizes[0];
    ctx->sizes.builtinzhreplicate_i64zigroup_sizze_28732 = cfg->sizes[1];
    ctx->sizes.mainziL2_sizze_28797 = cfg->sizes[2];
    ctx->sizes.mainziseghist_group_sizze_26741 = cfg->sizes[3];
    ctx->sizes.mainziseghist_num_groups_26743 = cfg->sizes[4];
    ctx->sizes.mainzisegmap_group_sizze_25901 = cfg->sizes[5];
    ctx->sizes.mainzisegmap_group_sizze_26077 = cfg->sizes[6];
    ctx->sizes.mainzisegmap_group_sizze_26376 = cfg->sizes[7];
    ctx->sizes.mainzisegmap_group_sizze_26475 = cfg->sizes[8];
    ctx->sizes.mainzisegmap_group_sizze_26538 = cfg->sizes[9];
    ctx->sizes.mainzisegmap_group_sizze_26834 = cfg->sizes[10];
    ctx->sizes.mainzisegmap_group_sizze_26872 = cfg->sizes[11];
    ctx->sizes.mainzisegmap_group_sizze_26897 = cfg->sizes[12];
    ctx->sizes.mainzisegmap_num_groups_26378 = cfg->sizes[13];
    ctx->sizes.mainzisegred_group_sizze_25877 = cfg->sizes[14];
    ctx->sizes.mainzisegred_group_sizze_26731 = cfg->sizes[15];
    ctx->sizes.mainzisegred_group_sizze_26840 = cfg->sizes[16];
    ctx->sizes.mainzisegred_group_sizze_26905 = cfg->sizes[17];
    ctx->sizes.mainzisegred_group_sizze_26936 = cfg->sizes[18];
    ctx->sizes.mainzisegred_group_sizze_28354 = cfg->sizes[19];
    ctx->sizes.mainzisegred_group_sizze_28386 = cfg->sizes[20];
    ctx->sizes.mainzisegred_num_groups_25879 = cfg->sizes[21];
    ctx->sizes.mainzisegred_num_groups_26733 = cfg->sizes[22];
    ctx->sizes.mainzisegred_num_groups_26842 = cfg->sizes[23];
    ctx->sizes.mainzisegred_num_groups_26907 = cfg->sizes[24];
    ctx->sizes.mainzisegred_num_groups_26938 = cfg->sizes[25];
    ctx->sizes.mainzisegred_num_groups_28352 = cfg->sizes[26];
    ctx->sizes.mainzisegred_num_groups_28384 = cfg->sizes[27];
    ctx->sizes.mainzisegscan_group_sizze_26723 = cfg->sizes[28];
    ctx->sizes.mainzisegscan_group_sizze_26756 = cfg->sizes[29];
    ctx->sizes.mainzisegscan_group_sizze_26764 = cfg->sizes[30];
    ctx->sizes.mainzisegscan_group_sizze_26772 = cfg->sizes[31];
    ctx->sizes.mainzisegscan_group_sizze_26824 = cfg->sizes[32];
    ctx->sizes.mainzisegscan_num_groups_26725 = cfg->sizes[33];
    ctx->sizes.mainzisegscan_num_groups_26758 = cfg->sizes[34];
    ctx->sizes.mainzisegscan_num_groups_26766 = cfg->sizes[35];
    ctx->sizes.mainzisegscan_num_groups_26774 = cfg->sizes[36];
    ctx->sizes.mainzisegscan_num_groups_26826 = cfg->sizes[37];
    ctx->sizes.mainzisuff_outer_par_0 = cfg->sizes[38];
    ctx->sizes.mainzisuff_outer_par_8 = cfg->sizes[39];
    ctx->sizes.mainzisuff_outer_redomap_7 = cfg->sizes[40];
    ctx->sizes.testziL2_sizze_28797 = cfg->sizes[41];
    ctx->sizes.testziseghist_group_sizze_27850 = cfg->sizes[42];
    ctx->sizes.testziseghist_num_groups_27852 = cfg->sizes[43];
    ctx->sizes.testzisegmap_group_sizze_27013 = cfg->sizes[44];
    ctx->sizes.testzisegmap_group_sizze_27189 = cfg->sizes[45];
    ctx->sizes.testzisegmap_group_sizze_27488 = cfg->sizes[46];
    ctx->sizes.testzisegmap_group_sizze_27587 = cfg->sizes[47];
    ctx->sizes.testzisegmap_group_sizze_27650 = cfg->sizes[48];
    ctx->sizes.testzisegmap_group_sizze_27943 = cfg->sizes[49];
    ctx->sizes.testzisegmap_group_sizze_27981 = cfg->sizes[50];
    ctx->sizes.testzisegmap_group_sizze_28006 = cfg->sizes[51];
    ctx->sizes.testzisegmap_num_groups_27490 = cfg->sizes[52];
    ctx->sizes.testzisegred_group_sizze_26989 = cfg->sizes[53];
    ctx->sizes.testzisegred_group_sizze_27840 = cfg->sizes[54];
    ctx->sizes.testzisegred_group_sizze_27949 = cfg->sizes[55];
    ctx->sizes.testzisegred_group_sizze_28014 = cfg->sizes[56];
    ctx->sizes.testzisegred_group_sizze_28045 = cfg->sizes[57];
    ctx->sizes.testzisegred_group_sizze_28436 = cfg->sizes[58];
    ctx->sizes.testzisegred_group_sizze_28468 = cfg->sizes[59];
    ctx->sizes.testzisegred_num_groups_26991 = cfg->sizes[60];
    ctx->sizes.testzisegred_num_groups_27842 = cfg->sizes[61];
    ctx->sizes.testzisegred_num_groups_27951 = cfg->sizes[62];
    ctx->sizes.testzisegred_num_groups_28016 = cfg->sizes[63];
    ctx->sizes.testzisegred_num_groups_28047 = cfg->sizes[64];
    ctx->sizes.testzisegred_num_groups_28434 = cfg->sizes[65];
    ctx->sizes.testzisegred_num_groups_28466 = cfg->sizes[66];
    ctx->sizes.testzisegscan_group_sizze_27832 = cfg->sizes[67];
    ctx->sizes.testzisegscan_group_sizze_27865 = cfg->sizes[68];
    ctx->sizes.testzisegscan_group_sizze_27873 = cfg->sizes[69];
    ctx->sizes.testzisegscan_group_sizze_27881 = cfg->sizes[70];
    ctx->sizes.testzisegscan_group_sizze_27933 = cfg->sizes[71];
    ctx->sizes.testzisegscan_num_groups_27834 = cfg->sizes[72];
    ctx->sizes.testzisegscan_num_groups_27867 = cfg->sizes[73];
    ctx->sizes.testzisegscan_num_groups_27875 = cfg->sizes[74];
    ctx->sizes.testzisegscan_num_groups_27883 = cfg->sizes[75];
    ctx->sizes.testzisegscan_num_groups_27935 = cfg->sizes[76];
    ctx->sizes.testzisuff_outer_par_0 = cfg->sizes[77];
    ctx->sizes.testzisuff_outer_par_8 = cfg->sizes[78];
    ctx->sizes.testzisuff_outer_redomap_7 = cfg->sizes[79];
    init_constants(ctx);
    // Clear the free list of any deallocations that occurred while initialising constants.
    OPENCL_SUCCEED_OR_RETURN(opencl_free_all(&ctx->opencl));
    // The program will be properly freed after all the kernels have also been freed.
    OPENCL_SUCCEED_OR_RETURN(clReleaseProgram(prog));
    return futhark_context_sync(ctx);
}
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg)
{
    struct futhark_context *ctx =
                           (struct futhark_context *) malloc(sizeof(struct futhark_context));
    
    if (ctx == NULL)
        return NULL;
    
    int required_types = 0;
    
    init_context_early(cfg, ctx);
    
    cl_program prog = setup_opencl(&ctx->opencl, opencl_program, required_types,
                                   cfg->build_opts);
    
    init_context_late(cfg, ctx, prog);
    return ctx;
}
struct futhark_context *futhark_context_new_with_command_queue(struct futhark_context_config *cfg,
                                                               cl_command_queue queue)
{
    struct futhark_context *ctx =
                           (struct futhark_context *) malloc(sizeof(struct futhark_context));
    
    if (ctx == NULL)
        return NULL;
    
    int required_types = 0;
    
    init_context_early(cfg, ctx);
    
    cl_program prog = setup_opencl_with_command_queue(&ctx->opencl, queue,
                                                      opencl_program,
                                                      required_types,
                                                      cfg->build_opts);
    
    init_context_late(cfg, ctx, prog);
    return ctx;
}
void futhark_context_free(struct futhark_context *ctx)
{
    free_constants(ctx);
    free_lock(&ctx->lock);
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->builtinzhreplicate_f32zireplicate_29137));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->builtinzhreplicate_i64zireplicate_28729));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32_low_height));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32_low_width));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32_small));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_26729));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_26762));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_26770));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_26778));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_26830));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_26729));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_26762));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_26770));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_26778));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_26830));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_26729));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_26762));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_26770));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_26778));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_26830));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziseghist_global_26747));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziseghist_local_26747));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_25899));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_26075));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_26374));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_26472));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_26536));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_26832));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_26870));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_26895));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_large_26911));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_large_28820));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_25885));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_26739));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_26848));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_26944));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_28359));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_28391));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_small_26911));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_small_28820));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_27838));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_27871));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_27879));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_27887));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_27939));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_27838));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_27871));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_27879));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_27887));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_27939));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_27838));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_27871));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_27879));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_27887));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_27939));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziseghist_global_27856));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziseghist_local_27856));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_27011));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_27187));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_27486));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_27584));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_27648));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_27941));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_27979));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_28004));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_large_28020));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_large_28820));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_26997));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_27848));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_27957));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_28053));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_28441));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_28473));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_small_28020));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_small_28820));
    teardown_opencl(&ctx->opencl);
    free(ctx);
}
int futhark_context_sync(struct futhark_context *ctx)
{
    cl_int failure_idx = -1;
    
    if (ctx->failure_is_an_option) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     ctx->global_failure,
                                                     CL_FALSE, 0,
                                                     sizeof(cl_int),
                                                     &failure_idx, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        ctx->failure_is_an_option = 0;
    }
    OPENCL_SUCCEED_OR_RETURN(clFinish(ctx->opencl.queue));
    if (failure_idx >= 0) {
        cl_int no_failure = -1;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                      ctx->global_failure,
                                                      CL_TRUE, 0,
                                                      sizeof(cl_int),
                                                      &no_failure, 0, NULL,
                                                      NULL));
        
        int64_t args[3 + 1];
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     ctx->global_failure_args,
                                                     CL_TRUE, 0, sizeof(args),
                                                     &args, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_host_runs,
                                                                                               &ctx->copy_dev_to_host_total_runtime)));
        switch (failure_idx) {
            
          case 0:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva.fut:54:29-52\n   #1  cva.fut:95:25-65\n   #2  cva.fut:109:16-62\n   #3  cva.fut:105:17-109:85\n   #4  cva.fut:100:1-165:21\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 1:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:96:47-70\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:100:1-165:21\n",
                              args[0], args[1]);
                break;
            }
            
          case 2:
            {
                ctx->error =
                    msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  cva.fut:97:74-90\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:100:1-165:21\n",
                              args[0], args[1]);
                break;
            }
            
          case 3:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva.fut:54:29-52\n   #1  cva.fut:95:25-65\n   #2  cva.fut:109:16-62\n   #3  cva.fut:105:17-109:85\n   #4  cva.fut:100:1-165:21\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 4:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:96:47-70\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:100:1-165:21\n",
                              args[0], args[1]);
                break;
            }
            
          case 5:
            {
                ctx->error =
                    msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  cva.fut:97:74-90\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:100:1-165:21\n",
                              args[0], args[1]);
                break;
            }
            
          case 6:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:71:97-104\n   #1  cva.fut:123:32-62\n   #2  cva.fut:123:22-69\n   #3  cva.fut:100:1-165:21\n",
                              args[0], args[1]);
                break;
            }
            
          case 7:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:71:58-105\n   #1  cva.fut:123:32-62\n   #2  cva.fut:123:22-69\n   #3  cva.fut:100:1-165:21\n",
                              args[0], args[1]);
                break;
            }
            
          case 8:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/segmented/segmented.fut:90:30-35\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:90:12-49\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva.fut:132:34-93\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  cva.fut:126:18-137:50\n   #9  cva.fut:100:1-165:21\n",
                              args[0], args[1]);
                break;
            }
            
          case 9:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva.fut:54:29-52\n   #1  cva.fut:95:25-65\n   #2  cva.fut:109:16-62\n   #3  cva.fut:105:17-109:85\n   #4  cva.fut:173:3-120\n   #5  cva.fut:172:1-173:128\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 10:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:96:47-70\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:173:3-120\n   #4  cva.fut:172:1-173:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 11:
            {
                ctx->error =
                    msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  cva.fut:97:74-90\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:173:3-120\n   #4  cva.fut:172:1-173:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 12:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva.fut:54:29-52\n   #1  cva.fut:95:25-65\n   #2  cva.fut:109:16-62\n   #3  cva.fut:105:17-109:85\n   #4  cva.fut:173:3-120\n   #5  cva.fut:172:1-173:128\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 13:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:96:47-70\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:173:3-120\n   #4  cva.fut:172:1-173:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 14:
            {
                ctx->error =
                    msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  cva.fut:97:74-90\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:173:3-120\n   #4  cva.fut:172:1-173:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 15:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:71:97-104\n   #1  cva.fut:123:32-62\n   #2  cva.fut:123:22-69\n   #3  cva.fut:173:3-120\n   #4  cva.fut:172:1-173:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 16:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:71:58-105\n   #1  cva.fut:123:32-62\n   #2  cva.fut:123:22-69\n   #3  cva.fut:173:3-120\n   #4  cva.fut:172:1-173:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 17:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/segmented/segmented.fut:90:30-35\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:90:12-49\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva.fut:132:34-93\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  cva.fut:126:18-137:50\n   #9  cva.fut:173:3-120\n   #10 cva.fut:172:1-173:128\n",
                              args[0], args[1]);
                break;
            }
        }
        return 1;
    }
    return 0;
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    ctx->error = OPENCL_SUCCEED_NONFATAL(opencl_free_all(&ctx->opencl));
    return ctx->error != NULL;
}
cl_command_queue futhark_context_get_command_queue(struct futhark_context *ctx)
{
    return ctx->opencl.queue;
}
static int memblock_unref_device(struct futhark_context *ctx,
                                 struct memblock_device *block, const
                                 char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(stderr,
                    "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n",
                    desc, block->desc, "space 'device'", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_device -= block->size;
            OPENCL_SUCCEED_OR_RETURN(opencl_free(&ctx->opencl, block->mem,
                                                 desc));
            free(block->references);
            if (ctx->detail_memory)
                fprintf(stderr,
                        "%lld bytes freed (now allocated: %lld bytes)\n",
                        (long long) block->size,
                        (long long) ctx->cur_mem_usage_device);
        }
        block->references = NULL;
    }
    return 0;
}
static int memblock_alloc_device(struct futhark_context *ctx,
                                 struct memblock_device *block, int64_t size,
                                 const char *desc)
{
    if (size < 0)
        futhark_panic(1,
                      "Negative allocation of %lld bytes attempted for %s in %s.\n",
                      (long long) size, desc, "space 'device'",
                      ctx->cur_mem_usage_device);
    
    int ret = memblock_unref_device(ctx, block, desc);
    
    ctx->cur_mem_usage_device += size;
    if (ctx->detail_memory)
        fprintf(stderr,
                "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)",
                (long long) size, desc, "space 'device'",
                (long long) ctx->cur_mem_usage_device);
    if (ctx->cur_mem_usage_device > ctx->peak_mem_usage_device) {
        ctx->peak_mem_usage_device = ctx->cur_mem_usage_device;
        if (ctx->detail_memory)
            fprintf(stderr, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(stderr, ".\n");
    OPENCL_SUCCEED_OR_RETURN(opencl_alloc(&ctx->opencl, size, desc,
                                          &block->mem));
    block->references = (int *) malloc(sizeof(int));
    *block->references = 1;
    block->size = size;
    block->desc = desc;
    return ret;
}
static int memblock_set_device(struct futhark_context *ctx,
                               struct memblock_device *lhs,
                               struct memblock_device *rhs, const
                               char *lhs_desc)
{
    int ret = memblock_unref_device(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
static int memblock_unref(struct futhark_context *ctx, struct memblock *block,
                          const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(stderr,
                    "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n",
                    desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            free(block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(stderr,
                        "%lld bytes freed (now allocated: %lld bytes)\n",
                        (long long) block->size,
                        (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
static int memblock_alloc(struct futhark_context *ctx, struct memblock *block,
                          int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1,
                      "Negative allocation of %lld bytes attempted for %s in %s.\n",
                      (long long) size, desc, "default space",
                      ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    ctx->cur_mem_usage_default += size;
    if (ctx->detail_memory)
        fprintf(stderr,
                "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)",
                (long long) size, desc, "default space",
                (long long) ctx->cur_mem_usage_default);
    if (ctx->cur_mem_usage_default > ctx->peak_mem_usage_default) {
        ctx->peak_mem_usage_default = ctx->cur_mem_usage_default;
        if (ctx->detail_memory)
            fprintf(stderr, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(stderr, ".\n");
    block->mem = (char *) malloc(size);
    block->references = (int *) malloc(sizeof(int));
    *block->references = 1;
    block->size = size;
    block->desc = desc;
    return ret;
}
static int memblock_set(struct futhark_context *ctx, struct memblock *lhs,
                        struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    struct str_builder builder;
    
    str_builder_init(&builder);
    if (ctx->detail_memory || ctx->profiling) {
        str_builder(&builder,
                    "Peak memory usage for space 'device': %lld bytes.\n",
                    (long long) ctx->peak_mem_usage_device);
        { }
    }
    if (ctx->profiling) {
        OPENCL_SUCCEED_FATAL(opencl_tally_profiling_records(&ctx->opencl));
        str_builder(&builder,
                    "copy_dev_to_dev                       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_dev_to_dev_runs,
                    (long) ctx->copy_dev_to_dev_total_runtime /
                    (ctx->copy_dev_to_dev_runs !=
                     0 ? ctx->copy_dev_to_dev_runs : 1),
                    (long) ctx->copy_dev_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_dev_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_dev_to_dev_runs;
        str_builder(&builder,
                    "copy_dev_to_host                      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_dev_to_host_runs,
                    (long) ctx->copy_dev_to_host_total_runtime /
                    (ctx->copy_dev_to_host_runs !=
                     0 ? ctx->copy_dev_to_host_runs : 1),
                    (long) ctx->copy_dev_to_host_total_runtime);
        ctx->total_runtime += ctx->copy_dev_to_host_total_runtime;
        ctx->total_runs += ctx->copy_dev_to_host_runs;
        str_builder(&builder,
                    "copy_host_to_dev                      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_host_to_dev_runs,
                    (long) ctx->copy_host_to_dev_total_runtime /
                    (ctx->copy_host_to_dev_runs !=
                     0 ? ctx->copy_host_to_dev_runs : 1),
                    (long) ctx->copy_host_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_host_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_host_to_dev_runs;
        str_builder(&builder,
                    "copy_scalar_to_dev                    ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_scalar_to_dev_runs,
                    (long) ctx->copy_scalar_to_dev_total_runtime /
                    (ctx->copy_scalar_to_dev_runs !=
                     0 ? ctx->copy_scalar_to_dev_runs : 1),
                    (long) ctx->copy_scalar_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_scalar_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_scalar_to_dev_runs;
        str_builder(&builder,
                    "copy_scalar_from_dev                  ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_scalar_from_dev_runs,
                    (long) ctx->copy_scalar_from_dev_total_runtime /
                    (ctx->copy_scalar_from_dev_runs !=
                     0 ? ctx->copy_scalar_from_dev_runs : 1),
                    (long) ctx->copy_scalar_from_dev_total_runtime);
        ctx->total_runtime += ctx->copy_scalar_from_dev_total_runtime;
        ctx->total_runs += ctx->copy_scalar_from_dev_runs;
        str_builder(&builder,
                    "builtin#replicate_f32.replicate_29137 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhreplicate_f32zireplicate_29137_runs,
                    (long) ctx->builtinzhreplicate_f32zireplicate_29137_total_runtime /
                    (ctx->builtinzhreplicate_f32zireplicate_29137_runs !=
                     0 ? ctx->builtinzhreplicate_f32zireplicate_29137_runs : 1),
                    (long) ctx->builtinzhreplicate_f32zireplicate_29137_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhreplicate_f32zireplicate_29137_total_runtime;
        ctx->total_runs += ctx->builtinzhreplicate_f32zireplicate_29137_runs;
        str_builder(&builder,
                    "builtin#replicate_i64.replicate_28729 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhreplicate_i64zireplicate_28729_runs,
                    (long) ctx->builtinzhreplicate_i64zireplicate_28729_total_runtime /
                    (ctx->builtinzhreplicate_i64zireplicate_28729_runs !=
                     0 ? ctx->builtinzhreplicate_i64zireplicate_28729_runs : 1),
                    (long) ctx->builtinzhreplicate_i64zireplicate_28729_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhreplicate_i64zireplicate_28729_total_runtime;
        ctx->total_runs += ctx->builtinzhreplicate_i64zireplicate_28729_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32                 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_runs,
                    (long) ctx->gpu_map_transpose_f32_total_runtime /
                    (ctx->gpu_map_transpose_f32_runs !=
                     0 ? ctx->gpu_map_transpose_f32_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_total_runtime);
        ctx->total_runtime += ctx->gpu_map_transpose_f32_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32_low_height      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_low_height_runs,
                    (long) ctx->gpu_map_transpose_f32_low_height_total_runtime /
                    (ctx->gpu_map_transpose_f32_low_height_runs !=
                     0 ? ctx->gpu_map_transpose_f32_low_height_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_low_height_total_runtime);
        ctx->total_runtime +=
            ctx->gpu_map_transpose_f32_low_height_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_low_height_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32_low_width       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_low_width_runs,
                    (long) ctx->gpu_map_transpose_f32_low_width_total_runtime /
                    (ctx->gpu_map_transpose_f32_low_width_runs !=
                     0 ? ctx->gpu_map_transpose_f32_low_width_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_low_width_total_runtime);
        ctx->total_runtime +=
            ctx->gpu_map_transpose_f32_low_width_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_low_width_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32_small           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_small_runs,
                    (long) ctx->gpu_map_transpose_f32_small_total_runtime /
                    (ctx->gpu_map_transpose_f32_small_runs !=
                     0 ? ctx->gpu_map_transpose_f32_small_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_small_total_runtime);
        ctx->total_runtime += ctx->gpu_map_transpose_f32_small_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_small_runs;
        str_builder(&builder,
                    "main.scan_stage1_26729                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_26729_runs,
                    (long) ctx->mainziscan_stage1_26729_total_runtime /
                    (ctx->mainziscan_stage1_26729_runs !=
                     0 ? ctx->mainziscan_stage1_26729_runs : 1),
                    (long) ctx->mainziscan_stage1_26729_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_26729_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_26729_runs;
        str_builder(&builder,
                    "main.scan_stage1_26762                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_26762_runs,
                    (long) ctx->mainziscan_stage1_26762_total_runtime /
                    (ctx->mainziscan_stage1_26762_runs !=
                     0 ? ctx->mainziscan_stage1_26762_runs : 1),
                    (long) ctx->mainziscan_stage1_26762_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_26762_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_26762_runs;
        str_builder(&builder,
                    "main.scan_stage1_26770                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_26770_runs,
                    (long) ctx->mainziscan_stage1_26770_total_runtime /
                    (ctx->mainziscan_stage1_26770_runs !=
                     0 ? ctx->mainziscan_stage1_26770_runs : 1),
                    (long) ctx->mainziscan_stage1_26770_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_26770_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_26770_runs;
        str_builder(&builder,
                    "main.scan_stage1_26778                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_26778_runs,
                    (long) ctx->mainziscan_stage1_26778_total_runtime /
                    (ctx->mainziscan_stage1_26778_runs !=
                     0 ? ctx->mainziscan_stage1_26778_runs : 1),
                    (long) ctx->mainziscan_stage1_26778_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_26778_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_26778_runs;
        str_builder(&builder,
                    "main.scan_stage1_26830                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_26830_runs,
                    (long) ctx->mainziscan_stage1_26830_total_runtime /
                    (ctx->mainziscan_stage1_26830_runs !=
                     0 ? ctx->mainziscan_stage1_26830_runs : 1),
                    (long) ctx->mainziscan_stage1_26830_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_26830_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_26830_runs;
        str_builder(&builder,
                    "main.scan_stage2_26729                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_26729_runs,
                    (long) ctx->mainziscan_stage2_26729_total_runtime /
                    (ctx->mainziscan_stage2_26729_runs !=
                     0 ? ctx->mainziscan_stage2_26729_runs : 1),
                    (long) ctx->mainziscan_stage2_26729_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_26729_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_26729_runs;
        str_builder(&builder,
                    "main.scan_stage2_26762                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_26762_runs,
                    (long) ctx->mainziscan_stage2_26762_total_runtime /
                    (ctx->mainziscan_stage2_26762_runs !=
                     0 ? ctx->mainziscan_stage2_26762_runs : 1),
                    (long) ctx->mainziscan_stage2_26762_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_26762_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_26762_runs;
        str_builder(&builder,
                    "main.scan_stage2_26770                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_26770_runs,
                    (long) ctx->mainziscan_stage2_26770_total_runtime /
                    (ctx->mainziscan_stage2_26770_runs !=
                     0 ? ctx->mainziscan_stage2_26770_runs : 1),
                    (long) ctx->mainziscan_stage2_26770_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_26770_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_26770_runs;
        str_builder(&builder,
                    "main.scan_stage2_26778                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_26778_runs,
                    (long) ctx->mainziscan_stage2_26778_total_runtime /
                    (ctx->mainziscan_stage2_26778_runs !=
                     0 ? ctx->mainziscan_stage2_26778_runs : 1),
                    (long) ctx->mainziscan_stage2_26778_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_26778_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_26778_runs;
        str_builder(&builder,
                    "main.scan_stage2_26830                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_26830_runs,
                    (long) ctx->mainziscan_stage2_26830_total_runtime /
                    (ctx->mainziscan_stage2_26830_runs !=
                     0 ? ctx->mainziscan_stage2_26830_runs : 1),
                    (long) ctx->mainziscan_stage2_26830_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_26830_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_26830_runs;
        str_builder(&builder,
                    "main.scan_stage3_26729                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_26729_runs,
                    (long) ctx->mainziscan_stage3_26729_total_runtime /
                    (ctx->mainziscan_stage3_26729_runs !=
                     0 ? ctx->mainziscan_stage3_26729_runs : 1),
                    (long) ctx->mainziscan_stage3_26729_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_26729_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_26729_runs;
        str_builder(&builder,
                    "main.scan_stage3_26762                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_26762_runs,
                    (long) ctx->mainziscan_stage3_26762_total_runtime /
                    (ctx->mainziscan_stage3_26762_runs !=
                     0 ? ctx->mainziscan_stage3_26762_runs : 1),
                    (long) ctx->mainziscan_stage3_26762_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_26762_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_26762_runs;
        str_builder(&builder,
                    "main.scan_stage3_26770                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_26770_runs,
                    (long) ctx->mainziscan_stage3_26770_total_runtime /
                    (ctx->mainziscan_stage3_26770_runs !=
                     0 ? ctx->mainziscan_stage3_26770_runs : 1),
                    (long) ctx->mainziscan_stage3_26770_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_26770_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_26770_runs;
        str_builder(&builder,
                    "main.scan_stage3_26778                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_26778_runs,
                    (long) ctx->mainziscan_stage3_26778_total_runtime /
                    (ctx->mainziscan_stage3_26778_runs !=
                     0 ? ctx->mainziscan_stage3_26778_runs : 1),
                    (long) ctx->mainziscan_stage3_26778_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_26778_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_26778_runs;
        str_builder(&builder,
                    "main.scan_stage3_26830                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_26830_runs,
                    (long) ctx->mainziscan_stage3_26830_total_runtime /
                    (ctx->mainziscan_stage3_26830_runs !=
                     0 ? ctx->mainziscan_stage3_26830_runs : 1),
                    (long) ctx->mainziscan_stage3_26830_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_26830_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_26830_runs;
        str_builder(&builder,
                    "main.seghist_global_26747             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziseghist_global_26747_runs,
                    (long) ctx->mainziseghist_global_26747_total_runtime /
                    (ctx->mainziseghist_global_26747_runs !=
                     0 ? ctx->mainziseghist_global_26747_runs : 1),
                    (long) ctx->mainziseghist_global_26747_total_runtime);
        ctx->total_runtime += ctx->mainziseghist_global_26747_total_runtime;
        ctx->total_runs += ctx->mainziseghist_global_26747_runs;
        str_builder(&builder,
                    "main.seghist_local_26747              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziseghist_local_26747_runs,
                    (long) ctx->mainziseghist_local_26747_total_runtime /
                    (ctx->mainziseghist_local_26747_runs !=
                     0 ? ctx->mainziseghist_local_26747_runs : 1),
                    (long) ctx->mainziseghist_local_26747_total_runtime);
        ctx->total_runtime += ctx->mainziseghist_local_26747_total_runtime;
        ctx->total_runs += ctx->mainziseghist_local_26747_runs;
        str_builder(&builder,
                    "main.segmap_25899                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_25899_runs,
                    (long) ctx->mainzisegmap_25899_total_runtime /
                    (ctx->mainzisegmap_25899_runs !=
                     0 ? ctx->mainzisegmap_25899_runs : 1),
                    (long) ctx->mainzisegmap_25899_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_25899_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_25899_runs;
        str_builder(&builder,
                    "main.segmap_26075                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_26075_runs,
                    (long) ctx->mainzisegmap_26075_total_runtime /
                    (ctx->mainzisegmap_26075_runs !=
                     0 ? ctx->mainzisegmap_26075_runs : 1),
                    (long) ctx->mainzisegmap_26075_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_26075_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_26075_runs;
        str_builder(&builder,
                    "main.segmap_26374                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_26374_runs,
                    (long) ctx->mainzisegmap_26374_total_runtime /
                    (ctx->mainzisegmap_26374_runs !=
                     0 ? ctx->mainzisegmap_26374_runs : 1),
                    (long) ctx->mainzisegmap_26374_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_26374_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_26374_runs;
        str_builder(&builder,
                    "main.segmap_26472                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_26472_runs,
                    (long) ctx->mainzisegmap_26472_total_runtime /
                    (ctx->mainzisegmap_26472_runs !=
                     0 ? ctx->mainzisegmap_26472_runs : 1),
                    (long) ctx->mainzisegmap_26472_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_26472_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_26472_runs;
        str_builder(&builder,
                    "main.segmap_26536                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_26536_runs,
                    (long) ctx->mainzisegmap_26536_total_runtime /
                    (ctx->mainzisegmap_26536_runs !=
                     0 ? ctx->mainzisegmap_26536_runs : 1),
                    (long) ctx->mainzisegmap_26536_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_26536_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_26536_runs;
        str_builder(&builder,
                    "main.segmap_26832                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_26832_runs,
                    (long) ctx->mainzisegmap_26832_total_runtime /
                    (ctx->mainzisegmap_26832_runs !=
                     0 ? ctx->mainzisegmap_26832_runs : 1),
                    (long) ctx->mainzisegmap_26832_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_26832_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_26832_runs;
        str_builder(&builder,
                    "main.segmap_26870                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_26870_runs,
                    (long) ctx->mainzisegmap_26870_total_runtime /
                    (ctx->mainzisegmap_26870_runs !=
                     0 ? ctx->mainzisegmap_26870_runs : 1),
                    (long) ctx->mainzisegmap_26870_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_26870_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_26870_runs;
        str_builder(&builder,
                    "main.segmap_26895                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_26895_runs,
                    (long) ctx->mainzisegmap_26895_total_runtime /
                    (ctx->mainzisegmap_26895_runs !=
                     0 ? ctx->mainzisegmap_26895_runs : 1),
                    (long) ctx->mainzisegmap_26895_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_26895_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_26895_runs;
        str_builder(&builder,
                    "main.segred_large_26911               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_large_26911_runs,
                    (long) ctx->mainzisegred_large_26911_total_runtime /
                    (ctx->mainzisegred_large_26911_runs !=
                     0 ? ctx->mainzisegred_large_26911_runs : 1),
                    (long) ctx->mainzisegred_large_26911_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_large_26911_total_runtime;
        ctx->total_runs += ctx->mainzisegred_large_26911_runs;
        str_builder(&builder,
                    "main.segred_large_28820               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_large_28820_runs,
                    (long) ctx->mainzisegred_large_28820_total_runtime /
                    (ctx->mainzisegred_large_28820_runs !=
                     0 ? ctx->mainzisegred_large_28820_runs : 1),
                    (long) ctx->mainzisegred_large_28820_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_large_28820_total_runtime;
        ctx->total_runs += ctx->mainzisegred_large_28820_runs;
        str_builder(&builder,
                    "main.segred_nonseg_25885              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_25885_runs,
                    (long) ctx->mainzisegred_nonseg_25885_total_runtime /
                    (ctx->mainzisegred_nonseg_25885_runs !=
                     0 ? ctx->mainzisegred_nonseg_25885_runs : 1),
                    (long) ctx->mainzisegred_nonseg_25885_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_25885_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_25885_runs;
        str_builder(&builder,
                    "main.segred_nonseg_26739              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_26739_runs,
                    (long) ctx->mainzisegred_nonseg_26739_total_runtime /
                    (ctx->mainzisegred_nonseg_26739_runs !=
                     0 ? ctx->mainzisegred_nonseg_26739_runs : 1),
                    (long) ctx->mainzisegred_nonseg_26739_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_26739_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_26739_runs;
        str_builder(&builder,
                    "main.segred_nonseg_26848              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_26848_runs,
                    (long) ctx->mainzisegred_nonseg_26848_total_runtime /
                    (ctx->mainzisegred_nonseg_26848_runs !=
                     0 ? ctx->mainzisegred_nonseg_26848_runs : 1),
                    (long) ctx->mainzisegred_nonseg_26848_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_26848_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_26848_runs;
        str_builder(&builder,
                    "main.segred_nonseg_26944              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_26944_runs,
                    (long) ctx->mainzisegred_nonseg_26944_total_runtime /
                    (ctx->mainzisegred_nonseg_26944_runs !=
                     0 ? ctx->mainzisegred_nonseg_26944_runs : 1),
                    (long) ctx->mainzisegred_nonseg_26944_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_26944_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_26944_runs;
        str_builder(&builder,
                    "main.segred_nonseg_28359              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_28359_runs,
                    (long) ctx->mainzisegred_nonseg_28359_total_runtime /
                    (ctx->mainzisegred_nonseg_28359_runs !=
                     0 ? ctx->mainzisegred_nonseg_28359_runs : 1),
                    (long) ctx->mainzisegred_nonseg_28359_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_28359_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_28359_runs;
        str_builder(&builder,
                    "main.segred_nonseg_28391              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_28391_runs,
                    (long) ctx->mainzisegred_nonseg_28391_total_runtime /
                    (ctx->mainzisegred_nonseg_28391_runs !=
                     0 ? ctx->mainzisegred_nonseg_28391_runs : 1),
                    (long) ctx->mainzisegred_nonseg_28391_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_28391_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_28391_runs;
        str_builder(&builder,
                    "main.segred_small_26911               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_small_26911_runs,
                    (long) ctx->mainzisegred_small_26911_total_runtime /
                    (ctx->mainzisegred_small_26911_runs !=
                     0 ? ctx->mainzisegred_small_26911_runs : 1),
                    (long) ctx->mainzisegred_small_26911_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_small_26911_total_runtime;
        ctx->total_runs += ctx->mainzisegred_small_26911_runs;
        str_builder(&builder,
                    "main.segred_small_28820               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_small_28820_runs,
                    (long) ctx->mainzisegred_small_28820_total_runtime /
                    (ctx->mainzisegred_small_28820_runs !=
                     0 ? ctx->mainzisegred_small_28820_runs : 1),
                    (long) ctx->mainzisegred_small_28820_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_small_28820_total_runtime;
        ctx->total_runs += ctx->mainzisegred_small_28820_runs;
        str_builder(&builder,
                    "test.scan_stage1_27838                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_27838_runs,
                    (long) ctx->testziscan_stage1_27838_total_runtime /
                    (ctx->testziscan_stage1_27838_runs !=
                     0 ? ctx->testziscan_stage1_27838_runs : 1),
                    (long) ctx->testziscan_stage1_27838_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_27838_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_27838_runs;
        str_builder(&builder,
                    "test.scan_stage1_27871                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_27871_runs,
                    (long) ctx->testziscan_stage1_27871_total_runtime /
                    (ctx->testziscan_stage1_27871_runs !=
                     0 ? ctx->testziscan_stage1_27871_runs : 1),
                    (long) ctx->testziscan_stage1_27871_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_27871_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_27871_runs;
        str_builder(&builder,
                    "test.scan_stage1_27879                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_27879_runs,
                    (long) ctx->testziscan_stage1_27879_total_runtime /
                    (ctx->testziscan_stage1_27879_runs !=
                     0 ? ctx->testziscan_stage1_27879_runs : 1),
                    (long) ctx->testziscan_stage1_27879_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_27879_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_27879_runs;
        str_builder(&builder,
                    "test.scan_stage1_27887                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_27887_runs,
                    (long) ctx->testziscan_stage1_27887_total_runtime /
                    (ctx->testziscan_stage1_27887_runs !=
                     0 ? ctx->testziscan_stage1_27887_runs : 1),
                    (long) ctx->testziscan_stage1_27887_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_27887_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_27887_runs;
        str_builder(&builder,
                    "test.scan_stage1_27939                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_27939_runs,
                    (long) ctx->testziscan_stage1_27939_total_runtime /
                    (ctx->testziscan_stage1_27939_runs !=
                     0 ? ctx->testziscan_stage1_27939_runs : 1),
                    (long) ctx->testziscan_stage1_27939_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_27939_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_27939_runs;
        str_builder(&builder,
                    "test.scan_stage2_27838                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_27838_runs,
                    (long) ctx->testziscan_stage2_27838_total_runtime /
                    (ctx->testziscan_stage2_27838_runs !=
                     0 ? ctx->testziscan_stage2_27838_runs : 1),
                    (long) ctx->testziscan_stage2_27838_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_27838_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_27838_runs;
        str_builder(&builder,
                    "test.scan_stage2_27871                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_27871_runs,
                    (long) ctx->testziscan_stage2_27871_total_runtime /
                    (ctx->testziscan_stage2_27871_runs !=
                     0 ? ctx->testziscan_stage2_27871_runs : 1),
                    (long) ctx->testziscan_stage2_27871_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_27871_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_27871_runs;
        str_builder(&builder,
                    "test.scan_stage2_27879                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_27879_runs,
                    (long) ctx->testziscan_stage2_27879_total_runtime /
                    (ctx->testziscan_stage2_27879_runs !=
                     0 ? ctx->testziscan_stage2_27879_runs : 1),
                    (long) ctx->testziscan_stage2_27879_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_27879_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_27879_runs;
        str_builder(&builder,
                    "test.scan_stage2_27887                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_27887_runs,
                    (long) ctx->testziscan_stage2_27887_total_runtime /
                    (ctx->testziscan_stage2_27887_runs !=
                     0 ? ctx->testziscan_stage2_27887_runs : 1),
                    (long) ctx->testziscan_stage2_27887_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_27887_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_27887_runs;
        str_builder(&builder,
                    "test.scan_stage2_27939                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_27939_runs,
                    (long) ctx->testziscan_stage2_27939_total_runtime /
                    (ctx->testziscan_stage2_27939_runs !=
                     0 ? ctx->testziscan_stage2_27939_runs : 1),
                    (long) ctx->testziscan_stage2_27939_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_27939_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_27939_runs;
        str_builder(&builder,
                    "test.scan_stage3_27838                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_27838_runs,
                    (long) ctx->testziscan_stage3_27838_total_runtime /
                    (ctx->testziscan_stage3_27838_runs !=
                     0 ? ctx->testziscan_stage3_27838_runs : 1),
                    (long) ctx->testziscan_stage3_27838_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_27838_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_27838_runs;
        str_builder(&builder,
                    "test.scan_stage3_27871                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_27871_runs,
                    (long) ctx->testziscan_stage3_27871_total_runtime /
                    (ctx->testziscan_stage3_27871_runs !=
                     0 ? ctx->testziscan_stage3_27871_runs : 1),
                    (long) ctx->testziscan_stage3_27871_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_27871_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_27871_runs;
        str_builder(&builder,
                    "test.scan_stage3_27879                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_27879_runs,
                    (long) ctx->testziscan_stage3_27879_total_runtime /
                    (ctx->testziscan_stage3_27879_runs !=
                     0 ? ctx->testziscan_stage3_27879_runs : 1),
                    (long) ctx->testziscan_stage3_27879_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_27879_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_27879_runs;
        str_builder(&builder,
                    "test.scan_stage3_27887                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_27887_runs,
                    (long) ctx->testziscan_stage3_27887_total_runtime /
                    (ctx->testziscan_stage3_27887_runs !=
                     0 ? ctx->testziscan_stage3_27887_runs : 1),
                    (long) ctx->testziscan_stage3_27887_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_27887_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_27887_runs;
        str_builder(&builder,
                    "test.scan_stage3_27939                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_27939_runs,
                    (long) ctx->testziscan_stage3_27939_total_runtime /
                    (ctx->testziscan_stage3_27939_runs !=
                     0 ? ctx->testziscan_stage3_27939_runs : 1),
                    (long) ctx->testziscan_stage3_27939_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_27939_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_27939_runs;
        str_builder(&builder,
                    "test.seghist_global_27856             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziseghist_global_27856_runs,
                    (long) ctx->testziseghist_global_27856_total_runtime /
                    (ctx->testziseghist_global_27856_runs !=
                     0 ? ctx->testziseghist_global_27856_runs : 1),
                    (long) ctx->testziseghist_global_27856_total_runtime);
        ctx->total_runtime += ctx->testziseghist_global_27856_total_runtime;
        ctx->total_runs += ctx->testziseghist_global_27856_runs;
        str_builder(&builder,
                    "test.seghist_local_27856              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziseghist_local_27856_runs,
                    (long) ctx->testziseghist_local_27856_total_runtime /
                    (ctx->testziseghist_local_27856_runs !=
                     0 ? ctx->testziseghist_local_27856_runs : 1),
                    (long) ctx->testziseghist_local_27856_total_runtime);
        ctx->total_runtime += ctx->testziseghist_local_27856_total_runtime;
        ctx->total_runs += ctx->testziseghist_local_27856_runs;
        str_builder(&builder,
                    "test.segmap_27011                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_27011_runs,
                    (long) ctx->testzisegmap_27011_total_runtime /
                    (ctx->testzisegmap_27011_runs !=
                     0 ? ctx->testzisegmap_27011_runs : 1),
                    (long) ctx->testzisegmap_27011_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_27011_total_runtime;
        ctx->total_runs += ctx->testzisegmap_27011_runs;
        str_builder(&builder,
                    "test.segmap_27187                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_27187_runs,
                    (long) ctx->testzisegmap_27187_total_runtime /
                    (ctx->testzisegmap_27187_runs !=
                     0 ? ctx->testzisegmap_27187_runs : 1),
                    (long) ctx->testzisegmap_27187_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_27187_total_runtime;
        ctx->total_runs += ctx->testzisegmap_27187_runs;
        str_builder(&builder,
                    "test.segmap_27486                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_27486_runs,
                    (long) ctx->testzisegmap_27486_total_runtime /
                    (ctx->testzisegmap_27486_runs !=
                     0 ? ctx->testzisegmap_27486_runs : 1),
                    (long) ctx->testzisegmap_27486_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_27486_total_runtime;
        ctx->total_runs += ctx->testzisegmap_27486_runs;
        str_builder(&builder,
                    "test.segmap_27584                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_27584_runs,
                    (long) ctx->testzisegmap_27584_total_runtime /
                    (ctx->testzisegmap_27584_runs !=
                     0 ? ctx->testzisegmap_27584_runs : 1),
                    (long) ctx->testzisegmap_27584_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_27584_total_runtime;
        ctx->total_runs += ctx->testzisegmap_27584_runs;
        str_builder(&builder,
                    "test.segmap_27648                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_27648_runs,
                    (long) ctx->testzisegmap_27648_total_runtime /
                    (ctx->testzisegmap_27648_runs !=
                     0 ? ctx->testzisegmap_27648_runs : 1),
                    (long) ctx->testzisegmap_27648_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_27648_total_runtime;
        ctx->total_runs += ctx->testzisegmap_27648_runs;
        str_builder(&builder,
                    "test.segmap_27941                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_27941_runs,
                    (long) ctx->testzisegmap_27941_total_runtime /
                    (ctx->testzisegmap_27941_runs !=
                     0 ? ctx->testzisegmap_27941_runs : 1),
                    (long) ctx->testzisegmap_27941_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_27941_total_runtime;
        ctx->total_runs += ctx->testzisegmap_27941_runs;
        str_builder(&builder,
                    "test.segmap_27979                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_27979_runs,
                    (long) ctx->testzisegmap_27979_total_runtime /
                    (ctx->testzisegmap_27979_runs !=
                     0 ? ctx->testzisegmap_27979_runs : 1),
                    (long) ctx->testzisegmap_27979_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_27979_total_runtime;
        ctx->total_runs += ctx->testzisegmap_27979_runs;
        str_builder(&builder,
                    "test.segmap_28004                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_28004_runs,
                    (long) ctx->testzisegmap_28004_total_runtime /
                    (ctx->testzisegmap_28004_runs !=
                     0 ? ctx->testzisegmap_28004_runs : 1),
                    (long) ctx->testzisegmap_28004_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_28004_total_runtime;
        ctx->total_runs += ctx->testzisegmap_28004_runs;
        str_builder(&builder,
                    "test.segred_large_28020               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_large_28020_runs,
                    (long) ctx->testzisegred_large_28020_total_runtime /
                    (ctx->testzisegred_large_28020_runs !=
                     0 ? ctx->testzisegred_large_28020_runs : 1),
                    (long) ctx->testzisegred_large_28020_total_runtime);
        ctx->total_runtime += ctx->testzisegred_large_28020_total_runtime;
        ctx->total_runs += ctx->testzisegred_large_28020_runs;
        str_builder(&builder,
                    "test.segred_large_28820               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_large_28820_runs,
                    (long) ctx->testzisegred_large_28820_total_runtime /
                    (ctx->testzisegred_large_28820_runs !=
                     0 ? ctx->testzisegred_large_28820_runs : 1),
                    (long) ctx->testzisegred_large_28820_total_runtime);
        ctx->total_runtime += ctx->testzisegred_large_28820_total_runtime;
        ctx->total_runs += ctx->testzisegred_large_28820_runs;
        str_builder(&builder,
                    "test.segred_nonseg_26997              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_26997_runs,
                    (long) ctx->testzisegred_nonseg_26997_total_runtime /
                    (ctx->testzisegred_nonseg_26997_runs !=
                     0 ? ctx->testzisegred_nonseg_26997_runs : 1),
                    (long) ctx->testzisegred_nonseg_26997_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_26997_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_26997_runs;
        str_builder(&builder,
                    "test.segred_nonseg_27848              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_27848_runs,
                    (long) ctx->testzisegred_nonseg_27848_total_runtime /
                    (ctx->testzisegred_nonseg_27848_runs !=
                     0 ? ctx->testzisegred_nonseg_27848_runs : 1),
                    (long) ctx->testzisegred_nonseg_27848_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_27848_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_27848_runs;
        str_builder(&builder,
                    "test.segred_nonseg_27957              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_27957_runs,
                    (long) ctx->testzisegred_nonseg_27957_total_runtime /
                    (ctx->testzisegred_nonseg_27957_runs !=
                     0 ? ctx->testzisegred_nonseg_27957_runs : 1),
                    (long) ctx->testzisegred_nonseg_27957_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_27957_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_27957_runs;
        str_builder(&builder,
                    "test.segred_nonseg_28053              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_28053_runs,
                    (long) ctx->testzisegred_nonseg_28053_total_runtime /
                    (ctx->testzisegred_nonseg_28053_runs !=
                     0 ? ctx->testzisegred_nonseg_28053_runs : 1),
                    (long) ctx->testzisegred_nonseg_28053_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_28053_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_28053_runs;
        str_builder(&builder,
                    "test.segred_nonseg_28441              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_28441_runs,
                    (long) ctx->testzisegred_nonseg_28441_total_runtime /
                    (ctx->testzisegred_nonseg_28441_runs !=
                     0 ? ctx->testzisegred_nonseg_28441_runs : 1),
                    (long) ctx->testzisegred_nonseg_28441_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_28441_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_28441_runs;
        str_builder(&builder,
                    "test.segred_nonseg_28473              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_28473_runs,
                    (long) ctx->testzisegred_nonseg_28473_total_runtime /
                    (ctx->testzisegred_nonseg_28473_runs !=
                     0 ? ctx->testzisegred_nonseg_28473_runs : 1),
                    (long) ctx->testzisegred_nonseg_28473_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_28473_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_28473_runs;
        str_builder(&builder,
                    "test.segred_small_28020               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_small_28020_runs,
                    (long) ctx->testzisegred_small_28020_total_runtime /
                    (ctx->testzisegred_small_28020_runs !=
                     0 ? ctx->testzisegred_small_28020_runs : 1),
                    (long) ctx->testzisegred_small_28020_total_runtime);
        ctx->total_runtime += ctx->testzisegred_small_28020_total_runtime;
        ctx->total_runs += ctx->testzisegred_small_28020_runs;
        str_builder(&builder,
                    "test.segred_small_28820               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_small_28820_runs,
                    (long) ctx->testzisegred_small_28820_total_runtime /
                    (ctx->testzisegred_small_28820_runs !=
                     0 ? ctx->testzisegred_small_28820_runs : 1),
                    (long) ctx->testzisegred_small_28820_total_runtime);
        ctx->total_runtime += ctx->testzisegred_small_28820_total_runtime;
        ctx->total_runs += ctx->testzisegred_small_28820_runs;
        str_builder(&builder, "%d operations with cumulative runtime: %6ldus\n",
                    ctx->total_runs, ctx->total_runtime);
    }
    return builder.str;
}
char *futhark_context_get_error(struct futhark_context *ctx)
{
    char *error = ctx->error;
    
    ctx->error = NULL;
    return error;
}
void futhark_context_pause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 1;
}
void futhark_context_unpause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 0;
}
static int futrts_builtinzhgpu_map_transpose_f32(struct futhark_context *ctx,
                                                 struct memblock_device destmem_0,
                                                 int32_t destoffset_1,
                                                 struct memblock_device srcmem_2,
                                                 int32_t srcoffset_3,
                                                 int32_t num_arrays_4,
                                                 int32_t x_elems_5,
                                                 int32_t y_elems_6);
static int futrts_builtinzhreplicate_f32(struct futhark_context *ctx,
                                         struct memblock_device mem_29133,
                                         int32_t num_elems_29134,
                                         float val_29135);
static int futrts_builtinzhreplicate_i64(struct futhark_context *ctx,
                                         struct memblock_device mem_28725,
                                         int32_t num_elems_28726,
                                         int64_t val_28727);
static int futrts_main(struct futhark_context *ctx, float *out_scalar_out_29311,
                       struct memblock_device *out_mem_p_29312,
                       int64_t *out_out_arrsizze_29313,
                       struct memblock_device swap_term_mem_28181,
                       struct memblock_device payments_mem_28182,
                       struct memblock_device notional_mem_28183,
                       int64_t n_24721, int64_t n_24722, int64_t n_24723,
                       int64_t paths_24724, int64_t steps_24725, float a_24729,
                       float b_24730, float sigma_24731, float r0_24732);
static int futrts_test(struct futhark_context *ctx, float *out_scalar_out_29506,
                       int64_t paths_25438, int64_t steps_25439);
int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    
  cleanup:
    return err;
}
int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    return 0;
}
static int futrts_builtinzhgpu_map_transpose_f32(struct futhark_context *ctx,
                                                 struct memblock_device destmem_0,
                                                 int32_t destoffset_1,
                                                 struct memblock_device srcmem_2,
                                                 int32_t srcoffset_3,
                                                 int32_t num_arrays_4,
                                                 int32_t x_elems_5,
                                                 int32_t y_elems_6)
{
    (void) ctx;
    
    int err = 0;
    
    if (!(num_arrays_4 == 0 || (x_elems_5 == 0 || y_elems_6 == 0))) {
        int32_t muly_8 = squot32(16, x_elems_5);
        int32_t mulx_7 = squot32(16, y_elems_6);
        
        if (num_arrays_4 == 1 && (x_elems_5 == 1 || y_elems_6 == 1)) {
            if (sext_i32_i64(x_elems_5 * y_elems_6 * (int32_t) sizeof(float)) >
                0) {
                OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                             srcmem_2.mem,
                                                             destmem_0.mem,
                                                             sext_i32_i64(srcoffset_3),
                                                             sext_i32_i64(destoffset_1),
                                                             sext_i32_i64(x_elems_5 *
                                                             y_elems_6 *
                                                             (int32_t) sizeof(float)),
                                                             0, NULL,
                                                             ctx->profiling_paused ||
                                                             !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                       &ctx->copy_dev_to_dev_runs,
                                                                                                       &ctx->copy_dev_to_dev_total_runtime)));
                if (ctx->debugging)
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            }
        } else {
            if (sle32(x_elems_5, 8) && slt32(16, y_elems_6)) {
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        0, 1088, NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        1, sizeof(destoffset_1),
                                                        &destoffset_1));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        2, sizeof(srcoffset_3),
                                                        &srcoffset_3));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        3, sizeof(num_arrays_4),
                                                        &num_arrays_4));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        4, sizeof(x_elems_5),
                                                        &x_elems_5));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        5, sizeof(y_elems_6),
                                                        &y_elems_6));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        6, sizeof(mulx_7),
                                                        &mulx_7));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        7, sizeof(muly_8),
                                                        &muly_8));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        8,
                                                        sizeof(destmem_0.mem),
                                                        &destmem_0.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        9, sizeof(srcmem_2.mem),
                                                        &srcmem_2.mem));
                if (1 * ((size_t) sdiv_up32(x_elems_5, 16) * (size_t) 16) *
                    ((size_t) sdiv_up32(sdiv_up32(y_elems_6, muly_8), 16) *
                     (size_t) 16) * ((size_t) num_arrays_4 * (size_t) 1) != 0) {
                    const size_t global_work_sizze_29281[3] =
                                 {(size_t) sdiv_up32(x_elems_5, 16) *
                                  (size_t) 16,
                                  (size_t) sdiv_up32(sdiv_up32(y_elems_6,
                                                               muly_8), 16) *
                                  (size_t) 16, (size_t) num_arrays_4 *
                                  (size_t) 1};
                    const size_t local_work_sizze_29285[3] = {16, 16, 1};
                    int64_t time_start_29282 = 0, time_end_29283 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "gpu_map_transpose_f32_low_width");
                        fprintf(stderr, "%zu", global_work_sizze_29281[0]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", global_work_sizze_29281[1]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", global_work_sizze_29281[2]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29285[0]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", local_work_sizze_29285[1]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", local_work_sizze_29285[2]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + 1088));
                        time_start_29282 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->gpu_map_transpose_f32_low_width,
                                                                    3, NULL,
                                                                    global_work_sizze_29281,
                                                                    local_work_sizze_29285,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->gpu_map_transpose_f32_low_width_runs,
                                                                                                              &ctx->gpu_map_transpose_f32_low_width_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29283 = get_wall_time();
                        
                        long time_diff_29284 = time_end_29283 -
                             time_start_29282;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "gpu_map_transpose_f32_low_width",
                                time_diff_29284);
                    }
                }
            } else {
                if (sle32(y_elems_6, 8) && slt32(16, x_elems_5)) {
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            0, 1088, NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            1,
                                                            sizeof(destoffset_1),
                                                            &destoffset_1));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            2,
                                                            sizeof(srcoffset_3),
                                                            &srcoffset_3));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            3,
                                                            sizeof(num_arrays_4),
                                                            &num_arrays_4));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            4,
                                                            sizeof(x_elems_5),
                                                            &x_elems_5));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            5,
                                                            sizeof(y_elems_6),
                                                            &y_elems_6));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            6, sizeof(mulx_7),
                                                            &mulx_7));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            7, sizeof(muly_8),
                                                            &muly_8));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            8,
                                                            sizeof(destmem_0.mem),
                                                            &destmem_0.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            9,
                                                            sizeof(srcmem_2.mem),
                                                            &srcmem_2.mem));
                    if (1 * ((size_t) sdiv_up32(sdiv_up32(x_elems_5, mulx_7),
                                                16) * (size_t) 16) *
                        ((size_t) sdiv_up32(y_elems_6, 16) * (size_t) 16) *
                        ((size_t) num_arrays_4 * (size_t) 1) != 0) {
                        const size_t global_work_sizze_29286[3] =
                                     {(size_t) sdiv_up32(sdiv_up32(x_elems_5,
                                                                   mulx_7),
                                                         16) * (size_t) 16,
                                      (size_t) sdiv_up32(y_elems_6, 16) *
                                      (size_t) 16, (size_t) num_arrays_4 *
                                      (size_t) 1};
                        const size_t local_work_sizze_29290[3] = {16, 16, 1};
                        int64_t time_start_29287 = 0, time_end_29288 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "gpu_map_transpose_f32_low_height");
                            fprintf(stderr, "%zu", global_work_sizze_29286[0]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", global_work_sizze_29286[1]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", global_work_sizze_29286[2]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29290[0]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", local_work_sizze_29290[1]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", local_work_sizze_29290[2]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + 1088));
                            time_start_29287 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->gpu_map_transpose_f32_low_height,
                                                                        3, NULL,
                                                                        global_work_sizze_29286,
                                                                        local_work_sizze_29290,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->gpu_map_transpose_f32_low_height_runs,
                                                                                                                  &ctx->gpu_map_transpose_f32_low_height_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29288 = get_wall_time();
                            
                            long time_diff_29289 = time_end_29288 -
                                 time_start_29287;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "gpu_map_transpose_f32_low_height",
                                    time_diff_29289);
                        }
                    }
                } else {
                    if (sle32(x_elems_5, 8) && sle32(y_elems_6, 8)) {
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                0, 1, NULL));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                1,
                                                                sizeof(destoffset_1),
                                                                &destoffset_1));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                2,
                                                                sizeof(srcoffset_3),
                                                                &srcoffset_3));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                3,
                                                                sizeof(num_arrays_4),
                                                                &num_arrays_4));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                4,
                                                                sizeof(x_elems_5),
                                                                &x_elems_5));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                5,
                                                                sizeof(y_elems_6),
                                                                &y_elems_6));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                6,
                                                                sizeof(mulx_7),
                                                                &mulx_7));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                7,
                                                                sizeof(muly_8),
                                                                &muly_8));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                8,
                                                                sizeof(destmem_0.mem),
                                                                &destmem_0.mem));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                9,
                                                                sizeof(srcmem_2.mem),
                                                                &srcmem_2.mem));
                        if (1 * ((size_t) sdiv_up32(num_arrays_4 * x_elems_5 *
                                                    y_elems_6, 256) *
                                 (size_t) 256) != 0) {
                            const size_t global_work_sizze_29291[1] =
                                         {(size_t) sdiv_up32(num_arrays_4 *
                                                             x_elems_5 *
                                                             y_elems_6, 256) *
                                         (size_t) 256};
                            const size_t local_work_sizze_29295[1] = {256};
                            int64_t time_start_29292 = 0, time_end_29293 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(stderr,
                                        "Launching %s with global work size [",
                                        "gpu_map_transpose_f32_small");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_29291[0]);
                                fprintf(stderr, "] and local work size [");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_29295[0]);
                                fprintf(stderr,
                                        "]; local memory parameters sum to %d bytes.\n",
                                        (int) (0 + 1));
                                time_start_29292 = get_wall_time();
                            }
                            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                            ctx->gpu_map_transpose_f32_small,
                                                                            1,
                                                                            NULL,
                                                                            global_work_sizze_29291,
                                                                            local_work_sizze_29295,
                                                                            0,
                                                                            NULL,
                                                                            ctx->profiling_paused ||
                                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                      &ctx->gpu_map_transpose_f32_small_runs,
                                                                                                                      &ctx->gpu_map_transpose_f32_small_total_runtime)));
                            if (ctx->debugging) {
                                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                                time_end_29293 = get_wall_time();
                                
                                long time_diff_29294 = time_end_29293 -
                                     time_start_29292;
                                
                                fprintf(stderr, "kernel %s runtime: %ldus\n",
                                        "gpu_map_transpose_f32_small",
                                        time_diff_29294);
                            }
                        }
                    } else {
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                0, 4224, NULL));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                1,
                                                                sizeof(destoffset_1),
                                                                &destoffset_1));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                2,
                                                                sizeof(srcoffset_3),
                                                                &srcoffset_3));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                3,
                                                                sizeof(num_arrays_4),
                                                                &num_arrays_4));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                4,
                                                                sizeof(x_elems_5),
                                                                &x_elems_5));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                5,
                                                                sizeof(y_elems_6),
                                                                &y_elems_6));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                6,
                                                                sizeof(mulx_7),
                                                                &mulx_7));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                7,
                                                                sizeof(muly_8),
                                                                &muly_8));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                8,
                                                                sizeof(destmem_0.mem),
                                                                &destmem_0.mem));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                9,
                                                                sizeof(srcmem_2.mem),
                                                                &srcmem_2.mem));
                        if (1 * ((size_t) sdiv_up32(x_elems_5, 32) *
                                 (size_t) 32) * ((size_t) sdiv_up32(y_elems_6,
                                                                    32) *
                                                 (size_t) 8) *
                            ((size_t) num_arrays_4 * (size_t) 1) != 0) {
                            const size_t global_work_sizze_29296[3] =
                                         {(size_t) sdiv_up32(x_elems_5, 32) *
                                          (size_t) 32,
                                          (size_t) sdiv_up32(y_elems_6, 32) *
                                          (size_t) 8, (size_t) num_arrays_4 *
                                          (size_t) 1};
                            const size_t local_work_sizze_29300[3] = {32, 8, 1};
                            int64_t time_start_29297 = 0, time_end_29298 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(stderr,
                                        "Launching %s with global work size [",
                                        "gpu_map_transpose_f32");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_29296[0]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_29296[1]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_29296[2]);
                                fprintf(stderr, "] and local work size [");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_29300[0]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_29300[1]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_29300[2]);
                                fprintf(stderr,
                                        "]; local memory parameters sum to %d bytes.\n",
                                        (int) (0 + 4224));
                                time_start_29297 = get_wall_time();
                            }
                            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                            ctx->gpu_map_transpose_f32,
                                                                            3,
                                                                            NULL,
                                                                            global_work_sizze_29296,
                                                                            local_work_sizze_29300,
                                                                            0,
                                                                            NULL,
                                                                            ctx->profiling_paused ||
                                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                      &ctx->gpu_map_transpose_f32_runs,
                                                                                                                      &ctx->gpu_map_transpose_f32_total_runtime)));
                            if (ctx->debugging) {
                                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                                time_end_29298 = get_wall_time();
                                
                                long time_diff_29299 = time_end_29298 -
                                     time_start_29297;
                                
                                fprintf(stderr, "kernel %s runtime: %ldus\n",
                                        "gpu_map_transpose_f32",
                                        time_diff_29299);
                            }
                        }
                    }
                }
            }
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_builtinzhreplicate_f32(struct futhark_context *ctx,
                                         struct memblock_device mem_29133,
                                         int32_t num_elems_29134,
                                         float val_29135)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_29140;
    
    group_sizze_29140 = ctx->sizes.builtinzhreplicate_f32zigroup_sizze_29140;
    
    int64_t num_groups_29141;
    
    num_groups_29141 = sdiv_up64(num_elems_29134, group_sizze_29140);
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_f32zireplicate_29137,
                                            0, sizeof(mem_29133.mem),
                                            &mem_29133.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_f32zireplicate_29137,
                                            1, sizeof(num_elems_29134),
                                            &num_elems_29134));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_f32zireplicate_29137,
                                            2, sizeof(val_29135), &val_29135));
    if (1 * ((size_t) num_groups_29141 * (size_t) group_sizze_29140) != 0) {
        const size_t global_work_sizze_29301[1] = {(size_t) num_groups_29141 *
                     (size_t) group_sizze_29140};
        const size_t local_work_sizze_29305[1] = {group_sizze_29140};
        int64_t time_start_29302 = 0, time_end_29303 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "builtin#replicate_f32.replicate_29137");
            fprintf(stderr, "%zu", global_work_sizze_29301[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_29305[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_29302 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->builtinzhreplicate_f32zireplicate_29137,
                                                        1, NULL,
                                                        global_work_sizze_29301,
                                                        local_work_sizze_29305,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->builtinzhreplicate_f32zireplicate_29137_runs,
                                                                                                  &ctx->builtinzhreplicate_f32zireplicate_29137_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_29303 = get_wall_time();
            
            long time_diff_29304 = time_end_29303 - time_start_29302;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "builtin#replicate_f32.replicate_29137", time_diff_29304);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_builtinzhreplicate_i64(struct futhark_context *ctx,
                                         struct memblock_device mem_28725,
                                         int32_t num_elems_28726,
                                         int64_t val_28727)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_28732;
    
    group_sizze_28732 = ctx->sizes.builtinzhreplicate_i64zigroup_sizze_28732;
    
    int64_t num_groups_28733;
    
    num_groups_28733 = sdiv_up64(num_elems_28726, group_sizze_28732);
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_i64zireplicate_28729,
                                            0, sizeof(mem_28725.mem),
                                            &mem_28725.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_i64zireplicate_28729,
                                            1, sizeof(num_elems_28726),
                                            &num_elems_28726));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_i64zireplicate_28729,
                                            2, sizeof(val_28727), &val_28727));
    if (1 * ((size_t) num_groups_28733 * (size_t) group_sizze_28732) != 0) {
        const size_t global_work_sizze_29306[1] = {(size_t) num_groups_28733 *
                     (size_t) group_sizze_28732};
        const size_t local_work_sizze_29310[1] = {group_sizze_28732};
        int64_t time_start_29307 = 0, time_end_29308 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "builtin#replicate_i64.replicate_28729");
            fprintf(stderr, "%zu", global_work_sizze_29306[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_29310[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_29307 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->builtinzhreplicate_i64zireplicate_28729,
                                                        1, NULL,
                                                        global_work_sizze_29306,
                                                        local_work_sizze_29310,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->builtinzhreplicate_i64zireplicate_28729_runs,
                                                                                                  &ctx->builtinzhreplicate_i64zireplicate_28729_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_29308 = get_wall_time();
            
            long time_diff_29309 = time_end_29308 - time_start_29307;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "builtin#replicate_i64.replicate_28729", time_diff_29309);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_main(struct futhark_context *ctx, float *out_scalar_out_29311,
                       struct memblock_device *out_mem_p_29312,
                       int64_t *out_out_arrsizze_29313,
                       struct memblock_device swap_term_mem_28181,
                       struct memblock_device payments_mem_28182,
                       struct memblock_device notional_mem_28183,
                       int64_t n_24721, int64_t n_24722, int64_t n_24723,
                       int64_t paths_24724, int64_t steps_24725, float a_24729,
                       float b_24730, float sigma_24731, float r0_24732)
{
    (void) ctx;
    
    int err = 0;
    float scalar_out_28506;
    struct memblock_device out_mem_28507;
    
    out_mem_28507.references = NULL;
    
    int64_t out_arrsizze_28508;
    bool dim_match_24733 = n_24721 == n_24722;
    bool empty_or_match_cert_24734;
    
    if (!dim_match_24733) {
        ctx->error = msgprintf("Error: %s\n\nBacktrace:\n%s",
                               "function arguments of wrong shape",
                               "-> #0  cva.fut:100:1-165:21\n");
        if (memblock_unref_device(ctx, &out_mem_28507, "out_mem_28507") != 0)
            return 1;
        return 1;
    }
    
    int64_t segred_group_sizze_25878;
    
    segred_group_sizze_25878 = ctx->sizes.mainzisegred_group_sizze_25877;
    
    int64_t num_groups_25880;
    int32_t max_num_groups_28509;
    
    max_num_groups_28509 = ctx->sizes.mainzisegred_num_groups_25879;
    num_groups_25880 = sext_i64_i32(smax64(1, smin64(sdiv_up64(n_24721,
                                                               sext_i32_i64(segred_group_sizze_25878)),
                                                     sext_i32_i64(max_num_groups_28509))));
    
    struct memblock_device mem_28186;
    
    mem_28186.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28186, 4, "mem_28186")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mainzicounter_mem_28510 =
                           ctx->mainzicounter_mem_28510;
    struct memblock_device group_res_arr_mem_28512;
    
    group_res_arr_mem_28512.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_28512,
                              (int32_t) sizeof(float) *
                              (segred_group_sizze_25878 * num_groups_25880),
                              "group_res_arr_mem_28512")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_28514;
    
    num_threads_28514 = num_groups_25880 * segred_group_sizze_25878;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25885, 1,
                                            (int32_t) sizeof(float) *
                                            segred_group_sizze_25878, NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25885, 2,
                                            (int32_t) sizeof(bool), NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25885, 3,
                                            sizeof(n_24721), &n_24721));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25885, 4,
                                            sizeof(num_groups_25880),
                                            &num_groups_25880));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25885, 5,
                                            sizeof(swap_term_mem_28181.mem),
                                            &swap_term_mem_28181.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25885, 6,
                                            sizeof(payments_mem_28182.mem),
                                            &payments_mem_28182.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25885, 7,
                                            sizeof(mem_28186.mem),
                                            &mem_28186.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25885, 8,
                                            sizeof(mainzicounter_mem_28510.mem),
                                            &mainzicounter_mem_28510.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25885, 9,
                                            sizeof(group_res_arr_mem_28512.mem),
                                            &group_res_arr_mem_28512.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25885, 10,
                                            sizeof(num_threads_28514),
                                            &num_threads_28514));
    if (1 * ((size_t) num_groups_25880 * (size_t) segred_group_sizze_25878) !=
        0) {
        const size_t global_work_sizze_29315[1] = {(size_t) num_groups_25880 *
                     (size_t) segred_group_sizze_25878};
        const size_t local_work_sizze_29319[1] = {segred_group_sizze_25878};
        int64_t time_start_29316 = 0, time_end_29317 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segred_nonseg_25885");
            fprintf(stderr, "%zu", global_work_sizze_29315[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_29319[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) (0 + (int32_t) sizeof(float) *
                           segred_group_sizze_25878 + (int32_t) sizeof(bool)));
            time_start_29316 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegred_nonseg_25885,
                                                        1, NULL,
                                                        global_work_sizze_29315,
                                                        local_work_sizze_29319,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegred_nonseg_25885_runs,
                                                                                                  &ctx->mainzisegred_nonseg_25885_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_29317 = get_wall_time();
            
            long time_diff_29318 = time_end_29317 - time_start_29316;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "main.segred_nonseg_25885", time_diff_29318);
        }
    }
    
    float read_res_29320;
    
    OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                 mem_28186.mem,
                                                 ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                 0 * sizeof(float),
                                                 sizeof(float), &read_res_29320,
                                                 0, NULL,
                                                 ctx->profiling_paused ||
                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                           &ctx->copy_scalar_from_dev_runs,
                                                                                           &ctx->copy_scalar_from_dev_total_runtime)));
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
        return 1;
    
    float res_24738 = read_res_29320;
    
    if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
        return 1;
    
    float res_24746 = sitofp_i64_f32(steps_24725);
    float dt_24747 = res_24738 / res_24746;
    float x_24749 = fpow32(a_24729, 2.0F);
    float x_24750 = b_24730 * x_24749;
    float x_24751 = fpow32(sigma_24731, 2.0F);
    float y_24752 = x_24751 / 2.0F;
    float y_24753 = x_24750 - y_24752;
    float y_24754 = 4.0F * a_24729;
    bool suff_outer_par_25887;
    
    suff_outer_par_25887 = ctx->sizes.mainzisuff_outer_par_0 <= n_24721;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_outer_par_0",
                n_24721);
    
    int64_t segmap_group_sizze_25977;
    
    segmap_group_sizze_25977 = ctx->sizes.mainzisegmap_group_sizze_25901;
    
    int64_t segmap_group_sizze_26153;
    
    segmap_group_sizze_26153 = ctx->sizes.mainzisegmap_group_sizze_26077;
    
    int64_t bytes_28187 = 4 * n_24721;
    int64_t bytes_28189 = 8 * n_24721;
    int64_t segred_num_groups_28353;
    
    segred_num_groups_28353 = ctx->sizes.mainzisegred_num_groups_28352;
    
    int64_t segred_group_sizze_28355;
    
    segred_group_sizze_28355 = ctx->sizes.mainzisegred_group_sizze_28354;
    
    int64_t segred_num_groups_28385;
    
    segred_num_groups_28385 = ctx->sizes.mainzisegred_num_groups_28384;
    
    int64_t segred_group_sizze_28387;
    
    segred_group_sizze_28387 = ctx->sizes.mainzisegred_group_sizze_28386;
    
    struct memblock_device res_mem_28233;
    
    res_mem_28233.references = NULL;
    
    struct memblock_device res_mem_28234;
    
    res_mem_28234.references = NULL;
    
    struct memblock_device res_mem_28235;
    
    res_mem_28235.references = NULL;
    
    struct memblock_device res_mem_28236;
    
    res_mem_28236.references = NULL;
    
    int32_t local_memory_capacity_28614;
    
    local_memory_capacity_28614 = ctx->opencl.max_local_memory;
    if ((sle64((int32_t) sizeof(bool) + (int32_t) sizeof(int64_t) *
               segred_group_sizze_28355,
               sext_i32_i64(local_memory_capacity_28614)) && sle64(0,
                                                                   sext_i32_i64(local_memory_capacity_28614))) &&
        suff_outer_par_25887) {
        int64_t segmap_usable_groups_25978 = sdiv_up64(n_24721,
                                                       segmap_group_sizze_25977);
        struct memblock_device mem_28188;
        
        mem_28188.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28188, bytes_28187, "mem_28188")) {
            err = 1;
            goto cleanup;
        }
        if (n_24721 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         swap_term_mem_28181.mem,
                                                         mem_28188.mem, 0, 0,
                                                         n_24721 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28190;
        
        mem_28190.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28190, bytes_28189, "mem_28190")) {
            err = 1;
            goto cleanup;
        }
        if (n_24721 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         payments_mem_28182.mem,
                                                         mem_28190.mem, 0, 0,
                                                         n_24721 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28192;
        
        mem_28192.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28192, bytes_28187, "mem_28192")) {
            err = 1;
            goto cleanup;
        }
        if (n_24721 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         notional_mem_28183.mem,
                                                         mem_28192.mem, 0, 0,
                                                         n_24721 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28209;
        
        mem_28209.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28209, bytes_28187, "mem_28209")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28343 = segmap_group_sizze_25977 *
                segmap_usable_groups_25978;
        struct memblock_device mem_28371;
        
        mem_28371.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28371, 8, "mem_28371")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mainzicounter_mem_28540 =
                               ctx->mainzicounter_mem_28540;
        struct memblock_device group_res_arr_mem_28542;
        
        group_res_arr_mem_28542.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28542,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_28355 *
                                   segred_num_groups_28353),
                                  "group_res_arr_mem_28542")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28544;
        
        num_threads_28544 = segred_num_groups_28353 * segred_group_sizze_28355;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28359,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_28355,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28359,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28359,
                                                3, sizeof(n_24721), &n_24721));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28359,
                                                4,
                                                sizeof(payments_mem_28182.mem),
                                                &payments_mem_28182.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28359,
                                                5, sizeof(mem_28371.mem),
                                                &mem_28371.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28359,
                                                6,
                                                sizeof(mainzicounter_mem_28540.mem),
                                                &mainzicounter_mem_28540.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28359,
                                                7,
                                                sizeof(group_res_arr_mem_28542.mem),
                                                &group_res_arr_mem_28542.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28359,
                                                8, sizeof(num_threads_28544),
                                                &num_threads_28544));
        if (1 * ((size_t) segred_num_groups_28353 *
                 (size_t) segred_group_sizze_28355) != 0) {
            const size_t global_work_sizze_29322[1] =
                         {(size_t) segred_num_groups_28353 *
                         (size_t) segred_group_sizze_28355};
            const size_t local_work_sizze_29326[1] = {segred_group_sizze_28355};
            int64_t time_start_29323 = 0, time_end_29324 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segred_nonseg_28359");
                fprintf(stderr, "%zu", global_work_sizze_29322[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29326[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_28355 +
                               (int32_t) sizeof(bool)));
                time_start_29323 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegred_nonseg_28359,
                                                            1, NULL,
                                                            global_work_sizze_29322,
                                                            local_work_sizze_29326,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegred_nonseg_28359_runs,
                                                                                                      &ctx->mainzisegred_nonseg_28359_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29324 = get_wall_time();
                
                long time_diff_29325 = time_end_29324 - time_start_29323;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segred_nonseg_28359", time_diff_29325);
            }
        }
        
        int64_t read_res_29327;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_28371.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_29327, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t max_per_thread_28349 = read_res_29327;
        
        if (memblock_unref_device(ctx, &mem_28371, "mem_28371") != 0)
            return 1;
        
        int64_t sizze_sum_28366 = num_threads_28343 * max_per_thread_28349;
        struct memblock_device mem_28195;
        
        mem_28195.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28195, sizze_sum_28366,
                                  "mem_28195")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25899, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25899, 3,
                                                sizeof(n_24721), &n_24721));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25899, 4,
                                                sizeof(a_24729), &a_24729));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25899, 5,
                                                sizeof(r0_24732), &r0_24732));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25899, 6,
                                                sizeof(x_24749), &x_24749));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25899, 7,
                                                sizeof(x_24751), &x_24751));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25899, 8,
                                                sizeof(y_24753), &y_24753));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25899, 9,
                                                sizeof(y_24754), &y_24754));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25899, 10,
                                                sizeof(swap_term_mem_28181.mem),
                                                &swap_term_mem_28181.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25899, 11,
                                                sizeof(payments_mem_28182.mem),
                                                &payments_mem_28182.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25899, 12,
                                                sizeof(mem_28195.mem),
                                                &mem_28195.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25899, 13,
                                                sizeof(mem_28209.mem),
                                                &mem_28209.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25899, 14,
                                                sizeof(num_threads_28343),
                                                &num_threads_28343));
        if (1 * ((size_t) segmap_usable_groups_25978 *
                 (size_t) segmap_group_sizze_25977) != 0) {
            const size_t global_work_sizze_29328[1] =
                         {(size_t) segmap_usable_groups_25978 *
                         (size_t) segmap_group_sizze_25977};
            const size_t local_work_sizze_29332[1] = {segmap_group_sizze_25977};
            int64_t time_start_29329 = 0, time_end_29330 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_25899");
                fprintf(stderr, "%zu", global_work_sizze_29328[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29332[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29329 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_25899,
                                                            1, NULL,
                                                            global_work_sizze_29328,
                                                            local_work_sizze_29332,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_25899_runs,
                                                                                                      &ctx->mainzisegmap_25899_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29330 = get_wall_time();
                
                long time_diff_29331 = time_end_29330 - time_start_29329;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_25899", time_diff_29331);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_28195, "mem_28195") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28233, &mem_28209, "mem_28209") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28234, &mem_28192, "mem_28192") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28235, &mem_28190, "mem_28190") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28236, &mem_28188, "mem_28188") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28195, "mem_28195") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28542,
                                  "group_res_arr_mem_28542") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28371, "mem_28371") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28209, "mem_28209") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28192, "mem_28192") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28190, "mem_28190") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28188, "mem_28188") != 0)
            return 1;
    } else {
        int64_t segmap_usable_groups_26154 = sdiv_up64(n_24721,
                                                       segmap_group_sizze_26153);
        struct memblock_device mem_28211;
        
        mem_28211.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28211, bytes_28187, "mem_28211")) {
            err = 1;
            goto cleanup;
        }
        if (n_24721 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         swap_term_mem_28181.mem,
                                                         mem_28211.mem, 0, 0,
                                                         n_24721 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28213;
        
        mem_28213.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28213, bytes_28189, "mem_28213")) {
            err = 1;
            goto cleanup;
        }
        if (n_24721 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         payments_mem_28182.mem,
                                                         mem_28213.mem, 0, 0,
                                                         n_24721 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28215;
        
        mem_28215.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28215, bytes_28187, "mem_28215")) {
            err = 1;
            goto cleanup;
        }
        if (n_24721 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         notional_mem_28183.mem,
                                                         mem_28215.mem, 0, 0,
                                                         n_24721 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28232;
        
        mem_28232.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28232, bytes_28187, "mem_28232")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28375 = segmap_group_sizze_26153 *
                segmap_usable_groups_26154;
        struct memblock_device mem_28403;
        
        mem_28403.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28403, 8, "mem_28403")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mainzicounter_mem_28577 =
                               ctx->mainzicounter_mem_28577;
        struct memblock_device group_res_arr_mem_28579;
        
        group_res_arr_mem_28579.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28579,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_28387 *
                                   segred_num_groups_28385),
                                  "group_res_arr_mem_28579")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28581;
        
        num_threads_28581 = segred_num_groups_28385 * segred_group_sizze_28387;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28391,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_28387,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28391,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28391,
                                                3, sizeof(n_24721), &n_24721));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28391,
                                                4,
                                                sizeof(payments_mem_28182.mem),
                                                &payments_mem_28182.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28391,
                                                5, sizeof(mem_28403.mem),
                                                &mem_28403.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28391,
                                                6,
                                                sizeof(mainzicounter_mem_28577.mem),
                                                &mainzicounter_mem_28577.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28391,
                                                7,
                                                sizeof(group_res_arr_mem_28579.mem),
                                                &group_res_arr_mem_28579.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_28391,
                                                8, sizeof(num_threads_28581),
                                                &num_threads_28581));
        if (1 * ((size_t) segred_num_groups_28385 *
                 (size_t) segred_group_sizze_28387) != 0) {
            const size_t global_work_sizze_29334[1] =
                         {(size_t) segred_num_groups_28385 *
                         (size_t) segred_group_sizze_28387};
            const size_t local_work_sizze_29338[1] = {segred_group_sizze_28387};
            int64_t time_start_29335 = 0, time_end_29336 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segred_nonseg_28391");
                fprintf(stderr, "%zu", global_work_sizze_29334[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29338[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_28387 +
                               (int32_t) sizeof(bool)));
                time_start_29335 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegred_nonseg_28391,
                                                            1, NULL,
                                                            global_work_sizze_29334,
                                                            local_work_sizze_29338,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegred_nonseg_28391_runs,
                                                                                                      &ctx->mainzisegred_nonseg_28391_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29336 = get_wall_time();
                
                long time_diff_29337 = time_end_29336 - time_start_29335;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segred_nonseg_28391", time_diff_29337);
            }
        }
        
        int64_t read_res_29339;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_28403.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_29339, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t max_per_thread_28381 = read_res_29339;
        
        if (memblock_unref_device(ctx, &mem_28403, "mem_28403") != 0)
            return 1;
        
        int64_t sizze_sum_28398 = num_threads_28375 * max_per_thread_28381;
        struct memblock_device mem_28218;
        
        mem_28218.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28218, sizze_sum_28398,
                                  "mem_28218")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26075, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26075, 3,
                                                sizeof(n_24721), &n_24721));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26075, 4,
                                                sizeof(a_24729), &a_24729));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26075, 5,
                                                sizeof(r0_24732), &r0_24732));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26075, 6,
                                                sizeof(x_24749), &x_24749));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26075, 7,
                                                sizeof(x_24751), &x_24751));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26075, 8,
                                                sizeof(y_24753), &y_24753));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26075, 9,
                                                sizeof(y_24754), &y_24754));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26075, 10,
                                                sizeof(swap_term_mem_28181.mem),
                                                &swap_term_mem_28181.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26075, 11,
                                                sizeof(payments_mem_28182.mem),
                                                &payments_mem_28182.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26075, 12,
                                                sizeof(mem_28218.mem),
                                                &mem_28218.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26075, 13,
                                                sizeof(mem_28232.mem),
                                                &mem_28232.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26075, 14,
                                                sizeof(num_threads_28375),
                                                &num_threads_28375));
        if (1 * ((size_t) segmap_usable_groups_26154 *
                 (size_t) segmap_group_sizze_26153) != 0) {
            const size_t global_work_sizze_29340[1] =
                         {(size_t) segmap_usable_groups_26154 *
                         (size_t) segmap_group_sizze_26153};
            const size_t local_work_sizze_29344[1] = {segmap_group_sizze_26153};
            int64_t time_start_29341 = 0, time_end_29342 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_26075");
                fprintf(stderr, "%zu", global_work_sizze_29340[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29344[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29341 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_26075,
                                                            1, NULL,
                                                            global_work_sizze_29340,
                                                            local_work_sizze_29344,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_26075_runs,
                                                                                                      &ctx->mainzisegmap_26075_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29342 = get_wall_time();
                
                long time_diff_29343 = time_end_29342 - time_start_29341;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_26075", time_diff_29343);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_28218, "mem_28218") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28233, &mem_28232, "mem_28232") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28234, &mem_28215, "mem_28215") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28235, &mem_28213, "mem_28213") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28236, &mem_28211, "mem_28211") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28218, "mem_28218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28579,
                                  "group_res_arr_mem_28579") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28403, "mem_28403") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28232, "mem_28232") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28215, "mem_28215") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28213, "mem_28213") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28211, "mem_28211") != 0)
            return 1;
    }
    
    float sims_per_year_24831 = res_24746 / res_24738;
    bool bounds_invalid_upwards_24832 = slt64(steps_24725, 1);
    bool valid_24833 = !bounds_invalid_upwards_24832;
    bool range_valid_c_24834;
    
    if (!valid_24833) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 1, "..", 2, "...", steps_24725,
                               " is invalid.",
                               "-> #0  cva.fut:60:56-67\n   #1  cva.fut:111:17-44\n   #2  cva.fut:100:1-165:21\n");
        if (memblock_unref_device(ctx, &res_mem_28236, "res_mem_28236") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28235, "res_mem_28235") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28234, "res_mem_28234") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28233, "res_mem_28233") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28512,
                                  "group_res_arr_mem_28512") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_28507, "out_mem_28507") != 0)
            return 1;
        return 1;
    }
    
    bool bounds_invalid_upwards_24836 = slt64(paths_24724, 0);
    bool valid_24837 = !bounds_invalid_upwards_24836;
    bool range_valid_c_24838;
    
    if (!valid_24837) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", paths_24724,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:126:11-16\n   #2  lib/github.com/diku-dk/cpprandom/random.fut:174:8-56\n   #3  cva.fut:115:19-49\n   #4  cva.fut:100:1-165:21\n");
        if (memblock_unref_device(ctx, &res_mem_28236, "res_mem_28236") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28235, "res_mem_28235") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28234, "res_mem_28234") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28233, "res_mem_28233") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28512,
                                  "group_res_arr_mem_28512") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_28507, "out_mem_28507") != 0)
            return 1;
        return 1;
    }
    
    int64_t upper_bound_24841 = sub64(steps_24725, 1);
    float res_24842;
    
    res_24842 = futrts_sqrt32(dt_24747);
    
    int64_t segmap_group_sizze_26555;
    
    segmap_group_sizze_26555 = ctx->sizes.mainzisegmap_group_sizze_26538;
    
    int64_t segmap_usable_groups_26556 = sdiv_up64(paths_24724,
                                                   segmap_group_sizze_26555);
    int64_t bytes_28238 = 4 * paths_24724;
    struct memblock_device mem_28239;
    
    mem_28239.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28239, bytes_28238, "mem_28239")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26536, 1,
                                            sizeof(paths_24724), &paths_24724));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26536, 2,
                                            sizeof(mem_28239.mem),
                                            &mem_28239.mem));
    if (1 * ((size_t) segmap_usable_groups_26556 *
             (size_t) segmap_group_sizze_26555) != 0) {
        const size_t global_work_sizze_29345[1] =
                     {(size_t) segmap_usable_groups_26556 *
                     (size_t) segmap_group_sizze_26555};
        const size_t local_work_sizze_29349[1] = {segmap_group_sizze_26555};
        int64_t time_start_29346 = 0, time_end_29347 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segmap_26536");
            fprintf(stderr, "%zu", global_work_sizze_29345[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_29349[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_29346 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegmap_26536,
                                                        1, NULL,
                                                        global_work_sizze_29345,
                                                        local_work_sizze_29349,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegmap_26536_runs,
                                                                                                  &ctx->mainzisegmap_26536_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_29347 = get_wall_time();
            
            long time_diff_29348 = time_end_29347 - time_start_29346;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "main.segmap_26536",
                    time_diff_29348);
        }
    }
    
    int64_t nest_sizze_26579 = paths_24724 * steps_24725;
    int64_t segmap_group_sizze_26580;
    
    segmap_group_sizze_26580 = ctx->sizes.mainzisegmap_group_sizze_26475;
    
    int64_t segmap_usable_groups_26581 = sdiv_up64(nest_sizze_26579,
                                                   segmap_group_sizze_26580);
    int64_t bytes_28241 = 4 * nest_sizze_26579;
    struct memblock_device mem_28243;
    
    mem_28243.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28243, bytes_28241, "mem_28243")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26472, 1,
                                            sizeof(paths_24724), &paths_24724));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26472, 2,
                                            sizeof(steps_24725), &steps_24725));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26472, 3,
                                            sizeof(mem_28239.mem),
                                            &mem_28239.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26472, 4,
                                            sizeof(mem_28243.mem),
                                            &mem_28243.mem));
    if (1 * ((size_t) segmap_usable_groups_26581 *
             (size_t) segmap_group_sizze_26580) != 0) {
        const size_t global_work_sizze_29350[1] =
                     {(size_t) segmap_usable_groups_26581 *
                     (size_t) segmap_group_sizze_26580};
        const size_t local_work_sizze_29354[1] = {segmap_group_sizze_26580};
        int64_t time_start_29351 = 0, time_end_29352 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segmap_26472");
            fprintf(stderr, "%zu", global_work_sizze_29350[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_29354[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_29351 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegmap_26472,
                                                        1, NULL,
                                                        global_work_sizze_29350,
                                                        local_work_sizze_29354,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegmap_26472_runs,
                                                                                                  &ctx->mainzisegmap_26472_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_29352 = get_wall_time();
            
            long time_diff_29353 = time_end_29352 - time_start_29351;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "main.segmap_26472",
                    time_diff_29353);
        }
    }
    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
        return 1;
    
    int64_t segmap_group_sizze_26625;
    
    segmap_group_sizze_26625 = ctx->sizes.mainzisegmap_group_sizze_26376;
    
    int64_t num_groups_26626;
    int32_t max_num_groups_28625;
    
    max_num_groups_28625 = ctx->sizes.mainzisegmap_num_groups_26378;
    num_groups_26626 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_24724,
                                                               sext_i32_i64(segmap_group_sizze_26625)),
                                                     sext_i32_i64(max_num_groups_28625))));
    
    struct memblock_device mem_28246;
    
    mem_28246.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28246, bytes_28241, "mem_28246")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_28246, 0, mem_28243, 0,
                                              1, steps_24725, paths_24724) !=
        0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &mem_28243, "mem_28243") != 0)
        return 1;
    
    struct memblock_device mem_28264;
    
    mem_28264.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28264, bytes_28241, "mem_28264")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_28248 = 4 * steps_24725;
    int64_t num_threads_28409 = segmap_group_sizze_26625 * num_groups_26626;
    int64_t total_sizze_28410 = bytes_28248 * num_threads_28409;
    struct memblock_device mem_28249;
    
    mem_28249.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28249, total_sizze_28410,
                              "mem_28249")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26374, 1,
                                            sizeof(ctx->failure_is_an_option),
                                            &ctx->failure_is_an_option));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26374, 3,
                                            sizeof(paths_24724), &paths_24724));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26374, 4,
                                            sizeof(steps_24725), &steps_24725));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26374, 5,
                                            sizeof(a_24729), &a_24729));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26374, 6,
                                            sizeof(b_24730), &b_24730));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26374, 7,
                                            sizeof(sigma_24731), &sigma_24731));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26374, 8,
                                            sizeof(r0_24732), &r0_24732));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26374, 9,
                                            sizeof(dt_24747), &dt_24747));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26374, 10,
                                            sizeof(upper_bound_24841),
                                            &upper_bound_24841));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26374, 11,
                                            sizeof(res_24842), &res_24842));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26374, 12,
                                            sizeof(num_groups_26626),
                                            &num_groups_26626));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26374, 13,
                                            sizeof(mem_28246.mem),
                                            &mem_28246.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26374, 14,
                                            sizeof(mem_28249.mem),
                                            &mem_28249.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26374, 15,
                                            sizeof(mem_28264.mem),
                                            &mem_28264.mem));
    if (1 * ((size_t) num_groups_26626 * (size_t) segmap_group_sizze_26625) !=
        0) {
        const size_t global_work_sizze_29355[1] = {(size_t) num_groups_26626 *
                     (size_t) segmap_group_sizze_26625};
        const size_t local_work_sizze_29359[1] = {segmap_group_sizze_26625};
        int64_t time_start_29356 = 0, time_end_29357 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segmap_26374");
            fprintf(stderr, "%zu", global_work_sizze_29355[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_29359[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_29356 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegmap_26374,
                                                        1, NULL,
                                                        global_work_sizze_29355,
                                                        local_work_sizze_29359,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegmap_26374_runs,
                                                                                                  &ctx->mainzisegmap_26374_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_29357 = get_wall_time();
            
            long time_diff_29358 = time_end_29357 - time_start_29356;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "main.segmap_26374",
                    time_diff_29358);
        }
    }
    ctx->failure_is_an_option = 1;
    if (memblock_unref_device(ctx, &mem_28246, "mem_28246") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28249, "mem_28249") != 0)
        return 1;
    
    int64_t flat_dim_24906 = n_24721 * paths_24724;
    float res_24910 = sitofp_i64_f32(paths_24724);
    struct memblock_device mem_28266;
    
    mem_28266.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28266, bytes_28248, "mem_28266")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segscan_group_sizze_26724;
    
    segscan_group_sizze_26724 = ctx->sizes.mainzisegscan_group_sizze_26723;
    
    int64_t num_groups_26726;
    int32_t max_num_groups_28637;
    
    max_num_groups_28637 = ctx->sizes.mainzisegscan_num_groups_26725;
    num_groups_26726 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_24906,
                                                               sext_i32_i64(segscan_group_sizze_26724)),
                                                     sext_i32_i64(max_num_groups_28637))));
    
    int64_t segred_group_sizze_26732;
    
    segred_group_sizze_26732 = ctx->sizes.mainzisegred_group_sizze_26731;
    
    int64_t num_groups_26734;
    int32_t max_num_groups_28638;
    
    max_num_groups_28638 = ctx->sizes.mainzisegred_num_groups_26733;
    num_groups_26734 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_24906,
                                                               sext_i32_i64(segred_group_sizze_26732)),
                                                     sext_i32_i64(max_num_groups_28638))));
    
    int64_t seghist_group_sizze_26742;
    
    seghist_group_sizze_26742 = ctx->sizes.mainziseghist_group_sizze_26741;
    
    int64_t num_groups_26744;
    int32_t max_num_groups_28639;
    
    max_num_groups_28639 = ctx->sizes.mainziseghist_num_groups_26743;
    num_groups_26744 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_24906,
                                                               sext_i32_i64(seghist_group_sizze_26742)),
                                                     sext_i32_i64(max_num_groups_28639))));
    
    int64_t segscan_group_sizze_26757;
    
    segscan_group_sizze_26757 = ctx->sizes.mainzisegscan_group_sizze_26756;
    
    int64_t segscan_group_sizze_26765;
    
    segscan_group_sizze_26765 = ctx->sizes.mainzisegscan_group_sizze_26764;
    
    int64_t segscan_group_sizze_26773;
    
    segscan_group_sizze_26773 = ctx->sizes.mainzisegscan_group_sizze_26772;
    
    int64_t segscan_group_sizze_26825;
    
    segscan_group_sizze_26825 = ctx->sizes.mainzisegscan_group_sizze_26824;
    
    bool suff_outer_redomap_26838;
    
    suff_outer_redomap_26838 = ctx->sizes.mainzisuff_outer_redomap_7 <=
        paths_24724;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_outer_redomap_7",
                paths_24724);
    
    int64_t segred_group_sizze_26850;
    
    segred_group_sizze_26850 = ctx->sizes.mainzisegred_group_sizze_26840;
    
    int64_t num_groups_26851;
    int32_t max_num_groups_28640;
    
    max_num_groups_28640 = ctx->sizes.mainzisegred_num_groups_26842;
    num_groups_26851 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_24724,
                                                               sext_i32_i64(segred_group_sizze_26850)),
                                                     sext_i32_i64(max_num_groups_28640))));
    
    bool suff_outer_par_26946;
    
    suff_outer_par_26946 = ctx->sizes.mainzisuff_outer_par_8 <= paths_24724;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_outer_par_8",
                paths_24724);
    
    int64_t segmap_group_sizze_26949;
    
    segmap_group_sizze_26949 = ctx->sizes.mainzisegmap_group_sizze_26872;
    
    int64_t segred_group_sizze_26961;
    
    segred_group_sizze_26961 = ctx->sizes.mainzisegred_group_sizze_26905;
    
    int64_t num_groups_26962;
    int32_t max_num_groups_28641;
    
    max_num_groups_28641 = ctx->sizes.mainzisegred_num_groups_26907;
    num_groups_26962 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_24906,
                                                               sext_i32_i64(segred_group_sizze_26961)),
                                                     sext_i32_i64(max_num_groups_28641))));
    
    int64_t segmap_group_sizze_26971;
    
    segmap_group_sizze_26971 = ctx->sizes.mainzisegmap_group_sizze_26897;
    
    int64_t segred_group_sizze_26978;
    
    segred_group_sizze_26978 = ctx->sizes.mainzisegred_group_sizze_26936;
    
    int64_t num_groups_26979;
    int32_t max_num_groups_28642;
    
    max_num_groups_28642 = ctx->sizes.mainzisegred_num_groups_26938;
    num_groups_26979 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_24724,
                                                               sext_i32_i64(segred_group_sizze_26978)),
                                                     sext_i32_i64(max_num_groups_28642))));
    
    int64_t segmap_usable_groups_26950 = sdiv_up_safe64(paths_24724,
                                                        segmap_group_sizze_26949);
    int64_t segmap_usable_groups_26972 = sdiv_up_safe64(paths_24724,
                                                        segmap_group_sizze_26971);
    int64_t bytes_28275 = 8 * flat_dim_24906;
    struct memblock_device mem_28276;
    
    mem_28276.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28276, bytes_28275, "mem_28276")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28278;
    
    mem_28278.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28278, bytes_28275, "mem_28278")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28281;
    
    mem_28281.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28281, 8, "mem_28281")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_28308 = 4 * flat_dim_24906;
    float res_25163;
    float redout_26652 = 0.0F;
    
    for (int64_t i_26654 = 0; i_26654 < steps_24725; i_26654++) {
        int64_t index_primexp_28125 = add64(1, i_26654);
        float res_25170 = sitofp_i64_f32(index_primexp_28125);
        float res_25171 = res_25170 / sims_per_year_24831;
        
        if (slt64(0, flat_dim_24906)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_28645;
            
            stage1_max_num_groups_28645 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_28646;
            
            stage1_num_groups_28646 = smin64(stage1_max_num_groups_28645,
                                             num_groups_26726);
            
            int32_t num_threads_28647;
            
            num_threads_28647 = sext_i64_i32(stage1_num_groups_28646 *
                segscan_group_sizze_26724);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26729,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_26724),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26729,
                                                    2, sizeof(n_24721),
                                                    &n_24721));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26729,
                                                    3, sizeof(flat_dim_24906),
                                                    &flat_dim_24906));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26729,
                                                    4, sizeof(res_25171),
                                                    &res_25171));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26729,
                                                    5,
                                                    sizeof(res_mem_28235.mem),
                                                    &res_mem_28235.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26729,
                                                    6,
                                                    sizeof(res_mem_28236.mem),
                                                    &res_mem_28236.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26729,
                                                    7, sizeof(mem_28276.mem),
                                                    &mem_28276.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26729,
                                                    8, sizeof(mem_28278.mem),
                                                    &mem_28278.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26729,
                                                    9,
                                                    sizeof(num_threads_28647),
                                                    &num_threads_28647));
            if (1 * ((size_t) stage1_num_groups_28646 *
                     (size_t) segscan_group_sizze_26724) != 0) {
                const size_t global_work_sizze_29360[1] =
                             {(size_t) stage1_num_groups_28646 *
                             (size_t) segscan_group_sizze_26724};
                const size_t local_work_sizze_29364[1] =
                             {segscan_group_sizze_26724};
                int64_t time_start_29361 = 0, time_end_29362 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage1_26729");
                    fprintf(stderr, "%zu", global_work_sizze_29360[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29364[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_26724)));
                    time_start_29361 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage1_26729,
                                                                1, NULL,
                                                                global_work_sizze_29360,
                                                                local_work_sizze_29364,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage1_26729_runs,
                                                                                                          &ctx->mainziscan_stage1_26729_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29362 = get_wall_time();
                    
                    long time_diff_29363 = time_end_29362 - time_start_29361;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage1_26729", time_diff_29363);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_26724 *
                                     sdiv_up64(flat_dim_24906,
                                               sext_i32_i64(num_threads_28647))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26729,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_28646),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26729,
                                                    2, sizeof(flat_dim_24906),
                                                    &flat_dim_24906));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26729,
                                                    3, sizeof(mem_28276.mem),
                                                    &mem_28276.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26729,
                                                    4,
                                                    sizeof(stage1_num_groups_28646),
                                                    &stage1_num_groups_28646));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26729,
                                                    5,
                                                    sizeof(num_threads_28647),
                                                    &num_threads_28647));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28646) != 0) {
                const size_t global_work_sizze_29365[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_28646};
                const size_t local_work_sizze_29369[1] =
                             {stage1_num_groups_28646};
                int64_t time_start_29366 = 0, time_end_29367 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage2_26729");
                    fprintf(stderr, "%zu", global_work_sizze_29365[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29369[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_28646)));
                    time_start_29366 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage2_26729,
                                                                1, NULL,
                                                                global_work_sizze_29365,
                                                                local_work_sizze_29369,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage2_26729_runs,
                                                                                                          &ctx->mainziscan_stage2_26729_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29367 = get_wall_time();
                    
                    long time_diff_29368 = time_end_29367 - time_start_29366;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage2_26729", time_diff_29368);
                }
            }
            
            int32_t required_groups_28683;
            
            required_groups_28683 = sext_i64_i32(sdiv_up64(flat_dim_24906,
                                                           segscan_group_sizze_26724));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26729,
                                                    1, sizeof(flat_dim_24906),
                                                    &flat_dim_24906));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26729,
                                                    2, sizeof(num_groups_26726),
                                                    &num_groups_26726));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26729,
                                                    3, sizeof(mem_28276.mem),
                                                    &mem_28276.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26729,
                                                    4,
                                                    sizeof(num_threads_28647),
                                                    &num_threads_28647));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26729,
                                                    5,
                                                    sizeof(required_groups_28683),
                                                    &required_groups_28683));
            if (1 * ((size_t) num_groups_26726 *
                     (size_t) segscan_group_sizze_26724) != 0) {
                const size_t global_work_sizze_29370[1] =
                             {(size_t) num_groups_26726 *
                             (size_t) segscan_group_sizze_26724};
                const size_t local_work_sizze_29374[1] =
                             {segscan_group_sizze_26724};
                int64_t time_start_29371 = 0, time_end_29372 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage3_26729");
                    fprintf(stderr, "%zu", global_work_sizze_29370[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29374[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29371 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage3_26729,
                                                                1, NULL,
                                                                global_work_sizze_29370,
                                                                local_work_sizze_29374,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage3_26729_runs,
                                                                                                          &ctx->mainziscan_stage3_26729_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29372 = get_wall_time();
                    
                    long time_diff_29373 = time_end_29372 - time_start_29371;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage3_26729", time_diff_29373);
                }
            }
        }
        
        struct memblock_device mainzicounter_mem_28695 =
                               ctx->mainzicounter_mem_28695;
        struct memblock_device group_res_arr_mem_28697;
        
        group_res_arr_mem_28697.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28697,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_26732 * num_groups_26734),
                                  "group_res_arr_mem_28697")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28699;
        
        num_threads_28699 = num_groups_26734 * segred_group_sizze_26732;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26739,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_26732,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26739,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26739,
                                                3, sizeof(flat_dim_24906),
                                                &flat_dim_24906));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26739,
                                                4, sizeof(num_groups_26734),
                                                &num_groups_26734));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26739,
                                                5, sizeof(mem_28278.mem),
                                                &mem_28278.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26739,
                                                6, sizeof(mem_28281.mem),
                                                &mem_28281.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26739,
                                                7,
                                                sizeof(mainzicounter_mem_28695.mem),
                                                &mainzicounter_mem_28695.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26739,
                                                8,
                                                sizeof(group_res_arr_mem_28697.mem),
                                                &group_res_arr_mem_28697.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26739,
                                                9, sizeof(num_threads_28699),
                                                &num_threads_28699));
        if (1 * ((size_t) num_groups_26734 *
                 (size_t) segred_group_sizze_26732) != 0) {
            const size_t global_work_sizze_29376[1] =
                         {(size_t) num_groups_26734 *
                         (size_t) segred_group_sizze_26732};
            const size_t local_work_sizze_29380[1] = {segred_group_sizze_26732};
            int64_t time_start_29377 = 0, time_end_29378 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segred_nonseg_26739");
                fprintf(stderr, "%zu", global_work_sizze_29376[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29380[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_26732 +
                               (int32_t) sizeof(bool)));
                time_start_29377 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegred_nonseg_26739,
                                                            1, NULL,
                                                            global_work_sizze_29376,
                                                            local_work_sizze_29380,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegred_nonseg_26739_runs,
                                                                                                      &ctx->mainzisegred_nonseg_26739_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29378 = get_wall_time();
                
                long time_diff_29379 = time_end_29378 - time_start_29377;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segred_nonseg_26739", time_diff_29379);
            }
        }
        
        int64_t read_res_29381;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_28281.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_29381, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t res_25191 = read_res_29381;
        bool bounds_invalid_upwards_25196 = slt64(res_25191, 0);
        bool valid_25197 = !bounds_invalid_upwards_25196;
        bool range_valid_c_25198;
        
        if (!valid_25197) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Range ", 0, "..", 1, "..<", res_25191,
                          " is invalid.",
                          "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:48:30-60\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:87:14-32\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva.fut:132:34-93\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  cva.fut:126:18-137:50\n   #9  cva.fut:100:1-165:21\n");
            if (memblock_unref_device(ctx, &group_res_arr_mem_28697,
                                      "group_res_arr_mem_28697") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28281, "mem_28281") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28278, "mem_28278") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28276, "mem_28276") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28266, "mem_28266") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28249, "mem_28249") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28264, "mem_28264") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28246, "mem_28246") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28243, "mem_28243") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28236, "res_mem_28236") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28235, "res_mem_28235") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28234, "res_mem_28234") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28233, "res_mem_28233") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28512,
                                      "group_res_arr_mem_28512") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_28507, "out_mem_28507") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t bytes_28282 = 8 * res_25191;
        struct memblock_device mem_28283;
        
        mem_28283.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28283, bytes_28282, "mem_28283")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_28283, res_25191, 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int32_t num_subhistos_28734;
        struct memblock_device res_subhistos_mem_28735;
        
        res_subhistos_mem_28735.references = NULL;
        
        int64_t h_28737;
        
        h_28737 = (int32_t) sizeof(int64_t) * res_25191;
        
        int64_t seg_h_28738;
        
        seg_h_28738 = (int32_t) sizeof(int64_t) * res_25191;
        if (!(seg_h_28738 == 0)) {
            int64_t hist_H_28739 = res_25191;
            int64_t hist_el_sizze_28740 = sdiv_up64(h_28737, hist_H_28739) + 4;
            int64_t hist_N_28741 = flat_dim_24906;
            int64_t hist_RF_28742 = 1;
            
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegHist");
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of threads (T)",
                        (long long) sext_i64_i32(num_groups_26744 *
                        seghist_group_sizze_26742), '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Desired group size (B)",
                        (long long) seghist_group_sizze_26742, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                        (long long) hist_H_28739, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Input elements per histogram (N)",
                        (long long) hist_N_28741, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of segments",
                        (long long) 1, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Histogram element size (el_size)",
                        (long long) hist_el_sizze_28740, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Race factor (RF)",
                        (long long) hist_RF_28742, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Memory per set of subhistograms per segment",
                        (long long) h_28737, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Memory per set of subhistograms times segments",
                        (long long) seg_h_28738, '\n');
            
            int32_t hist_L_28743;
            
            hist_L_28743 = ctx->opencl.max_local_memory;
            
            int32_t max_group_sizze_28744;
            
            max_group_sizze_28744 = ctx->opencl.max_group_size;
            
            int64_t num_groups_28745;
            
            num_groups_28745 =
                sdiv_up64(sext_i32_i64(sext_i64_i32(num_groups_26744 *
                          seghist_group_sizze_26742)), max_group_sizze_28744);
            
            double hist_m_prime_28746;
            
            hist_m_prime_28746 =
                sitofp_i64_f64(smin64(sext_i32_i64(squot32(hist_L_28743,
                                                           hist_el_sizze_28740)),
                                      sdiv_up64(hist_N_28741,
                                                num_groups_28745))) /
                sitofp_i64_f64(hist_H_28739);
            
            int64_t hist_M0_28747;
            
            hist_M0_28747 = smax64(1, smin64(fptosi_f64_i64(hist_m_prime_28746),
                                             max_group_sizze_28744));
            
            int64_t hist_Nout_28748;
            
            hist_Nout_28748 = 1;
            
            int64_t hist_Nin_28749;
            
            hist_Nin_28749 = flat_dim_24906;
            
            int64_t work_asymp_M_max_28750;
            
            work_asymp_M_max_28750 = squot64(hist_Nout_28748 * hist_N_28741, 2 *
                                             num_groups_28745 * hist_H_28739);
            
            int32_t hist_M_28751;
            
            hist_M_28751 = sext_i64_i32(smin64(hist_M0_28747,
                                               work_asymp_M_max_28750));
            
            int64_t hist_C_28752;
            
            hist_C_28752 = sdiv_up64(max_group_sizze_28744,
                                     sext_i32_i64(smax32(1, hist_M_28751)));
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local hist_M0",
                        (long long) hist_M0_28747, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local work asymp M max",
                        (long long) work_asymp_M_max_28750, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local C",
                        (long long) hist_C_28752, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local B",
                        (long long) max_group_sizze_28744, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local M",
                        (long long) hist_M_28751, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local memory needed",
                        (long long) (hist_H_28739 * hist_el_sizze_28740 *
                                     sext_i32_i64(hist_M_28751)), '\n');
            
            int64_t local_mem_needed_28753;
            
            local_mem_needed_28753 = hist_el_sizze_28740 *
                sext_i32_i64(hist_M_28751);
            
            int32_t hist_S_28754;
            
            hist_S_28754 = sext_i64_i32(sdiv_up64(hist_H_28739 *
                                                  local_mem_needed_28753,
                                                  hist_L_28743));
            if (sle64(hist_H_28739, hist_Nin_28749) &&
                (sle64(local_mem_needed_28753, hist_L_28743) &&
                 (sle32(hist_S_28754, 6) && (sle64(hist_C_28752,
                                                   max_group_sizze_28744) &&
                                             slt32(0, hist_M_28751))))) {
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "## Using local memory");
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                            (long long) hist_H_28739, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                            (long long) hist_M_28751, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Cooperation level (C)",
                            (long long) hist_C_28752, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                            (long long) hist_S_28754, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c",
                            "Number of local subhistograms per group",
                            (long long) hist_M_28751, '\n');
                
                int64_t num_segments_28755;
                
                num_segments_28755 = 1;
                num_subhistos_28734 = num_groups_28745 * num_segments_28755;
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c",
                            "Number of subhistograms in global memory",
                            (long long) num_subhistos_28734, '\n');
                if (num_subhistos_28734 == 1) {
                    if (memblock_set_device(ctx, &res_subhistos_mem_28735,
                                            &mem_28283, "mem_28283") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &res_subhistos_mem_28735,
                                              sext_i32_i64(num_subhistos_28734) *
                                              res_25191 *
                                              (int32_t) sizeof(int64_t),
                                              "res_subhistos_mem_28735")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx,
                                                      res_subhistos_mem_28735,
                                                      num_subhistos_28734 *
                                                      res_25191, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (res_25191 * (int32_t) sizeof(int64_t) > 0) {
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                     mem_28283.mem,
                                                                     res_subhistos_mem_28735.mem,
                                                                     0, 0,
                                                                     res_25191 *
                                                                     (int32_t) sizeof(int64_t),
                                                                     0, NULL,
                                                                     ctx->profiling_paused ||
                                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
                        if (ctx->debugging)
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    }
                }
                for (int32_t chk_i_28756 = 0; chk_i_28756 < hist_S_28754;
                     chk_i_28756++) {
                    int64_t num_segments_28757 = 1;
                    int64_t hist_H_chk_28758 = sdiv_up64(res_25191,
                                                         sext_i32_i64(hist_S_28754));
                    int64_t histo_sizze_28759 = hist_H_chk_28758;
                    int32_t init_per_thread_28760 =
                            sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_28751) *
                                                   histo_sizze_28759,
                                                   max_group_sizze_28744));
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_26747,
                                                            1,
                                                            (int32_t) sizeof(int32_t) *
                                                            (hist_M_28751 *
                                                             hist_H_chk_28758),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_26747,
                                                            2,
                                                            (int32_t) sizeof(int64_t) *
                                                            (hist_M_28751 *
                                                             hist_H_chk_28758),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_26747,
                                                            3,
                                                            sizeof(flat_dim_24906),
                                                            &flat_dim_24906));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_26747,
                                                            4,
                                                            sizeof(res_25191),
                                                            &res_25191));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_26747,
                                                            5,
                                                            sizeof(mem_28276.mem),
                                                            &mem_28276.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_26747,
                                                            6,
                                                            sizeof(res_subhistos_mem_28735.mem),
                                                            &res_subhistos_mem_28735.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_26747,
                                                            7,
                                                            sizeof(max_group_sizze_28744),
                                                            &max_group_sizze_28744));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_26747,
                                                            8,
                                                            sizeof(num_groups_28745),
                                                            &num_groups_28745));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_26747,
                                                            9,
                                                            sizeof(hist_M_28751),
                                                            &hist_M_28751));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_26747,
                                                            10,
                                                            sizeof(chk_i_28756),
                                                            &chk_i_28756));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_26747,
                                                            11,
                                                            sizeof(num_segments_28757),
                                                            &num_segments_28757));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_26747,
                                                            12,
                                                            sizeof(hist_H_chk_28758),
                                                            &hist_H_chk_28758));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_26747,
                                                            13,
                                                            sizeof(histo_sizze_28759),
                                                            &histo_sizze_28759));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_26747,
                                                            14,
                                                            sizeof(init_per_thread_28760),
                                                            &init_per_thread_28760));
                    if (1 * ((size_t) num_groups_28745 *
                             (size_t) max_group_sizze_28744) != 0) {
                        const size_t global_work_sizze_29382[1] =
                                     {(size_t) num_groups_28745 *
                                     (size_t) max_group_sizze_28744};
                        const size_t local_work_sizze_29386[1] =
                                     {max_group_sizze_28744};
                        int64_t time_start_29383 = 0, time_end_29384 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.seghist_local_26747");
                            fprintf(stderr, "%zu", global_work_sizze_29382[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29386[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(int32_t) *
                                           (hist_M_28751 * hist_H_chk_28758) +
                                           (int32_t) sizeof(int64_t) *
                                           (hist_M_28751 * hist_H_chk_28758)));
                            time_start_29383 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainziseghist_local_26747,
                                                                        1, NULL,
                                                                        global_work_sizze_29382,
                                                                        local_work_sizze_29386,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainziseghist_local_26747_runs,
                                                                                                                  &ctx->mainziseghist_local_26747_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29384 = get_wall_time();
                            
                            long time_diff_29385 = time_end_29384 -
                                 time_start_29383;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.seghist_local_26747",
                                    time_diff_29385);
                        }
                    }
                }
            } else {
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "## Using global memory");
                
                int64_t hist_H_28792;
                
                hist_H_28792 = res_25191;
                
                double hist_RF_28793;
                
                hist_RF_28793 = (0.0 + sitofp_i32_f64(1)) / 1.0;
                
                int32_t hist_el_sizze_28794;
                
                hist_el_sizze_28794 =
                    squot32(sext_i64_i32((int32_t) sizeof(int32_t) +
                            (int32_t) sizeof(int64_t)), 2);
                
                double hist_C_max_28795;
                
                hist_C_max_28795 =
                    fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_26744 *
                           seghist_group_sizze_26742)),
                           sitofp_i32_f64(hist_H_28792) / 2.0);
                
                int32_t hist_M_min_28796;
                
                hist_M_min_28796 = smax32(1,
                                          sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_26744 *
                                          seghist_group_sizze_26742)) /
                                          hist_C_max_28795)));
                
                int32_t L2_sizze_28797;
                
                L2_sizze_28797 = ctx->sizes.mainziL2_sizze_28797;
                
                double hist_RACE_exp_28798;
                
                hist_RACE_exp_28798 = fmax64(1.0, 0.75 * hist_RF_28793 / (64.0 /
                                                                          sitofp_i32_f64(hist_el_sizze_28794)));
                
                int32_t hist_S_28799;
                
                if (slt64(flat_dim_24906, hist_H_28792)) {
                    hist_S_28799 = 1;
                } else {
                    hist_S_28799 =
                        sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_min_28796) *
                                               hist_H_28792 *
                                               sext_i32_i64(hist_el_sizze_28794),
                                               fptosi_f64_i64(0.4 *
                                               sitofp_i32_f64(L2_sizze_28797) *
                                               hist_RACE_exp_28798)));
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s: %f%c",
                            "Race expansion factor (RACE^exp)",
                            (double) hist_RACE_exp_28798, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                            (long long) hist_S_28799, '\n');
                
                int64_t hist_H_chk_28800;
                
                hist_H_chk_28800 = sdiv_up64(res_25191,
                                             sext_i32_i64(hist_S_28799));
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Chunk size (H_chk)",
                            (long long) hist_H_chk_28800, '\n');
                
                double hist_k_max_28801;
                
                hist_k_max_28801 = fmin64(0.4 *
                                          (sitofp_i32_f64(L2_sizze_28797) /
                                           sitofp_i32_f64(sext_i64_i32((int32_t) sizeof(int32_t) +
                                           (int32_t) sizeof(int64_t)))) *
                                          hist_RACE_exp_28798,
                                          sitofp_i32_f64(flat_dim_24906)) /
                    sitofp_i32_f64(sext_i64_i32(num_groups_26744 *
                    seghist_group_sizze_26742));
                
                int64_t hist_u_28802;
                
                hist_u_28802 = 1;
                
                double hist_C_28803;
                
                hist_C_28803 =
                    fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_26744 *
                           seghist_group_sizze_26742)),
                           sitofp_i32_f64(hist_u_28802 * hist_H_chk_28800) /
                           hist_k_max_28801);
                
                int32_t hist_M_28804;
                
                hist_M_28804 = smax32(hist_M_min_28796,
                                      sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_26744 *
                                      seghist_group_sizze_26742)) /
                                      hist_C_28803)));
                if (ctx->debugging)
                    fprintf(stderr, "%s: %f%c",
                            "Elements/thread in L2 cache (k_max)",
                            (double) hist_k_max_28801, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                            (long long) hist_M_28804, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %f%c", "Cooperation level (C)",
                            (double) hist_C_28803, '\n');
                num_subhistos_28734 = sext_i32_i64(hist_M_28804);
                if (hist_M_28804 == 1) {
                    if (memblock_set_device(ctx, &res_subhistos_mem_28735,
                                            &mem_28283, "mem_28283") != 0)
                        return 1;
                } else {
                    if (num_subhistos_28734 == 1) {
                        if (memblock_set_device(ctx, &res_subhistos_mem_28735,
                                                &mem_28283, "mem_28283") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &res_subhistos_mem_28735,
                                                  sext_i32_i64(num_subhistos_28734) *
                                                  res_25191 *
                                                  (int32_t) sizeof(int64_t),
                                                  "res_subhistos_mem_28735")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx,
                                                          res_subhistos_mem_28735,
                                                          num_subhistos_28734 *
                                                          res_25191, 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (res_25191 * (int32_t) sizeof(int64_t) > 0) {
                            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                         mem_28283.mem,
                                                                         res_subhistos_mem_28735.mem,
                                                                         0, 0,
                                                                         res_25191 *
                                                                         (int32_t) sizeof(int64_t),
                                                                         0,
                                                                         NULL,
                                                                         ctx->profiling_paused ||
                                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
                            if (ctx->debugging)
                                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        }
                    }
                }
                
                struct memblock_device mainzihist_locks_mem_28805 =
                                       ctx->mainzihist_locks_mem_28805;
                
                for (int32_t chk_i_28807 = 0; chk_i_28807 < hist_S_28799;
                     chk_i_28807++) {
                    int64_t hist_H_chk_28808 = sdiv_up64(res_25191,
                                                         sext_i32_i64(hist_S_28799));
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_26747,
                                                            1,
                                                            sizeof(flat_dim_24906),
                                                            &flat_dim_24906));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_26747,
                                                            2,
                                                            sizeof(res_25191),
                                                            &res_25191));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_26747,
                                                            3,
                                                            sizeof(num_groups_26744),
                                                            &num_groups_26744));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_26747,
                                                            4,
                                                            sizeof(mem_28276.mem),
                                                            &mem_28276.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_26747,
                                                            5,
                                                            sizeof(num_subhistos_28734),
                                                            &num_subhistos_28734));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_26747,
                                                            6,
                                                            sizeof(res_subhistos_mem_28735.mem),
                                                            &res_subhistos_mem_28735.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_26747,
                                                            7,
                                                            sizeof(mainzihist_locks_mem_28805.mem),
                                                            &mainzihist_locks_mem_28805.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_26747,
                                                            8,
                                                            sizeof(chk_i_28807),
                                                            &chk_i_28807));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_26747,
                                                            9,
                                                            sizeof(hist_H_chk_28808),
                                                            &hist_H_chk_28808));
                    if (1 * ((size_t) num_groups_26744 *
                             (size_t) seghist_group_sizze_26742) != 0) {
                        const size_t global_work_sizze_29388[1] =
                                     {(size_t) num_groups_26744 *
                                     (size_t) seghist_group_sizze_26742};
                        const size_t local_work_sizze_29392[1] =
                                     {seghist_group_sizze_26742};
                        int64_t time_start_29389 = 0, time_end_29390 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.seghist_global_26747");
                            fprintf(stderr, "%zu", global_work_sizze_29388[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29392[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) 0);
                            time_start_29389 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainziseghist_global_26747,
                                                                        1, NULL,
                                                                        global_work_sizze_29388,
                                                                        local_work_sizze_29392,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainziseghist_global_26747_runs,
                                                                                                                  &ctx->mainziseghist_global_26747_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29390 = get_wall_time();
                            
                            long time_diff_29391 = time_end_29390 -
                                 time_start_29389;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.seghist_global_26747",
                                    time_diff_29391);
                        }
                    }
                }
            }
            if (num_subhistos_28734 == 1) {
                if (memblock_set_device(ctx, &mem_28283,
                                        &res_subhistos_mem_28735,
                                        "res_subhistos_mem_28735") != 0)
                    return 1;
            } else {
                if (slt64(num_subhistos_28734 * 2, seghist_group_sizze_26742)) {
                    int64_t segment_sizze_nonzzero_28821 = smax64(1,
                                                                  num_subhistos_28734);
                    int64_t num_threads_28822 = num_groups_26744 *
                            seghist_group_sizze_26742;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-small");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) res_25191, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) num_subhistos_28734, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segments_per_group",
                                (long long) squot64(seghist_group_sizze_26742,
                                                    segment_sizze_nonzzero_28821),
                                '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "required_groups",
                                (long long) sext_i64_i32(sdiv_up64(res_25191,
                                                                   squot64(seghist_group_sizze_26742,
                                                                           segment_sizze_nonzzero_28821))),
                                '\n');
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28820,
                                                            1,
                                                            (int32_t) sizeof(int64_t) *
                                                            seghist_group_sizze_26742,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28820,
                                                            2,
                                                            sizeof(res_25191),
                                                            &res_25191));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28820,
                                                            3,
                                                            sizeof(num_groups_26744),
                                                            &num_groups_26744));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28820,
                                                            4,
                                                            sizeof(mem_28283.mem),
                                                            &mem_28283.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28820,
                                                            5,
                                                            sizeof(num_subhistos_28734),
                                                            &num_subhistos_28734));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28820,
                                                            6,
                                                            sizeof(res_subhistos_mem_28735.mem),
                                                            &res_subhistos_mem_28735.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28820,
                                                            7,
                                                            sizeof(segment_sizze_nonzzero_28821),
                                                            &segment_sizze_nonzzero_28821));
                    if (1 * ((size_t) num_groups_26744 *
                             (size_t) seghist_group_sizze_26742) != 0) {
                        const size_t global_work_sizze_29393[1] =
                                     {(size_t) num_groups_26744 *
                                     (size_t) seghist_group_sizze_26742};
                        const size_t local_work_sizze_29397[1] =
                                     {seghist_group_sizze_26742};
                        int64_t time_start_29394 = 0, time_end_29395 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.segred_small_28820");
                            fprintf(stderr, "%zu", global_work_sizze_29393[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29397[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(int64_t) *
                                           seghist_group_sizze_26742));
                            time_start_29394 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainzisegred_small_28820,
                                                                        1, NULL,
                                                                        global_work_sizze_29393,
                                                                        local_work_sizze_29397,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainzisegred_small_28820_runs,
                                                                                                                  &ctx->mainzisegred_small_28820_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29395 = get_wall_time();
                            
                            long time_diff_29396 = time_end_29395 -
                                 time_start_29394;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.segred_small_28820", time_diff_29396);
                        }
                    }
                } else {
                    int64_t groups_per_segment_28842 =
                            sdiv_up64(num_groups_26744, smax64(1, res_25191));
                    int64_t elements_per_thread_28843 =
                            sdiv_up64(num_subhistos_28734,
                                      seghist_group_sizze_26742 *
                                      groups_per_segment_28842);
                    int64_t virt_num_groups_28844 = groups_per_segment_28842 *
                            res_25191;
                    int64_t num_threads_28845 = num_groups_26744 *
                            seghist_group_sizze_26742;
                    int64_t threads_per_segment_28846 =
                            groups_per_segment_28842 *
                            seghist_group_sizze_26742;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-large");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) res_25191, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) num_subhistos_28734, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                                (long long) virt_num_groups_28844, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_groups",
                                (long long) num_groups_26744, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "group_size",
                                (long long) seghist_group_sizze_26742, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                                (long long) elements_per_thread_28843, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                                (long long) groups_per_segment_28842, '\n');
                    
                    struct memblock_device group_res_arr_mem_28847;
                    
                    group_res_arr_mem_28847.references = NULL;
                    if (memblock_alloc_device(ctx, &group_res_arr_mem_28847,
                                              (int32_t) sizeof(int64_t) *
                                              (seghist_group_sizze_26742 *
                                               virt_num_groups_28844),
                                              "group_res_arr_mem_28847")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device mainzicounter_mem_28849 =
                                           ctx->mainzicounter_mem_28849;
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28820,
                                                            1,
                                                            (int32_t) sizeof(bool),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28820,
                                                            2,
                                                            (int32_t) sizeof(int64_t) *
                                                            seghist_group_sizze_26742,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28820,
                                                            3,
                                                            sizeof(res_25191),
                                                            &res_25191));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28820,
                                                            4,
                                                            sizeof(num_groups_26744),
                                                            &num_groups_26744));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28820,
                                                            5,
                                                            sizeof(mem_28283.mem),
                                                            &mem_28283.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28820,
                                                            6,
                                                            sizeof(num_subhistos_28734),
                                                            &num_subhistos_28734));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28820,
                                                            7,
                                                            sizeof(res_subhistos_mem_28735.mem),
                                                            &res_subhistos_mem_28735.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28820,
                                                            8,
                                                            sizeof(groups_per_segment_28842),
                                                            &groups_per_segment_28842));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28820,
                                                            9,
                                                            sizeof(elements_per_thread_28843),
                                                            &elements_per_thread_28843));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28820,
                                                            10,
                                                            sizeof(virt_num_groups_28844),
                                                            &virt_num_groups_28844));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28820,
                                                            11,
                                                            sizeof(threads_per_segment_28846),
                                                            &threads_per_segment_28846));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28820,
                                                            12,
                                                            sizeof(group_res_arr_mem_28847.mem),
                                                            &group_res_arr_mem_28847.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28820,
                                                            13,
                                                            sizeof(mainzicounter_mem_28849.mem),
                                                            &mainzicounter_mem_28849.mem));
                    if (1 * ((size_t) num_groups_26744 *
                             (size_t) seghist_group_sizze_26742) != 0) {
                        const size_t global_work_sizze_29399[1] =
                                     {(size_t) num_groups_26744 *
                                     (size_t) seghist_group_sizze_26742};
                        const size_t local_work_sizze_29403[1] =
                                     {seghist_group_sizze_26742};
                        int64_t time_start_29400 = 0, time_end_29401 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.segred_large_28820");
                            fprintf(stderr, "%zu", global_work_sizze_29399[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29403[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(bool) +
                                           (int32_t) sizeof(int64_t) *
                                           seghist_group_sizze_26742));
                            time_start_29400 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainzisegred_large_28820,
                                                                        1, NULL,
                                                                        global_work_sizze_29399,
                                                                        local_work_sizze_29403,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainzisegred_large_28820_runs,
                                                                                                                  &ctx->mainzisegred_large_28820_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29401 = get_wall_time();
                            
                            long time_diff_29402 = time_end_29401 -
                                 time_start_29400;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.segred_large_28820", time_diff_29402);
                        }
                    }
                    if (memblock_unref_device(ctx, &group_res_arr_mem_28847,
                                              "group_res_arr_mem_28847") != 0)
                        return 1;
                }
            }
        }
        
        int64_t num_groups_26759;
        int32_t max_num_groups_28881;
        
        max_num_groups_28881 = ctx->sizes.mainzisegscan_num_groups_26758;
        num_groups_26759 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_25191,
                                                                   sext_i32_i64(segscan_group_sizze_26757)),
                                                         sext_i32_i64(max_num_groups_28881))));
        
        struct memblock_device mem_28287;
        
        mem_28287.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28287, res_25191, "mem_28287")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28289;
        
        mem_28289.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28289, bytes_28282, "mem_28289")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_25191)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_28882;
            
            stage1_max_num_groups_28882 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_28883;
            
            stage1_num_groups_28883 = smin64(stage1_max_num_groups_28882,
                                             num_groups_26759);
            
            int32_t num_threads_28884;
            
            num_threads_28884 = sext_i64_i32(stage1_num_groups_28883 *
                segscan_group_sizze_26757);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26762,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_26757),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26762,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              segscan_group_sizze_26757),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26762,
                                                    3, sizeof(res_25191),
                                                    &res_25191));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26762,
                                                    4, sizeof(mem_28283.mem),
                                                    &mem_28283.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26762,
                                                    5, sizeof(mem_28287.mem),
                                                    &mem_28287.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26762,
                                                    6, sizeof(mem_28289.mem),
                                                    &mem_28289.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26762,
                                                    7,
                                                    sizeof(num_threads_28884),
                                                    &num_threads_28884));
            if (1 * ((size_t) stage1_num_groups_28883 *
                     (size_t) segscan_group_sizze_26757) != 0) {
                const size_t global_work_sizze_29404[1] =
                             {(size_t) stage1_num_groups_28883 *
                             (size_t) segscan_group_sizze_26757};
                const size_t local_work_sizze_29408[1] =
                             {segscan_group_sizze_26757};
                int64_t time_start_29405 = 0, time_end_29406 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage1_26762");
                    fprintf(stderr, "%zu", global_work_sizze_29404[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29408[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_26757) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          segscan_group_sizze_26757)));
                    time_start_29405 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage1_26762,
                                                                1, NULL,
                                                                global_work_sizze_29404,
                                                                local_work_sizze_29408,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage1_26762_runs,
                                                                                                          &ctx->mainziscan_stage1_26762_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29406 = get_wall_time();
                    
                    long time_diff_29407 = time_end_29406 - time_start_29405;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage1_26762", time_diff_29407);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_26757 *
                                     sdiv_up64(res_25191,
                                               sext_i32_i64(num_threads_28884))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26762,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_28883),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26762,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              stage1_num_groups_28883),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26762,
                                                    3, sizeof(res_25191),
                                                    &res_25191));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26762,
                                                    4, sizeof(mem_28287.mem),
                                                    &mem_28287.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26762,
                                                    5, sizeof(mem_28289.mem),
                                                    &mem_28289.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26762,
                                                    6,
                                                    sizeof(stage1_num_groups_28883),
                                                    &stage1_num_groups_28883));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26762,
                                                    7,
                                                    sizeof(num_threads_28884),
                                                    &num_threads_28884));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28883) != 0) {
                const size_t global_work_sizze_29409[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_28883};
                const size_t local_work_sizze_29413[1] =
                             {stage1_num_groups_28883};
                int64_t time_start_29410 = 0, time_end_29411 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage2_26762");
                    fprintf(stderr, "%zu", global_work_sizze_29409[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29413[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_28883) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          stage1_num_groups_28883)));
                    time_start_29410 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage2_26762,
                                                                1, NULL,
                                                                global_work_sizze_29409,
                                                                local_work_sizze_29413,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage2_26762_runs,
                                                                                                          &ctx->mainziscan_stage2_26762_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29411 = get_wall_time();
                    
                    long time_diff_29412 = time_end_29411 - time_start_29410;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage2_26762", time_diff_29412);
                }
            }
            
            int32_t required_groups_28936;
            
            required_groups_28936 = sext_i64_i32(sdiv_up64(res_25191,
                                                           segscan_group_sizze_26757));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26762,
                                                    1, sizeof(res_25191),
                                                    &res_25191));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26762,
                                                    2, sizeof(num_groups_26759),
                                                    &num_groups_26759));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26762,
                                                    3, sizeof(mem_28287.mem),
                                                    &mem_28287.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26762,
                                                    4, sizeof(mem_28289.mem),
                                                    &mem_28289.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26762,
                                                    5,
                                                    sizeof(num_threads_28884),
                                                    &num_threads_28884));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26762,
                                                    6,
                                                    sizeof(required_groups_28936),
                                                    &required_groups_28936));
            if (1 * ((size_t) num_groups_26759 *
                     (size_t) segscan_group_sizze_26757) != 0) {
                const size_t global_work_sizze_29414[1] =
                             {(size_t) num_groups_26759 *
                             (size_t) segscan_group_sizze_26757};
                const size_t local_work_sizze_29418[1] =
                             {segscan_group_sizze_26757};
                int64_t time_start_29415 = 0, time_end_29416 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage3_26762");
                    fprintf(stderr, "%zu", global_work_sizze_29414[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29418[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29415 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage3_26762,
                                                                1, NULL,
                                                                global_work_sizze_29414,
                                                                local_work_sizze_29418,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage3_26762_runs,
                                                                                                          &ctx->mainziscan_stage3_26762_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29416 = get_wall_time();
                    
                    long time_diff_29417 = time_end_29416 - time_start_29415;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage3_26762", time_diff_29417);
                }
            }
        }
        if (memblock_unref_device(ctx, &mem_28283, "mem_28283") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28287, "mem_28287") != 0)
            return 1;
        
        int64_t num_groups_26767;
        int32_t max_num_groups_28948;
        
        max_num_groups_28948 = ctx->sizes.mainzisegscan_num_groups_26766;
        num_groups_26767 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_25191,
                                                                   sext_i32_i64(segscan_group_sizze_26765)),
                                                         sext_i32_i64(max_num_groups_28948))));
        
        struct memblock_device mem_28292;
        
        mem_28292.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28292, res_25191, "mem_28292")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28294;
        
        mem_28294.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28294, bytes_28282, "mem_28294")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28296;
        
        mem_28296.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28296, res_25191, "mem_28296")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_25191)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_28949;
            
            stage1_max_num_groups_28949 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_28950;
            
            stage1_num_groups_28950 = smin64(stage1_max_num_groups_28949,
                                             num_groups_26767);
            
            int32_t num_threads_28951;
            
            num_threads_28951 = sext_i64_i32(stage1_num_groups_28950 *
                segscan_group_sizze_26765);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26770,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_26765),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26770,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              segscan_group_sizze_26765),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26770,
                                                    3, sizeof(res_25191),
                                                    &res_25191));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26770,
                                                    4, sizeof(mem_28289.mem),
                                                    &mem_28289.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26770,
                                                    5, sizeof(mem_28292.mem),
                                                    &mem_28292.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26770,
                                                    6, sizeof(mem_28294.mem),
                                                    &mem_28294.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26770,
                                                    7, sizeof(mem_28296.mem),
                                                    &mem_28296.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26770,
                                                    8,
                                                    sizeof(num_threads_28951),
                                                    &num_threads_28951));
            if (1 * ((size_t) stage1_num_groups_28950 *
                     (size_t) segscan_group_sizze_26765) != 0) {
                const size_t global_work_sizze_29419[1] =
                             {(size_t) stage1_num_groups_28950 *
                             (size_t) segscan_group_sizze_26765};
                const size_t local_work_sizze_29423[1] =
                             {segscan_group_sizze_26765};
                int64_t time_start_29420 = 0, time_end_29421 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage1_26770");
                    fprintf(stderr, "%zu", global_work_sizze_29419[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29423[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_26765) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          segscan_group_sizze_26765)));
                    time_start_29420 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage1_26770,
                                                                1, NULL,
                                                                global_work_sizze_29419,
                                                                local_work_sizze_29423,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage1_26770_runs,
                                                                                                          &ctx->mainziscan_stage1_26770_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29421 = get_wall_time();
                    
                    long time_diff_29422 = time_end_29421 - time_start_29420;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage1_26770", time_diff_29422);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_26765 *
                                     sdiv_up64(res_25191,
                                               sext_i32_i64(num_threads_28951))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26770,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_28950),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26770,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              stage1_num_groups_28950),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26770,
                                                    3, sizeof(res_25191),
                                                    &res_25191));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26770,
                                                    4, sizeof(mem_28292.mem),
                                                    &mem_28292.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26770,
                                                    5, sizeof(mem_28294.mem),
                                                    &mem_28294.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26770,
                                                    6,
                                                    sizeof(stage1_num_groups_28950),
                                                    &stage1_num_groups_28950));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26770,
                                                    7,
                                                    sizeof(num_threads_28951),
                                                    &num_threads_28951));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28950) != 0) {
                const size_t global_work_sizze_29424[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_28950};
                const size_t local_work_sizze_29428[1] =
                             {stage1_num_groups_28950};
                int64_t time_start_29425 = 0, time_end_29426 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage2_26770");
                    fprintf(stderr, "%zu", global_work_sizze_29424[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29428[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_28950) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          stage1_num_groups_28950)));
                    time_start_29425 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage2_26770,
                                                                1, NULL,
                                                                global_work_sizze_29424,
                                                                local_work_sizze_29428,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage2_26770_runs,
                                                                                                          &ctx->mainziscan_stage2_26770_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29426 = get_wall_time();
                    
                    long time_diff_29427 = time_end_29426 - time_start_29425;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage2_26770", time_diff_29427);
                }
            }
            
            int32_t required_groups_29003;
            
            required_groups_29003 = sext_i64_i32(sdiv_up64(res_25191,
                                                           segscan_group_sizze_26765));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26770,
                                                    1, sizeof(res_25191),
                                                    &res_25191));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26770,
                                                    2, sizeof(num_groups_26767),
                                                    &num_groups_26767));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26770,
                                                    3, sizeof(mem_28292.mem),
                                                    &mem_28292.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26770,
                                                    4, sizeof(mem_28294.mem),
                                                    &mem_28294.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26770,
                                                    5,
                                                    sizeof(num_threads_28951),
                                                    &num_threads_28951));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26770,
                                                    6,
                                                    sizeof(required_groups_29003),
                                                    &required_groups_29003));
            if (1 * ((size_t) num_groups_26767 *
                     (size_t) segscan_group_sizze_26765) != 0) {
                const size_t global_work_sizze_29429[1] =
                             {(size_t) num_groups_26767 *
                             (size_t) segscan_group_sizze_26765};
                const size_t local_work_sizze_29433[1] =
                             {segscan_group_sizze_26765};
                int64_t time_start_29430 = 0, time_end_29431 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage3_26770");
                    fprintf(stderr, "%zu", global_work_sizze_29429[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29433[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29430 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage3_26770,
                                                                1, NULL,
                                                                global_work_sizze_29429,
                                                                local_work_sizze_29433,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage3_26770_runs,
                                                                                                          &ctx->mainziscan_stage3_26770_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29431 = get_wall_time();
                    
                    long time_diff_29432 = time_end_29431 - time_start_29430;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage3_26770", time_diff_29432);
                }
            }
        }
        if (memblock_unref_device(ctx, &mem_28292, "mem_28292") != 0)
            return 1;
        
        int64_t num_groups_26775;
        int32_t max_num_groups_29015;
        
        max_num_groups_29015 = ctx->sizes.mainzisegscan_num_groups_26774;
        num_groups_26775 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_25191,
                                                                   sext_i32_i64(segscan_group_sizze_26773)),
                                                         sext_i32_i64(max_num_groups_29015))));
        
        struct memblock_device mem_28299;
        
        mem_28299.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28299, res_25191, "mem_28299")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t bytes_28300 = 4 * res_25191;
        struct memblock_device mem_28301;
        
        mem_28301.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28301, bytes_28300, "mem_28301")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_25191)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_29016;
            
            stage1_max_num_groups_29016 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_29017;
            
            stage1_num_groups_29017 = smin64(stage1_max_num_groups_29016,
                                             num_groups_26775);
            
            int32_t num_threads_29018;
            
            num_threads_29018 = sext_i64_i32(stage1_num_groups_29017 *
                segscan_group_sizze_26773);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    1,
                                                    sizeof(ctx->failure_is_an_option),
                                                    &ctx->failure_is_an_option));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    3, smax64(1,
                                                              (int32_t) sizeof(float) *
                                                              segscan_group_sizze_26773),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    4, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              segscan_group_sizze_26773),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    5, sizeof(n_24721),
                                                    &n_24721));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    6, sizeof(paths_24724),
                                                    &paths_24724));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    7, sizeof(a_24729),
                                                    &a_24729));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    8, sizeof(b_24730),
                                                    &b_24730));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    9, sizeof(sigma_24731),
                                                    &sigma_24731));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    10, sizeof(flat_dim_24906),
                                                    &flat_dim_24906));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    11, sizeof(res_25171),
                                                    &res_25171));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    12, sizeof(res_25191),
                                                    &res_25191));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    13, sizeof(i_26654),
                                                    &i_26654));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    14,
                                                    sizeof(res_mem_28233.mem),
                                                    &res_mem_28233.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    15,
                                                    sizeof(res_mem_28234.mem),
                                                    &res_mem_28234.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    16,
                                                    sizeof(res_mem_28235.mem),
                                                    &res_mem_28235.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    17,
                                                    sizeof(res_mem_28236.mem),
                                                    &res_mem_28236.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    18, sizeof(mem_28264.mem),
                                                    &mem_28264.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    19, sizeof(mem_28289.mem),
                                                    &mem_28289.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    20, sizeof(mem_28294.mem),
                                                    &mem_28294.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    21, sizeof(mem_28296.mem),
                                                    &mem_28296.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    22, sizeof(mem_28299.mem),
                                                    &mem_28299.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    23, sizeof(mem_28301.mem),
                                                    &mem_28301.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26778,
                                                    24,
                                                    sizeof(num_threads_29018),
                                                    &num_threads_29018));
            if (1 * ((size_t) stage1_num_groups_29017 *
                     (size_t) segscan_group_sizze_26773) != 0) {
                const size_t global_work_sizze_29434[1] =
                             {(size_t) stage1_num_groups_29017 *
                             (size_t) segscan_group_sizze_26773};
                const size_t local_work_sizze_29438[1] =
                             {segscan_group_sizze_26773};
                int64_t time_start_29435 = 0, time_end_29436 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage1_26778");
                    fprintf(stderr, "%zu", global_work_sizze_29434[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29438[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                              segscan_group_sizze_26773) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          segscan_group_sizze_26773)));
                    time_start_29435 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage1_26778,
                                                                1, NULL,
                                                                global_work_sizze_29434,
                                                                local_work_sizze_29438,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage1_26778_runs,
                                                                                                          &ctx->mainziscan_stage1_26778_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29436 = get_wall_time();
                    
                    long time_diff_29437 = time_end_29436 - time_start_29435;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage1_26778", time_diff_29437);
                }
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_26773 *
                                     sdiv_up64(res_25191,
                                               sext_i32_i64(num_threads_29018))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26778,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(float) *
                                                              stage1_num_groups_29017),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26778,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              stage1_num_groups_29017),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26778,
                                                    3, sizeof(res_25191),
                                                    &res_25191));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26778,
                                                    4, sizeof(mem_28299.mem),
                                                    &mem_28299.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26778,
                                                    5, sizeof(mem_28301.mem),
                                                    &mem_28301.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26778,
                                                    6,
                                                    sizeof(stage1_num_groups_29017),
                                                    &stage1_num_groups_29017));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26778,
                                                    7,
                                                    sizeof(num_threads_29018),
                                                    &num_threads_29018));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_29017) != 0) {
                const size_t global_work_sizze_29439[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_29017};
                const size_t local_work_sizze_29443[1] =
                             {stage1_num_groups_29017};
                int64_t time_start_29440 = 0, time_end_29441 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage2_26778");
                    fprintf(stderr, "%zu", global_work_sizze_29439[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29443[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                              stage1_num_groups_29017) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          stage1_num_groups_29017)));
                    time_start_29440 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage2_26778,
                                                                1, NULL,
                                                                global_work_sizze_29439,
                                                                local_work_sizze_29443,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage2_26778_runs,
                                                                                                          &ctx->mainziscan_stage2_26778_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29441 = get_wall_time();
                    
                    long time_diff_29442 = time_end_29441 - time_start_29440;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage2_26778", time_diff_29442);
                }
            }
            
            int32_t required_groups_29070;
            
            required_groups_29070 = sext_i64_i32(sdiv_up64(res_25191,
                                                           segscan_group_sizze_26773));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26778,
                                                    1, sizeof(res_25191),
                                                    &res_25191));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26778,
                                                    2, sizeof(num_groups_26775),
                                                    &num_groups_26775));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26778,
                                                    3, sizeof(mem_28299.mem),
                                                    &mem_28299.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26778,
                                                    4, sizeof(mem_28301.mem),
                                                    &mem_28301.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26778,
                                                    5,
                                                    sizeof(num_threads_29018),
                                                    &num_threads_29018));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26778,
                                                    6,
                                                    sizeof(required_groups_29070),
                                                    &required_groups_29070));
            if (1 * ((size_t) num_groups_26775 *
                     (size_t) segscan_group_sizze_26773) != 0) {
                const size_t global_work_sizze_29444[1] =
                             {(size_t) num_groups_26775 *
                             (size_t) segscan_group_sizze_26773};
                const size_t local_work_sizze_29448[1] =
                             {segscan_group_sizze_26773};
                int64_t time_start_29445 = 0, time_end_29446 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage3_26778");
                    fprintf(stderr, "%zu", global_work_sizze_29444[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29448[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29445 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage3_26778,
                                                                1, NULL,
                                                                global_work_sizze_29444,
                                                                local_work_sizze_29448,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage3_26778_runs,
                                                                                                          &ctx->mainziscan_stage3_26778_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29446 = get_wall_time();
                    
                    long time_diff_29447 = time_end_29446 - time_start_29445;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage3_26778", time_diff_29447);
                }
            }
        }
        if (memblock_unref_device(ctx, &mem_28289, "mem_28289") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28294, "mem_28294") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28299, "mem_28299") != 0)
            return 1;
        
        int64_t num_groups_26827;
        int32_t max_num_groups_29082;
        
        max_num_groups_29082 = ctx->sizes.mainzisegscan_num_groups_26826;
        num_groups_26827 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_25191,
                                                                   sext_i32_i64(segscan_group_sizze_26825)),
                                                         sext_i32_i64(max_num_groups_29082))));
        
        struct memblock_device mem_28304;
        
        mem_28304.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28304, bytes_28282, "mem_28304")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_25191)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_29083;
            
            stage1_max_num_groups_29083 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_29084;
            
            stage1_num_groups_29084 = smin64(stage1_max_num_groups_29083,
                                             num_groups_26827);
            
            int32_t num_threads_29085;
            
            num_threads_29085 = sext_i64_i32(stage1_num_groups_29084 *
                segscan_group_sizze_26825);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26830,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_26825),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26830,
                                                    2, sizeof(res_25191),
                                                    &res_25191));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26830,
                                                    3, sizeof(mem_28296.mem),
                                                    &mem_28296.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26830,
                                                    4, sizeof(mem_28304.mem),
                                                    &mem_28304.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_26830,
                                                    5,
                                                    sizeof(num_threads_29085),
                                                    &num_threads_29085));
            if (1 * ((size_t) stage1_num_groups_29084 *
                     (size_t) segscan_group_sizze_26825) != 0) {
                const size_t global_work_sizze_29449[1] =
                             {(size_t) stage1_num_groups_29084 *
                             (size_t) segscan_group_sizze_26825};
                const size_t local_work_sizze_29453[1] =
                             {segscan_group_sizze_26825};
                int64_t time_start_29450 = 0, time_end_29451 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage1_26830");
                    fprintf(stderr, "%zu", global_work_sizze_29449[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29453[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_26825)));
                    time_start_29450 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage1_26830,
                                                                1, NULL,
                                                                global_work_sizze_29449,
                                                                local_work_sizze_29453,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage1_26830_runs,
                                                                                                          &ctx->mainziscan_stage1_26830_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29451 = get_wall_time();
                    
                    long time_diff_29452 = time_end_29451 - time_start_29450;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage1_26830", time_diff_29452);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_26825 *
                                     sdiv_up64(res_25191,
                                               sext_i32_i64(num_threads_29085))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26830,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_29084),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26830,
                                                    2, sizeof(res_25191),
                                                    &res_25191));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26830,
                                                    3, sizeof(mem_28304.mem),
                                                    &mem_28304.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26830,
                                                    4,
                                                    sizeof(stage1_num_groups_29084),
                                                    &stage1_num_groups_29084));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_26830,
                                                    5,
                                                    sizeof(num_threads_29085),
                                                    &num_threads_29085));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_29084) != 0) {
                const size_t global_work_sizze_29454[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_29084};
                const size_t local_work_sizze_29458[1] =
                             {stage1_num_groups_29084};
                int64_t time_start_29455 = 0, time_end_29456 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage2_26830");
                    fprintf(stderr, "%zu", global_work_sizze_29454[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29458[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_29084)));
                    time_start_29455 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage2_26830,
                                                                1, NULL,
                                                                global_work_sizze_29454,
                                                                local_work_sizze_29458,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage2_26830_runs,
                                                                                                          &ctx->mainziscan_stage2_26830_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29456 = get_wall_time();
                    
                    long time_diff_29457 = time_end_29456 - time_start_29455;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage2_26830", time_diff_29457);
                }
            }
            
            int32_t required_groups_29121;
            
            required_groups_29121 = sext_i64_i32(sdiv_up64(res_25191,
                                                           segscan_group_sizze_26825));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26830,
                                                    1, sizeof(res_25191),
                                                    &res_25191));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26830,
                                                    2, sizeof(num_groups_26827),
                                                    &num_groups_26827));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26830,
                                                    3, sizeof(mem_28304.mem),
                                                    &mem_28304.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26830,
                                                    4,
                                                    sizeof(num_threads_29085),
                                                    &num_threads_29085));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_26830,
                                                    5,
                                                    sizeof(required_groups_29121),
                                                    &required_groups_29121));
            if (1 * ((size_t) num_groups_26827 *
                     (size_t) segscan_group_sizze_26825) != 0) {
                const size_t global_work_sizze_29459[1] =
                             {(size_t) num_groups_26827 *
                             (size_t) segscan_group_sizze_26825};
                const size_t local_work_sizze_29463[1] =
                             {segscan_group_sizze_26825};
                int64_t time_start_29460 = 0, time_end_29461 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage3_26830");
                    fprintf(stderr, "%zu", global_work_sizze_29459[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29463[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29460 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage3_26830,
                                                                1, NULL,
                                                                global_work_sizze_29459,
                                                                local_work_sizze_29463,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage3_26830_runs,
                                                                                                          &ctx->mainziscan_stage3_26830_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29461 = get_wall_time();
                    
                    long time_diff_29462 = time_end_29461 - time_start_29460;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage3_26830", time_diff_29462);
                }
            }
        }
        
        bool cond_25383 = slt64(0, res_25191);
        int64_t num_segments_25384;
        
        if (cond_25383) {
            int64_t i_25385 = sub64(res_25191, 1);
            bool x_25386 = sle64(0, i_25385);
            bool y_25387 = slt64(i_25385, res_25191);
            bool bounds_check_25388 = x_25386 && y_25387;
            bool index_certs_25389;
            
            if (!bounds_check_25388) {
                ctx->error =
                    msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                              "Index [", i_25385,
                              "] out of bounds for array of shape [", res_25191,
                              "].",
                              "-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:29:36-59\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #4  cva.fut:132:34-93\n   #5  /prelude/soacs.fut:56:19-23\n   #6  /prelude/soacs.fut:56:3-37\n   #7  cva.fut:126:18-137:50\n   #8  cva.fut:100:1-165:21\n");
                if (memblock_unref_device(ctx, &mem_28304, "mem_28304") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28301, "mem_28301") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28299, "mem_28299") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28296, "mem_28296") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28294, "mem_28294") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28292, "mem_28292") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28289, "mem_28289") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28287, "mem_28287") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_subhistos_mem_28735,
                                          "res_subhistos_mem_28735") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28283, "mem_28283") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_28697,
                                          "group_res_arr_mem_28697") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28281, "mem_28281") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28278, "mem_28278") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28276, "mem_28276") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28266, "mem_28266") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28249, "mem_28249") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28264, "mem_28264") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28246, "mem_28246") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28243, "mem_28243") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28236,
                                          "res_mem_28236") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28235,
                                          "res_mem_28235") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28234,
                                          "res_mem_28234") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28233,
                                          "res_mem_28233") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_28512,
                                          "group_res_arr_mem_28512") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &out_mem_28507,
                                          "out_mem_28507") != 0)
                    return 1;
                return 1;
            }
            
            int64_t read_res_29464;
            
            OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                         mem_28304.mem,
                                                         ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                         i_25385 *
                                                         sizeof(int64_t),
                                                         sizeof(int64_t),
                                                         &read_res_29464, 0,
                                                         NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_scalar_from_dev_runs,
                                                                                                   &ctx->copy_scalar_from_dev_total_runtime)));
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
                return 1;
            
            int64_t res_25390 = read_res_29464;
            
            num_segments_25384 = res_25390;
        } else {
            num_segments_25384 = 0;
        }
        
        bool bounds_invalid_upwards_25391 = slt64(num_segments_25384, 0);
        bool valid_25392 = !bounds_invalid_upwards_25391;
        bool range_valid_c_25393;
        
        if (!valid_25392) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Range ", 0, "..", 1, "..<", num_segments_25384,
                          " is invalid.",
                          "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:33:17-41\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva.fut:132:34-93\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  cva.fut:126:18-137:50\n   #9  cva.fut:100:1-165:21\n");
            if (memblock_unref_device(ctx, &mem_28304, "mem_28304") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28301, "mem_28301") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28299, "mem_28299") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28296, "mem_28296") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28294, "mem_28294") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28292, "mem_28292") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28289, "mem_28289") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28287, "mem_28287") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_subhistos_mem_28735,
                                      "res_subhistos_mem_28735") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28283, "mem_28283") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28697,
                                      "group_res_arr_mem_28697") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28281, "mem_28281") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28278, "mem_28278") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28276, "mem_28276") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28266, "mem_28266") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28249, "mem_28249") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28264, "mem_28264") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28246, "mem_28246") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28243, "mem_28243") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28236, "res_mem_28236") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28235, "res_mem_28235") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28234, "res_mem_28234") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28233, "res_mem_28233") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28512,
                                      "group_res_arr_mem_28512") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_28507, "out_mem_28507") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t bytes_28305 = 4 * num_segments_25384;
        struct memblock_device mem_28306;
        
        mem_28306.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28306, bytes_28305, "mem_28306")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_f32(ctx, mem_28306, num_segments_25384,
                                          0.0F) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t segmap_group_sizze_26835;
        
        segmap_group_sizze_26835 = ctx->sizes.mainzisegmap_group_sizze_26834;
        
        int64_t segmap_usable_groups_26836 = sdiv_up64(res_25191,
                                                       segmap_group_sizze_26835);
        
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26832, 1,
                                                sizeof(res_25191), &res_25191));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26832, 2,
                                                sizeof(num_segments_25384),
                                                &num_segments_25384));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26832, 3,
                                                sizeof(mem_28296.mem),
                                                &mem_28296.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26832, 4,
                                                sizeof(mem_28301.mem),
                                                &mem_28301.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26832, 5,
                                                sizeof(mem_28304.mem),
                                                &mem_28304.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26832, 6,
                                                sizeof(mem_28306.mem),
                                                &mem_28306.mem));
        if (1 * ((size_t) segmap_usable_groups_26836 *
                 (size_t) segmap_group_sizze_26835) != 0) {
            const size_t global_work_sizze_29465[1] =
                         {(size_t) segmap_usable_groups_26836 *
                         (size_t) segmap_group_sizze_26835};
            const size_t local_work_sizze_29469[1] = {segmap_group_sizze_26835};
            int64_t time_start_29466 = 0, time_end_29467 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_26832");
                fprintf(stderr, "%zu", global_work_sizze_29465[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29469[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29466 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_26832,
                                                            1, NULL,
                                                            global_work_sizze_29465,
                                                            local_work_sizze_29469,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_26832_runs,
                                                                                                      &ctx->mainzisegmap_26832_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29467 = get_wall_time();
                
                long time_diff_29468 = time_end_29467 - time_start_29466;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_26832", time_diff_29468);
            }
        }
        if (memblock_unref_device(ctx, &mem_28296, "mem_28296") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28301, "mem_28301") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28304, "mem_28304") != 0)
            return 1;
        
        bool dim_match_25401 = flat_dim_24906 == num_segments_25384;
        bool empty_or_match_cert_25402;
        
        if (!dim_match_25401) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Value of (core language) shape (",
                                   num_segments_25384,
                                   ") cannot match shape of type `[",
                                   flat_dim_24906, "]b`.",
                                   "-> #0  lib/github.com/diku-dk/segmented/segmented.fut:103:6-45\n   #1  cva.fut:132:34-93\n   #2  /prelude/soacs.fut:56:19-23\n   #3  /prelude/soacs.fut:56:3-37\n   #4  cva.fut:126:18-137:50\n   #5  cva.fut:100:1-165:21\n");
            if (memblock_unref_device(ctx, &mem_28306, "mem_28306") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28304, "mem_28304") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28301, "mem_28301") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28299, "mem_28299") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28296, "mem_28296") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28294, "mem_28294") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28292, "mem_28292") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28289, "mem_28289") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28287, "mem_28287") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_subhistos_mem_28735,
                                      "res_subhistos_mem_28735") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28283, "mem_28283") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28697,
                                      "group_res_arr_mem_28697") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28281, "mem_28281") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28278, "mem_28278") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28276, "mem_28276") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28266, "mem_28266") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28249, "mem_28249") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28264, "mem_28264") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28246, "mem_28246") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28243, "mem_28243") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28236, "res_mem_28236") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28235, "res_mem_28235") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28234, "res_mem_28234") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28233, "res_mem_28233") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28512,
                                      "group_res_arr_mem_28512") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_28507, "out_mem_28507") !=
                0)
                return 1;
            return 1;
        }
        
        float res_25404;
        int32_t local_memory_capacity_29280;
        
        local_memory_capacity_29280 = ctx->opencl.max_local_memory;
        if (sle64((int32_t) sizeof(bool) + (int32_t) sizeof(float) *
                  segred_group_sizze_26850,
                  sext_i32_i64(local_memory_capacity_29280)) &&
            suff_outer_redomap_26838) {
            struct memblock_device mem_28310;
            
            mem_28310.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28310, bytes_28308,
                                      "mem_28310")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_28310, 0,
                                                      mem_28306, 0, 1, n_24721,
                                                      paths_24724) != 0) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_28313;
            
            mem_28313.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28313, 4, "mem_28313")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mainzicounter_mem_29147 =
                                   ctx->mainzicounter_mem_29147;
            struct memblock_device group_res_arr_mem_29149;
            
            group_res_arr_mem_29149.references = NULL;
            if (memblock_alloc_device(ctx, &group_res_arr_mem_29149,
                                      (int32_t) sizeof(float) *
                                      (segred_group_sizze_26850 *
                                       num_groups_26851),
                                      "group_res_arr_mem_29149")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_29151;
            
            num_threads_29151 = num_groups_26851 * segred_group_sizze_26850;
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegRed");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26848,
                                                    1, (int32_t) sizeof(float) *
                                                    segred_group_sizze_26850,
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26848,
                                                    2, (int32_t) sizeof(bool),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26848,
                                                    3, sizeof(n_24721),
                                                    &n_24721));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26848,
                                                    4, sizeof(paths_24724),
                                                    &paths_24724));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26848,
                                                    5, sizeof(num_groups_26851),
                                                    &num_groups_26851));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26848,
                                                    6, sizeof(mem_28310.mem),
                                                    &mem_28310.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26848,
                                                    7, sizeof(mem_28313.mem),
                                                    &mem_28313.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26848,
                                                    8,
                                                    sizeof(mainzicounter_mem_29147.mem),
                                                    &mainzicounter_mem_29147.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26848,
                                                    9,
                                                    sizeof(group_res_arr_mem_29149.mem),
                                                    &group_res_arr_mem_29149.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26848,
                                                    10,
                                                    sizeof(num_threads_29151),
                                                    &num_threads_29151));
            if (1 * ((size_t) num_groups_26851 *
                     (size_t) segred_group_sizze_26850) != 0) {
                const size_t global_work_sizze_29471[1] =
                             {(size_t) num_groups_26851 *
                             (size_t) segred_group_sizze_26850};
                const size_t local_work_sizze_29475[1] =
                             {segred_group_sizze_26850};
                int64_t time_start_29472 = 0, time_end_29473 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.segred_nonseg_26848");
                    fprintf(stderr, "%zu", global_work_sizze_29471[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29475[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + (int32_t) sizeof(float) *
                                   segred_group_sizze_26850 +
                                   (int32_t) sizeof(bool)));
                    time_start_29472 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainzisegred_nonseg_26848,
                                                                1, NULL,
                                                                global_work_sizze_29471,
                                                                local_work_sizze_29475,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainzisegred_nonseg_26848_runs,
                                                                                                          &ctx->mainzisegred_nonseg_26848_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29473 = get_wall_time();
                    
                    long time_diff_29474 = time_end_29473 - time_start_29472;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.segred_nonseg_26848", time_diff_29474);
                }
            }
            if (memblock_unref_device(ctx, &mem_28310, "mem_28310") != 0)
                return 1;
            
            float read_res_29476;
            
            OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                         mem_28313.mem,
                                                         ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                         0 * sizeof(float),
                                                         sizeof(float),
                                                         &read_res_29476, 0,
                                                         NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_scalar_from_dev_runs,
                                                                                                   &ctx->copy_scalar_from_dev_total_runtime)));
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
                return 1;
            
            float res_26864 = read_res_29476;
            
            if (memblock_unref_device(ctx, &mem_28313, "mem_28313") != 0)
                return 1;
            res_25404 = res_26864;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29149,
                                      "group_res_arr_mem_29149") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28313, "mem_28313") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28310, "mem_28310") != 0)
                return 1;
        } else {
            struct memblock_device res_map_acc_mem_28326;
            
            res_map_acc_mem_28326.references = NULL;
            
            int32_t local_memory_capacity_29249;
            
            local_memory_capacity_29249 = ctx->opencl.max_local_memory;
            if (sle64(0, sext_i32_i64(local_memory_capacity_29249)) &&
                suff_outer_par_26946) {
                struct memblock_device mem_28316;
                
                mem_28316.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28316, bytes_28308,
                                          "mem_28316")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_28316, 0,
                                                          mem_28306, 0, 1,
                                                          n_24721,
                                                          paths_24724) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28319;
                
                mem_28319.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28319, bytes_28238,
                                          "mem_28319")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26870,
                                                        1, sizeof(n_24721),
                                                        &n_24721));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26870,
                                                        2, sizeof(paths_24724),
                                                        &paths_24724));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26870,
                                                        3,
                                                        sizeof(mem_28316.mem),
                                                        &mem_28316.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26870,
                                                        4,
                                                        sizeof(mem_28319.mem),
                                                        &mem_28319.mem));
                if (1 * ((size_t) segmap_usable_groups_26950 *
                         (size_t) segmap_group_sizze_26949) != 0) {
                    const size_t global_work_sizze_29477[1] =
                                 {(size_t) segmap_usable_groups_26950 *
                                 (size_t) segmap_group_sizze_26949};
                    const size_t local_work_sizze_29481[1] =
                                 {segmap_group_sizze_26949};
                    int64_t time_start_29478 = 0, time_end_29479 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.segmap_26870");
                        fprintf(stderr, "%zu", global_work_sizze_29477[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29481[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_29478 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainzisegmap_26870,
                                                                    1, NULL,
                                                                    global_work_sizze_29477,
                                                                    local_work_sizze_29481,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainzisegmap_26870_runs,
                                                                                                              &ctx->mainzisegmap_26870_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29479 = get_wall_time();
                        
                        long time_diff_29480 = time_end_29479 -
                             time_start_29478;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.segmap_26870", time_diff_29480);
                    }
                }
                if (memblock_unref_device(ctx, &mem_28316, "mem_28316") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_28326, &mem_28319,
                                        "mem_28319") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28319, "mem_28319") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28316, "mem_28316") != 0)
                    return 1;
            } else {
                struct memblock_device mem_28322;
                
                mem_28322.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28322, bytes_28238,
                                          "mem_28322")) {
                    err = 1;
                    goto cleanup;
                }
                if (slt64(n_24721 * 2, segred_group_sizze_26961)) {
                    int64_t segment_sizze_nonzzero_29184 = smax64(1, n_24721);
                    int64_t num_threads_29185 = num_groups_26962 *
                            segred_group_sizze_26961;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-small");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) paths_24724, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) n_24721, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segments_per_group",
                                (long long) squot64(segred_group_sizze_26961,
                                                    segment_sizze_nonzzero_29184),
                                '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "required_groups",
                                (long long) sext_i64_i32(sdiv_up64(paths_24724,
                                                                   squot64(segred_group_sizze_26961,
                                                                           segment_sizze_nonzzero_29184))),
                                '\n');
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_26911,
                                                            1,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_26961,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_26911,
                                                            2, sizeof(n_24721),
                                                            &n_24721));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_26911,
                                                            3,
                                                            sizeof(paths_24724),
                                                            &paths_24724));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_26911,
                                                            4,
                                                            sizeof(num_groups_26962),
                                                            &num_groups_26962));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_26911,
                                                            5,
                                                            sizeof(mem_28306.mem),
                                                            &mem_28306.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_26911,
                                                            6,
                                                            sizeof(mem_28322.mem),
                                                            &mem_28322.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_26911,
                                                            7,
                                                            sizeof(segment_sizze_nonzzero_29184),
                                                            &segment_sizze_nonzzero_29184));
                    if (1 * ((size_t) num_groups_26962 *
                             (size_t) segred_group_sizze_26961) != 0) {
                        const size_t global_work_sizze_29482[1] =
                                     {(size_t) num_groups_26962 *
                                     (size_t) segred_group_sizze_26961};
                        const size_t local_work_sizze_29486[1] =
                                     {segred_group_sizze_26961};
                        int64_t time_start_29483 = 0, time_end_29484 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.segred_small_26911");
                            fprintf(stderr, "%zu", global_work_sizze_29482[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29486[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(float) *
                                           segred_group_sizze_26961));
                            time_start_29483 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainzisegred_small_26911,
                                                                        1, NULL,
                                                                        global_work_sizze_29482,
                                                                        local_work_sizze_29486,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainzisegred_small_26911_runs,
                                                                                                                  &ctx->mainzisegred_small_26911_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29484 = get_wall_time();
                            
                            long time_diff_29485 = time_end_29484 -
                                 time_start_29483;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.segred_small_26911", time_diff_29485);
                        }
                    }
                } else {
                    int64_t groups_per_segment_29205 =
                            sdiv_up64(num_groups_26962, smax64(1, paths_24724));
                    int64_t elements_per_thread_29206 = sdiv_up64(n_24721,
                                                                  segred_group_sizze_26961 *
                                                                  groups_per_segment_29205);
                    int64_t virt_num_groups_29207 = groups_per_segment_29205 *
                            paths_24724;
                    int64_t num_threads_29208 = num_groups_26962 *
                            segred_group_sizze_26961;
                    int64_t threads_per_segment_29209 =
                            groups_per_segment_29205 * segred_group_sizze_26961;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-large");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) paths_24724, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) n_24721, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                                (long long) virt_num_groups_29207, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_groups",
                                (long long) num_groups_26962, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "group_size",
                                (long long) segred_group_sizze_26961, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                                (long long) elements_per_thread_29206, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                                (long long) groups_per_segment_29205, '\n');
                    
                    struct memblock_device group_res_arr_mem_29210;
                    
                    group_res_arr_mem_29210.references = NULL;
                    if (memblock_alloc_device(ctx, &group_res_arr_mem_29210,
                                              (int32_t) sizeof(float) *
                                              (segred_group_sizze_26961 *
                                               virt_num_groups_29207),
                                              "group_res_arr_mem_29210")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device mainzicounter_mem_29212 =
                                           ctx->mainzicounter_mem_29212;
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_26911,
                                                            1,
                                                            (int32_t) sizeof(bool),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_26911,
                                                            2,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_26961,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_26911,
                                                            3, sizeof(n_24721),
                                                            &n_24721));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_26911,
                                                            4,
                                                            sizeof(num_groups_26962),
                                                            &num_groups_26962));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_26911,
                                                            5,
                                                            sizeof(mem_28306.mem),
                                                            &mem_28306.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_26911,
                                                            6,
                                                            sizeof(mem_28322.mem),
                                                            &mem_28322.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_26911,
                                                            7,
                                                            sizeof(groups_per_segment_29205),
                                                            &groups_per_segment_29205));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_26911,
                                                            8,
                                                            sizeof(elements_per_thread_29206),
                                                            &elements_per_thread_29206));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_26911,
                                                            9,
                                                            sizeof(virt_num_groups_29207),
                                                            &virt_num_groups_29207));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_26911,
                                                            10,
                                                            sizeof(threads_per_segment_29209),
                                                            &threads_per_segment_29209));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_26911,
                                                            11,
                                                            sizeof(group_res_arr_mem_29210.mem),
                                                            &group_res_arr_mem_29210.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_26911,
                                                            12,
                                                            sizeof(mainzicounter_mem_29212.mem),
                                                            &mainzicounter_mem_29212.mem));
                    if (1 * ((size_t) num_groups_26962 *
                             (size_t) segred_group_sizze_26961) != 0) {
                        const size_t global_work_sizze_29488[1] =
                                     {(size_t) num_groups_26962 *
                                     (size_t) segred_group_sizze_26961};
                        const size_t local_work_sizze_29492[1] =
                                     {segred_group_sizze_26961};
                        int64_t time_start_29489 = 0, time_end_29490 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.segred_large_26911");
                            fprintf(stderr, "%zu", global_work_sizze_29488[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29492[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(bool) +
                                           (int32_t) sizeof(float) *
                                           segred_group_sizze_26961));
                            time_start_29489 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainzisegred_large_26911,
                                                                        1, NULL,
                                                                        global_work_sizze_29488,
                                                                        local_work_sizze_29492,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainzisegred_large_26911_runs,
                                                                                                                  &ctx->mainzisegred_large_26911_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29490 = get_wall_time();
                            
                            long time_diff_29491 = time_end_29490 -
                                 time_start_29489;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.segred_large_26911", time_diff_29491);
                        }
                    }
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29210,
                                              "group_res_arr_mem_29210") != 0)
                        return 1;
                }
                
                struct memblock_device mem_28325;
                
                mem_28325.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28325, bytes_28238,
                                          "mem_28325")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26895,
                                                        1, sizeof(paths_24724),
                                                        &paths_24724));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26895,
                                                        2,
                                                        sizeof(mem_28322.mem),
                                                        &mem_28322.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26895,
                                                        3,
                                                        sizeof(mem_28325.mem),
                                                        &mem_28325.mem));
                if (1 * ((size_t) segmap_usable_groups_26972 *
                         (size_t) segmap_group_sizze_26971) != 0) {
                    const size_t global_work_sizze_29493[1] =
                                 {(size_t) segmap_usable_groups_26972 *
                                 (size_t) segmap_group_sizze_26971};
                    const size_t local_work_sizze_29497[1] =
                                 {segmap_group_sizze_26971};
                    int64_t time_start_29494 = 0, time_end_29495 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.segmap_26895");
                        fprintf(stderr, "%zu", global_work_sizze_29493[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29497[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_29494 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainzisegmap_26895,
                                                                    1, NULL,
                                                                    global_work_sizze_29493,
                                                                    local_work_sizze_29497,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainzisegmap_26895_runs,
                                                                                                              &ctx->mainzisegmap_26895_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29495 = get_wall_time();
                        
                        long time_diff_29496 = time_end_29495 -
                             time_start_29494;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.segmap_26895", time_diff_29496);
                    }
                }
                if (memblock_unref_device(ctx, &mem_28322, "mem_28322") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_28326, &mem_28325,
                                        "mem_28325") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28325, "mem_28325") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28322, "mem_28322") != 0)
                    return 1;
            }
            
            struct memblock_device mem_28329;
            
            mem_28329.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28329, 4, "mem_28329")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mainzicounter_mem_29250 =
                                   ctx->mainzicounter_mem_29250;
            struct memblock_device group_res_arr_mem_29252;
            
            group_res_arr_mem_29252.references = NULL;
            if (memblock_alloc_device(ctx, &group_res_arr_mem_29252,
                                      (int32_t) sizeof(float) *
                                      (segred_group_sizze_26978 *
                                       num_groups_26979),
                                      "group_res_arr_mem_29252")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_29254;
            
            num_threads_29254 = num_groups_26979 * segred_group_sizze_26978;
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegRed");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26944,
                                                    1, (int32_t) sizeof(float) *
                                                    segred_group_sizze_26978,
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26944,
                                                    2, (int32_t) sizeof(bool),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26944,
                                                    3, sizeof(paths_24724),
                                                    &paths_24724));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26944,
                                                    4, sizeof(num_groups_26979),
                                                    &num_groups_26979));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26944,
                                                    5,
                                                    sizeof(res_map_acc_mem_28326.mem),
                                                    &res_map_acc_mem_28326.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26944,
                                                    6, sizeof(mem_28329.mem),
                                                    &mem_28329.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26944,
                                                    7,
                                                    sizeof(mainzicounter_mem_29250.mem),
                                                    &mainzicounter_mem_29250.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26944,
                                                    8,
                                                    sizeof(group_res_arr_mem_29252.mem),
                                                    &group_res_arr_mem_29252.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26944,
                                                    9,
                                                    sizeof(num_threads_29254),
                                                    &num_threads_29254));
            if (1 * ((size_t) num_groups_26979 *
                     (size_t) segred_group_sizze_26978) != 0) {
                const size_t global_work_sizze_29499[1] =
                             {(size_t) num_groups_26979 *
                             (size_t) segred_group_sizze_26978};
                const size_t local_work_sizze_29503[1] =
                             {segred_group_sizze_26978};
                int64_t time_start_29500 = 0, time_end_29501 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.segred_nonseg_26944");
                    fprintf(stderr, "%zu", global_work_sizze_29499[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29503[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + (int32_t) sizeof(float) *
                                   segred_group_sizze_26978 +
                                   (int32_t) sizeof(bool)));
                    time_start_29500 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainzisegred_nonseg_26944,
                                                                1, NULL,
                                                                global_work_sizze_29499,
                                                                local_work_sizze_29503,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainzisegred_nonseg_26944_runs,
                                                                                                          &ctx->mainzisegred_nonseg_26944_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29501 = get_wall_time();
                    
                    long time_diff_29502 = time_end_29501 - time_start_29500;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.segred_nonseg_26944", time_diff_29502);
                }
            }
            if (memblock_unref_device(ctx, &res_map_acc_mem_28326,
                                      "res_map_acc_mem_28326") != 0)
                return 1;
            
            float read_res_29504;
            
            OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                         mem_28329.mem,
                                                         ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                         0 * sizeof(float),
                                                         sizeof(float),
                                                         &read_res_29504, 0,
                                                         NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_scalar_from_dev_runs,
                                                                                                   &ctx->copy_scalar_from_dev_total_runtime)));
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
                return 1;
            
            float res_26986 = read_res_29504;
            
            if (memblock_unref_device(ctx, &mem_28329, "mem_28329") != 0)
                return 1;
            res_25404 = res_26986;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29252,
                                      "group_res_arr_mem_29252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28329, "mem_28329") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_map_acc_mem_28326,
                                      "res_map_acc_mem_28326") != 0)
                return 1;
        }
        if (memblock_unref_device(ctx, &mem_28306, "mem_28306") != 0)
            return 1;
        
        float res_25415 = res_25404 / res_24910;
        float negate_arg_25416 = a_24729 * res_25171;
        float exp_arg_25417 = 0.0F - negate_arg_25416;
        float res_25418 = fpow32(2.7182817F, exp_arg_25417);
        float x_25419 = 1.0F - res_25418;
        float B_25420 = x_25419 / a_24729;
        float x_25421 = B_25420 - res_25171;
        float x_25422 = y_24753 * x_25421;
        float A1_25423 = x_25422 / x_24749;
        float y_25424 = fpow32(B_25420, 2.0F);
        float x_25425 = x_24751 * y_25424;
        float A2_25426 = x_25425 / y_24754;
        float exp_arg_25427 = A1_25423 - A2_25426;
        float res_25428 = fpow32(2.7182817F, exp_arg_25427);
        float negate_arg_25429 = 5.0e-2F * B_25420;
        float exp_arg_25430 = 0.0F - negate_arg_25429;
        float res_25431 = fpow32(2.7182817F, exp_arg_25430);
        float res_25432 = res_25428 * res_25431;
        float res_25433 = res_25415 * res_25432;
        float res_25167 = res_25433 + redout_26652;
        
        {
            float write_tmp_29505 = res_25415;
            
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          mem_28266.mem,
                                                          CL_TRUE, i_26654 *
                                                          sizeof(float),
                                                          sizeof(float),
                                                          &write_tmp_29505, 0,
                                                          NULL,
                                                          ctx->profiling_paused ||
                                                          !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                    &ctx->copy_scalar_to_dev_runs,
                                                                                                    &ctx->copy_scalar_to_dev_total_runtime)));
        }
        
        float redout_tmp_28643 = res_25167;
        
        redout_26652 = redout_tmp_28643;
        if (memblock_unref_device(ctx, &mem_28306, "mem_28306") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28304, "mem_28304") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28301, "mem_28301") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28299, "mem_28299") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28296, "mem_28296") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28294, "mem_28294") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28292, "mem_28292") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28289, "mem_28289") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28287, "mem_28287") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_subhistos_mem_28735,
                                  "res_subhistos_mem_28735") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28283, "mem_28283") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28697,
                                  "group_res_arr_mem_28697") != 0)
            return 1;
    }
    res_25163 = redout_26652;
    if (memblock_unref_device(ctx, &res_mem_28233, "res_mem_28233") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28234, "res_mem_28234") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28235, "res_mem_28235") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28236, "res_mem_28236") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28264, "mem_28264") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28276, "mem_28276") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28278, "mem_28278") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28281, "mem_28281") != 0)
        return 1;
    
    float CVA_25436 = 6.0e-3F * res_25163;
    struct memblock_device mem_28336;
    
    mem_28336.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28336, bytes_28248, "mem_28336")) {
        err = 1;
        goto cleanup;
    }
    if (steps_24725 * (int32_t) sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     mem_28266.mem,
                                                     mem_28336.mem, 0, 0,
                                                     steps_24725 *
                                                     (int32_t) sizeof(float), 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    if (memblock_unref_device(ctx, &mem_28266, "mem_28266") != 0)
        return 1;
    out_arrsizze_28508 = steps_24725;
    if (memblock_set_device(ctx, &out_mem_28507, &mem_28336, "mem_28336") != 0)
        return 1;
    scalar_out_28506 = CVA_25436;
    *out_scalar_out_29311 = scalar_out_28506;
    (*out_mem_p_29312).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_29312, &out_mem_28507,
                            "out_mem_28507") != 0)
        return 1;
    *out_out_arrsizze_29313 = out_arrsizze_28508;
    if (memblock_unref_device(ctx, &mem_28336, "mem_28336") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28281, "mem_28281") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28278, "mem_28278") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28276, "mem_28276") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28266, "mem_28266") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28249, "mem_28249") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28264, "mem_28264") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28246, "mem_28246") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28243, "mem_28243") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28236, "res_mem_28236") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28235, "res_mem_28235") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28234, "res_mem_28234") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28233, "res_mem_28233") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_28512,
                              "group_res_arr_mem_28512") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_28507, "out_mem_28507") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
static int futrts_test(struct futhark_context *ctx, float *out_scalar_out_29506,
                       int64_t paths_25438, int64_t steps_25439)
{
    (void) ctx;
    
    int err = 0;
    float scalar_out_28506;
    struct memblock_device mem_28182;
    
    mem_28182.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28182, 36, "mem_28182")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzistatic_array_28507 =
                           ctx->testzistatic_array_28507;
    
    if (9 * (int32_t) sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     testzistatic_array_28507.mem,
                                                     mem_28182.mem, 0, 0, 9 *
                                                     (int32_t) sizeof(float), 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    
    struct memblock_device mem_28184;
    
    mem_28184.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28184, 72, "mem_28184")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzistatic_array_28508 =
                           ctx->testzistatic_array_28508;
    
    if (9 * (int32_t) sizeof(int64_t) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     testzistatic_array_28508.mem,
                                                     mem_28184.mem, 0, 0, 9 *
                                                     (int32_t) sizeof(int64_t),
                                                     0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    
    struct memblock_device mem_28186;
    
    mem_28186.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28186, 36, "mem_28186")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzistatic_array_28509 =
                           ctx->testzistatic_array_28509;
    
    if (9 * (int32_t) sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     testzistatic_array_28509.mem,
                                                     mem_28186.mem, 0, 0, 9 *
                                                     (int32_t) sizeof(float), 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    
    int64_t segred_group_sizze_26990;
    
    segred_group_sizze_26990 = ctx->sizes.testzisegred_group_sizze_26989;
    
    int64_t num_groups_26992;
    int32_t max_num_groups_28510;
    
    max_num_groups_28510 = ctx->sizes.testzisegred_num_groups_26991;
    num_groups_26992 = sext_i64_i32(smax64(1, smin64(sdiv_up64(9,
                                                               sext_i32_i64(segred_group_sizze_26990)),
                                                     sext_i32_i64(max_num_groups_28510))));
    
    struct memblock_device mem_28189;
    
    mem_28189.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28189, 4, "mem_28189")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzicounter_mem_28511 =
                           ctx->testzicounter_mem_28511;
    struct memblock_device group_res_arr_mem_28513;
    
    group_res_arr_mem_28513.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_28513,
                              (int32_t) sizeof(float) *
                              (segred_group_sizze_26990 * num_groups_26992),
                              "group_res_arr_mem_28513")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_28515;
    
    num_threads_28515 = num_groups_26992 * segred_group_sizze_26990;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26997, 1,
                                            (int32_t) sizeof(float) *
                                            segred_group_sizze_26990, NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26997, 2,
                                            (int32_t) sizeof(bool), NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26997, 3,
                                            sizeof(num_groups_26992),
                                            &num_groups_26992));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26997, 4,
                                            sizeof(mem_28184.mem),
                                            &mem_28184.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26997, 5,
                                            sizeof(mem_28186.mem),
                                            &mem_28186.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26997, 6,
                                            sizeof(mem_28189.mem),
                                            &mem_28189.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26997, 7,
                                            sizeof(testzicounter_mem_28511.mem),
                                            &testzicounter_mem_28511.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26997, 8,
                                            sizeof(group_res_arr_mem_28513.mem),
                                            &group_res_arr_mem_28513.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_26997, 9,
                                            sizeof(num_threads_28515),
                                            &num_threads_28515));
    if (1 * ((size_t) num_groups_26992 * (size_t) segred_group_sizze_26990) !=
        0) {
        const size_t global_work_sizze_29511[1] = {(size_t) num_groups_26992 *
                     (size_t) segred_group_sizze_26990};
        const size_t local_work_sizze_29515[1] = {segred_group_sizze_26990};
        int64_t time_start_29512 = 0, time_end_29513 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segred_nonseg_26997");
            fprintf(stderr, "%zu", global_work_sizze_29511[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_29515[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) (0 + (int32_t) sizeof(float) *
                           segred_group_sizze_26990 + (int32_t) sizeof(bool)));
            time_start_29512 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegred_nonseg_26997,
                                                        1, NULL,
                                                        global_work_sizze_29511,
                                                        local_work_sizze_29515,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegred_nonseg_26997_runs,
                                                                                                  &ctx->testzisegred_nonseg_26997_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_29513 = get_wall_time();
            
            long time_diff_29514 = time_end_29513 - time_start_29512;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "test.segred_nonseg_26997", time_diff_29514);
        }
    }
    
    float read_res_29516;
    
    OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                 mem_28189.mem,
                                                 ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                 0 * sizeof(float),
                                                 sizeof(float), &read_res_29516,
                                                 0, NULL,
                                                 ctx->profiling_paused ||
                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                           &ctx->copy_scalar_from_dev_runs,
                                                                                           &ctx->copy_scalar_from_dev_total_runtime)));
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
        return 1;
    
    float res_25443 = read_res_29516;
    
    if (memblock_unref_device(ctx, &mem_28189, "mem_28189") != 0)
        return 1;
    
    float res_25451 = sitofp_i64_f32(steps_25439);
    float dt_25452 = res_25443 / res_25451;
    bool suff_outer_par_26999;
    
    suff_outer_par_26999 = ctx->sizes.testzisuff_outer_par_0 <= 9;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_outer_par_0", 9);
    
    int64_t segmap_group_sizze_27089;
    
    segmap_group_sizze_27089 = ctx->sizes.testzisegmap_group_sizze_27013;
    
    int64_t segmap_group_sizze_27265;
    
    segmap_group_sizze_27265 = ctx->sizes.testzisegmap_group_sizze_27189;
    
    int64_t segred_num_groups_28435;
    
    segred_num_groups_28435 = ctx->sizes.testzisegred_num_groups_28434;
    
    int64_t segred_group_sizze_28437;
    
    segred_group_sizze_28437 = ctx->sizes.testzisegred_group_sizze_28436;
    
    int64_t segred_num_groups_28467;
    
    segred_num_groups_28467 = ctx->sizes.testzisegred_num_groups_28466;
    
    int64_t segred_group_sizze_28469;
    
    segred_group_sizze_28469 = ctx->sizes.testzisegred_group_sizze_28468;
    
    struct memblock_device res_mem_28236;
    
    res_mem_28236.references = NULL;
    
    struct memblock_device res_mem_28237;
    
    res_mem_28237.references = NULL;
    
    struct memblock_device res_mem_28238;
    
    res_mem_28238.references = NULL;
    
    struct memblock_device res_mem_28239;
    
    res_mem_28239.references = NULL;
    
    int32_t local_memory_capacity_28615;
    
    local_memory_capacity_28615 = ctx->opencl.max_local_memory;
    if ((sle64((int32_t) sizeof(bool) + (int32_t) sizeof(int64_t) *
               segred_group_sizze_28437,
               sext_i32_i64(local_memory_capacity_28615)) && sle64(0,
                                                                   sext_i32_i64(local_memory_capacity_28615))) &&
        suff_outer_par_26999) {
        int64_t segmap_usable_groups_27090 = sdiv_up64(9,
                                                       segmap_group_sizze_27089);
        struct memblock_device mem_28191;
        
        mem_28191.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28191, 36, "mem_28191")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_28186.mem,
                                                         mem_28191.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28193;
        
        mem_28193.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28193, 72, "mem_28193")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_28184.mem,
                                                         mem_28193.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28195;
        
        mem_28195.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28195, 36, "mem_28195")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_28182.mem,
                                                         mem_28195.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28212;
        
        mem_28212.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28212, 36, "mem_28212")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28425 = segmap_group_sizze_27089 *
                segmap_usable_groups_27090;
        struct memblock_device mem_28453;
        
        mem_28453.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28453, 8, "mem_28453")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device testzicounter_mem_28541 =
                               ctx->testzicounter_mem_28541;
        struct memblock_device group_res_arr_mem_28543;
        
        group_res_arr_mem_28543.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28543,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_28437 *
                                   segred_num_groups_28435),
                                  "group_res_arr_mem_28543")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28545;
        
        num_threads_28545 = segred_num_groups_28435 * segred_group_sizze_28437;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28441,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_28437,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28441,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28441,
                                                3, sizeof(mem_28184.mem),
                                                &mem_28184.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28441,
                                                4, sizeof(mem_28453.mem),
                                                &mem_28453.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28441,
                                                5,
                                                sizeof(testzicounter_mem_28541.mem),
                                                &testzicounter_mem_28541.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28441,
                                                6,
                                                sizeof(group_res_arr_mem_28543.mem),
                                                &group_res_arr_mem_28543.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28441,
                                                7, sizeof(num_threads_28545),
                                                &num_threads_28545));
        if (1 * ((size_t) segred_num_groups_28435 *
                 (size_t) segred_group_sizze_28437) != 0) {
            const size_t global_work_sizze_29518[1] =
                         {(size_t) segred_num_groups_28435 *
                         (size_t) segred_group_sizze_28437};
            const size_t local_work_sizze_29522[1] = {segred_group_sizze_28437};
            int64_t time_start_29519 = 0, time_end_29520 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segred_nonseg_28441");
                fprintf(stderr, "%zu", global_work_sizze_29518[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29522[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_28437 +
                               (int32_t) sizeof(bool)));
                time_start_29519 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegred_nonseg_28441,
                                                            1, NULL,
                                                            global_work_sizze_29518,
                                                            local_work_sizze_29522,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegred_nonseg_28441_runs,
                                                                                                      &ctx->testzisegred_nonseg_28441_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29520 = get_wall_time();
                
                long time_diff_29521 = time_end_29520 - time_start_29519;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segred_nonseg_28441", time_diff_29521);
            }
        }
        
        int64_t read_res_29523;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_28453.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_29523, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t max_per_thread_28431 = read_res_29523;
        
        if (memblock_unref_device(ctx, &mem_28453, "mem_28453") != 0)
            return 1;
        
        int64_t sizze_sum_28448 = num_threads_28425 * max_per_thread_28431;
        struct memblock_device mem_28198;
        
        mem_28198.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28198, sizze_sum_28448,
                                  "mem_28198")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27011, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27011, 3,
                                                sizeof(mem_28184.mem),
                                                &mem_28184.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27011, 4,
                                                sizeof(mem_28186.mem),
                                                &mem_28186.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27011, 5,
                                                sizeof(mem_28198.mem),
                                                &mem_28198.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27011, 6,
                                                sizeof(mem_28212.mem),
                                                &mem_28212.mem));
        if (1 * ((size_t) segmap_usable_groups_27090 *
                 (size_t) segmap_group_sizze_27089) != 0) {
            const size_t global_work_sizze_29524[1] =
                         {(size_t) segmap_usable_groups_27090 *
                         (size_t) segmap_group_sizze_27089};
            const size_t local_work_sizze_29528[1] = {segmap_group_sizze_27089};
            int64_t time_start_29525 = 0, time_end_29526 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_27011");
                fprintf(stderr, "%zu", global_work_sizze_29524[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29528[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29525 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_27011,
                                                            1, NULL,
                                                            global_work_sizze_29524,
                                                            local_work_sizze_29528,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_27011_runs,
                                                                                                      &ctx->testzisegmap_27011_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29526 = get_wall_time();
                
                long time_diff_29527 = time_end_29526 - time_start_29525;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_27011", time_diff_29527);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_28198, "mem_28198") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28236, &mem_28212, "mem_28212") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28237, &mem_28195, "mem_28195") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28238, &mem_28193, "mem_28193") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28239, &mem_28191, "mem_28191") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28198, "mem_28198") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28543,
                                  "group_res_arr_mem_28543") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28453, "mem_28453") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28212, "mem_28212") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28195, "mem_28195") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28193, "mem_28193") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28191, "mem_28191") != 0)
            return 1;
    } else {
        int64_t segmap_usable_groups_27266 = sdiv_up64(9,
                                                       segmap_group_sizze_27265);
        struct memblock_device mem_28214;
        
        mem_28214.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28214, 36, "mem_28214")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_28186.mem,
                                                         mem_28214.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28216;
        
        mem_28216.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28216, 72, "mem_28216")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_28184.mem,
                                                         mem_28216.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28218;
        
        mem_28218.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28218, 36, "mem_28218")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_28182.mem,
                                                         mem_28218.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28235;
        
        mem_28235.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28235, 36, "mem_28235")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28457 = segmap_group_sizze_27265 *
                segmap_usable_groups_27266;
        struct memblock_device mem_28485;
        
        mem_28485.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28485, 8, "mem_28485")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device testzicounter_mem_28578 =
                               ctx->testzicounter_mem_28578;
        struct memblock_device group_res_arr_mem_28580;
        
        group_res_arr_mem_28580.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28580,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_28469 *
                                   segred_num_groups_28467),
                                  "group_res_arr_mem_28580")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28582;
        
        num_threads_28582 = segred_num_groups_28467 * segred_group_sizze_28469;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28473,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_28469,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28473,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28473,
                                                3, sizeof(mem_28184.mem),
                                                &mem_28184.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28473,
                                                4, sizeof(mem_28485.mem),
                                                &mem_28485.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28473,
                                                5,
                                                sizeof(testzicounter_mem_28578.mem),
                                                &testzicounter_mem_28578.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28473,
                                                6,
                                                sizeof(group_res_arr_mem_28580.mem),
                                                &group_res_arr_mem_28580.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28473,
                                                7, sizeof(num_threads_28582),
                                                &num_threads_28582));
        if (1 * ((size_t) segred_num_groups_28467 *
                 (size_t) segred_group_sizze_28469) != 0) {
            const size_t global_work_sizze_29530[1] =
                         {(size_t) segred_num_groups_28467 *
                         (size_t) segred_group_sizze_28469};
            const size_t local_work_sizze_29534[1] = {segred_group_sizze_28469};
            int64_t time_start_29531 = 0, time_end_29532 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segred_nonseg_28473");
                fprintf(stderr, "%zu", global_work_sizze_29530[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29534[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_28469 +
                               (int32_t) sizeof(bool)));
                time_start_29531 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegred_nonseg_28473,
                                                            1, NULL,
                                                            global_work_sizze_29530,
                                                            local_work_sizze_29534,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegred_nonseg_28473_runs,
                                                                                                      &ctx->testzisegred_nonseg_28473_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29532 = get_wall_time();
                
                long time_diff_29533 = time_end_29532 - time_start_29531;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segred_nonseg_28473", time_diff_29533);
            }
        }
        
        int64_t read_res_29535;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_28485.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_29535, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t max_per_thread_28463 = read_res_29535;
        
        if (memblock_unref_device(ctx, &mem_28485, "mem_28485") != 0)
            return 1;
        
        int64_t sizze_sum_28480 = num_threads_28457 * max_per_thread_28463;
        struct memblock_device mem_28221;
        
        mem_28221.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28221, sizze_sum_28480,
                                  "mem_28221")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27187, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27187, 3,
                                                sizeof(mem_28184.mem),
                                                &mem_28184.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27187, 4,
                                                sizeof(mem_28186.mem),
                                                &mem_28186.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27187, 5,
                                                sizeof(mem_28221.mem),
                                                &mem_28221.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27187, 6,
                                                sizeof(mem_28235.mem),
                                                &mem_28235.mem));
        if (1 * ((size_t) segmap_usable_groups_27266 *
                 (size_t) segmap_group_sizze_27265) != 0) {
            const size_t global_work_sizze_29536[1] =
                         {(size_t) segmap_usable_groups_27266 *
                         (size_t) segmap_group_sizze_27265};
            const size_t local_work_sizze_29540[1] = {segmap_group_sizze_27265};
            int64_t time_start_29537 = 0, time_end_29538 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_27187");
                fprintf(stderr, "%zu", global_work_sizze_29536[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29540[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29537 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_27187,
                                                            1, NULL,
                                                            global_work_sizze_29536,
                                                            local_work_sizze_29540,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_27187_runs,
                                                                                                      &ctx->testzisegmap_27187_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29538 = get_wall_time();
                
                long time_diff_29539 = time_end_29538 - time_start_29537;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_27187", time_diff_29539);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_28221, "mem_28221") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28236, &mem_28235, "mem_28235") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28237, &mem_28218, "mem_28218") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28238, &mem_28216, "mem_28216") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28239, &mem_28214, "mem_28214") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28221, "mem_28221") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28580,
                                  "group_res_arr_mem_28580") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28485, "mem_28485") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28235, "mem_28235") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28218, "mem_28218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28216, "mem_28216") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28214, "mem_28214") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_28182, "mem_28182") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28184, "mem_28184") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
        return 1;
    
    float sims_per_year_25530 = res_25451 / res_25443;
    bool bounds_invalid_upwards_25531 = slt64(steps_25439, 1);
    bool valid_25532 = !bounds_invalid_upwards_25531;
    bool range_valid_c_25533;
    
    if (!valid_25532) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 1, "..", 2, "...", steps_25439,
                               " is invalid.",
                               "-> #0  cva.fut:60:56-67\n   #1  cva.fut:111:17-44\n   #2  cva.fut:173:3-120\n   #3  cva.fut:172:1-173:128\n");
        if (memblock_unref_device(ctx, &res_mem_28239, "res_mem_28239") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28238, "res_mem_28238") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28237, "res_mem_28237") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28236, "res_mem_28236") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28513,
                                  "group_res_arr_mem_28513") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28189, "mem_28189") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28184, "mem_28184") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28182, "mem_28182") != 0)
            return 1;
        return 1;
    }
    
    bool bounds_invalid_upwards_25535 = slt64(paths_25438, 0);
    bool valid_25536 = !bounds_invalid_upwards_25535;
    bool range_valid_c_25537;
    
    if (!valid_25536) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", paths_25438,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:126:11-16\n   #2  lib/github.com/diku-dk/cpprandom/random.fut:174:8-56\n   #3  cva.fut:115:19-49\n   #4  cva.fut:173:3-120\n   #5  cva.fut:172:1-173:128\n");
        if (memblock_unref_device(ctx, &res_mem_28239, "res_mem_28239") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28238, "res_mem_28238") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28237, "res_mem_28237") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28236, "res_mem_28236") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28513,
                                  "group_res_arr_mem_28513") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28189, "mem_28189") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28184, "mem_28184") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28182, "mem_28182") != 0)
            return 1;
        return 1;
    }
    
    int64_t upper_bound_25540 = sub64(steps_25439, 1);
    float res_25541;
    
    res_25541 = futrts_sqrt32(dt_25452);
    
    int64_t segmap_group_sizze_27667;
    
    segmap_group_sizze_27667 = ctx->sizes.testzisegmap_group_sizze_27650;
    
    int64_t segmap_usable_groups_27668 = sdiv_up64(paths_25438,
                                                   segmap_group_sizze_27667);
    int64_t bytes_28241 = 4 * paths_25438;
    struct memblock_device mem_28242;
    
    mem_28242.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28242, bytes_28241, "mem_28242")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27648, 1,
                                            sizeof(paths_25438), &paths_25438));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27648, 2,
                                            sizeof(mem_28242.mem),
                                            &mem_28242.mem));
    if (1 * ((size_t) segmap_usable_groups_27668 *
             (size_t) segmap_group_sizze_27667) != 0) {
        const size_t global_work_sizze_29541[1] =
                     {(size_t) segmap_usable_groups_27668 *
                     (size_t) segmap_group_sizze_27667};
        const size_t local_work_sizze_29545[1] = {segmap_group_sizze_27667};
        int64_t time_start_29542 = 0, time_end_29543 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segmap_27648");
            fprintf(stderr, "%zu", global_work_sizze_29541[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_29545[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_29542 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegmap_27648,
                                                        1, NULL,
                                                        global_work_sizze_29541,
                                                        local_work_sizze_29545,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegmap_27648_runs,
                                                                                                  &ctx->testzisegmap_27648_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_29543 = get_wall_time();
            
            long time_diff_29544 = time_end_29543 - time_start_29542;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "test.segmap_27648",
                    time_diff_29544);
        }
    }
    
    int64_t nest_sizze_27691 = paths_25438 * steps_25439;
    int64_t segmap_group_sizze_27692;
    
    segmap_group_sizze_27692 = ctx->sizes.testzisegmap_group_sizze_27587;
    
    int64_t segmap_usable_groups_27693 = sdiv_up64(nest_sizze_27691,
                                                   segmap_group_sizze_27692);
    int64_t bytes_28244 = 4 * nest_sizze_27691;
    struct memblock_device mem_28246;
    
    mem_28246.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28246, bytes_28244, "mem_28246")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27584, 1,
                                            sizeof(paths_25438), &paths_25438));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27584, 2,
                                            sizeof(steps_25439), &steps_25439));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27584, 3,
                                            sizeof(mem_28242.mem),
                                            &mem_28242.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27584, 4,
                                            sizeof(mem_28246.mem),
                                            &mem_28246.mem));
    if (1 * ((size_t) segmap_usable_groups_27693 *
             (size_t) segmap_group_sizze_27692) != 0) {
        const size_t global_work_sizze_29546[1] =
                     {(size_t) segmap_usable_groups_27693 *
                     (size_t) segmap_group_sizze_27692};
        const size_t local_work_sizze_29550[1] = {segmap_group_sizze_27692};
        int64_t time_start_29547 = 0, time_end_29548 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segmap_27584");
            fprintf(stderr, "%zu", global_work_sizze_29546[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_29550[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_29547 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegmap_27584,
                                                        1, NULL,
                                                        global_work_sizze_29546,
                                                        local_work_sizze_29550,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegmap_27584_runs,
                                                                                                  &ctx->testzisegmap_27584_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_29548 = get_wall_time();
            
            long time_diff_29549 = time_end_29548 - time_start_29547;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "test.segmap_27584",
                    time_diff_29549);
        }
    }
    if (memblock_unref_device(ctx, &mem_28242, "mem_28242") != 0)
        return 1;
    
    int64_t segmap_group_sizze_27737;
    
    segmap_group_sizze_27737 = ctx->sizes.testzisegmap_group_sizze_27488;
    
    int64_t num_groups_27738;
    int32_t max_num_groups_28626;
    
    max_num_groups_28626 = ctx->sizes.testzisegmap_num_groups_27490;
    num_groups_27738 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_25438,
                                                               sext_i32_i64(segmap_group_sizze_27737)),
                                                     sext_i32_i64(max_num_groups_28626))));
    
    struct memblock_device mem_28249;
    
    mem_28249.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28249, bytes_28244, "mem_28249")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_28249, 0, mem_28246, 0,
                                              1, steps_25439, paths_25438) !=
        0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &mem_28246, "mem_28246") != 0)
        return 1;
    
    struct memblock_device mem_28267;
    
    mem_28267.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28267, bytes_28244, "mem_28267")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_28251 = 4 * steps_25439;
    int64_t num_threads_28491 = segmap_group_sizze_27737 * num_groups_27738;
    int64_t total_sizze_28492 = bytes_28251 * num_threads_28491;
    struct memblock_device mem_28252;
    
    mem_28252.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28252, total_sizze_28492,
                              "mem_28252")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27486, 1,
                                            sizeof(ctx->failure_is_an_option),
                                            &ctx->failure_is_an_option));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27486, 3,
                                            sizeof(paths_25438), &paths_25438));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27486, 4,
                                            sizeof(steps_25439), &steps_25439));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27486, 5,
                                            sizeof(dt_25452), &dt_25452));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27486, 6,
                                            sizeof(upper_bound_25540),
                                            &upper_bound_25540));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27486, 7,
                                            sizeof(res_25541), &res_25541));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27486, 8,
                                            sizeof(num_groups_27738),
                                            &num_groups_27738));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27486, 9,
                                            sizeof(mem_28249.mem),
                                            &mem_28249.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27486, 10,
                                            sizeof(mem_28252.mem),
                                            &mem_28252.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27486, 11,
                                            sizeof(mem_28267.mem),
                                            &mem_28267.mem));
    if (1 * ((size_t) num_groups_27738 * (size_t) segmap_group_sizze_27737) !=
        0) {
        const size_t global_work_sizze_29551[1] = {(size_t) num_groups_27738 *
                     (size_t) segmap_group_sizze_27737};
        const size_t local_work_sizze_29555[1] = {segmap_group_sizze_27737};
        int64_t time_start_29552 = 0, time_end_29553 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segmap_27486");
            fprintf(stderr, "%zu", global_work_sizze_29551[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_29555[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_29552 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegmap_27486,
                                                        1, NULL,
                                                        global_work_sizze_29551,
                                                        local_work_sizze_29555,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegmap_27486_runs,
                                                                                                  &ctx->testzisegmap_27486_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_29553 = get_wall_time();
            
            long time_diff_29554 = time_end_29553 - time_start_29552;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "test.segmap_27486",
                    time_diff_29554);
        }
    }
    ctx->failure_is_an_option = 1;
    if (memblock_unref_device(ctx, &mem_28249, "mem_28249") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
        return 1;
    
    int64_t flat_dim_25605 = 9 * paths_25438;
    float res_25609 = sitofp_i64_f32(paths_25438);
    int64_t segscan_group_sizze_27833;
    
    segscan_group_sizze_27833 = ctx->sizes.testzisegscan_group_sizze_27832;
    
    int64_t num_groups_27835;
    int32_t max_num_groups_28638;
    
    max_num_groups_28638 = ctx->sizes.testzisegscan_num_groups_27834;
    num_groups_27835 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_25605,
                                                               sext_i32_i64(segscan_group_sizze_27833)),
                                                     sext_i32_i64(max_num_groups_28638))));
    
    int64_t segred_group_sizze_27841;
    
    segred_group_sizze_27841 = ctx->sizes.testzisegred_group_sizze_27840;
    
    int64_t num_groups_27843;
    int32_t max_num_groups_28639;
    
    max_num_groups_28639 = ctx->sizes.testzisegred_num_groups_27842;
    num_groups_27843 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_25605,
                                                               sext_i32_i64(segred_group_sizze_27841)),
                                                     sext_i32_i64(max_num_groups_28639))));
    
    int64_t seghist_group_sizze_27851;
    
    seghist_group_sizze_27851 = ctx->sizes.testziseghist_group_sizze_27850;
    
    int64_t num_groups_27853;
    int32_t max_num_groups_28640;
    
    max_num_groups_28640 = ctx->sizes.testziseghist_num_groups_27852;
    num_groups_27853 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_25605,
                                                               sext_i32_i64(seghist_group_sizze_27851)),
                                                     sext_i32_i64(max_num_groups_28640))));
    
    int64_t segscan_group_sizze_27866;
    
    segscan_group_sizze_27866 = ctx->sizes.testzisegscan_group_sizze_27865;
    
    int64_t segscan_group_sizze_27874;
    
    segscan_group_sizze_27874 = ctx->sizes.testzisegscan_group_sizze_27873;
    
    int64_t segscan_group_sizze_27882;
    
    segscan_group_sizze_27882 = ctx->sizes.testzisegscan_group_sizze_27881;
    
    int64_t segscan_group_sizze_27934;
    
    segscan_group_sizze_27934 = ctx->sizes.testzisegscan_group_sizze_27933;
    
    bool suff_outer_redomap_27947;
    
    suff_outer_redomap_27947 = ctx->sizes.testzisuff_outer_redomap_7 <=
        paths_25438;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_outer_redomap_7",
                paths_25438);
    
    int64_t segred_group_sizze_27959;
    
    segred_group_sizze_27959 = ctx->sizes.testzisegred_group_sizze_27949;
    
    int64_t num_groups_27960;
    int32_t max_num_groups_28641;
    
    max_num_groups_28641 = ctx->sizes.testzisegred_num_groups_27951;
    num_groups_27960 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_25438,
                                                               sext_i32_i64(segred_group_sizze_27959)),
                                                     sext_i32_i64(max_num_groups_28641))));
    
    bool suff_outer_par_28055;
    
    suff_outer_par_28055 = ctx->sizes.testzisuff_outer_par_8 <= paths_25438;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_outer_par_8",
                paths_25438);
    
    int64_t segmap_group_sizze_28058;
    
    segmap_group_sizze_28058 = ctx->sizes.testzisegmap_group_sizze_27981;
    
    int64_t segred_group_sizze_28070;
    
    segred_group_sizze_28070 = ctx->sizes.testzisegred_group_sizze_28014;
    
    int64_t num_groups_28071;
    int32_t max_num_groups_28642;
    
    max_num_groups_28642 = ctx->sizes.testzisegred_num_groups_28016;
    num_groups_28071 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_25605,
                                                               sext_i32_i64(segred_group_sizze_28070)),
                                                     sext_i32_i64(max_num_groups_28642))));
    
    int64_t segmap_group_sizze_28080;
    
    segmap_group_sizze_28080 = ctx->sizes.testzisegmap_group_sizze_28006;
    
    int64_t segred_group_sizze_28087;
    
    segred_group_sizze_28087 = ctx->sizes.testzisegred_group_sizze_28045;
    
    int64_t num_groups_28088;
    int32_t max_num_groups_28643;
    
    max_num_groups_28643 = ctx->sizes.testzisegred_num_groups_28047;
    num_groups_28088 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_25438,
                                                               sext_i32_i64(segred_group_sizze_28087)),
                                                     sext_i32_i64(max_num_groups_28643))));
    
    int64_t segmap_usable_groups_28059 = sdiv_up_safe64(paths_25438,
                                                        segmap_group_sizze_28058);
    int64_t segmap_usable_groups_28081 = sdiv_up_safe64(paths_25438,
                                                        segmap_group_sizze_28080);
    int64_t bytes_28269 = 8 * flat_dim_25605;
    struct memblock_device mem_28270;
    
    mem_28270.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28270, bytes_28269, "mem_28270")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28272;
    
    mem_28272.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28272, bytes_28269, "mem_28272")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28275;
    
    mem_28275.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28275, 8, "mem_28275")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_28302 = 4 * flat_dim_25605;
    float res_25611;
    float redout_27763 = 0.0F;
    
    for (int64_t i_27764 = 0; i_27764 < steps_25439; i_27764++) {
        int64_t index_primexp_28125 = add64(1, i_27764);
        float res_25617 = sitofp_i64_f32(index_primexp_28125);
        float res_25618 = res_25617 / sims_per_year_25530;
        
        if (slt64(0, flat_dim_25605)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_28645;
            
            stage1_max_num_groups_28645 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_28646;
            
            stage1_num_groups_28646 = smin64(stage1_max_num_groups_28645,
                                             num_groups_27835);
            
            int32_t num_threads_28647;
            
            num_threads_28647 = sext_i64_i32(stage1_num_groups_28646 *
                segscan_group_sizze_27833);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27838,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_27833),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27838,
                                                    2, sizeof(flat_dim_25605),
                                                    &flat_dim_25605));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27838,
                                                    3, sizeof(res_25618),
                                                    &res_25618));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27838,
                                                    4,
                                                    sizeof(res_mem_28238.mem),
                                                    &res_mem_28238.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27838,
                                                    5,
                                                    sizeof(res_mem_28239.mem),
                                                    &res_mem_28239.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27838,
                                                    6, sizeof(mem_28270.mem),
                                                    &mem_28270.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27838,
                                                    7, sizeof(mem_28272.mem),
                                                    &mem_28272.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27838,
                                                    8,
                                                    sizeof(num_threads_28647),
                                                    &num_threads_28647));
            if (1 * ((size_t) stage1_num_groups_28646 *
                     (size_t) segscan_group_sizze_27833) != 0) {
                const size_t global_work_sizze_29556[1] =
                             {(size_t) stage1_num_groups_28646 *
                             (size_t) segscan_group_sizze_27833};
                const size_t local_work_sizze_29560[1] =
                             {segscan_group_sizze_27833};
                int64_t time_start_29557 = 0, time_end_29558 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage1_27838");
                    fprintf(stderr, "%zu", global_work_sizze_29556[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29560[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_27833)));
                    time_start_29557 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage1_27838,
                                                                1, NULL,
                                                                global_work_sizze_29556,
                                                                local_work_sizze_29560,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage1_27838_runs,
                                                                                                          &ctx->testziscan_stage1_27838_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29558 = get_wall_time();
                    
                    long time_diff_29559 = time_end_29558 - time_start_29557;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage1_27838", time_diff_29559);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_27833 *
                                     sdiv_up64(flat_dim_25605,
                                               sext_i32_i64(num_threads_28647))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27838,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_28646),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27838,
                                                    2, sizeof(flat_dim_25605),
                                                    &flat_dim_25605));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27838,
                                                    3, sizeof(mem_28270.mem),
                                                    &mem_28270.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27838,
                                                    4,
                                                    sizeof(stage1_num_groups_28646),
                                                    &stage1_num_groups_28646));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27838,
                                                    5,
                                                    sizeof(num_threads_28647),
                                                    &num_threads_28647));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28646) != 0) {
                const size_t global_work_sizze_29561[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_28646};
                const size_t local_work_sizze_29565[1] =
                             {stage1_num_groups_28646};
                int64_t time_start_29562 = 0, time_end_29563 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage2_27838");
                    fprintf(stderr, "%zu", global_work_sizze_29561[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29565[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_28646)));
                    time_start_29562 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage2_27838,
                                                                1, NULL,
                                                                global_work_sizze_29561,
                                                                local_work_sizze_29565,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage2_27838_runs,
                                                                                                          &ctx->testziscan_stage2_27838_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29563 = get_wall_time();
                    
                    long time_diff_29564 = time_end_29563 - time_start_29562;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage2_27838", time_diff_29564);
                }
            }
            
            int32_t required_groups_28683;
            
            required_groups_28683 = sext_i64_i32(sdiv_up64(flat_dim_25605,
                                                           segscan_group_sizze_27833));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27838,
                                                    1, sizeof(flat_dim_25605),
                                                    &flat_dim_25605));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27838,
                                                    2, sizeof(num_groups_27835),
                                                    &num_groups_27835));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27838,
                                                    3, sizeof(mem_28270.mem),
                                                    &mem_28270.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27838,
                                                    4,
                                                    sizeof(num_threads_28647),
                                                    &num_threads_28647));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27838,
                                                    5,
                                                    sizeof(required_groups_28683),
                                                    &required_groups_28683));
            if (1 * ((size_t) num_groups_27835 *
                     (size_t) segscan_group_sizze_27833) != 0) {
                const size_t global_work_sizze_29566[1] =
                             {(size_t) num_groups_27835 *
                             (size_t) segscan_group_sizze_27833};
                const size_t local_work_sizze_29570[1] =
                             {segscan_group_sizze_27833};
                int64_t time_start_29567 = 0, time_end_29568 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage3_27838");
                    fprintf(stderr, "%zu", global_work_sizze_29566[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29570[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29567 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage3_27838,
                                                                1, NULL,
                                                                global_work_sizze_29566,
                                                                local_work_sizze_29570,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage3_27838_runs,
                                                                                                          &ctx->testziscan_stage3_27838_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29568 = get_wall_time();
                    
                    long time_diff_29569 = time_end_29568 - time_start_29567;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage3_27838", time_diff_29569);
                }
            }
        }
        
        struct memblock_device testzicounter_mem_28695 =
                               ctx->testzicounter_mem_28695;
        struct memblock_device group_res_arr_mem_28697;
        
        group_res_arr_mem_28697.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28697,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_27841 * num_groups_27843),
                                  "group_res_arr_mem_28697")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28699;
        
        num_threads_28699 = num_groups_27843 * segred_group_sizze_27841;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27848,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_27841,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27848,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27848,
                                                3, sizeof(flat_dim_25605),
                                                &flat_dim_25605));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27848,
                                                4, sizeof(num_groups_27843),
                                                &num_groups_27843));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27848,
                                                5, sizeof(mem_28272.mem),
                                                &mem_28272.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27848,
                                                6, sizeof(mem_28275.mem),
                                                &mem_28275.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27848,
                                                7,
                                                sizeof(testzicounter_mem_28695.mem),
                                                &testzicounter_mem_28695.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27848,
                                                8,
                                                sizeof(group_res_arr_mem_28697.mem),
                                                &group_res_arr_mem_28697.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27848,
                                                9, sizeof(num_threads_28699),
                                                &num_threads_28699));
        if (1 * ((size_t) num_groups_27843 *
                 (size_t) segred_group_sizze_27841) != 0) {
            const size_t global_work_sizze_29572[1] =
                         {(size_t) num_groups_27843 *
                         (size_t) segred_group_sizze_27841};
            const size_t local_work_sizze_29576[1] = {segred_group_sizze_27841};
            int64_t time_start_29573 = 0, time_end_29574 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segred_nonseg_27848");
                fprintf(stderr, "%zu", global_work_sizze_29572[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29576[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_27841 +
                               (int32_t) sizeof(bool)));
                time_start_29573 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegred_nonseg_27848,
                                                            1, NULL,
                                                            global_work_sizze_29572,
                                                            local_work_sizze_29576,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegred_nonseg_27848_runs,
                                                                                                      &ctx->testzisegred_nonseg_27848_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29574 = get_wall_time();
                
                long time_diff_29575 = time_end_29574 - time_start_29573;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segred_nonseg_27848", time_diff_29575);
            }
        }
        
        int64_t read_res_29577;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_28275.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_29577, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t res_25638 = read_res_29577;
        bool bounds_invalid_upwards_25643 = slt64(res_25638, 0);
        bool valid_25644 = !bounds_invalid_upwards_25643;
        bool range_valid_c_25645;
        
        if (!valid_25644) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Range ", 0, "..", 1, "..<", res_25638,
                          " is invalid.",
                          "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:48:30-60\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:87:14-32\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva.fut:132:34-93\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  cva.fut:126:18-137:50\n   #9  cva.fut:173:3-120\n   #10 cva.fut:172:1-173:128\n");
            if (memblock_unref_device(ctx, &group_res_arr_mem_28697,
                                      "group_res_arr_mem_28697") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28275, "mem_28275") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28272, "mem_28272") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28270, "mem_28270") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28267, "mem_28267") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28249, "mem_28249") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28246, "mem_28246") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28242, "mem_28242") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28239, "res_mem_28239") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28238, "res_mem_28238") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28237, "res_mem_28237") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28236, "res_mem_28236") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28513,
                                      "group_res_arr_mem_28513") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28189, "mem_28189") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28184, "mem_28184") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28182, "mem_28182") != 0)
                return 1;
            return 1;
        }
        
        int64_t bytes_28276 = 8 * res_25638;
        struct memblock_device mem_28277;
        
        mem_28277.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28277, bytes_28276, "mem_28277")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_28277, res_25638, 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int32_t num_subhistos_28734;
        struct memblock_device res_subhistos_mem_28735;
        
        res_subhistos_mem_28735.references = NULL;
        
        int64_t h_28737;
        
        h_28737 = (int32_t) sizeof(int64_t) * res_25638;
        
        int64_t seg_h_28738;
        
        seg_h_28738 = (int32_t) sizeof(int64_t) * res_25638;
        if (!(seg_h_28738 == 0)) {
            int64_t hist_H_28739 = res_25638;
            int64_t hist_el_sizze_28740 = sdiv_up64(h_28737, hist_H_28739) + 4;
            int64_t hist_N_28741 = flat_dim_25605;
            int64_t hist_RF_28742 = 1;
            
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegHist");
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of threads (T)",
                        (long long) sext_i64_i32(num_groups_27853 *
                        seghist_group_sizze_27851), '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Desired group size (B)",
                        (long long) seghist_group_sizze_27851, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                        (long long) hist_H_28739, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Input elements per histogram (N)",
                        (long long) hist_N_28741, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of segments",
                        (long long) 1, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Histogram element size (el_size)",
                        (long long) hist_el_sizze_28740, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Race factor (RF)",
                        (long long) hist_RF_28742, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Memory per set of subhistograms per segment",
                        (long long) h_28737, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Memory per set of subhistograms times segments",
                        (long long) seg_h_28738, '\n');
            
            int32_t hist_L_28743;
            
            hist_L_28743 = ctx->opencl.max_local_memory;
            
            int32_t max_group_sizze_28744;
            
            max_group_sizze_28744 = ctx->opencl.max_group_size;
            
            int64_t num_groups_28745;
            
            num_groups_28745 =
                sdiv_up64(sext_i32_i64(sext_i64_i32(num_groups_27853 *
                          seghist_group_sizze_27851)), max_group_sizze_28744);
            
            double hist_m_prime_28746;
            
            hist_m_prime_28746 =
                sitofp_i64_f64(smin64(sext_i32_i64(squot32(hist_L_28743,
                                                           hist_el_sizze_28740)),
                                      sdiv_up64(hist_N_28741,
                                                num_groups_28745))) /
                sitofp_i64_f64(hist_H_28739);
            
            int64_t hist_M0_28747;
            
            hist_M0_28747 = smax64(1, smin64(fptosi_f64_i64(hist_m_prime_28746),
                                             max_group_sizze_28744));
            
            int64_t hist_Nout_28748;
            
            hist_Nout_28748 = 1;
            
            int64_t hist_Nin_28749;
            
            hist_Nin_28749 = flat_dim_25605;
            
            int64_t work_asymp_M_max_28750;
            
            work_asymp_M_max_28750 = squot64(hist_Nout_28748 * hist_N_28741, 2 *
                                             num_groups_28745 * hist_H_28739);
            
            int32_t hist_M_28751;
            
            hist_M_28751 = sext_i64_i32(smin64(hist_M0_28747,
                                               work_asymp_M_max_28750));
            
            int64_t hist_C_28752;
            
            hist_C_28752 = sdiv_up64(max_group_sizze_28744,
                                     sext_i32_i64(smax32(1, hist_M_28751)));
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local hist_M0",
                        (long long) hist_M0_28747, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local work asymp M max",
                        (long long) work_asymp_M_max_28750, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local C",
                        (long long) hist_C_28752, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local B",
                        (long long) max_group_sizze_28744, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local M",
                        (long long) hist_M_28751, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local memory needed",
                        (long long) (hist_H_28739 * hist_el_sizze_28740 *
                                     sext_i32_i64(hist_M_28751)), '\n');
            
            int64_t local_mem_needed_28753;
            
            local_mem_needed_28753 = hist_el_sizze_28740 *
                sext_i32_i64(hist_M_28751);
            
            int32_t hist_S_28754;
            
            hist_S_28754 = sext_i64_i32(sdiv_up64(hist_H_28739 *
                                                  local_mem_needed_28753,
                                                  hist_L_28743));
            if (sle64(hist_H_28739, hist_Nin_28749) &&
                (sle64(local_mem_needed_28753, hist_L_28743) &&
                 (sle32(hist_S_28754, 6) && (sle64(hist_C_28752,
                                                   max_group_sizze_28744) &&
                                             slt32(0, hist_M_28751))))) {
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "## Using local memory");
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                            (long long) hist_H_28739, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                            (long long) hist_M_28751, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Cooperation level (C)",
                            (long long) hist_C_28752, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                            (long long) hist_S_28754, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c",
                            "Number of local subhistograms per group",
                            (long long) hist_M_28751, '\n');
                
                int64_t num_segments_28755;
                
                num_segments_28755 = 1;
                num_subhistos_28734 = num_groups_28745 * num_segments_28755;
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c",
                            "Number of subhistograms in global memory",
                            (long long) num_subhistos_28734, '\n');
                if (num_subhistos_28734 == 1) {
                    if (memblock_set_device(ctx, &res_subhistos_mem_28735,
                                            &mem_28277, "mem_28277") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &res_subhistos_mem_28735,
                                              sext_i32_i64(num_subhistos_28734) *
                                              res_25638 *
                                              (int32_t) sizeof(int64_t),
                                              "res_subhistos_mem_28735")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx,
                                                      res_subhistos_mem_28735,
                                                      num_subhistos_28734 *
                                                      res_25638, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (res_25638 * (int32_t) sizeof(int64_t) > 0) {
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                     mem_28277.mem,
                                                                     res_subhistos_mem_28735.mem,
                                                                     0, 0,
                                                                     res_25638 *
                                                                     (int32_t) sizeof(int64_t),
                                                                     0, NULL,
                                                                     ctx->profiling_paused ||
                                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
                        if (ctx->debugging)
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    }
                }
                for (int32_t chk_i_28756 = 0; chk_i_28756 < hist_S_28754;
                     chk_i_28756++) {
                    int64_t num_segments_28757 = 1;
                    int64_t hist_H_chk_28758 = sdiv_up64(res_25638,
                                                         sext_i32_i64(hist_S_28754));
                    int64_t histo_sizze_28759 = hist_H_chk_28758;
                    int32_t init_per_thread_28760 =
                            sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_28751) *
                                                   histo_sizze_28759,
                                                   max_group_sizze_28744));
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27856,
                                                            1,
                                                            (int32_t) sizeof(int32_t) *
                                                            (hist_M_28751 *
                                                             hist_H_chk_28758),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27856,
                                                            2,
                                                            (int32_t) sizeof(int64_t) *
                                                            (hist_M_28751 *
                                                             hist_H_chk_28758),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27856,
                                                            3,
                                                            sizeof(flat_dim_25605),
                                                            &flat_dim_25605));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27856,
                                                            4,
                                                            sizeof(res_25638),
                                                            &res_25638));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27856,
                                                            5,
                                                            sizeof(mem_28270.mem),
                                                            &mem_28270.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27856,
                                                            6,
                                                            sizeof(res_subhistos_mem_28735.mem),
                                                            &res_subhistos_mem_28735.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27856,
                                                            7,
                                                            sizeof(max_group_sizze_28744),
                                                            &max_group_sizze_28744));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27856,
                                                            8,
                                                            sizeof(num_groups_28745),
                                                            &num_groups_28745));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27856,
                                                            9,
                                                            sizeof(hist_M_28751),
                                                            &hist_M_28751));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27856,
                                                            10,
                                                            sizeof(chk_i_28756),
                                                            &chk_i_28756));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27856,
                                                            11,
                                                            sizeof(num_segments_28757),
                                                            &num_segments_28757));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27856,
                                                            12,
                                                            sizeof(hist_H_chk_28758),
                                                            &hist_H_chk_28758));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27856,
                                                            13,
                                                            sizeof(histo_sizze_28759),
                                                            &histo_sizze_28759));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27856,
                                                            14,
                                                            sizeof(init_per_thread_28760),
                                                            &init_per_thread_28760));
                    if (1 * ((size_t) num_groups_28745 *
                             (size_t) max_group_sizze_28744) != 0) {
                        const size_t global_work_sizze_29578[1] =
                                     {(size_t) num_groups_28745 *
                                     (size_t) max_group_sizze_28744};
                        const size_t local_work_sizze_29582[1] =
                                     {max_group_sizze_28744};
                        int64_t time_start_29579 = 0, time_end_29580 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.seghist_local_27856");
                            fprintf(stderr, "%zu", global_work_sizze_29578[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29582[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(int32_t) *
                                           (hist_M_28751 * hist_H_chk_28758) +
                                           (int32_t) sizeof(int64_t) *
                                           (hist_M_28751 * hist_H_chk_28758)));
                            time_start_29579 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testziseghist_local_27856,
                                                                        1, NULL,
                                                                        global_work_sizze_29578,
                                                                        local_work_sizze_29582,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testziseghist_local_27856_runs,
                                                                                                                  &ctx->testziseghist_local_27856_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29580 = get_wall_time();
                            
                            long time_diff_29581 = time_end_29580 -
                                 time_start_29579;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.seghist_local_27856",
                                    time_diff_29581);
                        }
                    }
                }
            } else {
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "## Using global memory");
                
                int64_t hist_H_28792;
                
                hist_H_28792 = res_25638;
                
                double hist_RF_28793;
                
                hist_RF_28793 = (0.0 + sitofp_i32_f64(1)) / 1.0;
                
                int32_t hist_el_sizze_28794;
                
                hist_el_sizze_28794 =
                    squot32(sext_i64_i32((int32_t) sizeof(int32_t) +
                            (int32_t) sizeof(int64_t)), 2);
                
                double hist_C_max_28795;
                
                hist_C_max_28795 =
                    fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_27853 *
                           seghist_group_sizze_27851)),
                           sitofp_i32_f64(hist_H_28792) / 2.0);
                
                int32_t hist_M_min_28796;
                
                hist_M_min_28796 = smax32(1,
                                          sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_27853 *
                                          seghist_group_sizze_27851)) /
                                          hist_C_max_28795)));
                
                int32_t L2_sizze_28797;
                
                L2_sizze_28797 = ctx->sizes.testziL2_sizze_28797;
                
                double hist_RACE_exp_28798;
                
                hist_RACE_exp_28798 = fmax64(1.0, 0.75 * hist_RF_28793 / (64.0 /
                                                                          sitofp_i32_f64(hist_el_sizze_28794)));
                
                int32_t hist_S_28799;
                
                if (slt64(flat_dim_25605, hist_H_28792)) {
                    hist_S_28799 = 1;
                } else {
                    hist_S_28799 =
                        sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_min_28796) *
                                               hist_H_28792 *
                                               sext_i32_i64(hist_el_sizze_28794),
                                               fptosi_f64_i64(0.4 *
                                               sitofp_i32_f64(L2_sizze_28797) *
                                               hist_RACE_exp_28798)));
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s: %f%c",
                            "Race expansion factor (RACE^exp)",
                            (double) hist_RACE_exp_28798, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                            (long long) hist_S_28799, '\n');
                
                int64_t hist_H_chk_28800;
                
                hist_H_chk_28800 = sdiv_up64(res_25638,
                                             sext_i32_i64(hist_S_28799));
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Chunk size (H_chk)",
                            (long long) hist_H_chk_28800, '\n');
                
                double hist_k_max_28801;
                
                hist_k_max_28801 = fmin64(0.4 *
                                          (sitofp_i32_f64(L2_sizze_28797) /
                                           sitofp_i32_f64(sext_i64_i32((int32_t) sizeof(int32_t) +
                                           (int32_t) sizeof(int64_t)))) *
                                          hist_RACE_exp_28798,
                                          sitofp_i32_f64(flat_dim_25605)) /
                    sitofp_i32_f64(sext_i64_i32(num_groups_27853 *
                    seghist_group_sizze_27851));
                
                int64_t hist_u_28802;
                
                hist_u_28802 = 1;
                
                double hist_C_28803;
                
                hist_C_28803 =
                    fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_27853 *
                           seghist_group_sizze_27851)),
                           sitofp_i32_f64(hist_u_28802 * hist_H_chk_28800) /
                           hist_k_max_28801);
                
                int32_t hist_M_28804;
                
                hist_M_28804 = smax32(hist_M_min_28796,
                                      sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_27853 *
                                      seghist_group_sizze_27851)) /
                                      hist_C_28803)));
                if (ctx->debugging)
                    fprintf(stderr, "%s: %f%c",
                            "Elements/thread in L2 cache (k_max)",
                            (double) hist_k_max_28801, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                            (long long) hist_M_28804, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %f%c", "Cooperation level (C)",
                            (double) hist_C_28803, '\n');
                num_subhistos_28734 = sext_i32_i64(hist_M_28804);
                if (hist_M_28804 == 1) {
                    if (memblock_set_device(ctx, &res_subhistos_mem_28735,
                                            &mem_28277, "mem_28277") != 0)
                        return 1;
                } else {
                    if (num_subhistos_28734 == 1) {
                        if (memblock_set_device(ctx, &res_subhistos_mem_28735,
                                                &mem_28277, "mem_28277") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &res_subhistos_mem_28735,
                                                  sext_i32_i64(num_subhistos_28734) *
                                                  res_25638 *
                                                  (int32_t) sizeof(int64_t),
                                                  "res_subhistos_mem_28735")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx,
                                                          res_subhistos_mem_28735,
                                                          num_subhistos_28734 *
                                                          res_25638, 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (res_25638 * (int32_t) sizeof(int64_t) > 0) {
                            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                         mem_28277.mem,
                                                                         res_subhistos_mem_28735.mem,
                                                                         0, 0,
                                                                         res_25638 *
                                                                         (int32_t) sizeof(int64_t),
                                                                         0,
                                                                         NULL,
                                                                         ctx->profiling_paused ||
                                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
                            if (ctx->debugging)
                                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        }
                    }
                }
                
                struct memblock_device testzihist_locks_mem_28805 =
                                       ctx->testzihist_locks_mem_28805;
                
                for (int32_t chk_i_28807 = 0; chk_i_28807 < hist_S_28799;
                     chk_i_28807++) {
                    int64_t hist_H_chk_28808 = sdiv_up64(res_25638,
                                                         sext_i32_i64(hist_S_28799));
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27856,
                                                            1,
                                                            sizeof(flat_dim_25605),
                                                            &flat_dim_25605));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27856,
                                                            2,
                                                            sizeof(res_25638),
                                                            &res_25638));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27856,
                                                            3,
                                                            sizeof(num_groups_27853),
                                                            &num_groups_27853));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27856,
                                                            4,
                                                            sizeof(mem_28270.mem),
                                                            &mem_28270.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27856,
                                                            5,
                                                            sizeof(num_subhistos_28734),
                                                            &num_subhistos_28734));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27856,
                                                            6,
                                                            sizeof(res_subhistos_mem_28735.mem),
                                                            &res_subhistos_mem_28735.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27856,
                                                            7,
                                                            sizeof(testzihist_locks_mem_28805.mem),
                                                            &testzihist_locks_mem_28805.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27856,
                                                            8,
                                                            sizeof(chk_i_28807),
                                                            &chk_i_28807));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27856,
                                                            9,
                                                            sizeof(hist_H_chk_28808),
                                                            &hist_H_chk_28808));
                    if (1 * ((size_t) num_groups_27853 *
                             (size_t) seghist_group_sizze_27851) != 0) {
                        const size_t global_work_sizze_29584[1] =
                                     {(size_t) num_groups_27853 *
                                     (size_t) seghist_group_sizze_27851};
                        const size_t local_work_sizze_29588[1] =
                                     {seghist_group_sizze_27851};
                        int64_t time_start_29585 = 0, time_end_29586 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.seghist_global_27856");
                            fprintf(stderr, "%zu", global_work_sizze_29584[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29588[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) 0);
                            time_start_29585 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testziseghist_global_27856,
                                                                        1, NULL,
                                                                        global_work_sizze_29584,
                                                                        local_work_sizze_29588,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testziseghist_global_27856_runs,
                                                                                                                  &ctx->testziseghist_global_27856_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29586 = get_wall_time();
                            
                            long time_diff_29587 = time_end_29586 -
                                 time_start_29585;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.seghist_global_27856",
                                    time_diff_29587);
                        }
                    }
                }
            }
            if (num_subhistos_28734 == 1) {
                if (memblock_set_device(ctx, &mem_28277,
                                        &res_subhistos_mem_28735,
                                        "res_subhistos_mem_28735") != 0)
                    return 1;
            } else {
                if (slt64(num_subhistos_28734 * 2, seghist_group_sizze_27851)) {
                    int64_t segment_sizze_nonzzero_28821 = smax64(1,
                                                                  num_subhistos_28734);
                    int64_t num_threads_28822 = num_groups_27853 *
                            seghist_group_sizze_27851;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-small");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) res_25638, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) num_subhistos_28734, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segments_per_group",
                                (long long) squot64(seghist_group_sizze_27851,
                                                    segment_sizze_nonzzero_28821),
                                '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "required_groups",
                                (long long) sext_i64_i32(sdiv_up64(res_25638,
                                                                   squot64(seghist_group_sizze_27851,
                                                                           segment_sizze_nonzzero_28821))),
                                '\n');
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28820,
                                                            1,
                                                            (int32_t) sizeof(int64_t) *
                                                            seghist_group_sizze_27851,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28820,
                                                            2,
                                                            sizeof(res_25638),
                                                            &res_25638));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28820,
                                                            3,
                                                            sizeof(num_groups_27853),
                                                            &num_groups_27853));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28820,
                                                            4,
                                                            sizeof(mem_28277.mem),
                                                            &mem_28277.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28820,
                                                            5,
                                                            sizeof(num_subhistos_28734),
                                                            &num_subhistos_28734));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28820,
                                                            6,
                                                            sizeof(res_subhistos_mem_28735.mem),
                                                            &res_subhistos_mem_28735.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28820,
                                                            7,
                                                            sizeof(segment_sizze_nonzzero_28821),
                                                            &segment_sizze_nonzzero_28821));
                    if (1 * ((size_t) num_groups_27853 *
                             (size_t) seghist_group_sizze_27851) != 0) {
                        const size_t global_work_sizze_29589[1] =
                                     {(size_t) num_groups_27853 *
                                     (size_t) seghist_group_sizze_27851};
                        const size_t local_work_sizze_29593[1] =
                                     {seghist_group_sizze_27851};
                        int64_t time_start_29590 = 0, time_end_29591 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.segred_small_28820");
                            fprintf(stderr, "%zu", global_work_sizze_29589[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29593[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(int64_t) *
                                           seghist_group_sizze_27851));
                            time_start_29590 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testzisegred_small_28820,
                                                                        1, NULL,
                                                                        global_work_sizze_29589,
                                                                        local_work_sizze_29593,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testzisegred_small_28820_runs,
                                                                                                                  &ctx->testzisegred_small_28820_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29591 = get_wall_time();
                            
                            long time_diff_29592 = time_end_29591 -
                                 time_start_29590;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.segred_small_28820", time_diff_29592);
                        }
                    }
                } else {
                    int64_t groups_per_segment_28842 =
                            sdiv_up64(num_groups_27853, smax64(1, res_25638));
                    int64_t elements_per_thread_28843 =
                            sdiv_up64(num_subhistos_28734,
                                      seghist_group_sizze_27851 *
                                      groups_per_segment_28842);
                    int64_t virt_num_groups_28844 = groups_per_segment_28842 *
                            res_25638;
                    int64_t num_threads_28845 = num_groups_27853 *
                            seghist_group_sizze_27851;
                    int64_t threads_per_segment_28846 =
                            groups_per_segment_28842 *
                            seghist_group_sizze_27851;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-large");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) res_25638, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) num_subhistos_28734, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                                (long long) virt_num_groups_28844, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_groups",
                                (long long) num_groups_27853, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "group_size",
                                (long long) seghist_group_sizze_27851, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                                (long long) elements_per_thread_28843, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                                (long long) groups_per_segment_28842, '\n');
                    
                    struct memblock_device group_res_arr_mem_28847;
                    
                    group_res_arr_mem_28847.references = NULL;
                    if (memblock_alloc_device(ctx, &group_res_arr_mem_28847,
                                              (int32_t) sizeof(int64_t) *
                                              (seghist_group_sizze_27851 *
                                               virt_num_groups_28844),
                                              "group_res_arr_mem_28847")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device testzicounter_mem_28849 =
                                           ctx->testzicounter_mem_28849;
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28820,
                                                            1,
                                                            (int32_t) sizeof(bool),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28820,
                                                            2,
                                                            (int32_t) sizeof(int64_t) *
                                                            seghist_group_sizze_27851,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28820,
                                                            3,
                                                            sizeof(res_25638),
                                                            &res_25638));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28820,
                                                            4,
                                                            sizeof(num_groups_27853),
                                                            &num_groups_27853));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28820,
                                                            5,
                                                            sizeof(mem_28277.mem),
                                                            &mem_28277.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28820,
                                                            6,
                                                            sizeof(num_subhistos_28734),
                                                            &num_subhistos_28734));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28820,
                                                            7,
                                                            sizeof(res_subhistos_mem_28735.mem),
                                                            &res_subhistos_mem_28735.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28820,
                                                            8,
                                                            sizeof(groups_per_segment_28842),
                                                            &groups_per_segment_28842));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28820,
                                                            9,
                                                            sizeof(elements_per_thread_28843),
                                                            &elements_per_thread_28843));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28820,
                                                            10,
                                                            sizeof(virt_num_groups_28844),
                                                            &virt_num_groups_28844));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28820,
                                                            11,
                                                            sizeof(threads_per_segment_28846),
                                                            &threads_per_segment_28846));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28820,
                                                            12,
                                                            sizeof(group_res_arr_mem_28847.mem),
                                                            &group_res_arr_mem_28847.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28820,
                                                            13,
                                                            sizeof(testzicounter_mem_28849.mem),
                                                            &testzicounter_mem_28849.mem));
                    if (1 * ((size_t) num_groups_27853 *
                             (size_t) seghist_group_sizze_27851) != 0) {
                        const size_t global_work_sizze_29595[1] =
                                     {(size_t) num_groups_27853 *
                                     (size_t) seghist_group_sizze_27851};
                        const size_t local_work_sizze_29599[1] =
                                     {seghist_group_sizze_27851};
                        int64_t time_start_29596 = 0, time_end_29597 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.segred_large_28820");
                            fprintf(stderr, "%zu", global_work_sizze_29595[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29599[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(bool) +
                                           (int32_t) sizeof(int64_t) *
                                           seghist_group_sizze_27851));
                            time_start_29596 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testzisegred_large_28820,
                                                                        1, NULL,
                                                                        global_work_sizze_29595,
                                                                        local_work_sizze_29599,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testzisegred_large_28820_runs,
                                                                                                                  &ctx->testzisegred_large_28820_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29597 = get_wall_time();
                            
                            long time_diff_29598 = time_end_29597 -
                                 time_start_29596;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.segred_large_28820", time_diff_29598);
                        }
                    }
                    if (memblock_unref_device(ctx, &group_res_arr_mem_28847,
                                              "group_res_arr_mem_28847") != 0)
                        return 1;
                }
            }
        }
        
        int64_t num_groups_27868;
        int32_t max_num_groups_28881;
        
        max_num_groups_28881 = ctx->sizes.testzisegscan_num_groups_27867;
        num_groups_27868 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_25638,
                                                                   sext_i32_i64(segscan_group_sizze_27866)),
                                                         sext_i32_i64(max_num_groups_28881))));
        
        struct memblock_device mem_28281;
        
        mem_28281.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28281, res_25638, "mem_28281")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28283;
        
        mem_28283.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28283, bytes_28276, "mem_28283")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_25638)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_28882;
            
            stage1_max_num_groups_28882 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_28883;
            
            stage1_num_groups_28883 = smin64(stage1_max_num_groups_28882,
                                             num_groups_27868);
            
            int32_t num_threads_28884;
            
            num_threads_28884 = sext_i64_i32(stage1_num_groups_28883 *
                segscan_group_sizze_27866);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27871,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_27866),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27871,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              segscan_group_sizze_27866),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27871,
                                                    3, sizeof(res_25638),
                                                    &res_25638));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27871,
                                                    4, sizeof(mem_28277.mem),
                                                    &mem_28277.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27871,
                                                    5, sizeof(mem_28281.mem),
                                                    &mem_28281.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27871,
                                                    6, sizeof(mem_28283.mem),
                                                    &mem_28283.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27871,
                                                    7,
                                                    sizeof(num_threads_28884),
                                                    &num_threads_28884));
            if (1 * ((size_t) stage1_num_groups_28883 *
                     (size_t) segscan_group_sizze_27866) != 0) {
                const size_t global_work_sizze_29600[1] =
                             {(size_t) stage1_num_groups_28883 *
                             (size_t) segscan_group_sizze_27866};
                const size_t local_work_sizze_29604[1] =
                             {segscan_group_sizze_27866};
                int64_t time_start_29601 = 0, time_end_29602 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage1_27871");
                    fprintf(stderr, "%zu", global_work_sizze_29600[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29604[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_27866) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          segscan_group_sizze_27866)));
                    time_start_29601 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage1_27871,
                                                                1, NULL,
                                                                global_work_sizze_29600,
                                                                local_work_sizze_29604,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage1_27871_runs,
                                                                                                          &ctx->testziscan_stage1_27871_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29602 = get_wall_time();
                    
                    long time_diff_29603 = time_end_29602 - time_start_29601;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage1_27871", time_diff_29603);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_27866 *
                                     sdiv_up64(res_25638,
                                               sext_i32_i64(num_threads_28884))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27871,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_28883),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27871,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              stage1_num_groups_28883),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27871,
                                                    3, sizeof(res_25638),
                                                    &res_25638));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27871,
                                                    4, sizeof(mem_28281.mem),
                                                    &mem_28281.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27871,
                                                    5, sizeof(mem_28283.mem),
                                                    &mem_28283.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27871,
                                                    6,
                                                    sizeof(stage1_num_groups_28883),
                                                    &stage1_num_groups_28883));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27871,
                                                    7,
                                                    sizeof(num_threads_28884),
                                                    &num_threads_28884));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28883) != 0) {
                const size_t global_work_sizze_29605[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_28883};
                const size_t local_work_sizze_29609[1] =
                             {stage1_num_groups_28883};
                int64_t time_start_29606 = 0, time_end_29607 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage2_27871");
                    fprintf(stderr, "%zu", global_work_sizze_29605[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29609[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_28883) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          stage1_num_groups_28883)));
                    time_start_29606 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage2_27871,
                                                                1, NULL,
                                                                global_work_sizze_29605,
                                                                local_work_sizze_29609,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage2_27871_runs,
                                                                                                          &ctx->testziscan_stage2_27871_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29607 = get_wall_time();
                    
                    long time_diff_29608 = time_end_29607 - time_start_29606;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage2_27871", time_diff_29608);
                }
            }
            
            int32_t required_groups_28936;
            
            required_groups_28936 = sext_i64_i32(sdiv_up64(res_25638,
                                                           segscan_group_sizze_27866));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27871,
                                                    1, sizeof(res_25638),
                                                    &res_25638));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27871,
                                                    2, sizeof(num_groups_27868),
                                                    &num_groups_27868));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27871,
                                                    3, sizeof(mem_28281.mem),
                                                    &mem_28281.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27871,
                                                    4, sizeof(mem_28283.mem),
                                                    &mem_28283.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27871,
                                                    5,
                                                    sizeof(num_threads_28884),
                                                    &num_threads_28884));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27871,
                                                    6,
                                                    sizeof(required_groups_28936),
                                                    &required_groups_28936));
            if (1 * ((size_t) num_groups_27868 *
                     (size_t) segscan_group_sizze_27866) != 0) {
                const size_t global_work_sizze_29610[1] =
                             {(size_t) num_groups_27868 *
                             (size_t) segscan_group_sizze_27866};
                const size_t local_work_sizze_29614[1] =
                             {segscan_group_sizze_27866};
                int64_t time_start_29611 = 0, time_end_29612 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage3_27871");
                    fprintf(stderr, "%zu", global_work_sizze_29610[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29614[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29611 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage3_27871,
                                                                1, NULL,
                                                                global_work_sizze_29610,
                                                                local_work_sizze_29614,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage3_27871_runs,
                                                                                                          &ctx->testziscan_stage3_27871_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29612 = get_wall_time();
                    
                    long time_diff_29613 = time_end_29612 - time_start_29611;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage3_27871", time_diff_29613);
                }
            }
        }
        if (memblock_unref_device(ctx, &mem_28277, "mem_28277") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28281, "mem_28281") != 0)
            return 1;
        
        int64_t num_groups_27876;
        int32_t max_num_groups_28948;
        
        max_num_groups_28948 = ctx->sizes.testzisegscan_num_groups_27875;
        num_groups_27876 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_25638,
                                                                   sext_i32_i64(segscan_group_sizze_27874)),
                                                         sext_i32_i64(max_num_groups_28948))));
        
        struct memblock_device mem_28286;
        
        mem_28286.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28286, res_25638, "mem_28286")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28288;
        
        mem_28288.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28288, bytes_28276, "mem_28288")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28290;
        
        mem_28290.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28290, res_25638, "mem_28290")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_25638)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_28949;
            
            stage1_max_num_groups_28949 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_28950;
            
            stage1_num_groups_28950 = smin64(stage1_max_num_groups_28949,
                                             num_groups_27876);
            
            int32_t num_threads_28951;
            
            num_threads_28951 = sext_i64_i32(stage1_num_groups_28950 *
                segscan_group_sizze_27874);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27879,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_27874),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27879,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              segscan_group_sizze_27874),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27879,
                                                    3, sizeof(res_25638),
                                                    &res_25638));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27879,
                                                    4, sizeof(mem_28283.mem),
                                                    &mem_28283.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27879,
                                                    5, sizeof(mem_28286.mem),
                                                    &mem_28286.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27879,
                                                    6, sizeof(mem_28288.mem),
                                                    &mem_28288.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27879,
                                                    7, sizeof(mem_28290.mem),
                                                    &mem_28290.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27879,
                                                    8,
                                                    sizeof(num_threads_28951),
                                                    &num_threads_28951));
            if (1 * ((size_t) stage1_num_groups_28950 *
                     (size_t) segscan_group_sizze_27874) != 0) {
                const size_t global_work_sizze_29615[1] =
                             {(size_t) stage1_num_groups_28950 *
                             (size_t) segscan_group_sizze_27874};
                const size_t local_work_sizze_29619[1] =
                             {segscan_group_sizze_27874};
                int64_t time_start_29616 = 0, time_end_29617 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage1_27879");
                    fprintf(stderr, "%zu", global_work_sizze_29615[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29619[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_27874) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          segscan_group_sizze_27874)));
                    time_start_29616 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage1_27879,
                                                                1, NULL,
                                                                global_work_sizze_29615,
                                                                local_work_sizze_29619,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage1_27879_runs,
                                                                                                          &ctx->testziscan_stage1_27879_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29617 = get_wall_time();
                    
                    long time_diff_29618 = time_end_29617 - time_start_29616;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage1_27879", time_diff_29618);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_27874 *
                                     sdiv_up64(res_25638,
                                               sext_i32_i64(num_threads_28951))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27879,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_28950),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27879,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              stage1_num_groups_28950),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27879,
                                                    3, sizeof(res_25638),
                                                    &res_25638));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27879,
                                                    4, sizeof(mem_28286.mem),
                                                    &mem_28286.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27879,
                                                    5, sizeof(mem_28288.mem),
                                                    &mem_28288.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27879,
                                                    6,
                                                    sizeof(stage1_num_groups_28950),
                                                    &stage1_num_groups_28950));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27879,
                                                    7,
                                                    sizeof(num_threads_28951),
                                                    &num_threads_28951));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28950) != 0) {
                const size_t global_work_sizze_29620[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_28950};
                const size_t local_work_sizze_29624[1] =
                             {stage1_num_groups_28950};
                int64_t time_start_29621 = 0, time_end_29622 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage2_27879");
                    fprintf(stderr, "%zu", global_work_sizze_29620[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29624[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_28950) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          stage1_num_groups_28950)));
                    time_start_29621 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage2_27879,
                                                                1, NULL,
                                                                global_work_sizze_29620,
                                                                local_work_sizze_29624,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage2_27879_runs,
                                                                                                          &ctx->testziscan_stage2_27879_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29622 = get_wall_time();
                    
                    long time_diff_29623 = time_end_29622 - time_start_29621;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage2_27879", time_diff_29623);
                }
            }
            
            int32_t required_groups_29003;
            
            required_groups_29003 = sext_i64_i32(sdiv_up64(res_25638,
                                                           segscan_group_sizze_27874));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27879,
                                                    1, sizeof(res_25638),
                                                    &res_25638));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27879,
                                                    2, sizeof(num_groups_27876),
                                                    &num_groups_27876));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27879,
                                                    3, sizeof(mem_28286.mem),
                                                    &mem_28286.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27879,
                                                    4, sizeof(mem_28288.mem),
                                                    &mem_28288.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27879,
                                                    5,
                                                    sizeof(num_threads_28951),
                                                    &num_threads_28951));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27879,
                                                    6,
                                                    sizeof(required_groups_29003),
                                                    &required_groups_29003));
            if (1 * ((size_t) num_groups_27876 *
                     (size_t) segscan_group_sizze_27874) != 0) {
                const size_t global_work_sizze_29625[1] =
                             {(size_t) num_groups_27876 *
                             (size_t) segscan_group_sizze_27874};
                const size_t local_work_sizze_29629[1] =
                             {segscan_group_sizze_27874};
                int64_t time_start_29626 = 0, time_end_29627 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage3_27879");
                    fprintf(stderr, "%zu", global_work_sizze_29625[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29629[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29626 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage3_27879,
                                                                1, NULL,
                                                                global_work_sizze_29625,
                                                                local_work_sizze_29629,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage3_27879_runs,
                                                                                                          &ctx->testziscan_stage3_27879_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29627 = get_wall_time();
                    
                    long time_diff_29628 = time_end_29627 - time_start_29626;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage3_27879", time_diff_29628);
                }
            }
        }
        if (memblock_unref_device(ctx, &mem_28286, "mem_28286") != 0)
            return 1;
        
        int64_t num_groups_27884;
        int32_t max_num_groups_29015;
        
        max_num_groups_29015 = ctx->sizes.testzisegscan_num_groups_27883;
        num_groups_27884 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_25638,
                                                                   sext_i32_i64(segscan_group_sizze_27882)),
                                                         sext_i32_i64(max_num_groups_29015))));
        
        struct memblock_device mem_28293;
        
        mem_28293.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28293, res_25638, "mem_28293")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t bytes_28294 = 4 * res_25638;
        struct memblock_device mem_28295;
        
        mem_28295.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28295, bytes_28294, "mem_28295")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_25638)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_29016;
            
            stage1_max_num_groups_29016 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_29017;
            
            stage1_num_groups_29017 = smin64(stage1_max_num_groups_29016,
                                             num_groups_27884);
            
            int32_t num_threads_29018;
            
            num_threads_29018 = sext_i64_i32(stage1_num_groups_29017 *
                segscan_group_sizze_27882);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    1,
                                                    sizeof(ctx->failure_is_an_option),
                                                    &ctx->failure_is_an_option));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    3, smax64(1,
                                                              (int32_t) sizeof(float) *
                                                              segscan_group_sizze_27882),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    4, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              segscan_group_sizze_27882),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    5, sizeof(paths_25438),
                                                    &paths_25438));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    6, sizeof(flat_dim_25605),
                                                    &flat_dim_25605));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    7, sizeof(res_25618),
                                                    &res_25618));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    8, sizeof(res_25638),
                                                    &res_25638));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    9, sizeof(i_27764),
                                                    &i_27764));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    10,
                                                    sizeof(res_mem_28236.mem),
                                                    &res_mem_28236.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    11,
                                                    sizeof(res_mem_28237.mem),
                                                    &res_mem_28237.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    12,
                                                    sizeof(res_mem_28238.mem),
                                                    &res_mem_28238.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    13,
                                                    sizeof(res_mem_28239.mem),
                                                    &res_mem_28239.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    14, sizeof(mem_28267.mem),
                                                    &mem_28267.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    15, sizeof(mem_28283.mem),
                                                    &mem_28283.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    16, sizeof(mem_28288.mem),
                                                    &mem_28288.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    17, sizeof(mem_28290.mem),
                                                    &mem_28290.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    18, sizeof(mem_28293.mem),
                                                    &mem_28293.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    19, sizeof(mem_28295.mem),
                                                    &mem_28295.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27887,
                                                    20,
                                                    sizeof(num_threads_29018),
                                                    &num_threads_29018));
            if (1 * ((size_t) stage1_num_groups_29017 *
                     (size_t) segscan_group_sizze_27882) != 0) {
                const size_t global_work_sizze_29630[1] =
                             {(size_t) stage1_num_groups_29017 *
                             (size_t) segscan_group_sizze_27882};
                const size_t local_work_sizze_29634[1] =
                             {segscan_group_sizze_27882};
                int64_t time_start_29631 = 0, time_end_29632 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage1_27887");
                    fprintf(stderr, "%zu", global_work_sizze_29630[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29634[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                              segscan_group_sizze_27882) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          segscan_group_sizze_27882)));
                    time_start_29631 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage1_27887,
                                                                1, NULL,
                                                                global_work_sizze_29630,
                                                                local_work_sizze_29634,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage1_27887_runs,
                                                                                                          &ctx->testziscan_stage1_27887_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29632 = get_wall_time();
                    
                    long time_diff_29633 = time_end_29632 - time_start_29631;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage1_27887", time_diff_29633);
                }
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_27882 *
                                     sdiv_up64(res_25638,
                                               sext_i32_i64(num_threads_29018))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27887,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(float) *
                                                              stage1_num_groups_29017),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27887,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              stage1_num_groups_29017),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27887,
                                                    3, sizeof(res_25638),
                                                    &res_25638));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27887,
                                                    4, sizeof(mem_28293.mem),
                                                    &mem_28293.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27887,
                                                    5, sizeof(mem_28295.mem),
                                                    &mem_28295.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27887,
                                                    6,
                                                    sizeof(stage1_num_groups_29017),
                                                    &stage1_num_groups_29017));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27887,
                                                    7,
                                                    sizeof(num_threads_29018),
                                                    &num_threads_29018));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_29017) != 0) {
                const size_t global_work_sizze_29635[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_29017};
                const size_t local_work_sizze_29639[1] =
                             {stage1_num_groups_29017};
                int64_t time_start_29636 = 0, time_end_29637 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage2_27887");
                    fprintf(stderr, "%zu", global_work_sizze_29635[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29639[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                              stage1_num_groups_29017) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          stage1_num_groups_29017)));
                    time_start_29636 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage2_27887,
                                                                1, NULL,
                                                                global_work_sizze_29635,
                                                                local_work_sizze_29639,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage2_27887_runs,
                                                                                                          &ctx->testziscan_stage2_27887_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29637 = get_wall_time();
                    
                    long time_diff_29638 = time_end_29637 - time_start_29636;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage2_27887", time_diff_29638);
                }
            }
            
            int32_t required_groups_29070;
            
            required_groups_29070 = sext_i64_i32(sdiv_up64(res_25638,
                                                           segscan_group_sizze_27882));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27887,
                                                    1, sizeof(res_25638),
                                                    &res_25638));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27887,
                                                    2, sizeof(num_groups_27884),
                                                    &num_groups_27884));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27887,
                                                    3, sizeof(mem_28293.mem),
                                                    &mem_28293.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27887,
                                                    4, sizeof(mem_28295.mem),
                                                    &mem_28295.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27887,
                                                    5,
                                                    sizeof(num_threads_29018),
                                                    &num_threads_29018));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27887,
                                                    6,
                                                    sizeof(required_groups_29070),
                                                    &required_groups_29070));
            if (1 * ((size_t) num_groups_27884 *
                     (size_t) segscan_group_sizze_27882) != 0) {
                const size_t global_work_sizze_29640[1] =
                             {(size_t) num_groups_27884 *
                             (size_t) segscan_group_sizze_27882};
                const size_t local_work_sizze_29644[1] =
                             {segscan_group_sizze_27882};
                int64_t time_start_29641 = 0, time_end_29642 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage3_27887");
                    fprintf(stderr, "%zu", global_work_sizze_29640[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29644[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29641 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage3_27887,
                                                                1, NULL,
                                                                global_work_sizze_29640,
                                                                local_work_sizze_29644,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage3_27887_runs,
                                                                                                          &ctx->testziscan_stage3_27887_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29642 = get_wall_time();
                    
                    long time_diff_29643 = time_end_29642 - time_start_29641;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage3_27887", time_diff_29643);
                }
            }
        }
        if (memblock_unref_device(ctx, &mem_28283, "mem_28283") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28288, "mem_28288") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28293, "mem_28293") != 0)
            return 1;
        
        int64_t num_groups_27936;
        int32_t max_num_groups_29082;
        
        max_num_groups_29082 = ctx->sizes.testzisegscan_num_groups_27935;
        num_groups_27936 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_25638,
                                                                   sext_i32_i64(segscan_group_sizze_27934)),
                                                         sext_i32_i64(max_num_groups_29082))));
        
        struct memblock_device mem_28298;
        
        mem_28298.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28298, bytes_28276, "mem_28298")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_25638)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_29083;
            
            stage1_max_num_groups_29083 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_29084;
            
            stage1_num_groups_29084 = smin64(stage1_max_num_groups_29083,
                                             num_groups_27936);
            
            int32_t num_threads_29085;
            
            num_threads_29085 = sext_i64_i32(stage1_num_groups_29084 *
                segscan_group_sizze_27934);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27939,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_27934),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27939,
                                                    2, sizeof(res_25638),
                                                    &res_25638));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27939,
                                                    3, sizeof(mem_28290.mem),
                                                    &mem_28290.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27939,
                                                    4, sizeof(mem_28298.mem),
                                                    &mem_28298.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27939,
                                                    5,
                                                    sizeof(num_threads_29085),
                                                    &num_threads_29085));
            if (1 * ((size_t) stage1_num_groups_29084 *
                     (size_t) segscan_group_sizze_27934) != 0) {
                const size_t global_work_sizze_29645[1] =
                             {(size_t) stage1_num_groups_29084 *
                             (size_t) segscan_group_sizze_27934};
                const size_t local_work_sizze_29649[1] =
                             {segscan_group_sizze_27934};
                int64_t time_start_29646 = 0, time_end_29647 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage1_27939");
                    fprintf(stderr, "%zu", global_work_sizze_29645[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29649[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_27934)));
                    time_start_29646 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage1_27939,
                                                                1, NULL,
                                                                global_work_sizze_29645,
                                                                local_work_sizze_29649,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage1_27939_runs,
                                                                                                          &ctx->testziscan_stage1_27939_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29647 = get_wall_time();
                    
                    long time_diff_29648 = time_end_29647 - time_start_29646;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage1_27939", time_diff_29648);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_27934 *
                                     sdiv_up64(res_25638,
                                               sext_i32_i64(num_threads_29085))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27939,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_29084),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27939,
                                                    2, sizeof(res_25638),
                                                    &res_25638));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27939,
                                                    3, sizeof(mem_28298.mem),
                                                    &mem_28298.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27939,
                                                    4,
                                                    sizeof(stage1_num_groups_29084),
                                                    &stage1_num_groups_29084));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27939,
                                                    5,
                                                    sizeof(num_threads_29085),
                                                    &num_threads_29085));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_29084) != 0) {
                const size_t global_work_sizze_29650[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_29084};
                const size_t local_work_sizze_29654[1] =
                             {stage1_num_groups_29084};
                int64_t time_start_29651 = 0, time_end_29652 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage2_27939");
                    fprintf(stderr, "%zu", global_work_sizze_29650[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29654[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_29084)));
                    time_start_29651 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage2_27939,
                                                                1, NULL,
                                                                global_work_sizze_29650,
                                                                local_work_sizze_29654,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage2_27939_runs,
                                                                                                          &ctx->testziscan_stage2_27939_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29652 = get_wall_time();
                    
                    long time_diff_29653 = time_end_29652 - time_start_29651;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage2_27939", time_diff_29653);
                }
            }
            
            int32_t required_groups_29121;
            
            required_groups_29121 = sext_i64_i32(sdiv_up64(res_25638,
                                                           segscan_group_sizze_27934));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27939,
                                                    1, sizeof(res_25638),
                                                    &res_25638));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27939,
                                                    2, sizeof(num_groups_27936),
                                                    &num_groups_27936));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27939,
                                                    3, sizeof(mem_28298.mem),
                                                    &mem_28298.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27939,
                                                    4,
                                                    sizeof(num_threads_29085),
                                                    &num_threads_29085));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27939,
                                                    5,
                                                    sizeof(required_groups_29121),
                                                    &required_groups_29121));
            if (1 * ((size_t) num_groups_27936 *
                     (size_t) segscan_group_sizze_27934) != 0) {
                const size_t global_work_sizze_29655[1] =
                             {(size_t) num_groups_27936 *
                             (size_t) segscan_group_sizze_27934};
                const size_t local_work_sizze_29659[1] =
                             {segscan_group_sizze_27934};
                int64_t time_start_29656 = 0, time_end_29657 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage3_27939");
                    fprintf(stderr, "%zu", global_work_sizze_29655[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29659[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29656 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage3_27939,
                                                                1, NULL,
                                                                global_work_sizze_29655,
                                                                local_work_sizze_29659,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage3_27939_runs,
                                                                                                          &ctx->testziscan_stage3_27939_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29657 = get_wall_time();
                    
                    long time_diff_29658 = time_end_29657 - time_start_29656;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage3_27939", time_diff_29658);
                }
            }
        }
        
        bool cond_25824 = slt64(0, res_25638);
        int64_t num_segments_25825;
        
        if (cond_25824) {
            int64_t i_25826 = sub64(res_25638, 1);
            bool x_25827 = sle64(0, i_25826);
            bool y_25828 = slt64(i_25826, res_25638);
            bool bounds_check_25829 = x_25827 && y_25828;
            bool index_certs_25830;
            
            if (!bounds_check_25829) {
                ctx->error =
                    msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                              "Index [", i_25826,
                              "] out of bounds for array of shape [", res_25638,
                              "].",
                              "-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:29:36-59\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #4  cva.fut:132:34-93\n   #5  /prelude/soacs.fut:56:19-23\n   #6  /prelude/soacs.fut:56:3-37\n   #7  cva.fut:126:18-137:50\n   #8  cva.fut:173:3-120\n   #9  cva.fut:172:1-173:128\n");
                if (memblock_unref_device(ctx, &mem_28298, "mem_28298") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28295, "mem_28295") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28293, "mem_28293") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28290, "mem_28290") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28288, "mem_28288") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28286, "mem_28286") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28283, "mem_28283") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28281, "mem_28281") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_subhistos_mem_28735,
                                          "res_subhistos_mem_28735") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28277, "mem_28277") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_28697,
                                          "group_res_arr_mem_28697") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28275, "mem_28275") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28272, "mem_28272") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28270, "mem_28270") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28267, "mem_28267") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28249, "mem_28249") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28246, "mem_28246") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28242, "mem_28242") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28239,
                                          "res_mem_28239") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28238,
                                          "res_mem_28238") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28237,
                                          "res_mem_28237") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28236,
                                          "res_mem_28236") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_28513,
                                          "group_res_arr_mem_28513") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28189, "mem_28189") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28184, "mem_28184") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28182, "mem_28182") != 0)
                    return 1;
                return 1;
            }
            
            int64_t read_res_29660;
            
            OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                         mem_28298.mem,
                                                         ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                         i_25826 *
                                                         sizeof(int64_t),
                                                         sizeof(int64_t),
                                                         &read_res_29660, 0,
                                                         NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_scalar_from_dev_runs,
                                                                                                   &ctx->copy_scalar_from_dev_total_runtime)));
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
                return 1;
            
            int64_t res_25831 = read_res_29660;
            
            num_segments_25825 = res_25831;
        } else {
            num_segments_25825 = 0;
        }
        
        bool bounds_invalid_upwards_25832 = slt64(num_segments_25825, 0);
        bool valid_25833 = !bounds_invalid_upwards_25832;
        bool range_valid_c_25834;
        
        if (!valid_25833) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Range ", 0, "..", 1, "..<", num_segments_25825,
                          " is invalid.",
                          "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:33:17-41\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva.fut:132:34-93\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  cva.fut:126:18-137:50\n   #9  cva.fut:173:3-120\n   #10 cva.fut:172:1-173:128\n");
            if (memblock_unref_device(ctx, &mem_28298, "mem_28298") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28295, "mem_28295") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28293, "mem_28293") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28290, "mem_28290") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28288, "mem_28288") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28286, "mem_28286") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28283, "mem_28283") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28281, "mem_28281") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_subhistos_mem_28735,
                                      "res_subhistos_mem_28735") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28277, "mem_28277") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28697,
                                      "group_res_arr_mem_28697") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28275, "mem_28275") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28272, "mem_28272") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28270, "mem_28270") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28267, "mem_28267") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28249, "mem_28249") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28246, "mem_28246") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28242, "mem_28242") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28239, "res_mem_28239") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28238, "res_mem_28238") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28237, "res_mem_28237") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28236, "res_mem_28236") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28513,
                                      "group_res_arr_mem_28513") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28189, "mem_28189") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28184, "mem_28184") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28182, "mem_28182") != 0)
                return 1;
            return 1;
        }
        
        int64_t bytes_28299 = 4 * num_segments_25825;
        struct memblock_device mem_28300;
        
        mem_28300.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28300, bytes_28299, "mem_28300")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_f32(ctx, mem_28300, num_segments_25825,
                                          0.0F) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t segmap_group_sizze_27944;
        
        segmap_group_sizze_27944 = ctx->sizes.testzisegmap_group_sizze_27943;
        
        int64_t segmap_usable_groups_27945 = sdiv_up64(res_25638,
                                                       segmap_group_sizze_27944);
        
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27941, 1,
                                                sizeof(res_25638), &res_25638));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27941, 2,
                                                sizeof(num_segments_25825),
                                                &num_segments_25825));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27941, 3,
                                                sizeof(mem_28290.mem),
                                                &mem_28290.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27941, 4,
                                                sizeof(mem_28295.mem),
                                                &mem_28295.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27941, 5,
                                                sizeof(mem_28298.mem),
                                                &mem_28298.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27941, 6,
                                                sizeof(mem_28300.mem),
                                                &mem_28300.mem));
        if (1 * ((size_t) segmap_usable_groups_27945 *
                 (size_t) segmap_group_sizze_27944) != 0) {
            const size_t global_work_sizze_29661[1] =
                         {(size_t) segmap_usable_groups_27945 *
                         (size_t) segmap_group_sizze_27944};
            const size_t local_work_sizze_29665[1] = {segmap_group_sizze_27944};
            int64_t time_start_29662 = 0, time_end_29663 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_27941");
                fprintf(stderr, "%zu", global_work_sizze_29661[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29665[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29662 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_27941,
                                                            1, NULL,
                                                            global_work_sizze_29661,
                                                            local_work_sizze_29665,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_27941_runs,
                                                                                                      &ctx->testzisegmap_27941_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29663 = get_wall_time();
                
                long time_diff_29664 = time_end_29663 - time_start_29662;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_27941", time_diff_29664);
            }
        }
        if (memblock_unref_device(ctx, &mem_28290, "mem_28290") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28295, "mem_28295") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28298, "mem_28298") != 0)
            return 1;
        
        bool dim_match_25842 = flat_dim_25605 == num_segments_25825;
        bool empty_or_match_cert_25843;
        
        if (!dim_match_25842) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Value of (core language) shape (",
                                   num_segments_25825,
                                   ") cannot match shape of type `[",
                                   flat_dim_25605, "]b`.",
                                   "-> #0  lib/github.com/diku-dk/segmented/segmented.fut:103:6-45\n   #1  cva.fut:132:34-93\n   #2  /prelude/soacs.fut:56:19-23\n   #3  /prelude/soacs.fut:56:3-37\n   #4  cva.fut:126:18-137:50\n   #5  cva.fut:173:3-120\n   #6  cva.fut:172:1-173:128\n");
            if (memblock_unref_device(ctx, &mem_28300, "mem_28300") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28298, "mem_28298") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28295, "mem_28295") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28293, "mem_28293") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28290, "mem_28290") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28288, "mem_28288") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28286, "mem_28286") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28283, "mem_28283") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28281, "mem_28281") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_subhistos_mem_28735,
                                      "res_subhistos_mem_28735") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28277, "mem_28277") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28697,
                                      "group_res_arr_mem_28697") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28275, "mem_28275") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28272, "mem_28272") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28270, "mem_28270") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28267, "mem_28267") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28249, "mem_28249") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28246, "mem_28246") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28242, "mem_28242") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28239, "res_mem_28239") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28238, "res_mem_28238") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28237, "res_mem_28237") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28236, "res_mem_28236") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28513,
                                      "group_res_arr_mem_28513") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28189, "mem_28189") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28184, "mem_28184") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28182, "mem_28182") != 0)
                return 1;
            return 1;
        }
        
        float res_25845;
        int32_t local_memory_capacity_29280;
        
        local_memory_capacity_29280 = ctx->opencl.max_local_memory;
        if (sle64((int32_t) sizeof(bool) + (int32_t) sizeof(float) *
                  segred_group_sizze_27959,
                  sext_i32_i64(local_memory_capacity_29280)) &&
            suff_outer_redomap_27947) {
            struct memblock_device mem_28304;
            
            mem_28304.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28304, bytes_28302,
                                      "mem_28304")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_28304, 0,
                                                      mem_28300, 0, 1, 9,
                                                      paths_25438) != 0) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_28307;
            
            mem_28307.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28307, 4, "mem_28307")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device testzicounter_mem_29147 =
                                   ctx->testzicounter_mem_29147;
            struct memblock_device group_res_arr_mem_29149;
            
            group_res_arr_mem_29149.references = NULL;
            if (memblock_alloc_device(ctx, &group_res_arr_mem_29149,
                                      (int32_t) sizeof(float) *
                                      (segred_group_sizze_27959 *
                                       num_groups_27960),
                                      "group_res_arr_mem_29149")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_29151;
            
            num_threads_29151 = num_groups_27960 * segred_group_sizze_27959;
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegRed");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27957,
                                                    1, (int32_t) sizeof(float) *
                                                    segred_group_sizze_27959,
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27957,
                                                    2, (int32_t) sizeof(bool),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27957,
                                                    3, sizeof(paths_25438),
                                                    &paths_25438));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27957,
                                                    4, sizeof(num_groups_27960),
                                                    &num_groups_27960));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27957,
                                                    5, sizeof(mem_28304.mem),
                                                    &mem_28304.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27957,
                                                    6, sizeof(mem_28307.mem),
                                                    &mem_28307.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27957,
                                                    7,
                                                    sizeof(testzicounter_mem_29147.mem),
                                                    &testzicounter_mem_29147.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27957,
                                                    8,
                                                    sizeof(group_res_arr_mem_29149.mem),
                                                    &group_res_arr_mem_29149.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27957,
                                                    9,
                                                    sizeof(num_threads_29151),
                                                    &num_threads_29151));
            if (1 * ((size_t) num_groups_27960 *
                     (size_t) segred_group_sizze_27959) != 0) {
                const size_t global_work_sizze_29667[1] =
                             {(size_t) num_groups_27960 *
                             (size_t) segred_group_sizze_27959};
                const size_t local_work_sizze_29671[1] =
                             {segred_group_sizze_27959};
                int64_t time_start_29668 = 0, time_end_29669 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.segred_nonseg_27957");
                    fprintf(stderr, "%zu", global_work_sizze_29667[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29671[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + (int32_t) sizeof(float) *
                                   segred_group_sizze_27959 +
                                   (int32_t) sizeof(bool)));
                    time_start_29668 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testzisegred_nonseg_27957,
                                                                1, NULL,
                                                                global_work_sizze_29667,
                                                                local_work_sizze_29671,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testzisegred_nonseg_27957_runs,
                                                                                                          &ctx->testzisegred_nonseg_27957_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29669 = get_wall_time();
                    
                    long time_diff_29670 = time_end_29669 - time_start_29668;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.segred_nonseg_27957", time_diff_29670);
                }
            }
            if (memblock_unref_device(ctx, &mem_28304, "mem_28304") != 0)
                return 1;
            
            float read_res_29672;
            
            OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                         mem_28307.mem,
                                                         ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                         0 * sizeof(float),
                                                         sizeof(float),
                                                         &read_res_29672, 0,
                                                         NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_scalar_from_dev_runs,
                                                                                                   &ctx->copy_scalar_from_dev_total_runtime)));
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
                return 1;
            
            float res_27973 = read_res_29672;
            
            if (memblock_unref_device(ctx, &mem_28307, "mem_28307") != 0)
                return 1;
            res_25845 = res_27973;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29149,
                                      "group_res_arr_mem_29149") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28307, "mem_28307") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28304, "mem_28304") != 0)
                return 1;
        } else {
            struct memblock_device res_map_acc_mem_28320;
            
            res_map_acc_mem_28320.references = NULL;
            
            int32_t local_memory_capacity_29249;
            
            local_memory_capacity_29249 = ctx->opencl.max_local_memory;
            if (sle64(0, sext_i32_i64(local_memory_capacity_29249)) &&
                suff_outer_par_28055) {
                struct memblock_device mem_28310;
                
                mem_28310.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28310, bytes_28302,
                                          "mem_28310")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_28310, 0,
                                                          mem_28300, 0, 1, 9,
                                                          paths_25438) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28313;
                
                mem_28313.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28313, bytes_28241,
                                          "mem_28313")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27979,
                                                        1, sizeof(paths_25438),
                                                        &paths_25438));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27979,
                                                        2,
                                                        sizeof(mem_28310.mem),
                                                        &mem_28310.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27979,
                                                        3,
                                                        sizeof(mem_28313.mem),
                                                        &mem_28313.mem));
                if (1 * ((size_t) segmap_usable_groups_28059 *
                         (size_t) segmap_group_sizze_28058) != 0) {
                    const size_t global_work_sizze_29673[1] =
                                 {(size_t) segmap_usable_groups_28059 *
                                 (size_t) segmap_group_sizze_28058};
                    const size_t local_work_sizze_29677[1] =
                                 {segmap_group_sizze_28058};
                    int64_t time_start_29674 = 0, time_end_29675 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.segmap_27979");
                        fprintf(stderr, "%zu", global_work_sizze_29673[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29677[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_29674 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testzisegmap_27979,
                                                                    1, NULL,
                                                                    global_work_sizze_29673,
                                                                    local_work_sizze_29677,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testzisegmap_27979_runs,
                                                                                                              &ctx->testzisegmap_27979_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29675 = get_wall_time();
                        
                        long time_diff_29676 = time_end_29675 -
                             time_start_29674;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.segmap_27979", time_diff_29676);
                    }
                }
                if (memblock_unref_device(ctx, &mem_28310, "mem_28310") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_28320, &mem_28313,
                                        "mem_28313") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28313, "mem_28313") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28310, "mem_28310") != 0)
                    return 1;
            } else {
                struct memblock_device mem_28316;
                
                mem_28316.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28316, bytes_28241,
                                          "mem_28316")) {
                    err = 1;
                    goto cleanup;
                }
                if (slt64(18, segred_group_sizze_28070)) {
                    int64_t segment_sizze_nonzzero_29184 = 9;
                    int64_t num_threads_29185 = num_groups_28071 *
                            segred_group_sizze_28070;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-small");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) paths_25438, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) 9, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segments_per_group",
                                (long long) squot64(segred_group_sizze_28070,
                                                    segment_sizze_nonzzero_29184),
                                '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "required_groups",
                                (long long) sext_i64_i32(sdiv_up64(paths_25438,
                                                                   squot64(segred_group_sizze_28070,
                                                                           segment_sizze_nonzzero_29184))),
                                '\n');
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28020,
                                                            1,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_28070,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28020,
                                                            2,
                                                            sizeof(paths_25438),
                                                            &paths_25438));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28020,
                                                            3,
                                                            sizeof(num_groups_28071),
                                                            &num_groups_28071));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28020,
                                                            4,
                                                            sizeof(mem_28300.mem),
                                                            &mem_28300.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28020,
                                                            5,
                                                            sizeof(mem_28316.mem),
                                                            &mem_28316.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28020,
                                                            6,
                                                            sizeof(segment_sizze_nonzzero_29184),
                                                            &segment_sizze_nonzzero_29184));
                    if (1 * ((size_t) num_groups_28071 *
                             (size_t) segred_group_sizze_28070) != 0) {
                        const size_t global_work_sizze_29678[1] =
                                     {(size_t) num_groups_28071 *
                                     (size_t) segred_group_sizze_28070};
                        const size_t local_work_sizze_29682[1] =
                                     {segred_group_sizze_28070};
                        int64_t time_start_29679 = 0, time_end_29680 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.segred_small_28020");
                            fprintf(stderr, "%zu", global_work_sizze_29678[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29682[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(float) *
                                           segred_group_sizze_28070));
                            time_start_29679 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testzisegred_small_28020,
                                                                        1, NULL,
                                                                        global_work_sizze_29678,
                                                                        local_work_sizze_29682,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testzisegred_small_28020_runs,
                                                                                                                  &ctx->testzisegred_small_28020_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29680 = get_wall_time();
                            
                            long time_diff_29681 = time_end_29680 -
                                 time_start_29679;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.segred_small_28020", time_diff_29681);
                        }
                    }
                } else {
                    int64_t groups_per_segment_29205 =
                            sdiv_up64(num_groups_28071, smax64(1, paths_25438));
                    int64_t elements_per_thread_29206 = sdiv_up64(9,
                                                                  segred_group_sizze_28070 *
                                                                  groups_per_segment_29205);
                    int64_t virt_num_groups_29207 = groups_per_segment_29205 *
                            paths_25438;
                    int64_t num_threads_29208 = num_groups_28071 *
                            segred_group_sizze_28070;
                    int64_t threads_per_segment_29209 =
                            groups_per_segment_29205 * segred_group_sizze_28070;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-large");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) paths_25438, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) 9, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                                (long long) virt_num_groups_29207, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_groups",
                                (long long) num_groups_28071, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "group_size",
                                (long long) segred_group_sizze_28070, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                                (long long) elements_per_thread_29206, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                                (long long) groups_per_segment_29205, '\n');
                    
                    struct memblock_device group_res_arr_mem_29210;
                    
                    group_res_arr_mem_29210.references = NULL;
                    if (memblock_alloc_device(ctx, &group_res_arr_mem_29210,
                                              (int32_t) sizeof(float) *
                                              (segred_group_sizze_28070 *
                                               virt_num_groups_29207),
                                              "group_res_arr_mem_29210")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device testzicounter_mem_29212 =
                                           ctx->testzicounter_mem_29212;
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28020,
                                                            1,
                                                            (int32_t) sizeof(bool),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28020,
                                                            2,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_28070,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28020,
                                                            3,
                                                            sizeof(num_groups_28071),
                                                            &num_groups_28071));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28020,
                                                            4,
                                                            sizeof(mem_28300.mem),
                                                            &mem_28300.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28020,
                                                            5,
                                                            sizeof(mem_28316.mem),
                                                            &mem_28316.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28020,
                                                            6,
                                                            sizeof(groups_per_segment_29205),
                                                            &groups_per_segment_29205));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28020,
                                                            7,
                                                            sizeof(elements_per_thread_29206),
                                                            &elements_per_thread_29206));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28020,
                                                            8,
                                                            sizeof(virt_num_groups_29207),
                                                            &virt_num_groups_29207));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28020,
                                                            9,
                                                            sizeof(threads_per_segment_29209),
                                                            &threads_per_segment_29209));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28020,
                                                            10,
                                                            sizeof(group_res_arr_mem_29210.mem),
                                                            &group_res_arr_mem_29210.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28020,
                                                            11,
                                                            sizeof(testzicounter_mem_29212.mem),
                                                            &testzicounter_mem_29212.mem));
                    if (1 * ((size_t) num_groups_28071 *
                             (size_t) segred_group_sizze_28070) != 0) {
                        const size_t global_work_sizze_29684[1] =
                                     {(size_t) num_groups_28071 *
                                     (size_t) segred_group_sizze_28070};
                        const size_t local_work_sizze_29688[1] =
                                     {segred_group_sizze_28070};
                        int64_t time_start_29685 = 0, time_end_29686 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.segred_large_28020");
                            fprintf(stderr, "%zu", global_work_sizze_29684[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29688[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(bool) +
                                           (int32_t) sizeof(float) *
                                           segred_group_sizze_28070));
                            time_start_29685 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testzisegred_large_28020,
                                                                        1, NULL,
                                                                        global_work_sizze_29684,
                                                                        local_work_sizze_29688,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testzisegred_large_28020_runs,
                                                                                                                  &ctx->testzisegred_large_28020_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29686 = get_wall_time();
                            
                            long time_diff_29687 = time_end_29686 -
                                 time_start_29685;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.segred_large_28020", time_diff_29687);
                        }
                    }
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29210,
                                              "group_res_arr_mem_29210") != 0)
                        return 1;
                }
                
                struct memblock_device mem_28319;
                
                mem_28319.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28319, bytes_28241,
                                          "mem_28319")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28004,
                                                        1, sizeof(paths_25438),
                                                        &paths_25438));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28004,
                                                        2,
                                                        sizeof(mem_28316.mem),
                                                        &mem_28316.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28004,
                                                        3,
                                                        sizeof(mem_28319.mem),
                                                        &mem_28319.mem));
                if (1 * ((size_t) segmap_usable_groups_28081 *
                         (size_t) segmap_group_sizze_28080) != 0) {
                    const size_t global_work_sizze_29689[1] =
                                 {(size_t) segmap_usable_groups_28081 *
                                 (size_t) segmap_group_sizze_28080};
                    const size_t local_work_sizze_29693[1] =
                                 {segmap_group_sizze_28080};
                    int64_t time_start_29690 = 0, time_end_29691 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.segmap_28004");
                        fprintf(stderr, "%zu", global_work_sizze_29689[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29693[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_29690 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testzisegmap_28004,
                                                                    1, NULL,
                                                                    global_work_sizze_29689,
                                                                    local_work_sizze_29693,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testzisegmap_28004_runs,
                                                                                                              &ctx->testzisegmap_28004_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29691 = get_wall_time();
                        
                        long time_diff_29692 = time_end_29691 -
                             time_start_29690;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.segmap_28004", time_diff_29692);
                    }
                }
                if (memblock_unref_device(ctx, &mem_28316, "mem_28316") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_28320, &mem_28319,
                                        "mem_28319") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28319, "mem_28319") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28316, "mem_28316") != 0)
                    return 1;
            }
            
            struct memblock_device mem_28323;
            
            mem_28323.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28323, 4, "mem_28323")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device testzicounter_mem_29250 =
                                   ctx->testzicounter_mem_29250;
            struct memblock_device group_res_arr_mem_29252;
            
            group_res_arr_mem_29252.references = NULL;
            if (memblock_alloc_device(ctx, &group_res_arr_mem_29252,
                                      (int32_t) sizeof(float) *
                                      (segred_group_sizze_28087 *
                                       num_groups_28088),
                                      "group_res_arr_mem_29252")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_29254;
            
            num_threads_29254 = num_groups_28088 * segred_group_sizze_28087;
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegRed");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28053,
                                                    1, (int32_t) sizeof(float) *
                                                    segred_group_sizze_28087,
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28053,
                                                    2, (int32_t) sizeof(bool),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28053,
                                                    3, sizeof(paths_25438),
                                                    &paths_25438));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28053,
                                                    4, sizeof(num_groups_28088),
                                                    &num_groups_28088));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28053,
                                                    5,
                                                    sizeof(res_map_acc_mem_28320.mem),
                                                    &res_map_acc_mem_28320.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28053,
                                                    6, sizeof(mem_28323.mem),
                                                    &mem_28323.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28053,
                                                    7,
                                                    sizeof(testzicounter_mem_29250.mem),
                                                    &testzicounter_mem_29250.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28053,
                                                    8,
                                                    sizeof(group_res_arr_mem_29252.mem),
                                                    &group_res_arr_mem_29252.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28053,
                                                    9,
                                                    sizeof(num_threads_29254),
                                                    &num_threads_29254));
            if (1 * ((size_t) num_groups_28088 *
                     (size_t) segred_group_sizze_28087) != 0) {
                const size_t global_work_sizze_29695[1] =
                             {(size_t) num_groups_28088 *
                             (size_t) segred_group_sizze_28087};
                const size_t local_work_sizze_29699[1] =
                             {segred_group_sizze_28087};
                int64_t time_start_29696 = 0, time_end_29697 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.segred_nonseg_28053");
                    fprintf(stderr, "%zu", global_work_sizze_29695[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29699[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + (int32_t) sizeof(float) *
                                   segred_group_sizze_28087 +
                                   (int32_t) sizeof(bool)));
                    time_start_29696 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testzisegred_nonseg_28053,
                                                                1, NULL,
                                                                global_work_sizze_29695,
                                                                local_work_sizze_29699,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testzisegred_nonseg_28053_runs,
                                                                                                          &ctx->testzisegred_nonseg_28053_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29697 = get_wall_time();
                    
                    long time_diff_29698 = time_end_29697 - time_start_29696;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.segred_nonseg_28053", time_diff_29698);
                }
            }
            if (memblock_unref_device(ctx, &res_map_acc_mem_28320,
                                      "res_map_acc_mem_28320") != 0)
                return 1;
            
            float read_res_29700;
            
            OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                         mem_28323.mem,
                                                         ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                         0 * sizeof(float),
                                                         sizeof(float),
                                                         &read_res_29700, 0,
                                                         NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_scalar_from_dev_runs,
                                                                                                   &ctx->copy_scalar_from_dev_total_runtime)));
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
                return 1;
            
            float res_28095 = read_res_29700;
            
            if (memblock_unref_device(ctx, &mem_28323, "mem_28323") != 0)
                return 1;
            res_25845 = res_28095;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29252,
                                      "group_res_arr_mem_29252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28323, "mem_28323") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_map_acc_mem_28320,
                                      "res_map_acc_mem_28320") != 0)
                return 1;
        }
        if (memblock_unref_device(ctx, &mem_28300, "mem_28300") != 0)
            return 1;
        
        float res_25856 = res_25845 / res_25609;
        float negate_arg_25857 = 1.0e-2F * res_25618;
        float exp_arg_25858 = 0.0F - negate_arg_25857;
        float res_25859 = fpow32(2.7182817F, exp_arg_25858);
        float x_25860 = 1.0F - res_25859;
        float B_25861 = x_25860 / 1.0e-2F;
        float x_25862 = B_25861 - res_25618;
        float x_25863 = 4.4999997e-6F * x_25862;
        float A1_25864 = x_25863 / 1.0e-4F;
        float y_25865 = fpow32(B_25861, 2.0F);
        float x_25866 = 1.0000001e-6F * y_25865;
        float A2_25867 = x_25866 / 4.0e-2F;
        float exp_arg_25868 = A1_25864 - A2_25867;
        float res_25869 = fpow32(2.7182817F, exp_arg_25868);
        float negate_arg_25870 = 5.0e-2F * B_25861;
        float exp_arg_25871 = 0.0F - negate_arg_25870;
        float res_25872 = fpow32(2.7182817F, exp_arg_25871);
        float res_25873 = res_25869 * res_25872;
        float res_25874 = res_25856 * res_25873;
        float res_25614 = res_25874 + redout_27763;
        float redout_tmp_28644 = res_25614;
        
        redout_27763 = redout_tmp_28644;
        if (memblock_unref_device(ctx, &mem_28300, "mem_28300") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28298, "mem_28298") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28295, "mem_28295") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28293, "mem_28293") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28290, "mem_28290") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28288, "mem_28288") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28286, "mem_28286") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28283, "mem_28283") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28281, "mem_28281") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_subhistos_mem_28735,
                                  "res_subhistos_mem_28735") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28277, "mem_28277") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28697,
                                  "group_res_arr_mem_28697") != 0)
            return 1;
    }
    res_25611 = redout_27763;
    if (memblock_unref_device(ctx, &res_mem_28236, "res_mem_28236") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28237, "res_mem_28237") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28238, "res_mem_28238") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28239, "res_mem_28239") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28267, "mem_28267") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28270, "mem_28270") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28272, "mem_28272") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28275, "mem_28275") != 0)
        return 1;
    
    float CVA_25875 = 6.0e-3F * res_25611;
    
    scalar_out_28506 = CVA_25875;
    *out_scalar_out_29506 = scalar_out_28506;
    if (memblock_unref_device(ctx, &mem_28275, "mem_28275") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28272, "mem_28272") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28270, "mem_28270") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28267, "mem_28267") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28249, "mem_28249") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28246, "mem_28246") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28242, "mem_28242") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28239, "res_mem_28239") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28238, "res_mem_28238") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28237, "res_mem_28237") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28236, "res_mem_28236") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_28513,
                              "group_res_arr_mem_28513") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28189, "mem_28189") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28186, "mem_28186") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28184, "mem_28184") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28182, "mem_28182") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
struct futhark_i64_1d {
    struct memblock_device mem;
    int64_t shape[1];
} ;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const
                                          int64_t *data, int64_t dim0)
{
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr =
                          (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(int64_t),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(int64_t) > 0)
        OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                      arr->mem.mem, CL_TRUE, 0,
                                                      (size_t) dim0 *
                                                      sizeof(int64_t), data + 0,
                                                      0, NULL,
                                                      ctx->profiling_paused ||
                                                      !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                &ctx->copy_dev_to_host_runs,
                                                                                                &ctx->copy_dev_to_host_total_runtime)));
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0)
{
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr =
                          (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(int64_t),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(int64_t) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue, data,
                                                     arr->mem.mem, offset, 0,
                                                     (size_t) dim0 *
                                                     sizeof(int64_t), 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx,
                          struct futhark_i64_1d *arr, int64_t *data)
{
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * sizeof(int64_t) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     arr->mem.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0, (size_t) arr->shape[0] *
                                                     sizeof(int64_t), data + 0,
                                                     0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_host_to_dev_runs,
                                                                                               &ctx->copy_host_to_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
    }
    lock_unlock(&ctx->lock);
    return 0;
}
cl_mem futhark_values_raw_i64_1d(struct futhark_context *ctx,
                                 struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx,
                                    struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_1d {
    struct memblock_device mem;
    int64_t shape[1];
} ;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const
                                          float *data, int64_t dim0)
{
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr =
                          (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(float),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(float) > 0)
        OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                      arr->mem.mem, CL_TRUE, 0,
                                                      (size_t) dim0 *
                                                      sizeof(float), data + 0,
                                                      0, NULL,
                                                      ctx->profiling_paused ||
                                                      !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                &ctx->copy_dev_to_host_runs,
                                                                                                &ctx->copy_dev_to_host_total_runtime)));
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0)
{
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr =
                          (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(float),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue, data,
                                                     arr->mem.mem, offset, 0,
                                                     (size_t) dim0 *
                                                     sizeof(float), 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_1d(struct futhark_context *ctx,
                          struct futhark_f32_1d *arr, float *data)
{
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     arr->mem.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0, (size_t) arr->shape[0] *
                                                     sizeof(float), data + 0, 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_host_to_dev_runs,
                                                                                               &ctx->copy_host_to_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
    }
    lock_unlock(&ctx->lock);
    return 0;
}
cl_mem futhark_values_raw_f32_1d(struct futhark_context *ctx,
                                 struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx,
                                    struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
int futhark_entry_main(struct futhark_context *ctx, float *out0,
                       struct futhark_f32_1d **out1, const int64_t in0, const
                       int64_t in1, const struct futhark_f32_1d *in2, const
                       struct futhark_i64_1d *in3, const
                       struct futhark_f32_1d *in4, const float in5, const
                       float in6, const float in7, const float in8)
{
    struct memblock_device swap_term_mem_28181;
    
    swap_term_mem_28181.references = NULL;
    
    struct memblock_device payments_mem_28182;
    
    payments_mem_28182.references = NULL;
    
    struct memblock_device notional_mem_28183;
    
    notional_mem_28183.references = NULL;
    
    int64_t n_24721;
    int64_t n_24722;
    int64_t n_24723;
    int64_t paths_24724;
    int64_t steps_24725;
    float a_24729;
    float b_24730;
    float sigma_24731;
    float r0_24732;
    float scalar_out_28506;
    struct memblock_device out_mem_28507;
    
    out_mem_28507.references = NULL;
    
    int64_t out_arrsizze_28508;
    
    lock_lock(&ctx->lock);
    paths_24724 = in0;
    steps_24725 = in1;
    swap_term_mem_28181 = in2->mem;
    n_24721 = in2->shape[0];
    payments_mem_28182 = in3->mem;
    n_24722 = in3->shape[0];
    notional_mem_28183 = in4->mem;
    n_24723 = in4->shape[0];
    a_24729 = in5;
    b_24730 = in6;
    sigma_24731 = in7;
    r0_24732 = in8;
    
    int ret = futrts_main(ctx, &scalar_out_28506, &out_mem_28507,
                          &out_arrsizze_28508, swap_term_mem_28181,
                          payments_mem_28182, notional_mem_28183, n_24721,
                          n_24722, n_24723, paths_24724, steps_24725, a_24729,
                          b_24730, sigma_24731, r0_24732);
    
    if (ret == 0) {
        *out0 = scalar_out_28506;
        assert((*out1 =
                (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) !=
            NULL);
        (*out1)->mem = out_mem_28507;
        (*out1)->shape[0] = out_arrsizze_28508;
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_test(struct futhark_context *ctx, float *out0, const
                       int64_t in0, const int64_t in1)
{
    int64_t paths_25438;
    int64_t steps_25439;
    float scalar_out_28506;
    
    lock_lock(&ctx->lock);
    paths_25438 = in0;
    steps_25439 = in1;
    
    int ret = futrts_test(ctx, &scalar_out_28506, paths_25438, steps_25439);
    
    if (ret == 0) {
        *out0 = scalar_out_28506;
    }
    lock_unlock(&ctx->lock);
    return ret;
}
