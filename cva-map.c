#ifdef __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#endif
#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#endif
// Headers

#define _GNU_SOURCE
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#define CL_TARGET_OPENCL_VERSION 120
#define CL_USE_DEPRECATED_OPENCL_1_2_APIS
#ifdef __APPLE__
#define CL_SILENCE_DEPRECATION
#include <OpenCL/cl.h>
#else
#include <CL/cl.h>
#endif


// Initialisation

int futhark_get_num_sizes(void);
const char *futhark_get_size_name(int);
const char *futhark_get_size_class(int);
struct futhark_context_config ;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
void futhark_context_config_add_build_option(struct futhark_context_config *cfg,
                                             const char *opt);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int flag);
void futhark_context_config_set_device(struct futhark_context_config *cfg, const
                                       char *s);
void futhark_context_config_set_platform(struct futhark_context_config *cfg,
                                         const char *s);
void
futhark_context_config_select_device_interactively(struct futhark_context_config *cfg);
void futhark_context_config_list_devices(struct futhark_context_config *cfg);
void futhark_context_config_dump_program_to(struct futhark_context_config *cfg,
                                            const char *path);
void
futhark_context_config_load_program_from(struct futhark_context_config *cfg,
                                         const char *path);
void futhark_context_config_dump_binary_to(struct futhark_context_config *cfg,
                                           const char *path);
void futhark_context_config_load_binary_from(struct futhark_context_config *cfg,
                                             const char *path);
void
futhark_context_config_set_default_group_size(struct futhark_context_config *cfg,
                                              int size);
void
futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg,
                                              int num);
void
futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg,
                                             int num);
void
futhark_context_config_set_default_threshold(struct futhark_context_config *cfg,
                                             int num);
int futhark_context_config_set_size(struct futhark_context_config *cfg, const
                                    char *size_name, size_t size_value);
struct futhark_context ;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
struct futhark_context
*futhark_context_new_with_command_queue(struct futhark_context_config *cfg,
                                        cl_command_queue queue);
void futhark_context_free(struct futhark_context *ctx);
cl_command_queue futhark_context_get_command_queue(struct futhark_context *ctx);

// Arrays

struct futhark_f32_1d ;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const
                                          float *data, int64_t dim0);
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0);
int futhark_free_f32_1d(struct futhark_context *ctx,
                        struct futhark_f32_1d *arr);
int futhark_values_f32_1d(struct futhark_context *ctx,
                          struct futhark_f32_1d *arr, float *data);
cl_mem futhark_values_raw_f32_1d(struct futhark_context *ctx,
                                 struct futhark_f32_1d *arr);
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx,
                                    struct futhark_f32_1d *arr);
struct futhark_i64_1d ;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const
                                          int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx,
                        struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx,
                          struct futhark_i64_1d *arr, int64_t *data);
cl_mem futhark_values_raw_i64_1d(struct futhark_context *ctx,
                                 struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx,
                                    struct futhark_i64_1d *arr);

// Opaque values


// Entry points

int futhark_entry_main(struct futhark_context *ctx, float *out0,
                       struct futhark_f32_1d **out1, const int64_t in0, const
                       int64_t in1, const struct futhark_f32_1d *in2, const
                       struct futhark_i64_1d *in3, const
                       struct futhark_f32_1d *in4, const float in5, const
                       float in6, const float in7, const float in8);
int futhark_entry_test(struct futhark_context *ctx, float *out0, const
                       int64_t in0, const int64_t in1);
int futhark_entry_test2(struct futhark_context *ctx, float *out0, const
                        int64_t in0, const int64_t in1, const int64_t in2);

// Miscellaneous

int futhark_context_sync(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
#define FUTHARK_BACKEND_opencl
#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}


static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                            const char *msg, ...)
{
  if (errval) {
    char str[256];
    char errnum[10];
    sprintf(errnum, "%d", errval);
    sprintf(str, "ERROR: %s in %s() at line %d with error code %s\n", msg, fun, line,
            sets_errno ? strerror(errno) : errnum);
    fprintf(stderr, "%s", str);
    exit(errval);
  }
}

#define CHECK_ERR(err, msg...) check_err(err, 0, __func__, __LINE__, msg)
#define CHECK_ERRNO(err, msg...) check_err(err, 1, __func__, __LINE__, msg)

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  unsigned char *s;
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  fseek(f, 0, SEEK_END);
  size_t src_size = ftell(f);
  fseek(f, 0, SEEK_SET);
  s = (unsigned char*) malloc(src_size + 1);
  if (fread(s, 1, src_size, f) != src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }
  fclose(f);

  if (size) {
    *size = src_size;
  }

  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

// End of util.h.

// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}


static inline uint64_t rdtsc() {
  unsigned int hi, lo;
  __asm__ __volatile__("rdtsc" : "=a"(lo), "=d"(hi));
  return  ((uint64_t) lo) | (((uint64_t) hi) << 32);
}

static inline void rdtsc_wait(uint64_t n) {
  const uint64_t start = rdtsc();
  while (rdtsc() < (start + n)) {
    __asm__("PAUSE");
  }
}
static inline void spin_for(uint64_t nb_cycles) {
  rdtsc_wait(nb_cycles);
}


#endif

// End of timing.h.

#include <string.h>
#include <inttypes.h>
#include <errno.h>
#include <ctype.h>
#include <errno.h>
#include <getopt.h>
// Start of values.h.

//// Text I/O

typedef int (*writer)(FILE*, const void*);
typedef int (*bin_reader)(void*);
typedef int (*str_reader)(const char *, void*);

struct array_reader {
  char* elems;
  int64_t n_elems_space;
  int64_t elem_size;
  int64_t n_elems_used;
  int64_t *shape;
  str_reader elem_reader;
};

static void skipspaces() {
  int c;
  do {
    c = getchar();
  } while (isspace(c));

  if (c != EOF) {
    ungetc(c, stdin);
  }
}

static int constituent(char c) {
  return isalnum(c) || c == '.' || c == '-' || c == '+' || c == '_';
}

// Produces an empty token only on EOF.
static void next_token(char *buf, int bufsize) {
 start:
  skipspaces();

  int i = 0;
  while (i < bufsize) {
    int c = getchar();
    buf[i] = (char)c;

    if (c == EOF) {
      buf[i] = 0;
      return;
    } else if (c == '-' && i == 1 && buf[0] == '-') {
      // Line comment, so skip to end of line and start over.
      for (; c != '\n' && c != EOF; c = getchar());
      goto start;
    } else if (!constituent((char)c)) {
      if (i == 0) {
        // We permit single-character tokens that are not
        // constituents; this lets things like ']' and ',' be
        // tokens.
        buf[i+1] = 0;
        return;
      } else {
        ungetc(c, stdin);
        buf[i] = 0;
        return;
      }
    }

    i++;
  }

  buf[bufsize-1] = 0;
}

static int next_token_is(char *buf, int bufsize, const char* expected) {
  next_token(buf, bufsize);
  return strcmp(buf, expected) == 0;
}

static void remove_underscores(char *buf) {
  char *w = buf;

  for (char *r = buf; *r; r++) {
    if (*r != '_') {
      *w++ = *r;
    }
  }

  *w++ = 0;
}

static int read_str_elem(char *buf, struct array_reader *reader) {
  int ret;
  if (reader->n_elems_used == reader->n_elems_space) {
    reader->n_elems_space *= 2;
    reader->elems = (char*) realloc(reader->elems,
                                    (size_t)(reader->n_elems_space * reader->elem_size));
  }

  ret = reader->elem_reader(buf, reader->elems + reader->n_elems_used * reader->elem_size);

  if (ret == 0) {
    reader->n_elems_used++;
  }

  return ret;
}

static int read_str_array_elems(char *buf, int bufsize,
                                struct array_reader *reader, int64_t dims) {
  int ret;
  int first = 1;
  char *knows_dimsize = (char*) calloc((size_t)dims, sizeof(char));
  int cur_dim = dims-1;
  int64_t *elems_read_in_dim = (int64_t*) calloc((size_t)dims, sizeof(int64_t));

  while (1) {
    next_token(buf, bufsize);

    if (strcmp(buf, "]") == 0) {
      if (knows_dimsize[cur_dim]) {
        if (reader->shape[cur_dim] != elems_read_in_dim[cur_dim]) {
          ret = 1;
          break;
        }
      } else {
        knows_dimsize[cur_dim] = 1;
        reader->shape[cur_dim] = elems_read_in_dim[cur_dim];
      }
      if (cur_dim == 0) {
        ret = 0;
        break;
      } else {
        cur_dim--;
        elems_read_in_dim[cur_dim]++;
      }
    } else if (strcmp(buf, ",") == 0) {
      next_token(buf, bufsize);
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        first = 1;
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else if (cur_dim == dims - 1) {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
      } else {
        ret = 1;
        break;
      }
    } else if (strlen(buf) == 0) {
      // EOF
      ret = 1;
      break;
    } else if (first) {
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
        first = 0;
      }
    } else {
      ret = 1;
      break;
    }
  }

  free(knows_dimsize);
  free(elems_read_in_dim);
  return ret;
}

static int read_str_empty_array(char *buf, int bufsize,
                                const char *type_name, int64_t *shape, int64_t dims) {
  if (strlen(buf) == 0) {
    // EOF
    return 1;
  }

  if (strcmp(buf, "empty") != 0) {
    return 1;
  }

  if (!next_token_is(buf, bufsize, "(")) {
    return 1;
  }

  for (int i = 0; i < dims; i++) {
    if (!next_token_is(buf, bufsize, "[")) {
      return 1;
    }

    next_token(buf, bufsize);

    if (sscanf(buf, "%"SCNu64, (uint64_t*)&shape[i]) != 1) {
      return 1;
    }

    if (!next_token_is(buf, bufsize, "]")) {
      return 1;
    }
  }

  if (!next_token_is(buf, bufsize, type_name)) {
    return 1;
  }


  if (!next_token_is(buf, bufsize, ")")) {
    return 1;
  }

  // Check whether the array really is empty.
  for (int i = 0; i < dims; i++) {
    if (shape[i] == 0) {
      return 0;
    }
  }

  // Not an empty array!
  return 1;
}

static int read_str_array(int64_t elem_size, str_reader elem_reader,
                          const char *type_name,
                          void **data, int64_t *shape, int64_t dims) {
  int ret;
  struct array_reader reader;
  char buf[100];

  int dims_seen;
  for (dims_seen = 0; dims_seen < dims; dims_seen++) {
    if (!next_token_is(buf, sizeof(buf), "[")) {
      break;
    }
  }

  if (dims_seen == 0) {
    return read_str_empty_array(buf, sizeof(buf), type_name, shape, dims);
  }

  if (dims_seen != dims) {
    return 1;
  }

  reader.shape = shape;
  reader.n_elems_used = 0;
  reader.elem_size = elem_size;
  reader.n_elems_space = 16;
  reader.elems = (char*) realloc(*data, (size_t)(elem_size*reader.n_elems_space));
  reader.elem_reader = elem_reader;

  ret = read_str_array_elems(buf, sizeof(buf), &reader, dims);

  *data = reader.elems;

  return ret;
}

#define READ_STR(MACRO, PTR, SUFFIX)                                   \
  remove_underscores(buf);                                              \
  int j;                                                                \
  if (sscanf(buf, "%"MACRO"%n", (PTR*)dest, &j) == 1) {                 \
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, SUFFIX) == 0);     \
  } else {                                                              \
    return 1;                                                           \
  }

static int read_str_i8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNi8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(int8_t*)dest = (int8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "i8") == 0);
  } else {
    return 1;
  }
}

static int read_str_u8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNu8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(uint8_t*)dest = (uint8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "u8") == 0);
  } else {
    return 1;
  }
}

static int read_str_i16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "i16");
}

static int read_str_u16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "u16");
}

static int read_str_i32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "i32");
}

static int read_str_u32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "u32");
}

static int read_str_i64(char *buf, void* dest) {
  READ_STR(SCNi64, int64_t, "i64");
}

static int read_str_u64(char *buf, void* dest) {
  // FIXME: This is not correct, as SCNu64 only permits decimal
  // literals.  However, SCNi64 does not handle very large numbers
  // correctly (it's really for signed numbers, so that's fair).
  READ_STR(SCNu64, uint64_t, "u64");
}

static int read_str_f32(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f32.nan") == 0) {
    *(float*)dest = NAN;
    return 0;
  } else if (strcmp(buf, "f32.inf") == 0) {
    *(float*)dest = INFINITY;
    return 0;
  } else if (strcmp(buf, "-f32.inf") == 0) {
    *(float*)dest = -INFINITY;
    return 0;
  } else {
    READ_STR("f", float, "f32");
  }
}

static int read_str_f64(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f64.nan") == 0) {
    *(double*)dest = NAN;
    return 0;
  } else if (strcmp(buf, "f64.inf") == 0) {
    *(double*)dest = INFINITY;
    return 0;
  } else if (strcmp(buf, "-f64.inf") == 0) {
    *(double*)dest = -INFINITY;
    return 0;
  } else {
    READ_STR("lf", double, "f64");
  }
}

static int read_str_bool(char *buf, void* dest) {
  if (strcmp(buf, "true") == 0) {
    *(char*)dest = 1;
    return 0;
  } else if (strcmp(buf, "false") == 0) {
    *(char*)dest = 0;
    return 0;
  } else {
    return 1;
  }
}

static int write_str_i8(FILE *out, int8_t *src) {
  return fprintf(out, "%hhdi8", *src);
}

static int write_str_u8(FILE *out, uint8_t *src) {
  return fprintf(out, "%hhuu8", *src);
}

static int write_str_i16(FILE *out, int16_t *src) {
  return fprintf(out, "%hdi16", *src);
}

static int write_str_u16(FILE *out, uint16_t *src) {
  return fprintf(out, "%huu16", *src);
}

static int write_str_i32(FILE *out, int32_t *src) {
  return fprintf(out, "%di32", *src);
}

static int write_str_u32(FILE *out, uint32_t *src) {
  return fprintf(out, "%uu32", *src);
}

static int write_str_i64(FILE *out, int64_t *src) {
  return fprintf(out, "%"PRIi64"i64", *src);
}

static int write_str_u64(FILE *out, uint64_t *src) {
  return fprintf(out, "%"PRIu64"u64", *src);
}

static int write_str_f32(FILE *out, float *src) {
  float x = *src;
  if (isnan(x)) {
    return fprintf(out, "f32.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f32.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f32.inf");
  } else {
    return fprintf(out, "%.6ff32", x);
  }
}

static int write_str_f64(FILE *out, double *src) {
  double x = *src;
  if (isnan(x)) {
    return fprintf(out, "f64.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f64.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f64.inf");
  } else {
    return fprintf(out, "%.6ff64", *src);
  }
}

static int write_str_bool(FILE *out, void *src) {
  return fprintf(out, *(char*)src ? "true" : "false");
}

//// Binary I/O

#define BINARY_FORMAT_VERSION 2
#define IS_BIG_ENDIAN (!*(unsigned char *)&(uint16_t){1})

static void flip_bytes(int elem_size, unsigned char *elem) {
  for (int j=0; j<elem_size/2; j++) {
    unsigned char head = elem[j];
    int tail_index = elem_size-1-j;
    elem[j] = elem[tail_index];
    elem[tail_index] = head;
  }
}

// On Windows we need to explicitly set the file mode to not mangle
// newline characters.  On *nix there is no difference.
#ifdef _WIN32
#include <io.h>
#include <fcntl.h>
static void set_binary_mode(FILE *f) {
  setmode(fileno(f), O_BINARY);
}
#else
static void set_binary_mode(FILE *f) {
  (void)f;
}
#endif

static int read_byte(void* dest) {
  int num_elems_read = fread(dest, 1, 1, stdin);
  return num_elems_read == 1 ? 0 : 1;
}

//// Types

struct primtype_info_t {
  const char binname[4]; // Used for parsing binary data.
  const char* type_name; // Same name as in Futhark.
  const int64_t size; // in bytes
  const writer write_str; // Write in text format.
  const str_reader read_str; // Read in text format.
};

static const struct primtype_info_t i8_info =
  {.binname = "  i8", .type_name = "i8",   .size = 1,
   .write_str = (writer)write_str_i8, .read_str = (str_reader)read_str_i8};
static const struct primtype_info_t i16_info =
  {.binname = " i16", .type_name = "i16",  .size = 2,
   .write_str = (writer)write_str_i16, .read_str = (str_reader)read_str_i16};
static const struct primtype_info_t i32_info =
  {.binname = " i32", .type_name = "i32",  .size = 4,
   .write_str = (writer)write_str_i32, .read_str = (str_reader)read_str_i32};
static const struct primtype_info_t i64_info =
  {.binname = " i64", .type_name = "i64",  .size = 8,
   .write_str = (writer)write_str_i64, .read_str = (str_reader)read_str_i64};
static const struct primtype_info_t u8_info =
  {.binname = "  u8", .type_name = "u8",   .size = 1,
   .write_str = (writer)write_str_u8, .read_str = (str_reader)read_str_u8};
static const struct primtype_info_t u16_info =
  {.binname = " u16", .type_name = "u16",  .size = 2,
   .write_str = (writer)write_str_u16, .read_str = (str_reader)read_str_u16};
static const struct primtype_info_t u32_info =
  {.binname = " u32", .type_name = "u32",  .size = 4,
   .write_str = (writer)write_str_u32, .read_str = (str_reader)read_str_u32};
static const struct primtype_info_t u64_info =
  {.binname = " u64", .type_name = "u64",  .size = 8,
   .write_str = (writer)write_str_u64, .read_str = (str_reader)read_str_u64};
static const struct primtype_info_t f32_info =
  {.binname = " f32", .type_name = "f32",  .size = 4,
   .write_str = (writer)write_str_f32, .read_str = (str_reader)read_str_f32};
static const struct primtype_info_t f64_info =
  {.binname = " f64", .type_name = "f64",  .size = 8,
   .write_str = (writer)write_str_f64, .read_str = (str_reader)read_str_f64};
static const struct primtype_info_t bool_info =
  {.binname = "bool", .type_name = "bool", .size = 1,
   .write_str = (writer)write_str_bool, .read_str = (str_reader)read_str_bool};

static const struct primtype_info_t* primtypes[] = {
  &i8_info, &i16_info, &i32_info, &i64_info,
  &u8_info, &u16_info, &u32_info, &u64_info,
  &f32_info, &f64_info,
  &bool_info,
  NULL // NULL-terminated
};

// General value interface.  All endian business taken care of at
// lower layers.

static int read_is_binary() {
  skipspaces();
  int c = getchar();
  if (c == 'b') {
    int8_t bin_version;
    int ret = read_byte(&bin_version);

    if (ret != 0) { futhark_panic(1, "binary-input: could not read version.\n"); }

    if (bin_version != BINARY_FORMAT_VERSION) {
      futhark_panic(1, "binary-input: File uses version %i, but I only understand version %i.\n",
            bin_version, BINARY_FORMAT_VERSION);
    }

    return 1;
  }
  ungetc(c, stdin);
  return 0;
}

static const struct primtype_info_t* read_bin_read_type_enum() {
  char read_binname[4];

  int num_matched = scanf("%4c", read_binname);
  if (num_matched != 1) { futhark_panic(1, "binary-input: Couldn't read element type.\n"); }

  const struct primtype_info_t **type = primtypes;

  for (; *type != NULL; type++) {
    // I compare the 4 characters manually instead of using strncmp because
    // this allows any value to be used, also NULL bytes
    if (memcmp(read_binname, (*type)->binname, 4) == 0) {
      return *type;
    }
  }
  futhark_panic(1, "binary-input: Did not recognize the type '%s'.\n", read_binname);
  return NULL;
}

static void read_bin_ensure_scalar(const struct primtype_info_t *expected_type) {
  int8_t bin_dims;
  int ret = read_byte(&bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != 0) {
    futhark_panic(1, "binary-input: Expected scalar (0 dimensions), but got array with %i dimensions.\n",
          bin_dims);
  }

  const struct primtype_info_t *bin_type = read_bin_read_type_enum();
  if (bin_type != expected_type) {
    futhark_panic(1, "binary-input: Expected scalar of type %s but got scalar of type %s.\n",
          expected_type->type_name,
          bin_type->type_name);
  }
}

//// High-level interface

static int read_bin_array(const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  int ret;

  int8_t bin_dims;
  ret = read_byte(&bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != dims) {
    futhark_panic(1, "binary-input: Expected %i dimensions, but got array with %i dimensions.\n",
          dims, bin_dims);
  }

  const struct primtype_info_t *bin_primtype = read_bin_read_type_enum();
  if (expected_type != bin_primtype) {
    futhark_panic(1, "binary-input: Expected %iD-array with element type '%s' but got %iD-array with element type '%s'.\n",
          dims, expected_type->type_name, dims, bin_primtype->type_name);
  }

  int64_t elem_count = 1;
  for (int i=0; i<dims; i++) {
    int64_t bin_shape;
    ret = fread(&bin_shape, sizeof(bin_shape), 1, stdin);
    if (ret != 1) {
      futhark_panic(1, "binary-input: Couldn't read size for dimension %i of array.\n", i);
    }
    if (IS_BIG_ENDIAN) {
      flip_bytes(sizeof(bin_shape), (unsigned char*) &bin_shape);
    }
    elem_count *= bin_shape;
    shape[i] = bin_shape;
  }

  int64_t elem_size = expected_type->size;
  void* tmp = realloc(*data, (size_t)(elem_count * elem_size));
  if (tmp == NULL) {
    futhark_panic(1, "binary-input: Failed to allocate array of size %i.\n",
          elem_count * elem_size);
  }
  *data = tmp;

  int64_t num_elems_read = (int64_t)fread(*data, (size_t)elem_size, (size_t)elem_count, stdin);
  if (num_elems_read != elem_count) {
    futhark_panic(1, "binary-input: tried to read %i elements of an array, but only got %i elements.\n",
          elem_count, num_elems_read);
  }

  // If we're on big endian platform we must change all multibyte elements
  // from using little endian to big endian
  if (IS_BIG_ENDIAN && elem_size != 1) {
    flip_bytes(elem_size, (unsigned char*) *data);
  }

  return 0;
}

static int read_array(const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  if (!read_is_binary()) {
    return read_str_array(expected_type->size, (str_reader)expected_type->read_str, expected_type->type_name, data, shape, dims);
  } else {
    return read_bin_array(expected_type, data, shape, dims);
  }
}

static int end_of_input() {
  skipspaces();
  char token[2];
  next_token(token, sizeof(token));
  if (strcmp(token, "") == 0) {
    return 0;
  } else {
    return 1;
  }
}

static int write_str_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  if (rank==0) {
    elem_type->write_str(out, (void*)data);
  } else {
    int64_t len = (int64_t)shape[0];
    int64_t slice_size = 1;

    int64_t elem_size = elem_type->size;
    for (int8_t i = 1; i < rank; i++) {
      slice_size *= shape[i];
    }

    if (len*slice_size == 0) {
      printf("empty(");
      for (int64_t i = 0; i < rank; i++) {
        printf("[%"PRIi64"]", shape[i]);
      }
      printf("%s", elem_type->type_name);
      printf(")");
    } else if (rank==1) {
      putchar('[');
      for (int64_t i = 0; i < len; i++) {
        elem_type->write_str(out, (void*) (data + i * elem_size));
        if (i != len-1) {
          printf(", ");
        }
      }
      putchar(']');
    } else {
      putchar('[');
      for (int64_t i = 0; i < len; i++) {
        write_str_array(out, elem_type, data + i * slice_size * elem_size, shape+1, rank-1);
        if (i != len-1) {
          printf(", ");
        }
      }
      putchar(']');
    }
  }
  return 0;
}

static int write_bin_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  int64_t num_elems = 1;
  for (int64_t i = 0; i < rank; i++) {
    num_elems *= shape[i];
  }

  fputc('b', out);
  fputc((char)BINARY_FORMAT_VERSION, out);
  fwrite(&rank, sizeof(int8_t), 1, out);
  fputs(elem_type->binname, out);
  if (shape != NULL) {
    fwrite(shape, sizeof(int64_t), (size_t)rank, out);
  }

  if (IS_BIG_ENDIAN) {
    for (int64_t i = 0; i < num_elems; i++) {
      const unsigned char *elem = data+i*elem_type->size;
      for (int64_t j = 0; j < elem_type->size; j++) {
        fwrite(&elem[elem_type->size-j], 1, 1, out);
      }
    }
  } else {
    fwrite(data, (size_t)elem_type->size, (size_t)num_elems, out);
  }

  return 0;
}

static int write_array(FILE *out, int write_binary,
                       const struct primtype_info_t *elem_type,
                       const void *data,
                       const int64_t *shape,
                       const int8_t rank) {
  if (write_binary) {
    return write_bin_array(out, elem_type, data, shape, rank);
  } else {
    return write_str_array(out, elem_type, data, shape, rank);
  }
}

static int read_scalar(const struct primtype_info_t *expected_type, void *dest) {
  if (!read_is_binary()) {
    char buf[100];
    next_token(buf, sizeof(buf));
    return expected_type->read_str(buf, dest);
  } else {
    read_bin_ensure_scalar(expected_type);
    int64_t elem_size = expected_type->size;
    int num_elems_read = fread(dest, (size_t)elem_size, 1, stdin);
    if (IS_BIG_ENDIAN) {
      flip_bytes(elem_size, (unsigned char*) dest);
    }
    return num_elems_read == 1 ? 0 : 1;
  }
}

static int write_scalar(FILE *out, int write_binary, const struct primtype_info_t *type, void *src) {
  if (write_binary) {
    return write_bin_array(out, type, src, NULL, 0);
  } else {
    return type->write_str(out, src);
  }
}

// End of values.h.

#define __private
static int binary_output = 0;
static FILE *runtime_file;
static int perform_warmup = 0;
static int num_runs = 1;
static const char *entry_point = "main";
// Start of tuning.h.

static char* load_tuning_file(const char *fname,
                              void *cfg,
                              int (*set_size)(void*, const char*, size_t)) {
  const int max_line_len = 1024;
  char* line = (char*) malloc(max_line_len);

  FILE *f = fopen(fname, "r");

  if (f == NULL) {
    snprintf(line, max_line_len, "Cannot open file: %s", strerror(errno));
    return line;
  }

  int lineno = 0;
  while (fgets(line, max_line_len, f) != NULL) {
    lineno++;
    char *eql = strstr(line, "=");
    if (eql) {
      *eql = 0;
      int value = atoi(eql+1);
      if (set_size(cfg, line, value) != 0) {
        strncpy(eql+1, line, max_line_len-strlen(line)-1);
        snprintf(line, max_line_len, "Unknown name '%s' on line %d.", eql+1, lineno);
        return line;
      }
    } else {
      snprintf(line, max_line_len, "Invalid line %d (must be of form 'name=int').",
               lineno);
      return line;
    }
  }

  free(line);

  return NULL;
}

// End of tuning.h.

int parse_options(struct futhark_context_config *cfg, int argc,
                  char *const argv[])
{
    int ch;
    static struct option long_options[] = {{"write-runtime-to",
                                            required_argument, NULL, 1},
                                           {"runs", required_argument, NULL, 2},
                                           {"debugging", no_argument, NULL, 3},
                                           {"log", no_argument, NULL, 4},
                                           {"entry-point", required_argument,
                                            NULL, 5}, {"binary-output",
                                                       no_argument, NULL, 6},
                                           {"help", no_argument, NULL, 7},
                                           {"device", required_argument, NULL,
                                            8}, {"default-group-size",
                                                 required_argument, NULL, 9},
                                           {"default-num-groups",
                                            required_argument, NULL, 10},
                                           {"default-tile-size",
                                            required_argument, NULL, 11},
                                           {"default-threshold",
                                            required_argument, NULL, 12},
                                           {"print-sizes", no_argument, NULL,
                                            13}, {"size", required_argument,
                                                  NULL, 14}, {"tuning",
                                                              required_argument,
                                                              NULL, 15},
                                           {"platform", required_argument, NULL,
                                            16}, {"dump-opencl",
                                                  required_argument, NULL, 17},
                                           {"load-opencl", required_argument,
                                            NULL, 18}, {"dump-opencl-binary",
                                                        required_argument, NULL,
                                                        19},
                                           {"load-opencl-binary",
                                            required_argument, NULL, 20},
                                           {"build-option", required_argument,
                                            NULL, 21}, {"profile", no_argument,
                                                        NULL, 22},
                                           {"list-devices", no_argument, NULL,
                                            23}, {0, 0, 0, 0}};
    static char *option_descriptions =
                "  -t/--write-runtime-to FILE Print the time taken to execute the program to the indicated file, an integral number of microseconds.\n  -r/--runs INT              Perform NUM runs of the program.\n  -D/--debugging             Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                   Print various low-overhead logging information to stderr while running.\n  -e/--entry-point NAME      The entry point to run. Defaults to main.\n  -b/--binary-output         Print the program result in the binary output format.\n  -h/--help                  Print help information and exit.\n  -d/--device NAME           Use the first OpenCL device whose name contains the given string.\n  --default-group-size INT   The default size of OpenCL workgroups that are launched.\n  --default-num-groups INT   The default number of OpenCL workgroups that are launched.\n  --default-tile-size INT    The default tile size used when performing two-dimensional tiling.\n  --default-threshold INT    The default parallelism threshold.\n  --print-sizes              Print all sizes that can be set with -size or --tuning.\n  --size ASSIGNMENT          Set a configurable run-time parameter to the given value.\n  --tuning FILE              Read size=value assignments from the given file.\n  -p/--platform NAME         Use the first OpenCL platform whose name contains the given string.\n  --dump-opencl FILE         Dump the embedded OpenCL program to the indicated file.\n  --load-opencl FILE         Instead of using the embedded OpenCL program, load it from the indicated file.\n  --dump-opencl-binary FILE  Dump the compiled version of the embedded OpenCL program to the indicated file.\n  --load-opencl-binary FILE  Load an OpenCL binary from the indicated file.\n  --build-option OPT         Add an additional build option to the string passed to clBuildProgram().\n  -P/--profile               Gather profiling data while executing and print out a summary at the end.\n  --list-devices             List all OpenCL devices and platforms available on the system.\n";
    
    while ((ch = getopt_long(argc, argv, ":t:r:DLe:bhd:p:P", long_options,
                             NULL)) != -1) {
        if (ch == 1 || ch == 't') {
            runtime_file = fopen(optarg, "w");
            if (runtime_file == NULL)
                futhark_panic(1, "Cannot open %s: %s\n", optarg,
                              strerror(errno));
        }
        if (ch == 2 || ch == 'r') {
            num_runs = atoi(optarg);
            perform_warmup = 1;
            if (num_runs <= 0)
                futhark_panic(1, "Need a positive number of runs, not %s\n",
                              optarg);
        }
        if (ch == 3 || ch == 'D')
            futhark_context_config_set_debugging(cfg, 1);
        if (ch == 4 || ch == 'L')
            futhark_context_config_set_logging(cfg, 1);
        if (ch == 5 || ch == 'e') {
            if (entry_point != NULL)
                entry_point = optarg;
        }
        if (ch == 6 || ch == 'b')
            binary_output = 1;
        if (ch == 7 || ch == 'h') {
            printf("Usage: %s [OPTION]...\nOptions:\n\n%s\nFor more information, consult the Futhark User's Guide or the man pages.\n",
                   fut_progname, option_descriptions);
            exit(0);
        }
        if (ch == 8 || ch == 'd')
            futhark_context_config_set_device(cfg, optarg);
        if (ch == 9)
            futhark_context_config_set_default_group_size(cfg, atoi(optarg));
        if (ch == 10)
            futhark_context_config_set_default_num_groups(cfg, atoi(optarg));
        if (ch == 11)
            futhark_context_config_set_default_tile_size(cfg, atoi(optarg));
        if (ch == 12)
            futhark_context_config_set_default_threshold(cfg, atoi(optarg));
        if (ch == 13) {
            int n = futhark_get_num_sizes();
            
            for (int i = 0; i < n; i++)
                printf("%s (%s)\n", futhark_get_size_name(i),
                       futhark_get_size_class(i));
            exit(0);
        }
        if (ch == 14) {
            char *name = optarg;
            char *equals = strstr(optarg, "=");
            char *value_str = equals != NULL ? equals + 1 : optarg;
            int value = atoi(value_str);
            
            if (equals != NULL) {
                *equals = 0;
                if (futhark_context_config_set_size(cfg, name, value) != 0)
                    futhark_panic(1, "Unknown size: %s\n", name);
            } else
                futhark_panic(1, "Invalid argument for size option: %s\n",
                              optarg);
        }
        if (ch == 15) {
            char *ret = load_tuning_file(optarg, cfg, (int (*)(void *, const
                                                               char *,
                                                               size_t)) futhark_context_config_set_size);
            
            if (ret != NULL)
                futhark_panic(1, "When loading tuning from '%s': %s\n", optarg,
                              ret);
        }
        if (ch == 16 || ch == 'p')
            futhark_context_config_set_platform(cfg, optarg);
        if (ch == 17) {
            futhark_context_config_dump_program_to(cfg, optarg);
            entry_point = NULL;
        }
        if (ch == 18)
            futhark_context_config_load_program_from(cfg, optarg);
        if (ch == 19) {
            futhark_context_config_dump_binary_to(cfg, optarg);
            entry_point = NULL;
        }
        if (ch == 20)
            futhark_context_config_load_binary_from(cfg, optarg);
        if (ch == 21)
            futhark_context_config_add_build_option(cfg, optarg);
        if (ch == 22 || ch == 'P')
            futhark_context_config_set_profiling(cfg, 1);
        if (ch == 23) {
            futhark_context_config_list_devices(cfg);
            entry_point = NULL;
        }
        if (ch == ':')
            futhark_panic(-1, "Missing argument for option %s\n", argv[optind -
                                                                       1]);
        if (ch == '?') {
            fprintf(stderr, "Usage: %s: %s\n", fut_progname,
                    "  -t/--write-runtime-to FILE Print the time taken to execute the program to the indicated file, an integral number of microseconds.\n  -r/--runs INT              Perform NUM runs of the program.\n  -D/--debugging             Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                   Print various low-overhead logging information to stderr while running.\n  -e/--entry-point NAME      The entry point to run. Defaults to main.\n  -b/--binary-output         Print the program result in the binary output format.\n  -h/--help                  Print help information and exit.\n  -d/--device NAME           Use the first OpenCL device whose name contains the given string.\n  --default-group-size INT   The default size of OpenCL workgroups that are launched.\n  --default-num-groups INT   The default number of OpenCL workgroups that are launched.\n  --default-tile-size INT    The default tile size used when performing two-dimensional tiling.\n  --default-threshold INT    The default parallelism threshold.\n  --print-sizes              Print all sizes that can be set with -size or --tuning.\n  --size ASSIGNMENT          Set a configurable run-time parameter to the given value.\n  --tuning FILE              Read size=value assignments from the given file.\n  -p/--platform NAME         Use the first OpenCL platform whose name contains the given string.\n  --dump-opencl FILE         Dump the embedded OpenCL program to the indicated file.\n  --load-opencl FILE         Instead of using the embedded OpenCL program, load it from the indicated file.\n  --dump-opencl-binary FILE  Dump the compiled version of the embedded OpenCL program to the indicated file.\n  --load-opencl-binary FILE  Load an OpenCL binary from the indicated file.\n  --build-option OPT         Add an additional build option to the string passed to clBuildProgram().\n  -P/--profile               Gather profiling data while executing and print out a summary at the end.\n  --list-devices             List all OpenCL devices and platforms available on the system.\n");
            futhark_panic(1, "Unknown option: %s\n", argv[optind - 1]);
        }
    }
    return optind;
}
static void futrts_cli_entry_main(struct futhark_context *ctx)
{
    int64_t t_start, t_end;
    int time_runs = 0, profile_run = 0;
    
    // We do not want to profile all the initialisation.
    futhark_context_pause_profiling(ctx);
    // Declare and read input.
    set_binary_mode(stdin);
    
    int64_t read_value_27773;
    
    if (read_scalar(&i64_info, &read_value_27773) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      0, i64_info.type_name, strerror(errno));
    
    int64_t read_value_27774;
    
    if (read_scalar(&i64_info, &read_value_27774) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      1, i64_info.type_name, strerror(errno));
    
    struct futhark_f32_1d *read_value_27775;
    int64_t read_shape_27776[1];
    float *read_arr_27777 = NULL;
    
    errno = 0;
    if (read_array(&f32_info, (void **) &read_arr_27777, read_shape_27776, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s%s (errno: %s).\n", 2,
                      "[]", f32_info.type_name, strerror(errno));
    
    struct futhark_i64_1d *read_value_27778;
    int64_t read_shape_27779[1];
    int64_t *read_arr_27780 = NULL;
    
    errno = 0;
    if (read_array(&i64_info, (void **) &read_arr_27780, read_shape_27779, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s%s (errno: %s).\n", 3,
                      "[]", i64_info.type_name, strerror(errno));
    
    struct futhark_f32_1d *read_value_27781;
    int64_t read_shape_27782[1];
    float *read_arr_27783 = NULL;
    
    errno = 0;
    if (read_array(&f32_info, (void **) &read_arr_27783, read_shape_27782, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s%s (errno: %s).\n", 4,
                      "[]", f32_info.type_name, strerror(errno));
    
    float read_value_27784;
    
    if (read_scalar(&f32_info, &read_value_27784) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      5, f32_info.type_name, strerror(errno));
    
    float read_value_27785;
    
    if (read_scalar(&f32_info, &read_value_27785) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      6, f32_info.type_name, strerror(errno));
    
    float read_value_27786;
    
    if (read_scalar(&f32_info, &read_value_27786) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      7, f32_info.type_name, strerror(errno));
    
    float read_value_27787;
    
    if (read_scalar(&f32_info, &read_value_27787) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      8, f32_info.type_name, strerror(errno));
    if (end_of_input() != 0)
        futhark_panic(1, "Expected EOF on stdin after reading input for %s.\n",
                      "\"main\"");
    
    float result_27788;
    struct futhark_f32_1d *result_27789;
    
    if (perform_warmup) {
        int r;
        
        ;
        ;
        assert((read_value_27775 = futhark_new_f32_1d(ctx, read_arr_27777,
                                                      read_shape_27776[0])) !=
            0);
        assert((read_value_27778 = futhark_new_i64_1d(ctx, read_arr_27780,
                                                      read_shape_27779[0])) !=
            0);
        assert((read_value_27781 = futhark_new_f32_1d(ctx, read_arr_27783,
                                                      read_shape_27782[0])) !=
            0);
        ;
        ;
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_main(ctx, &result_27788, &result_27789,
                               read_value_27773, read_value_27774,
                               read_value_27775, read_value_27778,
                               read_value_27781, read_value_27784,
                               read_value_27785, read_value_27786,
                               read_value_27787);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        assert(futhark_free_f32_1d(ctx, read_value_27775) == 0);
        assert(futhark_free_i64_1d(ctx, read_value_27778) == 0);
        assert(futhark_free_f32_1d(ctx, read_value_27781) == 0);
        ;
        ;
        ;
        ;
        ;
        assert(futhark_free_f32_1d(ctx, result_27789) == 0);
    }
    time_runs = 1;
    // Proper run.
    for (int run = 0; run < num_runs; run++) {
        // Only profile last run.
        profile_run = run == num_runs - 1;
        
        int r;
        
        ;
        ;
        assert((read_value_27775 = futhark_new_f32_1d(ctx, read_arr_27777,
                                                      read_shape_27776[0])) !=
            0);
        assert((read_value_27778 = futhark_new_i64_1d(ctx, read_arr_27780,
                                                      read_shape_27779[0])) !=
            0);
        assert((read_value_27781 = futhark_new_f32_1d(ctx, read_arr_27783,
                                                      read_shape_27782[0])) !=
            0);
        ;
        ;
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_main(ctx, &result_27788, &result_27789,
                               read_value_27773, read_value_27774,
                               read_value_27775, read_value_27778,
                               read_value_27781, read_value_27784,
                               read_value_27785, read_value_27786,
                               read_value_27787);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        assert(futhark_free_f32_1d(ctx, read_value_27775) == 0);
        assert(futhark_free_i64_1d(ctx, read_value_27778) == 0);
        assert(futhark_free_f32_1d(ctx, read_value_27781) == 0);
        ;
        ;
        ;
        ;
        if (run < num_runs - 1) {
            ;
            assert(futhark_free_f32_1d(ctx, result_27789) == 0);
        }
    }
    ;
    ;
    free(read_arr_27777);
    free(read_arr_27780);
    free(read_arr_27783);
    ;
    ;
    ;
    ;
    if (binary_output)
        set_binary_mode(stdout);
    write_scalar(stdout, binary_output, &f32_info, &result_27788);
    printf("\n");
    {
        float *arr = calloc(sizeof(float), futhark_shape_f32_1d(ctx,
                                                                result_27789)[0]);
        
        assert(arr != NULL);
        assert(futhark_values_f32_1d(ctx, result_27789, arr) == 0);
        write_array(stdout, binary_output, &f32_info, arr,
                    futhark_shape_f32_1d(ctx, result_27789), 1);
        free(arr);
    }
    printf("\n");
    ;
    assert(futhark_free_f32_1d(ctx, result_27789) == 0);
}
static void futrts_cli_entry_test(struct futhark_context *ctx)
{
    int64_t t_start, t_end;
    int time_runs = 0, profile_run = 0;
    
    // We do not want to profile all the initialisation.
    futhark_context_pause_profiling(ctx);
    // Declare and read input.
    set_binary_mode(stdin);
    
    int64_t read_value_27790;
    
    if (read_scalar(&i64_info, &read_value_27790) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      0, i64_info.type_name, strerror(errno));
    
    int64_t read_value_27791;
    
    if (read_scalar(&i64_info, &read_value_27791) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      1, i64_info.type_name, strerror(errno));
    if (end_of_input() != 0)
        futhark_panic(1, "Expected EOF on stdin after reading input for %s.\n",
                      "\"test\"");
    
    float result_27792;
    
    if (perform_warmup) {
        int r;
        
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_test(ctx, &result_27792, read_value_27790,
                               read_value_27791);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        ;
    }
    time_runs = 1;
    // Proper run.
    for (int run = 0; run < num_runs; run++) {
        // Only profile last run.
        profile_run = run == num_runs - 1;
        
        int r;
        
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_test(ctx, &result_27792, read_value_27790,
                               read_value_27791);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        if (run < num_runs - 1) {
            ;
        }
    }
    ;
    ;
    if (binary_output)
        set_binary_mode(stdout);
    write_scalar(stdout, binary_output, &f32_info, &result_27792);
    printf("\n");
    ;
}
static void futrts_cli_entry_test2(struct futhark_context *ctx)
{
    int64_t t_start, t_end;
    int time_runs = 0, profile_run = 0;
    
    // We do not want to profile all the initialisation.
    futhark_context_pause_profiling(ctx);
    // Declare and read input.
    set_binary_mode(stdin);
    
    int64_t read_value_27793;
    
    if (read_scalar(&i64_info, &read_value_27793) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      0, i64_info.type_name, strerror(errno));
    
    int64_t read_value_27794;
    
    if (read_scalar(&i64_info, &read_value_27794) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      1, i64_info.type_name, strerror(errno));
    
    int64_t read_value_27795;
    
    if (read_scalar(&i64_info, &read_value_27795) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      2, i64_info.type_name, strerror(errno));
    if (end_of_input() != 0)
        futhark_panic(1, "Expected EOF on stdin after reading input for %s.\n",
                      "\"test2\"");
    
    float result_27796;
    
    if (perform_warmup) {
        int r;
        
        ;
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_test2(ctx, &result_27796, read_value_27793,
                                read_value_27794, read_value_27795);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        ;
        ;
    }
    time_runs = 1;
    // Proper run.
    for (int run = 0; run < num_runs; run++) {
        // Only profile last run.
        profile_run = run == num_runs - 1;
        
        int r;
        
        ;
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_test2(ctx, &result_27796, read_value_27793,
                                read_value_27794, read_value_27795);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        ;
        if (run < num_runs - 1) {
            ;
        }
    }
    ;
    ;
    ;
    if (binary_output)
        set_binary_mode(stdout);
    write_scalar(stdout, binary_output, &f32_info, &result_27796);
    printf("\n");
    ;
}
typedef void entry_point_fun(struct futhark_context *);
struct entry_point_entry {
    const char *name;
    entry_point_fun *fun;
} ;
int main(int argc, char **argv)
{
    fut_progname = argv[0];
    
    struct entry_point_entry entry_points[] = {{.name ="main", .fun =
                                                futrts_cli_entry_main}, {.name =
                                                                         "test",
                                                                         .fun =
                                                                         futrts_cli_entry_test},
                                               {.name ="test2", .fun =
                                                futrts_cli_entry_test2}};
    struct futhark_context_config *cfg = futhark_context_config_new();
    
    assert(cfg != NULL);
    
    int parsed_options = parse_options(cfg, argc, argv);
    
    argc -= parsed_options;
    argv += parsed_options;
    if (argc != 0)
        futhark_panic(1, "Excess non-option: %s\n", argv[0]);
    
    struct futhark_context *ctx = futhark_context_new(cfg);
    
    assert(ctx != NULL);
    
    char *error = futhark_context_get_error(ctx);
    
    if (error != NULL)
        futhark_panic(1, "%s", error);
    if (entry_point != NULL) {
        int num_entry_points = sizeof(entry_points) / sizeof(entry_points[0]);
        entry_point_fun *entry_point_fun = NULL;
        
        for (int i = 0; i < num_entry_points; i++) {
            if (strcmp(entry_points[i].name, entry_point) == 0) {
                entry_point_fun = entry_points[i].fun;
                break;
            }
        }
        if (entry_point_fun == NULL) {
            fprintf(stderr,
                    "No entry point '%s'.  Select another with --entry-point.  Options are:\n",
                    entry_point);
            for (int i = 0; i < num_entry_points; i++)
                fprintf(stderr, "%s\n", entry_points[i].name);
            return 1;
        }
        entry_point_fun(ctx);
        if (runtime_file != NULL)
            fclose(runtime_file);
        
        char *report = futhark_context_report(ctx);
        
        fputs(report, stderr);
        free(report);
    }
    futhark_context_free(ctx);
    futhark_context_config_free(cfg);
    return 0;
}
#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <inttypes.h>
#include <ctype.h>
#include <errno.h>
#include <assert.h>
#define CL_TARGET_OPENCL_VERSION 120
#define CL_USE_DEPRECATED_OPENCL_1_2_APIS
#ifdef __APPLE__
#define CL_SILENCE_DEPRECATION
#include <OpenCL/cl.h>
#else
#include <CL/cl.h>
#endif

// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.

static inline uint8_t add8(uint8_t x, uint8_t y)
{
    return x + y;
}
static inline uint16_t add16(uint16_t x, uint16_t y)
{
    return x + y;
}
static inline uint32_t add32(uint32_t x, uint32_t y)
{
    return x + y;
}
static inline uint64_t add64(uint64_t x, uint64_t y)
{
    return x + y;
}
static inline uint8_t sub8(uint8_t x, uint8_t y)
{
    return x - y;
}
static inline uint16_t sub16(uint16_t x, uint16_t y)
{
    return x - y;
}
static inline uint32_t sub32(uint32_t x, uint32_t y)
{
    return x - y;
}
static inline uint64_t sub64(uint64_t x, uint64_t y)
{
    return x - y;
}
static inline uint8_t mul8(uint8_t x, uint8_t y)
{
    return x * y;
}
static inline uint16_t mul16(uint16_t x, uint16_t y)
{
    return x * y;
}
static inline uint32_t mul32(uint32_t x, uint32_t y)
{
    return x * y;
}
static inline uint64_t mul64(uint64_t x, uint64_t y)
{
    return x * y;
}
static inline uint8_t udiv8(uint8_t x, uint8_t y)
{
    return x / y;
}
static inline uint16_t udiv16(uint16_t x, uint16_t y)
{
    return x / y;
}
static inline uint32_t udiv32(uint32_t x, uint32_t y)
{
    return x / y;
}
static inline uint64_t udiv64(uint64_t x, uint64_t y)
{
    return x / y;
}
static inline uint8_t udiv_up8(uint8_t x, uint8_t y)
{
    return (x + y - 1) / y;
}
static inline uint16_t udiv_up16(uint16_t x, uint16_t y)
{
    return (x + y - 1) / y;
}
static inline uint32_t udiv_up32(uint32_t x, uint32_t y)
{
    return (x + y - 1) / y;
}
static inline uint64_t udiv_up64(uint64_t x, uint64_t y)
{
    return (x + y - 1) / y;
}
static inline uint8_t umod8(uint8_t x, uint8_t y)
{
    return x % y;
}
static inline uint16_t umod16(uint16_t x, uint16_t y)
{
    return x % y;
}
static inline uint32_t umod32(uint32_t x, uint32_t y)
{
    return x % y;
}
static inline uint64_t umod64(uint64_t x, uint64_t y)
{
    return x % y;
}
static inline uint8_t udiv_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint16_t udiv_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint32_t udiv_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint64_t udiv_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint8_t umod_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint16_t umod_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint32_t umod_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint64_t umod_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int8_t sdiv8(int8_t x, int8_t y)
{
    int8_t q = x / y;
    int8_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int16_t sdiv16(int16_t x, int16_t y)
{
    int16_t q = x / y;
    int16_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int32_t sdiv32(int32_t x, int32_t y)
{
    int32_t q = x / y;
    int32_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int64_t sdiv64(int64_t x, int64_t y)
{
    int64_t q = x / y;
    int64_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int8_t sdiv_up8(int8_t x, int8_t y)
{
    return sdiv8(x + y - 1, y);
}
static inline int16_t sdiv_up16(int16_t x, int16_t y)
{
    return sdiv16(x + y - 1, y);
}
static inline int32_t sdiv_up32(int32_t x, int32_t y)
{
    return sdiv32(x + y - 1, y);
}
static inline int64_t sdiv_up64(int64_t x, int64_t y)
{
    return sdiv64(x + y - 1, y);
}
static inline int8_t smod8(int8_t x, int8_t y)
{
    int8_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int16_t smod16(int16_t x, int16_t y)
{
    int16_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int32_t smod32(int32_t x, int32_t y)
{
    int32_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int64_t smod64(int64_t x, int64_t y)
{
    int64_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int8_t sdiv_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : sdiv8(x, y);
}
static inline int16_t sdiv_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : sdiv16(x, y);
}
static inline int32_t sdiv_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : sdiv32(x, y);
}
static inline int64_t sdiv_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : sdiv64(x, y);
}
static inline int8_t sdiv_up_safe8(int8_t x, int8_t y)
{
    return sdiv_safe8(x + y - 1, y);
}
static inline int16_t sdiv_up_safe16(int16_t x, int16_t y)
{
    return sdiv_safe16(x + y - 1, y);
}
static inline int32_t sdiv_up_safe32(int32_t x, int32_t y)
{
    return sdiv_safe32(x + y - 1, y);
}
static inline int64_t sdiv_up_safe64(int64_t x, int64_t y)
{
    return sdiv_safe64(x + y - 1, y);
}
static inline int8_t smod_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : smod8(x, y);
}
static inline int16_t smod_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : smod16(x, y);
}
static inline int32_t smod_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : smod32(x, y);
}
static inline int64_t smod_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : smod64(x, y);
}
static inline int8_t squot8(int8_t x, int8_t y)
{
    return x / y;
}
static inline int16_t squot16(int16_t x, int16_t y)
{
    return x / y;
}
static inline int32_t squot32(int32_t x, int32_t y)
{
    return x / y;
}
static inline int64_t squot64(int64_t x, int64_t y)
{
    return x / y;
}
static inline int8_t srem8(int8_t x, int8_t y)
{
    return x % y;
}
static inline int16_t srem16(int16_t x, int16_t y)
{
    return x % y;
}
static inline int32_t srem32(int32_t x, int32_t y)
{
    return x % y;
}
static inline int64_t srem64(int64_t x, int64_t y)
{
    return x % y;
}
static inline int8_t squot_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int16_t squot_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int32_t squot_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int64_t squot_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int8_t srem_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int16_t srem_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int32_t srem_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int64_t srem_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int8_t smin8(int8_t x, int8_t y)
{
    return x < y ? x : y;
}
static inline int16_t smin16(int16_t x, int16_t y)
{
    return x < y ? x : y;
}
static inline int32_t smin32(int32_t x, int32_t y)
{
    return x < y ? x : y;
}
static inline int64_t smin64(int64_t x, int64_t y)
{
    return x < y ? x : y;
}
static inline uint8_t umin8(uint8_t x, uint8_t y)
{
    return x < y ? x : y;
}
static inline uint16_t umin16(uint16_t x, uint16_t y)
{
    return x < y ? x : y;
}
static inline uint32_t umin32(uint32_t x, uint32_t y)
{
    return x < y ? x : y;
}
static inline uint64_t umin64(uint64_t x, uint64_t y)
{
    return x < y ? x : y;
}
static inline int8_t smax8(int8_t x, int8_t y)
{
    return x < y ? y : x;
}
static inline int16_t smax16(int16_t x, int16_t y)
{
    return x < y ? y : x;
}
static inline int32_t smax32(int32_t x, int32_t y)
{
    return x < y ? y : x;
}
static inline int64_t smax64(int64_t x, int64_t y)
{
    return x < y ? y : x;
}
static inline uint8_t umax8(uint8_t x, uint8_t y)
{
    return x < y ? y : x;
}
static inline uint16_t umax16(uint16_t x, uint16_t y)
{
    return x < y ? y : x;
}
static inline uint32_t umax32(uint32_t x, uint32_t y)
{
    return x < y ? y : x;
}
static inline uint64_t umax64(uint64_t x, uint64_t y)
{
    return x < y ? y : x;
}
static inline uint8_t shl8(uint8_t x, uint8_t y)
{
    return x << y;
}
static inline uint16_t shl16(uint16_t x, uint16_t y)
{
    return x << y;
}
static inline uint32_t shl32(uint32_t x, uint32_t y)
{
    return x << y;
}
static inline uint64_t shl64(uint64_t x, uint64_t y)
{
    return x << y;
}
static inline uint8_t lshr8(uint8_t x, uint8_t y)
{
    return x >> y;
}
static inline uint16_t lshr16(uint16_t x, uint16_t y)
{
    return x >> y;
}
static inline uint32_t lshr32(uint32_t x, uint32_t y)
{
    return x >> y;
}
static inline uint64_t lshr64(uint64_t x, uint64_t y)
{
    return x >> y;
}
static inline int8_t ashr8(int8_t x, int8_t y)
{
    return x >> y;
}
static inline int16_t ashr16(int16_t x, int16_t y)
{
    return x >> y;
}
static inline int32_t ashr32(int32_t x, int32_t y)
{
    return x >> y;
}
static inline int64_t ashr64(int64_t x, int64_t y)
{
    return x >> y;
}
static inline uint8_t and8(uint8_t x, uint8_t y)
{
    return x & y;
}
static inline uint16_t and16(uint16_t x, uint16_t y)
{
    return x & y;
}
static inline uint32_t and32(uint32_t x, uint32_t y)
{
    return x & y;
}
static inline uint64_t and64(uint64_t x, uint64_t y)
{
    return x & y;
}
static inline uint8_t or8(uint8_t x, uint8_t y)
{
    return x | y;
}
static inline uint16_t or16(uint16_t x, uint16_t y)
{
    return x | y;
}
static inline uint32_t or32(uint32_t x, uint32_t y)
{
    return x | y;
}
static inline uint64_t or64(uint64_t x, uint64_t y)
{
    return x | y;
}
static inline uint8_t xor8(uint8_t x, uint8_t y)
{
    return x ^ y;
}
static inline uint16_t xor16(uint16_t x, uint16_t y)
{
    return x ^ y;
}
static inline uint32_t xor32(uint32_t x, uint32_t y)
{
    return x ^ y;
}
static inline uint64_t xor64(uint64_t x, uint64_t y)
{
    return x ^ y;
}
static inline bool ult8(uint8_t x, uint8_t y)
{
    return x < y;
}
static inline bool ult16(uint16_t x, uint16_t y)
{
    return x < y;
}
static inline bool ult32(uint32_t x, uint32_t y)
{
    return x < y;
}
static inline bool ult64(uint64_t x, uint64_t y)
{
    return x < y;
}
static inline bool ule8(uint8_t x, uint8_t y)
{
    return x <= y;
}
static inline bool ule16(uint16_t x, uint16_t y)
{
    return x <= y;
}
static inline bool ule32(uint32_t x, uint32_t y)
{
    return x <= y;
}
static inline bool ule64(uint64_t x, uint64_t y)
{
    return x <= y;
}
static inline bool slt8(int8_t x, int8_t y)
{
    return x < y;
}
static inline bool slt16(int16_t x, int16_t y)
{
    return x < y;
}
static inline bool slt32(int32_t x, int32_t y)
{
    return x < y;
}
static inline bool slt64(int64_t x, int64_t y)
{
    return x < y;
}
static inline bool sle8(int8_t x, int8_t y)
{
    return x <= y;
}
static inline bool sle16(int16_t x, int16_t y)
{
    return x <= y;
}
static inline bool sle32(int32_t x, int32_t y)
{
    return x <= y;
}
static inline bool sle64(int64_t x, int64_t y)
{
    return x <= y;
}
static inline int8_t pow8(int8_t x, int8_t y)
{
    int8_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int16_t pow16(int16_t x, int16_t y)
{
    int16_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int32_t pow32(int32_t x, int32_t y)
{
    int32_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int64_t pow64(int64_t x, int64_t y)
{
    int64_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline bool itob_i8_bool(int8_t x)
{
    return x;
}
static inline bool itob_i16_bool(int16_t x)
{
    return x;
}
static inline bool itob_i32_bool(int32_t x)
{
    return x;
}
static inline bool itob_i64_bool(int64_t x)
{
    return x;
}
static inline int8_t btoi_bool_i8(bool x)
{
    return x;
}
static inline int16_t btoi_bool_i16(bool x)
{
    return x;
}
static inline int32_t btoi_bool_i32(bool x)
{
    return x;
}
static inline int64_t btoi_bool_i64(bool x)
{
    return x;
}
#define sext_i8_i8(x) ((int8_t) (int8_t) x)
#define sext_i8_i16(x) ((int16_t) (int8_t) x)
#define sext_i8_i32(x) ((int32_t) (int8_t) x)
#define sext_i8_i64(x) ((int64_t) (int8_t) x)
#define sext_i16_i8(x) ((int8_t) (int16_t) x)
#define sext_i16_i16(x) ((int16_t) (int16_t) x)
#define sext_i16_i32(x) ((int32_t) (int16_t) x)
#define sext_i16_i64(x) ((int64_t) (int16_t) x)
#define sext_i32_i8(x) ((int8_t) (int32_t) x)
#define sext_i32_i16(x) ((int16_t) (int32_t) x)
#define sext_i32_i32(x) ((int32_t) (int32_t) x)
#define sext_i32_i64(x) ((int64_t) (int32_t) x)
#define sext_i64_i8(x) ((int8_t) (int64_t) x)
#define sext_i64_i16(x) ((int16_t) (int64_t) x)
#define sext_i64_i32(x) ((int32_t) (int64_t) x)
#define sext_i64_i64(x) ((int64_t) (int64_t) x)
#define zext_i8_i8(x) ((int8_t) (uint8_t) x)
#define zext_i8_i16(x) ((int16_t) (uint8_t) x)
#define zext_i8_i32(x) ((int32_t) (uint8_t) x)
#define zext_i8_i64(x) ((int64_t) (uint8_t) x)
#define zext_i16_i8(x) ((int8_t) (uint16_t) x)
#define zext_i16_i16(x) ((int16_t) (uint16_t) x)
#define zext_i16_i32(x) ((int32_t) (uint16_t) x)
#define zext_i16_i64(x) ((int64_t) (uint16_t) x)
#define zext_i32_i8(x) ((int8_t) (uint32_t) x)
#define zext_i32_i16(x) ((int16_t) (uint32_t) x)
#define zext_i32_i32(x) ((int32_t) (uint32_t) x)
#define zext_i32_i64(x) ((int64_t) (uint32_t) x)
#define zext_i64_i8(x) ((int8_t) (uint64_t) x)
#define zext_i64_i16(x) ((int16_t) (uint64_t) x)
#define zext_i64_i32(x) ((int32_t) (uint64_t) x)
#define zext_i64_i64(x) ((int64_t) (uint64_t) x)
#if defined(__OPENCL_VERSION__)
static int32_t futrts_popc8(int8_t x)
{
    return popcount(x);
}
static int32_t futrts_popc16(int16_t x)
{
    return popcount(x);
}
static int32_t futrts_popc32(int32_t x)
{
    return popcount(x);
}
static int32_t futrts_popc64(int64_t x)
{
    return popcount(x);
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_popc8(int8_t x)
{
    return __popc(zext_i8_i32(x));
}
static int32_t futrts_popc16(int16_t x)
{
    return __popc(zext_i16_i32(x));
}
static int32_t futrts_popc32(int32_t x)
{
    return __popc(x);
}
static int32_t futrts_popc64(int64_t x)
{
    return __popcll(x);
}
#else
static int32_t futrts_popc8(int8_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc16(int16_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc32(int32_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc64(int64_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
#endif
#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    return mul_hi(a, b);
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    return mul_hi(a, b);
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    return mul_hi(a, b);
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    return mul_hi(a, b);
}
#elif defined(__CUDA_ARCH__)
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    uint16_t aa = a;
    uint16_t bb = b;
    
    return aa * bb >> 8;
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    uint32_t aa = a;
    uint32_t bb = b;
    
    return aa * bb >> 16;
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    return mulhi(a, b);
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    return mul64hi(a, b);
}
#else
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    uint16_t aa = a;
    uint16_t bb = b;
    
    return aa * bb >> 8;
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    uint32_t aa = a;
    uint32_t bb = b;
    
    return aa * bb >> 16;
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    uint64_t aa = a;
    uint64_t bb = b;
    
    return aa * bb >> 32;
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    __uint128_t aa = a;
    __uint128_t bb = b;
    
    return aa * bb >> 64;
}
#endif
#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)
{
    return mad_hi(a, b, c);
}
static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)
{
    return mad_hi(a, b, c);
}
static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)
{
    return mad_hi(a, b, c);
}
static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)
{
    return mad_hi(a, b, c);
}
#else
static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)
{
    return futrts_mul_hi8(a, b) + c;
}
static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)
{
    return futrts_mul_hi16(a, b) + c;
}
static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)
{
    return futrts_mul_hi32(a, b) + c;
}
static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)
{
    return futrts_mul_hi64(a, b) + c;
}
#endif
#if defined(__OPENCL_VERSION__)
static int32_t futrts_clzz8(int8_t x)
{
    return clz(x);
}
static int32_t futrts_clzz16(int16_t x)
{
    return clz(x);
}
static int32_t futrts_clzz32(int32_t x)
{
    return clz(x);
}
static int32_t futrts_clzz64(int64_t x)
{
    return clz(x);
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_clzz8(int8_t x)
{
    return __clz(zext_i8_i32(x)) - 24;
}
static int32_t futrts_clzz16(int16_t x)
{
    return __clz(zext_i16_i32(x)) - 16;
}
static int32_t futrts_clzz32(int32_t x)
{
    return __clz(x);
}
static int32_t futrts_clzz64(int64_t x)
{
    return __clzll(x);
}
#else
static int32_t futrts_clzz8(int8_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz16(int16_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz32(int32_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz64(int64_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
#endif
#if defined(__OPENCL_VERSION__)
static int32_t futrts_ctzz8(int8_t x)
{
    int i = 0;
    
    for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz16(int16_t x)
{
    int i = 0;
    
    for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz32(int32_t x)
{
    int i = 0;
    
    for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz64(int64_t x)
{
    int i = 0;
    
    for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_ctzz8(int8_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 8 : y - 1;
}
static int32_t futrts_ctzz16(int16_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 16 : y - 1;
}
static int32_t futrts_ctzz32(int32_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 32 : y - 1;
}
static int32_t futrts_ctzz64(int64_t x)
{
    int y = __ffsll(x);
    
    return y == 0 ? 64 : y - 1;
}
#else
static int32_t futrts_ctzz8(int8_t x)
{
    return x == 0 ? 8 : __builtin_ctz((uint32_t) x);
}
static int32_t futrts_ctzz16(int16_t x)
{
    return x == 0 ? 16 : __builtin_ctz((uint32_t) x);
}
static int32_t futrts_ctzz32(int32_t x)
{
    return x == 0 ? 32 : __builtin_ctz(x);
}
static int32_t futrts_ctzz64(int64_t x)
{
    return x == 0 ? 64 : __builtin_ctzl(x);
}
#endif
static inline float fdiv32(float x, float y)
{
    return x / y;
}
static inline float fadd32(float x, float y)
{
    return x + y;
}
static inline float fsub32(float x, float y)
{
    return x - y;
}
static inline float fmul32(float x, float y)
{
    return x * y;
}
static inline float fmin32(float x, float y)
{
    return fmin(x, y);
}
static inline float fmax32(float x, float y)
{
    return fmax(x, y);
}
static inline float fpow32(float x, float y)
{
    return pow(x, y);
}
static inline bool cmplt32(float x, float y)
{
    return x < y;
}
static inline bool cmple32(float x, float y)
{
    return x <= y;
}
static inline float sitofp_i8_f32(int8_t x)
{
    return (float) x;
}
static inline float sitofp_i16_f32(int16_t x)
{
    return (float) x;
}
static inline float sitofp_i32_f32(int32_t x)
{
    return (float) x;
}
static inline float sitofp_i64_f32(int64_t x)
{
    return (float) x;
}
static inline float uitofp_i8_f32(uint8_t x)
{
    return (float) x;
}
static inline float uitofp_i16_f32(uint16_t x)
{
    return (float) x;
}
static inline float uitofp_i32_f32(uint32_t x)
{
    return (float) x;
}
static inline float uitofp_i64_f32(uint64_t x)
{
    return (float) x;
}
static inline int8_t fptosi_f32_i8(float x)
{
    return (int8_t) x;
}
static inline int16_t fptosi_f32_i16(float x)
{
    return (int16_t) x;
}
static inline int32_t fptosi_f32_i32(float x)
{
    return (int32_t) x;
}
static inline int64_t fptosi_f32_i64(float x)
{
    return (int64_t) x;
}
static inline uint8_t fptoui_f32_i8(float x)
{
    return (uint8_t) x;
}
static inline uint16_t fptoui_f32_i16(float x)
{
    return (uint16_t) x;
}
static inline uint32_t fptoui_f32_i32(float x)
{
    return (uint32_t) x;
}
static inline uint64_t fptoui_f32_i64(float x)
{
    return (uint64_t) x;
}
static inline double fdiv64(double x, double y)
{
    return x / y;
}
static inline double fadd64(double x, double y)
{
    return x + y;
}
static inline double fsub64(double x, double y)
{
    return x - y;
}
static inline double fmul64(double x, double y)
{
    return x * y;
}
static inline double fmin64(double x, double y)
{
    return fmin(x, y);
}
static inline double fmax64(double x, double y)
{
    return fmax(x, y);
}
static inline double fpow64(double x, double y)
{
    return pow(x, y);
}
static inline bool cmplt64(double x, double y)
{
    return x < y;
}
static inline bool cmple64(double x, double y)
{
    return x <= y;
}
static inline double sitofp_i8_f64(int8_t x)
{
    return (double) x;
}
static inline double sitofp_i16_f64(int16_t x)
{
    return (double) x;
}
static inline double sitofp_i32_f64(int32_t x)
{
    return (double) x;
}
static inline double sitofp_i64_f64(int64_t x)
{
    return (double) x;
}
static inline double uitofp_i8_f64(uint8_t x)
{
    return (double) x;
}
static inline double uitofp_i16_f64(uint16_t x)
{
    return (double) x;
}
static inline double uitofp_i32_f64(uint32_t x)
{
    return (double) x;
}
static inline double uitofp_i64_f64(uint64_t x)
{
    return (double) x;
}
static inline int8_t fptosi_f64_i8(double x)
{
    return (int8_t) x;
}
static inline int16_t fptosi_f64_i16(double x)
{
    return (int16_t) x;
}
static inline int32_t fptosi_f64_i32(double x)
{
    return (int32_t) x;
}
static inline int64_t fptosi_f64_i64(double x)
{
    return (int64_t) x;
}
static inline uint8_t fptoui_f64_i8(double x)
{
    return (uint8_t) x;
}
static inline uint16_t fptoui_f64_i16(double x)
{
    return (uint16_t) x;
}
static inline uint32_t fptoui_f64_i32(double x)
{
    return (uint32_t) x;
}
static inline uint64_t fptoui_f64_i64(double x)
{
    return (uint64_t) x;
}
static inline float fpconv_f32_f32(float x)
{
    return (float) x;
}
static inline double fpconv_f32_f64(float x)
{
    return (double) x;
}
static inline float fpconv_f64_f32(double x)
{
    return (float) x;
}
static inline double fpconv_f64_f64(double x)
{
    return (double) x;
}
static inline float futrts_log32(float x)
{
    return log(x);
}
static inline float futrts_log2_32(float x)
{
    return log2(x);
}
static inline float futrts_log10_32(float x)
{
    return log10(x);
}
static inline float futrts_sqrt32(float x)
{
    return sqrt(x);
}
static inline float futrts_exp32(float x)
{
    return exp(x);
}
static inline float futrts_cos32(float x)
{
    return cos(x);
}
static inline float futrts_sin32(float x)
{
    return sin(x);
}
static inline float futrts_tan32(float x)
{
    return tan(x);
}
static inline float futrts_acos32(float x)
{
    return acos(x);
}
static inline float futrts_asin32(float x)
{
    return asin(x);
}
static inline float futrts_atan32(float x)
{
    return atan(x);
}
static inline float futrts_cosh32(float x)
{
    return cosh(x);
}
static inline float futrts_sinh32(float x)
{
    return sinh(x);
}
static inline float futrts_tanh32(float x)
{
    return tanh(x);
}
static inline float futrts_acosh32(float x)
{
    return acosh(x);
}
static inline float futrts_asinh32(float x)
{
    return asinh(x);
}
static inline float futrts_atanh32(float x)
{
    return atanh(x);
}
static inline float futrts_atan2_32(float x, float y)
{
    return atan2(x, y);
}
static inline float futrts_gamma32(float x)
{
    return tgamma(x);
}
static inline float futrts_lgamma32(float x)
{
    return lgamma(x);
}
static inline bool futrts_isnan32(float x)
{
    return isnan(x);
}
static inline bool futrts_isinf32(float x)
{
    return isinf(x);
}
static inline int32_t futrts_to_bits32(float x)
{
    union {
        float f;
        int32_t t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline float futrts_from_bits32(int32_t x)
{
    union {
        int32_t f;
        float t;
    } p;
    
    p.f = x;
    return p.t;
}
#ifdef __OPENCL_VERSION__
static inline float fmod32(float x, float y)
{
    return fmod(x, y);
}
static inline float futrts_round32(float x)
{
    return rint(x);
}
static inline float futrts_floor32(float x)
{
    return floor(x);
}
static inline float futrts_ceil32(float x)
{
    return ceil(x);
}
static inline float futrts_lerp32(float v0, float v1, float t)
{
    return mix(v0, v1, t);
}
static inline float futrts_mad32(float a, float b, float c)
{
    return mad(a, b, c);
}
static inline float futrts_fma32(float a, float b, float c)
{
    return fma(a, b, c);
}
#else
static inline float fmod32(float x, float y)
{
    return fmodf(x, y);
}
static inline float futrts_round32(float x)
{
    return rintf(x);
}
static inline float futrts_floor32(float x)
{
    return floorf(x);
}
static inline float futrts_ceil32(float x)
{
    return ceilf(x);
}
static inline float futrts_lerp32(float v0, float v1, float t)
{
    return v0 + (v1 - v0) * t;
}
static inline float futrts_mad32(float a, float b, float c)
{
    return a * b + c;
}
static inline float futrts_fma32(float a, float b, float c)
{
    return fmaf(a, b, c);
}
#endif
static inline double futrts_log64(double x)
{
    return log(x);
}
static inline double futrts_log2_64(double x)
{
    return log2(x);
}
static inline double futrts_log10_64(double x)
{
    return log10(x);
}
static inline double futrts_sqrt64(double x)
{
    return sqrt(x);
}
static inline double futrts_exp64(double x)
{
    return exp(x);
}
static inline double futrts_cos64(double x)
{
    return cos(x);
}
static inline double futrts_sin64(double x)
{
    return sin(x);
}
static inline double futrts_tan64(double x)
{
    return tan(x);
}
static inline double futrts_acos64(double x)
{
    return acos(x);
}
static inline double futrts_asin64(double x)
{
    return asin(x);
}
static inline double futrts_atan64(double x)
{
    return atan(x);
}
static inline double futrts_cosh64(double x)
{
    return cosh(x);
}
static inline double futrts_sinh64(double x)
{
    return sinh(x);
}
static inline double futrts_tanh64(double x)
{
    return tanh(x);
}
static inline double futrts_acosh64(double x)
{
    return acosh(x);
}
static inline double futrts_asinh64(double x)
{
    return asinh(x);
}
static inline double futrts_atanh64(double x)
{
    return atanh(x);
}
static inline double futrts_atan2_64(double x, double y)
{
    return atan2(x, y);
}
static inline double futrts_gamma64(double x)
{
    return tgamma(x);
}
static inline double futrts_lgamma64(double x)
{
    return lgamma(x);
}
static inline double futrts_fma64(double a, double b, double c)
{
    return fma(a, b, c);
}
static inline double futrts_round64(double x)
{
    return rint(x);
}
static inline double futrts_ceil64(double x)
{
    return ceil(x);
}
static inline double futrts_floor64(double x)
{
    return floor(x);
}
static inline bool futrts_isnan64(double x)
{
    return isnan(x);
}
static inline bool futrts_isinf64(double x)
{
    return isinf(x);
}
static inline int64_t futrts_to_bits64(double x)
{
    union {
        double f;
        int64_t t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline double futrts_from_bits64(int64_t x)
{
    union {
        int64_t f;
        double t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline double fmod64(double x, double y)
{
    return fmod(x, y);
}
#ifdef __OPENCL_VERSION__
static inline double futrts_lerp64(double v0, double v1, double t)
{
    return mix(v0, v1, t);
}
static inline double futrts_mad64(double a, double b, double c)
{
    return mad(a, b, c);
}
#else
static inline double futrts_lerp64(double v0, double v1, double t)
{
    return v0 + (v1 - v0) * t;
}
static inline double futrts_mad64(double a, double b, double c)
{
    return a * b + c;
}
#endif
int init_constants(struct futhark_context *);
int free_constants(struct futhark_context *);
static int32_t mainzicounter_mem_realtype_27552[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_27584[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_27606[10240];
static int32_t mainzicounter_mem_realtype_27617[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static float testzistatic_array_realtype_27625[4] = {1.0F, -0.5F, 1.0F, 1.0F};
static int64_t testzistatic_array_realtype_27626[4] = {10, 20, 5, 5};
static float testzistatic_array_realtype_27627[4] = {1.0F, 0.5F, 0.25F, 0.1F};
static int32_t testzicounter_mem_realtype_27628[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_27660[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_27682[10240];
static int32_t testzicounter_mem_realtype_27693[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t test2zicounter_mem_realtype_27701[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                        0, 0};
static int32_t test2zicounter_mem_realtype_27733[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                        0, 0};
static int32_t test2zicounter_mem_realtype_27755[10240];
static int32_t test2zicounter_mem_realtype_27766[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                        0, 0};
struct memblock_device {
    int *references;
    cl_mem mem;
    int64_t size;
    const char *desc;
} ;
struct memblock {
    int *references;
    char *mem;
    int64_t size;
    const char *desc;
} ;
typedef cl_mem fl_mem_t;
// Start of free_list.h.

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem_t mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries;        // Pointer to entries.
  int capacity;                           // Number of entries.
  int used;                               // Number of valid entries.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
}

static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem_t mem, const char *tag) {
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size,
                          size_t *size_out, fl_mem_t *mem_out) {
  int size_match = -1;
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid &&
        size <= l->entries[i].size &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    return 0;
  } else {
    return 1;
  }
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem_t *mem_out) {
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      return 0;
    }
  }

  return 1;
}

// End of free_list.h.

// Start of opencl.h.

#define OPENCL_SUCCEED_FATAL(e) opencl_succeed_fatal(e, #e, __FILE__, __LINE__)
#define OPENCL_SUCCEED_NONFATAL(e) opencl_succeed_nonfatal(e, #e, __FILE__, __LINE__)
// Take care not to override an existing error.
#define OPENCL_SUCCEED_OR_RETURN(e) {             \
    char *serror = OPENCL_SUCCEED_NONFATAL(e);    \
    if (serror) {                                 \
      if (!ctx->error) {                          \
        ctx->error = serror;                      \
        return bad;                               \
      } else {                                    \
        free(serror);                             \
      }                                           \
    }                                             \
  }

// OPENCL_SUCCEED_OR_RETURN returns the value of the variable 'bad' in
// scope.  By default, it will be this one.  Create a local variable
// of some other type if needed.  This is a bit of a hack, but it
// saves effort in the code generator.
static const int bad = 1;

struct opencl_config {
  int debugging;
  int profiling;
  int logging;
  int preferred_device_num;
  const char *preferred_platform;
  const char *preferred_device;
  int ignore_blacklist;

  const char* dump_program_to;
  const char* load_program_from;
  const char* dump_binary_to;
  const char* load_binary_from;

  size_t default_group_size;
  size_t default_num_groups;
  size_t default_tile_size;
  size_t default_threshold;

  int default_group_size_changed;
  int default_tile_size_changed;

  int num_sizes;
  const char **size_names;
  const char **size_vars;
  size_t *size_values;
  const char **size_classes;
};

static void opencl_config_init(struct opencl_config *cfg,
                               int num_sizes,
                               const char *size_names[],
                               const char *size_vars[],
                               size_t *size_values,
                               const char *size_classes[]) {
  cfg->debugging = 0;
  cfg->logging = 0;
  cfg->profiling = 0;
  cfg->preferred_device_num = 0;
  cfg->preferred_platform = "";
  cfg->preferred_device = "";
  cfg->ignore_blacklist = 0;
  cfg->dump_program_to = NULL;
  cfg->load_program_from = NULL;
  cfg->dump_binary_to = NULL;
  cfg->load_binary_from = NULL;

  // The following are dummy sizes that mean the concrete defaults
  // will be set during initialisation via hardware-inspection-based
  // heuristics.
  cfg->default_group_size = 0;
  cfg->default_num_groups = 0;
  cfg->default_tile_size = 0;
  cfg->default_threshold = 0;

  cfg->default_group_size_changed = 0;
  cfg->default_tile_size_changed = 0;

  cfg->num_sizes = num_sizes;
  cfg->size_names = size_names;
  cfg->size_vars = size_vars;
  cfg->size_values = size_values;
  cfg->size_classes = size_classes;
}

// A record of something that happened.
struct profiling_record {
  cl_event *event;
  int *runs;
  int64_t *runtime;
};

struct opencl_context {
  cl_device_id device;
  cl_context ctx;
  cl_command_queue queue;

  struct opencl_config cfg;

  struct free_list free_list;

  size_t max_group_size;
  size_t max_num_groups;
  size_t max_tile_size;
  size_t max_threshold;
  size_t max_local_memory;

  size_t lockstep_width;

  struct profiling_record *profiling_records;
  int profiling_records_capacity;
  int profiling_records_used;
};

struct opencl_device_option {
  cl_platform_id platform;
  cl_device_id device;
  cl_device_type device_type;
  char *platform_name;
  char *device_name;
};

// This function must be defined by the user.  It is invoked by
// setup_opencl() after the platform and device has been found, but
// before the program is loaded.  Its intended use is to tune
// constants based on the selected platform and device.
static void post_opencl_setup(struct opencl_context*, struct opencl_device_option*);

static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

static const char* opencl_error_string(cl_int err)
{
    switch (err) {
        case CL_SUCCESS:                            return "Success!";
        case CL_DEVICE_NOT_FOUND:                   return "Device not found.";
        case CL_DEVICE_NOT_AVAILABLE:               return "Device not available";
        case CL_COMPILER_NOT_AVAILABLE:             return "Compiler not available";
        case CL_MEM_OBJECT_ALLOCATION_FAILURE:      return "Memory object allocation failure";
        case CL_OUT_OF_RESOURCES:                   return "Out of resources";
        case CL_OUT_OF_HOST_MEMORY:                 return "Out of host memory";
        case CL_PROFILING_INFO_NOT_AVAILABLE:       return "Profiling information not available";
        case CL_MEM_COPY_OVERLAP:                   return "Memory copy overlap";
        case CL_IMAGE_FORMAT_MISMATCH:              return "Image format mismatch";
        case CL_IMAGE_FORMAT_NOT_SUPPORTED:         return "Image format not supported";
        case CL_BUILD_PROGRAM_FAILURE:              return "Program build failure";
        case CL_MAP_FAILURE:                        return "Map failure";
        case CL_INVALID_VALUE:                      return "Invalid value";
        case CL_INVALID_DEVICE_TYPE:                return "Invalid device type";
        case CL_INVALID_PLATFORM:                   return "Invalid platform";
        case CL_INVALID_DEVICE:                     return "Invalid device";
        case CL_INVALID_CONTEXT:                    return "Invalid context";
        case CL_INVALID_QUEUE_PROPERTIES:           return "Invalid queue properties";
        case CL_INVALID_COMMAND_QUEUE:              return "Invalid command queue";
        case CL_INVALID_HOST_PTR:                   return "Invalid host pointer";
        case CL_INVALID_MEM_OBJECT:                 return "Invalid memory object";
        case CL_INVALID_IMAGE_FORMAT_DESCRIPTOR:    return "Invalid image format descriptor";
        case CL_INVALID_IMAGE_SIZE:                 return "Invalid image size";
        case CL_INVALID_SAMPLER:                    return "Invalid sampler";
        case CL_INVALID_BINARY:                     return "Invalid binary";
        case CL_INVALID_BUILD_OPTIONS:              return "Invalid build options";
        case CL_INVALID_PROGRAM:                    return "Invalid program";
        case CL_INVALID_PROGRAM_EXECUTABLE:         return "Invalid program executable";
        case CL_INVALID_KERNEL_NAME:                return "Invalid kernel name";
        case CL_INVALID_KERNEL_DEFINITION:          return "Invalid kernel definition";
        case CL_INVALID_KERNEL:                     return "Invalid kernel";
        case CL_INVALID_ARG_INDEX:                  return "Invalid argument index";
        case CL_INVALID_ARG_VALUE:                  return "Invalid argument value";
        case CL_INVALID_ARG_SIZE:                   return "Invalid argument size";
        case CL_INVALID_KERNEL_ARGS:                return "Invalid kernel arguments";
        case CL_INVALID_WORK_DIMENSION:             return "Invalid work dimension";
        case CL_INVALID_WORK_GROUP_SIZE:            return "Invalid work group size";
        case CL_INVALID_WORK_ITEM_SIZE:             return "Invalid work item size";
        case CL_INVALID_GLOBAL_OFFSET:              return "Invalid global offset";
        case CL_INVALID_EVENT_WAIT_LIST:            return "Invalid event wait list";
        case CL_INVALID_EVENT:                      return "Invalid event";
        case CL_INVALID_OPERATION:                  return "Invalid operation";
        case CL_INVALID_GL_OBJECT:                  return "Invalid OpenGL object";
        case CL_INVALID_BUFFER_SIZE:                return "Invalid buffer size";
        case CL_INVALID_MIP_LEVEL:                  return "Invalid mip-map level";
        default:                                    return "Unknown";
    }
}

static void opencl_succeed_fatal(unsigned int ret,
                                 const char *call,
                                 const char *file,
                                 int line) {
  if (ret != CL_SUCCESS) {
    futhark_panic(-1, "%s:%d: OpenCL call\n  %s\nfailed with error code %d (%s)\n",
          file, line, call, ret, opencl_error_string(ret));
  }
}

static char* opencl_succeed_nonfatal(unsigned int ret,
                                     const char *call,
                                     const char *file,
                                     int line) {
  if (ret != CL_SUCCESS) {
    return msgprintf("%s:%d: OpenCL call\n  %s\nfailed with error code %d (%s)\n",
                     file, line, call, ret, opencl_error_string(ret));
  } else {
    return NULL;
  }
}

static void set_preferred_platform(struct opencl_config *cfg, const char *s) {
  cfg->preferred_platform = s;
  cfg->ignore_blacklist = 1;
}

static void set_preferred_device(struct opencl_config *cfg, const char *s) {
  int x = 0;
  if (*s == '#') {
    s++;
    while (isdigit(*s)) {
      x = x * 10 + (*s++)-'0';
    }
    // Skip trailing spaces.
    while (isspace(*s)) {
      s++;
    }
  }
  cfg->preferred_device = s;
  cfg->preferred_device_num = x;
  cfg->ignore_blacklist = 1;
}

static char* opencl_platform_info(cl_platform_id platform,
                                  cl_platform_info param) {
  size_t req_bytes;
  char *info;

  OPENCL_SUCCEED_FATAL(clGetPlatformInfo(platform, param, 0, NULL, &req_bytes));

  info = (char*) malloc(req_bytes);

  OPENCL_SUCCEED_FATAL(clGetPlatformInfo(platform, param, req_bytes, info, NULL));

  return info;
}

static char* opencl_device_info(cl_device_id device,
                                cl_device_info param) {
  size_t req_bytes;
  char *info;

  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device, param, 0, NULL, &req_bytes));

  info = (char*) malloc(req_bytes);

  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device, param, req_bytes, info, NULL));

  return info;
}

static void opencl_all_device_options(struct opencl_device_option **devices_out,
                                      size_t *num_devices_out) {
  size_t num_devices = 0, num_devices_added = 0;

  cl_platform_id *all_platforms;
  cl_uint *platform_num_devices;

  cl_uint num_platforms;

  // Find the number of platforms.
  OPENCL_SUCCEED_FATAL(clGetPlatformIDs(0, NULL, &num_platforms));

  // Make room for them.
  all_platforms = calloc(num_platforms, sizeof(cl_platform_id));
  platform_num_devices = calloc(num_platforms, sizeof(cl_uint));

  // Fetch all the platforms.
  OPENCL_SUCCEED_FATAL(clGetPlatformIDs(num_platforms, all_platforms, NULL));

  // Count the number of devices for each platform, as well as the
  // total number of devices.
  for (cl_uint i = 0; i < num_platforms; i++) {
    if (clGetDeviceIDs(all_platforms[i], CL_DEVICE_TYPE_ALL,
                       0, NULL, &platform_num_devices[i]) == CL_SUCCESS) {
      num_devices += platform_num_devices[i];
    } else {
      platform_num_devices[i] = 0;
    }
  }

  // Make room for all the device options.
  struct opencl_device_option *devices =
    calloc(num_devices, sizeof(struct opencl_device_option));

  // Loop through the platforms, getting information about their devices.
  for (cl_uint i = 0; i < num_platforms; i++) {
    cl_platform_id platform = all_platforms[i];
    cl_uint num_platform_devices = platform_num_devices[i];

    if (num_platform_devices == 0) {
      continue;
    }

    char *platform_name = opencl_platform_info(platform, CL_PLATFORM_NAME);
    cl_device_id *platform_devices =
      calloc(num_platform_devices, sizeof(cl_device_id));

    // Fetch all the devices.
    OPENCL_SUCCEED_FATAL(clGetDeviceIDs(platform, CL_DEVICE_TYPE_ALL,
                                  num_platform_devices, platform_devices, NULL));

    // Loop through the devices, adding them to the devices array.
    for (cl_uint i = 0; i < num_platform_devices; i++) {
      char *device_name = opencl_device_info(platform_devices[i], CL_DEVICE_NAME);
      devices[num_devices_added].platform = platform;
      devices[num_devices_added].device = platform_devices[i];
      OPENCL_SUCCEED_FATAL(clGetDeviceInfo(platform_devices[i], CL_DEVICE_TYPE,
                                     sizeof(cl_device_type),
                                     &devices[num_devices_added].device_type,
                                     NULL));
      // We don't want the structs to share memory, so copy the platform name.
      // Each device name is already unique.
      devices[num_devices_added].platform_name = strclone(platform_name);
      devices[num_devices_added].device_name = device_name;
      num_devices_added++;
    }
    free(platform_devices);
    free(platform_name);
  }
  free(all_platforms);
  free(platform_num_devices);

  *devices_out = devices;
  *num_devices_out = num_devices;
}

// Returns 0 on success.
static int list_devices(struct opencl_config *cfg) {
  struct opencl_device_option *devices;
  size_t num_devices;

  opencl_all_device_options(&devices, &num_devices);

  const char *cur_platform = "";
  for (size_t i = 0; i < num_devices; i++) {
    struct opencl_device_option device = devices[i];
    if (strcmp(cur_platform, device.platform_name) != 0) {
      printf("Platform: %s\n", device.platform_name);
      cur_platform = device.platform_name;
    }
    printf("[%d]: %s\n", (int)i, device.device_name);
  }

  // Free all the platform and device names.
  for (size_t j = 0; j < num_devices; j++) {
    free(devices[j].platform_name);
    free(devices[j].device_name);
  }
  free(devices);

  return 0;
}

// Returns 0 on success.
static int select_device_interactively(struct opencl_config *cfg) {
  struct opencl_device_option *devices;
  size_t num_devices;
  int ret = 1;

  opencl_all_device_options(&devices, &num_devices);

  printf("Choose OpenCL device:\n");
  const char *cur_platform = "";
  for (size_t i = 0; i < num_devices; i++) {
    struct opencl_device_option device = devices[i];
    if (strcmp(cur_platform, device.platform_name) != 0) {
      printf("Platform: %s\n", device.platform_name);
      cur_platform = device.platform_name;
    }
    printf("[%d] %s\n", (int)i, device.device_name);
  }

  int selection;
  printf("Choice: ");
  if (scanf("%d", &selection) == 1) {
    ret = 0;
    cfg->preferred_platform = "";
    cfg->preferred_device = "";
    cfg->preferred_device_num = selection;
    cfg->ignore_blacklist = 1;
  }

  // Free all the platform and device names.
  for (size_t j = 0; j < num_devices; j++) {
    free(devices[j].platform_name);
    free(devices[j].device_name);
  }
  free(devices);

  return ret;
}

static int is_blacklisted(const char *platform_name, const char *device_name,
                          const struct opencl_config *cfg) {
  if (strcmp(cfg->preferred_platform, "") != 0 ||
      strcmp(cfg->preferred_device, "") != 0) {
    return 0;
  } else if (strstr(platform_name, "Apple") != NULL &&
             strstr(device_name, "Intel(R) Core(TM)") != NULL) {
    return 1;
  } else {
    return 0;
  }
}

static struct opencl_device_option get_preferred_device(const struct opencl_config *cfg) {
  struct opencl_device_option *devices;
  size_t num_devices;

  opencl_all_device_options(&devices, &num_devices);

  int num_device_matches = 0;

  for (size_t i = 0; i < num_devices; i++) {
    struct opencl_device_option device = devices[i];
    if (strstr(device.platform_name, cfg->preferred_platform) != NULL &&
        strstr(device.device_name, cfg->preferred_device) != NULL &&
        (cfg->ignore_blacklist ||
         !is_blacklisted(device.platform_name, device.device_name, cfg)) &&
        num_device_matches++ == cfg->preferred_device_num) {
      // Free all the platform and device names, except the ones we have chosen.
      for (size_t j = 0; j < num_devices; j++) {
        if (j != i) {
          free(devices[j].platform_name);
          free(devices[j].device_name);
        }
      }
      free(devices);
      return device;
    }
  }

  futhark_panic(1, "Could not find acceptable OpenCL device.\n");
  exit(1); // Never reached
}

static void describe_device_option(struct opencl_device_option device) {
  fprintf(stderr, "Using platform: %s\n", device.platform_name);
  fprintf(stderr, "Using device: %s\n", device.device_name);
}

static cl_build_status build_opencl_program(cl_program program, cl_device_id device, const char* options) {
  cl_int clBuildProgram_error = clBuildProgram(program, 1, &device, options, NULL, NULL);

  // Avoid termination due to CL_BUILD_PROGRAM_FAILURE
  if (clBuildProgram_error != CL_SUCCESS &&
      clBuildProgram_error != CL_BUILD_PROGRAM_FAILURE) {
    OPENCL_SUCCEED_FATAL(clBuildProgram_error);
  }

  cl_build_status build_status;
  OPENCL_SUCCEED_FATAL(clGetProgramBuildInfo(program,
                                             device,
                                             CL_PROGRAM_BUILD_STATUS,
                                             sizeof(cl_build_status),
                                             &build_status,
                                             NULL));

  if (build_status != CL_SUCCESS) {
    char *build_log;
    size_t ret_val_size;
    OPENCL_SUCCEED_FATAL(clGetProgramBuildInfo(program, device, CL_PROGRAM_BUILD_LOG, 0, NULL, &ret_val_size));

    build_log = (char*) malloc(ret_val_size+1);
    OPENCL_SUCCEED_FATAL(clGetProgramBuildInfo(program, device, CL_PROGRAM_BUILD_LOG, ret_val_size, build_log, NULL));

    // The spec technically does not say whether the build log is zero-terminated, so let's be careful.
    build_log[ret_val_size] = '\0';

    fprintf(stderr, "Build log:\n%s\n", build_log);

    free(build_log);
  }

  return build_status;
}

// Fields in a bitmask indicating which types we must be sure are
// available.
enum opencl_required_type { OPENCL_F64 = 1 };

// We take as input several strings representing the program, because
// C does not guarantee that the compiler supports particularly large
// literals.  Notably, Visual C has a limit of 2048 characters.  The
// array must be NULL-terminated.
static cl_program setup_opencl_with_command_queue(struct opencl_context *ctx,
                                                  cl_command_queue queue,
                                                  const char *srcs[],
                                                  int required_types,
                                                  const char *extra_build_opts[]) {
  int error;

  free_list_init(&ctx->free_list);
  ctx->queue = queue;

  OPENCL_SUCCEED_FATAL(clGetCommandQueueInfo(ctx->queue, CL_QUEUE_CONTEXT, sizeof(cl_context), &ctx->ctx, NULL));

  // Fill out the device info.  This is redundant work if we are
  // called from setup_opencl() (which is the common case), but I
  // doubt it matters much.
  struct opencl_device_option device_option;
  OPENCL_SUCCEED_FATAL(clGetCommandQueueInfo(ctx->queue, CL_QUEUE_DEVICE,
                                       sizeof(cl_device_id),
                                       &device_option.device,
                                       NULL));
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_PLATFORM,
                                 sizeof(cl_platform_id),
                                 &device_option.platform,
                                 NULL));
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_TYPE,
                                 sizeof(cl_device_type),
                                 &device_option.device_type,
                                 NULL));
  device_option.platform_name = opencl_platform_info(device_option.platform, CL_PLATFORM_NAME);
  device_option.device_name = opencl_device_info(device_option.device, CL_DEVICE_NAME);

  ctx->device = device_option.device;

  if (required_types & OPENCL_F64) {
    cl_uint supported;
    OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_PREFERRED_VECTOR_WIDTH_DOUBLE,
                                   sizeof(cl_uint), &supported, NULL));
    if (!supported) {
      futhark_panic(1, "Program uses double-precision floats, but this is not supported on the chosen device: %s\n",
            device_option.device_name);
    }
  }

  size_t max_group_size;
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_MAX_WORK_GROUP_SIZE,
                                 sizeof(size_t), &max_group_size, NULL));

  size_t max_tile_size = sqrt(max_group_size);

  cl_ulong max_local_memory;
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_LOCAL_MEM_SIZE,
                                       sizeof(size_t), &max_local_memory, NULL));

  // Futhark reserves 4 bytes for bookkeeping information.
  max_local_memory -= 4;

  // The OpenCL implementation may reserve some local memory bytes for
  // various purposes.  In principle, we should use
  // clGetKernelWorkGroupInfo() to figure out for each kernel how much
  // is actually available, but our current code generator design
  // makes this infeasible.  Instead, we have this nasty hack where we
  // arbitrarily subtract some bytes, based on empirical measurements
  // (but which might be arbitrarily wrong).  Fortunately, we rarely
  // try to really push the local memory usage.
  if (strstr(device_option.platform_name, "NVIDIA CUDA") != NULL) {
    max_local_memory -= 12;
  } else if (strstr(device_option.platform_name, "AMD") != NULL) {
    max_local_memory -= 16;
  }

  // Make sure this function is defined.
  post_opencl_setup(ctx, &device_option);

  if (max_group_size < ctx->cfg.default_group_size) {
    if (ctx->cfg.default_group_size_changed) {
      fprintf(stderr, "Note: Device limits default group size to %zu (down from %zu).\n",
              max_group_size, ctx->cfg.default_group_size);
    }
    ctx->cfg.default_group_size = max_group_size;
  }

  if (max_tile_size < ctx->cfg.default_tile_size) {
    if (ctx->cfg.default_tile_size_changed) {
      fprintf(stderr, "Note: Device limits default tile size to %zu (down from %zu).\n",
              max_tile_size, ctx->cfg.default_tile_size);
    }
    ctx->cfg.default_tile_size = max_tile_size;
  }

  ctx->max_group_size = max_group_size;
  ctx->max_tile_size = max_tile_size; // No limit.
  ctx->max_threshold = ctx->max_num_groups = 0; // No limit.
  ctx->max_local_memory = max_local_memory;

  // Now we go through all the sizes, clamp them to the valid range,
  // or set them to the default.
  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    const char *size_class = ctx->cfg.size_classes[i];
    size_t *size_value = &ctx->cfg.size_values[i];
    const char* size_name = ctx->cfg.size_names[i];
    size_t max_value = 0, default_value = 0;
    if (strstr(size_class, "group_size") == size_class) {
      max_value = max_group_size;
      default_value = ctx->cfg.default_group_size;
    } else if (strstr(size_class, "num_groups") == size_class) {
      max_value = max_group_size; // Futhark assumes this constraint.
      default_value = ctx->cfg.default_num_groups;
      // XXX: as a quick and dirty hack, use twice as many threads for
      // histograms by default.  We really should just be smarter
      // about sizes somehow.
      if (strstr(size_name, ".seghist_") != NULL) {
        default_value *= 2;
      }
    } else if (strstr(size_class, "tile_size") == size_class) {
      max_value = sqrt(max_group_size);
      default_value = ctx->cfg.default_tile_size;
    } else if (strstr(size_class, "threshold") == size_class) {
      // Threshold can be as large as it takes.
      default_value = ctx->cfg.default_threshold;
    } else {
      // Bespoke sizes have no limit or default.
    }
    if (*size_value == 0) {
      *size_value = default_value;
    } else if (max_value > 0 && *size_value > max_value) {
      fprintf(stderr, "Note: Device limits %s to %d (down from %d)\n",
              size_name, (int)max_value, (int)*size_value);
      *size_value = max_value;
    }
  }

  if (ctx->lockstep_width == 0) {
    ctx->lockstep_width = 1;
  }

  if (ctx->cfg.logging) {
    fprintf(stderr, "Lockstep width: %d\n", (int)ctx->lockstep_width);
    fprintf(stderr, "Default group size: %d\n", (int)ctx->cfg.default_group_size);
    fprintf(stderr, "Default number of groups: %d\n", (int)ctx->cfg.default_num_groups);
  }

  char *fut_opencl_src = NULL;
  cl_program prog;
  error = CL_SUCCESS;

  if (ctx->cfg.load_binary_from == NULL) {
    size_t src_size = 0;

    // Maybe we have to read OpenCL source from somewhere else (used for debugging).
    if (ctx->cfg.load_program_from != NULL) {
      fut_opencl_src = slurp_file(ctx->cfg.load_program_from, NULL);
      assert(fut_opencl_src != NULL);
    } else {
      // Construct the OpenCL source concatenating all the fragments.
      for (const char **src = srcs; src && *src; src++) {
        src_size += strlen(*src);
      }

      fut_opencl_src = (char*) malloc(src_size + 1);

      size_t n, i;
      for (i = 0, n = 0; srcs && srcs[i]; i++) {
        strncpy(fut_opencl_src+n, srcs[i], src_size-n);
        n += strlen(srcs[i]);
      }
      fut_opencl_src[src_size] = 0;
    }

    if (ctx->cfg.dump_program_to != NULL) {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "Dumping OpenCL source to %s...\n", ctx->cfg.dump_program_to);
      }

      dump_file(ctx->cfg.dump_program_to, fut_opencl_src, strlen(fut_opencl_src));
    }

    if (ctx->cfg.debugging) {
      fprintf(stderr, "Creating OpenCL program...\n");
    }

    const char* src_ptr[] = {fut_opencl_src};
    prog = clCreateProgramWithSource(ctx->ctx, 1, src_ptr, &src_size, &error);
    OPENCL_SUCCEED_FATAL(error);
  } else {
    if (ctx->cfg.debugging) {
      fprintf(stderr, "Loading OpenCL binary from %s...\n", ctx->cfg.load_binary_from);
    }
    size_t binary_size;
    unsigned char *fut_opencl_bin =
      (unsigned char*) slurp_file(ctx->cfg.load_binary_from, &binary_size);
    assert(fut_opencl_bin != NULL);
    const unsigned char *binaries[1] = { fut_opencl_bin };
    cl_int status = 0;

    prog = clCreateProgramWithBinary(ctx->ctx, 1, &device_option.device,
                                     &binary_size, binaries,
                                     &status, &error);

    OPENCL_SUCCEED_FATAL(status);
    OPENCL_SUCCEED_FATAL(error);
  }

  int compile_opts_size = 1024;

  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    compile_opts_size += strlen(ctx->cfg.size_names[i]) + 20;
  }

  for (int i = 0; extra_build_opts[i] != NULL; i++) {
    compile_opts_size += strlen(extra_build_opts[i] + 1);
  }

  char *compile_opts = (char*) malloc(compile_opts_size);

  int w = snprintf(compile_opts, compile_opts_size,
                   "-DLOCKSTEP_WIDTH=%d ",
                   (int)ctx->lockstep_width);

  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    w += snprintf(compile_opts+w, compile_opts_size-w,
                  "-D%s=%d ",
                  ctx->cfg.size_vars[i],
                  (int)ctx->cfg.size_values[i]);
  }

  for (int i = 0; extra_build_opts[i] != NULL; i++) {
    w += snprintf(compile_opts+w, compile_opts_size-w,
                  "%s ", extra_build_opts[i]);
  }

  if (ctx->cfg.debugging) {
    fprintf(stderr, "OpenCL compiler options: %s\n", compile_opts);
    fprintf(stderr, "Building OpenCL program...\n");
  }
  OPENCL_SUCCEED_FATAL(build_opencl_program(prog, device_option.device, compile_opts));

  free(compile_opts);
  free(fut_opencl_src);

  if (ctx->cfg.dump_binary_to != NULL) {
    if (ctx->cfg.debugging) {
      fprintf(stderr, "Dumping OpenCL binary to %s...\n", ctx->cfg.dump_binary_to);
    }

    size_t binary_size;
    OPENCL_SUCCEED_FATAL(clGetProgramInfo(prog, CL_PROGRAM_BINARY_SIZES,
                                          sizeof(size_t), &binary_size, NULL));
    unsigned char *binary = (unsigned char*) malloc(binary_size);
    unsigned char *binaries[1] = { binary };
    OPENCL_SUCCEED_FATAL(clGetProgramInfo(prog, CL_PROGRAM_BINARIES,
                                          sizeof(unsigned char*), binaries, NULL));

    dump_file(ctx->cfg.dump_binary_to, binary, binary_size);
  }

  return prog;
}

static cl_program setup_opencl(struct opencl_context *ctx,
                               const char *srcs[],
                               int required_types,
                               const char *extra_build_opts[]) {

  ctx->lockstep_width = 0; // Real value set later.

  struct opencl_device_option device_option = get_preferred_device(&ctx->cfg);

  if (ctx->cfg.logging) {
    describe_device_option(device_option);
  }

  // Note that NVIDIA's OpenCL requires the platform property
  cl_context_properties properties[] = {
    CL_CONTEXT_PLATFORM,
    (cl_context_properties)device_option.platform,
    0
  };

  cl_int clCreateContext_error;
  ctx->ctx = clCreateContext(properties, 1, &device_option.device, NULL, NULL, &clCreateContext_error);
  OPENCL_SUCCEED_FATAL(clCreateContext_error);

  cl_int clCreateCommandQueue_error;
  cl_command_queue queue =
    clCreateCommandQueue(ctx->ctx,
                         device_option.device,
                         ctx->cfg.profiling ? CL_QUEUE_PROFILING_ENABLE : 0,
                         &clCreateCommandQueue_error);
  OPENCL_SUCCEED_FATAL(clCreateCommandQueue_error);

  return setup_opencl_with_command_queue(ctx, queue, srcs, required_types, extra_build_opts);
}

// Count up the runtime all the profiling_records that occured during execution.
// Also clears the buffer of profiling_records.
static cl_int opencl_tally_profiling_records(struct opencl_context *ctx) {
  cl_int err;
  for (int i = 0; i < ctx->profiling_records_used; i++) {
    struct profiling_record record = ctx->profiling_records[i];

    cl_ulong start_t, end_t;

    if ((err = clGetEventProfilingInfo(*record.event,
                                       CL_PROFILING_COMMAND_START,
                                       sizeof(start_t),
                                       &start_t,
                                       NULL)) != CL_SUCCESS) {
      return err;
    }

    if ((err = clGetEventProfilingInfo(*record.event,
                                       CL_PROFILING_COMMAND_END,
                                       sizeof(end_t),
                                       &end_t,
                                       NULL)) != CL_SUCCESS) {
      return err;
    }

    // OpenCL provides nanosecond resolution, but we want
    // microseconds.
    *record.runs += 1;
    *record.runtime += (end_t - start_t)/1000;

    if ((err = clReleaseEvent(*record.event)) != CL_SUCCESS) {
      return err;
    }
    free(record.event);
  }

  ctx->profiling_records_used = 0;

  return CL_SUCCESS;
}

// If profiling, produce an event associated with a profiling record.
static cl_event* opencl_get_event(struct opencl_context *ctx, int *runs, int64_t *runtime) {
    if (ctx->profiling_records_used == ctx->profiling_records_capacity) {
      ctx->profiling_records_capacity *= 2;
      ctx->profiling_records =
        realloc(ctx->profiling_records,
                ctx->profiling_records_capacity *
                sizeof(struct profiling_record));
    }
    cl_event *event = malloc(sizeof(cl_event));
    ctx->profiling_records[ctx->profiling_records_used].event = event;
    ctx->profiling_records[ctx->profiling_records_used].runs = runs;
    ctx->profiling_records[ctx->profiling_records_used].runtime = runtime;
    ctx->profiling_records_used++;
    return event;
}

// Allocate memory from driver. The problem is that OpenCL may perform
// lazy allocation, so we cannot know whether an allocation succeeded
// until the first time we try to use it.  Hence we immediately
// perform a write to see if the allocation succeeded.  This is slow,
// but the assumption is that this operation will be rare (most things
// will go through the free list).
static int opencl_alloc_actual(struct opencl_context *ctx, size_t size, cl_mem *mem_out) {
  int error;
  *mem_out = clCreateBuffer(ctx->ctx, CL_MEM_READ_WRITE, size, NULL, &error);

  if (error != CL_SUCCESS) {
    return error;
  }

  int x = 2;
  error = clEnqueueWriteBuffer(ctx->queue, *mem_out, 1, 0, sizeof(x), &x, 0, NULL, NULL);

  // No need to wait for completion here. clWaitForEvents() cannot
  // return mem object allocation failures. This implies that the
  // buffer is faulted onto the device on enqueue. (Observation by
  // Andreas Kloeckner.)

  return error;
}

static int opencl_alloc(struct opencl_context *ctx, size_t min_size, const char *tag, cl_mem *mem_out) {
  (void)tag;
  if (min_size < sizeof(int)) {
    min_size = sizeof(int);
  }

  size_t size;

  if (free_list_find(&ctx->free_list, min_size, &size, mem_out) == 0) {
    // Successfully found a free block.  Is it big enough?
    //
    // FIXME: we might also want to check whether the block is *too
    // big*, to avoid internal fragmentation.  However, this can
    // sharply impact performance on programs where arrays change size
    // frequently.  Fortunately, such allocations are usually fairly
    // short-lived, as they are necessarily within a loop, so the risk
    // of internal fragmentation resulting in an OOM situation is
    // limited.  However, it would be preferable if we could go back
    // and *shrink* oversize allocations when we encounter an OOM
    // condition.  That is technically feasible, since we do not
    // expose OpenCL pointer values directly to the application, but
    // instead rely on a level of indirection.
    if (size >= min_size) {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "No need to allocate: Found a block in the free list.\n");
      }

      return CL_SUCCESS;
    } else {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "Found a free block, but it was too small.\n");
      }

      // Not just right - free it.
      int error = clReleaseMemObject(*mem_out);
      if (error != CL_SUCCESS) {
        return error;
      }
    }
  }

  // We have to allocate a new block from the driver.  If the
  // allocation does not succeed, then we might be in an out-of-memory
  // situation.  We now start freeing things from the free list until
  // we think we have freed enough that the allocation will succeed.
  // Since we don't know how far the allocation is from fitting, we
  // have to check after every deallocation.  This might be pretty
  // expensive.  Let's hope that this case is hit rarely.

  if (ctx->cfg.debugging) {
    fprintf(stderr, "Actually allocating the desired block.\n");
  }

  int error = opencl_alloc_actual(ctx, min_size, mem_out);

  while (error == CL_MEM_OBJECT_ALLOCATION_FAILURE) {
    if (ctx->cfg.debugging) {
      fprintf(stderr, "Out of OpenCL memory: releasing entry from the free list...\n");
    }
    cl_mem mem;
    if (free_list_first(&ctx->free_list, &mem) == 0) {
      error = clReleaseMemObject(mem);
      if (error != CL_SUCCESS) {
        return error;
      }
    } else {
      break;
    }
    error = opencl_alloc_actual(ctx, min_size, mem_out);
  }

  return error;
}

static int opencl_free(struct opencl_context *ctx, cl_mem mem, const char *tag) {
  size_t size;
  cl_mem existing_mem;

  // If there is already a block with this tag, then remove it.
  if (free_list_find(&ctx->free_list, -1, &size, &existing_mem) == 0) {
    int error = clReleaseMemObject(existing_mem);
    if (error != CL_SUCCESS) {
      return error;
    }
  }

  int error = clGetMemObjectInfo(mem, CL_MEM_SIZE, sizeof(size_t), &size, NULL);

  if (error == CL_SUCCESS) {
    free_list_insert(&ctx->free_list, size, mem, tag);
  }

  return error;
}

static int opencl_free_all(struct opencl_context *ctx) {
  cl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, &mem) == 0) {
    int error = clReleaseMemObject(mem);
    if (error != CL_SUCCESS) {
      return error;
    }
  }

  return CL_SUCCESS;
}

// Free everything that belongs to 'ctx', but do not free 'ctx'
// itself.
static void teardown_opencl(struct opencl_context *ctx) {
  (void)opencl_tally_profiling_records(ctx);
  free(ctx->profiling_records);
  (void)opencl_free_all(ctx);
  (void)clReleaseCommandQueue(ctx->queue);
  (void)clReleaseContext(ctx->ctx);
}

// End of opencl.h.

static const char *opencl_program[] =
                  {"#ifdef cl_clang_storage_class_specifiers\n#pragma OPENCL EXTENSION cl_clang_storage_class_specifiers : enable\n#endif\n#pragma OPENCL EXTENSION cl_khr_byte_addressable_store : enable\n__kernel void dummy_kernel(__global unsigned char *dummy, int n)\n{\n    const int thread_gid = get_global_id(0);\n    \n    if (thread_gid >= n)\n        return;\n}\ntypedef char int8_t;\ntypedef short int16_t;\ntypedef int int32_t;\ntypedef long int64_t;\ntypedef uchar uint8_t;\ntypedef ushort uint16_t;\ntypedef uint uint32_t;\ntypedef ulong uint64_t;\n#ifdef cl_nv_pragma_unroll\nstatic inline void mem_fence_global()\n{\n    asm(\"membar.gl;\");\n}\n#else\nstatic inline void mem_fence_global()\n{\n    mem_fence(CLK_LOCAL_MEM_FENCE | CLK_GLOBAL_MEM_FENCE);\n}\n#endif\nstatic inline void mem_fence_local()\n{\n    mem_fence(CLK_LOCAL_MEM_FENCE);\n}\nstatic inline uint8_t add8(uint8_t x, uint8_t y)\n{\n    return x + y;\n}\nstatic inline uint16_t add16(uint16_t x, uint16_t y)\n{\n    return x + y;\n}\nstatic inline uint32_t add32(uint32_t x, uint32_t y)\n{\n    return x + y;\n}\nstatic inline uint64_t add64(uint64_t x, uint64_t y)\n{\n    return x + y;\n}\nstatic inline uint8_t sub8(uint8_t x, uint8_t y)\n{\n    return x - y;\n}\nstatic inline uint16_t sub16(uint16_t x, uint16_t y)\n{\n    return x - y;\n}\nstatic inline uint32_t sub32(uint32_t x, uint32_t y)\n{\n    return x - y;\n}\nstatic inline uint64_t sub64(uint64_t x, uint64_t y)\n{\n    return x - y;\n}\nstatic inline uint8_t mul8(uint8_t x, uint8_t y)\n{\n    return x * y;\n}\nstatic inline uint16_t mul16(uint16_t x, uint16_t y)\n{\n    return x * y;\n}\nstatic inline uint32_t mul32(uint32_t x, uint32_t y)\n{\n    return x * y;\n}\nstatic inline uint64_t mul64(uint64_t x, uint64_t y)\n{\n    return x * y;\n}\nstatic inline uint8_t udiv8(uint8_t x, uint8_t y)\n{\n    return x / y;\n}\nstatic inline uint16_t udiv16(uint16_t x, uint16_t y)\n{\n    return x / y;\n}\nstatic inline uint32_t udiv32(uint32_t x, uint32_t y)\n{\n    return x / y;\n}\nstatic inline uint64_t udiv64(uint64_t x, uint64_t y)\n{\n    return x / y;\n}\nstatic ",
                   "inline uint8_t udiv_up8(uint8_t x, uint8_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint16_t udiv_up16(uint16_t x, uint16_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint32_t udiv_up32(uint32_t x, uint32_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint64_t udiv_up64(uint64_t x, uint64_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint8_t umod8(uint8_t x, uint8_t y)\n{\n    return x % y;\n}\nstatic inline uint16_t umod16(uint16_t x, uint16_t y)\n{\n    return x % y;\n}\nstatic inline uint32_t umod32(uint32_t x, uint32_t y)\n{\n    return x % y;\n}\nstatic inline uint64_t umod64(uint64_t x, uint64_t y)\n{\n    return x % y;\n}\nstatic inline uint8_t udiv_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint16_t udiv_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint32_t udiv_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint64_t udiv_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint8_t umod_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint16_t umod_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint32_t umod_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint64_t umod_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int8_t sdiv8(int8_t x, int8_t y)\n{\n    int8_t q = x / y;\n    int8_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int16_t sdiv16(int16",
                   "_t x, int16_t y)\n{\n    int16_t q = x / y;\n    int16_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int32_t sdiv32(int32_t x, int32_t y)\n{\n    int32_t q = x / y;\n    int32_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int64_t sdiv64(int64_t x, int64_t y)\n{\n    int64_t q = x / y;\n    int64_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int8_t sdiv_up8(int8_t x, int8_t y)\n{\n    return sdiv8(x + y - 1, y);\n}\nstatic inline int16_t sdiv_up16(int16_t x, int16_t y)\n{\n    return sdiv16(x + y - 1, y);\n}\nstatic inline int32_t sdiv_up32(int32_t x, int32_t y)\n{\n    return sdiv32(x + y - 1, y);\n}\nstatic inline int64_t sdiv_up64(int64_t x, int64_t y)\n{\n    return sdiv64(x + y - 1, y);\n}\nstatic inline int8_t smod8(int8_t x, int8_t y)\n{\n    int8_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int16_t smod16(int16_t x, int16_t y)\n{\n    int16_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int32_t smod32(int32_t x, int32_t y)\n{\n    int32_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int64_t smod64(int64_t x, int64_t y)\n{\n    int64_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int8_t sdiv_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : sdiv8(x, y);\n}\nstatic inline int16_t sdiv_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : sdiv16(x, y);\n}\nstatic inline int32_t sdiv_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : sdiv32(x, y);\n}\nstatic inline int64_t sdiv_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : sdiv64(x, y);\n}\nstatic inline int8_t sdiv_up_safe8(int8_t x, int8_t y)\n{\n    return sdiv_safe8(x + y - 1, y);\n}\nstatic inline int16_t sdiv_up_safe16(int16_t x, int16_t y)\n{\n    return sdiv_safe16(x + y - 1, y",
                   ");\n}\nstatic inline int32_t sdiv_up_safe32(int32_t x, int32_t y)\n{\n    return sdiv_safe32(x + y - 1, y);\n}\nstatic inline int64_t sdiv_up_safe64(int64_t x, int64_t y)\n{\n    return sdiv_safe64(x + y - 1, y);\n}\nstatic inline int8_t smod_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : smod8(x, y);\n}\nstatic inline int16_t smod_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : smod16(x, y);\n}\nstatic inline int32_t smod_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : smod32(x, y);\n}\nstatic inline int64_t smod_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : smod64(x, y);\n}\nstatic inline int8_t squot8(int8_t x, int8_t y)\n{\n    return x / y;\n}\nstatic inline int16_t squot16(int16_t x, int16_t y)\n{\n    return x / y;\n}\nstatic inline int32_t squot32(int32_t x, int32_t y)\n{\n    return x / y;\n}\nstatic inline int64_t squot64(int64_t x, int64_t y)\n{\n    return x / y;\n}\nstatic inline int8_t srem8(int8_t x, int8_t y)\n{\n    return x % y;\n}\nstatic inline int16_t srem16(int16_t x, int16_t y)\n{\n    return x % y;\n}\nstatic inline int32_t srem32(int32_t x, int32_t y)\n{\n    return x % y;\n}\nstatic inline int64_t srem64(int64_t x, int64_t y)\n{\n    return x % y;\n}\nstatic inline int8_t squot_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int16_t squot_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int32_t squot_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int64_t squot_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int8_t srem_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int16_t srem_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int32_t srem_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int64_t srem_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int8_t smin8(int8_t x, int8_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int16_t smi",
                   "n16(int16_t x, int16_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int32_t smin32(int32_t x, int32_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int64_t smin64(int64_t x, int64_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint8_t umin8(uint8_t x, uint8_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint16_t umin16(uint16_t x, uint16_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint32_t umin32(uint32_t x, uint32_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint64_t umin64(uint64_t x, uint64_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int8_t smax8(int8_t x, int8_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int16_t smax16(int16_t x, int16_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int32_t smax32(int32_t x, int32_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int64_t smax64(int64_t x, int64_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint8_t umax8(uint8_t x, uint8_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint16_t umax16(uint16_t x, uint16_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint32_t umax32(uint32_t x, uint32_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint64_t umax64(uint64_t x, uint64_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint8_t shl8(uint8_t x, uint8_t y)\n{\n    return x << y;\n}\nstatic inline uint16_t shl16(uint16_t x, uint16_t y)\n{\n    return x << y;\n}\nstatic inline uint32_t shl32(uint32_t x, uint32_t y)\n{\n    return x << y;\n}\nstatic inline uint64_t shl64(uint64_t x, uint64_t y)\n{\n    return x << y;\n}\nstatic inline uint8_t lshr8(uint8_t x, uint8_t y)\n{\n    return x >> y;\n}\nstatic inline uint16_t lshr16(uint16_t x, uint16_t y)\n{\n    return x >> y;\n}\nstatic inline uint32_t lshr32(uint32_t x, uint32_t y)\n{\n    return x >> y;\n}\nstatic inline uint64_t lshr64(uint64_t x, uint64_t y)\n{\n    return x >> y;\n}\nstatic inline int8_t ashr8(int8_t x, int8_t y)\n{\n    return x >> y;\n}\nstatic inline int16_t ashr16(int16_t x, int16_t y)\n{\n    return x >> y;\n}\nstatic inline int32_t ashr32(int32_t x, int32_t y)",
                   "\n{\n    return x >> y;\n}\nstatic inline int64_t ashr64(int64_t x, int64_t y)\n{\n    return x >> y;\n}\nstatic inline uint8_t and8(uint8_t x, uint8_t y)\n{\n    return x & y;\n}\nstatic inline uint16_t and16(uint16_t x, uint16_t y)\n{\n    return x & y;\n}\nstatic inline uint32_t and32(uint32_t x, uint32_t y)\n{\n    return x & y;\n}\nstatic inline uint64_t and64(uint64_t x, uint64_t y)\n{\n    return x & y;\n}\nstatic inline uint8_t or8(uint8_t x, uint8_t y)\n{\n    return x | y;\n}\nstatic inline uint16_t or16(uint16_t x, uint16_t y)\n{\n    return x | y;\n}\nstatic inline uint32_t or32(uint32_t x, uint32_t y)\n{\n    return x | y;\n}\nstatic inline uint64_t or64(uint64_t x, uint64_t y)\n{\n    return x | y;\n}\nstatic inline uint8_t xor8(uint8_t x, uint8_t y)\n{\n    return x ^ y;\n}\nstatic inline uint16_t xor16(uint16_t x, uint16_t y)\n{\n    return x ^ y;\n}\nstatic inline uint32_t xor32(uint32_t x, uint32_t y)\n{\n    return x ^ y;\n}\nstatic inline uint64_t xor64(uint64_t x, uint64_t y)\n{\n    return x ^ y;\n}\nstatic inline bool ult8(uint8_t x, uint8_t y)\n{\n    return x < y;\n}\nstatic inline bool ult16(uint16_t x, uint16_t y)\n{\n    return x < y;\n}\nstatic inline bool ult32(uint32_t x, uint32_t y)\n{\n    return x < y;\n}\nstatic inline bool ult64(uint64_t x, uint64_t y)\n{\n    return x < y;\n}\nstatic inline bool ule8(uint8_t x, uint8_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule16(uint16_t x, uint16_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule32(uint32_t x, uint32_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule64(uint64_t x, uint64_t y)\n{\n    return x <= y;\n}\nstatic inline bool slt8(int8_t x, int8_t y)\n{\n    return x < y;\n}\nstatic inline bool slt16(int16_t x, int16_t y)\n{\n    return x < y;\n}\nstatic inline bool slt32(int32_t x, int32_t y)\n{\n    return x < y;\n}\nstatic inline bool slt64(int64_t x, int64_t y)\n{\n    return x < y;\n}\nstatic inline bool sle8(int8_t x, int8_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle16(int16_t x, int16_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle32(int32_t x, int32_",
                   "t y)\n{\n    return x <= y;\n}\nstatic inline bool sle64(int64_t x, int64_t y)\n{\n    return x <= y;\n}\nstatic inline int8_t pow8(int8_t x, int8_t y)\n{\n    int8_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int16_t pow16(int16_t x, int16_t y)\n{\n    int16_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int32_t pow32(int32_t x, int32_t y)\n{\n    int32_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int64_t pow64(int64_t x, int64_t y)\n{\n    int64_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline bool itob_i8_bool(int8_t x)\n{\n    return x;\n}\nstatic inline bool itob_i16_bool(int16_t x)\n{\n    return x;\n}\nstatic inline bool itob_i32_bool(int32_t x)\n{\n    return x;\n}\nstatic inline bool itob_i64_bool(int64_t x)\n{\n    return x;\n}\nstatic inline int8_t btoi_bool_i8(bool x)\n{\n    return x;\n}\nstatic inline int16_t btoi_bool_i16(bool x)\n{\n    return x;\n}\nstatic inline int32_t btoi_bool_i32(bool x)\n{\n    return x;\n}\nstatic inline int64_t btoi_bool_i64(bool x)\n{\n    return x;\n}\n#define sext_i8_i8(x) ((int8_t) (int8_t) x)\n#define sext_i8_i16(x) ((int16_t) (int8_t) x)\n#define sext_i8_i32(x) ((int32_t) (int8_t) x)\n#define sext_i8_i64(x) ((int64_t) (int8_t) x)\n#define sext_i16_i8(x) ((int8_t) (int16_t) x)\n#define sext_i16_i16(x) ((int16_t) (int16_t) x)\n#define sext_i16_i32(x) ((int32_t) (int16_t) x)\n#define sext_i16_i64(x) ((int64_t) (int16_t) x)\n#define sext_i32_i8(x) ((int8_t) (int32_t) x)\n#define sext_i32_i16(x) ((int16_t) (int32_t) x)\n#define sext_i32_i32(x) ((int32_t) (int32_t) x)\n#define sext_i32_i64(x) ((int64_t) (int32_t) x)\n#defi",
                   "ne sext_i64_i8(x) ((int8_t) (int64_t) x)\n#define sext_i64_i16(x) ((int16_t) (int64_t) x)\n#define sext_i64_i32(x) ((int32_t) (int64_t) x)\n#define sext_i64_i64(x) ((int64_t) (int64_t) x)\n#define zext_i8_i8(x) ((int8_t) (uint8_t) x)\n#define zext_i8_i16(x) ((int16_t) (uint8_t) x)\n#define zext_i8_i32(x) ((int32_t) (uint8_t) x)\n#define zext_i8_i64(x) ((int64_t) (uint8_t) x)\n#define zext_i16_i8(x) ((int8_t) (uint16_t) x)\n#define zext_i16_i16(x) ((int16_t) (uint16_t) x)\n#define zext_i16_i32(x) ((int32_t) (uint16_t) x)\n#define zext_i16_i64(x) ((int64_t) (uint16_t) x)\n#define zext_i32_i8(x) ((int8_t) (uint32_t) x)\n#define zext_i32_i16(x) ((int16_t) (uint32_t) x)\n#define zext_i32_i32(x) ((int32_t) (uint32_t) x)\n#define zext_i32_i64(x) ((int64_t) (uint32_t) x)\n#define zext_i64_i8(x) ((int8_t) (uint64_t) x)\n#define zext_i64_i16(x) ((int16_t) (uint64_t) x)\n#define zext_i64_i32(x) ((int32_t) (uint64_t) x)\n#define zext_i64_i64(x) ((int64_t) (uint64_t) x)\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_popc8(int8_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    return popcount(x);\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_popc8(int8_t x)\n{\n    return __popc(zext_i8_i32(x));\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    return __popc(zext_i16_i32(x));\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    return __popc(x);\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    return __popcll(x);\n}\n#else\nstatic int32_t futrts_popc8(int8_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    int c = 0;\n    \n    for ",
                   "(; x; ++c)\n        x &= x - 1;\n    return c;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    return mul_hi(a, b);\n}\n#elif defined(__CUDA_ARCH__)\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    uint16_t aa = a;\n    uint16_t bb = b;\n    \n    return aa * bb >> 8;\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    uint32_t aa = a;\n    uint32_t bb = b;\n    \n    return aa * bb >> 16;\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    return mulhi(a, b);\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    return mul64hi(a, b);\n}\n#else\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    uint16_t aa = a;\n    uint16_t bb = b;\n    \n    return aa * bb >> 8;\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    uint32_t aa = a;\n    uint32_t bb = b;\n    \n    return aa * bb >> 16;\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    uint64_t aa = a;\n    uint64_t bb = b;\n    \n    return aa * bb >> 32;\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    __uint128_t aa = a;\n    __uint128_t bb = b;\n    \n    return aa * bb >> 64;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)\n{\n    return mad_hi(a, b, c);\n}\n#else\nstatic uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)\n{\n    return futrts_mul_hi8(a, b) + c;\n}\nstatic uint16_t futrts_mad_hi16(uin",
                   "t16_t a, uint16_t b, uint16_t c)\n{\n    return futrts_mul_hi16(a, b) + c;\n}\nstatic uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)\n{\n    return futrts_mul_hi32(a, b) + c;\n}\nstatic uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)\n{\n    return futrts_mul_hi64(a, b) + c;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    return clz(x);\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    return __clz(zext_i8_i32(x)) - 24;\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    return __clz(zext_i16_i32(x)) - 16;\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    return __clz(x);\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    return __clzll(x);\n}\n#else\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    int i = 0;\n    \n    for (; i < 8 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz16(int16_t ",
                   "x)\n{\n    int i = 0;\n    \n    for (; i < 16 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    int i = 0;\n    \n    for (; i < 32 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    int i = 0;\n    \n    for (; i < 64 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 8 : y - 1;\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 16 : y - 1;\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 32 : y - 1;\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    int y = __ffsll(x);\n    \n    return y == 0 ? 64 : y - 1;\n}\n#else\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    return x == 0 ? 8 : __builtin_ctz((uint32_t) x);\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    return x == 0 ? 16 : __builtin_ctz((uint32_t) x);\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    return x == 0 ? 32 : __builtin_ctz(x);\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    return x == 0 ? 64 : __builtin_ctzl(x);\n}\n#endif\nstatic inline float fdiv32(float x, float y)\n{\n    return x / y;\n}\nstatic inline float fadd32(float x, float y)\n{\n    return x + y;\n}\nstatic inline float fsub32(float x, float y)\n{\n    return x - y;\n}\nstatic inline float fmul32(float x, float y)\n{\n    return x * y;\n}\nstatic inline float fmin32(float x, float y)\n{\n    return fmin(x, y);\n}\nstatic inline float fmax32(float x, float y)\n{\n    return fmax(x, y);\n}\nstatic inline float fpow32(float x, float y)\n{\n    return pow(x, y);\n}\nstatic inline bool cmplt32(float x, float y)\n{\n    return x < y;\n}\nstatic inline bool cmple32(float x, float y)\n{\n    return x <= y;\n}\nstatic inline float sitofp_i8_f32(int8_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i16_f32(int16_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i32_f32(int32_t x)",
                   "\n{\n    return (float) x;\n}\nstatic inline float sitofp_i64_f32(int64_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i8_f32(uint8_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i16_f32(uint16_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i32_f32(uint32_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i64_f32(uint64_t x)\n{\n    return (float) x;\n}\nstatic inline int8_t fptosi_f32_i8(float x)\n{\n    return (int8_t) x;\n}\nstatic inline int16_t fptosi_f32_i16(float x)\n{\n    return (int16_t) x;\n}\nstatic inline int32_t fptosi_f32_i32(float x)\n{\n    return (int32_t) x;\n}\nstatic inline int64_t fptosi_f32_i64(float x)\n{\n    return (int64_t) x;\n}\nstatic inline uint8_t fptoui_f32_i8(float x)\n{\n    return (uint8_t) x;\n}\nstatic inline uint16_t fptoui_f32_i16(float x)\n{\n    return (uint16_t) x;\n}\nstatic inline uint32_t fptoui_f32_i32(float x)\n{\n    return (uint32_t) x;\n}\nstatic inline uint64_t fptoui_f32_i64(float x)\n{\n    return (uint64_t) x;\n}\nstatic inline float futrts_log32(float x)\n{\n    return log(x);\n}\nstatic inline float futrts_log2_32(float x)\n{\n    return log2(x);\n}\nstatic inline float futrts_log10_32(float x)\n{\n    return log10(x);\n}\nstatic inline float futrts_sqrt32(float x)\n{\n    return sqrt(x);\n}\nstatic inline float futrts_exp32(float x)\n{\n    return exp(x);\n}\nstatic inline float futrts_cos32(float x)\n{\n    return cos(x);\n}\nstatic inline float futrts_sin32(float x)\n{\n    return sin(x);\n}\nstatic inline float futrts_tan32(float x)\n{\n    return tan(x);\n}\nstatic inline float futrts_acos32(float x)\n{\n    return acos(x);\n}\nstatic inline float futrts_asin32(float x)\n{\n    return asin(x);\n}\nstatic inline float futrts_atan32(float x)\n{\n    return atan(x);\n}\nstatic inline float futrts_cosh32(float x)\n{\n    return cosh(x);\n}\nstatic inline float futrts_sinh32(float x)\n{\n    return sinh(x);\n}\nstatic inline float futrts_tanh32(float x)\n{\n    return tanh(x);\n}\nstatic inline float futrts_acosh32(float x)\n{\n    return acosh(x);\n}\nstatic inline fl",
                   "oat futrts_asinh32(float x)\n{\n    return asinh(x);\n}\nstatic inline float futrts_atanh32(float x)\n{\n    return atanh(x);\n}\nstatic inline float futrts_atan2_32(float x, float y)\n{\n    return atan2(x, y);\n}\nstatic inline float futrts_gamma32(float x)\n{\n    return tgamma(x);\n}\nstatic inline float futrts_lgamma32(float x)\n{\n    return lgamma(x);\n}\nstatic inline bool futrts_isnan32(float x)\n{\n    return isnan(x);\n}\nstatic inline bool futrts_isinf32(float x)\n{\n    return isinf(x);\n}\nstatic inline int32_t futrts_to_bits32(float x)\n{\n    union {\n        float f;\n        int32_t t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\nstatic inline float futrts_from_bits32(int32_t x)\n{\n    union {\n        int32_t f;\n        float t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\n#ifdef __OPENCL_VERSION__\nstatic inline float fmod32(float x, float y)\n{\n    return fmod(x, y);\n}\nstatic inline float futrts_round32(float x)\n{\n    return rint(x);\n}\nstatic inline float futrts_floor32(float x)\n{\n    return floor(x);\n}\nstatic inline float futrts_ceil32(float x)\n{\n    return ceil(x);\n}\nstatic inline float futrts_lerp32(float v0, float v1, float t)\n{\n    return mix(v0, v1, t);\n}\nstatic inline float futrts_mad32(float a, float b, float c)\n{\n    return mad(a, b, c);\n}\nstatic inline float futrts_fma32(float a, float b, float c)\n{\n    return fma(a, b, c);\n}\n#else\nstatic inline float fmod32(float x, float y)\n{\n    return fmodf(x, y);\n}\nstatic inline float futrts_round32(float x)\n{\n    return rintf(x);\n}\nstatic inline float futrts_floor32(float x)\n{\n    return floorf(x);\n}\nstatic inline float futrts_ceil32(float x)\n{\n    return ceilf(x);\n}\nstatic inline float futrts_lerp32(float v0, float v1, float t)\n{\n    return v0 + (v1 - v0) * t;\n}\nstatic inline float futrts_mad32(float a, float b, float c)\n{\n    return a * b + c;\n}\nstatic inline float futrts_fma32(float a, float b, float c)\n{\n    return fmaf(a, b, c);\n}\n#endif\n// Start of atomics.h\n\ninline int32_t atomic_add_i32_global(volatile __global int32_t *p, ",
                   "int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\ninline int32_t atomic_add_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\ninline float atomic_fadd_f32_global(volatile __global float *p, float x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg((volatile __global int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\ninline float atomic_fadd_f32_local(volatile __local float *p, float x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg((volatile __local int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\ninline int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline int32_t atomic_smax_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline int32_t atomic_smin_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p",
                   ", x);\n#endif\n}\n\ninline uint32_t atomic_umax_i32_local(volatile __local uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline uint32_t atomic_umin_i32_local(volatile __local uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\ninline int32_t atomic_and_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\ninline int32_t atomic_or_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\ninline int32_t atomic_or_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\ninline int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xor_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xchg_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t",
                   " atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                         int32_t cmp, int32_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\ninline int32_t atomic_cmpxchg_i32_local(volatile __local int32_t *p,\n                                         int32_t cmp, int32_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\n// End of atomics.h\n\n\n\n\n__kernel void gpu_map_transpose_f32(__local volatile\n                                    int64_t *block_9_backing_aligned_0,\n                                    int32_t destoffset_1, int32_t srcoffset_3,\n                                    int32_t num_arrays_4, int32_t x_elems_5,\n                                    int32_t y_elems_6, int32_t mulx_7,\n                                    int32_t muly_8, __global\n                                    unsigned char *destmem_0, __global\n                                    unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = get_group_id_2_42 * x_elems_5 * y_elems_6;\n    int32_t odat",
                   "a_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t x_index_31 = get_global_id_0_37;\n    int32_t y_index_32 = get_group_id_1_41 * 32 + get_local_id_1_39;\n    \n    if (slt32(x_index_31, x_elems_5)) {\n        for (int32_t j_43 = 0; j_43 < 4; j_43++) {\n            int32_t index_in_35 = (y_index_32 + j_43 * 8) * x_elems_5 +\n                    x_index_31;\n            \n            if (slt32(y_index_32 + j_43 * 8, y_elems_6)) {\n                ((__local float *) block_9)[sext_i32_i64((get_local_id_1_39 +\n                                                          j_43 * 8) * 33 +\n                                            get_local_id_0_38)] = ((__global\n                                                                    float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                                       index_in_35)];\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    x_index_31 = get_group_id_1_41 * 32 + get_local_id_0_38;\n    y_index_32 = get_group_id_0_40 * 32 + get_local_id_1_39;\n    if (slt32(x_index_31, y_elems_6)) {\n        for (int32_t j_43 = 0; j_43 < 4; j_43++) {\n            int32_t index_out_36 = (y_index_32 + j_43 * 8) * y_elems_6 +\n                    x_index_31;\n            \n            if (slt32(y_index_32 + j_43 * 8, x_elems_5)) {\n                ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                               index_out_36)] = ((__local\n                                                                  float *) block_9)[sext_i32_i64(get_local_id_0_38 *\n                                                                                    33 +\n                                                                                    get_local_id_1_39 +\n                                                                                    j_43 *\n                  ",
                   "                                                                  8)];\n            }\n        }\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32_low_height(__local volatile\n                                               int64_t *block_9_backing_aligned_0,\n                                               int32_t destoffset_1,\n                                               int32_t srcoffset_3,\n                                               int32_t num_arrays_4,\n                                               int32_t x_elems_5,\n                                               int32_t y_elems_6,\n                                               int32_t mulx_7, int32_t muly_8,\n                                               __global\n                                               unsigned char *destmem_0,\n                                               __global unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = get_group_id_2_42 * x_elems_5 * y_elems_6;\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t x_index_31 ",
                   "= get_group_id_0_40 * 16 * mulx_7 + get_local_id_0_38 +\n            srem32(get_local_id_1_39, mulx_7) * 16;\n    int32_t y_index_32 = get_group_id_1_41 * 16 + squot32(get_local_id_1_39,\n                                                          mulx_7);\n    int32_t index_in_35 = y_index_32 * x_elems_5 + x_index_31;\n    \n    if (slt32(x_index_31, x_elems_5) && slt32(y_index_32, y_elems_6)) {\n        ((__local float *) block_9)[sext_i32_i64(get_local_id_1_39 * 17 +\n                                    get_local_id_0_38)] = ((__global\n                                                            float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                               index_in_35)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    x_index_31 = get_group_id_1_41 * 16 + squot32(get_local_id_0_38, mulx_7);\n    y_index_32 = get_group_id_0_40 * 16 * mulx_7 + get_local_id_1_39 +\n        srem32(get_local_id_0_38, mulx_7) * 16;\n    \n    int32_t index_out_36 = y_index_32 * y_elems_6 + x_index_31;\n    \n    if (slt32(x_index_31, y_elems_6) && slt32(y_index_32, x_elems_5)) {\n        ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                       index_out_36)] = ((__local\n                                                          float *) block_9)[sext_i32_i64(get_local_id_0_38 *\n                                                                            17 +\n                                                                            get_local_id_1_39)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32_low_width(__local volatile\n                                              int64_t *block_9_backing_aligned_0,\n                                              int32_t destoffset_1,\n                                              int32_t srcoffset_3,\n                                              int32_t num_arrays_4,\n                                              int32_t x_elems_5,\n      ",
                   "                                        int32_t y_elems_6, int32_t mulx_7,\n                                              int32_t muly_8, __global\n                                              unsigned char *destmem_0, __global\n                                              unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = get_group_id_2_42 * x_elems_5 * y_elems_6;\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t x_index_31 = get_group_id_0_40 * 16 + squot32(get_local_id_0_38,\n                                                          muly_8);\n    int32_t y_index_32 = get_group_id_1_41 * 16 * muly_8 + get_local_id_1_39 +\n            srem32(get_local_id_0_38, muly_8) * 16;\n    int32_t index_in_35 = y_index_32 * x_elems_5 + x_index_31;\n    \n    if (slt32(x_index_31, x_elems_5) && slt32(y_index_32, y_elems_6)) {\n        ((__local float *) block_9)[sext_i32_i64(get_local_id_1_39 * 17 +\n                                    get_local_id_0_38)] = ((__global\n                                                            float *) src",
                   "mem_2)[sext_i32_i64(idata_offset_34 +\n                                                                               index_in_35)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    x_index_31 = get_group_id_1_41 * 16 * muly_8 + get_local_id_0_38 +\n        srem32(get_local_id_1_39, muly_8) * 16;\n    y_index_32 = get_group_id_0_40 * 16 + squot32(get_local_id_1_39, muly_8);\n    \n    int32_t index_out_36 = y_index_32 * y_elems_6 + x_index_31;\n    \n    if (slt32(x_index_31, y_elems_6) && slt32(y_index_32, x_elems_5)) {\n        ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                       index_out_36)] = ((__local\n                                                          float *) block_9)[sext_i32_i64(get_local_id_0_38 *\n                                                                            17 +\n                                                                            get_local_id_1_39)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32_small(__local volatile\n                                          int64_t *block_9_backing_aligned_0,\n                                          int32_t destoffset_1,\n                                          int32_t srcoffset_3,\n                                          int32_t num_arrays_4,\n                                          int32_t x_elems_5, int32_t y_elems_6,\n                                          int32_t mulx_7, int32_t muly_8,\n                                          __global unsigned char *destmem_0,\n                                          __global unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_g",
                   "lobal_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = squot32(get_global_id_0_37, y_elems_6 *\n                                          x_elems_5) * (y_elems_6 * x_elems_5);\n    int32_t x_index_31 = squot32(srem32(get_global_id_0_37, y_elems_6 *\n                                        x_elems_5), y_elems_6);\n    int32_t y_index_32 = srem32(get_global_id_0_37, y_elems_6);\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t index_in_35 = y_index_32 * x_elems_5 + x_index_31;\n    int32_t index_out_36 = x_index_31 * y_elems_6 + y_index_32;\n    \n    if (slt32(get_global_id_0_37, x_elems_5 * y_elems_6 * num_arrays_4)) {\n        ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                       index_out_36)] = ((__global\n                                                          float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                             index_in_35)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void mainzisegmap_20862(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, int64_t n_19755,\n                                 float a_19763, float r0_19766, float x_19783,\n                                 float x_19785, float y_19787, float y_19788,\n                                 __global unsigned char *swap_term_mem_27171,\n                ",
                   "                 __global unsigned char *payments_mem_27172,\n                                 __global unsigned char *mem_27185)\n{\n    #define segmap_group_sizze_20928 (mainzisegmap_group_sizze_20864)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27335;\n    int32_t local_tid_27336;\n    int64_t group_sizze_27339;\n    int32_t wave_sizze_27338;\n    int32_t group_tid_27337;\n    \n    global_tid_27335 = get_global_id(0);\n    local_tid_27336 = get_local_id(0);\n    group_sizze_27339 = get_local_size(0);\n    wave_sizze_27338 = LOCKSTEP_WIDTH;\n    group_tid_27337 = get_group_id(0);\n    \n    int32_t phys_tid_20862;\n    \n    phys_tid_20862 = global_tid_27335;\n    \n    int64_t gtid_20861;\n    \n    gtid_20861 = sext_i32_i64(group_tid_27337) * segmap_group_sizze_20928 +\n        sext_i32_i64(local_tid_27336);\n    if (slt64(gtid_20861, n_19755)) {\n        float res_20939 = ((__global float *) swap_term_mem_27171)[gtid_20861];\n        int64_t res_20940 = ((__global\n                              int64_t *) payments_mem_27172)[gtid_20861];\n        bool bounds_invalid_upwards_20942 = slt64(res_20940, 1);\n        bool valid_20943 = !bounds_invalid_upwards_20942;\n        bool range_valid_c_20944;\n        \n        if (!valid_20943) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 0) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = 2;\n                    global_failure_args[2] = res_20940;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        bool y_20946 = slt64(0, res_20940);\n        bool index_certs_20947;\n        \n        if (!y_20946) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 1) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_209",
                   "40;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_20948 = sitofp_i64_f32(res_20940);\n        float index_primexp_20949 = res_20939 * binop_y_20948;\n        float negate_arg_20950 = a_19763 * index_primexp_20949;\n        float exp_arg_20951 = 0.0F - negate_arg_20950;\n        float res_20952 = fpow32(2.7182817F, exp_arg_20951);\n        float x_20953 = 1.0F - res_20952;\n        float B_20954 = x_20953 / a_19763;\n        float x_20955 = B_20954 - index_primexp_20949;\n        float x_20956 = y_19787 * x_20955;\n        float A1_20957 = x_20956 / x_19783;\n        float y_20958 = fpow32(B_20954, 2.0F);\n        float x_20959 = x_19785 * y_20958;\n        float A2_20960 = x_20959 / y_19788;\n        float exp_arg_20961 = A1_20957 - A2_20960;\n        float res_20962 = fpow32(2.7182817F, exp_arg_20961);\n        float negate_arg_20963 = r0_19766 * B_20954;\n        float exp_arg_20964 = 0.0F - negate_arg_20963;\n        float res_20965 = fpow32(2.7182817F, exp_arg_20964);\n        float res_20966 = res_20962 * res_20965;\n        float res_20967;\n        float redout_27074 = 0.0F;\n        \n        for (int64_t i_27075 = 0; i_27075 < res_20940; i_27075++) {\n            int64_t index_primexp_27118 = add64(1, i_27075);\n            float res_20972 = sitofp_i64_f32(index_primexp_27118);\n            float res_20973 = res_20939 * res_20972;\n            float negate_arg_20974 = a_19763 * res_20973;\n            float exp_arg_20975 = 0.0F - negate_arg_20974;\n            float res_20976 = fpow32(2.7182817F, exp_arg_20975);\n            float x_20977 = 1.0F - res_20976;\n            float B_20978 = x_20977 / a_19763;\n            float x_20979 = B_20978 - res_20973;\n            float x_20980 = y_19787 * x_20979;\n            float A1_20981 = x_20980 / x_19783;\n            float y_20982 = fpow32(B_20978, 2.0F);\n            float x_20983 = x_19785 * y_20982;\n            float A2_20984 = x_20983 / y_19788;\n            float exp_arg",
                   "_20985 = A1_20981 - A2_20984;\n            float res_20986 = fpow32(2.7182817F, exp_arg_20985);\n            float negate_arg_20987 = r0_19766 * B_20978;\n            float exp_arg_20988 = 0.0F - negate_arg_20987;\n            float res_20989 = fpow32(2.7182817F, exp_arg_20988);\n            float res_20990 = res_20986 * res_20989;\n            float res_20970 = res_20990 + redout_27074;\n            float redout_tmp_27340 = res_20970;\n            \n            redout_27074 = redout_tmp_27340;\n        }\n        res_20967 = redout_27074;\n        \n        float x_20991 = 1.0F - res_20966;\n        float y_20992 = res_20939 * res_20967;\n        float res_20993 = x_20991 / y_20992;\n        \n        ((__global float *) mem_27185)[gtid_20861] = res_20993;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_20928\n}\n__kernel void mainzisegmap_21011(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, int64_t n_19755,\n                                 float a_19763, float r0_19766, float x_19783,\n                                 float x_19785, float y_19787, float y_19788,\n                                 __global unsigned char *swap_term_mem_27171,\n                                 __global unsigned char *payments_mem_27172,\n                                 __global unsigned char *mem_27194)\n{\n    #define segmap_group_sizze_21077 (mainzisegmap_group_sizze_21013)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27341;\n    int32_t local_tid_27342;\n    int64_t group_sizze_27345;\n    int32_t wave_sizze_27344;\n    int32_t group_tid_27343;\n    \n    global_tid_27341 = get_global_id(0);\n    local_tid_27342 = get_local_id(0);\n    group_sizze_27345 = get_local_size(0);\n    wave_sizze_27344 = LOCKSTEP_WIDTH;\n    group_tid_27343 = get_group_id(0);\n    \n   ",
                   " int32_t phys_tid_21011;\n    \n    phys_tid_21011 = global_tid_27341;\n    \n    int64_t gtid_21010;\n    \n    gtid_21010 = sext_i32_i64(group_tid_27343) * segmap_group_sizze_21077 +\n        sext_i32_i64(local_tid_27342);\n    if (slt64(gtid_21010, n_19755)) {\n        float res_21088 = ((__global float *) swap_term_mem_27171)[gtid_21010];\n        int64_t res_21089 = ((__global\n                              int64_t *) payments_mem_27172)[gtid_21010];\n        bool bounds_invalid_upwards_21091 = slt64(res_21089, 1);\n        bool valid_21092 = !bounds_invalid_upwards_21091;\n        bool range_valid_c_21093;\n        \n        if (!valid_21092) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 2) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = 2;\n                    global_failure_args[2] = res_21089;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        bool y_21095 = slt64(0, res_21089);\n        bool index_certs_21096;\n        \n        if (!y_21095) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 3) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_21089;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_21097 = sitofp_i64_f32(res_21089);\n        float index_primexp_21098 = res_21088 * binop_y_21097;\n        float negate_arg_21099 = a_19763 * index_primexp_21098;\n        float exp_arg_21100 = 0.0F - negate_arg_21099;\n        float res_21101 = fpow32(2.7182817F, exp_arg_21100);\n        float x_21102 = 1.0F - res_21101;\n        float B_21103 = x_21102 / a_19763;\n        float x_21104 = B_21103 - index_primexp_21098;\n        float x_21105 = y_19787 * x_21104;\n        float A1_21106 = x_21105 / x_19783;\n        float y_21107 = fpow32(B_21103, 2.0F);\n        float x_21108 = x_19785 * y_2110",
                   "7;\n        float A2_21109 = x_21108 / y_19788;\n        float exp_arg_21110 = A1_21106 - A2_21109;\n        float res_21111 = fpow32(2.7182817F, exp_arg_21110);\n        float negate_arg_21112 = r0_19766 * B_21103;\n        float exp_arg_21113 = 0.0F - negate_arg_21112;\n        float res_21114 = fpow32(2.7182817F, exp_arg_21113);\n        float res_21115 = res_21111 * res_21114;\n        float res_21116;\n        float redout_27078 = 0.0F;\n        \n        for (int64_t i_27079 = 0; i_27079 < res_21089; i_27079++) {\n            int64_t index_primexp_27120 = add64(1, i_27079);\n            float res_21121 = sitofp_i64_f32(index_primexp_27120);\n            float res_21122 = res_21088 * res_21121;\n            float negate_arg_21123 = a_19763 * res_21122;\n            float exp_arg_21124 = 0.0F - negate_arg_21123;\n            float res_21125 = fpow32(2.7182817F, exp_arg_21124);\n            float x_21126 = 1.0F - res_21125;\n            float B_21127 = x_21126 / a_19763;\n            float x_21128 = B_21127 - res_21122;\n            float x_21129 = y_19787 * x_21128;\n            float A1_21130 = x_21129 / x_19783;\n            float y_21131 = fpow32(B_21127, 2.0F);\n            float x_21132 = x_19785 * y_21131;\n            float A2_21133 = x_21132 / y_19788;\n            float exp_arg_21134 = A1_21130 - A2_21133;\n            float res_21135 = fpow32(2.7182817F, exp_arg_21134);\n            float negate_arg_21136 = r0_19766 * B_21127;\n            float exp_arg_21137 = 0.0F - negate_arg_21136;\n            float res_21138 = fpow32(2.7182817F, exp_arg_21137);\n            float res_21139 = res_21135 * res_21138;\n            float res_21119 = res_21139 + redout_27078;\n            float redout_tmp_27346 = res_21119;\n            \n            redout_27078 = redout_tmp_27346;\n        }\n        res_21116 = redout_27078;\n        \n        float x_21140 = 1.0F - res_21115;\n        float y_21141 = res_21088 * res_21116;\n        float res_21142 = x_21140 / y_21141;\n        \n        ((__global float *) ",
                   "mem_27194)[gtid_21010] = res_21142;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_21077\n}\n__kernel void mainzisegmap_21320(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args,\n                                 int64_t paths_19758, int64_t steps_19759,\n                                 float a_19763, float b_19764,\n                                 float sigma_19765, float r0_19766,\n                                 float dt_19781, int64_t upper_bound_19867,\n                                 float res_19868, int64_t num_groups_21572,\n                                 __global unsigned char *mem_27208, __global\n                                 unsigned char *mem_27211, __global\n                                 unsigned char *mem_27226)\n{\n    #define segmap_group_sizze_21571 (mainzisegmap_group_sizze_21322)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27359;\n    int32_t local_tid_27360;\n    int64_t group_sizze_27363;\n    int32_t wave_sizze_27362;\n    int32_t group_tid_27361;\n    \n    global_tid_27359 = get_global_id(0);\n    local_tid_27360 = get_local_id(0);\n    group_sizze_27363 = get_local_size(0);\n    wave_sizze_27362 = LOCKSTEP_WIDTH;\n    group_tid_27361 = get_group_id(0);\n    \n    int32_t phys_tid_21320;\n    \n    phys_tid_21320 = global_tid_27359;\n    \n    int32_t phys_group_id_27364;\n    \n    phys_group_id_27364 = get_group_id(0);\n    for (int32_t i_27365 = 0; i_27365 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(paths_19758,\n                                          segmap_group_sizze_21571)) -\n                   phys_group_id_27364, sex",
                   "t_i64_i32(num_groups_21572));\n         i_27365++) {\n        int32_t virt_group_id_27366 = phys_group_id_27364 + i_27365 *\n                sext_i64_i32(num_groups_21572);\n        int64_t gtid_21319 = sext_i32_i64(virt_group_id_27366) *\n                segmap_group_sizze_21571 + sext_i32_i64(local_tid_27360);\n        \n        if (slt64(gtid_21319, paths_19758)) {\n            for (int64_t i_27367 = 0; i_27367 < steps_19759; i_27367++) {\n                ((__global float *) mem_27211)[phys_tid_21320 + i_27367 *\n                                               (num_groups_21572 *\n                                                segmap_group_sizze_21571)] =\n                    r0_19766;\n            }\n            for (int64_t i_21578 = 0; i_21578 < upper_bound_19867; i_21578++) {\n                bool y_21580 = slt64(i_21578, steps_19759);\n                bool index_certs_21581;\n                \n                if (!y_21580) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 4) ==\n                            -1) {\n                            global_failure_args[0] = i_21578;\n                            global_failure_args[1] = steps_19759;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float shortstep_arg_21582 = ((__global\n                                              float *) mem_27208)[i_21578 *\n                                                                  paths_19758 +\n                                                                  gtid_21319];\n                float shortstep_arg_21583 = ((__global\n                                              float *) mem_27211)[phys_tid_21320 +\n                                                                  i_21578 *\n                                                                  (num_groups_21572 *\n                    ",
                   "                                               segmap_group_sizze_21571)];\n                float y_21584 = b_19764 - shortstep_arg_21583;\n                float x_21585 = a_19763 * y_21584;\n                float x_21586 = dt_19781 * x_21585;\n                float x_21587 = res_19868 * shortstep_arg_21582;\n                float y_21588 = sigma_19765 * x_21587;\n                float delta_r_21589 = x_21586 + y_21588;\n                float res_21590 = shortstep_arg_21583 + delta_r_21589;\n                int64_t i_21591 = add64(1, i_21578);\n                bool x_21592 = sle64(0, i_21591);\n                bool y_21593 = slt64(i_21591, steps_19759);\n                bool bounds_check_21594 = x_21592 && y_21593;\n                bool index_certs_21595;\n                \n                if (!bounds_check_21594) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 5) ==\n                            -1) {\n                            global_failure_args[0] = i_21591;\n                            global_failure_args[1] = steps_19759;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                ((__global float *) mem_27211)[phys_tid_21320 + i_21591 *\n                                               (num_groups_21572 *\n                                                segmap_group_sizze_21571)] =\n                    res_21590;\n            }\n            for (int64_t i_27369 = 0; i_27369 < steps_19759; i_27369++) {\n                ((__global float *) mem_27226)[i_27369 * paths_19758 +\n                                               gtid_21319] = ((__global\n                                                               float *) mem_27211)[phys_tid_21320 +\n                                                                                   i_27369 *\n                                                                     ",
                   "              (num_groups_21572 *\n                                                                                    segmap_group_sizze_21571)];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_21571\n}\n__kernel void mainzisegmap_21418(__global int *global_failure,\n                                 int64_t paths_19758, int64_t steps_19759,\n                                 __global unsigned char *mem_27201, __global\n                                 unsigned char *mem_27205)\n{\n    #define segmap_group_sizze_21526 (mainzisegmap_group_sizze_21421)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27353;\n    int32_t local_tid_27354;\n    int64_t group_sizze_27357;\n    int32_t wave_sizze_27356;\n    int32_t group_tid_27355;\n    \n    global_tid_27353 = get_global_id(0);\n    local_tid_27354 = get_local_id(0);\n    group_sizze_27357 = get_local_size(0);\n    wave_sizze_27356 = LOCKSTEP_WIDTH;\n    group_tid_27355 = get_group_id(0);\n    \n    int32_t phys_tid_21418;\n    \n    phys_tid_21418 = global_tid_27353;\n    \n    int64_t gtid_21416;\n    \n    gtid_21416 = squot64(sext_i32_i64(group_tid_27355) *\n                         segmap_group_sizze_21526 +\n                         sext_i32_i64(local_tid_27354), steps_19759);\n    \n    int64_t gtid_21417;\n    \n    gtid_21417 = sext_i32_i64(group_tid_27355) * segmap_group_sizze_21526 +\n        sext_i32_i64(local_tid_27354) - squot64(sext_i32_i64(group_tid_27355) *\n                                                segmap_group_sizze_21526 +\n                                                sext_i32_i64(local_tid_27354),\n                                                steps_19759) * steps_19759;\n    if (slt64(gtid_21416, paths_19758) && slt64(gtid_21417, steps_19759)) {\n        int32_t unsign_arg_21529 = ((__global int32_t *) me",
                   "m_27201)[gtid_21416];\n        int32_t res_21531 = sext_i64_i32(gtid_21417);\n        int32_t x_21532 = lshr32(res_21531, 16);\n        int32_t x_21533 = res_21531 ^ x_21532;\n        int32_t x_21534 = mul32(73244475, x_21533);\n        int32_t x_21535 = lshr32(x_21534, 16);\n        int32_t x_21536 = x_21534 ^ x_21535;\n        int32_t x_21537 = mul32(73244475, x_21536);\n        int32_t x_21538 = lshr32(x_21537, 16);\n        int32_t x_21539 = x_21537 ^ x_21538;\n        int32_t unsign_arg_21540 = unsign_arg_21529 ^ x_21539;\n        int32_t unsign_arg_21541 = mul32(48271, unsign_arg_21540);\n        int32_t unsign_arg_21542 = umod32(unsign_arg_21541, 2147483647);\n        int32_t unsign_arg_21543 = mul32(48271, unsign_arg_21542);\n        int32_t unsign_arg_21544 = umod32(unsign_arg_21543, 2147483647);\n        float res_21545 = uitofp_i32_f32(unsign_arg_21542);\n        float res_21546 = res_21545 / 2.1474836e9F;\n        float res_21547 = uitofp_i32_f32(unsign_arg_21544);\n        float res_21548 = res_21547 / 2.1474836e9F;\n        float res_21549;\n        \n        res_21549 = futrts_log32(res_21546);\n        \n        float res_21550 = -2.0F * res_21549;\n        float res_21551;\n        \n        res_21551 = futrts_sqrt32(res_21550);\n        \n        float res_21552 = 6.2831855F * res_21548;\n        float res_21553;\n        \n        res_21553 = futrts_cos32(res_21552);\n        \n        float res_21554 = res_21551 * res_21553;\n        \n        ((__global float *) mem_27205)[gtid_21416 * steps_19759 + gtid_21417] =\n            res_21554;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_21526\n}\n__kernel void mainzisegmap_21482(__global int *global_failure,\n                                 int64_t paths_19758, __global\n                                 unsigned char *mem_27201)\n{\n    #define segmap_group_sizze_21501 (mainzisegmap_group_sizze_21484)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure",
                   " >= 0)\n        return;\n    \n    int32_t global_tid_27348;\n    int32_t local_tid_27349;\n    int64_t group_sizze_27352;\n    int32_t wave_sizze_27351;\n    int32_t group_tid_27350;\n    \n    global_tid_27348 = get_global_id(0);\n    local_tid_27349 = get_local_id(0);\n    group_sizze_27352 = get_local_size(0);\n    wave_sizze_27351 = LOCKSTEP_WIDTH;\n    group_tid_27350 = get_group_id(0);\n    \n    int32_t phys_tid_21482;\n    \n    phys_tid_21482 = global_tid_27348;\n    \n    int64_t gtid_21481;\n    \n    gtid_21481 = sext_i32_i64(group_tid_27350) * segmap_group_sizze_21501 +\n        sext_i32_i64(local_tid_27349);\n    if (slt64(gtid_21481, paths_19758)) {\n        int32_t res_21505 = sext_i64_i32(gtid_21481);\n        int32_t x_21506 = lshr32(res_21505, 16);\n        int32_t x_21507 = res_21505 ^ x_21506;\n        int32_t x_21508 = mul32(73244475, x_21507);\n        int32_t x_21509 = lshr32(x_21508, 16);\n        int32_t x_21510 = x_21508 ^ x_21509;\n        int32_t x_21511 = mul32(73244475, x_21510);\n        int32_t x_21512 = lshr32(x_21511, 16);\n        int32_t x_21513 = x_21511 ^ x_21512;\n        int32_t unsign_arg_21514 = 777822902 ^ x_21513;\n        int32_t unsign_arg_21515 = mul32(48271, unsign_arg_21514);\n        int32_t unsign_arg_21516 = umod32(unsign_arg_21515, 2147483647);\n        \n        ((__global int32_t *) mem_27201)[gtid_21481] = unsign_arg_21516;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_21501\n}\n__kernel void mainzisegmap_21767(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, int64_t n_19755,\n                                 int64_t paths_19758, int64_t steps_19759,\n                                 float a_19763, float b_19764,\n                                 float sigma_19765, float x_19783,\n                                 float x_19785, float y_19787, float y_19788,\n                                 float sims_per_year_19853, float r",
                   "es_19930,\n                                 __global unsigned char *res_mem_27195, __global\n                                 unsigned char *res_mem_27196, __global\n                                 unsigned char *res_mem_27197, __global\n                                 unsigned char *res_mem_27198, __global\n                                 unsigned char *mem_27226, __global\n                                 unsigned char *mem_27234, __global\n                                 unsigned char *mem_27236)\n{\n    #define segmap_group_sizze_22526 (mainzisegmap_group_sizze_21769)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27406;\n    int32_t local_tid_27407;\n    int64_t group_sizze_27410;\n    int32_t wave_sizze_27409;\n    int32_t group_tid_27408;\n    \n    global_tid_27406 = get_global_id(0);\n    local_tid_27407 = get_local_id(0);\n    group_sizze_27410 = get_local_size(0);\n    wave_sizze_27409 = LOCKSTEP_WIDTH;\n    group_tid_27408 = get_group_id(0);\n    \n    int32_t phys_tid_21767;\n    \n    phys_tid_21767 = global_tid_27406;\n    \n    int64_t gtid_21766;\n    \n    gtid_21766 = sext_i32_i64(group_tid_27408) * segmap_group_sizze_22526 +\n        sext_i32_i64(local_tid_27407);\n    if (slt64(gtid_21766, steps_19759)) {\n        int64_t index_primexp_27096 = add64(1, gtid_21766);\n        float res_22533 = sitofp_i64_f32(index_primexp_27096);\n        float res_22534 = res_22533 / sims_per_year_19853;\n        float res_22535;\n        float redout_27153 = 0.0F;\n        \n        for (int64_t i_27154 = 0; i_27154 < paths_19758; i_27154++) {\n            float x_22539 = ((__global float *) mem_27226)[gtid_21766 *\n                                                           paths_19758 +\n                                                           i_27154];\n            float res_22541;\n            float redout_27155 = 0.0F;\n            \n            for (int64_t i_27156 = 0",
                   "; i_27156 < n_19755; i_27156++) {\n                int64_t x_22547 = ((__global int64_t *) res_mem_27197)[i_27156];\n                float x_22548 = ((__global float *) res_mem_27198)[i_27156];\n                int64_t i64_arg_22549 = sub64(x_22547, 1);\n                float res_22550 = sitofp_i64_f32(i64_arg_22549);\n                float y_22551 = x_22548 * res_22550;\n                bool cond_22552 = y_22551 < res_22534;\n                float ceil_arg_22553 = res_22534 / x_22548;\n                float res_22554;\n                \n                res_22554 = futrts_ceil32(ceil_arg_22553);\n                \n                int64_t res_22555 = fptosi_f32_i64(res_22554);\n                int64_t remaining_22556 = sub64(x_22547, res_22555);\n                float res_22557;\n                \n                if (cond_22552) {\n                    res_22557 = 0.0F;\n                } else {\n                    float x_22545 = ((__global float *) res_mem_27195)[i_27156];\n                    float x_22546 = ((__global float *) res_mem_27196)[i_27156];\n                    float nextpayment_22558 = x_22548 * res_22554;\n                    bool bounds_invalid_upwards_22559 = slt64(remaining_22556,\n                                                              1);\n                    bool valid_22560 = !bounds_invalid_upwards_22559;\n                    bool range_valid_c_22561;\n                    \n                    if (!valid_22560) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1,\n                                                          8) == -1) {\n                                global_failure_args[0] = 1;\n                                global_failure_args[1] = 2;\n                                global_failure_args[2] = remaining_22556;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    \n                    flo",
                   "at y_22563 = nextpayment_22558 - res_22534;\n                    float negate_arg_22564 = a_19763 * y_22563;\n                    float exp_arg_22565 = 0.0F - negate_arg_22564;\n                    float res_22566 = fpow32(2.7182817F, exp_arg_22565);\n                    float x_22567 = 1.0F - res_22566;\n                    float B_22568 = x_22567 / a_19763;\n                    float x_22569 = B_22568 - nextpayment_22558;\n                    float x_22570 = res_22534 + x_22569;\n                    float x_22571 = fpow32(a_19763, 2.0F);\n                    float x_22572 = b_19764 * x_22571;\n                    float x_22573 = fpow32(sigma_19765, 2.0F);\n                    float y_22574 = x_22573 / 2.0F;\n                    float y_22575 = x_22572 - y_22574;\n                    float x_22576 = x_22570 * y_22575;\n                    float A1_22577 = x_22576 / x_22571;\n                    float y_22578 = fpow32(B_22568, 2.0F);\n                    float x_22579 = x_22573 * y_22578;\n                    float y_22580 = 4.0F * a_19763;\n                    float A2_22581 = x_22579 / y_22580;\n                    float exp_arg_22582 = A1_22577 - A2_22581;\n                    float res_22583 = fpow32(2.7182817F, exp_arg_22582);\n                    float negate_arg_22584 = x_22539 * B_22568;\n                    float exp_arg_22585 = 0.0F - negate_arg_22584;\n                    float res_22586 = fpow32(2.7182817F, exp_arg_22585);\n                    float res_22587 = res_22583 * res_22586;\n                    bool y_22588 = slt64(0, remaining_22556);\n                    bool index_certs_22589;\n                    \n                    if (!y_22588) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1,\n                                                          9) == -1) {\n                                global_failure_args[0] = 0;\n                                global_failure_args[1] = remaining_22556;\n                                ",
                   ";\n                            }\n                            return;\n                        }\n                    }\n                    \n                    float binop_y_22590 = sitofp_i64_f32(remaining_22556);\n                    float binop_y_22591 = x_22548 * binop_y_22590;\n                    float index_primexp_22592 = nextpayment_22558 +\n                          binop_y_22591;\n                    float y_22593 = index_primexp_22592 - res_22534;\n                    float negate_arg_22594 = a_19763 * y_22593;\n                    float exp_arg_22595 = 0.0F - negate_arg_22594;\n                    float res_22596 = fpow32(2.7182817F, exp_arg_22595);\n                    float x_22597 = 1.0F - res_22596;\n                    float B_22598 = x_22597 / a_19763;\n                    float x_22599 = B_22598 - index_primexp_22592;\n                    float x_22600 = res_22534 + x_22599;\n                    float x_22601 = y_22575 * x_22600;\n                    float A1_22602 = x_22601 / x_22571;\n                    float y_22603 = fpow32(B_22598, 2.0F);\n                    float x_22604 = x_22573 * y_22603;\n                    float A2_22605 = x_22604 / y_22580;\n                    float exp_arg_22606 = A1_22602 - A2_22605;\n                    float res_22607 = fpow32(2.7182817F, exp_arg_22606);\n                    float negate_arg_22608 = x_22539 * B_22598;\n                    float exp_arg_22609 = 0.0F - negate_arg_22608;\n                    float res_22610 = fpow32(2.7182817F, exp_arg_22609);\n                    float res_22611 = res_22607 * res_22610;\n                    float res_22612;\n                    float redout_27093 = 0.0F;\n                    \n                    for (int64_t i_27094 = 0; i_27094 < remaining_22556;\n                         i_27094++) {\n                        int64_t index_primexp_27130 = add64(1, i_27094);\n                        float res_22617 = sitofp_i64_f32(index_primexp_27130);\n                        float res_22618 = x_22548 * res_",
                   "22617;\n                        float res_22619 = nextpayment_22558 + res_22618;\n                        float y_22620 = res_22619 - res_22534;\n                        float negate_arg_22621 = a_19763 * y_22620;\n                        float exp_arg_22622 = 0.0F - negate_arg_22621;\n                        float res_22623 = fpow32(2.7182817F, exp_arg_22622);\n                        float x_22624 = 1.0F - res_22623;\n                        float B_22625 = x_22624 / a_19763;\n                        float x_22626 = B_22625 - res_22619;\n                        float x_22627 = res_22534 + x_22626;\n                        float x_22628 = y_22575 * x_22627;\n                        float A1_22629 = x_22628 / x_22571;\n                        float y_22630 = fpow32(B_22625, 2.0F);\n                        float x_22631 = x_22573 * y_22630;\n                        float A2_22632 = x_22631 / y_22580;\n                        float exp_arg_22633 = A1_22629 - A2_22632;\n                        float res_22634 = fpow32(2.7182817F, exp_arg_22633);\n                        float negate_arg_22635 = x_22539 * B_22625;\n                        float exp_arg_22636 = 0.0F - negate_arg_22635;\n                        float res_22637 = fpow32(2.7182817F, exp_arg_22636);\n                        float res_22638 = res_22634 * res_22637;\n                        float res_22615 = res_22638 + redout_27093;\n                        float redout_tmp_27413 = res_22615;\n                        \n                        redout_27093 = redout_tmp_27413;\n                    }\n                    res_22612 = redout_27093;\n                    \n                    float x_22639 = res_22587 - res_22611;\n                    float x_22640 = x_22545 * x_22548;\n                    float y_22641 = res_22612 * x_22640;\n                    float y_22642 = x_22639 - y_22641;\n                    float res_22643 = x_22546 * y_22642;\n                    float res_22644 = x_22546 * res_22643;\n                    \n              ",
                   "      res_22557 = res_22644;\n                }\n                \n                float res_22544 = res_22557 + redout_27155;\n                float redout_tmp_27412 = res_22544;\n                \n                redout_27155 = redout_tmp_27412;\n            }\n            res_22541 = redout_27155;\n            \n            float res_22645 = fmax32(0.0F, res_22541);\n            float res_22538 = res_22645 + redout_27153;\n            float redout_tmp_27411 = res_22538;\n            \n            redout_27153 = redout_tmp_27411;\n        }\n        res_22535 = redout_27153;\n        \n        float res_22646 = res_22535 / res_19930;\n        float negate_arg_22647 = a_19763 * res_22534;\n        float exp_arg_22648 = 0.0F - negate_arg_22647;\n        float res_22649 = fpow32(2.7182817F, exp_arg_22648);\n        float x_22650 = 1.0F - res_22649;\n        float B_22651 = x_22650 / a_19763;\n        float x_22652 = B_22651 - res_22534;\n        float x_22653 = y_19787 * x_22652;\n        float A1_22654 = x_22653 / x_19783;\n        float y_22655 = fpow32(B_22651, 2.0F);\n        float x_22656 = x_19785 * y_22655;\n        float A2_22657 = x_22656 / y_19788;\n        float exp_arg_22658 = A1_22654 - A2_22657;\n        float res_22659 = fpow32(2.7182817F, exp_arg_22658);\n        float negate_arg_22660 = 5.0e-2F * B_22651;\n        float exp_arg_22661 = 0.0F - negate_arg_22660;\n        float res_22662 = fpow32(2.7182817F, exp_arg_22661);\n        float res_22663 = res_22659 * res_22662;\n        float res_22664 = res_22646 * res_22663;\n        \n        ((__global float *) mem_27234)[gtid_21766] = res_22664;\n        ((__global float *) mem_27236)[gtid_21766] = res_22646;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_22526\n}\n__kernel void mainzisegmap_22192(__global int *global_failure,\n                                 int64_t steps_19759, float a_19763,\n                                 float x_19783, float x_19785, float y_19787,\n                                 float y_19788, float si",
                   "ms_per_year_19853,\n                                 float res_19930, __global\n                                 unsigned char *mem_27245, __global\n                                 unsigned char *mem_27248, __global\n                                 unsigned char *mem_27250)\n{\n    #define segmap_group_sizze_22930 (mainzisegmap_group_sizze_22194)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27490;\n    int32_t local_tid_27491;\n    int64_t group_sizze_27494;\n    int32_t wave_sizze_27493;\n    int32_t group_tid_27492;\n    \n    global_tid_27490 = get_global_id(0);\n    local_tid_27491 = get_local_id(0);\n    group_sizze_27494 = get_local_size(0);\n    wave_sizze_27493 = LOCKSTEP_WIDTH;\n    group_tid_27492 = get_group_id(0);\n    \n    int32_t phys_tid_22192;\n    \n    phys_tid_22192 = global_tid_27490;\n    \n    int64_t gtid_22191;\n    \n    gtid_22191 = sext_i32_i64(group_tid_27492) * segmap_group_sizze_22930 +\n        sext_i32_i64(local_tid_27491);\n    if (slt64(gtid_22191, steps_19759)) {\n        int64_t convop_x_27114 = add64(1, gtid_22191);\n        float binop_x_27115 = sitofp_i64_f32(convop_x_27114);\n        float index_primexp_27116 = binop_x_27115 / sims_per_year_19853;\n        float res_22935 = ((__global float *) mem_27245)[gtid_22191];\n        float res_22936 = res_22935 / res_19930;\n        float negate_arg_22937 = a_19763 * index_primexp_27116;\n        float exp_arg_22938 = 0.0F - negate_arg_22937;\n        float res_22939 = fpow32(2.7182817F, exp_arg_22938);\n        float x_22940 = 1.0F - res_22939;\n        float B_22941 = x_22940 / a_19763;\n        float x_22942 = B_22941 - index_primexp_27116;\n        float x_22943 = y_19787 * x_22942;\n        float A1_22944 = x_22943 / x_19783;\n        float y_22945 = fpow32(B_22941, 2.0F);\n        float x_22946 = x_19785 * y_22945;\n        float A2_22947 = x_22946 / y_19788;\n        float exp_arg_22948 = A",
                   "1_22944 - A2_22947;\n        float res_22949 = fpow32(2.7182817F, exp_arg_22948);\n        float negate_arg_22950 = 5.0e-2F * B_22941;\n        float exp_arg_22951 = 0.0F - negate_arg_22950;\n        float res_22952 = fpow32(2.7182817F, exp_arg_22951);\n        float res_22953 = res_22949 * res_22952;\n        float res_22954 = res_22936 * res_22953;\n        \n        ((__global float *) mem_27248)[gtid_22191] = res_22954;\n        ((__global float *) mem_27250)[gtid_22191] = res_22936;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_22930\n}\n__kernel void mainzisegmap_intragroup_21765(__global int *global_failure,\n                                            int failure_is_an_option, __global\n                                            int64_t *global_failure_args,\n                                            __local volatile\n                                            int64_t *red_arr_mem_27420_backing_aligned_0,\n                                            int64_t n_19755,\n                                            int64_t paths_19758, float a_19763,\n                                            float b_19764, float sigma_19765,\n                                            float x_19783, float x_19785,\n                                            float y_19787, float y_19788,\n                                            float sims_per_year_19853,\n                                            float res_19930, __global\n                                            unsigned char *res_mem_27195,\n                                            __global\n                                            unsigned char *res_mem_27196,\n                                            __global\n                                            unsigned char *res_mem_27197,\n                                            __global\n                                            unsigned char *res_mem_27198,\n                                            __global unsigned char *mem_27226,\n                        ",
                   "                    __global unsigned char *mem_27240,\n                                            __global unsigned char *mem_27242)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27420_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_27420_backing_aligned_0;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27414;\n    int32_t local_tid_27415;\n    int64_t group_sizze_27418;\n    int32_t wave_sizze_27417;\n    int32_t group_tid_27416;\n    \n    global_tid_27414 = get_global_id(0);\n    local_tid_27415 = get_local_id(0);\n    group_sizze_27418 = get_local_size(0);\n    wave_sizze_27417 = LOCKSTEP_WIDTH;\n    group_tid_27416 = get_group_id(0);\n    \n    int32_t phys_tid_21765;\n    \n    phys_tid_21765 = group_tid_27416;\n    \n    int32_t ltid_pre_27419;\n    \n    ltid_pre_27419 = local_tid_27415;\n    \n    int64_t gtid_21760;\n    \n    gtid_21760 = sext_i32_i64(group_tid_27416);\n    \n    int64_t index_primexp_27104;\n    \n    index_primexp_27104 = add64(1, gtid_21760);\n    \n    float res_22672 = sitofp_i64_f32(index_primexp_27104);\n    float res_22673 = res_22672 / sims_per_year_19853;\n    float res_22674;\n    int64_t gtid_21763 = sext_i32_i64(ltid_pre_27419);\n    int32_t phys_tid_21764 = local_tid_27415;\n    __local char *red_arr_mem_27420;\n    \n    red_arr_mem_27420 = (__local char *) red_arr_mem_27420_backing_0;\n    if (slt64(gtid_21763, paths_19758)) {\n        float x_22678 = ((__global float *) mem_27226)[gtid_21760 *\n                                                       paths_19758 +\n                                                       gtid_21763];\n        float res_22680;\n        float redout_27157 = 0.0F;\n        \n ",
                   "       for (int64_t i_27158 = 0; i_27158 < n_19755; i_27158++) {\n            int64_t x_22686 = ((__global int64_t *) res_mem_27197)[i_27158];\n            float x_22687 = ((__global float *) res_mem_27198)[i_27158];\n            int64_t i64_arg_22688 = sub64(x_22686, 1);\n            float res_22689 = sitofp_i64_f32(i64_arg_22688);\n            float y_22690 = x_22687 * res_22689;\n            bool cond_22691 = y_22690 < res_22673;\n            float ceil_arg_22692 = res_22673 / x_22687;\n            float res_22693;\n            \n            res_22693 = futrts_ceil32(ceil_arg_22692);\n            \n            int64_t res_22694 = fptosi_f32_i64(res_22693);\n            int64_t remaining_22695 = sub64(x_22686, res_22694);\n            float res_22696;\n            \n            if (cond_22691) {\n                res_22696 = 0.0F;\n            } else {\n                float x_22684 = ((__global float *) res_mem_27195)[i_27158];\n                float x_22685 = ((__global float *) res_mem_27196)[i_27158];\n                float nextpayment_22697 = x_22687 * res_22693;\n                bool bounds_invalid_upwards_22698 = slt64(remaining_22695, 1);\n                bool valid_22699 = !bounds_invalid_upwards_22698;\n                bool range_valid_c_22700;\n                \n                if (!valid_22699) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 10) ==\n                            -1) {\n                            global_failure_args[0] = 1;\n                            global_failure_args[1] = 2;\n                            global_failure_args[2] = remaining_22695;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float y_22702 = nextpayment_22697 - res_22673;\n                float negate_arg_22703 = a_19763 * y_22702;\n                float exp_arg_22704 = 0.0F - negate_arg_",
                   "22703;\n                float res_22705 = fpow32(2.7182817F, exp_arg_22704);\n                float x_22706 = 1.0F - res_22705;\n                float B_22707 = x_22706 / a_19763;\n                float x_22708 = B_22707 - nextpayment_22697;\n                float x_22709 = res_22673 + x_22708;\n                float x_22710 = fpow32(a_19763, 2.0F);\n                float x_22711 = b_19764 * x_22710;\n                float x_22712 = fpow32(sigma_19765, 2.0F);\n                float y_22713 = x_22712 / 2.0F;\n                float y_22714 = x_22711 - y_22713;\n                float x_22715 = x_22709 * y_22714;\n                float A1_22716 = x_22715 / x_22710;\n                float y_22717 = fpow32(B_22707, 2.0F);\n                float x_22718 = x_22712 * y_22717;\n                float y_22719 = 4.0F * a_19763;\n                float A2_22720 = x_22718 / y_22719;\n                float exp_arg_22721 = A1_22716 - A2_22720;\n                float res_22722 = fpow32(2.7182817F, exp_arg_22721);\n                float negate_arg_22723 = x_22678 * B_22707;\n                float exp_arg_22724 = 0.0F - negate_arg_22723;\n                float res_22725 = fpow32(2.7182817F, exp_arg_22724);\n                float res_22726 = res_22722 * res_22725;\n                bool y_22727 = slt64(0, remaining_22695);\n                bool index_certs_22728;\n                \n                if (!y_22727) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 11) ==\n                            -1) {\n                            global_failure_args[0] = 0;\n                            global_failure_args[1] = remaining_22695;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float binop_y_22729 = sitofp_i64_f32(remaining_22695);\n                float binop_y_22730 = x_22687 * binop_y_22729;\n                fl",
                   "oat index_primexp_22731 = nextpayment_22697 + binop_y_22730;\n                float y_22732 = index_primexp_22731 - res_22673;\n                float negate_arg_22733 = a_19763 * y_22732;\n                float exp_arg_22734 = 0.0F - negate_arg_22733;\n                float res_22735 = fpow32(2.7182817F, exp_arg_22734);\n                float x_22736 = 1.0F - res_22735;\n                float B_22737 = x_22736 / a_19763;\n                float x_22738 = B_22737 - index_primexp_22731;\n                float x_22739 = res_22673 + x_22738;\n                float x_22740 = y_22714 * x_22739;\n                float A1_22741 = x_22740 / x_22710;\n                float y_22742 = fpow32(B_22737, 2.0F);\n                float x_22743 = x_22712 * y_22742;\n                float A2_22744 = x_22743 / y_22719;\n                float exp_arg_22745 = A1_22741 - A2_22744;\n                float res_22746 = fpow32(2.7182817F, exp_arg_22745);\n                float negate_arg_22747 = x_22678 * B_22737;\n                float exp_arg_22748 = 0.0F - negate_arg_22747;\n                float res_22749 = fpow32(2.7182817F, exp_arg_22748);\n                float res_22750 = res_22746 * res_22749;\n                float res_22751;\n                float redout_27097 = 0.0F;\n                \n                for (int64_t i_27098 = 0; i_27098 < remaining_22695;\n                     i_27098++) {\n                    int64_t index_primexp_27132 = add64(1, i_27098);\n                    float res_22756 = sitofp_i64_f32(index_primexp_27132);\n                    float res_22757 = x_22687 * res_22756;\n                    float res_22758 = nextpayment_22697 + res_22757;\n                    float y_22759 = res_22758 - res_22673;\n                    float negate_arg_22760 = a_19763 * y_22759;\n                    float exp_arg_22761 = 0.0F - negate_arg_22760;\n                    float res_22762 = fpow32(2.7182817F, exp_arg_22761);\n                    float x_22763 = 1.0F - res_22762;\n                    float B_22764 = x_2276",
                   "3 / a_19763;\n                    float x_22765 = B_22764 - res_22758;\n                    float x_22766 = res_22673 + x_22765;\n                    float x_22767 = y_22714 * x_22766;\n                    float A1_22768 = x_22767 / x_22710;\n                    float y_22769 = fpow32(B_22764, 2.0F);\n                    float x_22770 = x_22712 * y_22769;\n                    float A2_22771 = x_22770 / y_22719;\n                    float exp_arg_22772 = A1_22768 - A2_22771;\n                    float res_22773 = fpow32(2.7182817F, exp_arg_22772);\n                    float negate_arg_22774 = x_22678 * B_22764;\n                    float exp_arg_22775 = 0.0F - negate_arg_22774;\n                    float res_22776 = fpow32(2.7182817F, exp_arg_22775);\n                    float res_22777 = res_22773 * res_22776;\n                    float res_22754 = res_22777 + redout_27097;\n                    float redout_tmp_27423 = res_22754;\n                    \n                    redout_27097 = redout_tmp_27423;\n                }\n                res_22751 = redout_27097;\n                \n                float x_22778 = res_22726 - res_22750;\n                float x_22779 = x_22684 * x_22687;\n                float y_22780 = res_22751 * x_22779;\n                float y_22781 = x_22778 - y_22780;\n                float res_22782 = x_22685 * y_22781;\n                float res_22783 = x_22685 * res_22782;\n                \n                res_22696 = res_22783;\n            }\n            \n            float res_22683 = res_22696 + redout_27157;\n            float redout_tmp_27422 = res_22683;\n            \n            redout_27157 = redout_tmp_27422;\n        }\n        res_22680 = redout_27157;\n        \n        float res_22784 = fmax32(0.0F, res_22680);\n        \n        ((__local float *) red_arr_mem_27420)[gtid_21763] = res_22784;\n    }\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_27424;\n    int32_t s",
                   "kip_waves_27425;\n    \n    skip_waves_27425 = 1;\n    \n    float x_22675;\n    float x_22676;\n    \n    offset_27424 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_27415, sext_i64_i32(paths_19758))) {\n            x_22675 = ((__local\n                        float *) red_arr_mem_27420)[sext_i32_i64(local_tid_27415 +\n                                                    offset_27424)];\n        }\n    }\n    offset_27424 = 1;\n    while (slt32(offset_27424, wave_sizze_27417)) {\n        if (slt32(local_tid_27415 + offset_27424, sext_i64_i32(paths_19758)) &&\n            ((local_tid_27415 - squot32(local_tid_27415, wave_sizze_27417) *\n              wave_sizze_27417) & (2 * offset_27424 - 1)) == 0) {\n            // read array element\n            {\n                x_22676 = ((volatile __local\n                            float *) red_arr_mem_27420)[sext_i32_i64(local_tid_27415 +\n                                                        offset_27424)];\n            }\n            // apply reduction operation\n            {\n                float res_22677 = x_22675 + x_22676;\n                \n                x_22675 = res_22677;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_27420)[sext_i32_i64(local_tid_27415)] =\n                    x_22675;\n            }\n        }\n        offset_27424 *= 2;\n    }\n    while (slt32(skip_waves_27425, squot32(sext_i64_i32(paths_19758) +\n                                           wave_sizze_27417 - 1,\n                                           wave_sizze_27417))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_27424 = skip_waves_27425 * wave_sizze_27417;\n        if (slt32(local_tid_27415 + offset_27424, sext_i64_i32(paths_19758)) &&\n            ((local_tid_27415 - squot32(local_tid_27415, wave_sizze_27417) *\n              wave_sizze_27417) == 0 && (squot32(local_tid_27415,\n                                          ",
                   "       wave_sizze_27417) & (2 *\n                                                                      skip_waves_27425 -\n                                                                      1)) ==\n             0)) {\n            // read array element\n            {\n                x_22676 = ((__local\n                            float *) red_arr_mem_27420)[sext_i32_i64(local_tid_27415 +\n                                                        offset_27424)];\n            }\n            // apply reduction operation\n            {\n                float res_22677 = x_22675 + x_22676;\n                \n                x_22675 = res_22677;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_27420)[sext_i32_i64(local_tid_27415)] =\n                    x_22675;\n            }\n        }\n        skip_waves_27425 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    res_22674 = ((__local float *) red_arr_mem_27420)[0];\n    \n    float res_22785 = res_22674 / res_19930;\n    float negate_arg_22786 = a_19763 * res_22673;\n    float exp_arg_22787 = 0.0F - negate_arg_22786;\n    float res_22788 = fpow32(2.7182817F, exp_arg_22787);\n    float x_22789 = 1.0F - res_22788;\n    float B_22790 = x_22789 / a_19763;\n    float x_22791 = B_22790 - res_22673;\n    float x_22792 = y_19787 * x_22791;\n    float A1_22793 = x_22792 / x_19783;\n    float y_22794 = fpow32(B_22790, 2.0F);\n    float x_22795 = x_19785 * y_22794;\n    float A2_22796 = x_22795 / y_19788;\n    float exp_arg_22797 = A1_22793 - A2_22796;\n    float res_22798 = fpow32(2.7182817F, exp_arg_22797);\n    float negate_arg_22799 = 5.0e-2F * B_22790;\n    float exp_arg_22800 = 0.0F - negate_arg_22799;\n    float res_22801 = fpow32(2.7182817F, exp_arg_22800);\n    float res_22802 = res_22798 * res_22801;\n    float res_22803 = res_22785 * res_22802;\n    \n    if (local_tid_27415 == 0) {\n        ((__global float *) mem_27240)[gtid_21760] = res_22803;\n    }\n    if (local_tid_27415 ",
                   "== 0) {\n        ((__global float *) mem_27242)[gtid_21760] = res_22785;\n    }\n    \n  error_2:\n    return;\n}\n__kernel void mainzisegred_large_22227(__global int *global_failure,\n                                       int failure_is_an_option, __global\n                                       int64_t *global_failure_args,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_27465_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_27463_backing_aligned_1,\n                                       int64_t n_19755, int64_t paths_19758,\n                                       float a_19763, float b_19764,\n                                       float sigma_19765,\n                                       float sims_per_year_19853,\n                                       int64_t num_groups_22814, __global\n                                       unsigned char *res_mem_27195, __global\n                                       unsigned char *res_mem_27196, __global\n                                       unsigned char *res_mem_27197, __global\n                                       unsigned char *res_mem_27198, __global\n                                       unsigned char *mem_27226, __global\n                                       unsigned char *mem_27245,\n                                       int64_t groups_per_segment_27449,\n                                       int64_t elements_per_thread_27450,\n                                       int64_t virt_num_groups_27451,\n                                       int64_t threads_per_segment_27453,\n                                       __global\n                                       unsigned char *group_res_arr_mem_27454,\n                                       __global\n                                       unsigned char *mainzicounter_mem_27456)\n{\n    #define segred_group_sizze_22813 (mainzisegred_grou",
                   "p_sizze_22221)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_27465_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_27465_backing_aligned_0;\n    __local volatile char *restrict red_arr_mem_27463_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_27463_backing_aligned_1;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27458;\n    int32_t local_tid_27459;\n    int64_t group_sizze_27462;\n    int32_t wave_sizze_27461;\n    int32_t group_tid_27460;\n    \n    global_tid_27458 = get_global_id(0);\n    local_tid_27459 = get_local_id(0);\n    group_sizze_27462 = get_local_size(0);\n    wave_sizze_27461 = LOCKSTEP_WIDTH;\n    group_tid_27460 = get_group_id(0);\n    \n    int32_t phys_tid_22227;\n    \n    phys_tid_22227 = global_tid_27458;\n    \n    __local char *red_arr_mem_27463;\n    \n    red_arr_mem_27463 = (__local char *) red_arr_mem_27463_backing_0;\n    \n    __local char *sync_arr_mem_27465;\n    \n    sync_arr_mem_27465 = (__local char *) sync_arr_mem_27465_backing_1;\n    \n    int32_t phys_group_id_27467;\n    \n    phys_group_id_27467 = get_group_id(0);\n    for (int32_t i_27468 = 0; i_27468 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_27451) - phys_group_id_27467,\n                   sext_i64_i32(num_groups_22814)); i_27468++) {\n        int32_t virt_group_id_27469 = phys_group_id_27467 + i_27468 *\n                sext_i64_i32(num_groups_22814);\n        int32_t flat_segment_id_27470 = squot32(virt_group_id_27469,\n                                                sext_i64_i32(groups_per_segment_27449));\n        int64_t global_tid_27471 = srem64(sext_i32_i64(virt_group_id",
                   "_27469) *\n                                          segred_group_sizze_22813 +\n                                          sext_i32_i64(local_tid_27459),\n                                          segred_group_sizze_22813 *\n                                          groups_per_segment_27449);\n        int64_t gtid_22218 = sext_i32_i64(flat_segment_id_27470);\n        int64_t gtid_22226;\n        float x_acc_27472;\n        int64_t chunk_sizze_27473;\n        \n        chunk_sizze_27473 = smin64(elements_per_thread_27450,\n                                   sdiv_up64(paths_19758 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_27471)),\n                                             threads_per_segment_27453));\n        \n        float x_22817;\n        float x_22818;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_27472 = 0.0F;\n        }\n        for (int64_t i_27477 = 0; i_27477 < chunk_sizze_27473; i_27477++) {\n            gtid_22226 = sext_i32_i64(sext_i64_i32(global_tid_27471)) +\n                threads_per_segment_27453 * i_27477;\n            // apply map function\n            {\n                float x_22822 = ((__global float *) mem_27226)[gtid_22218 *\n                                                               paths_19758 +\n                                                               gtid_22226];\n                int64_t convop_x_27110 = add64(1, gtid_22218);\n                float binop_x_27111 = sitofp_i64_f32(convop_x_27110);\n                float index_primexp_27112 = binop_x_27111 / sims_per_year_19853;\n                float res_22824;\n                float redout_27159 = 0.0F;\n                \n                for (int64_t i_27160 = 0; i_27160 < n_19755; i_27160++) {\n                    int64_t x_22830 = ((__global\n                                        int64_t *) res_mem_27197)[i_27160];\n                    float x_22831 = ((__global float *) res_mem_27198)[i_27160];\n                    int64_t i64",
                   "_arg_22832 = sub64(x_22830, 1);\n                    float res_22833 = sitofp_i64_f32(i64_arg_22832);\n                    float y_22834 = x_22831 * res_22833;\n                    bool cond_22835 = y_22834 < index_primexp_27112;\n                    float ceil_arg_22836 = index_primexp_27112 / x_22831;\n                    float res_22837;\n                    \n                    res_22837 = futrts_ceil32(ceil_arg_22836);\n                    \n                    int64_t res_22838 = fptosi_f32_i64(res_22837);\n                    int64_t remaining_22839 = sub64(x_22830, res_22838);\n                    float res_22840;\n                    \n                    if (cond_22835) {\n                        res_22840 = 0.0F;\n                    } else {\n                        float x_22828 = ((__global\n                                          float *) res_mem_27195)[i_27160];\n                        float x_22829 = ((__global\n                                          float *) res_mem_27196)[i_27160];\n                        float nextpayment_22841 = x_22831 * res_22837;\n                        bool bounds_invalid_upwards_22842 =\n                             slt64(remaining_22839, 1);\n                        bool valid_22843 = !bounds_invalid_upwards_22842;\n                        bool range_valid_c_22844;\n                        \n                        if (!valid_22843) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 14) == -1) {\n                                    global_failure_args[0] = 1;\n                                    global_failure_args[1] = 2;\n                                    global_failure_args[2] = remaining_22839;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                     ",
                   "   }\n                        \n                        float y_22846 = nextpayment_22841 - index_primexp_27112;\n                        float negate_arg_22847 = a_19763 * y_22846;\n                        float exp_arg_22848 = 0.0F - negate_arg_22847;\n                        float res_22849 = fpow32(2.7182817F, exp_arg_22848);\n                        float x_22850 = 1.0F - res_22849;\n                        float B_22851 = x_22850 / a_19763;\n                        float x_22852 = B_22851 - nextpayment_22841;\n                        float x_22853 = x_22852 + index_primexp_27112;\n                        float x_22854 = fpow32(a_19763, 2.0F);\n                        float x_22855 = b_19764 * x_22854;\n                        float x_22856 = fpow32(sigma_19765, 2.0F);\n                        float y_22857 = x_22856 / 2.0F;\n                        float y_22858 = x_22855 - y_22857;\n                        float x_22859 = x_22853 * y_22858;\n                        float A1_22860 = x_22859 / x_22854;\n                        float y_22861 = fpow32(B_22851, 2.0F);\n                        float x_22862 = x_22856 * y_22861;\n                        float y_22863 = 4.0F * a_19763;\n                        float A2_22864 = x_22862 / y_22863;\n                        float exp_arg_22865 = A1_22860 - A2_22864;\n                        float res_22866 = fpow32(2.7182817F, exp_arg_22865);\n                        float negate_arg_22867 = x_22822 * B_22851;\n                        float exp_arg_22868 = 0.0F - negate_arg_22867;\n                        float res_22869 = fpow32(2.7182817F, exp_arg_22868);\n                        float res_22870 = res_22866 * res_22869;\n                        bool y_22871 = slt64(0, remaining_22839);\n                        bool index_certs_22872;\n                        \n                        if (!y_22871) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                           ",
                   "                   -1, 15) == -1) {\n                                    global_failure_args[0] = 0;\n                                    global_failure_args[1] = remaining_22839;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float binop_y_22873 = sitofp_i64_f32(remaining_22839);\n                        float binop_y_22874 = x_22831 * binop_y_22873;\n                        float index_primexp_22875 = nextpayment_22841 +\n                              binop_y_22874;\n                        float y_22876 = index_primexp_22875 -\n                              index_primexp_27112;\n                        float negate_arg_22877 = a_19763 * y_22876;\n                        float exp_arg_22878 = 0.0F - negate_arg_22877;\n                        float res_22879 = fpow32(2.7182817F, exp_arg_22878);\n                        float x_22880 = 1.0F - res_22879;\n                        float B_22881 = x_22880 / a_19763;\n                        float x_22882 = B_22881 - index_primexp_22875;\n                        float x_22883 = x_22882 + index_primexp_27112;\n                        float x_22884 = y_22858 * x_22883;\n                        float A1_22885 = x_22884 / x_22854;\n                        float y_22886 = fpow32(B_22881, 2.0F);\n                        float x_22887 = x_22856 * y_22886;\n                        float A2_22888 = x_22887 / y_22863;\n                        float exp_arg_22889 = A1_22885 - A2_22888;\n                        float res_22890 = fpow32(2.7182817F, exp_arg_22889);\n                        float negate_arg_22891 = x_22822 * B_22881;\n                        float exp_arg_22892 = 0.0F - negate_arg_22891;\n                        float res_22893 = fpow32(2.7182817F, exp_arg_22892);\n                        float res_22894 = res_22890 *",
                   " res_22893;\n                        float res_22895;\n                        float redout_27107 = 0.0F;\n                        \n                        for (int64_t i_27108 = 0; i_27108 < remaining_22839;\n                             i_27108++) {\n                            int64_t index_primexp_27134 = add64(1, i_27108);\n                            float res_22900 =\n                                  sitofp_i64_f32(index_primexp_27134);\n                            float res_22901 = x_22831 * res_22900;\n                            float res_22902 = nextpayment_22841 + res_22901;\n                            float y_22903 = res_22902 - index_primexp_27112;\n                            float negate_arg_22904 = a_19763 * y_22903;\n                            float exp_arg_22905 = 0.0F - negate_arg_22904;\n                            float res_22906 = fpow32(2.7182817F, exp_arg_22905);\n                            float x_22907 = 1.0F - res_22906;\n                            float B_22908 = x_22907 / a_19763;\n                            float x_22909 = B_22908 - res_22902;\n                            float x_22910 = x_22909 + index_primexp_27112;\n                            float x_22911 = y_22858 * x_22910;\n                            float A1_22912 = x_22911 / x_22854;\n                            float y_22913 = fpow32(B_22908, 2.0F);\n                            float x_22914 = x_22856 * y_22913;\n                            float A2_22915 = x_22914 / y_22863;\n                            float exp_arg_22916 = A1_22912 - A2_22915;\n                            float res_22917 = fpow32(2.7182817F, exp_arg_22916);\n                            float negate_arg_22918 = x_22822 * B_22908;\n                            float exp_arg_22919 = 0.0F - negate_arg_22918;\n                            float res_22920 = fpow32(2.7182817F, exp_arg_22919);\n                            float res_22921 = res_22917 * res_22920;\n                            float res_22898 = res_22921 + redout_27107;\n  ",
                   "                          float redout_tmp_27479 = res_22898;\n                            \n                            redout_27107 = redout_tmp_27479;\n                        }\n                        res_22895 = redout_27107;\n                        \n                        float x_22922 = res_22870 - res_22894;\n                        float x_22923 = x_22828 * x_22831;\n                        float y_22924 = res_22895 * x_22923;\n                        float y_22925 = x_22922 - y_22924;\n                        float res_22926 = x_22829 * y_22925;\n                        float res_22927 = x_22829 * res_22926;\n                        \n                        res_22840 = res_22927;\n                    }\n                    \n                    float res_22827 = res_22840 + redout_27159;\n                    float redout_tmp_27478 = res_22827;\n                    \n                    redout_27159 = redout_tmp_27478;\n                }\n                res_22824 = redout_27159;\n                \n                float res_22928 = fmax32(0.0F, res_22824);\n                \n                // save map-out results\n                { }\n                // load accumulator\n                {\n                    x_22817 = x_acc_27472;\n                }\n                // load new values\n                {\n                    x_22818 = res_22928;\n                }\n                // apply reduction operator\n                {\n                    float res_22819 = x_22817 + x_22818;\n                    \n                    // store in accumulator\n                    {\n                        x_acc_27472 = res_22819;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_22817 = x_acc_27472;\n            ((__local\n              float *) red_arr_mem_27463)[sext_i32_i64(local_tid_27459)] =\n                x_22817;\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n     ",
                   "   if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_27480;\n        int32_t skip_waves_27481;\n        \n        skip_waves_27481 = 1;\n        \n        float x_27474;\n        float x_27475;\n        \n        offset_27480 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_27459,\n                      sext_i64_i32(segred_group_sizze_22813))) {\n                x_27474 = ((__local\n                            float *) red_arr_mem_27463)[sext_i32_i64(local_tid_27459 +\n                                                        offset_27480)];\n            }\n        }\n        offset_27480 = 1;\n        while (slt32(offset_27480, wave_sizze_27461)) {\n            if (slt32(local_tid_27459 + offset_27480,\n                      sext_i64_i32(segred_group_sizze_22813)) &&\n                ((local_tid_27459 - squot32(local_tid_27459, wave_sizze_27461) *\n                  wave_sizze_27461) & (2 * offset_27480 - 1)) == 0) {\n                // read array element\n                {\n                    x_27475 = ((volatile __local\n                                float *) red_arr_mem_27463)[sext_i32_i64(local_tid_27459 +\n                                                            offset_27480)];\n                }\n                // apply reduction operation\n                {\n                    float res_27476 = x_27474 + x_27475;\n                    \n                    x_27474 = res_27476;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      float *) red_arr_mem_27463)[sext_i32_i64(local_tid_27459)] =\n                        x_27474;\n                }\n            }\n            offset_27480 *= 2;\n        }\n        while (slt32(skip_waves_27481,\n                     squot32(sext_i64_i32(segred_group_sizze_22813) +\n                             wave_sizze_27461 - 1, wave_sizze_27461))) {\n            ",
                   "barrier(CLK_LOCAL_MEM_FENCE);\n            offset_27480 = skip_waves_27481 * wave_sizze_27461;\n            if (slt32(local_tid_27459 + offset_27480,\n                      sext_i64_i32(segred_group_sizze_22813)) &&\n                ((local_tid_27459 - squot32(local_tid_27459, wave_sizze_27461) *\n                  wave_sizze_27461) == 0 && (squot32(local_tid_27459,\n                                                     wave_sizze_27461) & (2 *\n                                                                          skip_waves_27481 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_27475 = ((__local\n                                float *) red_arr_mem_27463)[sext_i32_i64(local_tid_27459 +\n                                                            offset_27480)];\n                }\n                // apply reduction operation\n                {\n                    float res_27476 = x_27474 + x_27475;\n                    \n                    x_27474 = res_27476;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      float *) red_arr_mem_27463)[sext_i32_i64(local_tid_27459)] =\n                        x_27474;\n                }\n            }\n            skip_waves_27481 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_27459) == 0) {\n                x_acc_27472 = x_27474;\n            }\n        }\n        if (groups_per_segment_27449 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_27459 == 0) {\n                    ((__global float *) mem_27245)[gtid_22218] = x_acc_27472;\n                }\n            }\n        } else {\n            int32_t old_counter_27482;\n            \n            // first thre",
                   "ad in group saves group result to global memory\n            {\n                if (local_tid_27459 == 0) {\n                    ((__global\n                      float *) group_res_arr_mem_27454)[sext_i32_i64(virt_group_id_27469) *\n                                                        segred_group_sizze_22813] =\n                        x_acc_27472;\n                    mem_fence_global();\n                    old_counter_27482 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_27456)[sext_i32_i64(srem32(flat_segment_id_27470,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_27465)[0] =\n                        old_counter_27482 == groups_per_segment_27449 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_27483;\n            \n            is_last_group_27483 = ((__local bool *) sync_arr_mem_27465)[0];\n            if (is_last_group_27483) {\n                if (local_tid_27459 == 0) {\n                    old_counter_27482 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_27456)[sext_i32_i64(srem32(flat_segment_id_27470,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_27449));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_27484 =\n                            sdiv_up64(groups_per_segment_27449,\n                                      segred_group_sizze_22813);\n        ",
                   "            \n                    x_22817 = 0.0F;\n                    for (int64_t i_27485 = 0; i_27485 < read_per_thread_27484;\n                         i_27485++) {\n                        int64_t group_res_id_27486 =\n                                sext_i32_i64(local_tid_27459) *\n                                read_per_thread_27484 + i_27485;\n                        int64_t index_of_group_res_27487 =\n                                sext_i32_i64(flat_segment_id_27470) *\n                                groups_per_segment_27449 + group_res_id_27486;\n                        \n                        if (slt64(group_res_id_27486,\n                                  groups_per_segment_27449)) {\n                            x_22818 = ((__global\n                                        float *) group_res_arr_mem_27454)[index_of_group_res_27487 *\n                                                                          segred_group_sizze_22813];\n                            \n                            float res_22819;\n                            \n                            res_22819 = x_22817 + x_22818;\n                            x_22817 = res_22819;\n                        }\n                    }\n                }\n                ((__local\n                  float *) red_arr_mem_27463)[sext_i32_i64(local_tid_27459)] =\n                    x_22817;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_27488;\n                    int32_t skip_waves_27489;\n                    \n                    skip_waves_27489 = 1;\n                    \n                    float x_27474;\n                    float x_27475;\n                    \n                    offset_27488 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_27459,\n                                  sext_i64_i32(segred_group_sizze_22813))) {\n       ",
                   "                     x_27474 = ((__local\n                                        float *) red_arr_mem_27463)[sext_i32_i64(local_tid_27459 +\n                                                                    offset_27488)];\n                        }\n                    }\n                    offset_27488 = 1;\n                    while (slt32(offset_27488, wave_sizze_27461)) {\n                        if (slt32(local_tid_27459 + offset_27488,\n                                  sext_i64_i32(segred_group_sizze_22813)) &&\n                            ((local_tid_27459 - squot32(local_tid_27459,\n                                                        wave_sizze_27461) *\n                              wave_sizze_27461) & (2 * offset_27488 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_27475 = ((volatile __local\n                                            float *) red_arr_mem_27463)[sext_i32_i64(local_tid_27459 +\n                                                                        offset_27488)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_27476 = x_27474 + x_27475;\n                                \n                                x_27474 = res_27476;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_27463)[sext_i32_i64(local_tid_27459)] =\n                                    x_27474;\n                            }\n                        }\n                        offset_27488 *= 2;\n                    }\n                    while (slt32(skip_waves_27489,\n                                 squot32(sext_i64_i32(segred_group_sizze_22813) +\n                                         wave_sizze_27",
                   "461 - 1,\n                                         wave_sizze_27461))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_27488 = skip_waves_27489 * wave_sizze_27461;\n                        if (slt32(local_tid_27459 + offset_27488,\n                                  sext_i64_i32(segred_group_sizze_22813)) &&\n                            ((local_tid_27459 - squot32(local_tid_27459,\n                                                        wave_sizze_27461) *\n                              wave_sizze_27461) == 0 &&\n                             (squot32(local_tid_27459, wave_sizze_27461) & (2 *\n                                                                            skip_waves_27489 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_27475 = ((__local\n                                            float *) red_arr_mem_27463)[sext_i32_i64(local_tid_27459 +\n                                                                        offset_27488)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_27476 = x_27474 + x_27475;\n                                \n                                x_27474 = res_27476;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  float *) red_arr_mem_27463)[sext_i32_i64(local_tid_27459)] =\n                                    x_27474;\n                            }\n                        }\n                        skip_waves_27489 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_27459 == 0) {\n",
                   "                            ((__global float *) mem_27245)[gtid_22218] =\n                                x_27474;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_22813\n}\n__kernel void mainzisegred_nonseg_20858(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_27317_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_27315_backing_aligned_1,\n                                        int64_t n_19755,\n                                        int64_t num_groups_20853, __global\n                                        unsigned char *swap_term_mem_27171,\n                                        __global\n                                        unsigned char *payments_mem_27172,\n                                        __global unsigned char *mem_27176,\n                                        __global\n                                        unsigned char *mainzicounter_mem_27305,\n                                        __global\n                                        unsigned char *group_res_arr_mem_27307,\n                                        int64_t num_threads_27309)\n{\n    #define segred_group_sizze_20851 (mainzisegred_group_sizze_20850)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27317_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_27317_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_27315_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_27315_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n      ",
                   "  return;\n    \n    int32_t global_tid_27310;\n    int32_t local_tid_27311;\n    int64_t group_sizze_27314;\n    int32_t wave_sizze_27313;\n    int32_t group_tid_27312;\n    \n    global_tid_27310 = get_global_id(0);\n    local_tid_27311 = get_local_id(0);\n    group_sizze_27314 = get_local_size(0);\n    wave_sizze_27313 = LOCKSTEP_WIDTH;\n    group_tid_27312 = get_group_id(0);\n    \n    int32_t phys_tid_20858;\n    \n    phys_tid_20858 = global_tid_27310;\n    \n    __local char *sync_arr_mem_27315;\n    \n    sync_arr_mem_27315 = (__local char *) sync_arr_mem_27315_backing_0;\n    \n    __local char *red_arr_mem_27317;\n    \n    red_arr_mem_27317 = (__local char *) red_arr_mem_27317_backing_1;\n    \n    int64_t dummy_20856;\n    \n    dummy_20856 = 0;\n    \n    int64_t gtid_20857;\n    \n    gtid_20857 = 0;\n    \n    float x_acc_27319;\n    int64_t chunk_sizze_27320;\n    \n    chunk_sizze_27320 = smin64(sdiv_up64(n_19755,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_20851 *\n                                         num_groups_20853))),\n                               sdiv_up64(n_19755 - sext_i32_i64(phys_tid_20858),\n                                         num_threads_27309));\n    \n    float x_19773;\n    float x_19774;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_27319 = -INFINITY;\n    }\n    for (int64_t i_27324 = 0; i_27324 < chunk_sizze_27320; i_27324++) {\n        gtid_20857 = sext_i32_i64(phys_tid_20858) + num_threads_27309 * i_27324;\n        // apply map function\n        {\n            float x_19776 = ((__global\n                              float *) swap_term_mem_27171)[gtid_20857];\n            int64_t x_19777 = ((__global\n                                int64_t *) payments_mem_27172)[gtid_20857];\n            float res_19778 = sitofp_i64_f32(x_19777);\n            float res_19779 = x_19776 * res_19778;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_",
                   "19773 = x_acc_27319;\n            }\n            // load new values\n            {\n                x_19774 = res_19779;\n            }\n            // apply reduction operator\n            {\n                float res_19775 = fmax32(x_19773, x_19774);\n                \n                // store in accumulator\n                {\n                    x_acc_27319 = res_19775;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_19773 = x_acc_27319;\n        ((__local float *) red_arr_mem_27317)[sext_i32_i64(local_tid_27311)] =\n            x_19773;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_27325;\n    int32_t skip_waves_27326;\n    \n    skip_waves_27326 = 1;\n    \n    float x_27321;\n    float x_27322;\n    \n    offset_27325 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_27311, sext_i64_i32(segred_group_sizze_20851))) {\n            x_27321 = ((__local\n                        float *) red_arr_mem_27317)[sext_i32_i64(local_tid_27311 +\n                                                    offset_27325)];\n        }\n    }\n    offset_27325 = 1;\n    while (slt32(offset_27325, wave_sizze_27313)) {\n        if (slt32(local_tid_27311 + offset_27325,\n                  sext_i64_i32(segred_group_sizze_20851)) && ((local_tid_27311 -\n                                                               squot32(local_tid_27311,\n                                                                       wave_sizze_27313) *\n                                                               wave_sizze_27313) &\n                                                              (2 *\n                                                               offset_27325 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_27322 = ((volatile __local\n                            float *) red_arr_mem_27317)[sext_i32_i",
                   "64(local_tid_27311 +\n                                                        offset_27325)];\n            }\n            // apply reduction operation\n            {\n                float res_27323 = fmax32(x_27321, x_27322);\n                \n                x_27321 = res_27323;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_27317)[sext_i32_i64(local_tid_27311)] =\n                    x_27321;\n            }\n        }\n        offset_27325 *= 2;\n    }\n    while (slt32(skip_waves_27326,\n                 squot32(sext_i64_i32(segred_group_sizze_20851) +\n                         wave_sizze_27313 - 1, wave_sizze_27313))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_27325 = skip_waves_27326 * wave_sizze_27313;\n        if (slt32(local_tid_27311 + offset_27325,\n                  sext_i64_i32(segred_group_sizze_20851)) && ((local_tid_27311 -\n                                                               squot32(local_tid_27311,\n                                                                       wave_sizze_27313) *\n                                                               wave_sizze_27313) ==\n                                                              0 &&\n                                                              (squot32(local_tid_27311,\n                                                                       wave_sizze_27313) &\n                                                               (2 *\n                                                                skip_waves_27326 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_27322 = ((__local\n                            float *) red_arr_mem_27317)[sext_i32_i64(local_tid_27311 +\n                                                        offset_27325)];\n            }\n            // apply reduction operation\n            {\n       ",
                   "         float res_27323 = fmax32(x_27321, x_27322);\n                \n                x_27321 = res_27323;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_27317)[sext_i32_i64(local_tid_27311)] =\n                    x_27321;\n            }\n        }\n        skip_waves_27326 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_27311) == 0) {\n            x_acc_27319 = x_27321;\n        }\n    }\n    \n    int32_t old_counter_27327;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_27311 == 0) {\n            ((__global\n              float *) group_res_arr_mem_27307)[sext_i32_i64(group_tid_27312) *\n                                                segred_group_sizze_20851] =\n                x_acc_27319;\n            mem_fence_global();\n            old_counter_27327 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_27305)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_27315)[0] = old_counter_27327 ==\n                num_groups_20853 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_27328;\n    \n    is_last_group_27328 = ((__local bool *) sync_arr_mem_27315)[0];\n    if (is_last_group_27328) {\n        if (local_tid_27311 == 0) {\n            old_counter_27327 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_27305)[0],\n                                                      (int) (0 -\n                                                             num_groups_20853));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_27329 = sdiv_up64(num_groups_20853,\n       ",
                   "                                               segred_group_sizze_20851);\n            \n            x_19773 = -INFINITY;\n            for (int64_t i_27330 = 0; i_27330 < read_per_thread_27329;\n                 i_27330++) {\n                int64_t group_res_id_27331 = sext_i32_i64(local_tid_27311) *\n                        read_per_thread_27329 + i_27330;\n                int64_t index_of_group_res_27332 = group_res_id_27331;\n                \n                if (slt64(group_res_id_27331, num_groups_20853)) {\n                    x_19774 = ((__global\n                                float *) group_res_arr_mem_27307)[index_of_group_res_27332 *\n                                                                  segred_group_sizze_20851];\n                    \n                    float res_19775;\n                    \n                    res_19775 = fmax32(x_19773, x_19774);\n                    x_19773 = res_19775;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_27317)[sext_i32_i64(local_tid_27311)] =\n            x_19773;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_27333;\n            int32_t skip_waves_27334;\n            \n            skip_waves_27334 = 1;\n            \n            float x_27321;\n            float x_27322;\n            \n            offset_27333 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_27311,\n                          sext_i64_i32(segred_group_sizze_20851))) {\n                    x_27321 = ((__local\n                                float *) red_arr_mem_27317)[sext_i32_i64(local_tid_27311 +\n                                                            offset_27333)];\n                }\n            }\n            offset_27333 = 1;\n            while (slt32(offset_27333, wave_sizze_27313)) {\n                if (slt32(local_tid_27311 + offset_27333,\n                          sext_i64_i32(segred_group",
                   "_sizze_20851)) &&\n                    ((local_tid_27311 - squot32(local_tid_27311,\n                                                wave_sizze_27313) *\n                      wave_sizze_27313) & (2 * offset_27333 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_27322 = ((volatile __local\n                                    float *) red_arr_mem_27317)[sext_i32_i64(local_tid_27311 +\n                                                                offset_27333)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27323 = fmax32(x_27321, x_27322);\n                        \n                        x_27321 = res_27323;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_27317)[sext_i32_i64(local_tid_27311)] =\n                            x_27321;\n                    }\n                }\n                offset_27333 *= 2;\n            }\n            while (slt32(skip_waves_27334,\n                         squot32(sext_i64_i32(segred_group_sizze_20851) +\n                                 wave_sizze_27313 - 1, wave_sizze_27313))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_27333 = skip_waves_27334 * wave_sizze_27313;\n                if (slt32(local_tid_27311 + offset_27333,\n                          sext_i64_i32(segred_group_sizze_20851)) &&\n                    ((local_tid_27311 - squot32(local_tid_27311,\n                                                wave_sizze_27313) *\n                      wave_sizze_27313) == 0 && (squot32(local_tid_27311,\n                                                         wave_sizze_27313) &\n                                                 (2 * skip_waves_27334 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n             ",
                   "           x_27322 = ((__local\n                                    float *) red_arr_mem_27317)[sext_i32_i64(local_tid_27311 +\n                                                                offset_27333)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27323 = fmax32(x_27321, x_27322);\n                        \n                        x_27321 = res_27323;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_27317)[sext_i32_i64(local_tid_27311)] =\n                            x_27321;\n                    }\n                }\n                skip_waves_27334 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_27311 == 0) {\n                    ((__global float *) mem_27176)[0] = x_27321;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_20851\n}\n__kernel void mainzisegred_nonseg_21609(__global int *global_failure,\n                                        int failure_is_an_option, __global\n                                        int64_t *global_failure_args,\n                                        __local volatile\n                                        int64_t *red_arr_mem_27385_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_27383_backing_aligned_1,\n                                        int64_t n_19755, int64_t paths_19758,\n                                        int64_t steps_19759, float a_19763,\n                                        float b_19764, float sigma_19765,\n                                        float x_19783, float x_19785,\n                                        float y_19787, float y_19788,\n                                        float sims_per_y",
                   "ear_19853,\n                                        float res_19930,\n                                        int64_t num_groups_21612, __global\n                                        unsigned char *res_mem_27195, __global\n                                        unsigned char *res_mem_27196, __global\n                                        unsigned char *res_mem_27197, __global\n                                        unsigned char *res_mem_27198, __global\n                                        unsigned char *mem_27226, __global\n                                        unsigned char *mem_27229, __global\n                                        unsigned char *mem_27231, __global\n                                        unsigned char *mainzicounter_mem_27373,\n                                        __global\n                                        unsigned char *group_res_arr_mem_27375,\n                                        int64_t num_threads_27377)\n{\n    #define segred_group_sizze_21611 (mainzisegred_group_sizze_21600)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27385_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_27385_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_27383_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_27383_backing_aligned_1;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27378;\n    int32_t local_tid_27379;\n    int64_t group_sizze_27382;\n    int32_t wave_sizze_27381;\n    int32_t group_tid_27380;\n    \n    global_tid_27378 = get_global_id(0);\n    local_tid_27379 = get_local_id(0);\n    group_sizze_27382 = get_loc",
                   "al_size(0);\n    wave_sizze_27381 = LOCKSTEP_WIDTH;\n    group_tid_27380 = get_group_id(0);\n    \n    int32_t phys_tid_21609;\n    \n    phys_tid_21609 = global_tid_27378;\n    \n    __local char *sync_arr_mem_27383;\n    \n    sync_arr_mem_27383 = (__local char *) sync_arr_mem_27383_backing_0;\n    \n    __local char *red_arr_mem_27385;\n    \n    red_arr_mem_27385 = (__local char *) red_arr_mem_27385_backing_1;\n    \n    int64_t dummy_21607;\n    \n    dummy_21607 = 0;\n    \n    int64_t gtid_21608;\n    \n    gtid_21608 = 0;\n    \n    float x_acc_27387;\n    int64_t chunk_sizze_27388;\n    \n    chunk_sizze_27388 = smin64(sdiv_up64(steps_19759,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_21611 *\n                                         num_groups_21612))),\n                               sdiv_up64(steps_19759 -\n                                         sext_i32_i64(phys_tid_21609),\n                                         num_threads_27377));\n    \n    float x_21616;\n    float x_21617;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_27387 = 0.0F;\n    }\n    for (int64_t i_27392 = 0; i_27392 < chunk_sizze_27388; i_27392++) {\n        gtid_21608 = sext_i32_i64(phys_tid_21609) + num_threads_27377 * i_27392;\n        // apply map function\n        {\n            int64_t index_primexp_27092 = add64(1, gtid_21608);\n            float res_21622 = sitofp_i64_f32(index_primexp_27092);\n            float res_21623 = res_21622 / sims_per_year_19853;\n            float res_21624;\n            float redout_27149 = 0.0F;\n            \n            for (int64_t i_27150 = 0; i_27150 < paths_19758; i_27150++) {\n                float x_21628 = ((__global float *) mem_27226)[gtid_21608 *\n                                                               paths_19758 +\n                                                               i_27150];\n                float res_21630;\n                float redout_27151 = 0.0F;\n                \n                for (int64_t i_2",
                   "7152 = 0; i_27152 < n_19755; i_27152++) {\n                    int64_t x_21636 = ((__global\n                                        int64_t *) res_mem_27197)[i_27152];\n                    float x_21637 = ((__global float *) res_mem_27198)[i_27152];\n                    int64_t i64_arg_21638 = sub64(x_21636, 1);\n                    float res_21639 = sitofp_i64_f32(i64_arg_21638);\n                    float y_21640 = x_21637 * res_21639;\n                    bool cond_21641 = y_21640 < res_21623;\n                    float ceil_arg_21642 = res_21623 / x_21637;\n                    float res_21643;\n                    \n                    res_21643 = futrts_ceil32(ceil_arg_21642);\n                    \n                    int64_t res_21644 = fptosi_f32_i64(res_21643);\n                    int64_t remaining_21645 = sub64(x_21636, res_21644);\n                    float res_21646;\n                    \n                    if (cond_21641) {\n                        res_21646 = 0.0F;\n                    } else {\n                        float x_21634 = ((__global\n                                          float *) res_mem_27195)[i_27152];\n                        float x_21635 = ((__global\n                                          float *) res_mem_27196)[i_27152];\n                        float nextpayment_21647 = x_21637 * res_21643;\n                        bool bounds_invalid_upwards_21648 =\n                             slt64(remaining_21645, 1);\n                        bool valid_21649 = !bounds_invalid_upwards_21648;\n                        bool range_valid_c_21650;\n                        \n                        if (!valid_21649) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 6) == -1) {\n                                    global_failure_args[0] = 1;\n                                    global_failure_args[1] = 2;\n                                    global_",
                   "failure_args[2] = remaining_21645;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float y_21652 = nextpayment_21647 - res_21623;\n                        float negate_arg_21653 = a_19763 * y_21652;\n                        float exp_arg_21654 = 0.0F - negate_arg_21653;\n                        float res_21655 = fpow32(2.7182817F, exp_arg_21654);\n                        float x_21656 = 1.0F - res_21655;\n                        float B_21657 = x_21656 / a_19763;\n                        float x_21658 = B_21657 - nextpayment_21647;\n                        float x_21659 = res_21623 + x_21658;\n                        float x_21660 = fpow32(a_19763, 2.0F);\n                        float x_21661 = b_19764 * x_21660;\n                        float x_21662 = fpow32(sigma_19765, 2.0F);\n                        float y_21663 = x_21662 / 2.0F;\n                        float y_21664 = x_21661 - y_21663;\n                        float x_21665 = x_21659 * y_21664;\n                        float A1_21666 = x_21665 / x_21660;\n                        float y_21667 = fpow32(B_21657, 2.0F);\n                        float x_21668 = x_21662 * y_21667;\n                        float y_21669 = 4.0F * a_19763;\n                        float A2_21670 = x_21668 / y_21669;\n                        float exp_arg_21671 = A1_21666 - A2_21670;\n                        float res_21672 = fpow32(2.7182817F, exp_arg_21671);\n                        float negate_arg_21673 = x_21628 * B_21657;\n                        float exp_arg_21674 = 0.0F - negate_arg_21673;\n                        float res_21675 = fpow32(2.7182817F, exp_arg_21674);\n                        float res_21676 = res_21672 * res_21675;\n                        bool y_21677 = slt64(0, remaining_21645);\n                        bo",
                   "ol index_certs_21678;\n                        \n                        if (!y_21677) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 7) == -1) {\n                                    global_failure_args[0] = 0;\n                                    global_failure_args[1] = remaining_21645;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float binop_y_21679 = sitofp_i64_f32(remaining_21645);\n                        float binop_y_21680 = x_21637 * binop_y_21679;\n                        float index_primexp_21681 = nextpayment_21647 +\n                              binop_y_21680;\n                        float y_21682 = index_primexp_21681 - res_21623;\n                        float negate_arg_21683 = a_19763 * y_21682;\n                        float exp_arg_21684 = 0.0F - negate_arg_21683;\n                        float res_21685 = fpow32(2.7182817F, exp_arg_21684);\n                        float x_21686 = 1.0F - res_21685;\n                        float B_21687 = x_21686 / a_19763;\n                        float x_21688 = B_21687 - index_primexp_21681;\n                        float x_21689 = res_21623 + x_21688;\n                        float x_21690 = y_21664 * x_21689;\n                        float A1_21691 = x_21690 / x_21660;\n                        float y_21692 = fpow32(B_21687, 2.0F);\n                        float x_21693 = x_21662 * y_21692;\n                        float A2_21694 = x_21693 / y_21669;\n                        float exp_arg_21695 = A1_21691 - A2_21694;\n                        float res_21696 = fpow32(2.7182817F, exp_arg_21695);\n                        float negate_arg_21697 = x_21628 * B_21687;\n              ",
                   "          float exp_arg_21698 = 0.0F - negate_arg_21697;\n                        float res_21699 = fpow32(2.7182817F, exp_arg_21698);\n                        float res_21700 = res_21696 * res_21699;\n                        float res_21701;\n                        float redout_27089 = 0.0F;\n                        \n                        for (int64_t i_27090 = 0; i_27090 < remaining_21645;\n                             i_27090++) {\n                            int64_t index_primexp_27128 = add64(1, i_27090);\n                            float res_21706 =\n                                  sitofp_i64_f32(index_primexp_27128);\n                            float res_21707 = x_21637 * res_21706;\n                            float res_21708 = nextpayment_21647 + res_21707;\n                            float y_21709 = res_21708 - res_21623;\n                            float negate_arg_21710 = a_19763 * y_21709;\n                            float exp_arg_21711 = 0.0F - negate_arg_21710;\n                            float res_21712 = fpow32(2.7182817F, exp_arg_21711);\n                            float x_21713 = 1.0F - res_21712;\n                            float B_21714 = x_21713 / a_19763;\n                            float x_21715 = B_21714 - res_21708;\n                            float x_21716 = res_21623 + x_21715;\n                            float x_21717 = y_21664 * x_21716;\n                            float A1_21718 = x_21717 / x_21660;\n                            float y_21719 = fpow32(B_21714, 2.0F);\n                            float x_21720 = x_21662 * y_21719;\n                            float A2_21721 = x_21720 / y_21669;\n                            float exp_arg_21722 = A1_21718 - A2_21721;\n                            float res_21723 = fpow32(2.7182817F, exp_arg_21722);\n                            float negate_arg_21724 = x_21628 * B_21714;\n                            float exp_arg_21725 = 0.0F - negate_arg_21724;\n                            float res_21726 = fpow32(2.71",
                   "82817F, exp_arg_21725);\n                            float res_21727 = res_21723 * res_21726;\n                            float res_21704 = res_21727 + redout_27089;\n                            float redout_tmp_27395 = res_21704;\n                            \n                            redout_27089 = redout_tmp_27395;\n                        }\n                        res_21701 = redout_27089;\n                        \n                        float x_21728 = res_21676 - res_21700;\n                        float x_21729 = x_21634 * x_21637;\n                        float y_21730 = res_21701 * x_21729;\n                        float y_21731 = x_21728 - y_21730;\n                        float res_21732 = x_21635 * y_21731;\n                        float res_21733 = x_21635 * res_21732;\n                        \n                        res_21646 = res_21733;\n                    }\n                    \n                    float res_21633 = res_21646 + redout_27151;\n                    float redout_tmp_27394 = res_21633;\n                    \n                    redout_27151 = redout_tmp_27394;\n                }\n                res_21630 = redout_27151;\n                \n                float res_21734 = fmax32(0.0F, res_21630);\n                float res_21627 = res_21734 + redout_27149;\n                float redout_tmp_27393 = res_21627;\n                \n                redout_27149 = redout_tmp_27393;\n            }\n            res_21624 = redout_27149;\n            \n            float res_21735 = res_21624 / res_19930;\n            float negate_arg_21736 = a_19763 * res_21623;\n            float exp_arg_21737 = 0.0F - negate_arg_21736;\n            float res_21738 = fpow32(2.7182817F, exp_arg_21737);\n            float x_21739 = 1.0F - res_21738;\n            float B_21740 = x_21739 / a_19763;\n            float x_21741 = B_21740 - res_21623;\n            float x_21742 = y_19787 * x_21741;\n            float A1_21743 = x_21742 / x_19783;\n            float y_21744 = fpow32(B_21740, 2.0F);\n   ",
                   "         float x_21745 = x_19785 * y_21744;\n            float A2_21746 = x_21745 / y_19788;\n            float exp_arg_21747 = A1_21743 - A2_21746;\n            float res_21748 = fpow32(2.7182817F, exp_arg_21747);\n            float negate_arg_21749 = 5.0e-2F * B_21740;\n            float exp_arg_21750 = 0.0F - negate_arg_21749;\n            float res_21751 = fpow32(2.7182817F, exp_arg_21750);\n            float res_21752 = res_21748 * res_21751;\n            float res_21753 = res_21735 * res_21752;\n            \n            // save map-out results\n            {\n                ((__global float *) mem_27231)[dummy_21607 * steps_19759 +\n                                               gtid_21608] = res_21735;\n            }\n            // load accumulator\n            {\n                x_21616 = x_acc_27387;\n            }\n            // load new values\n            {\n                x_21617 = res_21753;\n            }\n            // apply reduction operator\n            {\n                float res_21618 = x_21616 + x_21617;\n                \n                // store in accumulator\n                {\n                    x_acc_27387 = res_21618;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_21616 = x_acc_27387;\n        ((__local float *) red_arr_mem_27385)[sext_i32_i64(local_tid_27379)] =\n            x_21616;\n    }\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_27396;\n    int32_t skip_waves_27397;\n    \n    skip_waves_27397 = 1;\n    \n    float x_27389;\n    float x_27390;\n    \n    offset_27396 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_27379, sext_i64_i32(segred_group_sizze_21611))) {\n            x_27389 = ((__local\n                        float *) red_arr_mem_27385)[sext_i32_i64(local_tid_27379 +\n                                                    offset_273",
                   "96)];\n        }\n    }\n    offset_27396 = 1;\n    while (slt32(offset_27396, wave_sizze_27381)) {\n        if (slt32(local_tid_27379 + offset_27396,\n                  sext_i64_i32(segred_group_sizze_21611)) && ((local_tid_27379 -\n                                                               squot32(local_tid_27379,\n                                                                       wave_sizze_27381) *\n                                                               wave_sizze_27381) &\n                                                              (2 *\n                                                               offset_27396 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_27390 = ((volatile __local\n                            float *) red_arr_mem_27385)[sext_i32_i64(local_tid_27379 +\n                                                        offset_27396)];\n            }\n            // apply reduction operation\n            {\n                float res_27391 = x_27389 + x_27390;\n                \n                x_27389 = res_27391;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_27385)[sext_i32_i64(local_tid_27379)] =\n                    x_27389;\n            }\n        }\n        offset_27396 *= 2;\n    }\n    while (slt32(skip_waves_27397,\n                 squot32(sext_i64_i32(segred_group_sizze_21611) +\n                         wave_sizze_27381 - 1, wave_sizze_27381))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_27396 = skip_waves_27397 * wave_sizze_27381;\n        if (slt32(local_tid_27379 + offset_27396,\n                  sext_i64_i32(segred_group_sizze_21611)) && ((local_tid_27379 -\n                                                               squot32(local_tid_27379,\n                                                                       wave_sizze_27381) *\n                ",
                   "                                               wave_sizze_27381) ==\n                                                              0 &&\n                                                              (squot32(local_tid_27379,\n                                                                       wave_sizze_27381) &\n                                                               (2 *\n                                                                skip_waves_27397 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_27390 = ((__local\n                            float *) red_arr_mem_27385)[sext_i32_i64(local_tid_27379 +\n                                                        offset_27396)];\n            }\n            // apply reduction operation\n            {\n                float res_27391 = x_27389 + x_27390;\n                \n                x_27389 = res_27391;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_27385)[sext_i32_i64(local_tid_27379)] =\n                    x_27389;\n            }\n        }\n        skip_waves_27397 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_27379) == 0) {\n            x_acc_27387 = x_27389;\n        }\n    }\n    \n    int32_t old_counter_27398;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_27379 == 0) {\n            ((__global\n              float *) group_res_arr_mem_27375)[sext_i32_i64(group_tid_27380) *\n                                                segred_group_sizze_21611] =\n                x_acc_27387;\n            mem_fence_global();\n            old_counter_27398 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_27373)[0],\n                          ",
                   "                            (int) 1);\n            ((__local bool *) sync_arr_mem_27383)[0] = old_counter_27398 ==\n                num_groups_21612 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_27399;\n    \n    is_last_group_27399 = ((__local bool *) sync_arr_mem_27383)[0];\n    if (is_last_group_27399) {\n        if (local_tid_27379 == 0) {\n            old_counter_27398 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_27373)[0],\n                                                      (int) (0 -\n                                                             num_groups_21612));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_27400 = sdiv_up64(num_groups_21612,\n                                                      segred_group_sizze_21611);\n            \n            x_21616 = 0.0F;\n            for (int64_t i_27401 = 0; i_27401 < read_per_thread_27400;\n                 i_27401++) {\n                int64_t group_res_id_27402 = sext_i32_i64(local_tid_27379) *\n                        read_per_thread_27400 + i_27401;\n                int64_t index_of_group_res_27403 = group_res_id_27402;\n                \n                if (slt64(group_res_id_27402, num_groups_21612)) {\n                    x_21617 = ((__global\n                                float *) group_res_arr_mem_27375)[index_of_group_res_27403 *\n                                                                  segred_group_sizze_21611];\n                    \n                    float res_21618;\n                    \n                    res_21618 = x_21616 + x_21617;\n                    x_21616 = res_21618;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_27385)[sext_i32_i64(local_tid_27379)] =\n            x_21616;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            i",
                   "nt32_t offset_27404;\n            int32_t skip_waves_27405;\n            \n            skip_waves_27405 = 1;\n            \n            float x_27389;\n            float x_27390;\n            \n            offset_27404 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_27379,\n                          sext_i64_i32(segred_group_sizze_21611))) {\n                    x_27389 = ((__local\n                                float *) red_arr_mem_27385)[sext_i32_i64(local_tid_27379 +\n                                                            offset_27404)];\n                }\n            }\n            offset_27404 = 1;\n            while (slt32(offset_27404, wave_sizze_27381)) {\n                if (slt32(local_tid_27379 + offset_27404,\n                          sext_i64_i32(segred_group_sizze_21611)) &&\n                    ((local_tid_27379 - squot32(local_tid_27379,\n                                                wave_sizze_27381) *\n                      wave_sizze_27381) & (2 * offset_27404 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_27390 = ((volatile __local\n                                    float *) red_arr_mem_27385)[sext_i32_i64(local_tid_27379 +\n                                                                offset_27404)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27391 = x_27389 + x_27390;\n                        \n                        x_27389 = res_27391;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_27385)[sext_i32_i64(local_tid_27379)] =\n                            x_27389;\n                    }\n                }\n                offset_27404 *= 2;\n            }\n            while (slt32(skip_waves_27405,\n                         ",
                   "squot32(sext_i64_i32(segred_group_sizze_21611) +\n                                 wave_sizze_27381 - 1, wave_sizze_27381))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_27404 = skip_waves_27405 * wave_sizze_27381;\n                if (slt32(local_tid_27379 + offset_27404,\n                          sext_i64_i32(segred_group_sizze_21611)) &&\n                    ((local_tid_27379 - squot32(local_tid_27379,\n                                                wave_sizze_27381) *\n                      wave_sizze_27381) == 0 && (squot32(local_tid_27379,\n                                                         wave_sizze_27381) &\n                                                 (2 * skip_waves_27405 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_27390 = ((__local\n                                    float *) red_arr_mem_27385)[sext_i32_i64(local_tid_27379 +\n                                                                offset_27404)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27391 = x_27389 + x_27390;\n                        \n                        x_27389 = res_27391;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_27385)[sext_i32_i64(local_tid_27379)] =\n                            x_27389;\n                    }\n                }\n                skip_waves_27405 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_27379 == 0) {\n                    ((__global float *) mem_27229)[0] = x_27389;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_21611\n}\n__kernel void mainzisegred_nonseg_22513(__global int *global_failure,\n                            ",
                   "            __local volatile\n                                        int64_t *red_arr_mem_27509_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_27507_backing_aligned_1,\n                                        int64_t steps_19759,\n                                        int64_t num_groups_22959, __global\n                                        unsigned char *res_map_acc_mem_27253,\n                                        __global unsigned char *mem_27257,\n                                        __global\n                                        unsigned char *mainzicounter_mem_27497,\n                                        __global\n                                        unsigned char *group_res_arr_mem_27499,\n                                        int64_t num_threads_27501)\n{\n    #define segred_group_sizze_22958 (mainzisegred_group_sizze_22505)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27509_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_27509_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_27507_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_27507_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27502;\n    int32_t local_tid_27503;\n    int64_t group_sizze_27506;\n    int32_t wave_sizze_27505;\n    int32_t group_tid_27504;\n    \n    global_tid_27502 = get_global_id(0);\n    local_tid_27503 = get_local_id(0);\n    group_sizze_27506 = get_local_size(0);\n    wave_sizze_27505 = LOCKSTEP_WIDTH;\n    group_tid_27504 = get_group_id(0);\n    \n    int32_t phys_tid_22513;\n    \n    phys_tid_22513 = global_tid_27502;\n    \n    __local char *sync_arr_mem_27507;\n    \n    sync_arr_mem_27507 = (__local char *) sync_arr_mem_275",
                   "07_backing_0;\n    \n    __local char *red_arr_mem_27509;\n    \n    red_arr_mem_27509 = (__local char *) red_arr_mem_27509_backing_1;\n    \n    int64_t dummy_22511;\n    \n    dummy_22511 = 0;\n    \n    int64_t gtid_22512;\n    \n    gtid_22512 = 0;\n    \n    float x_acc_27511;\n    int64_t chunk_sizze_27512;\n    \n    chunk_sizze_27512 = smin64(sdiv_up64(steps_19759,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_22958 *\n                                         num_groups_22959))),\n                               sdiv_up64(steps_19759 -\n                                         sext_i32_i64(phys_tid_22513),\n                                         num_threads_27501));\n    \n    float x_22962;\n    float x_22963;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_27511 = 0.0F;\n    }\n    for (int64_t i_27516 = 0; i_27516 < chunk_sizze_27512; i_27516++) {\n        gtid_22512 = sext_i32_i64(phys_tid_22513) + num_threads_27501 * i_27516;\n        // apply map function\n        {\n            float x_22965 = ((__global\n                              float *) res_map_acc_mem_27253)[gtid_22512];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_22962 = x_acc_27511;\n            }\n            // load new values\n            {\n                x_22963 = x_22965;\n            }\n            // apply reduction operator\n            {\n                float res_22964 = x_22962 + x_22963;\n                \n                // store in accumulator\n                {\n                    x_acc_27511 = res_22964;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_22962 = x_acc_27511;\n        ((__local float *) red_arr_mem_27509)[sext_i32_i64(local_tid_27503)] =\n            x_22962;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_27517;\n    int32_t skip_waves_27518;\n    \n    skip_waves_275",
                   "18 = 1;\n    \n    float x_27513;\n    float x_27514;\n    \n    offset_27517 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_27503, sext_i64_i32(segred_group_sizze_22958))) {\n            x_27513 = ((__local\n                        float *) red_arr_mem_27509)[sext_i32_i64(local_tid_27503 +\n                                                    offset_27517)];\n        }\n    }\n    offset_27517 = 1;\n    while (slt32(offset_27517, wave_sizze_27505)) {\n        if (slt32(local_tid_27503 + offset_27517,\n                  sext_i64_i32(segred_group_sizze_22958)) && ((local_tid_27503 -\n                                                               squot32(local_tid_27503,\n                                                                       wave_sizze_27505) *\n                                                               wave_sizze_27505) &\n                                                              (2 *\n                                                               offset_27517 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_27514 = ((volatile __local\n                            float *) red_arr_mem_27509)[sext_i32_i64(local_tid_27503 +\n                                                        offset_27517)];\n            }\n            // apply reduction operation\n            {\n                float res_27515 = x_27513 + x_27514;\n                \n                x_27513 = res_27515;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_27509)[sext_i32_i64(local_tid_27503)] =\n                    x_27513;\n            }\n        }\n        offset_27517 *= 2;\n    }\n    while (slt32(skip_waves_27518,\n                 squot32(sext_i64_i32(segred_group_sizze_22958) +\n                         wave_sizze_27505 - 1, wave_sizze_27505))) {\n        barrier(CLK_LOCAL_MEM_F",
                   "ENCE);\n        offset_27517 = skip_waves_27518 * wave_sizze_27505;\n        if (slt32(local_tid_27503 + offset_27517,\n                  sext_i64_i32(segred_group_sizze_22958)) && ((local_tid_27503 -\n                                                               squot32(local_tid_27503,\n                                                                       wave_sizze_27505) *\n                                                               wave_sizze_27505) ==\n                                                              0 &&\n                                                              (squot32(local_tid_27503,\n                                                                       wave_sizze_27505) &\n                                                               (2 *\n                                                                skip_waves_27518 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_27514 = ((__local\n                            float *) red_arr_mem_27509)[sext_i32_i64(local_tid_27503 +\n                                                        offset_27517)];\n            }\n            // apply reduction operation\n            {\n                float res_27515 = x_27513 + x_27514;\n                \n                x_27513 = res_27515;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_27509)[sext_i32_i64(local_tid_27503)] =\n                    x_27513;\n            }\n        }\n        skip_waves_27518 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_27503) == 0) {\n            x_acc_27511 = x_27513;\n        }\n    }\n    \n    int32_t old_counter_27519;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_27503 == 0) {\n            ((__global\n              floa",
                   "t *) group_res_arr_mem_27499)[sext_i32_i64(group_tid_27504) *\n                                                segred_group_sizze_22958] =\n                x_acc_27511;\n            mem_fence_global();\n            old_counter_27519 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_27497)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_27507)[0] = old_counter_27519 ==\n                num_groups_22959 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_27520;\n    \n    is_last_group_27520 = ((__local bool *) sync_arr_mem_27507)[0];\n    if (is_last_group_27520) {\n        if (local_tid_27503 == 0) {\n            old_counter_27519 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_27497)[0],\n                                                      (int) (0 -\n                                                             num_groups_22959));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_27521 = sdiv_up64(num_groups_22959,\n                                                      segred_group_sizze_22958);\n            \n            x_22962 = 0.0F;\n            for (int64_t i_27522 = 0; i_27522 < read_per_thread_27521;\n                 i_27522++) {\n                int64_t group_res_id_27523 = sext_i32_i64(local_tid_27503) *\n                        read_per_thread_27521 + i_27522;\n                int64_t index_of_group_res_27524 = group_res_id_27523;\n                \n                if (slt64(group_res_id_27523, num_groups_22959)) {\n                    x_22963 = ((__global\n                                float *) group_res_arr_mem_27499)[index_of_group_res_27524 *\n                                                                  segred_group_sizze_22958];\n                    \n",
                   "                    float res_22964;\n                    \n                    res_22964 = x_22962 + x_22963;\n                    x_22962 = res_22964;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_27509)[sext_i32_i64(local_tid_27503)] =\n            x_22962;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_27525;\n            int32_t skip_waves_27526;\n            \n            skip_waves_27526 = 1;\n            \n            float x_27513;\n            float x_27514;\n            \n            offset_27525 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_27503,\n                          sext_i64_i32(segred_group_sizze_22958))) {\n                    x_27513 = ((__local\n                                float *) red_arr_mem_27509)[sext_i32_i64(local_tid_27503 +\n                                                            offset_27525)];\n                }\n            }\n            offset_27525 = 1;\n            while (slt32(offset_27525, wave_sizze_27505)) {\n                if (slt32(local_tid_27503 + offset_27525,\n                          sext_i64_i32(segred_group_sizze_22958)) &&\n                    ((local_tid_27503 - squot32(local_tid_27503,\n                                                wave_sizze_27505) *\n                      wave_sizze_27505) & (2 * offset_27525 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_27514 = ((volatile __local\n                                    float *) red_arr_mem_27509)[sext_i32_i64(local_tid_27503 +\n                                                                offset_27525)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27515 = x_27513 + x_27514;\n                        \n                        x_27513 = res_27515;\n                    }\n  ",
                   "                  // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_27509)[sext_i32_i64(local_tid_27503)] =\n                            x_27513;\n                    }\n                }\n                offset_27525 *= 2;\n            }\n            while (slt32(skip_waves_27526,\n                         squot32(sext_i64_i32(segred_group_sizze_22958) +\n                                 wave_sizze_27505 - 1, wave_sizze_27505))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_27525 = skip_waves_27526 * wave_sizze_27505;\n                if (slt32(local_tid_27503 + offset_27525,\n                          sext_i64_i32(segred_group_sizze_22958)) &&\n                    ((local_tid_27503 - squot32(local_tid_27503,\n                                                wave_sizze_27505) *\n                      wave_sizze_27505) == 0 && (squot32(local_tid_27503,\n                                                         wave_sizze_27505) &\n                                                 (2 * skip_waves_27526 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_27514 = ((__local\n                                    float *) red_arr_mem_27509)[sext_i32_i64(local_tid_27503 +\n                                                                offset_27525)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27515 = x_27513 + x_27514;\n                        \n                        x_27513 = res_27515;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_27509)[sext_i32_i64(local_tid_27503)] =\n                            x_27513;\n                    }\n                }\n                skip_waves_27526 *= 2;\n            ",
                   "}\n            // and back to memory with the final result\n            {\n                if (local_tid_27503 == 0) {\n                    ((__global float *) mem_27257)[0] = x_27513;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_22958\n}\n__kernel void mainzisegred_small_22227(__global int *global_failure,\n                                       int failure_is_an_option, __global\n                                       int64_t *global_failure_args,\n                                       __local volatile\n                                       int64_t *red_arr_mem_27433_backing_aligned_0,\n                                       int64_t n_19755, int64_t paths_19758,\n                                       int64_t steps_19759, float a_19763,\n                                       float b_19764, float sigma_19765,\n                                       float sims_per_year_19853,\n                                       int64_t num_groups_22814, __global\n                                       unsigned char *res_mem_27195, __global\n                                       unsigned char *res_mem_27196, __global\n                                       unsigned char *res_mem_27197, __global\n                                       unsigned char *res_mem_27198, __global\n                                       unsigned char *mem_27226, __global\n                                       unsigned char *mem_27245,\n                                       int64_t segment_sizze_nonzzero_27426)\n{\n    #define segred_group_sizze_22813 (mainzisegred_group_sizze_22221)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27433_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_27433_backing_aligned_0;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_fai",
                   "lure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27428;\n    int32_t local_tid_27429;\n    int64_t group_sizze_27432;\n    int32_t wave_sizze_27431;\n    int32_t group_tid_27430;\n    \n    global_tid_27428 = get_global_id(0);\n    local_tid_27429 = get_local_id(0);\n    group_sizze_27432 = get_local_size(0);\n    wave_sizze_27431 = LOCKSTEP_WIDTH;\n    group_tid_27430 = get_group_id(0);\n    \n    int32_t phys_tid_22227;\n    \n    phys_tid_22227 = global_tid_27428;\n    \n    __local char *red_arr_mem_27433;\n    \n    red_arr_mem_27433 = (__local char *) red_arr_mem_27433_backing_0;\n    \n    int32_t phys_group_id_27435;\n    \n    phys_group_id_27435 = get_group_id(0);\n    for (int32_t i_27436 = 0; i_27436 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(steps_19759,\n                                          squot64(segred_group_sizze_22813,\n                                                  segment_sizze_nonzzero_27426))) -\n                   phys_group_id_27435, sext_i64_i32(num_groups_22814));\n         i_27436++) {\n        int32_t virt_group_id_27437 = phys_group_id_27435 + i_27436 *\n                sext_i64_i32(num_groups_22814);\n        int64_t gtid_22218 = squot64(sext_i32_i64(local_tid_27429),\n                                     segment_sizze_nonzzero_27426) +\n                sext_i32_i64(virt_group_id_27437) *\n                squot64(segred_group_sizze_22813, segment_sizze_nonzzero_27426);\n        int64_t gtid_22226 = srem64(sext_i32_i64(local_tid_27429), paths_19758);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, paths_19758) && (slt64(gtid_22218, steps_19759) &&\n                                          slt64(sext_i32_i64(local_tid_27429),\n                                                paths_19758 *\n                                                squot64(segred_group_sizze_22813,\n                                                     ",
                   "   segment_sizze_nonzzero_27426)))) {\n                float x_22822 = ((__global float *) mem_27226)[gtid_22218 *\n                                                               paths_19758 +\n                                                               gtid_22226];\n                int64_t convop_x_27110 = add64(1, gtid_22218);\n                float binop_x_27111 = sitofp_i64_f32(convop_x_27110);\n                float index_primexp_27112 = binop_x_27111 / sims_per_year_19853;\n                float res_22824;\n                float redout_27159 = 0.0F;\n                \n                for (int64_t i_27160 = 0; i_27160 < n_19755; i_27160++) {\n                    int64_t x_22830 = ((__global\n                                        int64_t *) res_mem_27197)[i_27160];\n                    float x_22831 = ((__global float *) res_mem_27198)[i_27160];\n                    int64_t i64_arg_22832 = sub64(x_22830, 1);\n                    float res_22833 = sitofp_i64_f32(i64_arg_22832);\n                    float y_22834 = x_22831 * res_22833;\n                    bool cond_22835 = y_22834 < index_primexp_27112;\n                    float ceil_arg_22836 = index_primexp_27112 / x_22831;\n                    float res_22837;\n                    \n                    res_22837 = futrts_ceil32(ceil_arg_22836);\n                    \n                    int64_t res_22838 = fptosi_f32_i64(res_22837);\n                    int64_t remaining_22839 = sub64(x_22830, res_22838);\n                    float res_22840;\n                    \n                    if (cond_22835) {\n                        res_22840 = 0.0F;\n                    } else {\n                        float x_22828 = ((__global\n                                          float *) res_mem_27195)[i_27160];\n                        float x_22829 = ((__global\n                                          float *) res_mem_27196)[i_27160];\n                        float nextpayment_22841 = x_22831 * res_22837;\n                        bool bounds_inva",
                   "lid_upwards_22842 =\n                             slt64(remaining_22839, 1);\n                        bool valid_22843 = !bounds_invalid_upwards_22842;\n                        bool range_valid_c_22844;\n                        \n                        if (!valid_22843) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 12) == -1) {\n                                    global_failure_args[0] = 1;\n                                    global_failure_args[1] = 2;\n                                    global_failure_args[2] = remaining_22839;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float y_22846 = nextpayment_22841 - index_primexp_27112;\n                        float negate_arg_22847 = a_19763 * y_22846;\n                        float exp_arg_22848 = 0.0F - negate_arg_22847;\n                        float res_22849 = fpow32(2.7182817F, exp_arg_22848);\n                        float x_22850 = 1.0F - res_22849;\n                        float B_22851 = x_22850 / a_19763;\n                        float x_22852 = B_22851 - nextpayment_22841;\n                        float x_22853 = x_22852 + index_primexp_27112;\n                        float x_22854 = fpow32(a_19763, 2.0F);\n                        float x_22855 = b_19764 * x_22854;\n                        float x_22856 = fpow32(sigma_19765, 2.0F);\n                        float y_22857 = x_22856 / 2.0F;\n                        float y_22858 = x_22855 - y_22857;\n                        float x_22859 = x_22853 * y_22858;\n                        float A1_22860 = x_22859 / x_22854;\n                        float y_22861 = fpow32(B_22851, 2.0F);\n                        float x_22862 = x_228",
                   "56 * y_22861;\n                        float y_22863 = 4.0F * a_19763;\n                        float A2_22864 = x_22862 / y_22863;\n                        float exp_arg_22865 = A1_22860 - A2_22864;\n                        float res_22866 = fpow32(2.7182817F, exp_arg_22865);\n                        float negate_arg_22867 = x_22822 * B_22851;\n                        float exp_arg_22868 = 0.0F - negate_arg_22867;\n                        float res_22869 = fpow32(2.7182817F, exp_arg_22868);\n                        float res_22870 = res_22866 * res_22869;\n                        bool y_22871 = slt64(0, remaining_22839);\n                        bool index_certs_22872;\n                        \n                        if (!y_22871) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 13) == -1) {\n                                    global_failure_args[0] = 0;\n                                    global_failure_args[1] = remaining_22839;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float binop_y_22873 = sitofp_i64_f32(remaining_22839);\n                        float binop_y_22874 = x_22831 * binop_y_22873;\n                        float index_primexp_22875 = nextpayment_22841 +\n                              binop_y_22874;\n                        float y_22876 = index_primexp_22875 -\n                              index_primexp_27112;\n                        float negate_arg_22877 = a_19763 * y_22876;\n                        float exp_arg_22878 = 0.0F - negate_arg_22877;\n                        float res_22879 = fpow32(2.7182817F, exp_arg_22878);\n                        float x_22880 = 1.0F - res_22879;\n                        float ",
                   "B_22881 = x_22880 / a_19763;\n                        float x_22882 = B_22881 - index_primexp_22875;\n                        float x_22883 = x_22882 + index_primexp_27112;\n                        float x_22884 = y_22858 * x_22883;\n                        float A1_22885 = x_22884 / x_22854;\n                        float y_22886 = fpow32(B_22881, 2.0F);\n                        float x_22887 = x_22856 * y_22886;\n                        float A2_22888 = x_22887 / y_22863;\n                        float exp_arg_22889 = A1_22885 - A2_22888;\n                        float res_22890 = fpow32(2.7182817F, exp_arg_22889);\n                        float negate_arg_22891 = x_22822 * B_22881;\n                        float exp_arg_22892 = 0.0F - negate_arg_22891;\n                        float res_22893 = fpow32(2.7182817F, exp_arg_22892);\n                        float res_22894 = res_22890 * res_22893;\n                        float res_22895;\n                        float redout_27107 = 0.0F;\n                        \n                        for (int64_t i_27108 = 0; i_27108 < remaining_22839;\n                             i_27108++) {\n                            int64_t index_primexp_27134 = add64(1, i_27108);\n                            float res_22900 =\n                                  sitofp_i64_f32(index_primexp_27134);\n                            float res_22901 = x_22831 * res_22900;\n                            float res_22902 = nextpayment_22841 + res_22901;\n                            float y_22903 = res_22902 - index_primexp_27112;\n                            float negate_arg_22904 = a_19763 * y_22903;\n                            float exp_arg_22905 = 0.0F - negate_arg_22904;\n                            float res_22906 = fpow32(2.7182817F, exp_arg_22905);\n                            float x_22907 = 1.0F - res_22906;\n                            float B_22908 = x_22907 / a_19763;\n                            float x_22909 = B_22908 - res_22902;\n                            float ",
                   "x_22910 = x_22909 + index_primexp_27112;\n                            float x_22911 = y_22858 * x_22910;\n                            float A1_22912 = x_22911 / x_22854;\n                            float y_22913 = fpow32(B_22908, 2.0F);\n                            float x_22914 = x_22856 * y_22913;\n                            float A2_22915 = x_22914 / y_22863;\n                            float exp_arg_22916 = A1_22912 - A2_22915;\n                            float res_22917 = fpow32(2.7182817F, exp_arg_22916);\n                            float negate_arg_22918 = x_22822 * B_22908;\n                            float exp_arg_22919 = 0.0F - negate_arg_22918;\n                            float res_22920 = fpow32(2.7182817F, exp_arg_22919);\n                            float res_22921 = res_22917 * res_22920;\n                            float res_22898 = res_22921 + redout_27107;\n                            float redout_tmp_27439 = res_22898;\n                            \n                            redout_27107 = redout_tmp_27439;\n                        }\n                        res_22895 = redout_27107;\n                        \n                        float x_22922 = res_22870 - res_22894;\n                        float x_22923 = x_22828 * x_22831;\n                        float y_22924 = res_22895 * x_22923;\n                        float y_22925 = x_22922 - y_22924;\n                        float res_22926 = x_22829 * y_22925;\n                        float res_22927 = x_22829 * res_22926;\n                        \n                        res_22840 = res_22927;\n                    }\n                    \n                    float res_22827 = res_22840 + redout_27159;\n                    float redout_tmp_27438 = res_22827;\n                    \n                    redout_27159 = redout_tmp_27438;\n                }\n                res_22824 = redout_27159;\n                \n                float res_22928 = fmax32(0.0F, res_22824);\n                \n                // save map-out re",
                   "sults\n                { }\n                // save results to be reduced\n                {\n                    ((__local\n                      float *) red_arr_mem_27433)[sext_i32_i64(local_tid_27429)] =\n                        res_22928;\n                }\n            } else {\n                ((__local\n                  float *) red_arr_mem_27433)[sext_i32_i64(local_tid_27429)] =\n                    0.0F;\n            }\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, paths_19758)) {\n            // perform segmented scan to imitate reduction\n            {\n                float x_22817;\n                float x_22818;\n                float x_27440;\n                float x_27441;\n                bool ltid_in_bounds_27443;\n                \n                ltid_in_bounds_27443 = slt64(sext_i32_i64(local_tid_27429),\n                                             paths_19758 *\n                                             squot64(segred_group_sizze_22813,\n                                                     segment_sizze_nonzzero_27426));\n                \n                int32_t skip_threads_27444;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_27443) {\n                        x_22818 = ((volatile __local\n                                    float *) red_arr_mem_27433)[sext_i32_i64(local_tid_27429)];\n                        if ((local_tid_27429 - squot32(local_tid_27429, 32) *\n                             32) == 0) {\n                            x_22817 = x_22818;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_27444 = 1;\n                    while (slt32(skip_threads_27444, 32)) {\n                        if (sle32(skip_threads_27444, local_tid_27429",
                   " -\n                                  squot32(local_tid_27429, 32) * 32) &&\n                            ltid_in_bounds_27443) {\n                            // read operands\n                            {\n                                x_22817 = ((volatile __local\n                                            float *) red_arr_mem_27433)[sext_i32_i64(local_tid_27429) -\n                                                                        sext_i32_i64(skip_threads_27444)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_27445 =\n                                     slt64(srem64(sext_i32_i64(local_tid_27429),\n                                                  paths_19758),\n                                           sext_i32_i64(local_tid_27429) -\n                                           sext_i32_i64(local_tid_27429 -\n                                           skip_threads_27444));\n                                \n                                if (inactive_27445) {\n                                    x_22817 = x_22818;\n                                }\n                                if (!inactive_27445) {\n                                    float res_22819 = x_22817 + x_22818;\n                                    \n                                    x_22817 = res_22819;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_27431, skip_threads_27444)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_27444, local_tid_27429 -\n                                  squot32(local_tid_27429, 32) * 32) &&\n                            ltid_in_bounds_27443) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  fl",
                   "oat *) red_arr_mem_27433)[sext_i32_i64(local_tid_27429)] =\n                                    x_22817;\n                                x_22818 = x_22817;\n                            }\n                        }\n                        if (sle32(wave_sizze_27431, skip_threads_27444)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_27444 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_27429 - squot32(local_tid_27429, 32) * 32) ==\n                        31 && ltid_in_bounds_27443) {\n                        ((volatile __local\n                          float *) red_arr_mem_27433)[sext_i32_i64(squot32(local_tid_27429,\n                                                                           32))] =\n                            x_22817;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_27446;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_27429, 32) == 0 &&\n                            ltid_in_bounds_27443) {\n                            x_27441 = ((volatile __local\n                                        float *) red_arr_mem_27433)[sext_i32_i64(local_tid_27429)];\n                            if ((local_tid_27429 - squot32(local_tid_27429,\n                                                           32) * 32) == 0) {\n                                x_27440 = x_27441;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                    ",
                   "    skip_threads_27446 = 1;\n                        while (slt32(skip_threads_27446, 32)) {\n                            if (sle32(skip_threads_27446, local_tid_27429 -\n                                      squot32(local_tid_27429, 32) * 32) &&\n                                (squot32(local_tid_27429, 32) == 0 &&\n                                 ltid_in_bounds_27443)) {\n                                // read operands\n                                {\n                                    x_27440 = ((volatile __local\n                                                float *) red_arr_mem_27433)[sext_i32_i64(local_tid_27429) -\n                                                                            sext_i32_i64(skip_threads_27446)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_27447 =\n                                         slt64(srem64(sext_i32_i64(local_tid_27429 *\n                                                      32 + 32 - 1),\n                                                      paths_19758),\n                                               sext_i32_i64(local_tid_27429 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_27429 -\n                                                             skip_threads_27446) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_27447) {\n                                        x_27440 = x_27441;\n                                    }\n                                    if (!inactive_27447) {\n                                        float res_27442 = x_27440 + x_27441;\n                                        \n                                        x_27440 = res_27442;\n                                    }\n                             ",
                   "   }\n                            }\n                            if (sle32(wave_sizze_27431, skip_threads_27446)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_27446, local_tid_27429 -\n                                      squot32(local_tid_27429, 32) * 32) &&\n                                (squot32(local_tid_27429, 32) == 0 &&\n                                 ltid_in_bounds_27443)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      float *) red_arr_mem_27433)[sext_i32_i64(local_tid_27429)] =\n                                        x_27440;\n                                    x_27441 = x_27440;\n                                }\n                            }\n                            if (sle32(wave_sizze_27431, skip_threads_27446)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_27446 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_27429, 32) == 0 ||\n                          !ltid_in_bounds_27443)) {\n                        // read operands\n                        {\n                            x_22818 = x_22817;\n                            x_22817 = ((__local\n                                        float *) red_arr_mem_27433)[sext_i32_i64(squot32(local_tid_27429,\n                                                                                         32)) -\n                                                                    1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_27448",
                   " =\n                                 slt64(srem64(sext_i32_i64(local_tid_27429),\n                                              paths_19758),\n                                       sext_i32_i64(local_tid_27429) -\n                                       sext_i32_i64(squot32(local_tid_27429,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_27448) {\n                                x_22817 = x_22818;\n                            }\n                            if (!inactive_27448) {\n                                float res_22819 = x_22817 + x_22818;\n                                \n                                x_22817 = res_22819;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              float *) red_arr_mem_27433)[sext_i32_i64(local_tid_27429)] =\n                                x_22817;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_27429, 32) == 0) {\n                        ((__local\n                          float *) red_arr_mem_27433)[sext_i32_i64(local_tid_27429)] =\n                            x_22818;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_27437) *\n                      squot64(segred_group_sizze_22813,\n                              segment_sizze_nonzzero_27426) +\n                      sext_i32_i64(local_tid_27429), steps_19759) &&\n                slt64(sext_i32_i64(local_tid_27429),\n                      squot64(segred_group_sizze_22813,\n            ",
                   "                  segment_sizze_nonzzero_27426))) {\n                ((__global\n                  float *) mem_27245)[sext_i32_i64(virt_group_id_27437) *\n                                      squot64(segred_group_sizze_22813,\n                                              segment_sizze_nonzzero_27426) +\n                                      sext_i32_i64(local_tid_27429)] = ((__local\n                                                                         float *) red_arr_mem_27433)[(sext_i32_i64(local_tid_27429) +\n                                                                                                      1) *\n                                                                                                     segment_sizze_nonzzero_27426 -\n                                                                                                     1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_22813\n}\n__kernel void testzisegmap_22982(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, __global\n                                 unsigned char *mem_27174, __global\n                                 unsigned char *mem_27176, __global\n                                 unsigned char *mem_27188)\n{\n    #define segmap_group_sizze_23048 (testzisegmap_group_sizze_22984)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27336;\n    int32_t local_tid_27337;\n    int64_t group_sizze_27340;\n    int32_t wave_sizze_27339;\n    int32_t group_tid_27338;\n    \n    global_tid_27336 = get_global_id(0);\n    local_tid_27337 = get_local_id(0);\n    group_sizze_27340 = get_local_size(0);\n    wave_sizze_27339 = LOCKSTEP_WIDTH;\n    gr",
                   "oup_tid_27338 = get_group_id(0);\n    \n    int32_t phys_tid_22982;\n    \n    phys_tid_22982 = global_tid_27336;\n    \n    int64_t gtid_22981;\n    \n    gtid_22981 = sext_i32_i64(group_tid_27338) * segmap_group_sizze_23048 +\n        sext_i32_i64(local_tid_27337);\n    if (slt64(gtid_22981, 4)) {\n        float res_23059 = ((__global float *) mem_27176)[gtid_22981];\n        int64_t res_23060 = ((__global int64_t *) mem_27174)[gtid_22981];\n        bool bounds_invalid_upwards_23062 = slt64(res_23060, 1);\n        bool valid_23063 = !bounds_invalid_upwards_23062;\n        bool range_valid_c_23064;\n        \n        if (!valid_23063) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 16) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = 2;\n                    global_failure_args[2] = res_23060;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        bool y_23066 = slt64(0, res_23060);\n        bool index_certs_23067;\n        \n        if (!y_23066) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 17) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_23060;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_23068 = sitofp_i64_f32(res_23060);\n        float index_primexp_23069 = res_23059 * binop_y_23068;\n        float negate_arg_23070 = 1.0e-2F * index_primexp_23069;\n        float exp_arg_23071 = 0.0F - negate_arg_23070;\n        float res_23072 = fpow32(2.7182817F, exp_arg_23071);\n        float x_23073 = 1.0F - res_23072;\n        float B_23074 = x_23073 / 1.0e-2F;\n        float x_23075 = B_23074 - index_primexp_23069;\n        float x_23076 = 4.4999997e-6F * x_23075;\n        float A1_23077 = x_23076 / 1.0e-4F;\n        float y_23078 = fpow32(B_23074, 2.0F);\n        float x_23079 = 1.0000001e-6F * y_2307",
                   "8;\n        float A2_23080 = x_23079 / 4.0e-2F;\n        float exp_arg_23081 = A1_23077 - A2_23080;\n        float res_23082 = fpow32(2.7182817F, exp_arg_23081);\n        float negate_arg_23083 = 5.0e-2F * B_23074;\n        float exp_arg_23084 = 0.0F - negate_arg_23083;\n        float res_23085 = fpow32(2.7182817F, exp_arg_23084);\n        float res_23086 = res_23082 * res_23085;\n        float res_23087;\n        float redout_27074 = 0.0F;\n        \n        for (int64_t i_27075 = 0; i_27075 < res_23060; i_27075++) {\n            int64_t index_primexp_27118 = add64(1, i_27075);\n            float res_23092 = sitofp_i64_f32(index_primexp_27118);\n            float res_23093 = res_23059 * res_23092;\n            float negate_arg_23094 = 1.0e-2F * res_23093;\n            float exp_arg_23095 = 0.0F - negate_arg_23094;\n            float res_23096 = fpow32(2.7182817F, exp_arg_23095);\n            float x_23097 = 1.0F - res_23096;\n            float B_23098 = x_23097 / 1.0e-2F;\n            float x_23099 = B_23098 - res_23093;\n            float x_23100 = 4.4999997e-6F * x_23099;\n            float A1_23101 = x_23100 / 1.0e-4F;\n            float y_23102 = fpow32(B_23098, 2.0F);\n            float x_23103 = 1.0000001e-6F * y_23102;\n            float A2_23104 = x_23103 / 4.0e-2F;\n            float exp_arg_23105 = A1_23101 - A2_23104;\n            float res_23106 = fpow32(2.7182817F, exp_arg_23105);\n            float negate_arg_23107 = 5.0e-2F * B_23098;\n            float exp_arg_23108 = 0.0F - negate_arg_23107;\n            float res_23109 = fpow32(2.7182817F, exp_arg_23108);\n            float res_23110 = res_23106 * res_23109;\n            float res_23090 = res_23110 + redout_27074;\n            float redout_tmp_27341 = res_23090;\n            \n            redout_27074 = redout_tmp_27341;\n        }\n        res_23087 = redout_27074;\n        \n        float x_23111 = 1.0F - res_23086;\n        float y_23112 = res_23059 * res_23087;\n        float res_23113 = x_23111 / y_23112;\n        \n        ((__global",
                   " float *) mem_27188)[gtid_22981] = res_23113;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_23048\n}\n__kernel void testzisegmap_23131(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, __global\n                                 unsigned char *mem_27174, __global\n                                 unsigned char *mem_27176, __global\n                                 unsigned char *mem_27197)\n{\n    #define segmap_group_sizze_23197 (testzisegmap_group_sizze_23133)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27342;\n    int32_t local_tid_27343;\n    int64_t group_sizze_27346;\n    int32_t wave_sizze_27345;\n    int32_t group_tid_27344;\n    \n    global_tid_27342 = get_global_id(0);\n    local_tid_27343 = get_local_id(0);\n    group_sizze_27346 = get_local_size(0);\n    wave_sizze_27345 = LOCKSTEP_WIDTH;\n    group_tid_27344 = get_group_id(0);\n    \n    int32_t phys_tid_23131;\n    \n    phys_tid_23131 = global_tid_27342;\n    \n    int64_t gtid_23130;\n    \n    gtid_23130 = sext_i32_i64(group_tid_27344) * segmap_group_sizze_23197 +\n        sext_i32_i64(local_tid_27343);\n    if (slt64(gtid_23130, 4)) {\n        float res_23208 = ((__global float *) mem_27176)[gtid_23130];\n        int64_t res_23209 = ((__global int64_t *) mem_27174)[gtid_23130];\n        bool bounds_invalid_upwards_23211 = slt64(res_23209, 1);\n        bool valid_23212 = !bounds_invalid_upwards_23211;\n        bool range_valid_c_23213;\n        \n        if (!valid_23212) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 18) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = 2;\n                    global_failure_args[2] = res_23209;\n                    ;\n                }\n                return;\n ",
                   "           }\n        }\n        \n        bool y_23215 = slt64(0, res_23209);\n        bool index_certs_23216;\n        \n        if (!y_23215) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 19) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_23209;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_23217 = sitofp_i64_f32(res_23209);\n        float index_primexp_23218 = res_23208 * binop_y_23217;\n        float negate_arg_23219 = 1.0e-2F * index_primexp_23218;\n        float exp_arg_23220 = 0.0F - negate_arg_23219;\n        float res_23221 = fpow32(2.7182817F, exp_arg_23220);\n        float x_23222 = 1.0F - res_23221;\n        float B_23223 = x_23222 / 1.0e-2F;\n        float x_23224 = B_23223 - index_primexp_23218;\n        float x_23225 = 4.4999997e-6F * x_23224;\n        float A1_23226 = x_23225 / 1.0e-4F;\n        float y_23227 = fpow32(B_23223, 2.0F);\n        float x_23228 = 1.0000001e-6F * y_23227;\n        float A2_23229 = x_23228 / 4.0e-2F;\n        float exp_arg_23230 = A1_23226 - A2_23229;\n        float res_23231 = fpow32(2.7182817F, exp_arg_23230);\n        float negate_arg_23232 = 5.0e-2F * B_23223;\n        float exp_arg_23233 = 0.0F - negate_arg_23232;\n        float res_23234 = fpow32(2.7182817F, exp_arg_23233);\n        float res_23235 = res_23231 * res_23234;\n        float res_23236;\n        float redout_27078 = 0.0F;\n        \n        for (int64_t i_27079 = 0; i_27079 < res_23209; i_27079++) {\n            int64_t index_primexp_27120 = add64(1, i_27079);\n            float res_23241 = sitofp_i64_f32(index_primexp_27120);\n            float res_23242 = res_23208 * res_23241;\n            float negate_arg_23243 = 1.0e-2F * res_23242;\n            float exp_arg_23244 = 0.0F - negate_arg_23243;\n            float res_23245 = fpow32(2.7182817F, exp_arg_23244);\n            float x_23246 = 1.0F - res_23245;\n            float",
                   " B_23247 = x_23246 / 1.0e-2F;\n            float x_23248 = B_23247 - res_23242;\n            float x_23249 = 4.4999997e-6F * x_23248;\n            float A1_23250 = x_23249 / 1.0e-4F;\n            float y_23251 = fpow32(B_23247, 2.0F);\n            float x_23252 = 1.0000001e-6F * y_23251;\n            float A2_23253 = x_23252 / 4.0e-2F;\n            float exp_arg_23254 = A1_23250 - A2_23253;\n            float res_23255 = fpow32(2.7182817F, exp_arg_23254);\n            float negate_arg_23256 = 5.0e-2F * B_23247;\n            float exp_arg_23257 = 0.0F - negate_arg_23256;\n            float res_23258 = fpow32(2.7182817F, exp_arg_23257);\n            float res_23259 = res_23255 * res_23258;\n            float res_23239 = res_23259 + redout_27078;\n            float redout_tmp_27347 = res_23239;\n            \n            redout_27078 = redout_tmp_27347;\n        }\n        res_23236 = redout_27078;\n        \n        float x_23260 = 1.0F - res_23235;\n        float y_23261 = res_23208 * res_23236;\n        float res_23262 = x_23260 / y_23261;\n        \n        ((__global float *) mem_27197)[gtid_23130] = res_23262;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_23197\n}\n__kernel void testzisegmap_23440(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args,\n                                 int64_t paths_20195, int64_t steps_20196,\n                                 float dt_20209, int64_t upper_bound_20289,\n                                 float res_20290, int64_t num_groups_23692,\n                                 __global unsigned char *mem_27211, __global\n                                 unsigned char *mem_27214, __global\n                                 unsigned char *mem_27229)\n{\n    #define segmap_group_sizze_23691 (testzisegmap_group_sizze_23442)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile __local bool loc",
                   "al_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27360;\n    int32_t local_tid_27361;\n    int64_t group_sizze_27364;\n    int32_t wave_sizze_27363;\n    int32_t group_tid_27362;\n    \n    global_tid_27360 = get_global_id(0);\n    local_tid_27361 = get_local_id(0);\n    group_sizze_27364 = get_local_size(0);\n    wave_sizze_27363 = LOCKSTEP_WIDTH;\n    group_tid_27362 = get_group_id(0);\n    \n    int32_t phys_tid_23440;\n    \n    phys_tid_23440 = global_tid_27360;\n    \n    int32_t phys_group_id_27365;\n    \n    phys_group_id_27365 = get_group_id(0);\n    for (int32_t i_27366 = 0; i_27366 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(paths_20195,\n                                          segmap_group_sizze_23691)) -\n                   phys_group_id_27365, sext_i64_i32(num_groups_23692));\n         i_27366++) {\n        int32_t virt_group_id_27367 = phys_group_id_27365 + i_27366 *\n                sext_i64_i32(num_groups_23692);\n        int64_t gtid_23439 = sext_i32_i64(virt_group_id_27367) *\n                segmap_group_sizze_23691 + sext_i32_i64(local_tid_27361);\n        \n        if (slt64(gtid_23439, paths_20195)) {\n            for (int64_t i_27368 = 0; i_27368 < steps_20196; i_27368++) {\n                ((__global float *) mem_27214)[phys_tid_23440 + i_27368 *\n                                               (num_groups_23692 *\n                                                segmap_group_sizze_23691)] =\n                    5.0e-2F;\n            }\n            for (int64_t i_23698 = 0; i_23698 < upper_bound_20289; i_23698++) {\n                bool y_23700 = slt64(i_23698, steps_20196);\n                bool index_certs_23701;\n                \n                if (!y_23700) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 20) ==\n                            -",
                   "1) {\n                            global_failure_args[0] = i_23698;\n                            global_failure_args[1] = steps_20196;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float shortstep_arg_23702 = ((__global\n                                              float *) mem_27211)[i_23698 *\n                                                                  paths_20195 +\n                                                                  gtid_23439];\n                float shortstep_arg_23703 = ((__global\n                                              float *) mem_27214)[phys_tid_23440 +\n                                                                  i_23698 *\n                                                                  (num_groups_23692 *\n                                                                   segmap_group_sizze_23691)];\n                float y_23704 = 5.0e-2F - shortstep_arg_23703;\n                float x_23705 = 1.0e-2F * y_23704;\n                float x_23706 = dt_20209 * x_23705;\n                float x_23707 = res_20290 * shortstep_arg_23702;\n                float y_23708 = 1.0e-3F * x_23707;\n                float delta_r_23709 = x_23706 + y_23708;\n                float res_23710 = shortstep_arg_23703 + delta_r_23709;\n                int64_t i_23711 = add64(1, i_23698);\n                bool x_23712 = sle64(0, i_23711);\n                bool y_23713 = slt64(i_23711, steps_20196);\n                bool bounds_check_23714 = x_23712 && y_23713;\n                bool index_certs_23715;\n                \n                if (!bounds_check_23714) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 21) ==\n                            -1) {\n                            global_failure_args[0] = i_23711;\n                            global_failure_args[1] ",
                   "= steps_20196;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                ((__global float *) mem_27214)[phys_tid_23440 + i_23711 *\n                                               (num_groups_23692 *\n                                                segmap_group_sizze_23691)] =\n                    res_23710;\n            }\n            for (int64_t i_27370 = 0; i_27370 < steps_20196; i_27370++) {\n                ((__global float *) mem_27229)[i_27370 * paths_20195 +\n                                               gtid_23439] = ((__global\n                                                               float *) mem_27214)[phys_tid_23440 +\n                                                                                   i_27370 *\n                                                                                   (num_groups_23692 *\n                                                                                    segmap_group_sizze_23691)];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_23691\n}\n__kernel void testzisegmap_23538(__global int *global_failure,\n                                 int64_t paths_20195, int64_t steps_20196,\n                                 __global unsigned char *mem_27204, __global\n                                 unsigned char *mem_27208)\n{\n    #define segmap_group_sizze_23646 (testzisegmap_group_sizze_23541)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27354;\n    int32_t local_tid_27355;\n    int64_t group_sizze_27358;\n    int32_t wave_sizze_27357;\n    int32_t group_tid_27356;\n    \n    global_tid_27354 = get_global_id(0);\n    local_tid_27355 = get_local_id(0);\n    group_sizze_27358 = get_l",
                   "ocal_size(0);\n    wave_sizze_27357 = LOCKSTEP_WIDTH;\n    group_tid_27356 = get_group_id(0);\n    \n    int32_t phys_tid_23538;\n    \n    phys_tid_23538 = global_tid_27354;\n    \n    int64_t gtid_23536;\n    \n    gtid_23536 = squot64(sext_i32_i64(group_tid_27356) *\n                         segmap_group_sizze_23646 +\n                         sext_i32_i64(local_tid_27355), steps_20196);\n    \n    int64_t gtid_23537;\n    \n    gtid_23537 = sext_i32_i64(group_tid_27356) * segmap_group_sizze_23646 +\n        sext_i32_i64(local_tid_27355) - squot64(sext_i32_i64(group_tid_27356) *\n                                                segmap_group_sizze_23646 +\n                                                sext_i32_i64(local_tid_27355),\n                                                steps_20196) * steps_20196;\n    if (slt64(gtid_23536, paths_20195) && slt64(gtid_23537, steps_20196)) {\n        int32_t unsign_arg_23649 = ((__global int32_t *) mem_27204)[gtid_23536];\n        int32_t res_23651 = sext_i64_i32(gtid_23537);\n        int32_t x_23652 = lshr32(res_23651, 16);\n        int32_t x_23653 = res_23651 ^ x_23652;\n        int32_t x_23654 = mul32(73244475, x_23653);\n        int32_t x_23655 = lshr32(x_23654, 16);\n        int32_t x_23656 = x_23654 ^ x_23655;\n        int32_t x_23657 = mul32(73244475, x_23656);\n        int32_t x_23658 = lshr32(x_23657, 16);\n        int32_t x_23659 = x_23657 ^ x_23658;\n        int32_t unsign_arg_23660 = unsign_arg_23649 ^ x_23659;\n        int32_t unsign_arg_23661 = mul32(48271, unsign_arg_23660);\n        int32_t unsign_arg_23662 = umod32(unsign_arg_23661, 2147483647);\n        int32_t unsign_arg_23663 = mul32(48271, unsign_arg_23662);\n        int32_t unsign_arg_23664 = umod32(unsign_arg_23663, 2147483647);\n        float res_23665 = uitofp_i32_f32(unsign_arg_23662);\n        float res_23666 = res_23665 / 2.1474836e9F;\n        float res_23667 = uitofp_i32_f32(unsign_arg_23664);\n        float res_23668 = res_23667 / 2.1474836e9F;\n        float res_23669;\n        \n  ",
                   "      res_23669 = futrts_log32(res_23666);\n        \n        float res_23670 = -2.0F * res_23669;\n        float res_23671;\n        \n        res_23671 = futrts_sqrt32(res_23670);\n        \n        float res_23672 = 6.2831855F * res_23668;\n        float res_23673;\n        \n        res_23673 = futrts_cos32(res_23672);\n        \n        float res_23674 = res_23671 * res_23673;\n        \n        ((__global float *) mem_27208)[gtid_23536 * steps_20196 + gtid_23537] =\n            res_23674;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_23646\n}\n__kernel void testzisegmap_23602(__global int *global_failure,\n                                 int64_t paths_20195, __global\n                                 unsigned char *mem_27204)\n{\n    #define segmap_group_sizze_23621 (testzisegmap_group_sizze_23604)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27349;\n    int32_t local_tid_27350;\n    int64_t group_sizze_27353;\n    int32_t wave_sizze_27352;\n    int32_t group_tid_27351;\n    \n    global_tid_27349 = get_global_id(0);\n    local_tid_27350 = get_local_id(0);\n    group_sizze_27353 = get_local_size(0);\n    wave_sizze_27352 = LOCKSTEP_WIDTH;\n    group_tid_27351 = get_group_id(0);\n    \n    int32_t phys_tid_23602;\n    \n    phys_tid_23602 = global_tid_27349;\n    \n    int64_t gtid_23601;\n    \n    gtid_23601 = sext_i32_i64(group_tid_27351) * segmap_group_sizze_23621 +\n        sext_i32_i64(local_tid_27350);\n    if (slt64(gtid_23601, paths_20195)) {\n        int32_t res_23625 = sext_i64_i32(gtid_23601);\n        int32_t x_23626 = lshr32(res_23625, 16);\n        int32_t x_23627 = res_23625 ^ x_23626;\n        int32_t x_23628 = mul32(73244475, x_23627);\n        int32_t x_23629 = lshr32(x_23628, 16);\n        int32_t x_23630 = x_23628 ^ x_23629;\n        int32_t x_23631 = mul32(73244475, x_23630);\n        int32_t x_23632 = lshr32(x_23631, 16);\n        int32_t x_2",
                   "3633 = x_23631 ^ x_23632;\n        int32_t unsign_arg_23634 = 777822902 ^ x_23633;\n        int32_t unsign_arg_23635 = mul32(48271, unsign_arg_23634);\n        int32_t unsign_arg_23636 = umod32(unsign_arg_23635, 2147483647);\n        \n        ((__global int32_t *) mem_27204)[gtid_23601] = unsign_arg_23636;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_23621\n}\n__kernel void testzisegmap_23878(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args,\n                                 int64_t paths_20195, int64_t steps_20196,\n                                 float sims_per_year_20275, float res_20352,\n                                 __global unsigned char *res_mem_27198, __global\n                                 unsigned char *res_mem_27199, __global\n                                 unsigned char *res_mem_27200, __global\n                                 unsigned char *res_mem_27201, __global\n                                 unsigned char *mem_27229, __global\n                                 unsigned char *mem_27235)\n{\n    #define segmap_group_sizze_24601 (testzisegmap_group_sizze_23880)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27407;\n    int32_t local_tid_27408;\n    int64_t group_sizze_27411;\n    int32_t wave_sizze_27410;\n    int32_t group_tid_27409;\n    \n    global_tid_27407 = get_global_id(0);\n    local_tid_27408 = get_local_id(0);\n    group_sizze_27411 = get_local_size(0);\n    wave_sizze_27410 = LOCKSTEP_WIDTH;\n    group_tid_27409 = get_group_id(0);\n    \n    int32_t phys_tid_23878;\n    \n    phys_tid_23878 = global_tid_27407;\n    \n    int64_t gtid_23877;\n    \n    gtid_23877 = sext_i32_i64(group_tid_27409) * segmap_group_sizze_24601 +\n        sext_i32_i64(local_tid_27408);\n    if (slt64(gtid_23877, steps_20196)) {\n        ",
                   "int64_t index_primexp_27096 = add64(1, gtid_23877);\n        float res_24607 = sitofp_i64_f32(index_primexp_27096);\n        float res_24608 = res_24607 / sims_per_year_20275;\n        float res_24609;\n        float redout_27153 = 0.0F;\n        \n        for (int64_t i_27154 = 0; i_27154 < paths_20195; i_27154++) {\n            float x_24613 = ((__global float *) mem_27229)[gtid_23877 *\n                                                           paths_20195 +\n                                                           i_27154];\n            float res_24615;\n            float redout_27155 = 0.0F;\n            \n            for (int32_t i_27165 = 0; i_27165 < 4; i_27165++) {\n                int64_t i_27156 = sext_i32_i64(i_27165);\n                int64_t x_24621 = ((__global int64_t *) res_mem_27200)[i_27156];\n                float x_24622 = ((__global float *) res_mem_27201)[i_27156];\n                int64_t i64_arg_24623 = sub64(x_24621, 1);\n                float res_24624 = sitofp_i64_f32(i64_arg_24623);\n                float y_24625 = x_24622 * res_24624;\n                bool cond_24626 = y_24625 < res_24608;\n                float ceil_arg_24627 = res_24608 / x_24622;\n                float res_24628;\n                \n                res_24628 = futrts_ceil32(ceil_arg_24627);\n                \n                int64_t res_24629 = fptosi_f32_i64(res_24628);\n                int64_t remaining_24630 = sub64(x_24621, res_24629);\n                float res_24631;\n                \n                if (cond_24626) {\n                    res_24631 = 0.0F;\n                } else {\n                    float x_24619 = ((__global float *) res_mem_27198)[i_27156];\n                    float x_24620 = ((__global float *) res_mem_27199)[i_27156];\n                    float nextpayment_24632 = x_24622 * res_24628;\n                    bool bounds_invalid_upwards_24633 = slt64(remaining_24630,\n                                                              1);\n                    bool valid_24634 = !bo",
                   "unds_invalid_upwards_24633;\n                    bool range_valid_c_24635;\n                    \n                    if (!valid_24634) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1,\n                                                          24) == -1) {\n                                global_failure_args[0] = 1;\n                                global_failure_args[1] = 2;\n                                global_failure_args[2] = remaining_24630;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    \n                    float y_24637 = nextpayment_24632 - res_24608;\n                    float negate_arg_24638 = 1.0e-2F * y_24637;\n                    float exp_arg_24639 = 0.0F - negate_arg_24638;\n                    float res_24640 = fpow32(2.7182817F, exp_arg_24639);\n                    float x_24641 = 1.0F - res_24640;\n                    float B_24642 = x_24641 / 1.0e-2F;\n                    float x_24643 = B_24642 - nextpayment_24632;\n                    float x_24644 = res_24608 + x_24643;\n                    float x_24645 = 4.4999997e-6F * x_24644;\n                    float A1_24646 = x_24645 / 1.0e-4F;\n                    float y_24647 = fpow32(B_24642, 2.0F);\n                    float x_24648 = 1.0000001e-6F * y_24647;\n                    float A2_24649 = x_24648 / 4.0e-2F;\n                    float exp_arg_24650 = A1_24646 - A2_24649;\n                    float res_24651 = fpow32(2.7182817F, exp_arg_24650);\n                    float negate_arg_24652 = x_24613 * B_24642;\n                    float exp_arg_24653 = 0.0F - negate_arg_24652;\n                    float res_24654 = fpow32(2.7182817F, exp_arg_24653);\n                    float res_24655 = res_24651 * res_24654;\n                    bool y_24656 = slt64(0, remaining_24630);\n                    bool index_certs_24657;\n                    \n    ",
                   "                if (!y_24656) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1,\n                                                          25) == -1) {\n                                global_failure_args[0] = 0;\n                                global_failure_args[1] = remaining_24630;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    \n                    float binop_y_24658 = sitofp_i64_f32(remaining_24630);\n                    float binop_y_24659 = x_24622 * binop_y_24658;\n                    float index_primexp_24660 = nextpayment_24632 +\n                          binop_y_24659;\n                    float y_24661 = index_primexp_24660 - res_24608;\n                    float negate_arg_24662 = 1.0e-2F * y_24661;\n                    float exp_arg_24663 = 0.0F - negate_arg_24662;\n                    float res_24664 = fpow32(2.7182817F, exp_arg_24663);\n                    float x_24665 = 1.0F - res_24664;\n                    float B_24666 = x_24665 / 1.0e-2F;\n                    float x_24667 = B_24666 - index_primexp_24660;\n                    float x_24668 = res_24608 + x_24667;\n                    float x_24669 = 4.4999997e-6F * x_24668;\n                    float A1_24670 = x_24669 / 1.0e-4F;\n                    float y_24671 = fpow32(B_24666, 2.0F);\n                    float x_24672 = 1.0000001e-6F * y_24671;\n                    float A2_24673 = x_24672 / 4.0e-2F;\n                    float exp_arg_24674 = A1_24670 - A2_24673;\n                    float res_24675 = fpow32(2.7182817F, exp_arg_24674);\n                    float negate_arg_24676 = x_24613 * B_24666;\n                    float exp_arg_24677 = 0.0F - negate_arg_24676;\n                    float res_24678 = fpow32(2.7182817F, exp_arg_24677);\n                    float res_24679 = res_24675 * res_24678;\n                    float res_24680;\n  ",
                   "                  float redout_27093 = 0.0F;\n                    \n                    for (int64_t i_27094 = 0; i_27094 < remaining_24630;\n                         i_27094++) {\n                        int64_t index_primexp_27130 = add64(1, i_27094);\n                        float res_24685 = sitofp_i64_f32(index_primexp_27130);\n                        float res_24686 = x_24622 * res_24685;\n                        float res_24687 = nextpayment_24632 + res_24686;\n                        float y_24688 = res_24687 - res_24608;\n                        float negate_arg_24689 = 1.0e-2F * y_24688;\n                        float exp_arg_24690 = 0.0F - negate_arg_24689;\n                        float res_24691 = fpow32(2.7182817F, exp_arg_24690);\n                        float x_24692 = 1.0F - res_24691;\n                        float B_24693 = x_24692 / 1.0e-2F;\n                        float x_24694 = B_24693 - res_24687;\n                        float x_24695 = res_24608 + x_24694;\n                        float x_24696 = 4.4999997e-6F * x_24695;\n                        float A1_24697 = x_24696 / 1.0e-4F;\n                        float y_24698 = fpow32(B_24693, 2.0F);\n                        float x_24699 = 1.0000001e-6F * y_24698;\n                        float A2_24700 = x_24699 / 4.0e-2F;\n                        float exp_arg_24701 = A1_24697 - A2_24700;\n                        float res_24702 = fpow32(2.7182817F, exp_arg_24701);\n                        float negate_arg_24703 = x_24613 * B_24693;\n                        float exp_arg_24704 = 0.0F - negate_arg_24703;\n                        float res_24705 = fpow32(2.7182817F, exp_arg_24704);\n                        float res_24706 = res_24702 * res_24705;\n                        float res_24683 = res_24706 + redout_27093;\n                        float redout_tmp_27414 = res_24683;\n                        \n                        redout_27093 = redout_tmp_27414;\n                    }\n                    res_24680 = redout_27093;\n ",
                   "                   \n                    float x_24707 = res_24655 - res_24679;\n                    float x_24708 = x_24619 * x_24622;\n                    float y_24709 = res_24680 * x_24708;\n                    float y_24710 = x_24707 - y_24709;\n                    float res_24711 = x_24620 * y_24710;\n                    float res_24712 = x_24620 * res_24711;\n                    \n                    res_24631 = res_24712;\n                }\n                \n                float res_24618 = res_24631 + redout_27155;\n                float redout_tmp_27413 = res_24618;\n                \n                redout_27155 = redout_tmp_27413;\n            }\n            res_24615 = redout_27155;\n            \n            float res_24713 = fmax32(0.0F, res_24615);\n            float res_24612 = res_24713 + redout_27153;\n            float redout_tmp_27412 = res_24612;\n            \n            redout_27153 = redout_tmp_27412;\n        }\n        res_24609 = redout_27153;\n        \n        float res_24714 = res_24609 / res_20352;\n        float negate_arg_24715 = 1.0e-2F * res_24608;\n        float exp_arg_24716 = 0.0F - negate_arg_24715;\n        float res_24717 = fpow32(2.7182817F, exp_arg_24716);\n        float x_24718 = 1.0F - res_24717;\n        float B_24719 = x_24718 / 1.0e-2F;\n        float x_24720 = B_24719 - res_24608;\n        float x_24721 = 4.4999997e-6F * x_24720;\n        float A1_24722 = x_24721 / 1.0e-4F;\n        float y_24723 = fpow32(B_24719, 2.0F);\n        float x_24724 = 1.0000001e-6F * y_24723;\n        float A2_24725 = x_24724 / 4.0e-2F;\n        float exp_arg_24726 = A1_24722 - A2_24725;\n        float res_24727 = fpow32(2.7182817F, exp_arg_24726);\n        float negate_arg_24728 = 5.0e-2F * B_24719;\n        float exp_arg_24729 = 0.0F - negate_arg_24728;\n        float res_24730 = fpow32(2.7182817F, exp_arg_24729);\n        float res_24731 = res_24727 * res_24730;\n        float res_24732 = res_24714 * res_24731;\n        \n        ((__global float *) mem_27235)[gtid_23877] = res_",
                   "24732;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_24601\n}\n__kernel void testzisegmap_24283(__global int *global_failure,\n                                 int64_t steps_20196, float sims_per_year_20275,\n                                 float res_20352, __global\n                                 unsigned char *mem_27242, __global\n                                 unsigned char *mem_27245)\n{\n    #define segmap_group_sizze_24984 (testzisegmap_group_sizze_24285)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27491;\n    int32_t local_tid_27492;\n    int64_t group_sizze_27495;\n    int32_t wave_sizze_27494;\n    int32_t group_tid_27493;\n    \n    global_tid_27491 = get_global_id(0);\n    local_tid_27492 = get_local_id(0);\n    group_sizze_27495 = get_local_size(0);\n    wave_sizze_27494 = LOCKSTEP_WIDTH;\n    group_tid_27493 = get_group_id(0);\n    \n    int32_t phys_tid_24283;\n    \n    phys_tid_24283 = global_tid_27491;\n    \n    int64_t gtid_24282;\n    \n    gtid_24282 = sext_i32_i64(group_tid_27493) * segmap_group_sizze_24984 +\n        sext_i32_i64(local_tid_27492);\n    if (slt64(gtid_24282, steps_20196)) {\n        int64_t convop_x_27114 = add64(1, gtid_24282);\n        float binop_x_27115 = sitofp_i64_f32(convop_x_27114);\n        float index_primexp_27116 = binop_x_27115 / sims_per_year_20275;\n        float res_24988 = ((__global float *) mem_27242)[gtid_24282];\n        float res_24989 = res_24988 / res_20352;\n        float negate_arg_24990 = 1.0e-2F * index_primexp_27116;\n        float exp_arg_24991 = 0.0F - negate_arg_24990;\n        float res_24992 = fpow32(2.7182817F, exp_arg_24991);\n        float x_24993 = 1.0F - res_24992;\n        float B_24994 = x_24993 / 1.0e-2F;\n        float x_24995 = B_24994 - index_primexp_27116;\n        float x_24996 = 4.4999997e-6F * x_24995;\n        float A1_24997 = x_24996 / 1.0e-4F;\n        float y_24998 =",
                   " fpow32(B_24994, 2.0F);\n        float x_24999 = 1.0000001e-6F * y_24998;\n        float A2_25000 = x_24999 / 4.0e-2F;\n        float exp_arg_25001 = A1_24997 - A2_25000;\n        float res_25002 = fpow32(2.7182817F, exp_arg_25001);\n        float negate_arg_25003 = 5.0e-2F * B_24994;\n        float exp_arg_25004 = 0.0F - negate_arg_25003;\n        float res_25005 = fpow32(2.7182817F, exp_arg_25004);\n        float res_25006 = res_25002 * res_25005;\n        float res_25007 = res_24989 * res_25006;\n        \n        ((__global float *) mem_27245)[gtid_24282] = res_25007;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_24984\n}\n__kernel void testzisegmap_intragroup_23876(__global int *global_failure,\n                                            int failure_is_an_option, __global\n                                            int64_t *global_failure_args,\n                                            __local volatile\n                                            int64_t *red_arr_mem_27421_backing_aligned_0,\n                                            int64_t paths_20195,\n                                            float sims_per_year_20275,\n                                            float res_20352, __global\n                                            unsigned char *res_mem_27198,\n                                            __global\n                                            unsigned char *res_mem_27199,\n                                            __global\n                                            unsigned char *res_mem_27200,\n                                            __global\n                                            unsigned char *res_mem_27201,\n                                            __global unsigned char *mem_27229,\n                                            __global unsigned char *mem_27239)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27421_backing_0 =\n     ",
                   "                     (__local volatile\n                           char *) red_arr_mem_27421_backing_aligned_0;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27415;\n    int32_t local_tid_27416;\n    int64_t group_sizze_27419;\n    int32_t wave_sizze_27418;\n    int32_t group_tid_27417;\n    \n    global_tid_27415 = get_global_id(0);\n    local_tid_27416 = get_local_id(0);\n    group_sizze_27419 = get_local_size(0);\n    wave_sizze_27418 = LOCKSTEP_WIDTH;\n    group_tid_27417 = get_group_id(0);\n    \n    int32_t phys_tid_23876;\n    \n    phys_tid_23876 = group_tid_27417;\n    \n    int32_t ltid_pre_27420;\n    \n    ltid_pre_27420 = local_tid_27416;\n    \n    int64_t gtid_23871;\n    \n    gtid_23871 = sext_i32_i64(group_tid_27417);\n    \n    int64_t index_primexp_27104;\n    \n    index_primexp_27104 = add64(1, gtid_23871);\n    \n    float res_24738 = sitofp_i64_f32(index_primexp_27104);\n    float res_24739 = res_24738 / sims_per_year_20275;\n    float res_24740;\n    int64_t gtid_23874 = sext_i32_i64(ltid_pre_27420);\n    int32_t phys_tid_23875 = local_tid_27416;\n    __local char *red_arr_mem_27421;\n    \n    red_arr_mem_27421 = (__local char *) red_arr_mem_27421_backing_0;\n    if (slt64(gtid_23874, paths_20195)) {\n        float x_24744 = ((__global float *) mem_27229)[gtid_23871 *\n                                                       paths_20195 +\n                                                       gtid_23874];\n        float res_24746;\n        float redout_27157 = 0.0F;\n        \n        for (int32_t i_27169 = 0; i_27169 < 4; i_27169++) {\n            int64_t i_27158 = sext_i32_i64(i_27169);\n            int64_t x_24752 = ((__global int64_t *) res_mem_27200)[i_27158];\n            float x_24753 = ((__global float *) res_mem_27201)[i_27158];\n            int64_t i64_arg_24754 =",
                   " sub64(x_24752, 1);\n            float res_24755 = sitofp_i64_f32(i64_arg_24754);\n            float y_24756 = x_24753 * res_24755;\n            bool cond_24757 = y_24756 < res_24739;\n            float ceil_arg_24758 = res_24739 / x_24753;\n            float res_24759;\n            \n            res_24759 = futrts_ceil32(ceil_arg_24758);\n            \n            int64_t res_24760 = fptosi_f32_i64(res_24759);\n            int64_t remaining_24761 = sub64(x_24752, res_24760);\n            float res_24762;\n            \n            if (cond_24757) {\n                res_24762 = 0.0F;\n            } else {\n                float x_24750 = ((__global float *) res_mem_27198)[i_27158];\n                float x_24751 = ((__global float *) res_mem_27199)[i_27158];\n                float nextpayment_24763 = x_24753 * res_24759;\n                bool bounds_invalid_upwards_24764 = slt64(remaining_24761, 1);\n                bool valid_24765 = !bounds_invalid_upwards_24764;\n                bool range_valid_c_24766;\n                \n                if (!valid_24765) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 26) ==\n                            -1) {\n                            global_failure_args[0] = 1;\n                            global_failure_args[1] = 2;\n                            global_failure_args[2] = remaining_24761;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float y_24768 = nextpayment_24763 - res_24739;\n                float negate_arg_24769 = 1.0e-2F * y_24768;\n                float exp_arg_24770 = 0.0F - negate_arg_24769;\n                float res_24771 = fpow32(2.7182817F, exp_arg_24770);\n                float x_24772 = 1.0F - res_24771;\n                float B_24773 = x_24772 / 1.0e-2F;\n                float x_24774 = B_24773 - nextpayment_24763;\n            ",
                   "    float x_24775 = res_24739 + x_24774;\n                float x_24776 = 4.4999997e-6F * x_24775;\n                float A1_24777 = x_24776 / 1.0e-4F;\n                float y_24778 = fpow32(B_24773, 2.0F);\n                float x_24779 = 1.0000001e-6F * y_24778;\n                float A2_24780 = x_24779 / 4.0e-2F;\n                float exp_arg_24781 = A1_24777 - A2_24780;\n                float res_24782 = fpow32(2.7182817F, exp_arg_24781);\n                float negate_arg_24783 = x_24744 * B_24773;\n                float exp_arg_24784 = 0.0F - negate_arg_24783;\n                float res_24785 = fpow32(2.7182817F, exp_arg_24784);\n                float res_24786 = res_24782 * res_24785;\n                bool y_24787 = slt64(0, remaining_24761);\n                bool index_certs_24788;\n                \n                if (!y_24787) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 27) ==\n                            -1) {\n                            global_failure_args[0] = 0;\n                            global_failure_args[1] = remaining_24761;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float binop_y_24789 = sitofp_i64_f32(remaining_24761);\n                float binop_y_24790 = x_24753 * binop_y_24789;\n                float index_primexp_24791 = nextpayment_24763 + binop_y_24790;\n                float y_24792 = index_primexp_24791 - res_24739;\n                float negate_arg_24793 = 1.0e-2F * y_24792;\n                float exp_arg_24794 = 0.0F - negate_arg_24793;\n                float res_24795 = fpow32(2.7182817F, exp_arg_24794);\n                float x_24796 = 1.0F - res_24795;\n                float B_24797 = x_24796 / 1.0e-2F;\n                float x_24798 = B_24797 - index_primexp_24791;\n                float x_24799 = res_24739 + x_24798;\n               ",
                   " float x_24800 = 4.4999997e-6F * x_24799;\n                float A1_24801 = x_24800 / 1.0e-4F;\n                float y_24802 = fpow32(B_24797, 2.0F);\n                float x_24803 = 1.0000001e-6F * y_24802;\n                float A2_24804 = x_24803 / 4.0e-2F;\n                float exp_arg_24805 = A1_24801 - A2_24804;\n                float res_24806 = fpow32(2.7182817F, exp_arg_24805);\n                float negate_arg_24807 = x_24744 * B_24797;\n                float exp_arg_24808 = 0.0F - negate_arg_24807;\n                float res_24809 = fpow32(2.7182817F, exp_arg_24808);\n                float res_24810 = res_24806 * res_24809;\n                float res_24811;\n                float redout_27097 = 0.0F;\n                \n                for (int64_t i_27098 = 0; i_27098 < remaining_24761;\n                     i_27098++) {\n                    int64_t index_primexp_27132 = add64(1, i_27098);\n                    float res_24816 = sitofp_i64_f32(index_primexp_27132);\n                    float res_24817 = x_24753 * res_24816;\n                    float res_24818 = nextpayment_24763 + res_24817;\n                    float y_24819 = res_24818 - res_24739;\n                    float negate_arg_24820 = 1.0e-2F * y_24819;\n                    float exp_arg_24821 = 0.0F - negate_arg_24820;\n                    float res_24822 = fpow32(2.7182817F, exp_arg_24821);\n                    float x_24823 = 1.0F - res_24822;\n                    float B_24824 = x_24823 / 1.0e-2F;\n                    float x_24825 = B_24824 - res_24818;\n                    float x_24826 = res_24739 + x_24825;\n                    float x_24827 = 4.4999997e-6F * x_24826;\n                    float A1_24828 = x_24827 / 1.0e-4F;\n                    float y_24829 = fpow32(B_24824, 2.0F);\n                    float x_24830 = 1.0000001e-6F * y_24829;\n                    float A2_24831 = x_24830 / 4.0e-2F;\n                    float exp_arg_24832 = A1_24828 - A2_24831;\n                    float res_24833 = fpow32(2.7182817F",
                   ", exp_arg_24832);\n                    float negate_arg_24834 = x_24744 * B_24824;\n                    float exp_arg_24835 = 0.0F - negate_arg_24834;\n                    float res_24836 = fpow32(2.7182817F, exp_arg_24835);\n                    float res_24837 = res_24833 * res_24836;\n                    float res_24814 = res_24837 + redout_27097;\n                    float redout_tmp_27424 = res_24814;\n                    \n                    redout_27097 = redout_tmp_27424;\n                }\n                res_24811 = redout_27097;\n                \n                float x_24838 = res_24786 - res_24810;\n                float x_24839 = x_24750 * x_24753;\n                float y_24840 = res_24811 * x_24839;\n                float y_24841 = x_24838 - y_24840;\n                float res_24842 = x_24751 * y_24841;\n                float res_24843 = x_24751 * res_24842;\n                \n                res_24762 = res_24843;\n            }\n            \n            float res_24749 = res_24762 + redout_27157;\n            float redout_tmp_27423 = res_24749;\n            \n            redout_27157 = redout_tmp_27423;\n        }\n        res_24746 = redout_27157;\n        \n        float res_24844 = fmax32(0.0F, res_24746);\n        \n        ((__local float *) red_arr_mem_27421)[gtid_23874] = res_24844;\n    }\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_27425;\n    int32_t skip_waves_27426;\n    \n    skip_waves_27426 = 1;\n    \n    float x_24741;\n    float x_24742;\n    \n    offset_27425 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_27416, sext_i64_i32(paths_20195))) {\n            x_24741 = ((__local\n                        float *) red_arr_mem_27421)[sext_i32_i64(local_tid_27416 +\n                                                    offset_27425)];\n        }\n    }\n    offset_27425 = 1;\n    while (slt32(offset_27425, wave_sizze_27418)) {\n        if",
                   " (slt32(local_tid_27416 + offset_27425, sext_i64_i32(paths_20195)) &&\n            ((local_tid_27416 - squot32(local_tid_27416, wave_sizze_27418) *\n              wave_sizze_27418) & (2 * offset_27425 - 1)) == 0) {\n            // read array element\n            {\n                x_24742 = ((volatile __local\n                            float *) red_arr_mem_27421)[sext_i32_i64(local_tid_27416 +\n                                                        offset_27425)];\n            }\n            // apply reduction operation\n            {\n                float res_24743 = x_24741 + x_24742;\n                \n                x_24741 = res_24743;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_27421)[sext_i32_i64(local_tid_27416)] =\n                    x_24741;\n            }\n        }\n        offset_27425 *= 2;\n    }\n    while (slt32(skip_waves_27426, squot32(sext_i64_i32(paths_20195) +\n                                           wave_sizze_27418 - 1,\n                                           wave_sizze_27418))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_27425 = skip_waves_27426 * wave_sizze_27418;\n        if (slt32(local_tid_27416 + offset_27425, sext_i64_i32(paths_20195)) &&\n            ((local_tid_27416 - squot32(local_tid_27416, wave_sizze_27418) *\n              wave_sizze_27418) == 0 && (squot32(local_tid_27416,\n                                                 wave_sizze_27418) & (2 *\n                                                                      skip_waves_27426 -\n                                                                      1)) ==\n             0)) {\n            // read array element\n            {\n                x_24742 = ((__local\n                            float *) red_arr_mem_27421)[sext_i32_i64(local_tid_27416 +\n                                                        offset_27425)];\n            }\n            // apply reduction operation\n           ",
                   " {\n                float res_24743 = x_24741 + x_24742;\n                \n                x_24741 = res_24743;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_27421)[sext_i32_i64(local_tid_27416)] =\n                    x_24741;\n            }\n        }\n        skip_waves_27426 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    res_24740 = ((__local float *) red_arr_mem_27421)[0];\n    \n    float res_24845 = res_24740 / res_20352;\n    float negate_arg_24846 = 1.0e-2F * res_24739;\n    float exp_arg_24847 = 0.0F - negate_arg_24846;\n    float res_24848 = fpow32(2.7182817F, exp_arg_24847);\n    float x_24849 = 1.0F - res_24848;\n    float B_24850 = x_24849 / 1.0e-2F;\n    float x_24851 = B_24850 - res_24739;\n    float x_24852 = 4.4999997e-6F * x_24851;\n    float A1_24853 = x_24852 / 1.0e-4F;\n    float y_24854 = fpow32(B_24850, 2.0F);\n    float x_24855 = 1.0000001e-6F * y_24854;\n    float A2_24856 = x_24855 / 4.0e-2F;\n    float exp_arg_24857 = A1_24853 - A2_24856;\n    float res_24858 = fpow32(2.7182817F, exp_arg_24857);\n    float negate_arg_24859 = 5.0e-2F * B_24850;\n    float exp_arg_24860 = 0.0F - negate_arg_24859;\n    float res_24861 = fpow32(2.7182817F, exp_arg_24860);\n    float res_24862 = res_24858 * res_24861;\n    float res_24863 = res_24845 * res_24862;\n    \n    if (local_tid_27416 == 0) {\n        ((__global float *) mem_27239)[gtid_23871] = res_24863;\n    }\n    \n  error_2:\n    return;\n}\n__kernel void testzisegred_large_24318(__global int *global_failure,\n                                       int failure_is_an_option, __global\n                                       int64_t *global_failure_args,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_27466_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_27464_backing_aligned_1,\n             ",
                   "                          int64_t paths_20195,\n                                       float sims_per_year_20275,\n                                       int64_t num_groups_24874, __global\n                                       unsigned char *res_mem_27198, __global\n                                       unsigned char *res_mem_27199, __global\n                                       unsigned char *res_mem_27200, __global\n                                       unsigned char *res_mem_27201, __global\n                                       unsigned char *mem_27229, __global\n                                       unsigned char *mem_27242,\n                                       int64_t groups_per_segment_27450,\n                                       int64_t elements_per_thread_27451,\n                                       int64_t virt_num_groups_27452,\n                                       int64_t threads_per_segment_27454,\n                                       __global\n                                       unsigned char *group_res_arr_mem_27455,\n                                       __global\n                                       unsigned char *testzicounter_mem_27457)\n{\n    #define segred_group_sizze_24873 (testzisegred_group_sizze_24312)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_27466_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_27466_backing_aligned_0;\n    __local volatile char *restrict red_arr_mem_27464_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_27464_backing_aligned_1;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27459;\n    int32_t ",
                   "local_tid_27460;\n    int64_t group_sizze_27463;\n    int32_t wave_sizze_27462;\n    int32_t group_tid_27461;\n    \n    global_tid_27459 = get_global_id(0);\n    local_tid_27460 = get_local_id(0);\n    group_sizze_27463 = get_local_size(0);\n    wave_sizze_27462 = LOCKSTEP_WIDTH;\n    group_tid_27461 = get_group_id(0);\n    \n    int32_t phys_tid_24318;\n    \n    phys_tid_24318 = global_tid_27459;\n    \n    __local char *red_arr_mem_27464;\n    \n    red_arr_mem_27464 = (__local char *) red_arr_mem_27464_backing_0;\n    \n    __local char *sync_arr_mem_27466;\n    \n    sync_arr_mem_27466 = (__local char *) sync_arr_mem_27466_backing_1;\n    \n    int32_t phys_group_id_27468;\n    \n    phys_group_id_27468 = get_group_id(0);\n    for (int32_t i_27469 = 0; i_27469 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_27452) - phys_group_id_27468,\n                   sext_i64_i32(num_groups_24874)); i_27469++) {\n        int32_t virt_group_id_27470 = phys_group_id_27468 + i_27469 *\n                sext_i64_i32(num_groups_24874);\n        int32_t flat_segment_id_27471 = squot32(virt_group_id_27470,\n                                                sext_i64_i32(groups_per_segment_27450));\n        int64_t global_tid_27472 = srem64(sext_i32_i64(virt_group_id_27470) *\n                                          segred_group_sizze_24873 +\n                                          sext_i32_i64(local_tid_27460),\n                                          segred_group_sizze_24873 *\n                                          groups_per_segment_27450);\n        int64_t gtid_24309 = sext_i32_i64(flat_segment_id_27471);\n        int64_t gtid_24317;\n        float x_acc_27473;\n        int64_t chunk_sizze_27474;\n        \n        chunk_sizze_27474 = smin64(elements_per_thread_27451,\n                                   sdiv_up64(paths_20195 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_27472)),\n                                             threads_per_segment_27454));\n        \n        fl",
                   "oat x_24877;\n        float x_24878;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_27473 = 0.0F;\n        }\n        for (int64_t i_27478 = 0; i_27478 < chunk_sizze_27474; i_27478++) {\n            gtid_24317 = sext_i32_i64(sext_i64_i32(global_tid_27472)) +\n                threads_per_segment_27454 * i_27478;\n            // apply map function\n            {\n                float x_24882 = ((__global float *) mem_27229)[gtid_24309 *\n                                                               paths_20195 +\n                                                               gtid_24317];\n                int64_t convop_x_27110 = add64(1, gtid_24309);\n                float binop_x_27111 = sitofp_i64_f32(convop_x_27110);\n                float index_primexp_27112 = binop_x_27111 / sims_per_year_20275;\n                float res_24884;\n                float redout_27159 = 0.0F;\n                \n                for (int32_t i_27170 = 0; i_27170 < 4; i_27170++) {\n                    int64_t i_27160 = sext_i32_i64(i_27170);\n                    int64_t x_24890 = ((__global\n                                        int64_t *) res_mem_27200)[i_27160];\n                    float x_24891 = ((__global float *) res_mem_27201)[i_27160];\n                    int64_t i64_arg_24892 = sub64(x_24890, 1);\n                    float res_24893 = sitofp_i64_f32(i64_arg_24892);\n                    float y_24894 = x_24891 * res_24893;\n                    bool cond_24895 = y_24894 < index_primexp_27112;\n                    float ceil_arg_24896 = index_primexp_27112 / x_24891;\n                    float res_24897;\n                    \n                    res_24897 = futrts_ceil32(ceil_arg_24896);\n                    \n                    int64_t res_24898 = fptosi_f32_i64(res_24897);\n                    int64_t remaining_24899 = sub64(x_24890, res_24898);\n                    float res_24900;\n                    \n                    if (cond_24895) {\n                        re",
                   "s_24900 = 0.0F;\n                    } else {\n                        float x_24888 = ((__global\n                                          float *) res_mem_27198)[i_27160];\n                        float x_24889 = ((__global\n                                          float *) res_mem_27199)[i_27160];\n                        float nextpayment_24901 = x_24891 * res_24897;\n                        bool bounds_invalid_upwards_24902 =\n                             slt64(remaining_24899, 1);\n                        bool valid_24903 = !bounds_invalid_upwards_24902;\n                        bool range_valid_c_24904;\n                        \n                        if (!valid_24903) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 30) == -1) {\n                                    global_failure_args[0] = 1;\n                                    global_failure_args[1] = 2;\n                                    global_failure_args[2] = remaining_24899;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float y_24906 = nextpayment_24901 - index_primexp_27112;\n                        float negate_arg_24907 = 1.0e-2F * y_24906;\n                        float exp_arg_24908 = 0.0F - negate_arg_24907;\n                        float res_24909 = fpow32(2.7182817F, exp_arg_24908);\n                        float x_24910 = 1.0F - res_24909;\n                        float B_24911 = x_24910 / 1.0e-2F;\n                        float x_24912 = B_24911 - nextpayment_24901;\n                        float x_24913 = x_24912 + index_primexp_27112;\n                        float x_24914 = 4.4999997e-6F * x_24913;\n                        float A1_24915 = x_24914 / 1.0e-",
                   "4F;\n                        float y_24916 = fpow32(B_24911, 2.0F);\n                        float x_24917 = 1.0000001e-6F * y_24916;\n                        float A2_24918 = x_24917 / 4.0e-2F;\n                        float exp_arg_24919 = A1_24915 - A2_24918;\n                        float res_24920 = fpow32(2.7182817F, exp_arg_24919);\n                        float negate_arg_24921 = x_24882 * B_24911;\n                        float exp_arg_24922 = 0.0F - negate_arg_24921;\n                        float res_24923 = fpow32(2.7182817F, exp_arg_24922);\n                        float res_24924 = res_24920 * res_24923;\n                        bool y_24925 = slt64(0, remaining_24899);\n                        bool index_certs_24926;\n                        \n                        if (!y_24925) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 31) == -1) {\n                                    global_failure_args[0] = 0;\n                                    global_failure_args[1] = remaining_24899;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float binop_y_24927 = sitofp_i64_f32(remaining_24899);\n                        float binop_y_24928 = x_24891 * binop_y_24927;\n                        float index_primexp_24929 = nextpayment_24901 +\n                              binop_y_24928;\n                        float y_24930 = index_primexp_24929 -\n                              index_primexp_27112;\n                        float negate_arg_24931 = 1.0e-2F * y_24930;\n                        float exp_arg_24932 = 0.0F - negate_arg_24931;\n                        float res_24933 = fpow32(2.7182817F, exp_arg_24932);\n                        fl",
                   "oat x_24934 = 1.0F - res_24933;\n                        float B_24935 = x_24934 / 1.0e-2F;\n                        float x_24936 = B_24935 - index_primexp_24929;\n                        float x_24937 = x_24936 + index_primexp_27112;\n                        float x_24938 = 4.4999997e-6F * x_24937;\n                        float A1_24939 = x_24938 / 1.0e-4F;\n                        float y_24940 = fpow32(B_24935, 2.0F);\n                        float x_24941 = 1.0000001e-6F * y_24940;\n                        float A2_24942 = x_24941 / 4.0e-2F;\n                        float exp_arg_24943 = A1_24939 - A2_24942;\n                        float res_24944 = fpow32(2.7182817F, exp_arg_24943);\n                        float negate_arg_24945 = x_24882 * B_24935;\n                        float exp_arg_24946 = 0.0F - negate_arg_24945;\n                        float res_24947 = fpow32(2.7182817F, exp_arg_24946);\n                        float res_24948 = res_24944 * res_24947;\n                        float res_24949;\n                        float redout_27107 = 0.0F;\n                        \n                        for (int64_t i_27108 = 0; i_27108 < remaining_24899;\n                             i_27108++) {\n                            int64_t index_primexp_27134 = add64(1, i_27108);\n                            float res_24954 =\n                                  sitofp_i64_f32(index_primexp_27134);\n                            float res_24955 = x_24891 * res_24954;\n                            float res_24956 = nextpayment_24901 + res_24955;\n                            float y_24957 = res_24956 - index_primexp_27112;\n                            float negate_arg_24958 = 1.0e-2F * y_24957;\n                            float exp_arg_24959 = 0.0F - negate_arg_24958;\n                            float res_24960 = fpow32(2.7182817F, exp_arg_24959);\n                            float x_24961 = 1.0F - res_24960;\n                            float B_24962 = x_24961 / 1.0e-2F;\n                         ",
                   "   float x_24963 = B_24962 - res_24956;\n                            float x_24964 = x_24963 + index_primexp_27112;\n                            float x_24965 = 4.4999997e-6F * x_24964;\n                            float A1_24966 = x_24965 / 1.0e-4F;\n                            float y_24967 = fpow32(B_24962, 2.0F);\n                            float x_24968 = 1.0000001e-6F * y_24967;\n                            float A2_24969 = x_24968 / 4.0e-2F;\n                            float exp_arg_24970 = A1_24966 - A2_24969;\n                            float res_24971 = fpow32(2.7182817F, exp_arg_24970);\n                            float negate_arg_24972 = x_24882 * B_24962;\n                            float exp_arg_24973 = 0.0F - negate_arg_24972;\n                            float res_24974 = fpow32(2.7182817F, exp_arg_24973);\n                            float res_24975 = res_24971 * res_24974;\n                            float res_24952 = res_24975 + redout_27107;\n                            float redout_tmp_27480 = res_24952;\n                            \n                            redout_27107 = redout_tmp_27480;\n                        }\n                        res_24949 = redout_27107;\n                        \n                        float x_24976 = res_24924 - res_24948;\n                        float x_24977 = x_24888 * x_24891;\n                        float y_24978 = res_24949 * x_24977;\n                        float y_24979 = x_24976 - y_24978;\n                        float res_24980 = x_24889 * y_24979;\n                        float res_24981 = x_24889 * res_24980;\n                        \n                        res_24900 = res_24981;\n                    }\n                    \n                    float res_24887 = res_24900 + redout_27159;\n                    float redout_tmp_27479 = res_24887;\n                    \n                    redout_27159 = redout_tmp_27479;\n                }\n                res_24884 = redout_27159;\n                \n                float re",
                   "s_24982 = fmax32(0.0F, res_24884);\n                \n                // save map-out results\n                { }\n                // load accumulator\n                {\n                    x_24877 = x_acc_27473;\n                }\n                // load new values\n                {\n                    x_24878 = res_24982;\n                }\n                // apply reduction operator\n                {\n                    float res_24879 = x_24877 + x_24878;\n                    \n                    // store in accumulator\n                    {\n                        x_acc_27473 = res_24879;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_24877 = x_acc_27473;\n            ((__local\n              float *) red_arr_mem_27464)[sext_i32_i64(local_tid_27460)] =\n                x_24877;\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_27481;\n        int32_t skip_waves_27482;\n        \n        skip_waves_27482 = 1;\n        \n        float x_27475;\n        float x_27476;\n        \n        offset_27481 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_27460,\n                      sext_i64_i32(segred_group_sizze_24873))) {\n                x_27475 = ((__local\n                            float *) red_arr_mem_27464)[sext_i32_i64(local_tid_27460 +\n                                                        offset_27481)];\n            }\n        }\n        offset_27481 = 1;\n        while (slt32(offset_27481, wave_sizze_27462)) {\n            if (slt32(local_tid_27460 + offset_27481,\n                      sext_i64_i32(segred_group_sizze_24873)) &&\n                ((local_tid_27460 - squot32(local_tid_27460, wave_sizze_27462) *\n                  wave_sizze_27462) & (2 * offset_27481 - 1)) == 0) {\n    ",
                   "            // read array element\n                {\n                    x_27476 = ((volatile __local\n                                float *) red_arr_mem_27464)[sext_i32_i64(local_tid_27460 +\n                                                            offset_27481)];\n                }\n                // apply reduction operation\n                {\n                    float res_27477 = x_27475 + x_27476;\n                    \n                    x_27475 = res_27477;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      float *) red_arr_mem_27464)[sext_i32_i64(local_tid_27460)] =\n                        x_27475;\n                }\n            }\n            offset_27481 *= 2;\n        }\n        while (slt32(skip_waves_27482,\n                     squot32(sext_i64_i32(segred_group_sizze_24873) +\n                             wave_sizze_27462 - 1, wave_sizze_27462))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_27481 = skip_waves_27482 * wave_sizze_27462;\n            if (slt32(local_tid_27460 + offset_27481,\n                      sext_i64_i32(segred_group_sizze_24873)) &&\n                ((local_tid_27460 - squot32(local_tid_27460, wave_sizze_27462) *\n                  wave_sizze_27462) == 0 && (squot32(local_tid_27460,\n                                                     wave_sizze_27462) & (2 *\n                                                                          skip_waves_27482 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_27476 = ((__local\n                                float *) red_arr_mem_27464)[sext_i32_i64(local_tid_27460 +\n                                                            offset_27481)];\n                }\n                // apply reduction operation\n                {\n                    float res_27477 = x_27475 ",
                   "+ x_27476;\n                    \n                    x_27475 = res_27477;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      float *) red_arr_mem_27464)[sext_i32_i64(local_tid_27460)] =\n                        x_27475;\n                }\n            }\n            skip_waves_27482 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_27460) == 0) {\n                x_acc_27473 = x_27475;\n            }\n        }\n        if (groups_per_segment_27450 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_27460 == 0) {\n                    ((__global float *) mem_27242)[gtid_24309] = x_acc_27473;\n                }\n            }\n        } else {\n            int32_t old_counter_27483;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_27460 == 0) {\n                    ((__global\n                      float *) group_res_arr_mem_27455)[sext_i32_i64(virt_group_id_27470) *\n                                                        segred_group_sizze_24873] =\n                        x_acc_27473;\n                    mem_fence_global();\n                    old_counter_27483 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_27457)[sext_i32_i64(srem32(flat_segment_id_27471,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_27466)[0] =\n                        old_counter_27483 == groups_per_segment_27450 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n      ",
                   "      \n            bool is_last_group_27484;\n            \n            is_last_group_27484 = ((__local bool *) sync_arr_mem_27466)[0];\n            if (is_last_group_27484) {\n                if (local_tid_27460 == 0) {\n                    old_counter_27483 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_27457)[sext_i32_i64(srem32(flat_segment_id_27471,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_27450));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_27485 =\n                            sdiv_up64(groups_per_segment_27450,\n                                      segred_group_sizze_24873);\n                    \n                    x_24877 = 0.0F;\n                    for (int64_t i_27486 = 0; i_27486 < read_per_thread_27485;\n                         i_27486++) {\n                        int64_t group_res_id_27487 =\n                                sext_i32_i64(local_tid_27460) *\n                                read_per_thread_27485 + i_27486;\n                        int64_t index_of_group_res_27488 =\n                                sext_i32_i64(flat_segment_id_27471) *\n                                groups_per_segment_27450 + group_res_id_27487;\n                        \n                        if (slt64(group_res_id_27487,\n                                  groups_per_segment_27450)) {\n                            x_24878 = ((__global\n                                        float *) group_res_arr_mem_27455)[index_of_group_res_27488 *\n                                                                          segred_group_sizze_24873];\n                            \n                            float res_24879;\n      ",
                   "                      \n                            res_24879 = x_24877 + x_24878;\n                            x_24877 = res_24879;\n                        }\n                    }\n                }\n                ((__local\n                  float *) red_arr_mem_27464)[sext_i32_i64(local_tid_27460)] =\n                    x_24877;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_27489;\n                    int32_t skip_waves_27490;\n                    \n                    skip_waves_27490 = 1;\n                    \n                    float x_27475;\n                    float x_27476;\n                    \n                    offset_27489 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_27460,\n                                  sext_i64_i32(segred_group_sizze_24873))) {\n                            x_27475 = ((__local\n                                        float *) red_arr_mem_27464)[sext_i32_i64(local_tid_27460 +\n                                                                    offset_27489)];\n                        }\n                    }\n                    offset_27489 = 1;\n                    while (slt32(offset_27489, wave_sizze_27462)) {\n                        if (slt32(local_tid_27460 + offset_27489,\n                                  sext_i64_i32(segred_group_sizze_24873)) &&\n                            ((local_tid_27460 - squot32(local_tid_27460,\n                                                        wave_sizze_27462) *\n                              wave_sizze_27462) & (2 * offset_27489 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_27476 = ((volatile __local\n                                            float *) red_arr_mem_27464)[sext_i32_i64(local_tid_27460 +\n     ",
                   "                                                                   offset_27489)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_27477 = x_27475 + x_27476;\n                                \n                                x_27475 = res_27477;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_27464)[sext_i32_i64(local_tid_27460)] =\n                                    x_27475;\n                            }\n                        }\n                        offset_27489 *= 2;\n                    }\n                    while (slt32(skip_waves_27490,\n                                 squot32(sext_i64_i32(segred_group_sizze_24873) +\n                                         wave_sizze_27462 - 1,\n                                         wave_sizze_27462))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_27489 = skip_waves_27490 * wave_sizze_27462;\n                        if (slt32(local_tid_27460 + offset_27489,\n                                  sext_i64_i32(segred_group_sizze_24873)) &&\n                            ((local_tid_27460 - squot32(local_tid_27460,\n                                                        wave_sizze_27462) *\n                              wave_sizze_27462) == 0 &&\n                             (squot32(local_tid_27460, wave_sizze_27462) & (2 *\n                                                                            skip_waves_27490 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_27476 = ((__local\n                                            float *) r",
                   "ed_arr_mem_27464)[sext_i32_i64(local_tid_27460 +\n                                                                        offset_27489)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_27477 = x_27475 + x_27476;\n                                \n                                x_27475 = res_27477;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  float *) red_arr_mem_27464)[sext_i32_i64(local_tid_27460)] =\n                                    x_27475;\n                            }\n                        }\n                        skip_waves_27490 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_27460 == 0) {\n                            ((__global float *) mem_27242)[gtid_24309] =\n                                x_27475;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_24873\n}\n__kernel void testzisegred_nonseg_22978(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_27318_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_27316_backing_aligned_1,\n                                        int64_t num_groups_22973, __global\n                                        unsigned char *mem_27174, __global\n                                        unsigned char *mem_27176, __global\n                                        unsigned char *mem_27179, __global\n                                   ",
                   "     unsigned char *testzicounter_mem_27306,\n                                        __global\n                                        unsigned char *group_res_arr_mem_27308,\n                                        int64_t num_threads_27310)\n{\n    #define segred_group_sizze_22971 (testzisegred_group_sizze_22970)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27318_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_27318_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_27316_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_27316_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27311;\n    int32_t local_tid_27312;\n    int64_t group_sizze_27315;\n    int32_t wave_sizze_27314;\n    int32_t group_tid_27313;\n    \n    global_tid_27311 = get_global_id(0);\n    local_tid_27312 = get_local_id(0);\n    group_sizze_27315 = get_local_size(0);\n    wave_sizze_27314 = LOCKSTEP_WIDTH;\n    group_tid_27313 = get_group_id(0);\n    \n    int32_t phys_tid_22978;\n    \n    phys_tid_22978 = global_tid_27311;\n    \n    __local char *sync_arr_mem_27316;\n    \n    sync_arr_mem_27316 = (__local char *) sync_arr_mem_27316_backing_0;\n    \n    __local char *red_arr_mem_27318;\n    \n    red_arr_mem_27318 = (__local char *) red_arr_mem_27318_backing_1;\n    \n    int64_t dummy_22976;\n    \n    dummy_22976 = 0;\n    \n    int64_t gtid_22977;\n    \n    gtid_22977 = 0;\n    \n    float x_acc_27320;\n    int64_t chunk_sizze_27321;\n    \n    chunk_sizze_27321 = smin64(sdiv_up64(4,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_22971 *\n                                         num_groups_22973))), sdiv_up64(4 -\n                                                                        sext_i32_i64(phys_tid_22978),\n           ",
                   "                                                             num_threads_27310));\n    \n    float x_20201;\n    float x_20202;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_27320 = -INFINITY;\n    }\n    for (int64_t i_27325 = 0; i_27325 < chunk_sizze_27321; i_27325++) {\n        gtid_22977 = sext_i32_i64(phys_tid_22978) + num_threads_27310 * i_27325;\n        // apply map function\n        {\n            float x_20204 = ((__global float *) mem_27176)[gtid_22977];\n            int64_t x_20205 = ((__global int64_t *) mem_27174)[gtid_22977];\n            float res_20206 = sitofp_i64_f32(x_20205);\n            float res_20207 = x_20204 * res_20206;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_20201 = x_acc_27320;\n            }\n            // load new values\n            {\n                x_20202 = res_20207;\n            }\n            // apply reduction operator\n            {\n                float res_20203 = fmax32(x_20201, x_20202);\n                \n                // store in accumulator\n                {\n                    x_acc_27320 = res_20203;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_20201 = x_acc_27320;\n        ((__local float *) red_arr_mem_27318)[sext_i32_i64(local_tid_27312)] =\n            x_20201;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_27326;\n    int32_t skip_waves_27327;\n    \n    skip_waves_27327 = 1;\n    \n    float x_27322;\n    float x_27323;\n    \n    offset_27326 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_27312, sext_i64_i32(segred_group_sizze_22971))) {\n            x_27322 = ((__local\n                        float *) red_arr_mem_27318)[sext_i32_i64(local_tid_27312 +\n                                                    offset_27326)];\n        }\n    }\n    offset_27326 = 1;\n    while (slt32(offset_27326,",
                   " wave_sizze_27314)) {\n        if (slt32(local_tid_27312 + offset_27326,\n                  sext_i64_i32(segred_group_sizze_22971)) && ((local_tid_27312 -\n                                                               squot32(local_tid_27312,\n                                                                       wave_sizze_27314) *\n                                                               wave_sizze_27314) &\n                                                              (2 *\n                                                               offset_27326 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_27323 = ((volatile __local\n                            float *) red_arr_mem_27318)[sext_i32_i64(local_tid_27312 +\n                                                        offset_27326)];\n            }\n            // apply reduction operation\n            {\n                float res_27324 = fmax32(x_27322, x_27323);\n                \n                x_27322 = res_27324;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_27318)[sext_i32_i64(local_tid_27312)] =\n                    x_27322;\n            }\n        }\n        offset_27326 *= 2;\n    }\n    while (slt32(skip_waves_27327,\n                 squot32(sext_i64_i32(segred_group_sizze_22971) +\n                         wave_sizze_27314 - 1, wave_sizze_27314))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_27326 = skip_waves_27327 * wave_sizze_27314;\n        if (slt32(local_tid_27312 + offset_27326,\n                  sext_i64_i32(segred_group_sizze_22971)) && ((local_tid_27312 -\n                                                               squot32(local_tid_27312,\n                                                                       wave_sizze_27314) *\n                                                               wave_sizze_27314) ==",
                   "\n                                                              0 &&\n                                                              (squot32(local_tid_27312,\n                                                                       wave_sizze_27314) &\n                                                               (2 *\n                                                                skip_waves_27327 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_27323 = ((__local\n                            float *) red_arr_mem_27318)[sext_i32_i64(local_tid_27312 +\n                                                        offset_27326)];\n            }\n            // apply reduction operation\n            {\n                float res_27324 = fmax32(x_27322, x_27323);\n                \n                x_27322 = res_27324;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_27318)[sext_i32_i64(local_tid_27312)] =\n                    x_27322;\n            }\n        }\n        skip_waves_27327 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_27312) == 0) {\n            x_acc_27320 = x_27322;\n        }\n    }\n    \n    int32_t old_counter_27328;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_27312 == 0) {\n            ((__global\n              float *) group_res_arr_mem_27308)[sext_i32_i64(group_tid_27313) *\n                                                segred_group_sizze_22971] =\n                x_acc_27320;\n            mem_fence_global();\n            old_counter_27328 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_27306)[0],\n                                                      (int) 1);\n            ((__local ",
                   "bool *) sync_arr_mem_27316)[0] = old_counter_27328 ==\n                num_groups_22973 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_27329;\n    \n    is_last_group_27329 = ((__local bool *) sync_arr_mem_27316)[0];\n    if (is_last_group_27329) {\n        if (local_tid_27312 == 0) {\n            old_counter_27328 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_27306)[0],\n                                                      (int) (0 -\n                                                             num_groups_22973));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_27330 = sdiv_up64(num_groups_22973,\n                                                      segred_group_sizze_22971);\n            \n            x_20201 = -INFINITY;\n            for (int64_t i_27331 = 0; i_27331 < read_per_thread_27330;\n                 i_27331++) {\n                int64_t group_res_id_27332 = sext_i32_i64(local_tid_27312) *\n                        read_per_thread_27330 + i_27331;\n                int64_t index_of_group_res_27333 = group_res_id_27332;\n                \n                if (slt64(group_res_id_27332, num_groups_22973)) {\n                    x_20202 = ((__global\n                                float *) group_res_arr_mem_27308)[index_of_group_res_27333 *\n                                                                  segred_group_sizze_22971];\n                    \n                    float res_20203;\n                    \n                    res_20203 = fmax32(x_20201, x_20202);\n                    x_20201 = res_20203;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_27318)[sext_i32_i64(local_tid_27312)] =\n            x_20201;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_27334;\n            int32_t skip_wa",
                   "ves_27335;\n            \n            skip_waves_27335 = 1;\n            \n            float x_27322;\n            float x_27323;\n            \n            offset_27334 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_27312,\n                          sext_i64_i32(segred_group_sizze_22971))) {\n                    x_27322 = ((__local\n                                float *) red_arr_mem_27318)[sext_i32_i64(local_tid_27312 +\n                                                            offset_27334)];\n                }\n            }\n            offset_27334 = 1;\n            while (slt32(offset_27334, wave_sizze_27314)) {\n                if (slt32(local_tid_27312 + offset_27334,\n                          sext_i64_i32(segred_group_sizze_22971)) &&\n                    ((local_tid_27312 - squot32(local_tid_27312,\n                                                wave_sizze_27314) *\n                      wave_sizze_27314) & (2 * offset_27334 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_27323 = ((volatile __local\n                                    float *) red_arr_mem_27318)[sext_i32_i64(local_tid_27312 +\n                                                                offset_27334)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27324 = fmax32(x_27322, x_27323);\n                        \n                        x_27322 = res_27324;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_27318)[sext_i32_i64(local_tid_27312)] =\n                            x_27322;\n                    }\n                }\n                offset_27334 *= 2;\n            }\n            while (slt32(skip_waves_27335,\n                         squot32(sext_i64_i32(segred_group_sizze_2",
                   "2971) +\n                                 wave_sizze_27314 - 1, wave_sizze_27314))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_27334 = skip_waves_27335 * wave_sizze_27314;\n                if (slt32(local_tid_27312 + offset_27334,\n                          sext_i64_i32(segred_group_sizze_22971)) &&\n                    ((local_tid_27312 - squot32(local_tid_27312,\n                                                wave_sizze_27314) *\n                      wave_sizze_27314) == 0 && (squot32(local_tid_27312,\n                                                         wave_sizze_27314) &\n                                                 (2 * skip_waves_27335 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_27323 = ((__local\n                                    float *) red_arr_mem_27318)[sext_i32_i64(local_tid_27312 +\n                                                                offset_27334)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27324 = fmax32(x_27322, x_27323);\n                        \n                        x_27322 = res_27324;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_27318)[sext_i32_i64(local_tid_27312)] =\n                            x_27322;\n                    }\n                }\n                skip_waves_27335 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_27312 == 0) {\n                    ((__global float *) mem_27179)[0] = x_27322;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_22971\n}\n__kernel void testzisegred_nonseg_23728(__global int *global_failure,\n                                        int failure_is_an_opti",
                   "on, __global\n                                        int64_t *global_failure_args,\n                                        __local volatile\n                                        int64_t *red_arr_mem_27386_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_27384_backing_aligned_1,\n                                        int64_t paths_20195,\n                                        int64_t steps_20196,\n                                        float sims_per_year_20275,\n                                        float res_20352,\n                                        int64_t num_groups_23731, __global\n                                        unsigned char *res_mem_27198, __global\n                                        unsigned char *res_mem_27199, __global\n                                        unsigned char *res_mem_27200, __global\n                                        unsigned char *res_mem_27201, __global\n                                        unsigned char *mem_27229, __global\n                                        unsigned char *mem_27232, __global\n                                        unsigned char *testzicounter_mem_27374,\n                                        __global\n                                        unsigned char *group_res_arr_mem_27376,\n                                        int64_t num_threads_27378)\n{\n    #define segred_group_sizze_23730 (testzisegred_group_sizze_23720)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27386_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_27386_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_27384_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_27384_backing_aligned_1;\n    volatile __local bool local_fa",
                   "ilure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27379;\n    int32_t local_tid_27380;\n    int64_t group_sizze_27383;\n    int32_t wave_sizze_27382;\n    int32_t group_tid_27381;\n    \n    global_tid_27379 = get_global_id(0);\n    local_tid_27380 = get_local_id(0);\n    group_sizze_27383 = get_local_size(0);\n    wave_sizze_27382 = LOCKSTEP_WIDTH;\n    group_tid_27381 = get_group_id(0);\n    \n    int32_t phys_tid_23728;\n    \n    phys_tid_23728 = global_tid_27379;\n    \n    __local char *sync_arr_mem_27384;\n    \n    sync_arr_mem_27384 = (__local char *) sync_arr_mem_27384_backing_0;\n    \n    __local char *red_arr_mem_27386;\n    \n    red_arr_mem_27386 = (__local char *) red_arr_mem_27386_backing_1;\n    \n    int64_t dummy_23726;\n    \n    dummy_23726 = 0;\n    \n    int64_t gtid_23727;\n    \n    gtid_23727 = 0;\n    \n    float x_acc_27388;\n    int64_t chunk_sizze_27389;\n    \n    chunk_sizze_27389 = smin64(sdiv_up64(steps_20196,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_23730 *\n                                         num_groups_23731))),\n                               sdiv_up64(steps_20196 -\n                                         sext_i32_i64(phys_tid_23728),\n                                         num_threads_27378));\n    \n    float x_23734;\n    float x_23735;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_27388 = 0.0F;\n    }\n    for (int64_t i_27393 = 0; i_27393 < chunk_sizze_27389; i_27393++) {\n        gtid_23727 = sext_i32_i64(phys_tid_23728) + num_threads_27378 * i_27393;\n        // apply map function\n        {\n            int64_t index_primexp_27092 = add64(1, gtid_23727);\n            float res_23740 = sitofp_i64_f32(index_primexp_27092);\n            float res_23741 = res_23740 / sims_per_year_20275;\n            float res_23742;\n    ",
                   "        float redout_27149 = 0.0F;\n            \n            for (int64_t i_27150 = 0; i_27150 < paths_20195; i_27150++) {\n                float x_23746 = ((__global float *) mem_27229)[gtid_23727 *\n                                                               paths_20195 +\n                                                               i_27150];\n                float res_23748;\n                float redout_27151 = 0.0F;\n                \n                for (int32_t i_27161 = 0; i_27161 < 4; i_27161++) {\n                    int64_t i_27152 = sext_i32_i64(i_27161);\n                    int64_t x_23754 = ((__global\n                                        int64_t *) res_mem_27200)[i_27152];\n                    float x_23755 = ((__global float *) res_mem_27201)[i_27152];\n                    int64_t i64_arg_23756 = sub64(x_23754, 1);\n                    float res_23757 = sitofp_i64_f32(i64_arg_23756);\n                    float y_23758 = x_23755 * res_23757;\n                    bool cond_23759 = y_23758 < res_23741;\n                    float ceil_arg_23760 = res_23741 / x_23755;\n                    float res_23761;\n                    \n                    res_23761 = futrts_ceil32(ceil_arg_23760);\n                    \n                    int64_t res_23762 = fptosi_f32_i64(res_23761);\n                    int64_t remaining_23763 = sub64(x_23754, res_23762);\n                    float res_23764;\n                    \n                    if (cond_23759) {\n                        res_23764 = 0.0F;\n                    } else {\n                        float x_23752 = ((__global\n                                          float *) res_mem_27198)[i_27152];\n                        float x_23753 = ((__global\n                                          float *) res_mem_27199)[i_27152];\n                        float nextpayment_23765 = x_23755 * res_23761;\n                        bool bounds_invalid_upwards_23766 =\n                             slt64(remaining_23763, 1);\n                      ",
                   "  bool valid_23767 = !bounds_invalid_upwards_23766;\n                        bool range_valid_c_23768;\n                        \n                        if (!valid_23767) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 22) == -1) {\n                                    global_failure_args[0] = 1;\n                                    global_failure_args[1] = 2;\n                                    global_failure_args[2] = remaining_23763;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float y_23770 = nextpayment_23765 - res_23741;\n                        float negate_arg_23771 = 1.0e-2F * y_23770;\n                        float exp_arg_23772 = 0.0F - negate_arg_23771;\n                        float res_23773 = fpow32(2.7182817F, exp_arg_23772);\n                        float x_23774 = 1.0F - res_23773;\n                        float B_23775 = x_23774 / 1.0e-2F;\n                        float x_23776 = B_23775 - nextpayment_23765;\n                        float x_23777 = res_23741 + x_23776;\n                        float x_23778 = 4.4999997e-6F * x_23777;\n                        float A1_23779 = x_23778 / 1.0e-4F;\n                        float y_23780 = fpow32(B_23775, 2.0F);\n                        float x_23781 = 1.0000001e-6F * y_23780;\n                        float A2_23782 = x_23781 / 4.0e-2F;\n                        float exp_arg_23783 = A1_23779 - A2_23782;\n                        float res_23784 = fpow32(2.7182817F, exp_arg_23783);\n                        float negate_arg_23785 = x_23746 * B_23775;\n                        float exp_arg_23786 = 0.0F - negate_arg_23785;\n                        float res_23787 = fpow32(2.71",
                   "82817F, exp_arg_23786);\n                        float res_23788 = res_23784 * res_23787;\n                        bool y_23789 = slt64(0, remaining_23763);\n                        bool index_certs_23790;\n                        \n                        if (!y_23789) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 23) == -1) {\n                                    global_failure_args[0] = 0;\n                                    global_failure_args[1] = remaining_23763;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float binop_y_23791 = sitofp_i64_f32(remaining_23763);\n                        float binop_y_23792 = x_23755 * binop_y_23791;\n                        float index_primexp_23793 = nextpayment_23765 +\n                              binop_y_23792;\n                        float y_23794 = index_primexp_23793 - res_23741;\n                        float negate_arg_23795 = 1.0e-2F * y_23794;\n                        float exp_arg_23796 = 0.0F - negate_arg_23795;\n                        float res_23797 = fpow32(2.7182817F, exp_arg_23796);\n                        float x_23798 = 1.0F - res_23797;\n                        float B_23799 = x_23798 / 1.0e-2F;\n                        float x_23800 = B_23799 - index_primexp_23793;\n                        float x_23801 = res_23741 + x_23800;\n                        float x_23802 = 4.4999997e-6F * x_23801;\n                        float A1_23803 = x_23802 / 1.0e-4F;\n                        float y_23804 = fpow32(B_23799, 2.0F);\n                        float x_23805 = 1.0000001e-6F * y_23804;\n                        float A2_23806 = x_23805 / 4.0e-2F;\n                        float ex",
                   "p_arg_23807 = A1_23803 - A2_23806;\n                        float res_23808 = fpow32(2.7182817F, exp_arg_23807);\n                        float negate_arg_23809 = x_23746 * B_23799;\n                        float exp_arg_23810 = 0.0F - negate_arg_23809;\n                        float res_23811 = fpow32(2.7182817F, exp_arg_23810);\n                        float res_23812 = res_23808 * res_23811;\n                        float res_23813;\n                        float redout_27089 = 0.0F;\n                        \n                        for (int64_t i_27090 = 0; i_27090 < remaining_23763;\n                             i_27090++) {\n                            int64_t index_primexp_27128 = add64(1, i_27090);\n                            float res_23818 =\n                                  sitofp_i64_f32(index_primexp_27128);\n                            float res_23819 = x_23755 * res_23818;\n                            float res_23820 = nextpayment_23765 + res_23819;\n                            float y_23821 = res_23820 - res_23741;\n                            float negate_arg_23822 = 1.0e-2F * y_23821;\n                            float exp_arg_23823 = 0.0F - negate_arg_23822;\n                            float res_23824 = fpow32(2.7182817F, exp_arg_23823);\n                            float x_23825 = 1.0F - res_23824;\n                            float B_23826 = x_23825 / 1.0e-2F;\n                            float x_23827 = B_23826 - res_23820;\n                            float x_23828 = res_23741 + x_23827;\n                            float x_23829 = 4.4999997e-6F * x_23828;\n                            float A1_23830 = x_23829 / 1.0e-4F;\n                            float y_23831 = fpow32(B_23826, 2.0F);\n                            float x_23832 = 1.0000001e-6F * y_23831;\n                            float A2_23833 = x_23832 / 4.0e-2F;\n                            float exp_arg_23834 = A1_23830 - A2_23833;\n                            float res_23835 = fpow32(2.7182817F, exp_arg_23834)",
                   ";\n                            float negate_arg_23836 = x_23746 * B_23826;\n                            float exp_arg_23837 = 0.0F - negate_arg_23836;\n                            float res_23838 = fpow32(2.7182817F, exp_arg_23837);\n                            float res_23839 = res_23835 * res_23838;\n                            float res_23816 = res_23839 + redout_27089;\n                            float redout_tmp_27396 = res_23816;\n                            \n                            redout_27089 = redout_tmp_27396;\n                        }\n                        res_23813 = redout_27089;\n                        \n                        float x_23840 = res_23788 - res_23812;\n                        float x_23841 = x_23752 * x_23755;\n                        float y_23842 = res_23813 * x_23841;\n                        float y_23843 = x_23840 - y_23842;\n                        float res_23844 = x_23753 * y_23843;\n                        float res_23845 = x_23753 * res_23844;\n                        \n                        res_23764 = res_23845;\n                    }\n                    \n                    float res_23751 = res_23764 + redout_27151;\n                    float redout_tmp_27395 = res_23751;\n                    \n                    redout_27151 = redout_tmp_27395;\n                }\n                res_23748 = redout_27151;\n                \n                float res_23846 = fmax32(0.0F, res_23748);\n                float res_23745 = res_23846 + redout_27149;\n                float redout_tmp_27394 = res_23745;\n                \n                redout_27149 = redout_tmp_27394;\n            }\n            res_23742 = redout_27149;\n            \n            float res_23847 = res_23742 / res_20352;\n            float negate_arg_23848 = 1.0e-2F * res_23741;\n            float exp_arg_23849 = 0.0F - negate_arg_23848;\n            float res_23850 = fpow32(2.7182817F, exp_arg_23849);\n            float x_23851 = 1.0F - res_23850;\n            float B_23852 = x_23851 / 1",
                   ".0e-2F;\n            float x_23853 = B_23852 - res_23741;\n            float x_23854 = 4.4999997e-6F * x_23853;\n            float A1_23855 = x_23854 / 1.0e-4F;\n            float y_23856 = fpow32(B_23852, 2.0F);\n            float x_23857 = 1.0000001e-6F * y_23856;\n            float A2_23858 = x_23857 / 4.0e-2F;\n            float exp_arg_23859 = A1_23855 - A2_23858;\n            float res_23860 = fpow32(2.7182817F, exp_arg_23859);\n            float negate_arg_23861 = 5.0e-2F * B_23852;\n            float exp_arg_23862 = 0.0F - negate_arg_23861;\n            float res_23863 = fpow32(2.7182817F, exp_arg_23862);\n            float res_23864 = res_23860 * res_23863;\n            float res_23865 = res_23847 * res_23864;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_23734 = x_acc_27388;\n            }\n            // load new values\n            {\n                x_23735 = res_23865;\n            }\n            // apply reduction operator\n            {\n                float res_23736 = x_23734 + x_23735;\n                \n                // store in accumulator\n                {\n                    x_acc_27388 = res_23736;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_23734 = x_acc_27388;\n        ((__local float *) red_arr_mem_27386)[sext_i32_i64(local_tid_27380)] =\n            x_23734;\n    }\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_27397;\n    int32_t skip_waves_27398;\n    \n    skip_waves_27398 = 1;\n    \n    float x_27390;\n    float x_27391;\n    \n    offset_27397 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_27380, sext_i64_i32(segred_group_sizze_23730))) {\n            x_27390 = ((__local\n                        float *) red_arr_mem_27386)[sext_i32_i64(local_tid_27380 +\n   ",
                   "                                                 offset_27397)];\n        }\n    }\n    offset_27397 = 1;\n    while (slt32(offset_27397, wave_sizze_27382)) {\n        if (slt32(local_tid_27380 + offset_27397,\n                  sext_i64_i32(segred_group_sizze_23730)) && ((local_tid_27380 -\n                                                               squot32(local_tid_27380,\n                                                                       wave_sizze_27382) *\n                                                               wave_sizze_27382) &\n                                                              (2 *\n                                                               offset_27397 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_27391 = ((volatile __local\n                            float *) red_arr_mem_27386)[sext_i32_i64(local_tid_27380 +\n                                                        offset_27397)];\n            }\n            // apply reduction operation\n            {\n                float res_27392 = x_27390 + x_27391;\n                \n                x_27390 = res_27392;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_27386)[sext_i32_i64(local_tid_27380)] =\n                    x_27390;\n            }\n        }\n        offset_27397 *= 2;\n    }\n    while (slt32(skip_waves_27398,\n                 squot32(sext_i64_i32(segred_group_sizze_23730) +\n                         wave_sizze_27382 - 1, wave_sizze_27382))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_27397 = skip_waves_27398 * wave_sizze_27382;\n        if (slt32(local_tid_27380 + offset_27397,\n                  sext_i64_i32(segred_group_sizze_23730)) && ((local_tid_27380 -\n                                                               squot32(local_tid_27380,\n                                                ",
                   "                       wave_sizze_27382) *\n                                                               wave_sizze_27382) ==\n                                                              0 &&\n                                                              (squot32(local_tid_27380,\n                                                                       wave_sizze_27382) &\n                                                               (2 *\n                                                                skip_waves_27398 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_27391 = ((__local\n                            float *) red_arr_mem_27386)[sext_i32_i64(local_tid_27380 +\n                                                        offset_27397)];\n            }\n            // apply reduction operation\n            {\n                float res_27392 = x_27390 + x_27391;\n                \n                x_27390 = res_27392;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_27386)[sext_i32_i64(local_tid_27380)] =\n                    x_27390;\n            }\n        }\n        skip_waves_27398 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_27380) == 0) {\n            x_acc_27388 = x_27390;\n        }\n    }\n    \n    int32_t old_counter_27399;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_27380 == 0) {\n            ((__global\n              float *) group_res_arr_mem_27376)[sext_i32_i64(group_tid_27381) *\n                                                segred_group_sizze_23730] =\n                x_acc_27388;\n            mem_fence_global();\n            old_counter_27399 = atomic_add_i32_global(&((volatile __global\n                                                         int",
                   " *) testzicounter_mem_27374)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_27384)[0] = old_counter_27399 ==\n                num_groups_23731 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_27400;\n    \n    is_last_group_27400 = ((__local bool *) sync_arr_mem_27384)[0];\n    if (is_last_group_27400) {\n        if (local_tid_27380 == 0) {\n            old_counter_27399 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_27374)[0],\n                                                      (int) (0 -\n                                                             num_groups_23731));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_27401 = sdiv_up64(num_groups_23731,\n                                                      segred_group_sizze_23730);\n            \n            x_23734 = 0.0F;\n            for (int64_t i_27402 = 0; i_27402 < read_per_thread_27401;\n                 i_27402++) {\n                int64_t group_res_id_27403 = sext_i32_i64(local_tid_27380) *\n                        read_per_thread_27401 + i_27402;\n                int64_t index_of_group_res_27404 = group_res_id_27403;\n                \n                if (slt64(group_res_id_27403, num_groups_23731)) {\n                    x_23735 = ((__global\n                                float *) group_res_arr_mem_27376)[index_of_group_res_27404 *\n                                                                  segred_group_sizze_23730];\n                    \n                    float res_23736;\n                    \n                    res_23736 = x_23734 + x_23735;\n                    x_23734 = res_23736;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_27386)[sext_i32_i64(local_tid_27380)] =\n            x_23734;\n        barrier(CLK_LOCAL_MEM_FENCE);\n    ",
                   "    // reduce the per-group results\n        {\n            int32_t offset_27405;\n            int32_t skip_waves_27406;\n            \n            skip_waves_27406 = 1;\n            \n            float x_27390;\n            float x_27391;\n            \n            offset_27405 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_27380,\n                          sext_i64_i32(segred_group_sizze_23730))) {\n                    x_27390 = ((__local\n                                float *) red_arr_mem_27386)[sext_i32_i64(local_tid_27380 +\n                                                            offset_27405)];\n                }\n            }\n            offset_27405 = 1;\n            while (slt32(offset_27405, wave_sizze_27382)) {\n                if (slt32(local_tid_27380 + offset_27405,\n                          sext_i64_i32(segred_group_sizze_23730)) &&\n                    ((local_tid_27380 - squot32(local_tid_27380,\n                                                wave_sizze_27382) *\n                      wave_sizze_27382) & (2 * offset_27405 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_27391 = ((volatile __local\n                                    float *) red_arr_mem_27386)[sext_i32_i64(local_tid_27380 +\n                                                                offset_27405)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27392 = x_27390 + x_27391;\n                        \n                        x_27390 = res_27392;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_27386)[sext_i32_i64(local_tid_27380)] =\n                            x_27390;\n                    }\n                }\n                offset_27405 *= 2;\n            }\n         ",
                   "   while (slt32(skip_waves_27406,\n                         squot32(sext_i64_i32(segred_group_sizze_23730) +\n                                 wave_sizze_27382 - 1, wave_sizze_27382))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_27405 = skip_waves_27406 * wave_sizze_27382;\n                if (slt32(local_tid_27380 + offset_27405,\n                          sext_i64_i32(segred_group_sizze_23730)) &&\n                    ((local_tid_27380 - squot32(local_tid_27380,\n                                                wave_sizze_27382) *\n                      wave_sizze_27382) == 0 && (squot32(local_tid_27380,\n                                                         wave_sizze_27382) &\n                                                 (2 * skip_waves_27406 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_27391 = ((__local\n                                    float *) red_arr_mem_27386)[sext_i32_i64(local_tid_27380 +\n                                                                offset_27405)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27392 = x_27390 + x_27391;\n                        \n                        x_27390 = res_27392;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_27386)[sext_i32_i64(local_tid_27380)] =\n                            x_27390;\n                    }\n                }\n                skip_waves_27406 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_27380 == 0) {\n                    ((__global float *) mem_27232)[0] = x_27390;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_23730\n}\n__kernel void testzisegred_nonseg_24589",
                   "(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_27510_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_27508_backing_aligned_1,\n                                        int64_t steps_20196,\n                                        int64_t num_groups_25011, __global\n                                        unsigned char *res_map_acc_mem_27247,\n                                        __global unsigned char *mem_27250,\n                                        __global\n                                        unsigned char *testzicounter_mem_27498,\n                                        __global\n                                        unsigned char *group_res_arr_mem_27500,\n                                        int64_t num_threads_27502)\n{\n    #define segred_group_sizze_25010 (testzisegred_group_sizze_24581)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27510_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_27510_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_27508_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_27508_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27503;\n    int32_t local_tid_27504;\n    int64_t group_sizze_27507;\n    int32_t wave_sizze_27506;\n    int32_t group_tid_27505;\n    \n    global_tid_27503 = get_global_id(0);\n    local_tid_27504 = get_local_id(0);\n    group_sizze_27507 = get_local_size(0);\n    wave_sizze_27506 = LOCKSTEP_WIDTH;\n    group_tid_27505 = get_group_id(0);\n    \n    int32_t phys_tid_24589;\n    \n    phys_tid_24589 = global_tid_27503;\n    \n    __local char *sync_arr_mem_27508;\n    ",
                   "\n    sync_arr_mem_27508 = (__local char *) sync_arr_mem_27508_backing_0;\n    \n    __local char *red_arr_mem_27510;\n    \n    red_arr_mem_27510 = (__local char *) red_arr_mem_27510_backing_1;\n    \n    int64_t dummy_24587;\n    \n    dummy_24587 = 0;\n    \n    int64_t gtid_24588;\n    \n    gtid_24588 = 0;\n    \n    float x_acc_27512;\n    int64_t chunk_sizze_27513;\n    \n    chunk_sizze_27513 = smin64(sdiv_up64(steps_20196,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_25010 *\n                                         num_groups_25011))),\n                               sdiv_up64(steps_20196 -\n                                         sext_i32_i64(phys_tid_24589),\n                                         num_threads_27502));\n    \n    float x_25014;\n    float x_25015;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_27512 = 0.0F;\n    }\n    for (int64_t i_27517 = 0; i_27517 < chunk_sizze_27513; i_27517++) {\n        gtid_24588 = sext_i32_i64(phys_tid_24589) + num_threads_27502 * i_27517;\n        // apply map function\n        {\n            float x_25017 = ((__global\n                              float *) res_map_acc_mem_27247)[gtid_24588];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_25014 = x_acc_27512;\n            }\n            // load new values\n            {\n                x_25015 = x_25017;\n            }\n            // apply reduction operator\n            {\n                float res_25016 = x_25014 + x_25015;\n                \n                // store in accumulator\n                {\n                    x_acc_27512 = res_25016;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_25014 = x_acc_27512;\n        ((__local float *) red_arr_mem_27510)[sext_i32_i64(local_tid_27504)] =\n            x_25014;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_2",
                   "7518;\n    int32_t skip_waves_27519;\n    \n    skip_waves_27519 = 1;\n    \n    float x_27514;\n    float x_27515;\n    \n    offset_27518 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_27504, sext_i64_i32(segred_group_sizze_25010))) {\n            x_27514 = ((__local\n                        float *) red_arr_mem_27510)[sext_i32_i64(local_tid_27504 +\n                                                    offset_27518)];\n        }\n    }\n    offset_27518 = 1;\n    while (slt32(offset_27518, wave_sizze_27506)) {\n        if (slt32(local_tid_27504 + offset_27518,\n                  sext_i64_i32(segred_group_sizze_25010)) && ((local_tid_27504 -\n                                                               squot32(local_tid_27504,\n                                                                       wave_sizze_27506) *\n                                                               wave_sizze_27506) &\n                                                              (2 *\n                                                               offset_27518 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_27515 = ((volatile __local\n                            float *) red_arr_mem_27510)[sext_i32_i64(local_tid_27504 +\n                                                        offset_27518)];\n            }\n            // apply reduction operation\n            {\n                float res_27516 = x_27514 + x_27515;\n                \n                x_27514 = res_27516;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_27510)[sext_i32_i64(local_tid_27504)] =\n                    x_27514;\n            }\n        }\n        offset_27518 *= 2;\n    }\n    while (slt32(skip_waves_27519,\n                 squot32(sext_i64_i32(segred_group_sizze_25010) +\n                         wave_sizze_27506",
                   " - 1, wave_sizze_27506))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_27518 = skip_waves_27519 * wave_sizze_27506;\n        if (slt32(local_tid_27504 + offset_27518,\n                  sext_i64_i32(segred_group_sizze_25010)) && ((local_tid_27504 -\n                                                               squot32(local_tid_27504,\n                                                                       wave_sizze_27506) *\n                                                               wave_sizze_27506) ==\n                                                              0 &&\n                                                              (squot32(local_tid_27504,\n                                                                       wave_sizze_27506) &\n                                                               (2 *\n                                                                skip_waves_27519 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_27515 = ((__local\n                            float *) red_arr_mem_27510)[sext_i32_i64(local_tid_27504 +\n                                                        offset_27518)];\n            }\n            // apply reduction operation\n            {\n                float res_27516 = x_27514 + x_27515;\n                \n                x_27514 = res_27516;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_27510)[sext_i32_i64(local_tid_27504)] =\n                    x_27514;\n            }\n        }\n        skip_waves_27519 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_27504) == 0) {\n            x_acc_27512 = x_27514;\n        }\n    }\n    \n    int32_t old_counter_27520;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_",
                   "tid_27504 == 0) {\n            ((__global\n              float *) group_res_arr_mem_27500)[sext_i32_i64(group_tid_27505) *\n                                                segred_group_sizze_25010] =\n                x_acc_27512;\n            mem_fence_global();\n            old_counter_27520 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_27498)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_27508)[0] = old_counter_27520 ==\n                num_groups_25011 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_27521;\n    \n    is_last_group_27521 = ((__local bool *) sync_arr_mem_27508)[0];\n    if (is_last_group_27521) {\n        if (local_tid_27504 == 0) {\n            old_counter_27520 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_27498)[0],\n                                                      (int) (0 -\n                                                             num_groups_25011));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_27522 = sdiv_up64(num_groups_25011,\n                                                      segred_group_sizze_25010);\n            \n            x_25014 = 0.0F;\n            for (int64_t i_27523 = 0; i_27523 < read_per_thread_27522;\n                 i_27523++) {\n                int64_t group_res_id_27524 = sext_i32_i64(local_tid_27504) *\n                        read_per_thread_27522 + i_27523;\n                int64_t index_of_group_res_27525 = group_res_id_27524;\n                \n                if (slt64(group_res_id_27524, num_groups_25011)) {\n                    x_25015 = ((__global\n                                float *) group_res_arr_mem_27500)[index_of_group_res_27525 *\n                                                       ",
                   "           segred_group_sizze_25010];\n                    \n                    float res_25016;\n                    \n                    res_25016 = x_25014 + x_25015;\n                    x_25014 = res_25016;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_27510)[sext_i32_i64(local_tid_27504)] =\n            x_25014;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_27526;\n            int32_t skip_waves_27527;\n            \n            skip_waves_27527 = 1;\n            \n            float x_27514;\n            float x_27515;\n            \n            offset_27526 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_27504,\n                          sext_i64_i32(segred_group_sizze_25010))) {\n                    x_27514 = ((__local\n                                float *) red_arr_mem_27510)[sext_i32_i64(local_tid_27504 +\n                                                            offset_27526)];\n                }\n            }\n            offset_27526 = 1;\n            while (slt32(offset_27526, wave_sizze_27506)) {\n                if (slt32(local_tid_27504 + offset_27526,\n                          sext_i64_i32(segred_group_sizze_25010)) &&\n                    ((local_tid_27504 - squot32(local_tid_27504,\n                                                wave_sizze_27506) *\n                      wave_sizze_27506) & (2 * offset_27526 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_27515 = ((volatile __local\n                                    float *) red_arr_mem_27510)[sext_i32_i64(local_tid_27504 +\n                                                                offset_27526)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27516 = x_27514 + x_27515;\n                        \n          ",
                   "              x_27514 = res_27516;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_27510)[sext_i32_i64(local_tid_27504)] =\n                            x_27514;\n                    }\n                }\n                offset_27526 *= 2;\n            }\n            while (slt32(skip_waves_27527,\n                         squot32(sext_i64_i32(segred_group_sizze_25010) +\n                                 wave_sizze_27506 - 1, wave_sizze_27506))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_27526 = skip_waves_27527 * wave_sizze_27506;\n                if (slt32(local_tid_27504 + offset_27526,\n                          sext_i64_i32(segred_group_sizze_25010)) &&\n                    ((local_tid_27504 - squot32(local_tid_27504,\n                                                wave_sizze_27506) *\n                      wave_sizze_27506) == 0 && (squot32(local_tid_27504,\n                                                         wave_sizze_27506) &\n                                                 (2 * skip_waves_27527 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_27515 = ((__local\n                                    float *) red_arr_mem_27510)[sext_i32_i64(local_tid_27504 +\n                                                                offset_27526)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27516 = x_27514 + x_27515;\n                        \n                        x_27514 = res_27516;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_27510)[sext_i32_i64(local_tid_27504)] =\n                            x_27514;\n                    }\n          ",
                   "      }\n                skip_waves_27527 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_27504 == 0) {\n                    ((__global float *) mem_27250)[0] = x_27514;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_25010\n}\n__kernel void testzisegred_small_24318(__global int *global_failure,\n                                       int failure_is_an_option, __global\n                                       int64_t *global_failure_args,\n                                       __local volatile\n                                       int64_t *red_arr_mem_27434_backing_aligned_0,\n                                       int64_t paths_20195, int64_t steps_20196,\n                                       float sims_per_year_20275,\n                                       int64_t num_groups_24874, __global\n                                       unsigned char *res_mem_27198, __global\n                                       unsigned char *res_mem_27199, __global\n                                       unsigned char *res_mem_27200, __global\n                                       unsigned char *res_mem_27201, __global\n                                       unsigned char *mem_27229, __global\n                                       unsigned char *mem_27242,\n                                       int64_t segment_sizze_nonzzero_27427)\n{\n    #define segred_group_sizze_24873 (testzisegred_group_sizze_24312)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27434_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_27434_backing_aligned_0;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure =",
                   " false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27429;\n    int32_t local_tid_27430;\n    int64_t group_sizze_27433;\n    int32_t wave_sizze_27432;\n    int32_t group_tid_27431;\n    \n    global_tid_27429 = get_global_id(0);\n    local_tid_27430 = get_local_id(0);\n    group_sizze_27433 = get_local_size(0);\n    wave_sizze_27432 = LOCKSTEP_WIDTH;\n    group_tid_27431 = get_group_id(0);\n    \n    int32_t phys_tid_24318;\n    \n    phys_tid_24318 = global_tid_27429;\n    \n    __local char *red_arr_mem_27434;\n    \n    red_arr_mem_27434 = (__local char *) red_arr_mem_27434_backing_0;\n    \n    int32_t phys_group_id_27436;\n    \n    phys_group_id_27436 = get_group_id(0);\n    for (int32_t i_27437 = 0; i_27437 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(steps_20196,\n                                          squot64(segred_group_sizze_24873,\n                                                  segment_sizze_nonzzero_27427))) -\n                   phys_group_id_27436, sext_i64_i32(num_groups_24874));\n         i_27437++) {\n        int32_t virt_group_id_27438 = phys_group_id_27436 + i_27437 *\n                sext_i64_i32(num_groups_24874);\n        int64_t gtid_24309 = squot64(sext_i32_i64(local_tid_27430),\n                                     segment_sizze_nonzzero_27427) +\n                sext_i32_i64(virt_group_id_27438) *\n                squot64(segred_group_sizze_24873, segment_sizze_nonzzero_27427);\n        int64_t gtid_24317 = srem64(sext_i32_i64(local_tid_27430), paths_20195);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, paths_20195) && (slt64(gtid_24309, steps_20196) &&\n                                          slt64(sext_i32_i64(local_tid_27430),\n                                                paths_20195 *\n                                                squot64(segred_group_sizze_24873,\n                                                        segment_sizze_nonzzero_27427)))) {\n                float x_24882 = ((__global floa",
                   "t *) mem_27229)[gtid_24309 *\n                                                               paths_20195 +\n                                                               gtid_24317];\n                int64_t convop_x_27110 = add64(1, gtid_24309);\n                float binop_x_27111 = sitofp_i64_f32(convop_x_27110);\n                float index_primexp_27112 = binop_x_27111 / sims_per_year_20275;\n                float res_24884;\n                float redout_27159 = 0.0F;\n                \n                for (int32_t i_27170 = 0; i_27170 < 4; i_27170++) {\n                    int64_t i_27160 = sext_i32_i64(i_27170);\n                    int64_t x_24890 = ((__global\n                                        int64_t *) res_mem_27200)[i_27160];\n                    float x_24891 = ((__global float *) res_mem_27201)[i_27160];\n                    int64_t i64_arg_24892 = sub64(x_24890, 1);\n                    float res_24893 = sitofp_i64_f32(i64_arg_24892);\n                    float y_24894 = x_24891 * res_24893;\n                    bool cond_24895 = y_24894 < index_primexp_27112;\n                    float ceil_arg_24896 = index_primexp_27112 / x_24891;\n                    float res_24897;\n                    \n                    res_24897 = futrts_ceil32(ceil_arg_24896);\n                    \n                    int64_t res_24898 = fptosi_f32_i64(res_24897);\n                    int64_t remaining_24899 = sub64(x_24890, res_24898);\n                    float res_24900;\n                    \n                    if (cond_24895) {\n                        res_24900 = 0.0F;\n                    } else {\n                        float x_24888 = ((__global\n                                          float *) res_mem_27198)[i_27160];\n                        float x_24889 = ((__global\n                                          float *) res_mem_27199)[i_27160];\n                        float nextpayment_24901 = x_24891 * res_24897;\n                        bool bounds_invalid_upwards_24902 =\n          ",
                   "                   slt64(remaining_24899, 1);\n                        bool valid_24903 = !bounds_invalid_upwards_24902;\n                        bool range_valid_c_24904;\n                        \n                        if (!valid_24903) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 28) == -1) {\n                                    global_failure_args[0] = 1;\n                                    global_failure_args[1] = 2;\n                                    global_failure_args[2] = remaining_24899;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float y_24906 = nextpayment_24901 - index_primexp_27112;\n                        float negate_arg_24907 = 1.0e-2F * y_24906;\n                        float exp_arg_24908 = 0.0F - negate_arg_24907;\n                        float res_24909 = fpow32(2.7182817F, exp_arg_24908);\n                        float x_24910 = 1.0F - res_24909;\n                        float B_24911 = x_24910 / 1.0e-2F;\n                        float x_24912 = B_24911 - nextpayment_24901;\n                        float x_24913 = x_24912 + index_primexp_27112;\n                        float x_24914 = 4.4999997e-6F * x_24913;\n                        float A1_24915 = x_24914 / 1.0e-4F;\n                        float y_24916 = fpow32(B_24911, 2.0F);\n                        float x_24917 = 1.0000001e-6F * y_24916;\n                        float A2_24918 = x_24917 / 4.0e-2F;\n                        float exp_arg_24919 = A1_24915 - A2_24918;\n                        float res_24920 = fpow32(2.7182817F, exp_arg_24919);\n                        float negate_arg_24921 = x_24882 * B_24911;\n                        float exp_ar",
                   "g_24922 = 0.0F - negate_arg_24921;\n                        float res_24923 = fpow32(2.7182817F, exp_arg_24922);\n                        float res_24924 = res_24920 * res_24923;\n                        bool y_24925 = slt64(0, remaining_24899);\n                        bool index_certs_24926;\n                        \n                        if (!y_24925) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 29) == -1) {\n                                    global_failure_args[0] = 0;\n                                    global_failure_args[1] = remaining_24899;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float binop_y_24927 = sitofp_i64_f32(remaining_24899);\n                        float binop_y_24928 = x_24891 * binop_y_24927;\n                        float index_primexp_24929 = nextpayment_24901 +\n                              binop_y_24928;\n                        float y_24930 = index_primexp_24929 -\n                              index_primexp_27112;\n                        float negate_arg_24931 = 1.0e-2F * y_24930;\n                        float exp_arg_24932 = 0.0F - negate_arg_24931;\n                        float res_24933 = fpow32(2.7182817F, exp_arg_24932);\n                        float x_24934 = 1.0F - res_24933;\n                        float B_24935 = x_24934 / 1.0e-2F;\n                        float x_24936 = B_24935 - index_primexp_24929;\n                        float x_24937 = x_24936 + index_primexp_27112;\n                        float x_24938 = 4.4999997e-6F * x_24937;\n                        float A1_24939 = x_24938 / 1.0e-4F;\n                        float y_24940 = fpow32(B_24935, 2.0F);\n                   ",
                   "     float x_24941 = 1.0000001e-6F * y_24940;\n                        float A2_24942 = x_24941 / 4.0e-2F;\n                        float exp_arg_24943 = A1_24939 - A2_24942;\n                        float res_24944 = fpow32(2.7182817F, exp_arg_24943);\n                        float negate_arg_24945 = x_24882 * B_24935;\n                        float exp_arg_24946 = 0.0F - negate_arg_24945;\n                        float res_24947 = fpow32(2.7182817F, exp_arg_24946);\n                        float res_24948 = res_24944 * res_24947;\n                        float res_24949;\n                        float redout_27107 = 0.0F;\n                        \n                        for (int64_t i_27108 = 0; i_27108 < remaining_24899;\n                             i_27108++) {\n                            int64_t index_primexp_27134 = add64(1, i_27108);\n                            float res_24954 =\n                                  sitofp_i64_f32(index_primexp_27134);\n                            float res_24955 = x_24891 * res_24954;\n                            float res_24956 = nextpayment_24901 + res_24955;\n                            float y_24957 = res_24956 - index_primexp_27112;\n                            float negate_arg_24958 = 1.0e-2F * y_24957;\n                            float exp_arg_24959 = 0.0F - negate_arg_24958;\n                            float res_24960 = fpow32(2.7182817F, exp_arg_24959);\n                            float x_24961 = 1.0F - res_24960;\n                            float B_24962 = x_24961 / 1.0e-2F;\n                            float x_24963 = B_24962 - res_24956;\n                            float x_24964 = x_24963 + index_primexp_27112;\n                            float x_24965 = 4.4999997e-6F * x_24964;\n                            float A1_24966 = x_24965 / 1.0e-4F;\n                            float y_24967 = fpow32(B_24962, 2.0F);\n                            float x_24968 = 1.0000001e-6F * y_24967;\n                            float A2_24969 = x_24968 / 4",
                   ".0e-2F;\n                            float exp_arg_24970 = A1_24966 - A2_24969;\n                            float res_24971 = fpow32(2.7182817F, exp_arg_24970);\n                            float negate_arg_24972 = x_24882 * B_24962;\n                            float exp_arg_24973 = 0.0F - negate_arg_24972;\n                            float res_24974 = fpow32(2.7182817F, exp_arg_24973);\n                            float res_24975 = res_24971 * res_24974;\n                            float res_24952 = res_24975 + redout_27107;\n                            float redout_tmp_27440 = res_24952;\n                            \n                            redout_27107 = redout_tmp_27440;\n                        }\n                        res_24949 = redout_27107;\n                        \n                        float x_24976 = res_24924 - res_24948;\n                        float x_24977 = x_24888 * x_24891;\n                        float y_24978 = res_24949 * x_24977;\n                        float y_24979 = x_24976 - y_24978;\n                        float res_24980 = x_24889 * y_24979;\n                        float res_24981 = x_24889 * res_24980;\n                        \n                        res_24900 = res_24981;\n                    }\n                    \n                    float res_24887 = res_24900 + redout_27159;\n                    float redout_tmp_27439 = res_24887;\n                    \n                    redout_27159 = redout_tmp_27439;\n                }\n                res_24884 = redout_27159;\n                \n                float res_24982 = fmax32(0.0F, res_24884);\n                \n                // save map-out results\n                { }\n                // save results to be reduced\n                {\n                    ((__local\n                      float *) red_arr_mem_27434)[sext_i32_i64(local_tid_27430)] =\n                        res_24982;\n                }\n            } else {\n                ((__local\n                  float *) red_arr_mem_27434)[sext_",
                   "i32_i64(local_tid_27430)] =\n                    0.0F;\n            }\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, paths_20195)) {\n            // perform segmented scan to imitate reduction\n            {\n                float x_24877;\n                float x_24878;\n                float x_27441;\n                float x_27442;\n                bool ltid_in_bounds_27444;\n                \n                ltid_in_bounds_27444 = slt64(sext_i32_i64(local_tid_27430),\n                                             paths_20195 *\n                                             squot64(segred_group_sizze_24873,\n                                                     segment_sizze_nonzzero_27427));\n                \n                int32_t skip_threads_27445;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_27444) {\n                        x_24878 = ((volatile __local\n                                    float *) red_arr_mem_27434)[sext_i32_i64(local_tid_27430)];\n                        if ((local_tid_27430 - squot32(local_tid_27430, 32) *\n                             32) == 0) {\n                            x_24877 = x_24878;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_27445 = 1;\n                    while (slt32(skip_threads_27445, 32)) {\n                        if (sle32(skip_threads_27445, local_tid_27430 -\n                                  squot32(local_tid_27430, 32) * 32) &&\n                            ltid_in_bounds_27444) {\n                            // read operands\n                            {\n                                x_24877 = ((volatile __local\n                                            float *) red_arr_mem_27434)[sext_i32_i64(local_",
                   "tid_27430) -\n                                                                        sext_i32_i64(skip_threads_27445)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_27446 =\n                                     slt64(srem64(sext_i32_i64(local_tid_27430),\n                                                  paths_20195),\n                                           sext_i32_i64(local_tid_27430) -\n                                           sext_i32_i64(local_tid_27430 -\n                                           skip_threads_27445));\n                                \n                                if (inactive_27446) {\n                                    x_24877 = x_24878;\n                                }\n                                if (!inactive_27446) {\n                                    float res_24879 = x_24877 + x_24878;\n                                    \n                                    x_24877 = res_24879;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_27432, skip_threads_27445)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_27445, local_tid_27430 -\n                                  squot32(local_tid_27430, 32) * 32) &&\n                            ltid_in_bounds_27444) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_27434)[sext_i32_i64(local_tid_27430)] =\n                                    x_24877;\n                                x_24878 = x_24877;\n                            }\n                        }\n                        if (sle32(wave_sizze_27432, skip_threads_27445)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n          ",
                   "              }\n                        skip_threads_27445 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_27430 - squot32(local_tid_27430, 32) * 32) ==\n                        31 && ltid_in_bounds_27444) {\n                        ((volatile __local\n                          float *) red_arr_mem_27434)[sext_i32_i64(squot32(local_tid_27430,\n                                                                           32))] =\n                            x_24877;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_27447;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_27430, 32) == 0 &&\n                            ltid_in_bounds_27444) {\n                            x_27442 = ((volatile __local\n                                        float *) red_arr_mem_27434)[sext_i32_i64(local_tid_27430)];\n                            if ((local_tid_27430 - squot32(local_tid_27430,\n                                                           32) * 32) == 0) {\n                                x_27441 = x_27442;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_27447 = 1;\n                        while (slt32(skip_threads_27447, 32)) {\n                            if (sle32(skip_threads_27447, local_tid_27430 -\n                                      squot32(local_tid_27430, 32) * 32) &&\n                                (squot32(local_tid_27430, 32) == 0 &&\n                                 ltid_in",
                   "_bounds_27444)) {\n                                // read operands\n                                {\n                                    x_27441 = ((volatile __local\n                                                float *) red_arr_mem_27434)[sext_i32_i64(local_tid_27430) -\n                                                                            sext_i32_i64(skip_threads_27447)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_27448 =\n                                         slt64(srem64(sext_i32_i64(local_tid_27430 *\n                                                      32 + 32 - 1),\n                                                      paths_20195),\n                                               sext_i32_i64(local_tid_27430 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_27430 -\n                                                             skip_threads_27447) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_27448) {\n                                        x_27441 = x_27442;\n                                    }\n                                    if (!inactive_27448) {\n                                        float res_27443 = x_27441 + x_27442;\n                                        \n                                        x_27441 = res_27443;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_27432, skip_threads_27447)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_27447, local_tid_27430 -\n                                      squot32(local_tid_27430, 32) * 32)",
                   " &&\n                                (squot32(local_tid_27430, 32) == 0 &&\n                                 ltid_in_bounds_27444)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      float *) red_arr_mem_27434)[sext_i32_i64(local_tid_27430)] =\n                                        x_27441;\n                                    x_27442 = x_27441;\n                                }\n                            }\n                            if (sle32(wave_sizze_27432, skip_threads_27447)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_27447 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_27430, 32) == 0 ||\n                          !ltid_in_bounds_27444)) {\n                        // read operands\n                        {\n                            x_24878 = x_24877;\n                            x_24877 = ((__local\n                                        float *) red_arr_mem_27434)[sext_i32_i64(squot32(local_tid_27430,\n                                                                                         32)) -\n                                                                    1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_27449 =\n                                 slt64(srem64(sext_i32_i64(local_tid_27430),\n                                              paths_20195),\n                                       sext_i32_i64(local_tid_27430) -\n                                       sext_i32_i64(squot32(local_tid_27430,\n                                                            32) * ",
                   "32 - 1));\n                            \n                            if (inactive_27449) {\n                                x_24877 = x_24878;\n                            }\n                            if (!inactive_27449) {\n                                float res_24879 = x_24877 + x_24878;\n                                \n                                x_24877 = res_24879;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              float *) red_arr_mem_27434)[sext_i32_i64(local_tid_27430)] =\n                                x_24877;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_27430, 32) == 0) {\n                        ((__local\n                          float *) red_arr_mem_27434)[sext_i32_i64(local_tid_27430)] =\n                            x_24878;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_27438) *\n                      squot64(segred_group_sizze_24873,\n                              segment_sizze_nonzzero_27427) +\n                      sext_i32_i64(local_tid_27430), steps_20196) &&\n                slt64(sext_i32_i64(local_tid_27430),\n                      squot64(segred_group_sizze_24873,\n                              segment_sizze_nonzzero_27427))) {\n                ((__global\n                  float *) mem_27242)[sext_i32_i64(virt_group_id_27438) *\n                                      squot64(segred_group_sizze_24873,\n                                              segment_sizze_nonzzero_27427) +\n                                      sext_i32_i64(",
                   "local_tid_27430)] = ((__local\n                                                                         float *) red_arr_mem_27434)[(sext_i32_i64(local_tid_27430) +\n                                                                                                      1) *\n                                                                                                     segment_sizze_nonzzero_27427 -\n                                                                                                     1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_24873\n}\n__kernel void test2zisegmap_25036(__global int *global_failure,\n                                  int failure_is_an_option, __global\n                                  int64_t *global_failure_args,\n                                  int64_t numswaps_20496, __global\n                                  unsigned char *mem_27175, __global\n                                  unsigned char *mem_27177, __global\n                                  unsigned char *mem_27179, __global\n                                  unsigned char *mem_27182, __global\n                                  unsigned char *mem_27184, __global\n                                  unsigned char *mem_27186, __global\n                                  unsigned char *mem_27188)\n{\n    #define segmap_group_sizze_25102 (test2zisegmap_group_sizze_25038)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27333;\n    int32_t local_tid_27334;\n    int64_t group_sizze_27337;\n    int32_t wave_sizze_27336;\n    int32_t group_tid_27335;\n    \n    global_tid_27333 = get_global_id(0);\n    local_tid_27334 = get_local_id(0);\n    group_sizze_27337 = get_local_size(0);\n    wave_sizze_27336 = LOCKSTEP_WIDTH;\n    group_tid_27335",
                   " = get_group_id(0);\n    \n    int32_t phys_tid_25036;\n    \n    phys_tid_25036 = global_tid_27333;\n    \n    int64_t gtid_25035;\n    \n    gtid_25035 = sext_i32_i64(group_tid_27335) * segmap_group_sizze_25102 +\n        sext_i32_i64(local_tid_27334);\n    if (slt64(gtid_25035, numswaps_20496)) {\n        float res_25113 = ((__global float *) mem_27179)[gtid_25035];\n        int64_t res_25114 = ((__global int64_t *) mem_27177)[gtid_25035];\n        float res_25115 = ((__global float *) mem_27175)[gtid_25035];\n        bool bounds_invalid_upwards_25116 = slt64(res_25114, 1);\n        bool valid_25117 = !bounds_invalid_upwards_25116;\n        bool range_valid_c_25118;\n        \n        if (!valid_25117) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 32) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = 2;\n                    global_failure_args[2] = res_25114;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        bool y_25120 = slt64(0, res_25114);\n        bool index_certs_25121;\n        \n        if (!y_25120) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 33) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_25114;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_25122 = sitofp_i64_f32(res_25114);\n        float index_primexp_25123 = res_25113 * binop_y_25122;\n        float negate_arg_25124 = 1.0e-2F * index_primexp_25123;\n        float exp_arg_25125 = 0.0F - negate_arg_25124;\n        float res_25126 = fpow32(2.7182817F, exp_arg_25125);\n        float x_25127 = 1.0F - res_25126;\n        float B_25128 = x_25127 / 1.0e-2F;\n        float x_25129 = B_25128 - index_primexp_25123;\n        float x_25130 = 4.4999997e-6F * x_25129;\n        float A1_25131 = x_25130 / 1.0e-4F;\n        float y_25132 =",
                   " fpow32(B_25128, 2.0F);\n        float x_25133 = 1.0000001e-6F * y_25132;\n        float A2_25134 = x_25133 / 4.0e-2F;\n        float exp_arg_25135 = A1_25131 - A2_25134;\n        float res_25136 = fpow32(2.7182817F, exp_arg_25135);\n        float negate_arg_25137 = 5.0e-2F * B_25128;\n        float exp_arg_25138 = 0.0F - negate_arg_25137;\n        float res_25139 = fpow32(2.7182817F, exp_arg_25138);\n        float res_25140 = res_25136 * res_25139;\n        float res_25141;\n        float redout_27076 = 0.0F;\n        \n        for (int64_t i_27077 = 0; i_27077 < res_25114; i_27077++) {\n            int64_t index_primexp_27120 = add64(1, i_27077);\n            float res_25146 = sitofp_i64_f32(index_primexp_27120);\n            float res_25147 = res_25113 * res_25146;\n            float negate_arg_25148 = 1.0e-2F * res_25147;\n            float exp_arg_25149 = 0.0F - negate_arg_25148;\n            float res_25150 = fpow32(2.7182817F, exp_arg_25149);\n            float x_25151 = 1.0F - res_25150;\n            float B_25152 = x_25151 / 1.0e-2F;\n            float x_25153 = B_25152 - res_25147;\n            float x_25154 = 4.4999997e-6F * x_25153;\n            float A1_25155 = x_25154 / 1.0e-4F;\n            float y_25156 = fpow32(B_25152, 2.0F);\n            float x_25157 = 1.0000001e-6F * y_25156;\n            float A2_25158 = x_25157 / 4.0e-2F;\n            float exp_arg_25159 = A1_25155 - A2_25158;\n            float res_25160 = fpow32(2.7182817F, exp_arg_25159);\n            float negate_arg_25161 = 5.0e-2F * B_25152;\n            float exp_arg_25162 = 0.0F - negate_arg_25161;\n            float res_25163 = fpow32(2.7182817F, exp_arg_25162);\n            float res_25164 = res_25160 * res_25163;\n            float res_25144 = res_25164 + redout_27076;\n            float redout_tmp_27338 = res_25144;\n            \n            redout_27076 = redout_tmp_27338;\n        }\n        res_25141 = redout_27076;\n        \n        float x_25165 = 1.0F - res_25140;\n        float y_25166 = res_25113 * res_25141;\n  ",
                   "      float res_25167 = x_25165 / y_25166;\n        \n        ((__global float *) mem_27182)[gtid_25035] = res_25167;\n        ((__global float *) mem_27184)[gtid_25035] = res_25115;\n        ((__global int64_t *) mem_27186)[gtid_25035] = res_25114;\n        ((__global float *) mem_27188)[gtid_25035] = res_25113;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25102\n}\n__kernel void test2zisegmap_25185(__global int *global_failure,\n                                  int failure_is_an_option, __global\n                                  int64_t *global_failure_args,\n                                  int64_t numswaps_20496, __global\n                                  unsigned char *mem_27175, __global\n                                  unsigned char *mem_27177, __global\n                                  unsigned char *mem_27179, __global\n                                  unsigned char *mem_27191, __global\n                                  unsigned char *mem_27193, __global\n                                  unsigned char *mem_27195, __global\n                                  unsigned char *mem_27197)\n{\n    #define segmap_group_sizze_25251 (test2zisegmap_group_sizze_25187)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27339;\n    int32_t local_tid_27340;\n    int64_t group_sizze_27343;\n    int32_t wave_sizze_27342;\n    int32_t group_tid_27341;\n    \n    global_tid_27339 = get_global_id(0);\n    local_tid_27340 = get_local_id(0);\n    group_sizze_27343 = get_local_size(0);\n    wave_sizze_27342 = LOCKSTEP_WIDTH;\n    group_tid_27341 = get_group_id(0);\n    \n    int32_t phys_tid_25185;\n    \n    phys_tid_25185 = global_tid_27339;\n    \n    int64_t gtid_25184;\n    \n    gtid_25184 = sext_i32_i64(group_tid_27341) * segmap_group_sizze_25251 +\n        sext_i32_i64(local_tid_27340);\n    if (slt64(gtid_25184, numswaps_20496)) {\n        float res_25262 = ((__",
                   "global float *) mem_27179)[gtid_25184];\n        int64_t res_25263 = ((__global int64_t *) mem_27177)[gtid_25184];\n        float res_25264 = ((__global float *) mem_27175)[gtid_25184];\n        bool bounds_invalid_upwards_25265 = slt64(res_25263, 1);\n        bool valid_25266 = !bounds_invalid_upwards_25265;\n        bool range_valid_c_25267;\n        \n        if (!valid_25266) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 34) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = 2;\n                    global_failure_args[2] = res_25263;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        bool y_25269 = slt64(0, res_25263);\n        bool index_certs_25270;\n        \n        if (!y_25269) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 35) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_25263;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_25271 = sitofp_i64_f32(res_25263);\n        float index_primexp_25272 = res_25262 * binop_y_25271;\n        float negate_arg_25273 = 1.0e-2F * index_primexp_25272;\n        float exp_arg_25274 = 0.0F - negate_arg_25273;\n        float res_25275 = fpow32(2.7182817F, exp_arg_25274);\n        float x_25276 = 1.0F - res_25275;\n        float B_25277 = x_25276 / 1.0e-2F;\n        float x_25278 = B_25277 - index_primexp_25272;\n        float x_25279 = 4.4999997e-6F * x_25278;\n        float A1_25280 = x_25279 / 1.0e-4F;\n        float y_25281 = fpow32(B_25277, 2.0F);\n        float x_25282 = 1.0000001e-6F * y_25281;\n        float A2_25283 = x_25282 / 4.0e-2F;\n        float exp_arg_25284 = A1_25280 - A2_25283;\n        float res_25285 = fpow32(2.7182817F, exp_arg_25284);\n        float negate_arg_25286 = 5.0e-2F * B_25277;\n        float exp_arg_25287 = 0.0F - neg",
                   "ate_arg_25286;\n        float res_25288 = fpow32(2.7182817F, exp_arg_25287);\n        float res_25289 = res_25285 * res_25288;\n        float res_25290;\n        float redout_27080 = 0.0F;\n        \n        for (int64_t i_27081 = 0; i_27081 < res_25263; i_27081++) {\n            int64_t index_primexp_27122 = add64(1, i_27081);\n            float res_25295 = sitofp_i64_f32(index_primexp_27122);\n            float res_25296 = res_25262 * res_25295;\n            float negate_arg_25297 = 1.0e-2F * res_25296;\n            float exp_arg_25298 = 0.0F - negate_arg_25297;\n            float res_25299 = fpow32(2.7182817F, exp_arg_25298);\n            float x_25300 = 1.0F - res_25299;\n            float B_25301 = x_25300 / 1.0e-2F;\n            float x_25302 = B_25301 - res_25296;\n            float x_25303 = 4.4999997e-6F * x_25302;\n            float A1_25304 = x_25303 / 1.0e-4F;\n            float y_25305 = fpow32(B_25301, 2.0F);\n            float x_25306 = 1.0000001e-6F * y_25305;\n            float A2_25307 = x_25306 / 4.0e-2F;\n            float exp_arg_25308 = A1_25304 - A2_25307;\n            float res_25309 = fpow32(2.7182817F, exp_arg_25308);\n            float negate_arg_25310 = 5.0e-2F * B_25301;\n            float exp_arg_25311 = 0.0F - negate_arg_25310;\n            float res_25312 = fpow32(2.7182817F, exp_arg_25311);\n            float res_25313 = res_25309 * res_25312;\n            float res_25293 = res_25313 + redout_27080;\n            float redout_tmp_27344 = res_25293;\n            \n            redout_27080 = redout_tmp_27344;\n        }\n        res_25290 = redout_27080;\n        \n        float x_25314 = 1.0F - res_25289;\n        float y_25315 = res_25262 * res_25290;\n        float res_25316 = x_25314 / y_25315;\n        \n        ((__global float *) mem_27191)[gtid_25184] = res_25316;\n        ((__global float *) mem_27193)[gtid_25184] = res_25264;\n        ((__global int64_t *) mem_27195)[gtid_25184] = res_25263;\n        ((__global float *) mem_27197)[gtid_25184] = res_25262;\n    }\n    \n",
                   "  error_0:\n    return;\n    #undef segmap_group_sizze_25251\n}\n__kernel void test2zisegmap_25494(__global int *global_failure,\n                                  int failure_is_an_option, __global\n                                  int64_t *global_failure_args,\n                                  int64_t paths_20494, int64_t steps_20495,\n                                  float dt_20565, int64_t upper_bound_20644,\n                                  float res_20645, int64_t num_groups_25746,\n                                  __global unsigned char *mem_27211, __global\n                                  unsigned char *mem_27214, __global\n                                  unsigned char *mem_27229)\n{\n    #define segmap_group_sizze_25745 (test2zisegmap_group_sizze_25496)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27357;\n    int32_t local_tid_27358;\n    int64_t group_sizze_27361;\n    int32_t wave_sizze_27360;\n    int32_t group_tid_27359;\n    \n    global_tid_27357 = get_global_id(0);\n    local_tid_27358 = get_local_id(0);\n    group_sizze_27361 = get_local_size(0);\n    wave_sizze_27360 = LOCKSTEP_WIDTH;\n    group_tid_27359 = get_group_id(0);\n    \n    int32_t phys_tid_25494;\n    \n    phys_tid_25494 = global_tid_27357;\n    \n    int32_t phys_group_id_27362;\n    \n    phys_group_id_27362 = get_group_id(0);\n    for (int32_t i_27363 = 0; i_27363 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(paths_20494,\n                                          segmap_group_sizze_25745)) -\n                   phys_group_id_27362, sext_i64_i32(num_groups_25746));\n         i_27363++) {\n        int32_t virt_group_id_27364 = phys_group_id_27362 + i_27363 *\n                sext_i64_i32(num_groups_25746)",
                   ";\n        int64_t gtid_25493 = sext_i32_i64(virt_group_id_27364) *\n                segmap_group_sizze_25745 + sext_i32_i64(local_tid_27358);\n        \n        if (slt64(gtid_25493, paths_20494)) {\n            for (int64_t i_27365 = 0; i_27365 < steps_20495; i_27365++) {\n                ((__global float *) mem_27214)[phys_tid_25494 + i_27365 *\n                                               (num_groups_25746 *\n                                                segmap_group_sizze_25745)] =\n                    5.0e-2F;\n            }\n            for (int64_t i_25752 = 0; i_25752 < upper_bound_20644; i_25752++) {\n                bool y_25754 = slt64(i_25752, steps_20495);\n                bool index_certs_25755;\n                \n                if (!y_25754) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 36) ==\n                            -1) {\n                            global_failure_args[0] = i_25752;\n                            global_failure_args[1] = steps_20495;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float shortstep_arg_25756 = ((__global\n                                              float *) mem_27211)[i_25752 *\n                                                                  paths_20494 +\n                                                                  gtid_25493];\n                float shortstep_arg_25757 = ((__global\n                                              float *) mem_27214)[phys_tid_25494 +\n                                                                  i_25752 *\n                                                                  (num_groups_25746 *\n                                                                   segmap_group_sizze_25745)];\n                float y_25758 = 5.0e-2F - shortstep_arg_25757;\n                float x_25759 ",
                   "= 1.0e-2F * y_25758;\n                float x_25760 = dt_20565 * x_25759;\n                float x_25761 = res_20645 * shortstep_arg_25756;\n                float y_25762 = 1.0e-3F * x_25761;\n                float delta_r_25763 = x_25760 + y_25762;\n                float res_25764 = shortstep_arg_25757 + delta_r_25763;\n                int64_t i_25765 = add64(1, i_25752);\n                bool x_25766 = sle64(0, i_25765);\n                bool y_25767 = slt64(i_25765, steps_20495);\n                bool bounds_check_25768 = x_25766 && y_25767;\n                bool index_certs_25769;\n                \n                if (!bounds_check_25768) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 37) ==\n                            -1) {\n                            global_failure_args[0] = i_25765;\n                            global_failure_args[1] = steps_20495;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                ((__global float *) mem_27214)[phys_tid_25494 + i_25765 *\n                                               (num_groups_25746 *\n                                                segmap_group_sizze_25745)] =\n                    res_25764;\n            }\n            for (int64_t i_27367 = 0; i_27367 < steps_20495; i_27367++) {\n                ((__global float *) mem_27229)[i_27367 * paths_20494 +\n                                               gtid_25493] = ((__global\n                                                               float *) mem_27214)[phys_tid_25494 +\n                                                                                   i_27367 *\n                                                                                   (num_groups_25746 *\n                                                                                    segmap_group_sizze_25745)];\n            }\n        }\n ",
                   "       barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25745\n}\n__kernel void test2zisegmap_25592(__global int *global_failure,\n                                  int64_t paths_20494, int64_t steps_20495,\n                                  __global unsigned char *mem_27204, __global\n                                  unsigned char *mem_27208)\n{\n    #define segmap_group_sizze_25700 (test2zisegmap_group_sizze_25595)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27351;\n    int32_t local_tid_27352;\n    int64_t group_sizze_27355;\n    int32_t wave_sizze_27354;\n    int32_t group_tid_27353;\n    \n    global_tid_27351 = get_global_id(0);\n    local_tid_27352 = get_local_id(0);\n    group_sizze_27355 = get_local_size(0);\n    wave_sizze_27354 = LOCKSTEP_WIDTH;\n    group_tid_27353 = get_group_id(0);\n    \n    int32_t phys_tid_25592;\n    \n    phys_tid_25592 = global_tid_27351;\n    \n    int64_t gtid_25590;\n    \n    gtid_25590 = squot64(sext_i32_i64(group_tid_27353) *\n                         segmap_group_sizze_25700 +\n                         sext_i32_i64(local_tid_27352), steps_20495);\n    \n    int64_t gtid_25591;\n    \n    gtid_25591 = sext_i32_i64(group_tid_27353) * segmap_group_sizze_25700 +\n        sext_i32_i64(local_tid_27352) - squot64(sext_i32_i64(group_tid_27353) *\n                                                segmap_group_sizze_25700 +\n                                                sext_i32_i64(local_tid_27352),\n                                                steps_20495) * steps_20495;\n    if (slt64(gtid_25590, paths_20494) && slt64(gtid_25591, steps_20495)) {\n        int32_t unsign_arg_25703 = ((__global int32_t *) mem_27204)[gtid_25590];\n        int32_t res_25705 = sext_i64_i32(gtid_25591);\n        int32_t x_25706 = lshr32(res_25705, 16);\n        int32_t x_25707 = res_25705 ^ x_2",
                   "5706;\n        int32_t x_25708 = mul32(73244475, x_25707);\n        int32_t x_25709 = lshr32(x_25708, 16);\n        int32_t x_25710 = x_25708 ^ x_25709;\n        int32_t x_25711 = mul32(73244475, x_25710);\n        int32_t x_25712 = lshr32(x_25711, 16);\n        int32_t x_25713 = x_25711 ^ x_25712;\n        int32_t unsign_arg_25714 = unsign_arg_25703 ^ x_25713;\n        int32_t unsign_arg_25715 = mul32(48271, unsign_arg_25714);\n        int32_t unsign_arg_25716 = umod32(unsign_arg_25715, 2147483647);\n        int32_t unsign_arg_25717 = mul32(48271, unsign_arg_25716);\n        int32_t unsign_arg_25718 = umod32(unsign_arg_25717, 2147483647);\n        float res_25719 = uitofp_i32_f32(unsign_arg_25716);\n        float res_25720 = res_25719 / 2.1474836e9F;\n        float res_25721 = uitofp_i32_f32(unsign_arg_25718);\n        float res_25722 = res_25721 / 2.1474836e9F;\n        float res_25723;\n        \n        res_25723 = futrts_log32(res_25720);\n        \n        float res_25724 = -2.0F * res_25723;\n        float res_25725;\n        \n        res_25725 = futrts_sqrt32(res_25724);\n        \n        float res_25726 = 6.2831855F * res_25722;\n        float res_25727;\n        \n        res_25727 = futrts_cos32(res_25726);\n        \n        float res_25728 = res_25725 * res_25727;\n        \n        ((__global float *) mem_27208)[gtid_25590 * steps_20495 + gtid_25591] =\n            res_25728;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25700\n}\n__kernel void test2zisegmap_25656(__global int *global_failure,\n                                  int64_t paths_20494, __global\n                                  unsigned char *mem_27204)\n{\n    #define segmap_group_sizze_25675 (test2zisegmap_group_sizze_25658)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27346;\n    int32_t local_tid_27347;\n    int64_t group_sizze_27350;\n    int32_t wave_sizze_27349;\n    int32_t gr",
                   "oup_tid_27348;\n    \n    global_tid_27346 = get_global_id(0);\n    local_tid_27347 = get_local_id(0);\n    group_sizze_27350 = get_local_size(0);\n    wave_sizze_27349 = LOCKSTEP_WIDTH;\n    group_tid_27348 = get_group_id(0);\n    \n    int32_t phys_tid_25656;\n    \n    phys_tid_25656 = global_tid_27346;\n    \n    int64_t gtid_25655;\n    \n    gtid_25655 = sext_i32_i64(group_tid_27348) * segmap_group_sizze_25675 +\n        sext_i32_i64(local_tid_27347);\n    if (slt64(gtid_25655, paths_20494)) {\n        int32_t res_25679 = sext_i64_i32(gtid_25655);\n        int32_t x_25680 = lshr32(res_25679, 16);\n        int32_t x_25681 = res_25679 ^ x_25680;\n        int32_t x_25682 = mul32(73244475, x_25681);\n        int32_t x_25683 = lshr32(x_25682, 16);\n        int32_t x_25684 = x_25682 ^ x_25683;\n        int32_t x_25685 = mul32(73244475, x_25684);\n        int32_t x_25686 = lshr32(x_25685, 16);\n        int32_t x_25687 = x_25685 ^ x_25686;\n        int32_t unsign_arg_25688 = 777822902 ^ x_25687;\n        int32_t unsign_arg_25689 = mul32(48271, unsign_arg_25688);\n        int32_t unsign_arg_25690 = umod32(unsign_arg_25689, 2147483647);\n        \n        ((__global int32_t *) mem_27204)[gtid_25655] = unsign_arg_25690;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25675\n}\n__kernel void test2zisegmap_25932(__global int *global_failure,\n                                  int failure_is_an_option, __global\n                                  int64_t *global_failure_args,\n                                  int64_t paths_20494, int64_t steps_20495,\n                                  int64_t numswaps_20496,\n                                  float sims_per_year_20630, float res_20707,\n                                  __global unsigned char *res_mem_27198,\n                                  __global unsigned char *res_mem_27199,\n                                  __global unsigned char *res_mem_27200,\n                                  __global unsigned char *res_mem_27201,\n                      ",
                   "            __global unsigned char *mem_27229, __global\n                                  unsigned char *mem_27235)\n{\n    #define segmap_group_sizze_26655 (test2zisegmap_group_sizze_25934)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27404;\n    int32_t local_tid_27405;\n    int64_t group_sizze_27408;\n    int32_t wave_sizze_27407;\n    int32_t group_tid_27406;\n    \n    global_tid_27404 = get_global_id(0);\n    local_tid_27405 = get_local_id(0);\n    group_sizze_27408 = get_local_size(0);\n    wave_sizze_27407 = LOCKSTEP_WIDTH;\n    group_tid_27406 = get_group_id(0);\n    \n    int32_t phys_tid_25932;\n    \n    phys_tid_25932 = global_tid_27404;\n    \n    int64_t gtid_25931;\n    \n    gtid_25931 = sext_i32_i64(group_tid_27406) * segmap_group_sizze_26655 +\n        sext_i32_i64(local_tid_27405);\n    if (slt64(gtid_25931, steps_20495)) {\n        int64_t index_primexp_27098 = add64(1, gtid_25931);\n        float res_26661 = sitofp_i64_f32(index_primexp_27098);\n        float res_26662 = res_26661 / sims_per_year_20630;\n        float res_26663;\n        float redout_27153 = 0.0F;\n        \n        for (int64_t i_27154 = 0; i_27154 < paths_20494; i_27154++) {\n            float x_26667 = ((__global float *) mem_27229)[gtid_25931 *\n                                                           paths_20494 +\n                                                           i_27154];\n            float res_26669;\n            float redout_27155 = 0.0F;\n            \n            for (int64_t i_27156 = 0; i_27156 < numswaps_20496; i_27156++) {\n                int64_t x_26675 = ((__global int64_t *) res_mem_27200)[i_27156];\n                float x_26676 = ((__global float *) res_mem_27201)[i_27156];\n                int64_t i64_arg_26677 = sub64(x_26675, 1);\n                float res_26678 = sitofp_i64_f32(i64_arg_26677);\n                float y_26679 = x_26676 * res_26678;\n         ",
                   "       bool cond_26680 = y_26679 < res_26662;\n                float ceil_arg_26681 = res_26662 / x_26676;\n                float res_26682;\n                \n                res_26682 = futrts_ceil32(ceil_arg_26681);\n                \n                int64_t res_26683 = fptosi_f32_i64(res_26682);\n                int64_t remaining_26684 = sub64(x_26675, res_26683);\n                float res_26685;\n                \n                if (cond_26680) {\n                    res_26685 = 0.0F;\n                } else {\n                    float x_26673 = ((__global float *) res_mem_27198)[i_27156];\n                    float x_26674 = ((__global float *) res_mem_27199)[i_27156];\n                    float nextpayment_26686 = x_26676 * res_26682;\n                    bool bounds_invalid_upwards_26687 = slt64(remaining_26684,\n                                                              1);\n                    bool valid_26688 = !bounds_invalid_upwards_26687;\n                    bool range_valid_c_26689;\n                    \n                    if (!valid_26688) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1,\n                                                          40) == -1) {\n                                global_failure_args[0] = 1;\n                                global_failure_args[1] = 2;\n                                global_failure_args[2] = remaining_26684;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    \n                    float y_26691 = nextpayment_26686 - res_26662;\n                    float negate_arg_26692 = 1.0e-2F * y_26691;\n                    float exp_arg_26693 = 0.0F - negate_arg_26692;\n                    float res_26694 = fpow32(2.7182817F, exp_arg_26693);\n                    float x_26695 = 1.0F - res_26694;\n                    float B_26696 = x_26695 / 1.0e-2F;\n                    ",
                   "float x_26697 = B_26696 - nextpayment_26686;\n                    float x_26698 = res_26662 + x_26697;\n                    float x_26699 = 4.4999997e-6F * x_26698;\n                    float A1_26700 = x_26699 / 1.0e-4F;\n                    float y_26701 = fpow32(B_26696, 2.0F);\n                    float x_26702 = 1.0000001e-6F * y_26701;\n                    float A2_26703 = x_26702 / 4.0e-2F;\n                    float exp_arg_26704 = A1_26700 - A2_26703;\n                    float res_26705 = fpow32(2.7182817F, exp_arg_26704);\n                    float negate_arg_26706 = x_26667 * B_26696;\n                    float exp_arg_26707 = 0.0F - negate_arg_26706;\n                    float res_26708 = fpow32(2.7182817F, exp_arg_26707);\n                    float res_26709 = res_26705 * res_26708;\n                    bool y_26710 = slt64(0, remaining_26684);\n                    bool index_certs_26711;\n                    \n                    if (!y_26710) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1,\n                                                          41) == -1) {\n                                global_failure_args[0] = 0;\n                                global_failure_args[1] = remaining_26684;\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    \n                    float binop_y_26712 = sitofp_i64_f32(remaining_26684);\n                    float binop_y_26713 = x_26676 * binop_y_26712;\n                    float index_primexp_26714 = nextpayment_26686 +\n                          binop_y_26713;\n                    float y_26715 = index_primexp_26714 - res_26662;\n                    float negate_arg_26716 = 1.0e-2F * y_26715;\n                    float exp_arg_26717 = 0.0F - negate_arg_26716;\n                    float res_26718 = fpow32(2.7182817F, exp_arg_26717);\n                    float x_26719 = 1.0",
                   "F - res_26718;\n                    float B_26720 = x_26719 / 1.0e-2F;\n                    float x_26721 = B_26720 - index_primexp_26714;\n                    float x_26722 = res_26662 + x_26721;\n                    float x_26723 = 4.4999997e-6F * x_26722;\n                    float A1_26724 = x_26723 / 1.0e-4F;\n                    float y_26725 = fpow32(B_26720, 2.0F);\n                    float x_26726 = 1.0000001e-6F * y_26725;\n                    float A2_26727 = x_26726 / 4.0e-2F;\n                    float exp_arg_26728 = A1_26724 - A2_26727;\n                    float res_26729 = fpow32(2.7182817F, exp_arg_26728);\n                    float negate_arg_26730 = x_26667 * B_26720;\n                    float exp_arg_26731 = 0.0F - negate_arg_26730;\n                    float res_26732 = fpow32(2.7182817F, exp_arg_26731);\n                    float res_26733 = res_26729 * res_26732;\n                    float res_26734;\n                    float redout_27095 = 0.0F;\n                    \n                    for (int64_t i_27096 = 0; i_27096 < remaining_26684;\n                         i_27096++) {\n                        int64_t index_primexp_27126 = add64(1, i_27096);\n                        float res_26739 = sitofp_i64_f32(index_primexp_27126);\n                        float res_26740 = x_26676 * res_26739;\n                        float res_26741 = nextpayment_26686 + res_26740;\n                        float y_26742 = res_26741 - res_26662;\n                        float negate_arg_26743 = 1.0e-2F * y_26742;\n                        float exp_arg_26744 = 0.0F - negate_arg_26743;\n                        float res_26745 = fpow32(2.7182817F, exp_arg_26744);\n                        float x_26746 = 1.0F - res_26745;\n                        float B_26747 = x_26746 / 1.0e-2F;\n                        float x_26748 = B_26747 - res_26741;\n                        float x_26749 = res_26662 + x_26748;\n                        float x_26750 = 4.4999997e-6F * x_26749;\n                        f",
                   "loat A1_26751 = x_26750 / 1.0e-4F;\n                        float y_26752 = fpow32(B_26747, 2.0F);\n                        float x_26753 = 1.0000001e-6F * y_26752;\n                        float A2_26754 = x_26753 / 4.0e-2F;\n                        float exp_arg_26755 = A1_26751 - A2_26754;\n                        float res_26756 = fpow32(2.7182817F, exp_arg_26755);\n                        float negate_arg_26757 = x_26667 * B_26747;\n                        float exp_arg_26758 = 0.0F - negate_arg_26757;\n                        float res_26759 = fpow32(2.7182817F, exp_arg_26758);\n                        float res_26760 = res_26756 * res_26759;\n                        float res_26737 = res_26760 + redout_27095;\n                        float redout_tmp_27411 = res_26737;\n                        \n                        redout_27095 = redout_tmp_27411;\n                    }\n                    res_26734 = redout_27095;\n                    \n                    float x_26761 = res_26709 - res_26733;\n                    float x_26762 = x_26673 * x_26676;\n                    float y_26763 = res_26734 * x_26762;\n                    float y_26764 = x_26761 - y_26763;\n                    float res_26765 = x_26674 * y_26764;\n                    float res_26766 = x_26674 * res_26765;\n                    \n                    res_26685 = res_26766;\n                }\n                \n                float res_26672 = res_26685 + redout_27155;\n                float redout_tmp_27410 = res_26672;\n                \n                redout_27155 = redout_tmp_27410;\n            }\n            res_26669 = redout_27155;\n            \n            float res_26767 = fmax32(0.0F, res_26669);\n            float res_26666 = res_26767 + redout_27153;\n            float redout_tmp_27409 = res_26666;\n            \n            redout_27153 = redout_tmp_27409;\n        }\n        res_26663 = redout_27153;\n        \n        float res_26768 = res_26663 / res_20707;\n        float negate_arg_26769 = 1.0e-2F * res_266",
                   "62;\n        float exp_arg_26770 = 0.0F - negate_arg_26769;\n        float res_26771 = fpow32(2.7182817F, exp_arg_26770);\n        float x_26772 = 1.0F - res_26771;\n        float B_26773 = x_26772 / 1.0e-2F;\n        float x_26774 = B_26773 - res_26662;\n        float x_26775 = 4.4999997e-6F * x_26774;\n        float A1_26776 = x_26775 / 1.0e-4F;\n        float y_26777 = fpow32(B_26773, 2.0F);\n        float x_26778 = 1.0000001e-6F * y_26777;\n        float A2_26779 = x_26778 / 4.0e-2F;\n        float exp_arg_26780 = A1_26776 - A2_26779;\n        float res_26781 = fpow32(2.7182817F, exp_arg_26780);\n        float negate_arg_26782 = 5.0e-2F * B_26773;\n        float exp_arg_26783 = 0.0F - negate_arg_26782;\n        float res_26784 = fpow32(2.7182817F, exp_arg_26783);\n        float res_26785 = res_26781 * res_26784;\n        float res_26786 = res_26768 * res_26785;\n        \n        ((__global float *) mem_27235)[gtid_25931] = res_26786;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26655\n}\n__kernel void test2zisegmap_26337(__global int *global_failure,\n                                  int64_t steps_20495,\n                                  float sims_per_year_20630, float res_20707,\n                                  __global unsigned char *mem_27242, __global\n                                  unsigned char *mem_27245)\n{\n    #define segmap_group_sizze_27038 (test2zisegmap_group_sizze_26339)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27488;\n    int32_t local_tid_27489;\n    int64_t group_sizze_27492;\n    int32_t wave_sizze_27491;\n    int32_t group_tid_27490;\n    \n    global_tid_27488 = get_global_id(0);\n    local_tid_27489 = get_local_id(0);\n    group_sizze_27492 = get_local_size(0);\n    wave_sizze_27491 = LOCKSTEP_WIDTH;\n    group_tid_27490 = get_group_id(0);\n    \n    int32_t phys_tid_26337;\n    \n    phys_tid_26337 = global_tid_27488;\n   ",
                   " \n    int64_t gtid_26336;\n    \n    gtid_26336 = sext_i32_i64(group_tid_27490) * segmap_group_sizze_27038 +\n        sext_i32_i64(local_tid_27489);\n    if (slt64(gtid_26336, steps_20495)) {\n        int64_t convop_x_27116 = add64(1, gtid_26336);\n        float binop_x_27117 = sitofp_i64_f32(convop_x_27116);\n        float index_primexp_27118 = binop_x_27117 / sims_per_year_20630;\n        float res_27042 = ((__global float *) mem_27242)[gtid_26336];\n        float res_27043 = res_27042 / res_20707;\n        float negate_arg_27044 = 1.0e-2F * index_primexp_27118;\n        float exp_arg_27045 = 0.0F - negate_arg_27044;\n        float res_27046 = fpow32(2.7182817F, exp_arg_27045);\n        float x_27047 = 1.0F - res_27046;\n        float B_27048 = x_27047 / 1.0e-2F;\n        float x_27049 = B_27048 - index_primexp_27118;\n        float x_27050 = 4.4999997e-6F * x_27049;\n        float A1_27051 = x_27050 / 1.0e-4F;\n        float y_27052 = fpow32(B_27048, 2.0F);\n        float x_27053 = 1.0000001e-6F * y_27052;\n        float A2_27054 = x_27053 / 4.0e-2F;\n        float exp_arg_27055 = A1_27051 - A2_27054;\n        float res_27056 = fpow32(2.7182817F, exp_arg_27055);\n        float negate_arg_27057 = 5.0e-2F * B_27048;\n        float exp_arg_27058 = 0.0F - negate_arg_27057;\n        float res_27059 = fpow32(2.7182817F, exp_arg_27058);\n        float res_27060 = res_27056 * res_27059;\n        float res_27061 = res_27043 * res_27060;\n        \n        ((__global float *) mem_27245)[gtid_26336] = res_27061;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27038\n}\n__kernel void test2zisegmap_intragroup_25930(__global int *global_failure,\n                                             int failure_is_an_option, __global\n                                             int64_t *global_failure_args,\n                                             __local volatile\n                                             int64_t *red_arr_mem_27418_backing_aligned_0,\n                                            ",
                   " int64_t paths_20494,\n                                             int64_t numswaps_20496,\n                                             float sims_per_year_20630,\n                                             float res_20707, __global\n                                             unsigned char *res_mem_27198,\n                                             __global\n                                             unsigned char *res_mem_27199,\n                                             __global\n                                             unsigned char *res_mem_27200,\n                                             __global\n                                             unsigned char *res_mem_27201,\n                                             __global unsigned char *mem_27229,\n                                             __global unsigned char *mem_27239)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27418_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_27418_backing_aligned_0;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27412;\n    int32_t local_tid_27413;\n    int64_t group_sizze_27416;\n    int32_t wave_sizze_27415;\n    int32_t group_tid_27414;\n    \n    global_tid_27412 = get_global_id(0);\n    local_tid_27413 = get_local_id(0);\n    group_sizze_27416 = get_local_size(0);\n    wave_sizze_27415 = LOCKSTEP_WIDTH;\n    group_tid_27414 = get_group_id(0);\n    \n    int32_t phys_tid_25930;\n    \n    phys_tid_25930 = group_tid_27414;\n    \n    int32_t ltid_pre_27417;\n    \n    ltid_pre_27417 = local_tid_27413;\n    \n    int64_t gtid_25925;\n    \n    gtid_25925 = sext_i32_i64(group_tid_27414);\n    \n    int64_t index_primexp_27106;\n ",
                   "   \n    index_primexp_27106 = add64(1, gtid_25925);\n    \n    float res_26792 = sitofp_i64_f32(index_primexp_27106);\n    float res_26793 = res_26792 / sims_per_year_20630;\n    float res_26794;\n    int64_t gtid_25928 = sext_i32_i64(ltid_pre_27417);\n    int32_t phys_tid_25929 = local_tid_27413;\n    __local char *red_arr_mem_27418;\n    \n    red_arr_mem_27418 = (__local char *) red_arr_mem_27418_backing_0;\n    if (slt64(gtid_25928, paths_20494)) {\n        float x_26798 = ((__global float *) mem_27229)[gtid_25925 *\n                                                       paths_20494 +\n                                                       gtid_25928];\n        float res_26800;\n        float redout_27157 = 0.0F;\n        \n        for (int64_t i_27158 = 0; i_27158 < numswaps_20496; i_27158++) {\n            int64_t x_26806 = ((__global int64_t *) res_mem_27200)[i_27158];\n            float x_26807 = ((__global float *) res_mem_27201)[i_27158];\n            int64_t i64_arg_26808 = sub64(x_26806, 1);\n            float res_26809 = sitofp_i64_f32(i64_arg_26808);\n            float y_26810 = x_26807 * res_26809;\n            bool cond_26811 = y_26810 < res_26793;\n            float ceil_arg_26812 = res_26793 / x_26807;\n            float res_26813;\n            \n            res_26813 = futrts_ceil32(ceil_arg_26812);\n            \n            int64_t res_26814 = fptosi_f32_i64(res_26813);\n            int64_t remaining_26815 = sub64(x_26806, res_26814);\n            float res_26816;\n            \n            if (cond_26811) {\n                res_26816 = 0.0F;\n            } else {\n                float x_26804 = ((__global float *) res_mem_27198)[i_27158];\n                float x_26805 = ((__global float *) res_mem_27199)[i_27158];\n                float nextpayment_26817 = x_26807 * res_26813;\n                bool bounds_invalid_upwards_26818 = slt64(remaining_26815, 1);\n                bool valid_26819 = !bounds_invalid_upwards_26818;\n                bool range_valid_c_26820;\n                \n  ",
                   "              if (!valid_26819) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 42) ==\n                            -1) {\n                            global_failure_args[0] = 1;\n                            global_failure_args[1] = 2;\n                            global_failure_args[2] = remaining_26815;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float y_26822 = nextpayment_26817 - res_26793;\n                float negate_arg_26823 = 1.0e-2F * y_26822;\n                float exp_arg_26824 = 0.0F - negate_arg_26823;\n                float res_26825 = fpow32(2.7182817F, exp_arg_26824);\n                float x_26826 = 1.0F - res_26825;\n                float B_26827 = x_26826 / 1.0e-2F;\n                float x_26828 = B_26827 - nextpayment_26817;\n                float x_26829 = res_26793 + x_26828;\n                float x_26830 = 4.4999997e-6F * x_26829;\n                float A1_26831 = x_26830 / 1.0e-4F;\n                float y_26832 = fpow32(B_26827, 2.0F);\n                float x_26833 = 1.0000001e-6F * y_26832;\n                float A2_26834 = x_26833 / 4.0e-2F;\n                float exp_arg_26835 = A1_26831 - A2_26834;\n                float res_26836 = fpow32(2.7182817F, exp_arg_26835);\n                float negate_arg_26837 = x_26798 * B_26827;\n                float exp_arg_26838 = 0.0F - negate_arg_26837;\n                float res_26839 = fpow32(2.7182817F, exp_arg_26838);\n                float res_26840 = res_26836 * res_26839;\n                bool y_26841 = slt64(0, remaining_26815);\n                bool index_certs_26842;\n                \n                if (!y_26841) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 43) ==\n                            -1) {\n                            global_failure_arg",
                   "s[0] = 0;\n                            global_failure_args[1] = remaining_26815;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float binop_y_26843 = sitofp_i64_f32(remaining_26815);\n                float binop_y_26844 = x_26807 * binop_y_26843;\n                float index_primexp_26845 = nextpayment_26817 + binop_y_26844;\n                float y_26846 = index_primexp_26845 - res_26793;\n                float negate_arg_26847 = 1.0e-2F * y_26846;\n                float exp_arg_26848 = 0.0F - negate_arg_26847;\n                float res_26849 = fpow32(2.7182817F, exp_arg_26848);\n                float x_26850 = 1.0F - res_26849;\n                float B_26851 = x_26850 / 1.0e-2F;\n                float x_26852 = B_26851 - index_primexp_26845;\n                float x_26853 = res_26793 + x_26852;\n                float x_26854 = 4.4999997e-6F * x_26853;\n                float A1_26855 = x_26854 / 1.0e-4F;\n                float y_26856 = fpow32(B_26851, 2.0F);\n                float x_26857 = 1.0000001e-6F * y_26856;\n                float A2_26858 = x_26857 / 4.0e-2F;\n                float exp_arg_26859 = A1_26855 - A2_26858;\n                float res_26860 = fpow32(2.7182817F, exp_arg_26859);\n                float negate_arg_26861 = x_26798 * B_26851;\n                float exp_arg_26862 = 0.0F - negate_arg_26861;\n                float res_26863 = fpow32(2.7182817F, exp_arg_26862);\n                float res_26864 = res_26860 * res_26863;\n                float res_26865;\n                float redout_27099 = 0.0F;\n                \n                for (int64_t i_27100 = 0; i_27100 < remaining_26815;\n                     i_27100++) {\n                    int64_t index_primexp_27128 = add64(1, i_27100);\n                    float res_26870 = sitofp_i64_f32(index_primexp_27128);\n                    float res_26871 = x_26807 ",
                   "* res_26870;\n                    float res_26872 = nextpayment_26817 + res_26871;\n                    float y_26873 = res_26872 - res_26793;\n                    float negate_arg_26874 = 1.0e-2F * y_26873;\n                    float exp_arg_26875 = 0.0F - negate_arg_26874;\n                    float res_26876 = fpow32(2.7182817F, exp_arg_26875);\n                    float x_26877 = 1.0F - res_26876;\n                    float B_26878 = x_26877 / 1.0e-2F;\n                    float x_26879 = B_26878 - res_26872;\n                    float x_26880 = res_26793 + x_26879;\n                    float x_26881 = 4.4999997e-6F * x_26880;\n                    float A1_26882 = x_26881 / 1.0e-4F;\n                    float y_26883 = fpow32(B_26878, 2.0F);\n                    float x_26884 = 1.0000001e-6F * y_26883;\n                    float A2_26885 = x_26884 / 4.0e-2F;\n                    float exp_arg_26886 = A1_26882 - A2_26885;\n                    float res_26887 = fpow32(2.7182817F, exp_arg_26886);\n                    float negate_arg_26888 = x_26798 * B_26878;\n                    float exp_arg_26889 = 0.0F - negate_arg_26888;\n                    float res_26890 = fpow32(2.7182817F, exp_arg_26889);\n                    float res_26891 = res_26887 * res_26890;\n                    float res_26868 = res_26891 + redout_27099;\n                    float redout_tmp_27421 = res_26868;\n                    \n                    redout_27099 = redout_tmp_27421;\n                }\n                res_26865 = redout_27099;\n                \n                float x_26892 = res_26840 - res_26864;\n                float x_26893 = x_26804 * x_26807;\n                float y_26894 = res_26865 * x_26893;\n                float y_26895 = x_26892 - y_26894;\n                float res_26896 = x_26805 * y_26895;\n                float res_26897 = x_26805 * res_26896;\n                \n                res_26816 = res_26897;\n            }\n            \n            float res_26803 = res_26816 + redout_27157;\n          ",
                   "  float redout_tmp_27420 = res_26803;\n            \n            redout_27157 = redout_tmp_27420;\n        }\n        res_26800 = redout_27157;\n        \n        float res_26898 = fmax32(0.0F, res_26800);\n        \n        ((__local float *) red_arr_mem_27418)[gtid_25928] = res_26898;\n    }\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_27422;\n    int32_t skip_waves_27423;\n    \n    skip_waves_27423 = 1;\n    \n    float x_26795;\n    float x_26796;\n    \n    offset_27422 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_27413, sext_i64_i32(paths_20494))) {\n            x_26795 = ((__local\n                        float *) red_arr_mem_27418)[sext_i32_i64(local_tid_27413 +\n                                                    offset_27422)];\n        }\n    }\n    offset_27422 = 1;\n    while (slt32(offset_27422, wave_sizze_27415)) {\n        if (slt32(local_tid_27413 + offset_27422, sext_i64_i32(paths_20494)) &&\n            ((local_tid_27413 - squot32(local_tid_27413, wave_sizze_27415) *\n              wave_sizze_27415) & (2 * offset_27422 - 1)) == 0) {\n            // read array element\n            {\n                x_26796 = ((volatile __local\n                            float *) red_arr_mem_27418)[sext_i32_i64(local_tid_27413 +\n                                                        offset_27422)];\n            }\n            // apply reduction operation\n            {\n                float res_26797 = x_26795 + x_26796;\n                \n                x_26795 = res_26797;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_27418)[sext_i32_i64(local_tid_27413)] =\n                    x_26795;\n            }\n        }\n        offset_27422 *= 2;\n    }\n    while (slt32(skip_waves_27423, squot32(sext_i64_i32(paths_20494) +\n                                        ",
                   "   wave_sizze_27415 - 1,\n                                           wave_sizze_27415))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_27422 = skip_waves_27423 * wave_sizze_27415;\n        if (slt32(local_tid_27413 + offset_27422, sext_i64_i32(paths_20494)) &&\n            ((local_tid_27413 - squot32(local_tid_27413, wave_sizze_27415) *\n              wave_sizze_27415) == 0 && (squot32(local_tid_27413,\n                                                 wave_sizze_27415) & (2 *\n                                                                      skip_waves_27423 -\n                                                                      1)) ==\n             0)) {\n            // read array element\n            {\n                x_26796 = ((__local\n                            float *) red_arr_mem_27418)[sext_i32_i64(local_tid_27413 +\n                                                        offset_27422)];\n            }\n            // apply reduction operation\n            {\n                float res_26797 = x_26795 + x_26796;\n                \n                x_26795 = res_26797;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_27418)[sext_i32_i64(local_tid_27413)] =\n                    x_26795;\n            }\n        }\n        skip_waves_27423 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    res_26794 = ((__local float *) red_arr_mem_27418)[0];\n    \n    float res_26899 = res_26794 / res_20707;\n    float negate_arg_26900 = 1.0e-2F * res_26793;\n    float exp_arg_26901 = 0.0F - negate_arg_26900;\n    float res_26902 = fpow32(2.7182817F, exp_arg_26901);\n    float x_26903 = 1.0F - res_26902;\n    float B_26904 = x_26903 / 1.0e-2F;\n    float x_26905 = B_26904 - res_26793;\n    float x_26906 = 4.4999997e-6F * x_26905;\n    float A1_26907 = x_26906 / 1.0e-4F;\n    float y_26908 = fpow32(B_26904, 2.0F);\n    float x_26909 = 1.0000001e-6F * y_26908;\n    float A2_26910 = x_26909 / 4.0e-2F;\n    float exp_ar",
                   "g_26911 = A1_26907 - A2_26910;\n    float res_26912 = fpow32(2.7182817F, exp_arg_26911);\n    float negate_arg_26913 = 5.0e-2F * B_26904;\n    float exp_arg_26914 = 0.0F - negate_arg_26913;\n    float res_26915 = fpow32(2.7182817F, exp_arg_26914);\n    float res_26916 = res_26912 * res_26915;\n    float res_26917 = res_26899 * res_26916;\n    \n    if (local_tid_27413 == 0) {\n        ((__global float *) mem_27239)[gtid_25925] = res_26917;\n    }\n    \n  error_2:\n    return;\n}\n__kernel void test2zisegred_large_26372(__global int *global_failure,\n                                        int failure_is_an_option, __global\n                                        int64_t *global_failure_args,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_27463_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *red_arr_mem_27461_backing_aligned_1,\n                                        int64_t paths_20494,\n                                        int64_t numswaps_20496,\n                                        float sims_per_year_20630,\n                                        int64_t num_groups_26928, __global\n                                        unsigned char *res_mem_27198, __global\n                                        unsigned char *res_mem_27199, __global\n                                        unsigned char *res_mem_27200, __global\n                                        unsigned char *res_mem_27201, __global\n                                        unsigned char *mem_27229, __global\n                                        unsigned char *mem_27242,\n                                        int64_t groups_per_segment_27447,\n                                        int64_t elements_per_thread_27448,\n                                        int64_t virt_num_groups_27449,\n                                        int64_t threads_per_segment_27451,\n        ",
                   "                                __global\n                                        unsigned char *group_res_arr_mem_27452,\n                                        __global\n                                        unsigned char *test2zicounter_mem_27454)\n{\n    #define segred_group_sizze_26927 (test2zisegred_group_sizze_26366)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_27463_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_27463_backing_aligned_0;\n    __local volatile char *restrict red_arr_mem_27461_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_27461_backing_aligned_1;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27456;\n    int32_t local_tid_27457;\n    int64_t group_sizze_27460;\n    int32_t wave_sizze_27459;\n    int32_t group_tid_27458;\n    \n    global_tid_27456 = get_global_id(0);\n    local_tid_27457 = get_local_id(0);\n    group_sizze_27460 = get_local_size(0);\n    wave_sizze_27459 = LOCKSTEP_WIDTH;\n    group_tid_27458 = get_group_id(0);\n    \n    int32_t phys_tid_26372;\n    \n    phys_tid_26372 = global_tid_27456;\n    \n    __local char *red_arr_mem_27461;\n    \n    red_arr_mem_27461 = (__local char *) red_arr_mem_27461_backing_0;\n    \n    __local char *sync_arr_mem_27463;\n    \n    sync_arr_mem_27463 = (__local char *) sync_arr_mem_27463_backing_1;\n    \n    int32_t phys_group_id_27465;\n    \n    phys_group_id_27465 = get_group_id(0);\n    for (int32_t i_27466 = 0; i_27466 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_27449) - phys_group_id_27465,\n                   sext_i64_i32(num_groups_26928)); i_27466++) {\n        int32_t virt_group_id_27467",
                   " = phys_group_id_27465 + i_27466 *\n                sext_i64_i32(num_groups_26928);\n        int32_t flat_segment_id_27468 = squot32(virt_group_id_27467,\n                                                sext_i64_i32(groups_per_segment_27447));\n        int64_t global_tid_27469 = srem64(sext_i32_i64(virt_group_id_27467) *\n                                          segred_group_sizze_26927 +\n                                          sext_i32_i64(local_tid_27457),\n                                          segred_group_sizze_26927 *\n                                          groups_per_segment_27447);\n        int64_t gtid_26363 = sext_i32_i64(flat_segment_id_27468);\n        int64_t gtid_26371;\n        float x_acc_27470;\n        int64_t chunk_sizze_27471;\n        \n        chunk_sizze_27471 = smin64(elements_per_thread_27448,\n                                   sdiv_up64(paths_20494 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_27469)),\n                                             threads_per_segment_27451));\n        \n        float x_26931;\n        float x_26932;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_27470 = 0.0F;\n        }\n        for (int64_t i_27475 = 0; i_27475 < chunk_sizze_27471; i_27475++) {\n            gtid_26371 = sext_i32_i64(sext_i64_i32(global_tid_27469)) +\n                threads_per_segment_27451 * i_27475;\n            // apply map function\n            {\n                float x_26936 = ((__global float *) mem_27229)[gtid_26363 *\n                                                               paths_20494 +\n                                                               gtid_26371];\n                int64_t convop_x_27112 = add64(1, gtid_26363);\n                float binop_x_27113 = sitofp_i64_f32(convop_x_27112);\n                float index_primexp_27114 = binop_x_27113 / sims_per_year_20630;\n                float res_26938;\n                float redout_27159 = 0.0F;\n                \n  ",
                   "              for (int64_t i_27160 = 0; i_27160 < numswaps_20496; i_27160++) {\n                    int64_t x_26944 = ((__global\n                                        int64_t *) res_mem_27200)[i_27160];\n                    float x_26945 = ((__global float *) res_mem_27201)[i_27160];\n                    int64_t i64_arg_26946 = sub64(x_26944, 1);\n                    float res_26947 = sitofp_i64_f32(i64_arg_26946);\n                    float y_26948 = x_26945 * res_26947;\n                    bool cond_26949 = y_26948 < index_primexp_27114;\n                    float ceil_arg_26950 = index_primexp_27114 / x_26945;\n                    float res_26951;\n                    \n                    res_26951 = futrts_ceil32(ceil_arg_26950);\n                    \n                    int64_t res_26952 = fptosi_f32_i64(res_26951);\n                    int64_t remaining_26953 = sub64(x_26944, res_26952);\n                    float res_26954;\n                    \n                    if (cond_26949) {\n                        res_26954 = 0.0F;\n                    } else {\n                        float x_26942 = ((__global\n                                          float *) res_mem_27198)[i_27160];\n                        float x_26943 = ((__global\n                                          float *) res_mem_27199)[i_27160];\n                        float nextpayment_26955 = x_26945 * res_26951;\n                        bool bounds_invalid_upwards_26956 =\n                             slt64(remaining_26953, 1);\n                        bool valid_26957 = !bounds_invalid_upwards_26956;\n                        bool range_valid_c_26958;\n                        \n                        if (!valid_26957) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 46) == -1) {\n                                    global_failure_args[0] = 1;\n                                    global_failur",
                   "e_args[1] = 2;\n                                    global_failure_args[2] = remaining_26953;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float y_26960 = nextpayment_26955 - index_primexp_27114;\n                        float negate_arg_26961 = 1.0e-2F * y_26960;\n                        float exp_arg_26962 = 0.0F - negate_arg_26961;\n                        float res_26963 = fpow32(2.7182817F, exp_arg_26962);\n                        float x_26964 = 1.0F - res_26963;\n                        float B_26965 = x_26964 / 1.0e-2F;\n                        float x_26966 = B_26965 - nextpayment_26955;\n                        float x_26967 = x_26966 + index_primexp_27114;\n                        float x_26968 = 4.4999997e-6F * x_26967;\n                        float A1_26969 = x_26968 / 1.0e-4F;\n                        float y_26970 = fpow32(B_26965, 2.0F);\n                        float x_26971 = 1.0000001e-6F * y_26970;\n                        float A2_26972 = x_26971 / 4.0e-2F;\n                        float exp_arg_26973 = A1_26969 - A2_26972;\n                        float res_26974 = fpow32(2.7182817F, exp_arg_26973);\n                        float negate_arg_26975 = x_26936 * B_26965;\n                        float exp_arg_26976 = 0.0F - negate_arg_26975;\n                        float res_26977 = fpow32(2.7182817F, exp_arg_26976);\n                        float res_26978 = res_26974 * res_26977;\n                        bool y_26979 = slt64(0, remaining_26953);\n                        bool index_certs_26980;\n                        \n                        if (!y_26979) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 47) == -1",
                   ") {\n                                    global_failure_args[0] = 0;\n                                    global_failure_args[1] = remaining_26953;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float binop_y_26981 = sitofp_i64_f32(remaining_26953);\n                        float binop_y_26982 = x_26945 * binop_y_26981;\n                        float index_primexp_26983 = nextpayment_26955 +\n                              binop_y_26982;\n                        float y_26984 = index_primexp_26983 -\n                              index_primexp_27114;\n                        float negate_arg_26985 = 1.0e-2F * y_26984;\n                        float exp_arg_26986 = 0.0F - negate_arg_26985;\n                        float res_26987 = fpow32(2.7182817F, exp_arg_26986);\n                        float x_26988 = 1.0F - res_26987;\n                        float B_26989 = x_26988 / 1.0e-2F;\n                        float x_26990 = B_26989 - index_primexp_26983;\n                        float x_26991 = x_26990 + index_primexp_27114;\n                        float x_26992 = 4.4999997e-6F * x_26991;\n                        float A1_26993 = x_26992 / 1.0e-4F;\n                        float y_26994 = fpow32(B_26989, 2.0F);\n                        float x_26995 = 1.0000001e-6F * y_26994;\n                        float A2_26996 = x_26995 / 4.0e-2F;\n                        float exp_arg_26997 = A1_26993 - A2_26996;\n                        float res_26998 = fpow32(2.7182817F, exp_arg_26997);\n                        float negate_arg_26999 = x_26936 * B_26989;\n                        float exp_arg_27000 = 0.0F - negate_arg_26999;\n                        float res_27001 = fpow32(2.7182817F, exp_arg_27000);\n                        float res_27002 = res_26998 * res_27001;\n        ",
                   "                float res_27003;\n                        float redout_27109 = 0.0F;\n                        \n                        for (int64_t i_27110 = 0; i_27110 < remaining_26953;\n                             i_27110++) {\n                            int64_t index_primexp_27130 = add64(1, i_27110);\n                            float res_27008 =\n                                  sitofp_i64_f32(index_primexp_27130);\n                            float res_27009 = x_26945 * res_27008;\n                            float res_27010 = nextpayment_26955 + res_27009;\n                            float y_27011 = res_27010 - index_primexp_27114;\n                            float negate_arg_27012 = 1.0e-2F * y_27011;\n                            float exp_arg_27013 = 0.0F - negate_arg_27012;\n                            float res_27014 = fpow32(2.7182817F, exp_arg_27013);\n                            float x_27015 = 1.0F - res_27014;\n                            float B_27016 = x_27015 / 1.0e-2F;\n                            float x_27017 = B_27016 - res_27010;\n                            float x_27018 = x_27017 + index_primexp_27114;\n                            float x_27019 = 4.4999997e-6F * x_27018;\n                            float A1_27020 = x_27019 / 1.0e-4F;\n                            float y_27021 = fpow32(B_27016, 2.0F);\n                            float x_27022 = 1.0000001e-6F * y_27021;\n                            float A2_27023 = x_27022 / 4.0e-2F;\n                            float exp_arg_27024 = A1_27020 - A2_27023;\n                            float res_27025 = fpow32(2.7182817F, exp_arg_27024);\n                            float negate_arg_27026 = x_26936 * B_27016;\n                            float exp_arg_27027 = 0.0F - negate_arg_27026;\n                            float res_27028 = fpow32(2.7182817F, exp_arg_27027);\n                            float res_27029 = res_27025 * res_27028;\n                            float res_27006 = res_27029 + redout_27109;\n          ",
                   "                  float redout_tmp_27477 = res_27006;\n                            \n                            redout_27109 = redout_tmp_27477;\n                        }\n                        res_27003 = redout_27109;\n                        \n                        float x_27030 = res_26978 - res_27002;\n                        float x_27031 = x_26942 * x_26945;\n                        float y_27032 = res_27003 * x_27031;\n                        float y_27033 = x_27030 - y_27032;\n                        float res_27034 = x_26943 * y_27033;\n                        float res_27035 = x_26943 * res_27034;\n                        \n                        res_26954 = res_27035;\n                    }\n                    \n                    float res_26941 = res_26954 + redout_27159;\n                    float redout_tmp_27476 = res_26941;\n                    \n                    redout_27159 = redout_tmp_27476;\n                }\n                res_26938 = redout_27159;\n                \n                float res_27036 = fmax32(0.0F, res_26938);\n                \n                // save map-out results\n                { }\n                // load accumulator\n                {\n                    x_26931 = x_acc_27470;\n                }\n                // load new values\n                {\n                    x_26932 = res_27036;\n                }\n                // apply reduction operator\n                {\n                    float res_26933 = x_26931 + x_26932;\n                    \n                    // store in accumulator\n                    {\n                        x_acc_27470 = res_26933;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_26931 = x_acc_27470;\n            ((__local\n              float *) red_arr_mem_27461)[sext_i32_i64(local_tid_27457)] =\n                x_26931;\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (l",
                   "ocal_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_27478;\n        int32_t skip_waves_27479;\n        \n        skip_waves_27479 = 1;\n        \n        float x_27472;\n        float x_27473;\n        \n        offset_27478 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_27457,\n                      sext_i64_i32(segred_group_sizze_26927))) {\n                x_27472 = ((__local\n                            float *) red_arr_mem_27461)[sext_i32_i64(local_tid_27457 +\n                                                        offset_27478)];\n            }\n        }\n        offset_27478 = 1;\n        while (slt32(offset_27478, wave_sizze_27459)) {\n            if (slt32(local_tid_27457 + offset_27478,\n                      sext_i64_i32(segred_group_sizze_26927)) &&\n                ((local_tid_27457 - squot32(local_tid_27457, wave_sizze_27459) *\n                  wave_sizze_27459) & (2 * offset_27478 - 1)) == 0) {\n                // read array element\n                {\n                    x_27473 = ((volatile __local\n                                float *) red_arr_mem_27461)[sext_i32_i64(local_tid_27457 +\n                                                            offset_27478)];\n                }\n                // apply reduction operation\n                {\n                    float res_27474 = x_27472 + x_27473;\n                    \n                    x_27472 = res_27474;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      float *) red_arr_mem_27461)[sext_i32_i64(local_tid_27457)] =\n                        x_27472;\n                }\n            }\n            offset_27478 *= 2;\n        }\n        while (slt32(skip_waves_27479,\n                     squot32(sext_i64_i32(segred_group_sizze_26927) +\n                             wave_sizze_27459 - 1, wave_sizze_27459))) {\n            barrier(",
                   "CLK_LOCAL_MEM_FENCE);\n            offset_27478 = skip_waves_27479 * wave_sizze_27459;\n            if (slt32(local_tid_27457 + offset_27478,\n                      sext_i64_i32(segred_group_sizze_26927)) &&\n                ((local_tid_27457 - squot32(local_tid_27457, wave_sizze_27459) *\n                  wave_sizze_27459) == 0 && (squot32(local_tid_27457,\n                                                     wave_sizze_27459) & (2 *\n                                                                          skip_waves_27479 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_27473 = ((__local\n                                float *) red_arr_mem_27461)[sext_i32_i64(local_tid_27457 +\n                                                            offset_27478)];\n                }\n                // apply reduction operation\n                {\n                    float res_27474 = x_27472 + x_27473;\n                    \n                    x_27472 = res_27474;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      float *) red_arr_mem_27461)[sext_i32_i64(local_tid_27457)] =\n                        x_27472;\n                }\n            }\n            skip_waves_27479 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_27457) == 0) {\n                x_acc_27470 = x_27472;\n            }\n        }\n        if (groups_per_segment_27447 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_27457 == 0) {\n                    ((__global float *) mem_27242)[gtid_26363] = x_acc_27470;\n                }\n            }\n        } else {\n            int32_t old_counter_27480;\n            \n            // first thread in gr",
                   "oup saves group result to global memory\n            {\n                if (local_tid_27457 == 0) {\n                    ((__global\n                      float *) group_res_arr_mem_27452)[sext_i32_i64(virt_group_id_27467) *\n                                                        segred_group_sizze_26927] =\n                        x_acc_27470;\n                    mem_fence_global();\n                    old_counter_27480 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) test2zicounter_mem_27454)[sext_i32_i64(srem32(flat_segment_id_27468,\n                                                                                                      10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_27463)[0] =\n                        old_counter_27480 == groups_per_segment_27447 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_27481;\n            \n            is_last_group_27481 = ((__local bool *) sync_arr_mem_27463)[0];\n            if (is_last_group_27481) {\n                if (local_tid_27457 == 0) {\n                    old_counter_27480 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) test2zicounter_mem_27454)[sext_i32_i64(srem32(flat_segment_id_27468,\n                                                                                                      10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_27447));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_27482 =\n                            sdiv_up64(groups_per_segment_27447,\n                                      segred_group_sizze_26927);\n            ",
                   "        \n                    x_26931 = 0.0F;\n                    for (int64_t i_27483 = 0; i_27483 < read_per_thread_27482;\n                         i_27483++) {\n                        int64_t group_res_id_27484 =\n                                sext_i32_i64(local_tid_27457) *\n                                read_per_thread_27482 + i_27483;\n                        int64_t index_of_group_res_27485 =\n                                sext_i32_i64(flat_segment_id_27468) *\n                                groups_per_segment_27447 + group_res_id_27484;\n                        \n                        if (slt64(group_res_id_27484,\n                                  groups_per_segment_27447)) {\n                            x_26932 = ((__global\n                                        float *) group_res_arr_mem_27452)[index_of_group_res_27485 *\n                                                                          segred_group_sizze_26927];\n                            \n                            float res_26933;\n                            \n                            res_26933 = x_26931 + x_26932;\n                            x_26931 = res_26933;\n                        }\n                    }\n                }\n                ((__local\n                  float *) red_arr_mem_27461)[sext_i32_i64(local_tid_27457)] =\n                    x_26931;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_27486;\n                    int32_t skip_waves_27487;\n                    \n                    skip_waves_27487 = 1;\n                    \n                    float x_27472;\n                    float x_27473;\n                    \n                    offset_27486 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_27457,\n                                  sext_i64_i32(segred_group_sizze_26927))) {\n           ",
                   "                 x_27472 = ((__local\n                                        float *) red_arr_mem_27461)[sext_i32_i64(local_tid_27457 +\n                                                                    offset_27486)];\n                        }\n                    }\n                    offset_27486 = 1;\n                    while (slt32(offset_27486, wave_sizze_27459)) {\n                        if (slt32(local_tid_27457 + offset_27486,\n                                  sext_i64_i32(segred_group_sizze_26927)) &&\n                            ((local_tid_27457 - squot32(local_tid_27457,\n                                                        wave_sizze_27459) *\n                              wave_sizze_27459) & (2 * offset_27486 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_27473 = ((volatile __local\n                                            float *) red_arr_mem_27461)[sext_i32_i64(local_tid_27457 +\n                                                                        offset_27486)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_27474 = x_27472 + x_27473;\n                                \n                                x_27472 = res_27474;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_27461)[sext_i32_i64(local_tid_27457)] =\n                                    x_27472;\n                            }\n                        }\n                        offset_27486 *= 2;\n                    }\n                    while (slt32(skip_waves_27487,\n                                 squot32(sext_i64_i32(segred_group_sizze_26927) +\n                                         wave_sizze_27459 ",
                   "- 1,\n                                         wave_sizze_27459))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_27486 = skip_waves_27487 * wave_sizze_27459;\n                        if (slt32(local_tid_27457 + offset_27486,\n                                  sext_i64_i32(segred_group_sizze_26927)) &&\n                            ((local_tid_27457 - squot32(local_tid_27457,\n                                                        wave_sizze_27459) *\n                              wave_sizze_27459) == 0 &&\n                             (squot32(local_tid_27457, wave_sizze_27459) & (2 *\n                                                                            skip_waves_27487 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_27473 = ((__local\n                                            float *) red_arr_mem_27461)[sext_i32_i64(local_tid_27457 +\n                                                                        offset_27486)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_27474 = x_27472 + x_27473;\n                                \n                                x_27472 = res_27474;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  float *) red_arr_mem_27461)[sext_i32_i64(local_tid_27457)] =\n                                    x_27472;\n                            }\n                        }\n                        skip_waves_27487 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_27457 == 0) {\n    ",
                   "                        ((__global float *) mem_27242)[gtid_26363] =\n                                x_27472;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_26927\n}\n__kernel void test2zisegred_nonseg_25032(__global int *global_failure,\n                                         __local volatile\n                                         int64_t *red_arr_mem_27315_backing_aligned_0,\n                                         __local volatile\n                                         int64_t *sync_arr_mem_27313_backing_aligned_1,\n                                         int64_t numswaps_20496,\n                                         float res_20514,\n                                         int64_t num_groups_25024, __global\n                                         unsigned char *mem_27173, __global\n                                         unsigned char *mem_27175, __global\n                                         unsigned char *mem_27177, __global\n                                         unsigned char *mem_27179, __global\n                                         unsigned char *test2zicounter_mem_27303,\n                                         __global\n                                         unsigned char *group_res_arr_mem_27305,\n                                         int64_t num_threads_27307)\n{\n    #define segred_group_sizze_25022 (test2zisegred_group_sizze_25021)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27315_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_27315_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_27313_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_27313_backin",
                   "g_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27308;\n    int32_t local_tid_27309;\n    int64_t group_sizze_27312;\n    int32_t wave_sizze_27311;\n    int32_t group_tid_27310;\n    \n    global_tid_27308 = get_global_id(0);\n    local_tid_27309 = get_local_id(0);\n    group_sizze_27312 = get_local_size(0);\n    wave_sizze_27311 = LOCKSTEP_WIDTH;\n    group_tid_27310 = get_group_id(0);\n    \n    int32_t phys_tid_25032;\n    \n    phys_tid_25032 = global_tid_27308;\n    \n    __local char *sync_arr_mem_27313;\n    \n    sync_arr_mem_27313 = (__local char *) sync_arr_mem_27313_backing_0;\n    \n    __local char *red_arr_mem_27315;\n    \n    red_arr_mem_27315 = (__local char *) red_arr_mem_27315_backing_1;\n    \n    int64_t dummy_25030;\n    \n    dummy_25030 = 0;\n    \n    int64_t gtid_25031;\n    \n    gtid_25031 = 0;\n    \n    float x_acc_27317;\n    int64_t chunk_sizze_27318;\n    \n    chunk_sizze_27318 = smin64(sdiv_up64(numswaps_20496,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_25022 *\n                                         num_groups_25024))),\n                               sdiv_up64(numswaps_20496 -\n                                         sext_i32_i64(phys_tid_25032),\n                                         num_threads_27307));\n    \n    float x_20530;\n    float x_20531;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_27317 = -INFINITY;\n    }\n    for (int64_t i_27322 = 0; i_27322 < chunk_sizze_27318; i_27322++) {\n        gtid_25031 = sext_i32_i64(phys_tid_25032) + num_threads_27307 * i_27322;\n        // apply map function\n        {\n            int32_t res_20534 = sext_i64_i32(gtid_25031);\n            int32_t x_20535 = lshr32(res_20534, 16);\n            int32_t x_20536 = res_20534 ^ x_20535;\n            int32_t x_20537 = mul32(73244475, x_20536);\n            int32_t x_20538 = lshr32(x_20537, 16);\n            int32_t x_20539 = x_20537 ^ x_20538;\n            int32_t x_20540 = mul32(7",
                   "3244475, x_20539);\n            int32_t x_20541 = lshr32(x_20540, 16);\n            int32_t x_20542 = x_20540 ^ x_20541;\n            int32_t unsign_arg_20543 = 281253711 ^ x_20542;\n            int32_t unsign_arg_20544 = mul32(48271, unsign_arg_20543);\n            int32_t unsign_arg_20545 = umod32(unsign_arg_20544, 2147483647);\n            float res_20546 = uitofp_i32_f32(unsign_arg_20545);\n            float res_20547 = res_20546 / 2.1474836e9F;\n            float res_20548 = 2.0F * res_20547;\n            float res_20549 = res_20514 * res_20547;\n            float res_20550 = 1.0F + res_20549;\n            int64_t res_20551 = fptosi_f32_i64(res_20550);\n            float res_20557 = -1.0F + res_20548;\n            float res_20558 = sitofp_i64_f32(res_20551);\n            float res_20559 = res_20548 * res_20558;\n            \n            // save map-out results\n            {\n                ((__global float *) mem_27175)[dummy_25030 * numswaps_20496 +\n                                               gtid_25031] = res_20557;\n                ((__global int64_t *) mem_27177)[dummy_25030 * numswaps_20496 +\n                                                 gtid_25031] = res_20551;\n                ((__global float *) mem_27179)[dummy_25030 * numswaps_20496 +\n                                               gtid_25031] = res_20548;\n            }\n            // load accumulator\n            {\n                x_20530 = x_acc_27317;\n            }\n            // load new values\n            {\n                x_20531 = res_20559;\n            }\n            // apply reduction operator\n            {\n                float res_20532 = fmax32(x_20530, x_20531);\n                \n                // store in accumulator\n                {\n                    x_acc_27317 = res_20532;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_20530 = x_acc_27317;\n        ((__local float *) red_arr_mem_27315)[sext_i32_i64(local_tid_27309)]",
                   " =\n            x_20530;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_27323;\n    int32_t skip_waves_27324;\n    \n    skip_waves_27324 = 1;\n    \n    float x_27319;\n    float x_27320;\n    \n    offset_27323 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_27309, sext_i64_i32(segred_group_sizze_25022))) {\n            x_27319 = ((__local\n                        float *) red_arr_mem_27315)[sext_i32_i64(local_tid_27309 +\n                                                    offset_27323)];\n        }\n    }\n    offset_27323 = 1;\n    while (slt32(offset_27323, wave_sizze_27311)) {\n        if (slt32(local_tid_27309 + offset_27323,\n                  sext_i64_i32(segred_group_sizze_25022)) && ((local_tid_27309 -\n                                                               squot32(local_tid_27309,\n                                                                       wave_sizze_27311) *\n                                                               wave_sizze_27311) &\n                                                              (2 *\n                                                               offset_27323 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_27320 = ((volatile __local\n                            float *) red_arr_mem_27315)[sext_i32_i64(local_tid_27309 +\n                                                        offset_27323)];\n            }\n            // apply reduction operation\n            {\n                float res_27321 = fmax32(x_27319, x_27320);\n                \n                x_27319 = res_27321;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_27315)[sext_i32_i64(local_tid_27309)] =\n                    x_27319;\n            }\n        }\n        offset_27323 *= 2;\n    }\n    while (slt32(skip_waves_27324,\n           ",
                   "      squot32(sext_i64_i32(segred_group_sizze_25022) +\n                         wave_sizze_27311 - 1, wave_sizze_27311))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_27323 = skip_waves_27324 * wave_sizze_27311;\n        if (slt32(local_tid_27309 + offset_27323,\n                  sext_i64_i32(segred_group_sizze_25022)) && ((local_tid_27309 -\n                                                               squot32(local_tid_27309,\n                                                                       wave_sizze_27311) *\n                                                               wave_sizze_27311) ==\n                                                              0 &&\n                                                              (squot32(local_tid_27309,\n                                                                       wave_sizze_27311) &\n                                                               (2 *\n                                                                skip_waves_27324 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_27320 = ((__local\n                            float *) red_arr_mem_27315)[sext_i32_i64(local_tid_27309 +\n                                                        offset_27323)];\n            }\n            // apply reduction operation\n            {\n                float res_27321 = fmax32(x_27319, x_27320);\n                \n                x_27319 = res_27321;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_27315)[sext_i32_i64(local_tid_27309)] =\n                    x_27319;\n            }\n        }\n        skip_waves_27324 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_27309) == 0) {\n            x_acc_27317 = x_27319;\n        }\n    }\n    \n    int32_t old_counte",
                   "r_27325;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_27309 == 0) {\n            ((__global\n              float *) group_res_arr_mem_27305)[sext_i32_i64(group_tid_27310) *\n                                                segred_group_sizze_25022] =\n                x_acc_27317;\n            mem_fence_global();\n            old_counter_27325 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test2zicounter_mem_27303)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_27313)[0] = old_counter_27325 ==\n                num_groups_25024 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_27326;\n    \n    is_last_group_27326 = ((__local bool *) sync_arr_mem_27313)[0];\n    if (is_last_group_27326) {\n        if (local_tid_27309 == 0) {\n            old_counter_27325 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test2zicounter_mem_27303)[0],\n                                                      (int) (0 -\n                                                             num_groups_25024));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_27327 = sdiv_up64(num_groups_25024,\n                                                      segred_group_sizze_25022);\n            \n            x_20530 = -INFINITY;\n            for (int64_t i_27328 = 0; i_27328 < read_per_thread_27327;\n                 i_27328++) {\n                int64_t group_res_id_27329 = sext_i32_i64(local_tid_27309) *\n                        read_per_thread_27327 + i_27328;\n                int64_t index_of_group_res_27330 = group_res_id_27329;\n                \n                if (slt64(group_res_id_27329, num_groups_25024)) {\n                    x_20531 = ((__global\n                                float ",
                   "*) group_res_arr_mem_27305)[index_of_group_res_27330 *\n                                                                  segred_group_sizze_25022];\n                    \n                    float res_20532;\n                    \n                    res_20532 = fmax32(x_20530, x_20531);\n                    x_20530 = res_20532;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_27315)[sext_i32_i64(local_tid_27309)] =\n            x_20530;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_27331;\n            int32_t skip_waves_27332;\n            \n            skip_waves_27332 = 1;\n            \n            float x_27319;\n            float x_27320;\n            \n            offset_27331 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_27309,\n                          sext_i64_i32(segred_group_sizze_25022))) {\n                    x_27319 = ((__local\n                                float *) red_arr_mem_27315)[sext_i32_i64(local_tid_27309 +\n                                                            offset_27331)];\n                }\n            }\n            offset_27331 = 1;\n            while (slt32(offset_27331, wave_sizze_27311)) {\n                if (slt32(local_tid_27309 + offset_27331,\n                          sext_i64_i32(segred_group_sizze_25022)) &&\n                    ((local_tid_27309 - squot32(local_tid_27309,\n                                                wave_sizze_27311) *\n                      wave_sizze_27311) & (2 * offset_27331 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_27320 = ((volatile __local\n                                    float *) red_arr_mem_27315)[sext_i32_i64(local_tid_27309 +\n                                                                offset_27331)];\n                    }\n                    // apply reduction operation\n ",
                   "                   {\n                        float res_27321 = fmax32(x_27319, x_27320);\n                        \n                        x_27319 = res_27321;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_27315)[sext_i32_i64(local_tid_27309)] =\n                            x_27319;\n                    }\n                }\n                offset_27331 *= 2;\n            }\n            while (slt32(skip_waves_27332,\n                         squot32(sext_i64_i32(segred_group_sizze_25022) +\n                                 wave_sizze_27311 - 1, wave_sizze_27311))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_27331 = skip_waves_27332 * wave_sizze_27311;\n                if (slt32(local_tid_27309 + offset_27331,\n                          sext_i64_i32(segred_group_sizze_25022)) &&\n                    ((local_tid_27309 - squot32(local_tid_27309,\n                                                wave_sizze_27311) *\n                      wave_sizze_27311) == 0 && (squot32(local_tid_27309,\n                                                         wave_sizze_27311) &\n                                                 (2 * skip_waves_27332 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_27320 = ((__local\n                                    float *) red_arr_mem_27315)[sext_i32_i64(local_tid_27309 +\n                                                                offset_27331)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27321 = fmax32(x_27319, x_27320);\n                        \n                        x_27319 = res_27321;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                         ",
                   " float *) red_arr_mem_27315)[sext_i32_i64(local_tid_27309)] =\n                            x_27319;\n                    }\n                }\n                skip_waves_27332 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_27309 == 0) {\n                    ((__global float *) mem_27173)[0] = x_27319;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_25022\n}\n__kernel void test2zisegred_nonseg_25782(__global int *global_failure,\n                                         int failure_is_an_option, __global\n                                         int64_t *global_failure_args,\n                                         __local volatile\n                                         int64_t *red_arr_mem_27383_backing_aligned_0,\n                                         __local volatile\n                                         int64_t *sync_arr_mem_27381_backing_aligned_1,\n                                         int64_t paths_20494,\n                                         int64_t steps_20495,\n                                         int64_t numswaps_20496,\n                                         float sims_per_year_20630,\n                                         float res_20707,\n                                         int64_t num_groups_25785, __global\n                                         unsigned char *res_mem_27198, __global\n                                         unsigned char *res_mem_27199, __global\n                                         unsigned char *res_mem_27200, __global\n                                         unsigned char *res_mem_27201, __global\n                                         unsigned char *mem_27229, __global\n                                         unsigned char *mem_27232, __global\n                                         unsigned char *test2zicounter_mem_27371,\n                                         __global\n           ",
                   "                              unsigned char *group_res_arr_mem_27373,\n                                         int64_t num_threads_27375)\n{\n    #define segred_group_sizze_25784 (test2zisegred_group_sizze_25774)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27383_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_27383_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_27381_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_27381_backing_aligned_1;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27376;\n    int32_t local_tid_27377;\n    int64_t group_sizze_27380;\n    int32_t wave_sizze_27379;\n    int32_t group_tid_27378;\n    \n    global_tid_27376 = get_global_id(0);\n    local_tid_27377 = get_local_id(0);\n    group_sizze_27380 = get_local_size(0);\n    wave_sizze_27379 = LOCKSTEP_WIDTH;\n    group_tid_27378 = get_group_id(0);\n    \n    int32_t phys_tid_25782;\n    \n    phys_tid_25782 = global_tid_27376;\n    \n    __local char *sync_arr_mem_27381;\n    \n    sync_arr_mem_27381 = (__local char *) sync_arr_mem_27381_backing_0;\n    \n    __local char *red_arr_mem_27383;\n    \n    red_arr_mem_27383 = (__local char *) red_arr_mem_27383_backing_1;\n    \n    int64_t dummy_25780;\n    \n    dummy_25780 = 0;\n    \n    int64_t gtid_25781;\n    \n    gtid_25781 = 0;\n    \n    float x_acc_27385;\n    int64_t chunk_sizze_27386;\n    \n    chunk_sizze_27386 = smin64(sdiv_up64(steps_20495,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_25784 *\n                                         num_groups_25785))),\n                               sd",
                   "iv_up64(steps_20495 -\n                                         sext_i32_i64(phys_tid_25782),\n                                         num_threads_27375));\n    \n    float x_25788;\n    float x_25789;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_27385 = 0.0F;\n    }\n    for (int64_t i_27390 = 0; i_27390 < chunk_sizze_27386; i_27390++) {\n        gtid_25781 = sext_i32_i64(phys_tid_25782) + num_threads_27375 * i_27390;\n        // apply map function\n        {\n            int64_t index_primexp_27094 = add64(1, gtid_25781);\n            float res_25794 = sitofp_i64_f32(index_primexp_27094);\n            float res_25795 = res_25794 / sims_per_year_20630;\n            float res_25796;\n            float redout_27149 = 0.0F;\n            \n            for (int64_t i_27150 = 0; i_27150 < paths_20494; i_27150++) {\n                float x_25800 = ((__global float *) mem_27229)[gtid_25781 *\n                                                               paths_20494 +\n                                                               i_27150];\n                float res_25802;\n                float redout_27151 = 0.0F;\n                \n                for (int64_t i_27152 = 0; i_27152 < numswaps_20496; i_27152++) {\n                    int64_t x_25808 = ((__global\n                                        int64_t *) res_mem_27200)[i_27152];\n                    float x_25809 = ((__global float *) res_mem_27201)[i_27152];\n                    int64_t i64_arg_25810 = sub64(x_25808, 1);\n                    float res_25811 = sitofp_i64_f32(i64_arg_25810);\n                    float y_25812 = x_25809 * res_25811;\n                    bool cond_25813 = y_25812 < res_25795;\n                    float ceil_arg_25814 = res_25795 / x_25809;\n                    float res_25815;\n                    \n                    res_25815 = futrts_ceil32(ceil_arg_25814);\n                    \n                    int64_t res_25816 = fptosi_f32_i64(res_25815);\n                    int64_t remaining_25817 =",
                   " sub64(x_25808, res_25816);\n                    float res_25818;\n                    \n                    if (cond_25813) {\n                        res_25818 = 0.0F;\n                    } else {\n                        float x_25806 = ((__global\n                                          float *) res_mem_27198)[i_27152];\n                        float x_25807 = ((__global\n                                          float *) res_mem_27199)[i_27152];\n                        float nextpayment_25819 = x_25809 * res_25815;\n                        bool bounds_invalid_upwards_25820 =\n                             slt64(remaining_25817, 1);\n                        bool valid_25821 = !bounds_invalid_upwards_25820;\n                        bool range_valid_c_25822;\n                        \n                        if (!valid_25821) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 38) == -1) {\n                                    global_failure_args[0] = 1;\n                                    global_failure_args[1] = 2;\n                                    global_failure_args[2] = remaining_25817;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float y_25824 = nextpayment_25819 - res_25795;\n                        float negate_arg_25825 = 1.0e-2F * y_25824;\n                        float exp_arg_25826 = 0.0F - negate_arg_25825;\n                        float res_25827 = fpow32(2.7182817F, exp_arg_25826);\n                        float x_25828 = 1.0F - res_25827;\n                        float B_25829 = x_25828 / 1.0e-2F;\n                        float x_25830 = B_25829 - nextpayment_25819;\n                        float x_25831 = res_25795 + ",
                   "x_25830;\n                        float x_25832 = 4.4999997e-6F * x_25831;\n                        float A1_25833 = x_25832 / 1.0e-4F;\n                        float y_25834 = fpow32(B_25829, 2.0F);\n                        float x_25835 = 1.0000001e-6F * y_25834;\n                        float A2_25836 = x_25835 / 4.0e-2F;\n                        float exp_arg_25837 = A1_25833 - A2_25836;\n                        float res_25838 = fpow32(2.7182817F, exp_arg_25837);\n                        float negate_arg_25839 = x_25800 * B_25829;\n                        float exp_arg_25840 = 0.0F - negate_arg_25839;\n                        float res_25841 = fpow32(2.7182817F, exp_arg_25840);\n                        float res_25842 = res_25838 * res_25841;\n                        bool y_25843 = slt64(0, remaining_25817);\n                        bool index_certs_25844;\n                        \n                        if (!y_25843) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 39) == -1) {\n                                    global_failure_args[0] = 0;\n                                    global_failure_args[1] = remaining_25817;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float binop_y_25845 = sitofp_i64_f32(remaining_25817);\n                        float binop_y_25846 = x_25809 * binop_y_25845;\n                        float index_primexp_25847 = nextpayment_25819 +\n                              binop_y_25846;\n                        float y_25848 = index_primexp_25847 - res_25795;\n                        float negate_arg_25849 = 1.0e-2F * y_25848;\n                        float exp_arg_25850 = 0.0F - negate_arg_25849;\n             ",
                   "           float res_25851 = fpow32(2.7182817F, exp_arg_25850);\n                        float x_25852 = 1.0F - res_25851;\n                        float B_25853 = x_25852 / 1.0e-2F;\n                        float x_25854 = B_25853 - index_primexp_25847;\n                        float x_25855 = res_25795 + x_25854;\n                        float x_25856 = 4.4999997e-6F * x_25855;\n                        float A1_25857 = x_25856 / 1.0e-4F;\n                        float y_25858 = fpow32(B_25853, 2.0F);\n                        float x_25859 = 1.0000001e-6F * y_25858;\n                        float A2_25860 = x_25859 / 4.0e-2F;\n                        float exp_arg_25861 = A1_25857 - A2_25860;\n                        float res_25862 = fpow32(2.7182817F, exp_arg_25861);\n                        float negate_arg_25863 = x_25800 * B_25853;\n                        float exp_arg_25864 = 0.0F - negate_arg_25863;\n                        float res_25865 = fpow32(2.7182817F, exp_arg_25864);\n                        float res_25866 = res_25862 * res_25865;\n                        float res_25867;\n                        float redout_27091 = 0.0F;\n                        \n                        for (int64_t i_27092 = 0; i_27092 < remaining_25817;\n                             i_27092++) {\n                            int64_t index_primexp_27124 = add64(1, i_27092);\n                            float res_25872 =\n                                  sitofp_i64_f32(index_primexp_27124);\n                            float res_25873 = x_25809 * res_25872;\n                            float res_25874 = nextpayment_25819 + res_25873;\n                            float y_25875 = res_25874 - res_25795;\n                            float negate_arg_25876 = 1.0e-2F * y_25875;\n                            float exp_arg_25877 = 0.0F - negate_arg_25876;\n                            float res_25878 = fpow32(2.7182817F, exp_arg_25877);\n                            float x_25879 = 1.0F - res_25878;\n                  ",
                   "          float B_25880 = x_25879 / 1.0e-2F;\n                            float x_25881 = B_25880 - res_25874;\n                            float x_25882 = res_25795 + x_25881;\n                            float x_25883 = 4.4999997e-6F * x_25882;\n                            float A1_25884 = x_25883 / 1.0e-4F;\n                            float y_25885 = fpow32(B_25880, 2.0F);\n                            float x_25886 = 1.0000001e-6F * y_25885;\n                            float A2_25887 = x_25886 / 4.0e-2F;\n                            float exp_arg_25888 = A1_25884 - A2_25887;\n                            float res_25889 = fpow32(2.7182817F, exp_arg_25888);\n                            float negate_arg_25890 = x_25800 * B_25880;\n                            float exp_arg_25891 = 0.0F - negate_arg_25890;\n                            float res_25892 = fpow32(2.7182817F, exp_arg_25891);\n                            float res_25893 = res_25889 * res_25892;\n                            float res_25870 = res_25893 + redout_27091;\n                            float redout_tmp_27393 = res_25870;\n                            \n                            redout_27091 = redout_tmp_27393;\n                        }\n                        res_25867 = redout_27091;\n                        \n                        float x_25894 = res_25842 - res_25866;\n                        float x_25895 = x_25806 * x_25809;\n                        float y_25896 = res_25867 * x_25895;\n                        float y_25897 = x_25894 - y_25896;\n                        float res_25898 = x_25807 * y_25897;\n                        float res_25899 = x_25807 * res_25898;\n                        \n                        res_25818 = res_25899;\n                    }\n                    \n                    float res_25805 = res_25818 + redout_27151;\n                    float redout_tmp_27392 = res_25805;\n                    \n                    redout_27151 = redout_tmp_27392;\n                }\n                res_258",
                   "02 = redout_27151;\n                \n                float res_25900 = fmax32(0.0F, res_25802);\n                float res_25799 = res_25900 + redout_27149;\n                float redout_tmp_27391 = res_25799;\n                \n                redout_27149 = redout_tmp_27391;\n            }\n            res_25796 = redout_27149;\n            \n            float res_25901 = res_25796 / res_20707;\n            float negate_arg_25902 = 1.0e-2F * res_25795;\n            float exp_arg_25903 = 0.0F - negate_arg_25902;\n            float res_25904 = fpow32(2.7182817F, exp_arg_25903);\n            float x_25905 = 1.0F - res_25904;\n            float B_25906 = x_25905 / 1.0e-2F;\n            float x_25907 = B_25906 - res_25795;\n            float x_25908 = 4.4999997e-6F * x_25907;\n            float A1_25909 = x_25908 / 1.0e-4F;\n            float y_25910 = fpow32(B_25906, 2.0F);\n            float x_25911 = 1.0000001e-6F * y_25910;\n            float A2_25912 = x_25911 / 4.0e-2F;\n            float exp_arg_25913 = A1_25909 - A2_25912;\n            float res_25914 = fpow32(2.7182817F, exp_arg_25913);\n            float negate_arg_25915 = 5.0e-2F * B_25906;\n            float exp_arg_25916 = 0.0F - negate_arg_25915;\n            float res_25917 = fpow32(2.7182817F, exp_arg_25916);\n            float res_25918 = res_25914 * res_25917;\n            float res_25919 = res_25901 * res_25918;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_25788 = x_acc_27385;\n            }\n            // load new values\n            {\n                x_25789 = res_25919;\n            }\n            // apply reduction operator\n            {\n                float res_25790 = x_25788 + x_25789;\n                \n                // store in accumulator\n                {\n                    x_acc_27385 = res_25790;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_25788 = x_",
                   "acc_27385;\n        ((__local float *) red_arr_mem_27383)[sext_i32_i64(local_tid_27377)] =\n            x_25788;\n    }\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_27394;\n    int32_t skip_waves_27395;\n    \n    skip_waves_27395 = 1;\n    \n    float x_27387;\n    float x_27388;\n    \n    offset_27394 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_27377, sext_i64_i32(segred_group_sizze_25784))) {\n            x_27387 = ((__local\n                        float *) red_arr_mem_27383)[sext_i32_i64(local_tid_27377 +\n                                                    offset_27394)];\n        }\n    }\n    offset_27394 = 1;\n    while (slt32(offset_27394, wave_sizze_27379)) {\n        if (slt32(local_tid_27377 + offset_27394,\n                  sext_i64_i32(segred_group_sizze_25784)) && ((local_tid_27377 -\n                                                               squot32(local_tid_27377,\n                                                                       wave_sizze_27379) *\n                                                               wave_sizze_27379) &\n                                                              (2 *\n                                                               offset_27394 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_27388 = ((volatile __local\n                            float *) red_arr_mem_27383)[sext_i32_i64(local_tid_27377 +\n                                                        offset_27394)];\n            }\n            // apply reduction operation\n            {\n                float res_27389 = x_27387 + x_27388;\n                \n                x_27387 = res_27389;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_273",
                   "83)[sext_i32_i64(local_tid_27377)] =\n                    x_27387;\n            }\n        }\n        offset_27394 *= 2;\n    }\n    while (slt32(skip_waves_27395,\n                 squot32(sext_i64_i32(segred_group_sizze_25784) +\n                         wave_sizze_27379 - 1, wave_sizze_27379))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_27394 = skip_waves_27395 * wave_sizze_27379;\n        if (slt32(local_tid_27377 + offset_27394,\n                  sext_i64_i32(segred_group_sizze_25784)) && ((local_tid_27377 -\n                                                               squot32(local_tid_27377,\n                                                                       wave_sizze_27379) *\n                                                               wave_sizze_27379) ==\n                                                              0 &&\n                                                              (squot32(local_tid_27377,\n                                                                       wave_sizze_27379) &\n                                                               (2 *\n                                                                skip_waves_27395 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_27388 = ((__local\n                            float *) red_arr_mem_27383)[sext_i32_i64(local_tid_27377 +\n                                                        offset_27394)];\n            }\n            // apply reduction operation\n            {\n                float res_27389 = x_27387 + x_27388;\n                \n                x_27387 = res_27389;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_27383)[sext_i32_i64(local_tid_27377)] =\n                    x_27387;\n            }\n        }\n        skip_waves_27395 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread save",
                   "s the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_27377) == 0) {\n            x_acc_27385 = x_27387;\n        }\n    }\n    \n    int32_t old_counter_27396;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_27377 == 0) {\n            ((__global\n              float *) group_res_arr_mem_27373)[sext_i32_i64(group_tid_27378) *\n                                                segred_group_sizze_25784] =\n                x_acc_27385;\n            mem_fence_global();\n            old_counter_27396 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test2zicounter_mem_27371)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_27381)[0] = old_counter_27396 ==\n                num_groups_25785 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_27397;\n    \n    is_last_group_27397 = ((__local bool *) sync_arr_mem_27381)[0];\n    if (is_last_group_27397) {\n        if (local_tid_27377 == 0) {\n            old_counter_27396 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test2zicounter_mem_27371)[0],\n                                                      (int) (0 -\n                                                             num_groups_25785));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_27398 = sdiv_up64(num_groups_25785,\n                                                      segred_group_sizze_25784);\n            \n            x_25788 = 0.0F;\n            for (int64_t i_27399 = 0; i_27399 < read_per_thread_27398;\n                 i_27399++) {\n                int64_t group_res_id_27400 = sext_i32_i64(local_tid_27377) *\n                        read_per_thread_27398 + i_27399;\n                int64_t index_of_group_res_27401 = group_res_id_27400;\n      ",
                   "          \n                if (slt64(group_res_id_27400, num_groups_25785)) {\n                    x_25789 = ((__global\n                                float *) group_res_arr_mem_27373)[index_of_group_res_27401 *\n                                                                  segred_group_sizze_25784];\n                    \n                    float res_25790;\n                    \n                    res_25790 = x_25788 + x_25789;\n                    x_25788 = res_25790;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_27383)[sext_i32_i64(local_tid_27377)] =\n            x_25788;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_27402;\n            int32_t skip_waves_27403;\n            \n            skip_waves_27403 = 1;\n            \n            float x_27387;\n            float x_27388;\n            \n            offset_27402 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_27377,\n                          sext_i64_i32(segred_group_sizze_25784))) {\n                    x_27387 = ((__local\n                                float *) red_arr_mem_27383)[sext_i32_i64(local_tid_27377 +\n                                                            offset_27402)];\n                }\n            }\n            offset_27402 = 1;\n            while (slt32(offset_27402, wave_sizze_27379)) {\n                if (slt32(local_tid_27377 + offset_27402,\n                          sext_i64_i32(segred_group_sizze_25784)) &&\n                    ((local_tid_27377 - squot32(local_tid_27377,\n                                                wave_sizze_27379) *\n                      wave_sizze_27379) & (2 * offset_27402 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_27388 = ((volatile __local\n                                    float *) red_arr_mem_27383)[sext_i32_i64(local_tid_27377 +\n  ",
                   "                                                              offset_27402)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27389 = x_27387 + x_27388;\n                        \n                        x_27387 = res_27389;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_27383)[sext_i32_i64(local_tid_27377)] =\n                            x_27387;\n                    }\n                }\n                offset_27402 *= 2;\n            }\n            while (slt32(skip_waves_27403,\n                         squot32(sext_i64_i32(segred_group_sizze_25784) +\n                                 wave_sizze_27379 - 1, wave_sizze_27379))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_27402 = skip_waves_27403 * wave_sizze_27379;\n                if (slt32(local_tid_27377 + offset_27402,\n                          sext_i64_i32(segred_group_sizze_25784)) &&\n                    ((local_tid_27377 - squot32(local_tid_27377,\n                                                wave_sizze_27379) *\n                      wave_sizze_27379) == 0 && (squot32(local_tid_27377,\n                                                         wave_sizze_27379) &\n                                                 (2 * skip_waves_27403 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_27388 = ((__local\n                                    float *) red_arr_mem_27383)[sext_i32_i64(local_tid_27377 +\n                                                                offset_27402)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27389 = x_27387 + x_27388;\n                        \n                        x_27387 = res_27389;\n                ",
                   "    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_27383)[sext_i32_i64(local_tid_27377)] =\n                            x_27387;\n                    }\n                }\n                skip_waves_27403 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_27377 == 0) {\n                    ((__global float *) mem_27232)[0] = x_27387;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_25784\n}\n__kernel void test2zisegred_nonseg_26643(__global int *global_failure,\n                                         __local volatile\n                                         int64_t *red_arr_mem_27507_backing_aligned_0,\n                                         __local volatile\n                                         int64_t *sync_arr_mem_27505_backing_aligned_1,\n                                         int64_t steps_20495,\n                                         int64_t num_groups_27065, __global\n                                         unsigned char *res_map_acc_mem_27247,\n                                         __global unsigned char *mem_27250,\n                                         __global\n                                         unsigned char *test2zicounter_mem_27495,\n                                         __global\n                                         unsigned char *group_res_arr_mem_27497,\n                                         int64_t num_threads_27499)\n{\n    #define segred_group_sizze_27064 (test2zisegred_group_sizze_26635)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27507_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_27507_backing_aligned_0;\n    __local volatile char *restrict sync_ar",
                   "r_mem_27505_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_27505_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_27500;\n    int32_t local_tid_27501;\n    int64_t group_sizze_27504;\n    int32_t wave_sizze_27503;\n    int32_t group_tid_27502;\n    \n    global_tid_27500 = get_global_id(0);\n    local_tid_27501 = get_local_id(0);\n    group_sizze_27504 = get_local_size(0);\n    wave_sizze_27503 = LOCKSTEP_WIDTH;\n    group_tid_27502 = get_group_id(0);\n    \n    int32_t phys_tid_26643;\n    \n    phys_tid_26643 = global_tid_27500;\n    \n    __local char *sync_arr_mem_27505;\n    \n    sync_arr_mem_27505 = (__local char *) sync_arr_mem_27505_backing_0;\n    \n    __local char *red_arr_mem_27507;\n    \n    red_arr_mem_27507 = (__local char *) red_arr_mem_27507_backing_1;\n    \n    int64_t dummy_26641;\n    \n    dummy_26641 = 0;\n    \n    int64_t gtid_26642;\n    \n    gtid_26642 = 0;\n    \n    float x_acc_27509;\n    int64_t chunk_sizze_27510;\n    \n    chunk_sizze_27510 = smin64(sdiv_up64(steps_20495,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_27064 *\n                                         num_groups_27065))),\n                               sdiv_up64(steps_20495 -\n                                         sext_i32_i64(phys_tid_26643),\n                                         num_threads_27499));\n    \n    float x_27068;\n    float x_27069;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_27509 = 0.0F;\n    }\n    for (int64_t i_27514 = 0; i_27514 < chunk_sizze_27510; i_27514++) {\n        gtid_26642 = sext_i32_i64(phys_tid_26643) + num_threads_27499 * i_27514;\n        // apply map function\n        {\n            float x_27071 = ((__global\n                              float *) res_map_acc_mem_27247)[gtid_26642];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n             ",
                   "   x_27068 = x_acc_27509;\n            }\n            // load new values\n            {\n                x_27069 = x_27071;\n            }\n            // apply reduction operator\n            {\n                float res_27070 = x_27068 + x_27069;\n                \n                // store in accumulator\n                {\n                    x_acc_27509 = res_27070;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_27068 = x_acc_27509;\n        ((__local float *) red_arr_mem_27507)[sext_i32_i64(local_tid_27501)] =\n            x_27068;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_27515;\n    int32_t skip_waves_27516;\n    \n    skip_waves_27516 = 1;\n    \n    float x_27511;\n    float x_27512;\n    \n    offset_27515 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_27501, sext_i64_i32(segred_group_sizze_27064))) {\n            x_27511 = ((__local\n                        float *) red_arr_mem_27507)[sext_i32_i64(local_tid_27501 +\n                                                    offset_27515)];\n        }\n    }\n    offset_27515 = 1;\n    while (slt32(offset_27515, wave_sizze_27503)) {\n        if (slt32(local_tid_27501 + offset_27515,\n                  sext_i64_i32(segred_group_sizze_27064)) && ((local_tid_27501 -\n                                                               squot32(local_tid_27501,\n                                                                       wave_sizze_27503) *\n                                                               wave_sizze_27503) &\n                                                              (2 *\n                                                               offset_27515 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_27512 = ((volatile __local\n                            float *) red_arr_mem_27507)[sext_i32_i64(l",
                   "ocal_tid_27501 +\n                                                        offset_27515)];\n            }\n            // apply reduction operation\n            {\n                float res_27513 = x_27511 + x_27512;\n                \n                x_27511 = res_27513;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_27507)[sext_i32_i64(local_tid_27501)] =\n                    x_27511;\n            }\n        }\n        offset_27515 *= 2;\n    }\n    while (slt32(skip_waves_27516,\n                 squot32(sext_i64_i32(segred_group_sizze_27064) +\n                         wave_sizze_27503 - 1, wave_sizze_27503))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_27515 = skip_waves_27516 * wave_sizze_27503;\n        if (slt32(local_tid_27501 + offset_27515,\n                  sext_i64_i32(segred_group_sizze_27064)) && ((local_tid_27501 -\n                                                               squot32(local_tid_27501,\n                                                                       wave_sizze_27503) *\n                                                               wave_sizze_27503) ==\n                                                              0 &&\n                                                              (squot32(local_tid_27501,\n                                                                       wave_sizze_27503) &\n                                                               (2 *\n                                                                skip_waves_27516 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_27512 = ((__local\n                            float *) red_arr_mem_27507)[sext_i32_i64(local_tid_27501 +\n                                                        offset_27515)];\n            }\n            // apply reduction operation\n            {\n                fl",
                   "oat res_27513 = x_27511 + x_27512;\n                \n                x_27511 = res_27513;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_27507)[sext_i32_i64(local_tid_27501)] =\n                    x_27511;\n            }\n        }\n        skip_waves_27516 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_27501) == 0) {\n            x_acc_27509 = x_27511;\n        }\n    }\n    \n    int32_t old_counter_27517;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_27501 == 0) {\n            ((__global\n              float *) group_res_arr_mem_27497)[sext_i32_i64(group_tid_27502) *\n                                                segred_group_sizze_27064] =\n                x_acc_27509;\n            mem_fence_global();\n            old_counter_27517 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test2zicounter_mem_27495)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_27505)[0] = old_counter_27517 ==\n                num_groups_27065 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_27518;\n    \n    is_last_group_27518 = ((__local bool *) sync_arr_mem_27505)[0];\n    if (is_last_group_27518) {\n        if (local_tid_27501 == 0) {\n            old_counter_27517 = atomic_add_i32_global(&((volatile __global\n                                                         int *) test2zicounter_mem_27495)[0],\n                                                      (int) (0 -\n                                                             num_groups_27065));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_27519 = sdiv_up64(num_groups_27065,\n                       ",
                   "                               segred_group_sizze_27064);\n            \n            x_27068 = 0.0F;\n            for (int64_t i_27520 = 0; i_27520 < read_per_thread_27519;\n                 i_27520++) {\n                int64_t group_res_id_27521 = sext_i32_i64(local_tid_27501) *\n                        read_per_thread_27519 + i_27520;\n                int64_t index_of_group_res_27522 = group_res_id_27521;\n                \n                if (slt64(group_res_id_27521, num_groups_27065)) {\n                    x_27069 = ((__global\n                                float *) group_res_arr_mem_27497)[index_of_group_res_27522 *\n                                                                  segred_group_sizze_27064];\n                    \n                    float res_27070;\n                    \n                    res_27070 = x_27068 + x_27069;\n                    x_27068 = res_27070;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_27507)[sext_i32_i64(local_tid_27501)] =\n            x_27068;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_27523;\n            int32_t skip_waves_27524;\n            \n            skip_waves_27524 = 1;\n            \n            float x_27511;\n            float x_27512;\n            \n            offset_27523 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_27501,\n                          sext_i64_i32(segred_group_sizze_27064))) {\n                    x_27511 = ((__local\n                                float *) red_arr_mem_27507)[sext_i32_i64(local_tid_27501 +\n                                                            offset_27523)];\n                }\n            }\n            offset_27523 = 1;\n            while (slt32(offset_27523, wave_sizze_27503)) {\n                if (slt32(local_tid_27501 + offset_27523,\n                          sext_i64_i32(segred_group_sizze_27064)) &&\n          ",
                   "          ((local_tid_27501 - squot32(local_tid_27501,\n                                                wave_sizze_27503) *\n                      wave_sizze_27503) & (2 * offset_27523 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_27512 = ((volatile __local\n                                    float *) red_arr_mem_27507)[sext_i32_i64(local_tid_27501 +\n                                                                offset_27523)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27513 = x_27511 + x_27512;\n                        \n                        x_27511 = res_27513;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_27507)[sext_i32_i64(local_tid_27501)] =\n                            x_27511;\n                    }\n                }\n                offset_27523 *= 2;\n            }\n            while (slt32(skip_waves_27524,\n                         squot32(sext_i64_i32(segred_group_sizze_27064) +\n                                 wave_sizze_27503 - 1, wave_sizze_27503))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_27523 = skip_waves_27524 * wave_sizze_27503;\n                if (slt32(local_tid_27501 + offset_27523,\n                          sext_i64_i32(segred_group_sizze_27064)) &&\n                    ((local_tid_27501 - squot32(local_tid_27501,\n                                                wave_sizze_27503) *\n                      wave_sizze_27503) == 0 && (squot32(local_tid_27501,\n                                                         wave_sizze_27503) &\n                                                 (2 * skip_waves_27524 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_27512 = ((__local\n    ",
                   "                                float *) red_arr_mem_27507)[sext_i32_i64(local_tid_27501 +\n                                                                offset_27523)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_27513 = x_27511 + x_27512;\n                        \n                        x_27511 = res_27513;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_27507)[sext_i32_i64(local_tid_27501)] =\n                            x_27511;\n                    }\n                }\n                skip_waves_27524 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_27501 == 0) {\n                    ((__global float *) mem_27250)[0] = x_27511;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27064\n}\n__kernel void test2zisegred_small_26372(__global int *global_failure,\n                                        int failure_is_an_option, __global\n                                        int64_t *global_failure_args,\n                                        __local volatile\n                                        int64_t *red_arr_mem_27431_backing_aligned_0,\n                                        int64_t paths_20494,\n                                        int64_t steps_20495,\n                                        int64_t numswaps_20496,\n                                        float sims_per_year_20630,\n                                        int64_t num_groups_26928, __global\n                                        unsigned char *res_mem_27198, __global\n                                        unsigned char *res_mem_27199, __global\n                                        unsigned char *res_mem_27200, __global\n                                        unsig",
                   "ned char *res_mem_27201, __global\n                                        unsigned char *mem_27229, __global\n                                        unsigned char *mem_27242,\n                                        int64_t segment_sizze_nonzzero_27424)\n{\n    #define segred_group_sizze_26927 (test2zisegred_group_sizze_26366)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_27431_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_27431_backing_aligned_0;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_27426;\n    int32_t local_tid_27427;\n    int64_t group_sizze_27430;\n    int32_t wave_sizze_27429;\n    int32_t group_tid_27428;\n    \n    global_tid_27426 = get_global_id(0);\n    local_tid_27427 = get_local_id(0);\n    group_sizze_27430 = get_local_size(0);\n    wave_sizze_27429 = LOCKSTEP_WIDTH;\n    group_tid_27428 = get_group_id(0);\n    \n    int32_t phys_tid_26372;\n    \n    phys_tid_26372 = global_tid_27426;\n    \n    __local char *red_arr_mem_27431;\n    \n    red_arr_mem_27431 = (__local char *) red_arr_mem_27431_backing_0;\n    \n    int32_t phys_group_id_27433;\n    \n    phys_group_id_27433 = get_group_id(0);\n    for (int32_t i_27434 = 0; i_27434 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(steps_20495,\n                                          squot64(segred_group_sizze_26927,\n                                                  segment_sizze_nonzzero_27424))) -\n                   phys_group_id_27433, sext_i64_i32(num_groups_26928));\n         i_27434++) {\n        int32_t virt_group_id_27435 = phys_group_id_27433 + i_27434 *\n                sext_i64_i32(num_groups_26928);\n        int64_t gtid_26363 = squot64(sext_i32_i64(lo",
                   "cal_tid_27427),\n                                     segment_sizze_nonzzero_27424) +\n                sext_i32_i64(virt_group_id_27435) *\n                squot64(segred_group_sizze_26927, segment_sizze_nonzzero_27424);\n        int64_t gtid_26371 = srem64(sext_i32_i64(local_tid_27427), paths_20494);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, paths_20494) && (slt64(gtid_26363, steps_20495) &&\n                                          slt64(sext_i32_i64(local_tid_27427),\n                                                paths_20494 *\n                                                squot64(segred_group_sizze_26927,\n                                                        segment_sizze_nonzzero_27424)))) {\n                float x_26936 = ((__global float *) mem_27229)[gtid_26363 *\n                                                               paths_20494 +\n                                                               gtid_26371];\n                int64_t convop_x_27112 = add64(1, gtid_26363);\n                float binop_x_27113 = sitofp_i64_f32(convop_x_27112);\n                float index_primexp_27114 = binop_x_27113 / sims_per_year_20630;\n                float res_26938;\n                float redout_27159 = 0.0F;\n                \n                for (int64_t i_27160 = 0; i_27160 < numswaps_20496; i_27160++) {\n                    int64_t x_26944 = ((__global\n                                        int64_t *) res_mem_27200)[i_27160];\n                    float x_26945 = ((__global float *) res_mem_27201)[i_27160];\n                    int64_t i64_arg_26946 = sub64(x_26944, 1);\n                    float res_26947 = sitofp_i64_f32(i64_arg_26946);\n                    float y_26948 = x_26945 * res_26947;\n                    bool cond_26949 = y_26948 < index_primexp_27114;\n                    float ceil_arg_26950 = index_primexp_27114 / x_26945;\n                    float res_26951;\n                    \n                    res_26951 = futr",
                   "ts_ceil32(ceil_arg_26950);\n                    \n                    int64_t res_26952 = fptosi_f32_i64(res_26951);\n                    int64_t remaining_26953 = sub64(x_26944, res_26952);\n                    float res_26954;\n                    \n                    if (cond_26949) {\n                        res_26954 = 0.0F;\n                    } else {\n                        float x_26942 = ((__global\n                                          float *) res_mem_27198)[i_27160];\n                        float x_26943 = ((__global\n                                          float *) res_mem_27199)[i_27160];\n                        float nextpayment_26955 = x_26945 * res_26951;\n                        bool bounds_invalid_upwards_26956 =\n                             slt64(remaining_26953, 1);\n                        bool valid_26957 = !bounds_invalid_upwards_26956;\n                        bool range_valid_c_26958;\n                        \n                        if (!valid_26957) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 44) == -1) {\n                                    global_failure_args[0] = 1;\n                                    global_failure_args[1] = 2;\n                                    global_failure_args[2] = remaining_26953;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float y_26960 = nextpayment_26955 - index_primexp_27114;\n                        float negate_arg_26961 = 1.0e-2F * y_26960;\n                        float exp_arg_26962 = 0.0F - negate_arg_26961;\n                        float res_26963 = fpow32(2.7182817F, exp_arg_26962);\n                        float x_26964 = 1.0F - res_26963;\n          ",
                   "              float B_26965 = x_26964 / 1.0e-2F;\n                        float x_26966 = B_26965 - nextpayment_26955;\n                        float x_26967 = x_26966 + index_primexp_27114;\n                        float x_26968 = 4.4999997e-6F * x_26967;\n                        float A1_26969 = x_26968 / 1.0e-4F;\n                        float y_26970 = fpow32(B_26965, 2.0F);\n                        float x_26971 = 1.0000001e-6F * y_26970;\n                        float A2_26972 = x_26971 / 4.0e-2F;\n                        float exp_arg_26973 = A1_26969 - A2_26972;\n                        float res_26974 = fpow32(2.7182817F, exp_arg_26973);\n                        float negate_arg_26975 = x_26936 * B_26965;\n                        float exp_arg_26976 = 0.0F - negate_arg_26975;\n                        float res_26977 = fpow32(2.7182817F, exp_arg_26976);\n                        float res_26978 = res_26974 * res_26977;\n                        bool y_26979 = slt64(0, remaining_26953);\n                        bool index_certs_26980;\n                        \n                        if (!y_26979) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 45) == -1) {\n                                    global_failure_args[0] = 0;\n                                    global_failure_args[1] = remaining_26953;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        float binop_y_26981 = sitofp_i64_f32(remaining_26953);\n                        float binop_y_26982 = x_26945 * binop_y_26981;\n                        float index_primexp_26983 = nextpayment_26955 +\n                              binop_y_26982;\n                        float y_26984 = index",
                   "_primexp_26983 -\n                              index_primexp_27114;\n                        float negate_arg_26985 = 1.0e-2F * y_26984;\n                        float exp_arg_26986 = 0.0F - negate_arg_26985;\n                        float res_26987 = fpow32(2.7182817F, exp_arg_26986);\n                        float x_26988 = 1.0F - res_26987;\n                        float B_26989 = x_26988 / 1.0e-2F;\n                        float x_26990 = B_26989 - index_primexp_26983;\n                        float x_26991 = x_26990 + index_primexp_27114;\n                        float x_26992 = 4.4999997e-6F * x_26991;\n                        float A1_26993 = x_26992 / 1.0e-4F;\n                        float y_26994 = fpow32(B_26989, 2.0F);\n                        float x_26995 = 1.0000001e-6F * y_26994;\n                        float A2_26996 = x_26995 / 4.0e-2F;\n                        float exp_arg_26997 = A1_26993 - A2_26996;\n                        float res_26998 = fpow32(2.7182817F, exp_arg_26997);\n                        float negate_arg_26999 = x_26936 * B_26989;\n                        float exp_arg_27000 = 0.0F - negate_arg_26999;\n                        float res_27001 = fpow32(2.7182817F, exp_arg_27000);\n                        float res_27002 = res_26998 * res_27001;\n                        float res_27003;\n                        float redout_27109 = 0.0F;\n                        \n                        for (int64_t i_27110 = 0; i_27110 < remaining_26953;\n                             i_27110++) {\n                            int64_t index_primexp_27130 = add64(1, i_27110);\n                            float res_27008 =\n                                  sitofp_i64_f32(index_primexp_27130);\n                            float res_27009 = x_26945 * res_27008;\n                            float res_27010 = nextpayment_26955 + res_27009;\n                            float y_27011 = res_27010 - index_primexp_27114;\n                            float negate_arg_27012 = 1.0e-2F * y_270",
                   "11;\n                            float exp_arg_27013 = 0.0F - negate_arg_27012;\n                            float res_27014 = fpow32(2.7182817F, exp_arg_27013);\n                            float x_27015 = 1.0F - res_27014;\n                            float B_27016 = x_27015 / 1.0e-2F;\n                            float x_27017 = B_27016 - res_27010;\n                            float x_27018 = x_27017 + index_primexp_27114;\n                            float x_27019 = 4.4999997e-6F * x_27018;\n                            float A1_27020 = x_27019 / 1.0e-4F;\n                            float y_27021 = fpow32(B_27016, 2.0F);\n                            float x_27022 = 1.0000001e-6F * y_27021;\n                            float A2_27023 = x_27022 / 4.0e-2F;\n                            float exp_arg_27024 = A1_27020 - A2_27023;\n                            float res_27025 = fpow32(2.7182817F, exp_arg_27024);\n                            float negate_arg_27026 = x_26936 * B_27016;\n                            float exp_arg_27027 = 0.0F - negate_arg_27026;\n                            float res_27028 = fpow32(2.7182817F, exp_arg_27027);\n                            float res_27029 = res_27025 * res_27028;\n                            float res_27006 = res_27029 + redout_27109;\n                            float redout_tmp_27437 = res_27006;\n                            \n                            redout_27109 = redout_tmp_27437;\n                        }\n                        res_27003 = redout_27109;\n                        \n                        float x_27030 = res_26978 - res_27002;\n                        float x_27031 = x_26942 * x_26945;\n                        float y_27032 = res_27003 * x_27031;\n                        float y_27033 = x_27030 - y_27032;\n                        float res_27034 = x_26943 * y_27033;\n                        float res_27035 = x_26943 * res_27034;\n                        \n                        res_26954 = res_27035;\n                    }\n      ",
                   "              \n                    float res_26941 = res_26954 + redout_27159;\n                    float redout_tmp_27436 = res_26941;\n                    \n                    redout_27159 = redout_tmp_27436;\n                }\n                res_26938 = redout_27159;\n                \n                float res_27036 = fmax32(0.0F, res_26938);\n                \n                // save map-out results\n                { }\n                // save results to be reduced\n                {\n                    ((__local\n                      float *) red_arr_mem_27431)[sext_i32_i64(local_tid_27427)] =\n                        res_27036;\n                }\n            } else {\n                ((__local\n                  float *) red_arr_mem_27431)[sext_i32_i64(local_tid_27427)] =\n                    0.0F;\n            }\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, paths_20494)) {\n            // perform segmented scan to imitate reduction\n            {\n                float x_26931;\n                float x_26932;\n                float x_27438;\n                float x_27439;\n                bool ltid_in_bounds_27441;\n                \n                ltid_in_bounds_27441 = slt64(sext_i32_i64(local_tid_27427),\n                                             paths_20494 *\n                                             squot64(segred_group_sizze_26927,\n                                                     segment_sizze_nonzzero_27424));\n                \n                int32_t skip_threads_27442;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_27441) {\n                        x_26932 = ((volatile __local\n                                    float *) red_arr_mem_27431)[sext_i32_i64(local_tid_27427)];\n                        if ((local_tid_27427 - squot32(local_tid_27427, 32) *\n             ",
                   "                32) == 0) {\n                            x_26931 = x_26932;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_27442 = 1;\n                    while (slt32(skip_threads_27442, 32)) {\n                        if (sle32(skip_threads_27442, local_tid_27427 -\n                                  squot32(local_tid_27427, 32) * 32) &&\n                            ltid_in_bounds_27441) {\n                            // read operands\n                            {\n                                x_26931 = ((volatile __local\n                                            float *) red_arr_mem_27431)[sext_i32_i64(local_tid_27427) -\n                                                                        sext_i32_i64(skip_threads_27442)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_27443 =\n                                     slt64(srem64(sext_i32_i64(local_tid_27427),\n                                                  paths_20494),\n                                           sext_i32_i64(local_tid_27427) -\n                                           sext_i32_i64(local_tid_27427 -\n                                           skip_threads_27442));\n                                \n                                if (inactive_27443) {\n                                    x_26931 = x_26932;\n                                }\n                                if (!inactive_27443) {\n                                    float res_26933 = x_26931 + x_26932;\n                                    \n                                    x_26931 = res_26933;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_27429, skip_threads_27442)) {\n                            barrier(CLK_LOCAL",
                   "_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_27442, local_tid_27427 -\n                                  squot32(local_tid_27427, 32) * 32) &&\n                            ltid_in_bounds_27441) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_27431)[sext_i32_i64(local_tid_27427)] =\n                                    x_26931;\n                                x_26932 = x_26931;\n                            }\n                        }\n                        if (sle32(wave_sizze_27429, skip_threads_27442)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_27442 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_27427 - squot32(local_tid_27427, 32) * 32) ==\n                        31 && ltid_in_bounds_27441) {\n                        ((volatile __local\n                          float *) red_arr_mem_27431)[sext_i32_i64(squot32(local_tid_27427,\n                                                                           32))] =\n                            x_26931;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_27444;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_27427, 32) == 0 &&\n                            ltid_in_bounds_27441) {\n                            x_27439 = ((volatile __local\n                                        float *) red_arr_mem_27431)[sext_i32_i64(local_tid_27427",
                   ")];\n                            if ((local_tid_27427 - squot32(local_tid_27427,\n                                                           32) * 32) == 0) {\n                                x_27438 = x_27439;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_27444 = 1;\n                        while (slt32(skip_threads_27444, 32)) {\n                            if (sle32(skip_threads_27444, local_tid_27427 -\n                                      squot32(local_tid_27427, 32) * 32) &&\n                                (squot32(local_tid_27427, 32) == 0 &&\n                                 ltid_in_bounds_27441)) {\n                                // read operands\n                                {\n                                    x_27438 = ((volatile __local\n                                                float *) red_arr_mem_27431)[sext_i32_i64(local_tid_27427) -\n                                                                            sext_i32_i64(skip_threads_27444)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_27445 =\n                                         slt64(srem64(sext_i32_i64(local_tid_27427 *\n                                                      32 + 32 - 1),\n                                                      paths_20494),\n                                               sext_i32_i64(local_tid_27427 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_27427 -\n                                                             skip_threads_27444) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_27445) {\n      ",
                   "                                  x_27438 = x_27439;\n                                    }\n                                    if (!inactive_27445) {\n                                        float res_27440 = x_27438 + x_27439;\n                                        \n                                        x_27438 = res_27440;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_27429, skip_threads_27444)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_27444, local_tid_27427 -\n                                      squot32(local_tid_27427, 32) * 32) &&\n                                (squot32(local_tid_27427, 32) == 0 &&\n                                 ltid_in_bounds_27441)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      float *) red_arr_mem_27431)[sext_i32_i64(local_tid_27427)] =\n                                        x_27438;\n                                    x_27439 = x_27438;\n                                }\n                            }\n                            if (sle32(wave_sizze_27429, skip_threads_27444)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_27444 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_27427, 32) == 0 ||\n                          !ltid_in_bounds_27441)) {\n                        // read operands\n                        {\n                            x_26932 = x_26931;\n                            x_26931 = ((__local\n                      ",
                   "                  float *) red_arr_mem_27431)[sext_i32_i64(squot32(local_tid_27427,\n                                                                                         32)) -\n                                                                    1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_27446 =\n                                 slt64(srem64(sext_i32_i64(local_tid_27427),\n                                              paths_20494),\n                                       sext_i32_i64(local_tid_27427) -\n                                       sext_i32_i64(squot32(local_tid_27427,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_27446) {\n                                x_26931 = x_26932;\n                            }\n                            if (!inactive_27446) {\n                                float res_26933 = x_26931 + x_26932;\n                                \n                                x_26931 = res_26933;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              float *) red_arr_mem_27431)[sext_i32_i64(local_tid_27427)] =\n                                x_26931;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_27427, 32) == 0) {\n                        ((__local\n                          float *) red_arr_mem_27431)[sext_i32_i64(local_tid_27427)] =\n                            x_26932;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final",
                   " values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_27435) *\n                      squot64(segred_group_sizze_26927,\n                              segment_sizze_nonzzero_27424) +\n                      sext_i32_i64(local_tid_27427), steps_20495) &&\n                slt64(sext_i32_i64(local_tid_27427),\n                      squot64(segred_group_sizze_26927,\n                              segment_sizze_nonzzero_27424))) {\n                ((__global\n                  float *) mem_27242)[sext_i32_i64(virt_group_id_27435) *\n                                      squot64(segred_group_sizze_26927,\n                                              segment_sizze_nonzzero_27424) +\n                                      sext_i32_i64(local_tid_27427)] = ((__local\n                                                                         float *) red_arr_mem_27431)[(sext_i32_i64(local_tid_27427) +\n                                                                                                      1) *\n                                                                                                     segment_sizze_nonzzero_27424 -\n                                                                                                     1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_26927\n}\n",
                   NULL};
static const char *size_names[] = {"main.segmap_group_size_20864",
                                   "main.segmap_group_size_21013",
                                   "main.segmap_group_size_21322",
                                   "main.segmap_group_size_21421",
                                   "main.segmap_group_size_21484",
                                   "main.segmap_group_size_21769",
                                   "main.segmap_group_size_22194",
                                   "main.segmap_num_groups_21324",
                                   "main.segred_group_size_20850",
                                   "main.segred_group_size_21600",
                                   "main.segred_group_size_22221",
                                   "main.segred_group_size_22505",
                                   "main.segred_num_groups_20852",
                                   "main.segred_num_groups_21602",
                                   "main.segred_num_groups_22223",
                                   "main.segred_num_groups_22507",
                                   "main.suff_intra_par_7",
                                   "main.suff_outer_par_0",
                                   "main.suff_outer_par_6",
                                   "main.suff_outer_redomap_5",
                                   "test.segmap_group_size_22984",
                                   "test.segmap_group_size_23133",
                                   "test.segmap_group_size_23442",
                                   "test.segmap_group_size_23541",
                                   "test.segmap_group_size_23604",
                                   "test.segmap_group_size_23880",
                                   "test.segmap_group_size_24285",
                                   "test.segmap_num_groups_23444",
                                   "test.segred_group_size_22970",
                                   "test.segred_group_size_23720",
                                   "test.segred_group_size_24312",
                                   "test.segred_group_size_24581",
                                   "test.segred_num_groups_22972",
                                   "test.segred_num_groups_23722",
                                   "test.segred_num_groups_24314",
                                   "test.segred_num_groups_24583",
                                   "test.suff_intra_par_7",
                                   "test.suff_outer_par_0",
                                   "test.suff_outer_par_6",
                                   "test.suff_outer_redomap_5",
                                   "test2.segmap_group_size_25038",
                                   "test2.segmap_group_size_25187",
                                   "test2.segmap_group_size_25496",
                                   "test2.segmap_group_size_25595",
                                   "test2.segmap_group_size_25658",
                                   "test2.segmap_group_size_25934",
                                   "test2.segmap_group_size_26339",
                                   "test2.segmap_num_groups_25498",
                                   "test2.segred_group_size_25021",
                                   "test2.segred_group_size_25774",
                                   "test2.segred_group_size_26366",
                                   "test2.segred_group_size_26635",
                                   "test2.segred_num_groups_25023",
                                   "test2.segred_num_groups_25776",
                                   "test2.segred_num_groups_26368",
                                   "test2.segred_num_groups_26637",
                                   "test2.suff_intra_par_7",
                                   "test2.suff_outer_par_0",
                                   "test2.suff_outer_par_6",
                                   "test2.suff_outer_redomap_5"};
static const char *size_vars[] = {"mainzisegmap_group_sizze_20864",
                                  "mainzisegmap_group_sizze_21013",
                                  "mainzisegmap_group_sizze_21322",
                                  "mainzisegmap_group_sizze_21421",
                                  "mainzisegmap_group_sizze_21484",
                                  "mainzisegmap_group_sizze_21769",
                                  "mainzisegmap_group_sizze_22194",
                                  "mainzisegmap_num_groups_21324",
                                  "mainzisegred_group_sizze_20850",
                                  "mainzisegred_group_sizze_21600",
                                  "mainzisegred_group_sizze_22221",
                                  "mainzisegred_group_sizze_22505",
                                  "mainzisegred_num_groups_20852",
                                  "mainzisegred_num_groups_21602",
                                  "mainzisegred_num_groups_22223",
                                  "mainzisegred_num_groups_22507",
                                  "mainzisuff_intra_par_7",
                                  "mainzisuff_outer_par_0",
                                  "mainzisuff_outer_par_6",
                                  "mainzisuff_outer_redomap_5",
                                  "testzisegmap_group_sizze_22984",
                                  "testzisegmap_group_sizze_23133",
                                  "testzisegmap_group_sizze_23442",
                                  "testzisegmap_group_sizze_23541",
                                  "testzisegmap_group_sizze_23604",
                                  "testzisegmap_group_sizze_23880",
                                  "testzisegmap_group_sizze_24285",
                                  "testzisegmap_num_groups_23444",
                                  "testzisegred_group_sizze_22970",
                                  "testzisegred_group_sizze_23720",
                                  "testzisegred_group_sizze_24312",
                                  "testzisegred_group_sizze_24581",
                                  "testzisegred_num_groups_22972",
                                  "testzisegred_num_groups_23722",
                                  "testzisegred_num_groups_24314",
                                  "testzisegred_num_groups_24583",
                                  "testzisuff_intra_par_7",
                                  "testzisuff_outer_par_0",
                                  "testzisuff_outer_par_6",
                                  "testzisuff_outer_redomap_5",
                                  "test2zisegmap_group_sizze_25038",
                                  "test2zisegmap_group_sizze_25187",
                                  "test2zisegmap_group_sizze_25496",
                                  "test2zisegmap_group_sizze_25595",
                                  "test2zisegmap_group_sizze_25658",
                                  "test2zisegmap_group_sizze_25934",
                                  "test2zisegmap_group_sizze_26339",
                                  "test2zisegmap_num_groups_25498",
                                  "test2zisegred_group_sizze_25021",
                                  "test2zisegred_group_sizze_25774",
                                  "test2zisegred_group_sizze_26366",
                                  "test2zisegred_group_sizze_26635",
                                  "test2zisegred_num_groups_25023",
                                  "test2zisegred_num_groups_25776",
                                  "test2zisegred_num_groups_26368",
                                  "test2zisegred_num_groups_26637",
                                  "test2zisuff_intra_par_7",
                                  "test2zisuff_outer_par_0",
                                  "test2zisuff_outer_par_6",
                                  "test2zisuff_outer_redomap_5"};
static const char *size_classes[] = {"group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "num_groups", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups",
                                     "threshold (!main.suff_outer_par_6 !main.suff_outer_redomap_5)",
                                     "threshold ()",
                                     "threshold (!main.suff_outer_redomap_5)",
                                     "threshold ()", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "num_groups",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "num_groups", "num_groups",
                                     "num_groups", "num_groups",
                                     "threshold (!test.suff_outer_par_6 !test.suff_outer_redomap_5)",
                                     "threshold ()",
                                     "threshold (!test.suff_outer_redomap_5)",
                                     "threshold ()", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "num_groups",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "num_groups", "num_groups",
                                     "num_groups", "num_groups",
                                     "threshold (!test2.suff_outer_par_6 !test2.suff_outer_redomap_5)",
                                     "threshold ()",
                                     "threshold (!test2.suff_outer_redomap_5)",
                                     "threshold ()"};
int futhark_get_num_sizes(void)
{
    return 60;
}
const char *futhark_get_size_name(int i)
{
    return size_names[i];
}
const char *futhark_get_size_class(int i)
{
    return size_classes[i];
}
struct sizes {
    size_t mainzisegmap_group_sizze_20864;
    size_t mainzisegmap_group_sizze_21013;
    size_t mainzisegmap_group_sizze_21322;
    size_t mainzisegmap_group_sizze_21421;
    size_t mainzisegmap_group_sizze_21484;
    size_t mainzisegmap_group_sizze_21769;
    size_t mainzisegmap_group_sizze_22194;
    size_t mainzisegmap_num_groups_21324;
    size_t mainzisegred_group_sizze_20850;
    size_t mainzisegred_group_sizze_21600;
    size_t mainzisegred_group_sizze_22221;
    size_t mainzisegred_group_sizze_22505;
    size_t mainzisegred_num_groups_20852;
    size_t mainzisegred_num_groups_21602;
    size_t mainzisegred_num_groups_22223;
    size_t mainzisegred_num_groups_22507;
    size_t mainzisuff_intra_par_7;
    size_t mainzisuff_outer_par_0;
    size_t mainzisuff_outer_par_6;
    size_t mainzisuff_outer_redomap_5;
    size_t testzisegmap_group_sizze_22984;
    size_t testzisegmap_group_sizze_23133;
    size_t testzisegmap_group_sizze_23442;
    size_t testzisegmap_group_sizze_23541;
    size_t testzisegmap_group_sizze_23604;
    size_t testzisegmap_group_sizze_23880;
    size_t testzisegmap_group_sizze_24285;
    size_t testzisegmap_num_groups_23444;
    size_t testzisegred_group_sizze_22970;
    size_t testzisegred_group_sizze_23720;
    size_t testzisegred_group_sizze_24312;
    size_t testzisegred_group_sizze_24581;
    size_t testzisegred_num_groups_22972;
    size_t testzisegred_num_groups_23722;
    size_t testzisegred_num_groups_24314;
    size_t testzisegred_num_groups_24583;
    size_t testzisuff_intra_par_7;
    size_t testzisuff_outer_par_0;
    size_t testzisuff_outer_par_6;
    size_t testzisuff_outer_redomap_5;
    size_t test2zisegmap_group_sizze_25038;
    size_t test2zisegmap_group_sizze_25187;
    size_t test2zisegmap_group_sizze_25496;
    size_t test2zisegmap_group_sizze_25595;
    size_t test2zisegmap_group_sizze_25658;
    size_t test2zisegmap_group_sizze_25934;
    size_t test2zisegmap_group_sizze_26339;
    size_t test2zisegmap_num_groups_25498;
    size_t test2zisegred_group_sizze_25021;
    size_t test2zisegred_group_sizze_25774;
    size_t test2zisegred_group_sizze_26366;
    size_t test2zisegred_group_sizze_26635;
    size_t test2zisegred_num_groups_25023;
    size_t test2zisegred_num_groups_25776;
    size_t test2zisegred_num_groups_26368;
    size_t test2zisegred_num_groups_26637;
    size_t test2zisuff_intra_par_7;
    size_t test2zisuff_outer_par_0;
    size_t test2zisuff_outer_par_6;
    size_t test2zisuff_outer_redomap_5;
} ;
struct futhark_context_config {
    struct opencl_config opencl;
    size_t sizes[60];
    int num_build_opts;
    const char **build_opts;
} ;
struct futhark_context_config *futhark_context_config_new(void)
{
    struct futhark_context_config *cfg =
                                  (struct futhark_context_config *) malloc(sizeof(struct futhark_context_config));
    
    if (cfg == NULL)
        return NULL;
    cfg->num_build_opts = 0;
    cfg->build_opts = (const char **) malloc(sizeof(const char *));
    cfg->build_opts[0] = NULL;
    cfg->sizes[0] = 0;
    cfg->sizes[1] = 0;
    cfg->sizes[2] = 0;
    cfg->sizes[3] = 0;
    cfg->sizes[4] = 0;
    cfg->sizes[5] = 0;
    cfg->sizes[6] = 0;
    cfg->sizes[7] = 0;
    cfg->sizes[8] = 0;
    cfg->sizes[9] = 0;
    cfg->sizes[10] = 0;
    cfg->sizes[11] = 0;
    cfg->sizes[12] = 0;
    cfg->sizes[13] = 0;
    cfg->sizes[14] = 0;
    cfg->sizes[15] = 0;
    cfg->sizes[16] = 32;
    cfg->sizes[17] = 0;
    cfg->sizes[18] = 0;
    cfg->sizes[19] = 0;
    cfg->sizes[20] = 0;
    cfg->sizes[21] = 0;
    cfg->sizes[22] = 0;
    cfg->sizes[23] = 0;
    cfg->sizes[24] = 0;
    cfg->sizes[25] = 0;
    cfg->sizes[26] = 0;
    cfg->sizes[27] = 0;
    cfg->sizes[28] = 0;
    cfg->sizes[29] = 0;
    cfg->sizes[30] = 0;
    cfg->sizes[31] = 0;
    cfg->sizes[32] = 0;
    cfg->sizes[33] = 0;
    cfg->sizes[34] = 0;
    cfg->sizes[35] = 0;
    cfg->sizes[36] = 32;
    cfg->sizes[37] = 0;
    cfg->sizes[38] = 0;
    cfg->sizes[39] = 0;
    cfg->sizes[40] = 0;
    cfg->sizes[41] = 0;
    cfg->sizes[42] = 0;
    cfg->sizes[43] = 0;
    cfg->sizes[44] = 0;
    cfg->sizes[45] = 0;
    cfg->sizes[46] = 0;
    cfg->sizes[47] = 0;
    cfg->sizes[48] = 0;
    cfg->sizes[49] = 0;
    cfg->sizes[50] = 0;
    cfg->sizes[51] = 0;
    cfg->sizes[52] = 0;
    cfg->sizes[53] = 0;
    cfg->sizes[54] = 0;
    cfg->sizes[55] = 0;
    cfg->sizes[56] = 32;
    cfg->sizes[57] = 0;
    cfg->sizes[58] = 0;
    cfg->sizes[59] = 0;
    opencl_config_init(&cfg->opencl, 60, size_names, size_vars, cfg->sizes,
                       size_classes);
    return cfg;
}
void futhark_context_config_free(struct futhark_context_config *cfg)
{
    free(cfg->build_opts);
    free(cfg);
}
void futhark_context_config_add_build_option(struct futhark_context_config *cfg,
                                             const char *opt)
{
    cfg->build_opts[cfg->num_build_opts] = opt;
    cfg->num_build_opts++;
    cfg->build_opts = (const char **) realloc(cfg->build_opts,
                                              (cfg->num_build_opts + 1) *
                                              sizeof(const char *));
    cfg->build_opts[cfg->num_build_opts] = NULL;
}
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int flag)
{
    cfg->opencl.profiling = cfg->opencl.logging = cfg->opencl.debugging = flag;
}
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag)
{
    cfg->opencl.profiling = flag;
}
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int flag)
{
    cfg->opencl.logging = flag;
}
void futhark_context_config_set_device(struct futhark_context_config *cfg, const
                                       char *s)
{
    set_preferred_device(&cfg->opencl, s);
}
void futhark_context_config_set_platform(struct futhark_context_config *cfg,
                                         const char *s)
{
    set_preferred_platform(&cfg->opencl, s);
}
void futhark_context_config_select_device_interactively(struct futhark_context_config *cfg)
{
    select_device_interactively(&cfg->opencl);
}
void futhark_context_config_list_devices(struct futhark_context_config *cfg)
{
    list_devices(&cfg->opencl);
}
void futhark_context_config_dump_program_to(struct futhark_context_config *cfg,
                                            const char *path)
{
    cfg->opencl.dump_program_to = path;
}
void futhark_context_config_load_program_from(struct futhark_context_config *cfg,
                                              const char *path)
{
    cfg->opencl.load_program_from = path;
}
void futhark_context_config_dump_binary_to(struct futhark_context_config *cfg,
                                           const char *path)
{
    cfg->opencl.dump_binary_to = path;
}
void futhark_context_config_load_binary_from(struct futhark_context_config *cfg,
                                             const char *path)
{
    cfg->opencl.load_binary_from = path;
}
void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg,
                                                   int size)
{
    cfg->opencl.default_group_size = size;
    cfg->opencl.default_group_size_changed = 1;
}
void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg,
                                                   int num)
{
    cfg->opencl.default_num_groups = num;
}
void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg,
                                                  int size)
{
    cfg->opencl.default_tile_size = size;
    cfg->opencl.default_tile_size_changed = 1;
}
void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg,
                                                  int size)
{
    cfg->opencl.default_threshold = size;
}
int futhark_context_config_set_size(struct futhark_context_config *cfg, const
                                    char *size_name, size_t size_value)
{
    for (int i = 0; i < 60; i++) {
        if (strcmp(size_name, size_names[i]) == 0) {
            cfg->sizes[i] = size_value;
            return 0;
        }
    }
    if (strcmp(size_name, "default_group_size") == 0) {
        cfg->opencl.default_group_size = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_num_groups") == 0) {
        cfg->opencl.default_num_groups = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_threshold") == 0) {
        cfg->opencl.default_threshold = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_tile_size") == 0) {
        cfg->opencl.default_tile_size = size_value;
        return 0;
    }
    return 1;
}
struct futhark_context {
    int detail_memory;
    int debugging;
    int profiling;
    int profiling_paused;
    int logging;
    lock_t lock;
    char *error;
    int64_t peak_mem_usage_device;
    int64_t cur_mem_usage_device;
    int64_t peak_mem_usage_default;
    int64_t cur_mem_usage_default;
    struct {
        int dummy;
    } constants;
    struct memblock_device mainzicounter_mem_27305;
    struct memblock_device mainzicounter_mem_27373;
    struct memblock_device mainzicounter_mem_27456;
    struct memblock_device mainzicounter_mem_27497;
    struct memblock_device testzistatic_array_27302;
    struct memblock_device testzistatic_array_27303;
    struct memblock_device testzistatic_array_27304;
    struct memblock_device testzicounter_mem_27306;
    struct memblock_device testzicounter_mem_27374;
    struct memblock_device testzicounter_mem_27457;
    struct memblock_device testzicounter_mem_27498;
    struct memblock_device test2zicounter_mem_27303;
    struct memblock_device test2zicounter_mem_27371;
    struct memblock_device test2zicounter_mem_27454;
    struct memblock_device test2zicounter_mem_27495;
    int total_runs;
    long total_runtime;
    cl_kernel gpu_map_transpose_f32;
    cl_kernel gpu_map_transpose_f32_low_height;
    cl_kernel gpu_map_transpose_f32_low_width;
    cl_kernel gpu_map_transpose_f32_small;
    cl_kernel mainzisegmap_20862;
    cl_kernel mainzisegmap_21011;
    cl_kernel mainzisegmap_21320;
    cl_kernel mainzisegmap_21418;
    cl_kernel mainzisegmap_21482;
    cl_kernel mainzisegmap_21767;
    cl_kernel mainzisegmap_22192;
    cl_kernel mainzisegmap_intragroup_21765;
    cl_kernel mainzisegred_large_22227;
    cl_kernel mainzisegred_nonseg_20858;
    cl_kernel mainzisegred_nonseg_21609;
    cl_kernel mainzisegred_nonseg_22513;
    cl_kernel mainzisegred_small_22227;
    cl_kernel testzisegmap_22982;
    cl_kernel testzisegmap_23131;
    cl_kernel testzisegmap_23440;
    cl_kernel testzisegmap_23538;
    cl_kernel testzisegmap_23602;
    cl_kernel testzisegmap_23878;
    cl_kernel testzisegmap_24283;
    cl_kernel testzisegmap_intragroup_23876;
    cl_kernel testzisegred_large_24318;
    cl_kernel testzisegred_nonseg_22978;
    cl_kernel testzisegred_nonseg_23728;
    cl_kernel testzisegred_nonseg_24589;
    cl_kernel testzisegred_small_24318;
    cl_kernel test2zisegmap_25036;
    cl_kernel test2zisegmap_25185;
    cl_kernel test2zisegmap_25494;
    cl_kernel test2zisegmap_25592;
    cl_kernel test2zisegmap_25656;
    cl_kernel test2zisegmap_25932;
    cl_kernel test2zisegmap_26337;
    cl_kernel test2zisegmap_intragroup_25930;
    cl_kernel test2zisegred_large_26372;
    cl_kernel test2zisegred_nonseg_25032;
    cl_kernel test2zisegred_nonseg_25782;
    cl_kernel test2zisegred_nonseg_26643;
    cl_kernel test2zisegred_small_26372;
    int64_t copy_dev_to_dev_total_runtime;
    int copy_dev_to_dev_runs;
    int64_t copy_dev_to_host_total_runtime;
    int copy_dev_to_host_runs;
    int64_t copy_host_to_dev_total_runtime;
    int copy_host_to_dev_runs;
    int64_t copy_scalar_to_dev_total_runtime;
    int copy_scalar_to_dev_runs;
    int64_t copy_scalar_from_dev_total_runtime;
    int copy_scalar_from_dev_runs;
    int64_t gpu_map_transpose_f32_total_runtime;
    int gpu_map_transpose_f32_runs;
    int64_t gpu_map_transpose_f32_low_height_total_runtime;
    int gpu_map_transpose_f32_low_height_runs;
    int64_t gpu_map_transpose_f32_low_width_total_runtime;
    int gpu_map_transpose_f32_low_width_runs;
    int64_t gpu_map_transpose_f32_small_total_runtime;
    int gpu_map_transpose_f32_small_runs;
    int64_t mainzisegmap_20862_total_runtime;
    int mainzisegmap_20862_runs;
    int64_t mainzisegmap_21011_total_runtime;
    int mainzisegmap_21011_runs;
    int64_t mainzisegmap_21320_total_runtime;
    int mainzisegmap_21320_runs;
    int64_t mainzisegmap_21418_total_runtime;
    int mainzisegmap_21418_runs;
    int64_t mainzisegmap_21482_total_runtime;
    int mainzisegmap_21482_runs;
    int64_t mainzisegmap_21767_total_runtime;
    int mainzisegmap_21767_runs;
    int64_t mainzisegmap_22192_total_runtime;
    int mainzisegmap_22192_runs;
    int64_t mainzisegmap_intragroup_21765_total_runtime;
    int mainzisegmap_intragroup_21765_runs;
    int64_t mainzisegred_large_22227_total_runtime;
    int mainzisegred_large_22227_runs;
    int64_t mainzisegred_nonseg_20858_total_runtime;
    int mainzisegred_nonseg_20858_runs;
    int64_t mainzisegred_nonseg_21609_total_runtime;
    int mainzisegred_nonseg_21609_runs;
    int64_t mainzisegred_nonseg_22513_total_runtime;
    int mainzisegred_nonseg_22513_runs;
    int64_t mainzisegred_small_22227_total_runtime;
    int mainzisegred_small_22227_runs;
    int64_t testzisegmap_22982_total_runtime;
    int testzisegmap_22982_runs;
    int64_t testzisegmap_23131_total_runtime;
    int testzisegmap_23131_runs;
    int64_t testzisegmap_23440_total_runtime;
    int testzisegmap_23440_runs;
    int64_t testzisegmap_23538_total_runtime;
    int testzisegmap_23538_runs;
    int64_t testzisegmap_23602_total_runtime;
    int testzisegmap_23602_runs;
    int64_t testzisegmap_23878_total_runtime;
    int testzisegmap_23878_runs;
    int64_t testzisegmap_24283_total_runtime;
    int testzisegmap_24283_runs;
    int64_t testzisegmap_intragroup_23876_total_runtime;
    int testzisegmap_intragroup_23876_runs;
    int64_t testzisegred_large_24318_total_runtime;
    int testzisegred_large_24318_runs;
    int64_t testzisegred_nonseg_22978_total_runtime;
    int testzisegred_nonseg_22978_runs;
    int64_t testzisegred_nonseg_23728_total_runtime;
    int testzisegred_nonseg_23728_runs;
    int64_t testzisegred_nonseg_24589_total_runtime;
    int testzisegred_nonseg_24589_runs;
    int64_t testzisegred_small_24318_total_runtime;
    int testzisegred_small_24318_runs;
    int64_t test2zisegmap_25036_total_runtime;
    int test2zisegmap_25036_runs;
    int64_t test2zisegmap_25185_total_runtime;
    int test2zisegmap_25185_runs;
    int64_t test2zisegmap_25494_total_runtime;
    int test2zisegmap_25494_runs;
    int64_t test2zisegmap_25592_total_runtime;
    int test2zisegmap_25592_runs;
    int64_t test2zisegmap_25656_total_runtime;
    int test2zisegmap_25656_runs;
    int64_t test2zisegmap_25932_total_runtime;
    int test2zisegmap_25932_runs;
    int64_t test2zisegmap_26337_total_runtime;
    int test2zisegmap_26337_runs;
    int64_t test2zisegmap_intragroup_25930_total_runtime;
    int test2zisegmap_intragroup_25930_runs;
    int64_t test2zisegred_large_26372_total_runtime;
    int test2zisegred_large_26372_runs;
    int64_t test2zisegred_nonseg_25032_total_runtime;
    int test2zisegred_nonseg_25032_runs;
    int64_t test2zisegred_nonseg_25782_total_runtime;
    int test2zisegred_nonseg_25782_runs;
    int64_t test2zisegred_nonseg_26643_total_runtime;
    int test2zisegred_nonseg_26643_runs;
    int64_t test2zisegred_small_26372_total_runtime;
    int test2zisegred_small_26372_runs;
    cl_mem global_failure;
    cl_mem global_failure_args;
    struct opencl_context opencl;
    struct sizes sizes;
    cl_int failure_is_an_option;
} ;
void post_opencl_setup(struct opencl_context *ctx,
                       struct opencl_device_option *option)
{
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name,
                                            "NVIDIA CUDA") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_GPU) == CL_DEVICE_TYPE_GPU) {
        ctx->lockstep_width = 32;
    }
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name,
                                            "AMD Accelerated Parallel Processing") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->lockstep_width = 32;
    }
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->lockstep_width = 1;
    }
    if ((ctx->cfg.default_num_groups == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_GPU) == CL_DEVICE_TYPE_GPU) {
        size_t MAX_COMPUTE_UNITS_val = 0;
        
        clGetDeviceInfo(ctx->device, CL_DEVICE_MAX_COMPUTE_UNITS,
                        sizeof(MAX_COMPUTE_UNITS_val), &MAX_COMPUTE_UNITS_val,
                        NULL);
        ctx->cfg.default_num_groups = 4 * MAX_COMPUTE_UNITS_val;
    }
    if ((ctx->cfg.default_group_size == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_GPU) == CL_DEVICE_TYPE_GPU) {
        ctx->cfg.default_group_size = 256;
    }
    if ((ctx->cfg.default_tile_size == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->cfg.default_tile_size = 32;
    }
    if ((ctx->cfg.default_threshold == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->cfg.default_threshold = 32768;
    }
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_CPU) ==
        CL_DEVICE_TYPE_CPU) {
        ctx->lockstep_width = 1;
    }
    if ((ctx->cfg.default_num_groups == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_CPU) == CL_DEVICE_TYPE_CPU) {
        size_t MAX_COMPUTE_UNITS_val = 0;
        
        clGetDeviceInfo(ctx->device, CL_DEVICE_MAX_COMPUTE_UNITS,
                        sizeof(MAX_COMPUTE_UNITS_val), &MAX_COMPUTE_UNITS_val,
                        NULL);
        ctx->cfg.default_num_groups = MAX_COMPUTE_UNITS_val;
    }
    if ((ctx->cfg.default_group_size == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_CPU) == CL_DEVICE_TYPE_CPU) {
        ctx->cfg.default_group_size = 32;
    }
    if ((ctx->cfg.default_tile_size == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_CPU) ==
        CL_DEVICE_TYPE_CPU) {
        ctx->cfg.default_tile_size = 4;
    }
    if ((ctx->cfg.default_threshold == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_CPU) ==
        CL_DEVICE_TYPE_CPU) {
        size_t MAX_COMPUTE_UNITS_val = 0;
        
        clGetDeviceInfo(ctx->device, CL_DEVICE_MAX_COMPUTE_UNITS,
                        sizeof(MAX_COMPUTE_UNITS_val), &MAX_COMPUTE_UNITS_val,
                        NULL);
        ctx->cfg.default_threshold = MAX_COMPUTE_UNITS_val;
    }
}
static void init_context_early(struct futhark_context_config *cfg,
                               struct futhark_context *ctx)
{
    ctx->opencl.cfg = cfg->opencl;
    ctx->detail_memory = cfg->opencl.debugging;
    ctx->debugging = cfg->opencl.debugging;
    ctx->profiling = cfg->opencl.profiling;
    ctx->profiling_paused = 0;
    ctx->logging = cfg->opencl.logging;
    ctx->error = NULL;
    ctx->opencl.profiling_records_capacity = 200;
    ctx->opencl.profiling_records_used = 0;
    ctx->opencl.profiling_records =
        malloc(ctx->opencl.profiling_records_capacity *
        sizeof(struct profiling_record));
    create_lock(&ctx->lock);
    ctx->failure_is_an_option = 0;
    ctx->peak_mem_usage_device = 0;
    ctx->cur_mem_usage_device = 0;
    ctx->peak_mem_usage_default = 0;
    ctx->cur_mem_usage_default = 0;
    ctx->total_runs = 0;
    ctx->total_runtime = 0;
    ctx->copy_dev_to_dev_total_runtime = 0;
    ctx->copy_dev_to_dev_runs = 0;
    ctx->copy_dev_to_host_total_runtime = 0;
    ctx->copy_dev_to_host_runs = 0;
    ctx->copy_host_to_dev_total_runtime = 0;
    ctx->copy_host_to_dev_runs = 0;
    ctx->copy_scalar_to_dev_total_runtime = 0;
    ctx->copy_scalar_to_dev_runs = 0;
    ctx->copy_scalar_from_dev_total_runtime = 0;
    ctx->copy_scalar_from_dev_runs = 0;
    ctx->gpu_map_transpose_f32_total_runtime = 0;
    ctx->gpu_map_transpose_f32_runs = 0;
    ctx->gpu_map_transpose_f32_low_height_total_runtime = 0;
    ctx->gpu_map_transpose_f32_low_height_runs = 0;
    ctx->gpu_map_transpose_f32_low_width_total_runtime = 0;
    ctx->gpu_map_transpose_f32_low_width_runs = 0;
    ctx->gpu_map_transpose_f32_small_total_runtime = 0;
    ctx->gpu_map_transpose_f32_small_runs = 0;
    ctx->mainzisegmap_20862_total_runtime = 0;
    ctx->mainzisegmap_20862_runs = 0;
    ctx->mainzisegmap_21011_total_runtime = 0;
    ctx->mainzisegmap_21011_runs = 0;
    ctx->mainzisegmap_21320_total_runtime = 0;
    ctx->mainzisegmap_21320_runs = 0;
    ctx->mainzisegmap_21418_total_runtime = 0;
    ctx->mainzisegmap_21418_runs = 0;
    ctx->mainzisegmap_21482_total_runtime = 0;
    ctx->mainzisegmap_21482_runs = 0;
    ctx->mainzisegmap_21767_total_runtime = 0;
    ctx->mainzisegmap_21767_runs = 0;
    ctx->mainzisegmap_22192_total_runtime = 0;
    ctx->mainzisegmap_22192_runs = 0;
    ctx->mainzisegmap_intragroup_21765_total_runtime = 0;
    ctx->mainzisegmap_intragroup_21765_runs = 0;
    ctx->mainzisegred_large_22227_total_runtime = 0;
    ctx->mainzisegred_large_22227_runs = 0;
    ctx->mainzisegred_nonseg_20858_total_runtime = 0;
    ctx->mainzisegred_nonseg_20858_runs = 0;
    ctx->mainzisegred_nonseg_21609_total_runtime = 0;
    ctx->mainzisegred_nonseg_21609_runs = 0;
    ctx->mainzisegred_nonseg_22513_total_runtime = 0;
    ctx->mainzisegred_nonseg_22513_runs = 0;
    ctx->mainzisegred_small_22227_total_runtime = 0;
    ctx->mainzisegred_small_22227_runs = 0;
    ctx->testzisegmap_22982_total_runtime = 0;
    ctx->testzisegmap_22982_runs = 0;
    ctx->testzisegmap_23131_total_runtime = 0;
    ctx->testzisegmap_23131_runs = 0;
    ctx->testzisegmap_23440_total_runtime = 0;
    ctx->testzisegmap_23440_runs = 0;
    ctx->testzisegmap_23538_total_runtime = 0;
    ctx->testzisegmap_23538_runs = 0;
    ctx->testzisegmap_23602_total_runtime = 0;
    ctx->testzisegmap_23602_runs = 0;
    ctx->testzisegmap_23878_total_runtime = 0;
    ctx->testzisegmap_23878_runs = 0;
    ctx->testzisegmap_24283_total_runtime = 0;
    ctx->testzisegmap_24283_runs = 0;
    ctx->testzisegmap_intragroup_23876_total_runtime = 0;
    ctx->testzisegmap_intragroup_23876_runs = 0;
    ctx->testzisegred_large_24318_total_runtime = 0;
    ctx->testzisegred_large_24318_runs = 0;
    ctx->testzisegred_nonseg_22978_total_runtime = 0;
    ctx->testzisegred_nonseg_22978_runs = 0;
    ctx->testzisegred_nonseg_23728_total_runtime = 0;
    ctx->testzisegred_nonseg_23728_runs = 0;
    ctx->testzisegred_nonseg_24589_total_runtime = 0;
    ctx->testzisegred_nonseg_24589_runs = 0;
    ctx->testzisegred_small_24318_total_runtime = 0;
    ctx->testzisegred_small_24318_runs = 0;
    ctx->test2zisegmap_25036_total_runtime = 0;
    ctx->test2zisegmap_25036_runs = 0;
    ctx->test2zisegmap_25185_total_runtime = 0;
    ctx->test2zisegmap_25185_runs = 0;
    ctx->test2zisegmap_25494_total_runtime = 0;
    ctx->test2zisegmap_25494_runs = 0;
    ctx->test2zisegmap_25592_total_runtime = 0;
    ctx->test2zisegmap_25592_runs = 0;
    ctx->test2zisegmap_25656_total_runtime = 0;
    ctx->test2zisegmap_25656_runs = 0;
    ctx->test2zisegmap_25932_total_runtime = 0;
    ctx->test2zisegmap_25932_runs = 0;
    ctx->test2zisegmap_26337_total_runtime = 0;
    ctx->test2zisegmap_26337_runs = 0;
    ctx->test2zisegmap_intragroup_25930_total_runtime = 0;
    ctx->test2zisegmap_intragroup_25930_runs = 0;
    ctx->test2zisegred_large_26372_total_runtime = 0;
    ctx->test2zisegred_large_26372_runs = 0;
    ctx->test2zisegred_nonseg_25032_total_runtime = 0;
    ctx->test2zisegred_nonseg_25032_runs = 0;
    ctx->test2zisegred_nonseg_25782_total_runtime = 0;
    ctx->test2zisegred_nonseg_25782_runs = 0;
    ctx->test2zisegred_nonseg_26643_total_runtime = 0;
    ctx->test2zisegred_nonseg_26643_runs = 0;
    ctx->test2zisegred_small_26372_total_runtime = 0;
    ctx->test2zisegred_small_26372_runs = 0;
}
static int init_context_late(struct futhark_context_config *cfg,
                             struct futhark_context *ctx, cl_program prog)
{
    cl_int error;
    cl_int no_error = -1;
    
    ctx->global_failure = clCreateBuffer(ctx->opencl.ctx, CL_MEM_READ_WRITE |
                                         CL_MEM_COPY_HOST_PTR, sizeof(cl_int),
                                         &no_error, &error);
    OPENCL_SUCCEED_OR_RETURN(error);
    // The +1 is to avoid zero-byte allocations.
    ctx->global_failure_args = clCreateBuffer(ctx->opencl.ctx,
                                              CL_MEM_READ_WRITE,
                                              sizeof(int64_t) * (3 + 1), NULL,
                                              &error);
    OPENCL_SUCCEED_OR_RETURN(error);
    {
        ctx->gpu_map_transpose_f32 = clCreateKernel(prog,
                                                    "gpu_map_transpose_f32",
                                                    &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "gpu_map_transpose_f32");
    }
    {
        ctx->gpu_map_transpose_f32_low_height = clCreateKernel(prog,
                                                               "gpu_map_transpose_f32_low_height",
                                                               &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "gpu_map_transpose_f32_low_height");
    }
    {
        ctx->gpu_map_transpose_f32_low_width = clCreateKernel(prog,
                                                              "gpu_map_transpose_f32_low_width",
                                                              &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "gpu_map_transpose_f32_low_width");
    }
    {
        ctx->gpu_map_transpose_f32_small = clCreateKernel(prog,
                                                          "gpu_map_transpose_f32_small",
                                                          &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "gpu_map_transpose_f32_small");
    }
    {
        ctx->mainzisegmap_20862 = clCreateKernel(prog, "mainzisegmap_20862",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_20862, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_20862, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_20862");
    }
    {
        ctx->mainzisegmap_21011 = clCreateKernel(prog, "mainzisegmap_21011",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_21011, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_21011, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_21011");
    }
    {
        ctx->mainzisegmap_21320 = clCreateKernel(prog, "mainzisegmap_21320",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_21320, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_21320, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_21320");
    }
    {
        ctx->mainzisegmap_21418 = clCreateKernel(prog, "mainzisegmap_21418",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_21418, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_21418");
    }
    {
        ctx->mainzisegmap_21482 = clCreateKernel(prog, "mainzisegmap_21482",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_21482, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_21482");
    }
    {
        ctx->mainzisegmap_21767 = clCreateKernel(prog, "mainzisegmap_21767",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_21767, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_21767, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_21767");
    }
    {
        ctx->mainzisegmap_22192 = clCreateKernel(prog, "mainzisegmap_22192",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_22192, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_22192");
    }
    {
        ctx->mainzisegmap_intragroup_21765 = clCreateKernel(prog,
                                                            "mainzisegmap_intragroup_21765",
                                                            &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                            0, sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                            2, sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "main.segmap_intragroup_21765");
    }
    {
        ctx->mainzisegred_large_22227 = clCreateKernel(prog,
                                                       "mainzisegred_large_22227",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_large_22227, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_large_22227, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_large_22227");
    }
    {
        ctx->mainzisegred_nonseg_20858 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_20858",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_20858, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_20858");
    }
    {
        ctx->mainzisegred_nonseg_21609 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_21609",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_21609, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_21609, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_21609");
    }
    {
        ctx->mainzisegred_nonseg_22513 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_22513",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_22513, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_22513");
    }
    {
        ctx->mainzisegred_small_22227 = clCreateKernel(prog,
                                                       "mainzisegred_small_22227",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_small_22227, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_small_22227, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_small_22227");
    }
    {
        ctx->testzisegmap_22982 = clCreateKernel(prog, "testzisegmap_22982",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_22982, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_22982, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_22982");
    }
    {
        ctx->testzisegmap_23131 = clCreateKernel(prog, "testzisegmap_23131",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_23131, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_23131, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_23131");
    }
    {
        ctx->testzisegmap_23440 = clCreateKernel(prog, "testzisegmap_23440",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_23440, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_23440, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_23440");
    }
    {
        ctx->testzisegmap_23538 = clCreateKernel(prog, "testzisegmap_23538",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_23538, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_23538");
    }
    {
        ctx->testzisegmap_23602 = clCreateKernel(prog, "testzisegmap_23602",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_23602, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_23602");
    }
    {
        ctx->testzisegmap_23878 = clCreateKernel(prog, "testzisegmap_23878",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_23878, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_23878, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_23878");
    }
    {
        ctx->testzisegmap_24283 = clCreateKernel(prog, "testzisegmap_24283",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_24283, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_24283");
    }
    {
        ctx->testzisegmap_intragroup_23876 = clCreateKernel(prog,
                                                            "testzisegmap_intragroup_23876",
                                                            &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_intragroup_23876,
                                            0, sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_intragroup_23876,
                                            2, sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "test.segmap_intragroup_23876");
    }
    {
        ctx->testzisegred_large_24318 = clCreateKernel(prog,
                                                       "testzisegred_large_24318",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_large_24318, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_large_24318, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_large_24318");
    }
    {
        ctx->testzisegred_nonseg_22978 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_22978",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_22978, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_22978");
    }
    {
        ctx->testzisegred_nonseg_23728 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_23728",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_23728, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_23728, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_23728");
    }
    {
        ctx->testzisegred_nonseg_24589 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_24589",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_24589, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_24589");
    }
    {
        ctx->testzisegred_small_24318 = clCreateKernel(prog,
                                                       "testzisegred_small_24318",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_small_24318, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_small_24318, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_small_24318");
    }
    {
        ctx->test2zisegmap_25036 = clCreateKernel(prog, "test2zisegmap_25036",
                                                  &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegmap_25036, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegmap_25036, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test2.segmap_25036");
    }
    {
        ctx->test2zisegmap_25185 = clCreateKernel(prog, "test2zisegmap_25185",
                                                  &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegmap_25185, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegmap_25185, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test2.segmap_25185");
    }
    {
        ctx->test2zisegmap_25494 = clCreateKernel(prog, "test2zisegmap_25494",
                                                  &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegmap_25494, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegmap_25494, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test2.segmap_25494");
    }
    {
        ctx->test2zisegmap_25592 = clCreateKernel(prog, "test2zisegmap_25592",
                                                  &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegmap_25592, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test2.segmap_25592");
    }
    {
        ctx->test2zisegmap_25656 = clCreateKernel(prog, "test2zisegmap_25656",
                                                  &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegmap_25656, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test2.segmap_25656");
    }
    {
        ctx->test2zisegmap_25932 = clCreateKernel(prog, "test2zisegmap_25932",
                                                  &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegmap_25932, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegmap_25932, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test2.segmap_25932");
    }
    {
        ctx->test2zisegmap_26337 = clCreateKernel(prog, "test2zisegmap_26337",
                                                  &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegmap_26337, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test2.segmap_26337");
    }
    {
        ctx->test2zisegmap_intragroup_25930 = clCreateKernel(prog,
                                                             "test2zisegmap_intragroup_25930",
                                                             &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegmap_intragroup_25930,
                                            0, sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegmap_intragroup_25930,
                                            2, sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "test2.segmap_intragroup_25930");
    }
    {
        ctx->test2zisegred_large_26372 = clCreateKernel(prog,
                                                        "test2zisegred_large_26372",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegred_large_26372, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegred_large_26372, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test2.segred_large_26372");
    }
    {
        ctx->test2zisegred_nonseg_25032 = clCreateKernel(prog,
                                                         "test2zisegred_nonseg_25032",
                                                         &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegred_nonseg_25032, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "test2.segred_nonseg_25032");
    }
    {
        ctx->test2zisegred_nonseg_25782 = clCreateKernel(prog,
                                                         "test2zisegred_nonseg_25782",
                                                         &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegred_nonseg_25782, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegred_nonseg_25782, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "test2.segred_nonseg_25782");
    }
    {
        ctx->test2zisegred_nonseg_26643 = clCreateKernel(prog,
                                                         "test2zisegred_nonseg_26643",
                                                         &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegred_nonseg_26643, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "test2.segred_nonseg_26643");
    }
    {
        ctx->test2zisegred_small_26372 = clCreateKernel(prog,
                                                        "test2zisegred_small_26372",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegred_small_26372, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->test2zisegred_small_26372, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test2.segred_small_26372");
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_27305.references = NULL;
        ctx->mainzicounter_mem_27305.size = 0;
        ctx->mainzicounter_mem_27305.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_27305.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_27552,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_27373.references = NULL;
        ctx->mainzicounter_mem_27373.size = 0;
        ctx->mainzicounter_mem_27373.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_27373.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_27584,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_27456.references = NULL;
        ctx->mainzicounter_mem_27456.size = 0;
        ctx->mainzicounter_mem_27456.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_27456.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_27606,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_27497.references = NULL;
        ctx->mainzicounter_mem_27497.size = 0;
        ctx->mainzicounter_mem_27497.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_27497.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_27617,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzistatic_array_27302.references = NULL;
        ctx->testzistatic_array_27302.size = 0;
        ctx->testzistatic_array_27302.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (4 > 0 ? 4 : 1) *
                                                           sizeof(float), NULL,
                                                           &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (4 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzistatic_array_27302.mem,
                                                          CL_TRUE, 0, 4 *
                                                          sizeof(float),
                                                          testzistatic_array_realtype_27625,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzistatic_array_27303.references = NULL;
        ctx->testzistatic_array_27303.size = 0;
        ctx->testzistatic_array_27303.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (4 > 0 ? 4 : 1) *
                                                           sizeof(int64_t),
                                                           NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (4 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzistatic_array_27303.mem,
                                                          CL_TRUE, 0, 4 *
                                                          sizeof(int64_t),
                                                          testzistatic_array_realtype_27626,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzistatic_array_27304.references = NULL;
        ctx->testzistatic_array_27304.size = 0;
        ctx->testzistatic_array_27304.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (4 > 0 ? 4 : 1) *
                                                           sizeof(float), NULL,
                                                           &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (4 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzistatic_array_27304.mem,
                                                          CL_TRUE, 0, 4 *
                                                          sizeof(float),
                                                          testzistatic_array_realtype_27627,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_27306.references = NULL;
        ctx->testzicounter_mem_27306.size = 0;
        ctx->testzicounter_mem_27306.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_27306.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_27628,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_27374.references = NULL;
        ctx->testzicounter_mem_27374.size = 0;
        ctx->testzicounter_mem_27374.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_27374.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_27660,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_27457.references = NULL;
        ctx->testzicounter_mem_27457.size = 0;
        ctx->testzicounter_mem_27457.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_27457.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_27682,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_27498.references = NULL;
        ctx->testzicounter_mem_27498.size = 0;
        ctx->testzicounter_mem_27498.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_27498.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_27693,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->test2zicounter_mem_27303.references = NULL;
        ctx->test2zicounter_mem_27303.size = 0;
        ctx->test2zicounter_mem_27303.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (10 > 0 ? 10 : 1) *
                                                           sizeof(int32_t),
                                                           NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->test2zicounter_mem_27303.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          test2zicounter_mem_realtype_27701,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->test2zicounter_mem_27371.references = NULL;
        ctx->test2zicounter_mem_27371.size = 0;
        ctx->test2zicounter_mem_27371.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (10 > 0 ? 10 : 1) *
                                                           sizeof(int32_t),
                                                           NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->test2zicounter_mem_27371.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          test2zicounter_mem_realtype_27733,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->test2zicounter_mem_27454.references = NULL;
        ctx->test2zicounter_mem_27454.size = 0;
        ctx->test2zicounter_mem_27454.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (10240 >
                                                            0 ? 10240 : 1) *
                                                           sizeof(int32_t),
                                                           NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->test2zicounter_mem_27454.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          test2zicounter_mem_realtype_27755,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->test2zicounter_mem_27495.references = NULL;
        ctx->test2zicounter_mem_27495.size = 0;
        ctx->test2zicounter_mem_27495.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (10 > 0 ? 10 : 1) *
                                                           sizeof(int32_t),
                                                           NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->test2zicounter_mem_27495.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          test2zicounter_mem_realtype_27766,
                                                          0, NULL, NULL));
    }
    ctx->sizes.mainzisegmap_group_sizze_20864 = cfg->sizes[0];
    ctx->sizes.mainzisegmap_group_sizze_21013 = cfg->sizes[1];
    ctx->sizes.mainzisegmap_group_sizze_21322 = cfg->sizes[2];
    ctx->sizes.mainzisegmap_group_sizze_21421 = cfg->sizes[3];
    ctx->sizes.mainzisegmap_group_sizze_21484 = cfg->sizes[4];
    ctx->sizes.mainzisegmap_group_sizze_21769 = cfg->sizes[5];
    ctx->sizes.mainzisegmap_group_sizze_22194 = cfg->sizes[6];
    ctx->sizes.mainzisegmap_num_groups_21324 = cfg->sizes[7];
    ctx->sizes.mainzisegred_group_sizze_20850 = cfg->sizes[8];
    ctx->sizes.mainzisegred_group_sizze_21600 = cfg->sizes[9];
    ctx->sizes.mainzisegred_group_sizze_22221 = cfg->sizes[10];
    ctx->sizes.mainzisegred_group_sizze_22505 = cfg->sizes[11];
    ctx->sizes.mainzisegred_num_groups_20852 = cfg->sizes[12];
    ctx->sizes.mainzisegred_num_groups_21602 = cfg->sizes[13];
    ctx->sizes.mainzisegred_num_groups_22223 = cfg->sizes[14];
    ctx->sizes.mainzisegred_num_groups_22507 = cfg->sizes[15];
    ctx->sizes.mainzisuff_intra_par_7 = cfg->sizes[16];
    ctx->sizes.mainzisuff_outer_par_0 = cfg->sizes[17];
    ctx->sizes.mainzisuff_outer_par_6 = cfg->sizes[18];
    ctx->sizes.mainzisuff_outer_redomap_5 = cfg->sizes[19];
    ctx->sizes.testzisegmap_group_sizze_22984 = cfg->sizes[20];
    ctx->sizes.testzisegmap_group_sizze_23133 = cfg->sizes[21];
    ctx->sizes.testzisegmap_group_sizze_23442 = cfg->sizes[22];
    ctx->sizes.testzisegmap_group_sizze_23541 = cfg->sizes[23];
    ctx->sizes.testzisegmap_group_sizze_23604 = cfg->sizes[24];
    ctx->sizes.testzisegmap_group_sizze_23880 = cfg->sizes[25];
    ctx->sizes.testzisegmap_group_sizze_24285 = cfg->sizes[26];
    ctx->sizes.testzisegmap_num_groups_23444 = cfg->sizes[27];
    ctx->sizes.testzisegred_group_sizze_22970 = cfg->sizes[28];
    ctx->sizes.testzisegred_group_sizze_23720 = cfg->sizes[29];
    ctx->sizes.testzisegred_group_sizze_24312 = cfg->sizes[30];
    ctx->sizes.testzisegred_group_sizze_24581 = cfg->sizes[31];
    ctx->sizes.testzisegred_num_groups_22972 = cfg->sizes[32];
    ctx->sizes.testzisegred_num_groups_23722 = cfg->sizes[33];
    ctx->sizes.testzisegred_num_groups_24314 = cfg->sizes[34];
    ctx->sizes.testzisegred_num_groups_24583 = cfg->sizes[35];
    ctx->sizes.testzisuff_intra_par_7 = cfg->sizes[36];
    ctx->sizes.testzisuff_outer_par_0 = cfg->sizes[37];
    ctx->sizes.testzisuff_outer_par_6 = cfg->sizes[38];
    ctx->sizes.testzisuff_outer_redomap_5 = cfg->sizes[39];
    ctx->sizes.test2zisegmap_group_sizze_25038 = cfg->sizes[40];
    ctx->sizes.test2zisegmap_group_sizze_25187 = cfg->sizes[41];
    ctx->sizes.test2zisegmap_group_sizze_25496 = cfg->sizes[42];
    ctx->sizes.test2zisegmap_group_sizze_25595 = cfg->sizes[43];
    ctx->sizes.test2zisegmap_group_sizze_25658 = cfg->sizes[44];
    ctx->sizes.test2zisegmap_group_sizze_25934 = cfg->sizes[45];
    ctx->sizes.test2zisegmap_group_sizze_26339 = cfg->sizes[46];
    ctx->sizes.test2zisegmap_num_groups_25498 = cfg->sizes[47];
    ctx->sizes.test2zisegred_group_sizze_25021 = cfg->sizes[48];
    ctx->sizes.test2zisegred_group_sizze_25774 = cfg->sizes[49];
    ctx->sizes.test2zisegred_group_sizze_26366 = cfg->sizes[50];
    ctx->sizes.test2zisegred_group_sizze_26635 = cfg->sizes[51];
    ctx->sizes.test2zisegred_num_groups_25023 = cfg->sizes[52];
    ctx->sizes.test2zisegred_num_groups_25776 = cfg->sizes[53];
    ctx->sizes.test2zisegred_num_groups_26368 = cfg->sizes[54];
    ctx->sizes.test2zisegred_num_groups_26637 = cfg->sizes[55];
    ctx->sizes.test2zisuff_intra_par_7 = cfg->sizes[56];
    ctx->sizes.test2zisuff_outer_par_0 = cfg->sizes[57];
    ctx->sizes.test2zisuff_outer_par_6 = cfg->sizes[58];
    ctx->sizes.test2zisuff_outer_redomap_5 = cfg->sizes[59];
    init_constants(ctx);
    // Clear the free list of any deallocations that occurred while initialising constants.
    OPENCL_SUCCEED_OR_RETURN(opencl_free_all(&ctx->opencl));
    // The program will be properly freed after all the kernels have also been freed.
    OPENCL_SUCCEED_OR_RETURN(clReleaseProgram(prog));
    return futhark_context_sync(ctx);
}
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg)
{
    struct futhark_context *ctx =
                           (struct futhark_context *) malloc(sizeof(struct futhark_context));
    
    if (ctx == NULL)
        return NULL;
    
    int required_types = 0;
    
    init_context_early(cfg, ctx);
    
    cl_program prog = setup_opencl(&ctx->opencl, opencl_program, required_types,
                                   cfg->build_opts);
    
    init_context_late(cfg, ctx, prog);
    return ctx;
}
struct futhark_context *futhark_context_new_with_command_queue(struct futhark_context_config *cfg,
                                                               cl_command_queue queue)
{
    struct futhark_context *ctx =
                           (struct futhark_context *) malloc(sizeof(struct futhark_context));
    
    if (ctx == NULL)
        return NULL;
    
    int required_types = 0;
    
    init_context_early(cfg, ctx);
    
    cl_program prog = setup_opencl_with_command_queue(&ctx->opencl, queue,
                                                      opencl_program,
                                                      required_types,
                                                      cfg->build_opts);
    
    init_context_late(cfg, ctx, prog);
    return ctx;
}
void futhark_context_free(struct futhark_context *ctx)
{
    free_constants(ctx);
    free_lock(&ctx->lock);
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32_low_height));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32_low_width));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32_small));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_20862));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_21011));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_21320));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_21418));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_21482));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_21767));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_22192));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_intragroup_21765));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_large_22227));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_20858));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_21609));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_22513));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_small_22227));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_22982));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_23131));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_23440));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_23538));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_23602));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_23878));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_24283));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_intragroup_23876));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_large_24318));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_22978));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_23728));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_24589));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_small_24318));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->test2zisegmap_25036));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->test2zisegmap_25185));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->test2zisegmap_25494));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->test2zisegmap_25592));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->test2zisegmap_25656));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->test2zisegmap_25932));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->test2zisegmap_26337));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->test2zisegmap_intragroup_25930));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->test2zisegred_large_26372));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->test2zisegred_nonseg_25032));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->test2zisegred_nonseg_25782));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->test2zisegred_nonseg_26643));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->test2zisegred_small_26372));
    teardown_opencl(&ctx->opencl);
    free(ctx);
}
int futhark_context_sync(struct futhark_context *ctx)
{
    cl_int failure_idx = -1;
    
    if (ctx->failure_is_an_option) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     ctx->global_failure,
                                                     CL_FALSE, 0,
                                                     sizeof(cl_int),
                                                     &failure_idx, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        ctx->failure_is_an_option = 0;
    }
    OPENCL_SUCCEED_OR_RETURN(clFinish(ctx->opencl.queue));
    if (failure_idx >= 0) {
        cl_int no_failure = -1;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                      ctx->global_failure,
                                                      CL_TRUE, 0,
                                                      sizeof(cl_int),
                                                      &no_failure, 0, NULL,
                                                      NULL));
        
        int64_t args[3 + 1];
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     ctx->global_failure_args,
                                                     CL_TRUE, 0, sizeof(args),
                                                     &args, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_host_runs,
                                                                                               &ctx->copy_dev_to_host_total_runtime)));
        switch (failure_idx) {
            
          case 0:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:64:29-48\n   #1  cva-map.fut:105:25-65\n   #2  cva-map.fut:120:16-62\n   #3  cva-map.fut:116:17-120:85\n   #4  cva-map.fut:111:1-152:16\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 1:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:106:47-70\n   #1  cva-map.fut:120:16-62\n   #2  cva-map.fut:116:17-120:85\n   #3  cva-map.fut:111:1-152:16\n",
                              args[0], args[1]);
                break;
            }
            
          case 2:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:64:29-48\n   #1  cva-map.fut:105:25-65\n   #2  cva-map.fut:120:16-62\n   #3  cva-map.fut:116:17-120:85\n   #4  cva-map.fut:111:1-152:16\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 3:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:106:47-70\n   #1  cva-map.fut:120:16-62\n   #2  cva-map.fut:116:17-120:85\n   #3  cva-map.fut:111:1-152:16\n",
                              args[0], args[1]);
                break;
            }
            
          case 4:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:81:97-104\n   #1  cva-map.fut:134:32-62\n   #2  cva-map.fut:134:22-69\n   #3  cva-map.fut:111:1-152:16\n",
                              args[0], args[1]);
                break;
            }
            
          case 5:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:81:58-105\n   #1  cva-map.fut:134:32-62\n   #2  cva-map.fut:134:22-69\n   #3  cva-map.fut:111:1-152:16\n",
                              args[0], args[1]);
                break;
            }
            
          case 6:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:40:30-45\n   #1  cva-map.fut:48:27-71\n   #2  cva-map.fut:141:51-76\n   #3  cva-map.fut:139:35-141:84\n   #4  /prelude/soacs.fut:56:19-23\n   #5  /prelude/soacs.fut:56:3-37\n   #6  cva-map.fut:138:25-145:33\n   #7  cva-map.fut:137:16-145:45\n   #8  cva-map.fut:111:1-152:16\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 7:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:50:38-63\n   #1  cva-map.fut:141:51-76\n   #2  cva-map.fut:139:35-141:84\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  cva-map.fut:138:25-145:33\n   #6  cva-map.fut:137:16-145:45\n   #7  cva-map.fut:111:1-152:16\n",
                              args[0], args[1]);
                break;
            }
            
          case 8:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:40:30-45\n   #1  cva-map.fut:48:27-71\n   #2  cva-map.fut:141:51-76\n   #3  cva-map.fut:139:35-141:84\n   #4  /prelude/soacs.fut:56:19-23\n   #5  /prelude/soacs.fut:56:3-37\n   #6  cva-map.fut:138:25-145:33\n   #7  cva-map.fut:137:16-145:45\n   #8  cva-map.fut:111:1-152:16\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 9:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:50:38-63\n   #1  cva-map.fut:141:51-76\n   #2  cva-map.fut:139:35-141:84\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  cva-map.fut:138:25-145:33\n   #6  cva-map.fut:137:16-145:45\n   #7  cva-map.fut:111:1-152:16\n",
                              args[0], args[1]);
                break;
            }
            
          case 10:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:40:30-45\n   #1  cva-map.fut:48:27-71\n   #2  cva-map.fut:141:51-76\n   #3  cva-map.fut:139:35-141:84\n   #4  /prelude/soacs.fut:56:19-23\n   #5  /prelude/soacs.fut:56:3-37\n   #6  cva-map.fut:138:25-145:33\n   #7  cva-map.fut:137:16-145:45\n   #8  cva-map.fut:111:1-152:16\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 11:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:50:38-63\n   #1  cva-map.fut:141:51-76\n   #2  cva-map.fut:139:35-141:84\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  cva-map.fut:138:25-145:33\n   #6  cva-map.fut:137:16-145:45\n   #7  cva-map.fut:111:1-152:16\n",
                              args[0], args[1]);
                break;
            }
            
          case 12:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:40:30-45\n   #1  cva-map.fut:48:27-71\n   #2  cva-map.fut:141:51-76\n   #3  cva-map.fut:139:35-141:84\n   #4  /prelude/soacs.fut:56:19-23\n   #5  /prelude/soacs.fut:56:3-37\n   #6  cva-map.fut:138:25-145:33\n   #7  cva-map.fut:137:16-145:45\n   #8  cva-map.fut:111:1-152:16\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 13:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:50:38-63\n   #1  cva-map.fut:141:51-76\n   #2  cva-map.fut:139:35-141:84\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  cva-map.fut:138:25-145:33\n   #6  cva-map.fut:137:16-145:45\n   #7  cva-map.fut:111:1-152:16\n",
                              args[0], args[1]);
                break;
            }
            
          case 14:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:40:30-45\n   #1  cva-map.fut:48:27-71\n   #2  cva-map.fut:141:51-76\n   #3  cva-map.fut:139:35-141:84\n   #4  /prelude/soacs.fut:56:19-23\n   #5  /prelude/soacs.fut:56:3-37\n   #6  cva-map.fut:138:25-145:33\n   #7  cva-map.fut:137:16-145:45\n   #8  cva-map.fut:111:1-152:16\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 15:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:50:38-63\n   #1  cva-map.fut:141:51-76\n   #2  cva-map.fut:139:35-141:84\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  cva-map.fut:138:25-145:33\n   #6  cva-map.fut:137:16-145:45\n   #7  cva-map.fut:111:1-152:16\n",
                              args[0], args[1]);
                break;
            }
            
          case 16:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:64:29-48\n   #1  cva-map.fut:105:25-65\n   #2  cva-map.fut:120:16-62\n   #3  cva-map.fut:116:17-120:85\n   #4  cva-map.fut:161:3-163:35\n   #5  cva-map.fut:160:1-163:43\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 17:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:106:47-70\n   #1  cva-map.fut:120:16-62\n   #2  cva-map.fut:116:17-120:85\n   #3  cva-map.fut:161:3-163:35\n   #4  cva-map.fut:160:1-163:43\n",
                              args[0], args[1]);
                break;
            }
            
          case 18:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:64:29-48\n   #1  cva-map.fut:105:25-65\n   #2  cva-map.fut:120:16-62\n   #3  cva-map.fut:116:17-120:85\n   #4  cva-map.fut:161:3-163:35\n   #5  cva-map.fut:160:1-163:43\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 19:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:106:47-70\n   #1  cva-map.fut:120:16-62\n   #2  cva-map.fut:116:17-120:85\n   #3  cva-map.fut:161:3-163:35\n   #4  cva-map.fut:160:1-163:43\n",
                              args[0], args[1]);
                break;
            }
            
          case 20:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:81:97-104\n   #1  cva-map.fut:134:32-62\n   #2  cva-map.fut:134:22-69\n   #3  cva-map.fut:161:3-163:35\n   #4  cva-map.fut:160:1-163:43\n",
                              args[0], args[1]);
                break;
            }
            
          case 21:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:81:58-105\n   #1  cva-map.fut:134:32-62\n   #2  cva-map.fut:134:22-69\n   #3  cva-map.fut:161:3-163:35\n   #4  cva-map.fut:160:1-163:43\n",
                              args[0], args[1]);
                break;
            }
            
          case 22:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:40:30-45\n   #1  cva-map.fut:48:27-71\n   #2  cva-map.fut:141:51-76\n   #3  cva-map.fut:139:35-141:84\n   #4  /prelude/soacs.fut:56:19-23\n   #5  /prelude/soacs.fut:56:3-37\n   #6  cva-map.fut:138:25-145:33\n   #7  cva-map.fut:137:16-145:45\n   #8  cva-map.fut:161:3-163:35\n   #9  cva-map.fut:160:1-163:43\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 23:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:50:38-63\n   #1  cva-map.fut:141:51-76\n   #2  cva-map.fut:139:35-141:84\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  cva-map.fut:138:25-145:33\n   #6  cva-map.fut:137:16-145:45\n   #7  cva-map.fut:161:3-163:35\n   #8  cva-map.fut:160:1-163:43\n",
                              args[0], args[1]);
                break;
            }
            
          case 24:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:40:30-45\n   #1  cva-map.fut:48:27-71\n   #2  cva-map.fut:141:51-76\n   #3  cva-map.fut:139:35-141:84\n   #4  /prelude/soacs.fut:56:19-23\n   #5  /prelude/soacs.fut:56:3-37\n   #6  cva-map.fut:138:25-145:33\n   #7  cva-map.fut:137:16-145:45\n   #8  cva-map.fut:161:3-163:35\n   #9  cva-map.fut:160:1-163:43\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 25:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:50:38-63\n   #1  cva-map.fut:141:51-76\n   #2  cva-map.fut:139:35-141:84\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  cva-map.fut:138:25-145:33\n   #6  cva-map.fut:137:16-145:45\n   #7  cva-map.fut:161:3-163:35\n   #8  cva-map.fut:160:1-163:43\n",
                              args[0], args[1]);
                break;
            }
            
          case 26:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:40:30-45\n   #1  cva-map.fut:48:27-71\n   #2  cva-map.fut:141:51-76\n   #3  cva-map.fut:139:35-141:84\n   #4  /prelude/soacs.fut:56:19-23\n   #5  /prelude/soacs.fut:56:3-37\n   #6  cva-map.fut:138:25-145:33\n   #7  cva-map.fut:137:16-145:45\n   #8  cva-map.fut:161:3-163:35\n   #9  cva-map.fut:160:1-163:43\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 27:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:50:38-63\n   #1  cva-map.fut:141:51-76\n   #2  cva-map.fut:139:35-141:84\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  cva-map.fut:138:25-145:33\n   #6  cva-map.fut:137:16-145:45\n   #7  cva-map.fut:161:3-163:35\n   #8  cva-map.fut:160:1-163:43\n",
                              args[0], args[1]);
                break;
            }
            
          case 28:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:40:30-45\n   #1  cva-map.fut:48:27-71\n   #2  cva-map.fut:141:51-76\n   #3  cva-map.fut:139:35-141:84\n   #4  /prelude/soacs.fut:56:19-23\n   #5  /prelude/soacs.fut:56:3-37\n   #6  cva-map.fut:138:25-145:33\n   #7  cva-map.fut:137:16-145:45\n   #8  cva-map.fut:161:3-163:35\n   #9  cva-map.fut:160:1-163:43\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 29:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:50:38-63\n   #1  cva-map.fut:141:51-76\n   #2  cva-map.fut:139:35-141:84\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  cva-map.fut:138:25-145:33\n   #6  cva-map.fut:137:16-145:45\n   #7  cva-map.fut:161:3-163:35\n   #8  cva-map.fut:160:1-163:43\n",
                              args[0], args[1]);
                break;
            }
            
          case 30:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:40:30-45\n   #1  cva-map.fut:48:27-71\n   #2  cva-map.fut:141:51-76\n   #3  cva-map.fut:139:35-141:84\n   #4  /prelude/soacs.fut:56:19-23\n   #5  /prelude/soacs.fut:56:3-37\n   #6  cva-map.fut:138:25-145:33\n   #7  cva-map.fut:137:16-145:45\n   #8  cva-map.fut:161:3-163:35\n   #9  cva-map.fut:160:1-163:43\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 31:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:50:38-63\n   #1  cva-map.fut:141:51-76\n   #2  cva-map.fut:139:35-141:84\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  cva-map.fut:138:25-145:33\n   #6  cva-map.fut:137:16-145:45\n   #7  cva-map.fut:161:3-163:35\n   #8  cva-map.fut:160:1-163:43\n",
                              args[0], args[1]);
                break;
            }
            
          case 32:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:64:29-48\n   #1  cva-map.fut:105:25-65\n   #2  cva-map.fut:120:16-62\n   #3  cva-map.fut:116:17-120:85\n   #4  cva-map.fut:183:8-68\n   #5  cva-map.fut:177:1-183:76\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 33:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:106:47-70\n   #1  cva-map.fut:120:16-62\n   #2  cva-map.fut:116:17-120:85\n   #3  cva-map.fut:183:8-68\n   #4  cva-map.fut:177:1-183:76\n",
                              args[0], args[1]);
                break;
            }
            
          case 34:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:64:29-48\n   #1  cva-map.fut:105:25-65\n   #2  cva-map.fut:120:16-62\n   #3  cva-map.fut:116:17-120:85\n   #4  cva-map.fut:183:8-68\n   #5  cva-map.fut:177:1-183:76\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 35:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:106:47-70\n   #1  cva-map.fut:120:16-62\n   #2  cva-map.fut:116:17-120:85\n   #3  cva-map.fut:183:8-68\n   #4  cva-map.fut:177:1-183:76\n",
                              args[0], args[1]);
                break;
            }
            
          case 36:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:81:97-104\n   #1  cva-map.fut:134:32-62\n   #2  cva-map.fut:134:22-69\n   #3  cva-map.fut:183:8-68\n   #4  cva-map.fut:177:1-183:76\n",
                              args[0], args[1]);
                break;
            }
            
          case 37:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:81:58-105\n   #1  cva-map.fut:134:32-62\n   #2  cva-map.fut:134:22-69\n   #3  cva-map.fut:183:8-68\n   #4  cva-map.fut:177:1-183:76\n",
                              args[0], args[1]);
                break;
            }
            
          case 38:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:40:30-45\n   #1  cva-map.fut:48:27-71\n   #2  cva-map.fut:141:51-76\n   #3  cva-map.fut:139:35-141:84\n   #4  /prelude/soacs.fut:56:19-23\n   #5  /prelude/soacs.fut:56:3-37\n   #6  cva-map.fut:138:25-145:33\n   #7  cva-map.fut:137:16-145:45\n   #8  cva-map.fut:183:8-68\n   #9  cva-map.fut:177:1-183:76\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 39:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:50:38-63\n   #1  cva-map.fut:141:51-76\n   #2  cva-map.fut:139:35-141:84\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  cva-map.fut:138:25-145:33\n   #6  cva-map.fut:137:16-145:45\n   #7  cva-map.fut:183:8-68\n   #8  cva-map.fut:177:1-183:76\n",
                              args[0], args[1]);
                break;
            }
            
          case 40:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:40:30-45\n   #1  cva-map.fut:48:27-71\n   #2  cva-map.fut:141:51-76\n   #3  cva-map.fut:139:35-141:84\n   #4  /prelude/soacs.fut:56:19-23\n   #5  /prelude/soacs.fut:56:3-37\n   #6  cva-map.fut:138:25-145:33\n   #7  cva-map.fut:137:16-145:45\n   #8  cva-map.fut:183:8-68\n   #9  cva-map.fut:177:1-183:76\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 41:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:50:38-63\n   #1  cva-map.fut:141:51-76\n   #2  cva-map.fut:139:35-141:84\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  cva-map.fut:138:25-145:33\n   #6  cva-map.fut:137:16-145:45\n   #7  cva-map.fut:183:8-68\n   #8  cva-map.fut:177:1-183:76\n",
                              args[0], args[1]);
                break;
            }
            
          case 42:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:40:30-45\n   #1  cva-map.fut:48:27-71\n   #2  cva-map.fut:141:51-76\n   #3  cva-map.fut:139:35-141:84\n   #4  /prelude/soacs.fut:56:19-23\n   #5  /prelude/soacs.fut:56:3-37\n   #6  cva-map.fut:138:25-145:33\n   #7  cva-map.fut:137:16-145:45\n   #8  cva-map.fut:183:8-68\n   #9  cva-map.fut:177:1-183:76\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 43:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:50:38-63\n   #1  cva-map.fut:141:51-76\n   #2  cva-map.fut:139:35-141:84\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  cva-map.fut:138:25-145:33\n   #6  cva-map.fut:137:16-145:45\n   #7  cva-map.fut:183:8-68\n   #8  cva-map.fut:177:1-183:76\n",
                              args[0], args[1]);
                break;
            }
            
          case 44:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:40:30-45\n   #1  cva-map.fut:48:27-71\n   #2  cva-map.fut:141:51-76\n   #3  cva-map.fut:139:35-141:84\n   #4  /prelude/soacs.fut:56:19-23\n   #5  /prelude/soacs.fut:56:3-37\n   #6  cva-map.fut:138:25-145:33\n   #7  cva-map.fut:137:16-145:45\n   #8  cva-map.fut:183:8-68\n   #9  cva-map.fut:177:1-183:76\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 45:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:50:38-63\n   #1  cva-map.fut:141:51-76\n   #2  cva-map.fut:139:35-141:84\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  cva-map.fut:138:25-145:33\n   #6  cva-map.fut:137:16-145:45\n   #7  cva-map.fut:183:8-68\n   #8  cva-map.fut:177:1-183:76\n",
                              args[0], args[1]);
                break;
            }
            
          case 46:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva-map.fut:40:30-45\n   #1  cva-map.fut:48:27-71\n   #2  cva-map.fut:141:51-76\n   #3  cva-map.fut:139:35-141:84\n   #4  /prelude/soacs.fut:56:19-23\n   #5  /prelude/soacs.fut:56:3-37\n   #6  cva-map.fut:138:25-145:33\n   #7  cva-map.fut:137:16-145:45\n   #8  cva-map.fut:183:8-68\n   #9  cva-map.fut:177:1-183:76\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 47:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva-map.fut:50:38-63\n   #1  cva-map.fut:141:51-76\n   #2  cva-map.fut:139:35-141:84\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  cva-map.fut:138:25-145:33\n   #6  cva-map.fut:137:16-145:45\n   #7  cva-map.fut:183:8-68\n   #8  cva-map.fut:177:1-183:76\n",
                              args[0], args[1]);
                break;
            }
        }
        return 1;
    }
    return 0;
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    ctx->error = OPENCL_SUCCEED_NONFATAL(opencl_free_all(&ctx->opencl));
    return ctx->error != NULL;
}
cl_command_queue futhark_context_get_command_queue(struct futhark_context *ctx)
{
    return ctx->opencl.queue;
}
static int memblock_unref_device(struct futhark_context *ctx,
                                 struct memblock_device *block, const
                                 char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(stderr,
                    "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n",
                    desc, block->desc, "space 'device'", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_device -= block->size;
            OPENCL_SUCCEED_OR_RETURN(opencl_free(&ctx->opencl, block->mem,
                                                 desc));
            free(block->references);
            if (ctx->detail_memory)
                fprintf(stderr,
                        "%lld bytes freed (now allocated: %lld bytes)\n",
                        (long long) block->size,
                        (long long) ctx->cur_mem_usage_device);
        }
        block->references = NULL;
    }
    return 0;
}
static int memblock_alloc_device(struct futhark_context *ctx,
                                 struct memblock_device *block, int64_t size,
                                 const char *desc)
{
    if (size < 0)
        futhark_panic(1,
                      "Negative allocation of %lld bytes attempted for %s in %s.\n",
                      (long long) size, desc, "space 'device'",
                      ctx->cur_mem_usage_device);
    
    int ret = memblock_unref_device(ctx, block, desc);
    
    ctx->cur_mem_usage_device += size;
    if (ctx->detail_memory)
        fprintf(stderr,
                "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)",
                (long long) size, desc, "space 'device'",
                (long long) ctx->cur_mem_usage_device);
    if (ctx->cur_mem_usage_device > ctx->peak_mem_usage_device) {
        ctx->peak_mem_usage_device = ctx->cur_mem_usage_device;
        if (ctx->detail_memory)
            fprintf(stderr, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(stderr, ".\n");
    OPENCL_SUCCEED_OR_RETURN(opencl_alloc(&ctx->opencl, size, desc,
                                          &block->mem));
    block->references = (int *) malloc(sizeof(int));
    *block->references = 1;
    block->size = size;
    block->desc = desc;
    return ret;
}
static int memblock_set_device(struct futhark_context *ctx,
                               struct memblock_device *lhs,
                               struct memblock_device *rhs, const
                               char *lhs_desc)
{
    int ret = memblock_unref_device(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
static int memblock_unref(struct futhark_context *ctx, struct memblock *block,
                          const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(stderr,
                    "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n",
                    desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            free(block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(stderr,
                        "%lld bytes freed (now allocated: %lld bytes)\n",
                        (long long) block->size,
                        (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
static int memblock_alloc(struct futhark_context *ctx, struct memblock *block,
                          int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1,
                      "Negative allocation of %lld bytes attempted for %s in %s.\n",
                      (long long) size, desc, "default space",
                      ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    ctx->cur_mem_usage_default += size;
    if (ctx->detail_memory)
        fprintf(stderr,
                "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)",
                (long long) size, desc, "default space",
                (long long) ctx->cur_mem_usage_default);
    if (ctx->cur_mem_usage_default > ctx->peak_mem_usage_default) {
        ctx->peak_mem_usage_default = ctx->cur_mem_usage_default;
        if (ctx->detail_memory)
            fprintf(stderr, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(stderr, ".\n");
    block->mem = (char *) malloc(size);
    block->references = (int *) malloc(sizeof(int));
    *block->references = 1;
    block->size = size;
    block->desc = desc;
    return ret;
}
static int memblock_set(struct futhark_context *ctx, struct memblock *lhs,
                        struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    struct str_builder builder;
    
    str_builder_init(&builder);
    if (ctx->detail_memory || ctx->profiling) {
        str_builder(&builder,
                    "Peak memory usage for space 'device': %lld bytes.\n",
                    (long long) ctx->peak_mem_usage_device);
        { }
    }
    if (ctx->profiling) {
        OPENCL_SUCCEED_FATAL(opencl_tally_profiling_records(&ctx->opencl));
        str_builder(&builder,
                    "copy_dev_to_dev                  ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_dev_to_dev_runs,
                    (long) ctx->copy_dev_to_dev_total_runtime /
                    (ctx->copy_dev_to_dev_runs !=
                     0 ? ctx->copy_dev_to_dev_runs : 1),
                    (long) ctx->copy_dev_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_dev_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_dev_to_dev_runs;
        str_builder(&builder,
                    "copy_dev_to_host                 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_dev_to_host_runs,
                    (long) ctx->copy_dev_to_host_total_runtime /
                    (ctx->copy_dev_to_host_runs !=
                     0 ? ctx->copy_dev_to_host_runs : 1),
                    (long) ctx->copy_dev_to_host_total_runtime);
        ctx->total_runtime += ctx->copy_dev_to_host_total_runtime;
        ctx->total_runs += ctx->copy_dev_to_host_runs;
        str_builder(&builder,
                    "copy_host_to_dev                 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_host_to_dev_runs,
                    (long) ctx->copy_host_to_dev_total_runtime /
                    (ctx->copy_host_to_dev_runs !=
                     0 ? ctx->copy_host_to_dev_runs : 1),
                    (long) ctx->copy_host_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_host_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_host_to_dev_runs;
        str_builder(&builder,
                    "copy_scalar_to_dev               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_scalar_to_dev_runs,
                    (long) ctx->copy_scalar_to_dev_total_runtime /
                    (ctx->copy_scalar_to_dev_runs !=
                     0 ? ctx->copy_scalar_to_dev_runs : 1),
                    (long) ctx->copy_scalar_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_scalar_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_scalar_to_dev_runs;
        str_builder(&builder,
                    "copy_scalar_from_dev             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_scalar_from_dev_runs,
                    (long) ctx->copy_scalar_from_dev_total_runtime /
                    (ctx->copy_scalar_from_dev_runs !=
                     0 ? ctx->copy_scalar_from_dev_runs : 1),
                    (long) ctx->copy_scalar_from_dev_total_runtime);
        ctx->total_runtime += ctx->copy_scalar_from_dev_total_runtime;
        ctx->total_runs += ctx->copy_scalar_from_dev_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_runs,
                    (long) ctx->gpu_map_transpose_f32_total_runtime /
                    (ctx->gpu_map_transpose_f32_runs !=
                     0 ? ctx->gpu_map_transpose_f32_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_total_runtime);
        ctx->total_runtime += ctx->gpu_map_transpose_f32_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32_low_height ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_low_height_runs,
                    (long) ctx->gpu_map_transpose_f32_low_height_total_runtime /
                    (ctx->gpu_map_transpose_f32_low_height_runs !=
                     0 ? ctx->gpu_map_transpose_f32_low_height_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_low_height_total_runtime);
        ctx->total_runtime +=
            ctx->gpu_map_transpose_f32_low_height_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_low_height_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32_low_width  ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_low_width_runs,
                    (long) ctx->gpu_map_transpose_f32_low_width_total_runtime /
                    (ctx->gpu_map_transpose_f32_low_width_runs !=
                     0 ? ctx->gpu_map_transpose_f32_low_width_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_low_width_total_runtime);
        ctx->total_runtime +=
            ctx->gpu_map_transpose_f32_low_width_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_low_width_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32_small      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_small_runs,
                    (long) ctx->gpu_map_transpose_f32_small_total_runtime /
                    (ctx->gpu_map_transpose_f32_small_runs !=
                     0 ? ctx->gpu_map_transpose_f32_small_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_small_total_runtime);
        ctx->total_runtime += ctx->gpu_map_transpose_f32_small_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_small_runs;
        str_builder(&builder,
                    "main.segmap_20862                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_20862_runs,
                    (long) ctx->mainzisegmap_20862_total_runtime /
                    (ctx->mainzisegmap_20862_runs !=
                     0 ? ctx->mainzisegmap_20862_runs : 1),
                    (long) ctx->mainzisegmap_20862_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_20862_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_20862_runs;
        str_builder(&builder,
                    "main.segmap_21011                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_21011_runs,
                    (long) ctx->mainzisegmap_21011_total_runtime /
                    (ctx->mainzisegmap_21011_runs !=
                     0 ? ctx->mainzisegmap_21011_runs : 1),
                    (long) ctx->mainzisegmap_21011_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_21011_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_21011_runs;
        str_builder(&builder,
                    "main.segmap_21320                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_21320_runs,
                    (long) ctx->mainzisegmap_21320_total_runtime /
                    (ctx->mainzisegmap_21320_runs !=
                     0 ? ctx->mainzisegmap_21320_runs : 1),
                    (long) ctx->mainzisegmap_21320_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_21320_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_21320_runs;
        str_builder(&builder,
                    "main.segmap_21418                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_21418_runs,
                    (long) ctx->mainzisegmap_21418_total_runtime /
                    (ctx->mainzisegmap_21418_runs !=
                     0 ? ctx->mainzisegmap_21418_runs : 1),
                    (long) ctx->mainzisegmap_21418_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_21418_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_21418_runs;
        str_builder(&builder,
                    "main.segmap_21482                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_21482_runs,
                    (long) ctx->mainzisegmap_21482_total_runtime /
                    (ctx->mainzisegmap_21482_runs !=
                     0 ? ctx->mainzisegmap_21482_runs : 1),
                    (long) ctx->mainzisegmap_21482_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_21482_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_21482_runs;
        str_builder(&builder,
                    "main.segmap_21767                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_21767_runs,
                    (long) ctx->mainzisegmap_21767_total_runtime /
                    (ctx->mainzisegmap_21767_runs !=
                     0 ? ctx->mainzisegmap_21767_runs : 1),
                    (long) ctx->mainzisegmap_21767_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_21767_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_21767_runs;
        str_builder(&builder,
                    "main.segmap_22192                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_22192_runs,
                    (long) ctx->mainzisegmap_22192_total_runtime /
                    (ctx->mainzisegmap_22192_runs !=
                     0 ? ctx->mainzisegmap_22192_runs : 1),
                    (long) ctx->mainzisegmap_22192_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_22192_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_22192_runs;
        str_builder(&builder,
                    "main.segmap_intragroup_21765     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_intragroup_21765_runs,
                    (long) ctx->mainzisegmap_intragroup_21765_total_runtime /
                    (ctx->mainzisegmap_intragroup_21765_runs !=
                     0 ? ctx->mainzisegmap_intragroup_21765_runs : 1),
                    (long) ctx->mainzisegmap_intragroup_21765_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_intragroup_21765_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_intragroup_21765_runs;
        str_builder(&builder,
                    "main.segred_large_22227          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_large_22227_runs,
                    (long) ctx->mainzisegred_large_22227_total_runtime /
                    (ctx->mainzisegred_large_22227_runs !=
                     0 ? ctx->mainzisegred_large_22227_runs : 1),
                    (long) ctx->mainzisegred_large_22227_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_large_22227_total_runtime;
        ctx->total_runs += ctx->mainzisegred_large_22227_runs;
        str_builder(&builder,
                    "main.segred_nonseg_20858         ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_20858_runs,
                    (long) ctx->mainzisegred_nonseg_20858_total_runtime /
                    (ctx->mainzisegred_nonseg_20858_runs !=
                     0 ? ctx->mainzisegred_nonseg_20858_runs : 1),
                    (long) ctx->mainzisegred_nonseg_20858_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_20858_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_20858_runs;
        str_builder(&builder,
                    "main.segred_nonseg_21609         ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_21609_runs,
                    (long) ctx->mainzisegred_nonseg_21609_total_runtime /
                    (ctx->mainzisegred_nonseg_21609_runs !=
                     0 ? ctx->mainzisegred_nonseg_21609_runs : 1),
                    (long) ctx->mainzisegred_nonseg_21609_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_21609_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_21609_runs;
        str_builder(&builder,
                    "main.segred_nonseg_22513         ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_22513_runs,
                    (long) ctx->mainzisegred_nonseg_22513_total_runtime /
                    (ctx->mainzisegred_nonseg_22513_runs !=
                     0 ? ctx->mainzisegred_nonseg_22513_runs : 1),
                    (long) ctx->mainzisegred_nonseg_22513_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_22513_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_22513_runs;
        str_builder(&builder,
                    "main.segred_small_22227          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_small_22227_runs,
                    (long) ctx->mainzisegred_small_22227_total_runtime /
                    (ctx->mainzisegred_small_22227_runs !=
                     0 ? ctx->mainzisegred_small_22227_runs : 1),
                    (long) ctx->mainzisegred_small_22227_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_small_22227_total_runtime;
        ctx->total_runs += ctx->mainzisegred_small_22227_runs;
        str_builder(&builder,
                    "test.segmap_22982                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_22982_runs,
                    (long) ctx->testzisegmap_22982_total_runtime /
                    (ctx->testzisegmap_22982_runs !=
                     0 ? ctx->testzisegmap_22982_runs : 1),
                    (long) ctx->testzisegmap_22982_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_22982_total_runtime;
        ctx->total_runs += ctx->testzisegmap_22982_runs;
        str_builder(&builder,
                    "test.segmap_23131                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_23131_runs,
                    (long) ctx->testzisegmap_23131_total_runtime /
                    (ctx->testzisegmap_23131_runs !=
                     0 ? ctx->testzisegmap_23131_runs : 1),
                    (long) ctx->testzisegmap_23131_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_23131_total_runtime;
        ctx->total_runs += ctx->testzisegmap_23131_runs;
        str_builder(&builder,
                    "test.segmap_23440                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_23440_runs,
                    (long) ctx->testzisegmap_23440_total_runtime /
                    (ctx->testzisegmap_23440_runs !=
                     0 ? ctx->testzisegmap_23440_runs : 1),
                    (long) ctx->testzisegmap_23440_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_23440_total_runtime;
        ctx->total_runs += ctx->testzisegmap_23440_runs;
        str_builder(&builder,
                    "test.segmap_23538                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_23538_runs,
                    (long) ctx->testzisegmap_23538_total_runtime /
                    (ctx->testzisegmap_23538_runs !=
                     0 ? ctx->testzisegmap_23538_runs : 1),
                    (long) ctx->testzisegmap_23538_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_23538_total_runtime;
        ctx->total_runs += ctx->testzisegmap_23538_runs;
        str_builder(&builder,
                    "test.segmap_23602                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_23602_runs,
                    (long) ctx->testzisegmap_23602_total_runtime /
                    (ctx->testzisegmap_23602_runs !=
                     0 ? ctx->testzisegmap_23602_runs : 1),
                    (long) ctx->testzisegmap_23602_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_23602_total_runtime;
        ctx->total_runs += ctx->testzisegmap_23602_runs;
        str_builder(&builder,
                    "test.segmap_23878                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_23878_runs,
                    (long) ctx->testzisegmap_23878_total_runtime /
                    (ctx->testzisegmap_23878_runs !=
                     0 ? ctx->testzisegmap_23878_runs : 1),
                    (long) ctx->testzisegmap_23878_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_23878_total_runtime;
        ctx->total_runs += ctx->testzisegmap_23878_runs;
        str_builder(&builder,
                    "test.segmap_24283                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_24283_runs,
                    (long) ctx->testzisegmap_24283_total_runtime /
                    (ctx->testzisegmap_24283_runs !=
                     0 ? ctx->testzisegmap_24283_runs : 1),
                    (long) ctx->testzisegmap_24283_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_24283_total_runtime;
        ctx->total_runs += ctx->testzisegmap_24283_runs;
        str_builder(&builder,
                    "test.segmap_intragroup_23876     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_intragroup_23876_runs,
                    (long) ctx->testzisegmap_intragroup_23876_total_runtime /
                    (ctx->testzisegmap_intragroup_23876_runs !=
                     0 ? ctx->testzisegmap_intragroup_23876_runs : 1),
                    (long) ctx->testzisegmap_intragroup_23876_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_intragroup_23876_total_runtime;
        ctx->total_runs += ctx->testzisegmap_intragroup_23876_runs;
        str_builder(&builder,
                    "test.segred_large_24318          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_large_24318_runs,
                    (long) ctx->testzisegred_large_24318_total_runtime /
                    (ctx->testzisegred_large_24318_runs !=
                     0 ? ctx->testzisegred_large_24318_runs : 1),
                    (long) ctx->testzisegred_large_24318_total_runtime);
        ctx->total_runtime += ctx->testzisegred_large_24318_total_runtime;
        ctx->total_runs += ctx->testzisegred_large_24318_runs;
        str_builder(&builder,
                    "test.segred_nonseg_22978         ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_22978_runs,
                    (long) ctx->testzisegred_nonseg_22978_total_runtime /
                    (ctx->testzisegred_nonseg_22978_runs !=
                     0 ? ctx->testzisegred_nonseg_22978_runs : 1),
                    (long) ctx->testzisegred_nonseg_22978_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_22978_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_22978_runs;
        str_builder(&builder,
                    "test.segred_nonseg_23728         ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_23728_runs,
                    (long) ctx->testzisegred_nonseg_23728_total_runtime /
                    (ctx->testzisegred_nonseg_23728_runs !=
                     0 ? ctx->testzisegred_nonseg_23728_runs : 1),
                    (long) ctx->testzisegred_nonseg_23728_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_23728_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_23728_runs;
        str_builder(&builder,
                    "test.segred_nonseg_24589         ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_24589_runs,
                    (long) ctx->testzisegred_nonseg_24589_total_runtime /
                    (ctx->testzisegred_nonseg_24589_runs !=
                     0 ? ctx->testzisegred_nonseg_24589_runs : 1),
                    (long) ctx->testzisegred_nonseg_24589_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_24589_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_24589_runs;
        str_builder(&builder,
                    "test.segred_small_24318          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_small_24318_runs,
                    (long) ctx->testzisegred_small_24318_total_runtime /
                    (ctx->testzisegred_small_24318_runs !=
                     0 ? ctx->testzisegred_small_24318_runs : 1),
                    (long) ctx->testzisegred_small_24318_total_runtime);
        ctx->total_runtime += ctx->testzisegred_small_24318_total_runtime;
        ctx->total_runs += ctx->testzisegred_small_24318_runs;
        str_builder(&builder,
                    "test2.segmap_25036               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test2zisegmap_25036_runs,
                    (long) ctx->test2zisegmap_25036_total_runtime /
                    (ctx->test2zisegmap_25036_runs !=
                     0 ? ctx->test2zisegmap_25036_runs : 1),
                    (long) ctx->test2zisegmap_25036_total_runtime);
        ctx->total_runtime += ctx->test2zisegmap_25036_total_runtime;
        ctx->total_runs += ctx->test2zisegmap_25036_runs;
        str_builder(&builder,
                    "test2.segmap_25185               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test2zisegmap_25185_runs,
                    (long) ctx->test2zisegmap_25185_total_runtime /
                    (ctx->test2zisegmap_25185_runs !=
                     0 ? ctx->test2zisegmap_25185_runs : 1),
                    (long) ctx->test2zisegmap_25185_total_runtime);
        ctx->total_runtime += ctx->test2zisegmap_25185_total_runtime;
        ctx->total_runs += ctx->test2zisegmap_25185_runs;
        str_builder(&builder,
                    "test2.segmap_25494               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test2zisegmap_25494_runs,
                    (long) ctx->test2zisegmap_25494_total_runtime /
                    (ctx->test2zisegmap_25494_runs !=
                     0 ? ctx->test2zisegmap_25494_runs : 1),
                    (long) ctx->test2zisegmap_25494_total_runtime);
        ctx->total_runtime += ctx->test2zisegmap_25494_total_runtime;
        ctx->total_runs += ctx->test2zisegmap_25494_runs;
        str_builder(&builder,
                    "test2.segmap_25592               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test2zisegmap_25592_runs,
                    (long) ctx->test2zisegmap_25592_total_runtime /
                    (ctx->test2zisegmap_25592_runs !=
                     0 ? ctx->test2zisegmap_25592_runs : 1),
                    (long) ctx->test2zisegmap_25592_total_runtime);
        ctx->total_runtime += ctx->test2zisegmap_25592_total_runtime;
        ctx->total_runs += ctx->test2zisegmap_25592_runs;
        str_builder(&builder,
                    "test2.segmap_25656               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test2zisegmap_25656_runs,
                    (long) ctx->test2zisegmap_25656_total_runtime /
                    (ctx->test2zisegmap_25656_runs !=
                     0 ? ctx->test2zisegmap_25656_runs : 1),
                    (long) ctx->test2zisegmap_25656_total_runtime);
        ctx->total_runtime += ctx->test2zisegmap_25656_total_runtime;
        ctx->total_runs += ctx->test2zisegmap_25656_runs;
        str_builder(&builder,
                    "test2.segmap_25932               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test2zisegmap_25932_runs,
                    (long) ctx->test2zisegmap_25932_total_runtime /
                    (ctx->test2zisegmap_25932_runs !=
                     0 ? ctx->test2zisegmap_25932_runs : 1),
                    (long) ctx->test2zisegmap_25932_total_runtime);
        ctx->total_runtime += ctx->test2zisegmap_25932_total_runtime;
        ctx->total_runs += ctx->test2zisegmap_25932_runs;
        str_builder(&builder,
                    "test2.segmap_26337               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test2zisegmap_26337_runs,
                    (long) ctx->test2zisegmap_26337_total_runtime /
                    (ctx->test2zisegmap_26337_runs !=
                     0 ? ctx->test2zisegmap_26337_runs : 1),
                    (long) ctx->test2zisegmap_26337_total_runtime);
        ctx->total_runtime += ctx->test2zisegmap_26337_total_runtime;
        ctx->total_runs += ctx->test2zisegmap_26337_runs;
        str_builder(&builder,
                    "test2.segmap_intragroup_25930    ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test2zisegmap_intragroup_25930_runs,
                    (long) ctx->test2zisegmap_intragroup_25930_total_runtime /
                    (ctx->test2zisegmap_intragroup_25930_runs !=
                     0 ? ctx->test2zisegmap_intragroup_25930_runs : 1),
                    (long) ctx->test2zisegmap_intragroup_25930_total_runtime);
        ctx->total_runtime += ctx->test2zisegmap_intragroup_25930_total_runtime;
        ctx->total_runs += ctx->test2zisegmap_intragroup_25930_runs;
        str_builder(&builder,
                    "test2.segred_large_26372         ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test2zisegred_large_26372_runs,
                    (long) ctx->test2zisegred_large_26372_total_runtime /
                    (ctx->test2zisegred_large_26372_runs !=
                     0 ? ctx->test2zisegred_large_26372_runs : 1),
                    (long) ctx->test2zisegred_large_26372_total_runtime);
        ctx->total_runtime += ctx->test2zisegred_large_26372_total_runtime;
        ctx->total_runs += ctx->test2zisegred_large_26372_runs;
        str_builder(&builder,
                    "test2.segred_nonseg_25032        ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test2zisegred_nonseg_25032_runs,
                    (long) ctx->test2zisegred_nonseg_25032_total_runtime /
                    (ctx->test2zisegred_nonseg_25032_runs !=
                     0 ? ctx->test2zisegred_nonseg_25032_runs : 1),
                    (long) ctx->test2zisegred_nonseg_25032_total_runtime);
        ctx->total_runtime += ctx->test2zisegred_nonseg_25032_total_runtime;
        ctx->total_runs += ctx->test2zisegred_nonseg_25032_runs;
        str_builder(&builder,
                    "test2.segred_nonseg_25782        ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test2zisegred_nonseg_25782_runs,
                    (long) ctx->test2zisegred_nonseg_25782_total_runtime /
                    (ctx->test2zisegred_nonseg_25782_runs !=
                     0 ? ctx->test2zisegred_nonseg_25782_runs : 1),
                    (long) ctx->test2zisegred_nonseg_25782_total_runtime);
        ctx->total_runtime += ctx->test2zisegred_nonseg_25782_total_runtime;
        ctx->total_runs += ctx->test2zisegred_nonseg_25782_runs;
        str_builder(&builder,
                    "test2.segred_nonseg_26643        ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test2zisegred_nonseg_26643_runs,
                    (long) ctx->test2zisegred_nonseg_26643_total_runtime /
                    (ctx->test2zisegred_nonseg_26643_runs !=
                     0 ? ctx->test2zisegred_nonseg_26643_runs : 1),
                    (long) ctx->test2zisegred_nonseg_26643_total_runtime);
        ctx->total_runtime += ctx->test2zisegred_nonseg_26643_total_runtime;
        ctx->total_runs += ctx->test2zisegred_nonseg_26643_runs;
        str_builder(&builder,
                    "test2.segred_small_26372         ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->test2zisegred_small_26372_runs,
                    (long) ctx->test2zisegred_small_26372_total_runtime /
                    (ctx->test2zisegred_small_26372_runs !=
                     0 ? ctx->test2zisegred_small_26372_runs : 1),
                    (long) ctx->test2zisegred_small_26372_total_runtime);
        ctx->total_runtime += ctx->test2zisegred_small_26372_total_runtime;
        ctx->total_runs += ctx->test2zisegred_small_26372_runs;
        str_builder(&builder, "%d operations with cumulative runtime: %6ldus\n",
                    ctx->total_runs, ctx->total_runtime);
    }
    return builder.str;
}
char *futhark_context_get_error(struct futhark_context *ctx)
{
    char *error = ctx->error;
    
    ctx->error = NULL;
    return error;
}
void futhark_context_pause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 1;
}
void futhark_context_unpause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 0;
}
static int futrts_builtinzhgpu_map_transpose_f32(struct futhark_context *ctx,
                                                 struct memblock_device destmem_0,
                                                 int32_t destoffset_1,
                                                 struct memblock_device srcmem_2,
                                                 int32_t srcoffset_3,
                                                 int32_t num_arrays_4,
                                                 int32_t x_elems_5,
                                                 int32_t y_elems_6);
static int futrts_main(struct futhark_context *ctx, float *out_scalar_out_27549,
                       struct memblock_device *out_mem_p_27550,
                       int64_t *out_out_arrsizze_27551,
                       struct memblock_device swap_term_mem_27171,
                       struct memblock_device payments_mem_27172,
                       struct memblock_device notional_mem_27173,
                       int64_t n_19755, int64_t n_19756, int64_t n_19757,
                       int64_t paths_19758, int64_t steps_19759, float a_19763,
                       float b_19764, float sigma_19765, float r0_19766);
static int futrts_test(struct futhark_context *ctx, float *out_scalar_out_27624,
                       int64_t paths_20195, int64_t steps_20196);
static int futrts_test2(struct futhark_context *ctx,
                        float *out_scalar_out_27700, int64_t paths_20494,
                        int64_t steps_20495, int64_t numswaps_20496);
int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    
  cleanup:
    return err;
}
int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    return 0;
}
static int futrts_builtinzhgpu_map_transpose_f32(struct futhark_context *ctx,
                                                 struct memblock_device destmem_0,
                                                 int32_t destoffset_1,
                                                 struct memblock_device srcmem_2,
                                                 int32_t srcoffset_3,
                                                 int32_t num_arrays_4,
                                                 int32_t x_elems_5,
                                                 int32_t y_elems_6)
{
    (void) ctx;
    
    int err = 0;
    
    if (!(num_arrays_4 == 0 || (x_elems_5 == 0 || y_elems_6 == 0))) {
        int32_t muly_8 = squot32(16, x_elems_5);
        int32_t mulx_7 = squot32(16, y_elems_6);
        
        if (num_arrays_4 == 1 && (x_elems_5 == 1 || y_elems_6 == 1)) {
            if (sext_i32_i64(x_elems_5 * y_elems_6 * (int32_t) sizeof(float)) >
                0) {
                OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                             srcmem_2.mem,
                                                             destmem_0.mem,
                                                             sext_i32_i64(srcoffset_3),
                                                             sext_i32_i64(destoffset_1),
                                                             sext_i32_i64(x_elems_5 *
                                                             y_elems_6 *
                                                             (int32_t) sizeof(float)),
                                                             0, NULL,
                                                             ctx->profiling_paused ||
                                                             !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                       &ctx->copy_dev_to_dev_runs,
                                                                                                       &ctx->copy_dev_to_dev_total_runtime)));
                if (ctx->debugging)
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            }
        } else {
            if (sle32(x_elems_5, 8) && slt32(16, y_elems_6)) {
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        0, 1088, NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        1, sizeof(destoffset_1),
                                                        &destoffset_1));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        2, sizeof(srcoffset_3),
                                                        &srcoffset_3));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        3, sizeof(num_arrays_4),
                                                        &num_arrays_4));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        4, sizeof(x_elems_5),
                                                        &x_elems_5));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        5, sizeof(y_elems_6),
                                                        &y_elems_6));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        6, sizeof(mulx_7),
                                                        &mulx_7));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        7, sizeof(muly_8),
                                                        &muly_8));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        8,
                                                        sizeof(destmem_0.mem),
                                                        &destmem_0.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        9, sizeof(srcmem_2.mem),
                                                        &srcmem_2.mem));
                if (1 * ((size_t) sdiv_up32(x_elems_5, 16) * (size_t) 16) *
                    ((size_t) sdiv_up32(sdiv_up32(y_elems_6, muly_8), 16) *
                     (size_t) 16) * ((size_t) num_arrays_4 * (size_t) 1) != 0) {
                    const size_t global_work_sizze_27529[3] =
                                 {(size_t) sdiv_up32(x_elems_5, 16) *
                                  (size_t) 16,
                                  (size_t) sdiv_up32(sdiv_up32(y_elems_6,
                                                               muly_8), 16) *
                                  (size_t) 16, (size_t) num_arrays_4 *
                                  (size_t) 1};
                    const size_t local_work_sizze_27533[3] = {16, 16, 1};
                    int64_t time_start_27530 = 0, time_end_27531 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "gpu_map_transpose_f32_low_width");
                        fprintf(stderr, "%zu", global_work_sizze_27529[0]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", global_work_sizze_27529[1]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", global_work_sizze_27529[2]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_27533[0]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", local_work_sizze_27533[1]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", local_work_sizze_27533[2]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + 1088));
                        time_start_27530 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->gpu_map_transpose_f32_low_width,
                                                                    3, NULL,
                                                                    global_work_sizze_27529,
                                                                    local_work_sizze_27533,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->gpu_map_transpose_f32_low_width_runs,
                                                                                                              &ctx->gpu_map_transpose_f32_low_width_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_27531 = get_wall_time();
                        
                        long time_diff_27532 = time_end_27531 -
                             time_start_27530;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "gpu_map_transpose_f32_low_width",
                                time_diff_27532);
                    }
                }
            } else {
                if (sle32(y_elems_6, 8) && slt32(16, x_elems_5)) {
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            0, 1088, NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            1,
                                                            sizeof(destoffset_1),
                                                            &destoffset_1));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            2,
                                                            sizeof(srcoffset_3),
                                                            &srcoffset_3));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            3,
                                                            sizeof(num_arrays_4),
                                                            &num_arrays_4));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            4,
                                                            sizeof(x_elems_5),
                                                            &x_elems_5));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            5,
                                                            sizeof(y_elems_6),
                                                            &y_elems_6));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            6, sizeof(mulx_7),
                                                            &mulx_7));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            7, sizeof(muly_8),
                                                            &muly_8));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            8,
                                                            sizeof(destmem_0.mem),
                                                            &destmem_0.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            9,
                                                            sizeof(srcmem_2.mem),
                                                            &srcmem_2.mem));
                    if (1 * ((size_t) sdiv_up32(sdiv_up32(x_elems_5, mulx_7),
                                                16) * (size_t) 16) *
                        ((size_t) sdiv_up32(y_elems_6, 16) * (size_t) 16) *
                        ((size_t) num_arrays_4 * (size_t) 1) != 0) {
                        const size_t global_work_sizze_27534[3] =
                                     {(size_t) sdiv_up32(sdiv_up32(x_elems_5,
                                                                   mulx_7),
                                                         16) * (size_t) 16,
                                      (size_t) sdiv_up32(y_elems_6, 16) *
                                      (size_t) 16, (size_t) num_arrays_4 *
                                      (size_t) 1};
                        const size_t local_work_sizze_27538[3] = {16, 16, 1};
                        int64_t time_start_27535 = 0, time_end_27536 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "gpu_map_transpose_f32_low_height");
                            fprintf(stderr, "%zu", global_work_sizze_27534[0]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", global_work_sizze_27534[1]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", global_work_sizze_27534[2]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_27538[0]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", local_work_sizze_27538[1]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", local_work_sizze_27538[2]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + 1088));
                            time_start_27535 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->gpu_map_transpose_f32_low_height,
                                                                        3, NULL,
                                                                        global_work_sizze_27534,
                                                                        local_work_sizze_27538,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->gpu_map_transpose_f32_low_height_runs,
                                                                                                                  &ctx->gpu_map_transpose_f32_low_height_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_27536 = get_wall_time();
                            
                            long time_diff_27537 = time_end_27536 -
                                 time_start_27535;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "gpu_map_transpose_f32_low_height",
                                    time_diff_27537);
                        }
                    }
                } else {
                    if (sle32(x_elems_5, 8) && sle32(y_elems_6, 8)) {
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                0, 1, NULL));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                1,
                                                                sizeof(destoffset_1),
                                                                &destoffset_1));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                2,
                                                                sizeof(srcoffset_3),
                                                                &srcoffset_3));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                3,
                                                                sizeof(num_arrays_4),
                                                                &num_arrays_4));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                4,
                                                                sizeof(x_elems_5),
                                                                &x_elems_5));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                5,
                                                                sizeof(y_elems_6),
                                                                &y_elems_6));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                6,
                                                                sizeof(mulx_7),
                                                                &mulx_7));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                7,
                                                                sizeof(muly_8),
                                                                &muly_8));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                8,
                                                                sizeof(destmem_0.mem),
                                                                &destmem_0.mem));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                9,
                                                                sizeof(srcmem_2.mem),
                                                                &srcmem_2.mem));
                        if (1 * ((size_t) sdiv_up32(num_arrays_4 * x_elems_5 *
                                                    y_elems_6, 256) *
                                 (size_t) 256) != 0) {
                            const size_t global_work_sizze_27539[1] =
                                         {(size_t) sdiv_up32(num_arrays_4 *
                                                             x_elems_5 *
                                                             y_elems_6, 256) *
                                         (size_t) 256};
                            const size_t local_work_sizze_27543[1] = {256};
                            int64_t time_start_27540 = 0, time_end_27541 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(stderr,
                                        "Launching %s with global work size [",
                                        "gpu_map_transpose_f32_small");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_27539[0]);
                                fprintf(stderr, "] and local work size [");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_27543[0]);
                                fprintf(stderr,
                                        "]; local memory parameters sum to %d bytes.\n",
                                        (int) (0 + 1));
                                time_start_27540 = get_wall_time();
                            }
                            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                            ctx->gpu_map_transpose_f32_small,
                                                                            1,
                                                                            NULL,
                                                                            global_work_sizze_27539,
                                                                            local_work_sizze_27543,
                                                                            0,
                                                                            NULL,
                                                                            ctx->profiling_paused ||
                                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                      &ctx->gpu_map_transpose_f32_small_runs,
                                                                                                                      &ctx->gpu_map_transpose_f32_small_total_runtime)));
                            if (ctx->debugging) {
                                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                                time_end_27541 = get_wall_time();
                                
                                long time_diff_27542 = time_end_27541 -
                                     time_start_27540;
                                
                                fprintf(stderr, "kernel %s runtime: %ldus\n",
                                        "gpu_map_transpose_f32_small",
                                        time_diff_27542);
                            }
                        }
                    } else {
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                0, 4224, NULL));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                1,
                                                                sizeof(destoffset_1),
                                                                &destoffset_1));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                2,
                                                                sizeof(srcoffset_3),
                                                                &srcoffset_3));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                3,
                                                                sizeof(num_arrays_4),
                                                                &num_arrays_4));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                4,
                                                                sizeof(x_elems_5),
                                                                &x_elems_5));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                5,
                                                                sizeof(y_elems_6),
                                                                &y_elems_6));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                6,
                                                                sizeof(mulx_7),
                                                                &mulx_7));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                7,
                                                                sizeof(muly_8),
                                                                &muly_8));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                8,
                                                                sizeof(destmem_0.mem),
                                                                &destmem_0.mem));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                9,
                                                                sizeof(srcmem_2.mem),
                                                                &srcmem_2.mem));
                        if (1 * ((size_t) sdiv_up32(x_elems_5, 32) *
                                 (size_t) 32) * ((size_t) sdiv_up32(y_elems_6,
                                                                    32) *
                                                 (size_t) 8) *
                            ((size_t) num_arrays_4 * (size_t) 1) != 0) {
                            const size_t global_work_sizze_27544[3] =
                                         {(size_t) sdiv_up32(x_elems_5, 32) *
                                          (size_t) 32,
                                          (size_t) sdiv_up32(y_elems_6, 32) *
                                          (size_t) 8, (size_t) num_arrays_4 *
                                          (size_t) 1};
                            const size_t local_work_sizze_27548[3] = {32, 8, 1};
                            int64_t time_start_27545 = 0, time_end_27546 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(stderr,
                                        "Launching %s with global work size [",
                                        "gpu_map_transpose_f32");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_27544[0]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_27544[1]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_27544[2]);
                                fprintf(stderr, "] and local work size [");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_27548[0]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_27548[1]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_27548[2]);
                                fprintf(stderr,
                                        "]; local memory parameters sum to %d bytes.\n",
                                        (int) (0 + 4224));
                                time_start_27545 = get_wall_time();
                            }
                            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                            ctx->gpu_map_transpose_f32,
                                                                            3,
                                                                            NULL,
                                                                            global_work_sizze_27544,
                                                                            local_work_sizze_27548,
                                                                            0,
                                                                            NULL,
                                                                            ctx->profiling_paused ||
                                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                      &ctx->gpu_map_transpose_f32_runs,
                                                                                                                      &ctx->gpu_map_transpose_f32_total_runtime)));
                            if (ctx->debugging) {
                                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                                time_end_27546 = get_wall_time();
                                
                                long time_diff_27547 = time_end_27546 -
                                     time_start_27545;
                                
                                fprintf(stderr, "kernel %s runtime: %ldus\n",
                                        "gpu_map_transpose_f32",
                                        time_diff_27547);
                            }
                        }
                    }
                }
            }
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_main(struct futhark_context *ctx, float *out_scalar_out_27549,
                       struct memblock_device *out_mem_p_27550,
                       int64_t *out_out_arrsizze_27551,
                       struct memblock_device swap_term_mem_27171,
                       struct memblock_device payments_mem_27172,
                       struct memblock_device notional_mem_27173,
                       int64_t n_19755, int64_t n_19756, int64_t n_19757,
                       int64_t paths_19758, int64_t steps_19759, float a_19763,
                       float b_19764, float sigma_19765, float r0_19766)
{
    (void) ctx;
    
    int err = 0;
    float scalar_out_27301;
    struct memblock_device out_mem_27302;
    
    out_mem_27302.references = NULL;
    
    int64_t out_arrsizze_27303;
    bool dim_match_19767 = n_19755 == n_19756;
    bool empty_or_match_cert_19768;
    
    if (!dim_match_19767) {
        ctx->error = msgprintf("Error: %s\n\nBacktrace:\n%s",
                               "function arguments of wrong shape",
                               "-> #0  cva-map.fut:111:1-152:16\n");
        if (memblock_unref_device(ctx, &out_mem_27302, "out_mem_27302") != 0)
            return 1;
        return 1;
    }
    
    int64_t segred_group_sizze_20851;
    
    segred_group_sizze_20851 = ctx->sizes.mainzisegred_group_sizze_20850;
    
    int64_t num_groups_20853;
    int32_t max_num_groups_27304;
    
    max_num_groups_27304 = ctx->sizes.mainzisegred_num_groups_20852;
    num_groups_20853 = sext_i64_i32(smax64(1, smin64(sdiv_up64(n_19755,
                                                               sext_i32_i64(segred_group_sizze_20851)),
                                                     sext_i32_i64(max_num_groups_27304))));
    
    struct memblock_device mem_27176;
    
    mem_27176.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27176, 4, "mem_27176")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mainzicounter_mem_27305 =
                           ctx->mainzicounter_mem_27305;
    struct memblock_device group_res_arr_mem_27307;
    
    group_res_arr_mem_27307.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_27307,
                              (int32_t) sizeof(float) *
                              (segred_group_sizze_20851 * num_groups_20853),
                              "group_res_arr_mem_27307")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_27309;
    
    num_threads_27309 = num_groups_20853 * segred_group_sizze_20851;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_20858, 1,
                                            (int32_t) sizeof(float) *
                                            segred_group_sizze_20851, NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_20858, 2,
                                            (int32_t) sizeof(bool), NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_20858, 3,
                                            sizeof(n_19755), &n_19755));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_20858, 4,
                                            sizeof(num_groups_20853),
                                            &num_groups_20853));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_20858, 5,
                                            sizeof(swap_term_mem_27171.mem),
                                            &swap_term_mem_27171.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_20858, 6,
                                            sizeof(payments_mem_27172.mem),
                                            &payments_mem_27172.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_20858, 7,
                                            sizeof(mem_27176.mem),
                                            &mem_27176.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_20858, 8,
                                            sizeof(mainzicounter_mem_27305.mem),
                                            &mainzicounter_mem_27305.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_20858, 9,
                                            sizeof(group_res_arr_mem_27307.mem),
                                            &group_res_arr_mem_27307.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_20858, 10,
                                            sizeof(num_threads_27309),
                                            &num_threads_27309));
    if (1 * ((size_t) num_groups_20853 * (size_t) segred_group_sizze_20851) !=
        0) {
        const size_t global_work_sizze_27553[1] = {(size_t) num_groups_20853 *
                     (size_t) segred_group_sizze_20851};
        const size_t local_work_sizze_27557[1] = {segred_group_sizze_20851};
        int64_t time_start_27554 = 0, time_end_27555 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segred_nonseg_20858");
            fprintf(stderr, "%zu", global_work_sizze_27553[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_27557[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) (0 + (int32_t) sizeof(float) *
                           segred_group_sizze_20851 + (int32_t) sizeof(bool)));
            time_start_27554 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegred_nonseg_20858,
                                                        1, NULL,
                                                        global_work_sizze_27553,
                                                        local_work_sizze_27557,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegred_nonseg_20858_runs,
                                                                                                  &ctx->mainzisegred_nonseg_20858_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_27555 = get_wall_time();
            
            long time_diff_27556 = time_end_27555 - time_start_27554;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "main.segred_nonseg_20858", time_diff_27556);
        }
    }
    
    float read_res_27558;
    
    OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                 mem_27176.mem,
                                                 ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                 0 * sizeof(float),
                                                 sizeof(float), &read_res_27558,
                                                 0, NULL,
                                                 ctx->profiling_paused ||
                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                           &ctx->copy_scalar_from_dev_runs,
                                                                                           &ctx->copy_scalar_from_dev_total_runtime)));
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
        return 1;
    
    float res_19772 = read_res_27558;
    
    if (memblock_unref_device(ctx, &mem_27176, "mem_27176") != 0)
        return 1;
    
    float res_19780 = sitofp_i64_f32(steps_19759);
    float dt_19781 = res_19772 / res_19780;
    float x_19783 = fpow32(a_19763, 2.0F);
    float x_19784 = b_19764 * x_19783;
    float x_19785 = fpow32(sigma_19765, 2.0F);
    float y_19786 = x_19785 / 2.0F;
    float y_19787 = x_19784 - y_19786;
    float y_19788 = 4.0F * a_19763;
    bool suff_outer_par_20860;
    
    suff_outer_par_20860 = ctx->sizes.mainzisuff_outer_par_0 <= n_19755;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_outer_par_0",
                n_19755);
    
    int64_t segmap_group_sizze_20928;
    
    segmap_group_sizze_20928 = ctx->sizes.mainzisegmap_group_sizze_20864;
    
    int64_t segmap_group_sizze_21077;
    
    segmap_group_sizze_21077 = ctx->sizes.mainzisegmap_group_sizze_21013;
    
    int64_t bytes_27177 = 4 * n_19755;
    int64_t bytes_27179 = 8 * n_19755;
    struct memblock_device res_mem_27195;
    
    res_mem_27195.references = NULL;
    
    struct memblock_device res_mem_27196;
    
    res_mem_27196.references = NULL;
    
    struct memblock_device res_mem_27197;
    
    res_mem_27197.references = NULL;
    
    struct memblock_device res_mem_27198;
    
    res_mem_27198.references = NULL;
    
    int32_t local_memory_capacity_27347;
    
    local_memory_capacity_27347 = ctx->opencl.max_local_memory;
    if (sle64(0, sext_i32_i64(local_memory_capacity_27347)) &&
        suff_outer_par_20860) {
        int64_t segmap_usable_groups_20929 = sdiv_up64(n_19755,
                                                       segmap_group_sizze_20928);
        struct memblock_device mem_27178;
        
        mem_27178.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27178, bytes_27177, "mem_27178")) {
            err = 1;
            goto cleanup;
        }
        if (n_19755 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         swap_term_mem_27171.mem,
                                                         mem_27178.mem, 0, 0,
                                                         n_19755 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27180;
        
        mem_27180.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27180, bytes_27179, "mem_27180")) {
            err = 1;
            goto cleanup;
        }
        if (n_19755 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         payments_mem_27172.mem,
                                                         mem_27180.mem, 0, 0,
                                                         n_19755 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27182;
        
        mem_27182.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27182, bytes_27177, "mem_27182")) {
            err = 1;
            goto cleanup;
        }
        if (n_19755 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         notional_mem_27173.mem,
                                                         mem_27182.mem, 0, 0,
                                                         n_19755 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27185;
        
        mem_27185.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27185, bytes_27177, "mem_27185")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_20862, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_20862, 3,
                                                sizeof(n_19755), &n_19755));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_20862, 4,
                                                sizeof(a_19763), &a_19763));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_20862, 5,
                                                sizeof(r0_19766), &r0_19766));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_20862, 6,
                                                sizeof(x_19783), &x_19783));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_20862, 7,
                                                sizeof(x_19785), &x_19785));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_20862, 8,
                                                sizeof(y_19787), &y_19787));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_20862, 9,
                                                sizeof(y_19788), &y_19788));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_20862, 10,
                                                sizeof(swap_term_mem_27171.mem),
                                                &swap_term_mem_27171.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_20862, 11,
                                                sizeof(payments_mem_27172.mem),
                                                &payments_mem_27172.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_20862, 12,
                                                sizeof(mem_27185.mem),
                                                &mem_27185.mem));
        if (1 * ((size_t) segmap_usable_groups_20929 *
                 (size_t) segmap_group_sizze_20928) != 0) {
            const size_t global_work_sizze_27559[1] =
                         {(size_t) segmap_usable_groups_20929 *
                         (size_t) segmap_group_sizze_20928};
            const size_t local_work_sizze_27563[1] = {segmap_group_sizze_20928};
            int64_t time_start_27560 = 0, time_end_27561 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_20862");
                fprintf(stderr, "%zu", global_work_sizze_27559[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_27563[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_27560 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_20862,
                                                            1, NULL,
                                                            global_work_sizze_27559,
                                                            local_work_sizze_27563,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_20862_runs,
                                                                                                      &ctx->mainzisegmap_20862_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_27561 = get_wall_time();
                
                long time_diff_27562 = time_end_27561 - time_start_27560;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_20862", time_diff_27562);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_set_device(ctx, &res_mem_27195, &mem_27185, "mem_27185") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27196, &mem_27182, "mem_27182") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27197, &mem_27180, "mem_27180") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27198, &mem_27178, "mem_27178") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27185, "mem_27185") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27182, "mem_27182") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27180, "mem_27180") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27178, "mem_27178") != 0)
            return 1;
    } else {
        int64_t segmap_usable_groups_21078 = sdiv_up64(n_19755,
                                                       segmap_group_sizze_21077);
        struct memblock_device mem_27187;
        
        mem_27187.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27187, bytes_27177, "mem_27187")) {
            err = 1;
            goto cleanup;
        }
        if (n_19755 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         swap_term_mem_27171.mem,
                                                         mem_27187.mem, 0, 0,
                                                         n_19755 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27189;
        
        mem_27189.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27189, bytes_27179, "mem_27189")) {
            err = 1;
            goto cleanup;
        }
        if (n_19755 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         payments_mem_27172.mem,
                                                         mem_27189.mem, 0, 0,
                                                         n_19755 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27191;
        
        mem_27191.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27191, bytes_27177, "mem_27191")) {
            err = 1;
            goto cleanup;
        }
        if (n_19755 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         notional_mem_27173.mem,
                                                         mem_27191.mem, 0, 0,
                                                         n_19755 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27194;
        
        mem_27194.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27194, bytes_27177, "mem_27194")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21011, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21011, 3,
                                                sizeof(n_19755), &n_19755));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21011, 4,
                                                sizeof(a_19763), &a_19763));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21011, 5,
                                                sizeof(r0_19766), &r0_19766));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21011, 6,
                                                sizeof(x_19783), &x_19783));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21011, 7,
                                                sizeof(x_19785), &x_19785));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21011, 8,
                                                sizeof(y_19787), &y_19787));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21011, 9,
                                                sizeof(y_19788), &y_19788));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21011, 10,
                                                sizeof(swap_term_mem_27171.mem),
                                                &swap_term_mem_27171.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21011, 11,
                                                sizeof(payments_mem_27172.mem),
                                                &payments_mem_27172.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21011, 12,
                                                sizeof(mem_27194.mem),
                                                &mem_27194.mem));
        if (1 * ((size_t) segmap_usable_groups_21078 *
                 (size_t) segmap_group_sizze_21077) != 0) {
            const size_t global_work_sizze_27564[1] =
                         {(size_t) segmap_usable_groups_21078 *
                         (size_t) segmap_group_sizze_21077};
            const size_t local_work_sizze_27568[1] = {segmap_group_sizze_21077};
            int64_t time_start_27565 = 0, time_end_27566 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_21011");
                fprintf(stderr, "%zu", global_work_sizze_27564[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_27568[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_27565 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_21011,
                                                            1, NULL,
                                                            global_work_sizze_27564,
                                                            local_work_sizze_27568,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_21011_runs,
                                                                                                      &ctx->mainzisegmap_21011_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_27566 = get_wall_time();
                
                long time_diff_27567 = time_end_27566 - time_start_27565;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_21011", time_diff_27567);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_set_device(ctx, &res_mem_27195, &mem_27194, "mem_27194") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27196, &mem_27191, "mem_27191") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27197, &mem_27189, "mem_27189") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27198, &mem_27187, "mem_27187") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27194, "mem_27194") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27191, "mem_27191") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27189, "mem_27189") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27187, "mem_27187") != 0)
            return 1;
    }
    
    float sims_per_year_19853 = res_19780 / res_19772;
    bool bounds_invalid_upwards_19854 = slt64(steps_19759, 1);
    bool valid_19855 = !bounds_invalid_upwards_19854;
    bool range_valid_c_19856;
    
    if (!valid_19855) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 1, "..", 2, "...", steps_19759,
                               " is invalid.",
                               "-> #0  cva-map.fut:70:56-67\n   #1  cva-map.fut:122:17-44\n   #2  cva-map.fut:111:1-152:16\n");
        if (memblock_unref_device(ctx, &res_mem_27198, "res_mem_27198") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27197, "res_mem_27197") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27196, "res_mem_27196") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27195, "res_mem_27195") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27307,
                                  "group_res_arr_mem_27307") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27176, "mem_27176") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_27302, "out_mem_27302") != 0)
            return 1;
        return 1;
    }
    
    bool bounds_invalid_upwards_19862 = slt64(paths_19758, 0);
    bool valid_19863 = !bounds_invalid_upwards_19862;
    bool range_valid_c_19864;
    
    if (!valid_19863) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", paths_19758,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:126:11-16\n   #2  lib/github.com/diku-dk/cpprandom/random.fut:174:8-56\n   #3  cva-map.fut:125:19-49\n   #4  cva-map.fut:111:1-152:16\n");
        if (memblock_unref_device(ctx, &res_mem_27198, "res_mem_27198") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27197, "res_mem_27197") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27196, "res_mem_27196") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27195, "res_mem_27195") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27307,
                                  "group_res_arr_mem_27307") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27176, "mem_27176") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_27302, "out_mem_27302") != 0)
            return 1;
        return 1;
    }
    
    int64_t upper_bound_19867 = sub64(steps_19759, 1);
    float res_19868;
    
    res_19868 = futrts_sqrt32(dt_19781);
    
    int64_t segmap_group_sizze_21501;
    
    segmap_group_sizze_21501 = ctx->sizes.mainzisegmap_group_sizze_21484;
    
    int64_t segmap_usable_groups_21502 = sdiv_up64(paths_19758,
                                                   segmap_group_sizze_21501);
    int64_t bytes_27200 = 4 * paths_19758;
    struct memblock_device mem_27201;
    
    mem_27201.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27201, bytes_27200, "mem_27201")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21482, 1,
                                            sizeof(paths_19758), &paths_19758));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21482, 2,
                                            sizeof(mem_27201.mem),
                                            &mem_27201.mem));
    if (1 * ((size_t) segmap_usable_groups_21502 *
             (size_t) segmap_group_sizze_21501) != 0) {
        const size_t global_work_sizze_27569[1] =
                     {(size_t) segmap_usable_groups_21502 *
                     (size_t) segmap_group_sizze_21501};
        const size_t local_work_sizze_27573[1] = {segmap_group_sizze_21501};
        int64_t time_start_27570 = 0, time_end_27571 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segmap_21482");
            fprintf(stderr, "%zu", global_work_sizze_27569[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_27573[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_27570 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegmap_21482,
                                                        1, NULL,
                                                        global_work_sizze_27569,
                                                        local_work_sizze_27573,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegmap_21482_runs,
                                                                                                  &ctx->mainzisegmap_21482_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_27571 = get_wall_time();
            
            long time_diff_27572 = time_end_27571 - time_start_27570;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "main.segmap_21482",
                    time_diff_27572);
        }
    }
    
    int64_t nest_sizze_21525 = paths_19758 * steps_19759;
    int64_t segmap_group_sizze_21526;
    
    segmap_group_sizze_21526 = ctx->sizes.mainzisegmap_group_sizze_21421;
    
    int64_t segmap_usable_groups_21527 = sdiv_up64(nest_sizze_21525,
                                                   segmap_group_sizze_21526);
    int64_t bytes_27203 = 4 * nest_sizze_21525;
    struct memblock_device mem_27205;
    
    mem_27205.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27205, bytes_27203, "mem_27205")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21418, 1,
                                            sizeof(paths_19758), &paths_19758));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21418, 2,
                                            sizeof(steps_19759), &steps_19759));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21418, 3,
                                            sizeof(mem_27201.mem),
                                            &mem_27201.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21418, 4,
                                            sizeof(mem_27205.mem),
                                            &mem_27205.mem));
    if (1 * ((size_t) segmap_usable_groups_21527 *
             (size_t) segmap_group_sizze_21526) != 0) {
        const size_t global_work_sizze_27574[1] =
                     {(size_t) segmap_usable_groups_21527 *
                     (size_t) segmap_group_sizze_21526};
        const size_t local_work_sizze_27578[1] = {segmap_group_sizze_21526};
        int64_t time_start_27575 = 0, time_end_27576 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segmap_21418");
            fprintf(stderr, "%zu", global_work_sizze_27574[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_27578[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_27575 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegmap_21418,
                                                        1, NULL,
                                                        global_work_sizze_27574,
                                                        local_work_sizze_27578,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegmap_21418_runs,
                                                                                                  &ctx->mainzisegmap_21418_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_27576 = get_wall_time();
            
            long time_diff_27577 = time_end_27576 - time_start_27575;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "main.segmap_21418",
                    time_diff_27577);
        }
    }
    if (memblock_unref_device(ctx, &mem_27201, "mem_27201") != 0)
        return 1;
    
    int64_t segmap_group_sizze_21571;
    
    segmap_group_sizze_21571 = ctx->sizes.mainzisegmap_group_sizze_21322;
    
    int64_t num_groups_21572;
    int32_t max_num_groups_27358;
    
    max_num_groups_27358 = ctx->sizes.mainzisegmap_num_groups_21324;
    num_groups_21572 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_19758,
                                                               sext_i32_i64(segmap_group_sizze_21571)),
                                                     sext_i32_i64(max_num_groups_27358))));
    
    struct memblock_device mem_27208;
    
    mem_27208.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27208, bytes_27203, "mem_27208")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27208, 0, mem_27205, 0,
                                              1, steps_19759, paths_19758) !=
        0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &mem_27205, "mem_27205") != 0)
        return 1;
    
    struct memblock_device mem_27226;
    
    mem_27226.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27226, bytes_27203, "mem_27226")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_27210 = 4 * steps_19759;
    int64_t num_threads_27267 = segmap_group_sizze_21571 * num_groups_21572;
    int64_t total_sizze_27268 = bytes_27210 * num_threads_27267;
    struct memblock_device mem_27211;
    
    mem_27211.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27211, total_sizze_27268,
                              "mem_27211")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21320, 1,
                                            sizeof(ctx->failure_is_an_option),
                                            &ctx->failure_is_an_option));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21320, 3,
                                            sizeof(paths_19758), &paths_19758));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21320, 4,
                                            sizeof(steps_19759), &steps_19759));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21320, 5,
                                            sizeof(a_19763), &a_19763));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21320, 6,
                                            sizeof(b_19764), &b_19764));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21320, 7,
                                            sizeof(sigma_19765), &sigma_19765));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21320, 8,
                                            sizeof(r0_19766), &r0_19766));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21320, 9,
                                            sizeof(dt_19781), &dt_19781));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21320, 10,
                                            sizeof(upper_bound_19867),
                                            &upper_bound_19867));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21320, 11,
                                            sizeof(res_19868), &res_19868));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21320, 12,
                                            sizeof(num_groups_21572),
                                            &num_groups_21572));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21320, 13,
                                            sizeof(mem_27208.mem),
                                            &mem_27208.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21320, 14,
                                            sizeof(mem_27211.mem),
                                            &mem_27211.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21320, 15,
                                            sizeof(mem_27226.mem),
                                            &mem_27226.mem));
    if (1 * ((size_t) num_groups_21572 * (size_t) segmap_group_sizze_21571) !=
        0) {
        const size_t global_work_sizze_27579[1] = {(size_t) num_groups_21572 *
                     (size_t) segmap_group_sizze_21571};
        const size_t local_work_sizze_27583[1] = {segmap_group_sizze_21571};
        int64_t time_start_27580 = 0, time_end_27581 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segmap_21320");
            fprintf(stderr, "%zu", global_work_sizze_27579[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_27583[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_27580 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegmap_21320,
                                                        1, NULL,
                                                        global_work_sizze_27579,
                                                        local_work_sizze_27583,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegmap_21320_runs,
                                                                                                  &ctx->mainzisegmap_21320_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_27581 = get_wall_time();
            
            long time_diff_27582 = time_end_27581 - time_start_27580;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "main.segmap_21320",
                    time_diff_27582);
        }
    }
    ctx->failure_is_an_option = 1;
    if (memblock_unref_device(ctx, &mem_27208, "mem_27208") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27211, "mem_27211") != 0)
        return 1;
    
    float res_19930 = sitofp_i64_f32(paths_19758);
    bool suff_outer_redomap_21598;
    
    suff_outer_redomap_21598 = ctx->sizes.mainzisuff_outer_redomap_5 <=
        steps_19759;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_outer_redomap_5",
                steps_19759);
    
    int64_t segred_group_sizze_21611;
    
    segred_group_sizze_21611 = ctx->sizes.mainzisegred_group_sizze_21600;
    
    int64_t num_groups_21612;
    int32_t max_num_groups_27370;
    
    max_num_groups_27370 = ctx->sizes.mainzisegred_num_groups_21602;
    num_groups_21612 = sext_i64_i32(smax64(1, smin64(sdiv_up64(steps_19759,
                                                               sext_i32_i64(segred_group_sizze_21611)),
                                                     sext_i32_i64(max_num_groups_27370))));
    
    bool suff_outer_par_22515;
    
    suff_outer_par_22515 = ctx->sizes.mainzisuff_outer_par_6 <= steps_19759;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_outer_par_6",
                steps_19759);
    
    int64_t max_group_sizze_22518;
    
    max_group_sizze_22518 = ctx->opencl.max_group_size;
    
    bool fits_22519 = sle64(paths_19758, max_group_sizze_22518);
    bool suff_intra_par_22521;
    
    suff_intra_par_22521 = ctx->sizes.mainzisuff_intra_par_7 <= paths_19758;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_intra_par_7",
                paths_19758);
    
    bool intra_suff_and_fits_22522 = fits_22519 && suff_intra_par_22521;
    int64_t segmap_group_sizze_22526;
    
    segmap_group_sizze_22526 = ctx->sizes.mainzisegmap_group_sizze_21769;
    
    int64_t segred_group_sizze_22813;
    
    segred_group_sizze_22813 = ctx->sizes.mainzisegred_group_sizze_22221;
    
    int64_t num_groups_22814;
    int32_t max_num_groups_27371;
    
    max_num_groups_27371 = ctx->sizes.mainzisegred_num_groups_22223;
    num_groups_22814 = sext_i64_i32(smax64(1, smin64(sdiv_up64(nest_sizze_21525,
                                                               sext_i32_i64(segred_group_sizze_22813)),
                                                     sext_i32_i64(max_num_groups_27371))));
    
    int64_t segmap_group_sizze_22930;
    
    segmap_group_sizze_22930 = ctx->sizes.mainzisegmap_group_sizze_22194;
    
    int64_t segred_group_sizze_22958;
    
    segred_group_sizze_22958 = ctx->sizes.mainzisegred_group_sizze_22505;
    
    int64_t num_groups_22959;
    int32_t max_num_groups_27372;
    
    max_num_groups_27372 = ctx->sizes.mainzisegred_num_groups_22507;
    num_groups_22959 = sext_i64_i32(smax64(1, smin64(sdiv_up64(steps_19759,
                                                               sext_i32_i64(segred_group_sizze_22958)),
                                                     sext_i32_i64(max_num_groups_27372))));
    
    struct memblock_device res_mem_27261;
    
    res_mem_27261.references = NULL;
    
    float res_20052;
    int32_t local_memory_capacity_27527;
    
    local_memory_capacity_27527 = ctx->opencl.max_local_memory;
    if (sle64((int32_t) sizeof(bool) + (int32_t) sizeof(float) *
              segred_group_sizze_21611,
              sext_i32_i64(local_memory_capacity_27527)) &&
        suff_outer_redomap_21598) {
        struct memblock_device mem_27229;
        
        mem_27229.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27229, 4, "mem_27229")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27231;
        
        mem_27231.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27231, bytes_27210, "mem_27231")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mainzicounter_mem_27373 =
                               ctx->mainzicounter_mem_27373;
        struct memblock_device group_res_arr_mem_27375;
        
        group_res_arr_mem_27375.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_27375,
                                  (int32_t) sizeof(float) *
                                  (segred_group_sizze_21611 * num_groups_21612),
                                  "group_res_arr_mem_27375")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_27377;
        
        num_threads_27377 = num_groups_21612 * segred_group_sizze_21611;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                3, (int32_t) sizeof(float) *
                                                segred_group_sizze_21611,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                4, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                5, sizeof(n_19755), &n_19755));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                6, sizeof(paths_19758),
                                                &paths_19758));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                7, sizeof(steps_19759),
                                                &steps_19759));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                8, sizeof(a_19763), &a_19763));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                9, sizeof(b_19764), &b_19764));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                10, sizeof(sigma_19765),
                                                &sigma_19765));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                11, sizeof(x_19783), &x_19783));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                12, sizeof(x_19785), &x_19785));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                13, sizeof(y_19787), &y_19787));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                14, sizeof(y_19788), &y_19788));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                15, sizeof(sims_per_year_19853),
                                                &sims_per_year_19853));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                16, sizeof(res_19930),
                                                &res_19930));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                17, sizeof(num_groups_21612),
                                                &num_groups_21612));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                18, sizeof(res_mem_27195.mem),
                                                &res_mem_27195.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                19, sizeof(res_mem_27196.mem),
                                                &res_mem_27196.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                20, sizeof(res_mem_27197.mem),
                                                &res_mem_27197.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                21, sizeof(res_mem_27198.mem),
                                                &res_mem_27198.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                22, sizeof(mem_27226.mem),
                                                &mem_27226.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                23, sizeof(mem_27229.mem),
                                                &mem_27229.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                24, sizeof(mem_27231.mem),
                                                &mem_27231.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                25,
                                                sizeof(mainzicounter_mem_27373.mem),
                                                &mainzicounter_mem_27373.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                26,
                                                sizeof(group_res_arr_mem_27375.mem),
                                                &group_res_arr_mem_27375.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_21609,
                                                27, sizeof(num_threads_27377),
                                                &num_threads_27377));
        if (1 * ((size_t) num_groups_21612 *
                 (size_t) segred_group_sizze_21611) != 0) {
            const size_t global_work_sizze_27585[1] =
                         {(size_t) num_groups_21612 *
                         (size_t) segred_group_sizze_21611};
            const size_t local_work_sizze_27589[1] = {segred_group_sizze_21611};
            int64_t time_start_27586 = 0, time_end_27587 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segred_nonseg_21609");
                fprintf(stderr, "%zu", global_work_sizze_27585[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_27589[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(float) *
                               segred_group_sizze_21611 +
                               (int32_t) sizeof(bool)));
                time_start_27586 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegred_nonseg_21609,
                                                            1, NULL,
                                                            global_work_sizze_27585,
                                                            local_work_sizze_27589,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegred_nonseg_21609_runs,
                                                                                                      &ctx->mainzisegred_nonseg_21609_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_27587 = get_wall_time();
                
                long time_diff_27588 = time_end_27587 - time_start_27586;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segred_nonseg_21609", time_diff_27588);
            }
        }
        ctx->failure_is_an_option = 1;
        
        float read_res_27590;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27229.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(float),
                                                     sizeof(float),
                                                     &read_res_27590, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        float res_21754 = read_res_27590;
        
        if (memblock_unref_device(ctx, &mem_27229, "mem_27229") != 0)
            return 1;
        
        struct memblock_device mem_27259;
        
        mem_27259.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27259, bytes_27210, "mem_27259")) {
            err = 1;
            goto cleanup;
        }
        if (steps_19759 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27231.mem,
                                                         mem_27259.mem, 0, 0,
                                                         steps_19759 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        if (memblock_unref_device(ctx, &mem_27231, "mem_27231") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27261, &mem_27259, "mem_27259") !=
            0)
            return 1;
        res_20052 = res_21754;
        if (memblock_unref_device(ctx, &mem_27259, "mem_27259") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27375,
                                  "group_res_arr_mem_27375") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27231, "mem_27231") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27229, "mem_27229") != 0)
            return 1;
    } else {
        struct memblock_device res_map_acc_mem_27253;
        
        res_map_acc_mem_27253.references = NULL;
        
        struct memblock_device res_mem_27254;
        
        res_mem_27254.references = NULL;
        
        int32_t local_memory_capacity_27496;
        
        local_memory_capacity_27496 = ctx->opencl.max_local_memory;
        if (sle64(0, sext_i32_i64(local_memory_capacity_27496)) &&
            suff_outer_par_22515) {
            int64_t segmap_usable_groups_22527 = sdiv_up64(steps_19759,
                                                           segmap_group_sizze_22526);
            struct memblock_device mem_27234;
            
            mem_27234.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27234, bytes_27210,
                                      "mem_27234")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_27236;
            
            mem_27236.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27236, bytes_27210,
                                      "mem_27236")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegMap");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 1,
                                                    sizeof(ctx->failure_is_an_option),
                                                    &ctx->failure_is_an_option));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 3,
                                                    sizeof(n_19755), &n_19755));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 4,
                                                    sizeof(paths_19758),
                                                    &paths_19758));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 5,
                                                    sizeof(steps_19759),
                                                    &steps_19759));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 6,
                                                    sizeof(a_19763), &a_19763));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 7,
                                                    sizeof(b_19764), &b_19764));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 8,
                                                    sizeof(sigma_19765),
                                                    &sigma_19765));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 9,
                                                    sizeof(x_19783), &x_19783));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 10,
                                                    sizeof(x_19785), &x_19785));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 11,
                                                    sizeof(y_19787), &y_19787));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 12,
                                                    sizeof(y_19788), &y_19788));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 13,
                                                    sizeof(sims_per_year_19853),
                                                    &sims_per_year_19853));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 14,
                                                    sizeof(res_19930),
                                                    &res_19930));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 15,
                                                    sizeof(res_mem_27195.mem),
                                                    &res_mem_27195.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 16,
                                                    sizeof(res_mem_27196.mem),
                                                    &res_mem_27196.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 17,
                                                    sizeof(res_mem_27197.mem),
                                                    &res_mem_27197.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 18,
                                                    sizeof(res_mem_27198.mem),
                                                    &res_mem_27198.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 19,
                                                    sizeof(mem_27226.mem),
                                                    &mem_27226.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 20,
                                                    sizeof(mem_27234.mem),
                                                    &mem_27234.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_21767, 21,
                                                    sizeof(mem_27236.mem),
                                                    &mem_27236.mem));
            if (1 * ((size_t) segmap_usable_groups_22527 *
                     (size_t) segmap_group_sizze_22526) != 0) {
                const size_t global_work_sizze_27591[1] =
                             {(size_t) segmap_usable_groups_22527 *
                             (size_t) segmap_group_sizze_22526};
                const size_t local_work_sizze_27595[1] =
                             {segmap_group_sizze_22526};
                int64_t time_start_27592 = 0, time_end_27593 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.segmap_21767");
                    fprintf(stderr, "%zu", global_work_sizze_27591[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_27595[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_27592 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainzisegmap_21767,
                                                                1, NULL,
                                                                global_work_sizze_27591,
                                                                local_work_sizze_27595,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainzisegmap_21767_runs,
                                                                                                          &ctx->mainzisegmap_21767_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_27593 = get_wall_time();
                    
                    long time_diff_27594 = time_end_27593 - time_start_27592;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.segmap_21767", time_diff_27594);
                }
            }
            ctx->failure_is_an_option = 1;
            if (memblock_set_device(ctx, &res_map_acc_mem_27253, &mem_27234,
                                    "mem_27234") != 0)
                return 1;
            if (memblock_set_device(ctx, &res_mem_27254, &mem_27236,
                                    "mem_27236") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27236, "mem_27236") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27234, "mem_27234") != 0)
                return 1;
        } else {
            struct memblock_device res_map_acc_mem_27251;
            
            res_map_acc_mem_27251.references = NULL;
            
            struct memblock_device res_mem_27252;
            
            res_mem_27252.references = NULL;
            
            int32_t local_memory_capacity_27495;
            
            local_memory_capacity_27495 = ctx->opencl.max_local_memory;
            if (sle64((int32_t) sizeof(float) * paths_19758,
                      sext_i32_i64(local_memory_capacity_27495)) &&
                intra_suff_and_fits_22522) {
                struct memblock_device mem_27240;
                
                mem_27240.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27240, bytes_27210,
                                          "mem_27240")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_27242;
                
                mem_27242.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27242, bytes_27210,
                                          "mem_27242")) {
                    err = 1;
                    goto cleanup;
                }
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        1,
                                                        sizeof(ctx->failure_is_an_option),
                                                        &ctx->failure_is_an_option));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        3,
                                                        (int32_t) sizeof(float) *
                                                        paths_19758, NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        4, sizeof(n_19755),
                                                        &n_19755));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        5, sizeof(paths_19758),
                                                        &paths_19758));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        6, sizeof(a_19763),
                                                        &a_19763));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        7, sizeof(b_19764),
                                                        &b_19764));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        8, sizeof(sigma_19765),
                                                        &sigma_19765));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        9, sizeof(x_19783),
                                                        &x_19783));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        10, sizeof(x_19785),
                                                        &x_19785));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        11, sizeof(y_19787),
                                                        &y_19787));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        12, sizeof(y_19788),
                                                        &y_19788));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        13,
                                                        sizeof(sims_per_year_19853),
                                                        &sims_per_year_19853));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        14, sizeof(res_19930),
                                                        &res_19930));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        15,
                                                        sizeof(res_mem_27195.mem),
                                                        &res_mem_27195.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        16,
                                                        sizeof(res_mem_27196.mem),
                                                        &res_mem_27196.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        17,
                                                        sizeof(res_mem_27197.mem),
                                                        &res_mem_27197.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        18,
                                                        sizeof(res_mem_27198.mem),
                                                        &res_mem_27198.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        19,
                                                        sizeof(mem_27226.mem),
                                                        &mem_27226.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        20,
                                                        sizeof(mem_27240.mem),
                                                        &mem_27240.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_21765,
                                                        21,
                                                        sizeof(mem_27242.mem),
                                                        &mem_27242.mem));
                if (1 * ((size_t) steps_19759 * (size_t) paths_19758) != 0) {
                    const size_t global_work_sizze_27596[1] =
                                 {(size_t) steps_19759 * (size_t) paths_19758};
                    const size_t local_work_sizze_27600[1] = {paths_19758};
                    int64_t time_start_27597 = 0, time_end_27598 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.segmap_intragroup_21765");
                        fprintf(stderr, "%zu", global_work_sizze_27596[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_27600[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(float) *
                                       paths_19758));
                        time_start_27597 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainzisegmap_intragroup_21765,
                                                                    1, NULL,
                                                                    global_work_sizze_27596,
                                                                    local_work_sizze_27600,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainzisegmap_intragroup_21765_runs,
                                                                                                              &ctx->mainzisegmap_intragroup_21765_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_27598 = get_wall_time();
                        
                        long time_diff_27599 = time_end_27598 -
                             time_start_27597;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.segmap_intragroup_21765",
                                time_diff_27599);
                    }
                }
                ctx->failure_is_an_option = 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_27251, &mem_27240,
                                        "mem_27240") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_mem_27252, &mem_27242,
                                        "mem_27242") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27242, "mem_27242") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27240, "mem_27240") != 0)
                    return 1;
            } else {
                struct memblock_device mem_27245;
                
                mem_27245.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27245, bytes_27210,
                                          "mem_27245")) {
                    err = 1;
                    goto cleanup;
                }
                if (slt64(paths_19758 * 2, segred_group_sizze_22813)) {
                    int64_t segment_sizze_nonzzero_27426 = smax64(1,
                                                                  paths_19758);
                    int64_t num_threads_27427 = num_groups_22814 *
                            segred_group_sizze_22813;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-small");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) steps_19759, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) paths_19758, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segments_per_group",
                                (long long) squot64(segred_group_sizze_22813,
                                                    segment_sizze_nonzzero_27426),
                                '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "required_groups",
                                (long long) sext_i64_i32(sdiv_up64(steps_19759,
                                                                   squot64(segred_group_sizze_22813,
                                                                           segment_sizze_nonzzero_27426))),
                                '\n');
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            1,
                                                            sizeof(ctx->failure_is_an_option),
                                                            &ctx->failure_is_an_option));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            3,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_22813,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            4, sizeof(n_19755),
                                                            &n_19755));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            5,
                                                            sizeof(paths_19758),
                                                            &paths_19758));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            6,
                                                            sizeof(steps_19759),
                                                            &steps_19759));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            7, sizeof(a_19763),
                                                            &a_19763));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            8, sizeof(b_19764),
                                                            &b_19764));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            9,
                                                            sizeof(sigma_19765),
                                                            &sigma_19765));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            10,
                                                            sizeof(sims_per_year_19853),
                                                            &sims_per_year_19853));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            11,
                                                            sizeof(num_groups_22814),
                                                            &num_groups_22814));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            12,
                                                            sizeof(res_mem_27195.mem),
                                                            &res_mem_27195.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            13,
                                                            sizeof(res_mem_27196.mem),
                                                            &res_mem_27196.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            14,
                                                            sizeof(res_mem_27197.mem),
                                                            &res_mem_27197.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            15,
                                                            sizeof(res_mem_27198.mem),
                                                            &res_mem_27198.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            16,
                                                            sizeof(mem_27226.mem),
                                                            &mem_27226.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            17,
                                                            sizeof(mem_27245.mem),
                                                            &mem_27245.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_22227,
                                                            18,
                                                            sizeof(segment_sizze_nonzzero_27426),
                                                            &segment_sizze_nonzzero_27426));
                    if (1 * ((size_t) num_groups_22814 *
                             (size_t) segred_group_sizze_22813) != 0) {
                        const size_t global_work_sizze_27601[1] =
                                     {(size_t) num_groups_22814 *
                                     (size_t) segred_group_sizze_22813};
                        const size_t local_work_sizze_27605[1] =
                                     {segred_group_sizze_22813};
                        int64_t time_start_27602 = 0, time_end_27603 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.segred_small_22227");
                            fprintf(stderr, "%zu", global_work_sizze_27601[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_27605[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(float) *
                                           segred_group_sizze_22813));
                            time_start_27602 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainzisegred_small_22227,
                                                                        1, NULL,
                                                                        global_work_sizze_27601,
                                                                        local_work_sizze_27605,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainzisegred_small_22227_runs,
                                                                                                                  &ctx->mainzisegred_small_22227_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_27603 = get_wall_time();
                            
                            long time_diff_27604 = time_end_27603 -
                                 time_start_27602;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.segred_small_22227", time_diff_27604);
                        }
                    }
                    ctx->failure_is_an_option = 1;
                } else {
                    int64_t groups_per_segment_27449 =
                            sdiv_up64(num_groups_22814, smax64(1, steps_19759));
                    int64_t elements_per_thread_27450 = sdiv_up64(paths_19758,
                                                                  segred_group_sizze_22813 *
                                                                  groups_per_segment_27449);
                    int64_t virt_num_groups_27451 = groups_per_segment_27449 *
                            steps_19759;
                    int64_t num_threads_27452 = num_groups_22814 *
                            segred_group_sizze_22813;
                    int64_t threads_per_segment_27453 =
                            groups_per_segment_27449 * segred_group_sizze_22813;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-large");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) steps_19759, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) paths_19758, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                                (long long) virt_num_groups_27451, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_groups",
                                (long long) num_groups_22814, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "group_size",
                                (long long) segred_group_sizze_22813, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                                (long long) elements_per_thread_27450, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                                (long long) groups_per_segment_27449, '\n');
                    
                    struct memblock_device group_res_arr_mem_27454;
                    
                    group_res_arr_mem_27454.references = NULL;
                    if (memblock_alloc_device(ctx, &group_res_arr_mem_27454,
                                              (int32_t) sizeof(float) *
                                              (segred_group_sizze_22813 *
                                               virt_num_groups_27451),
                                              "group_res_arr_mem_27454")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device mainzicounter_mem_27456 =
                                           ctx->mainzicounter_mem_27456;
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            1,
                                                            sizeof(ctx->failure_is_an_option),
                                                            &ctx->failure_is_an_option));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            3,
                                                            (int32_t) sizeof(bool),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            4,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_22813,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            5, sizeof(n_19755),
                                                            &n_19755));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            6,
                                                            sizeof(paths_19758),
                                                            &paths_19758));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            7, sizeof(a_19763),
                                                            &a_19763));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            8, sizeof(b_19764),
                                                            &b_19764));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            9,
                                                            sizeof(sigma_19765),
                                                            &sigma_19765));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            10,
                                                            sizeof(sims_per_year_19853),
                                                            &sims_per_year_19853));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            11,
                                                            sizeof(num_groups_22814),
                                                            &num_groups_22814));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            12,
                                                            sizeof(res_mem_27195.mem),
                                                            &res_mem_27195.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            13,
                                                            sizeof(res_mem_27196.mem),
                                                            &res_mem_27196.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            14,
                                                            sizeof(res_mem_27197.mem),
                                                            &res_mem_27197.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            15,
                                                            sizeof(res_mem_27198.mem),
                                                            &res_mem_27198.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            16,
                                                            sizeof(mem_27226.mem),
                                                            &mem_27226.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            17,
                                                            sizeof(mem_27245.mem),
                                                            &mem_27245.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            18,
                                                            sizeof(groups_per_segment_27449),
                                                            &groups_per_segment_27449));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            19,
                                                            sizeof(elements_per_thread_27450),
                                                            &elements_per_thread_27450));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            20,
                                                            sizeof(virt_num_groups_27451),
                                                            &virt_num_groups_27451));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            21,
                                                            sizeof(threads_per_segment_27453),
                                                            &threads_per_segment_27453));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            22,
                                                            sizeof(group_res_arr_mem_27454.mem),
                                                            &group_res_arr_mem_27454.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_22227,
                                                            23,
                                                            sizeof(mainzicounter_mem_27456.mem),
                                                            &mainzicounter_mem_27456.mem));
                    if (1 * ((size_t) num_groups_22814 *
                             (size_t) segred_group_sizze_22813) != 0) {
                        const size_t global_work_sizze_27607[1] =
                                     {(size_t) num_groups_22814 *
                                     (size_t) segred_group_sizze_22813};
                        const size_t local_work_sizze_27611[1] =
                                     {segred_group_sizze_22813};
                        int64_t time_start_27608 = 0, time_end_27609 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.segred_large_22227");
                            fprintf(stderr, "%zu", global_work_sizze_27607[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_27611[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(bool) +
                                           (int32_t) sizeof(float) *
                                           segred_group_sizze_22813));
                            time_start_27608 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainzisegred_large_22227,
                                                                        1, NULL,
                                                                        global_work_sizze_27607,
                                                                        local_work_sizze_27611,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainzisegred_large_22227_runs,
                                                                                                                  &ctx->mainzisegred_large_22227_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_27609 = get_wall_time();
                            
                            long time_diff_27610 = time_end_27609 -
                                 time_start_27608;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.segred_large_22227", time_diff_27610);
                        }
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_27454,
                                              "group_res_arr_mem_27454") != 0)
                        return 1;
                }
                
                int64_t segmap_usable_groups_22931 = sdiv_up64(steps_19759,
                                                               segmap_group_sizze_22930);
                struct memblock_device mem_27248;
                
                mem_27248.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27248, bytes_27210,
                                          "mem_27248")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_27250;
                
                mem_27250.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27250, bytes_27210,
                                          "mem_27250")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_22192,
                                                        1, sizeof(steps_19759),
                                                        &steps_19759));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_22192,
                                                        2, sizeof(a_19763),
                                                        &a_19763));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_22192,
                                                        3, sizeof(x_19783),
                                                        &x_19783));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_22192,
                                                        4, sizeof(x_19785),
                                                        &x_19785));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_22192,
                                                        5, sizeof(y_19787),
                                                        &y_19787));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_22192,
                                                        6, sizeof(y_19788),
                                                        &y_19788));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_22192,
                                                        7,
                                                        sizeof(sims_per_year_19853),
                                                        &sims_per_year_19853));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_22192,
                                                        8, sizeof(res_19930),
                                                        &res_19930));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_22192,
                                                        9,
                                                        sizeof(mem_27245.mem),
                                                        &mem_27245.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_22192,
                                                        10,
                                                        sizeof(mem_27248.mem),
                                                        &mem_27248.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_22192,
                                                        11,
                                                        sizeof(mem_27250.mem),
                                                        &mem_27250.mem));
                if (1 * ((size_t) segmap_usable_groups_22931 *
                         (size_t) segmap_group_sizze_22930) != 0) {
                    const size_t global_work_sizze_27612[1] =
                                 {(size_t) segmap_usable_groups_22931 *
                                 (size_t) segmap_group_sizze_22930};
                    const size_t local_work_sizze_27616[1] =
                                 {segmap_group_sizze_22930};
                    int64_t time_start_27613 = 0, time_end_27614 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.segmap_22192");
                        fprintf(stderr, "%zu", global_work_sizze_27612[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_27616[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_27613 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainzisegmap_22192,
                                                                    1, NULL,
                                                                    global_work_sizze_27612,
                                                                    local_work_sizze_27616,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainzisegmap_22192_runs,
                                                                                                              &ctx->mainzisegmap_22192_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_27614 = get_wall_time();
                        
                        long time_diff_27615 = time_end_27614 -
                             time_start_27613;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.segmap_22192", time_diff_27615);
                    }
                }
                if (memblock_unref_device(ctx, &mem_27245, "mem_27245") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_27251, &mem_27248,
                                        "mem_27248") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_mem_27252, &mem_27250,
                                        "mem_27250") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27250, "mem_27250") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27248, "mem_27248") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27245, "mem_27245") != 0)
                    return 1;
            }
            if (memblock_set_device(ctx, &res_map_acc_mem_27253,
                                    &res_map_acc_mem_27251,
                                    "res_map_acc_mem_27251") != 0)
                return 1;
            if (memblock_set_device(ctx, &res_mem_27254, &res_mem_27252,
                                    "res_mem_27252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27252, "res_mem_27252") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_map_acc_mem_27251,
                                      "res_map_acc_mem_27251") != 0)
                return 1;
        }
        
        struct memblock_device mem_27257;
        
        mem_27257.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27257, 4, "mem_27257")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mainzicounter_mem_27497 =
                               ctx->mainzicounter_mem_27497;
        struct memblock_device group_res_arr_mem_27499;
        
        group_res_arr_mem_27499.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_27499,
                                  (int32_t) sizeof(float) *
                                  (segred_group_sizze_22958 * num_groups_22959),
                                  "group_res_arr_mem_27499")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_27501;
        
        num_threads_27501 = num_groups_22959 * segred_group_sizze_22958;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_22513,
                                                1, (int32_t) sizeof(float) *
                                                segred_group_sizze_22958,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_22513,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_22513,
                                                3, sizeof(steps_19759),
                                                &steps_19759));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_22513,
                                                4, sizeof(num_groups_22959),
                                                &num_groups_22959));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_22513,
                                                5,
                                                sizeof(res_map_acc_mem_27253.mem),
                                                &res_map_acc_mem_27253.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_22513,
                                                6, sizeof(mem_27257.mem),
                                                &mem_27257.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_22513,
                                                7,
                                                sizeof(mainzicounter_mem_27497.mem),
                                                &mainzicounter_mem_27497.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_22513,
                                                8,
                                                sizeof(group_res_arr_mem_27499.mem),
                                                &group_res_arr_mem_27499.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_22513,
                                                9, sizeof(num_threads_27501),
                                                &num_threads_27501));
        if (1 * ((size_t) num_groups_22959 *
                 (size_t) segred_group_sizze_22958) != 0) {
            const size_t global_work_sizze_27618[1] =
                         {(size_t) num_groups_22959 *
                         (size_t) segred_group_sizze_22958};
            const size_t local_work_sizze_27622[1] = {segred_group_sizze_22958};
            int64_t time_start_27619 = 0, time_end_27620 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segred_nonseg_22513");
                fprintf(stderr, "%zu", global_work_sizze_27618[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_27622[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(float) *
                               segred_group_sizze_22958 +
                               (int32_t) sizeof(bool)));
                time_start_27619 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegred_nonseg_22513,
                                                            1, NULL,
                                                            global_work_sizze_27618,
                                                            local_work_sizze_27622,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegred_nonseg_22513_runs,
                                                                                                      &ctx->mainzisegred_nonseg_22513_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_27620 = get_wall_time();
                
                long time_diff_27621 = time_end_27620 - time_start_27619;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segred_nonseg_22513", time_diff_27621);
            }
        }
        if (memblock_unref_device(ctx, &res_map_acc_mem_27253,
                                  "res_map_acc_mem_27253") != 0)
            return 1;
        
        float read_res_27623;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27257.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(float),
                                                     sizeof(float),
                                                     &read_res_27623, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        float res_22966 = read_res_27623;
        
        if (memblock_unref_device(ctx, &mem_27257, "mem_27257") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27261, &res_mem_27254,
                                "res_mem_27254") != 0)
            return 1;
        res_20052 = res_22966;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27499,
                                  "group_res_arr_mem_27499") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27257, "mem_27257") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27254, "res_mem_27254") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_map_acc_mem_27253,
                                  "res_map_acc_mem_27253") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &res_mem_27195, "res_mem_27195") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27196, "res_mem_27196") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27197, "res_mem_27197") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27198, "res_mem_27198") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27226, "mem_27226") != 0)
        return 1;
    
    float CVA_20194 = 6.0e-3F * res_20052;
    
    out_arrsizze_27303 = steps_19759;
    if (memblock_set_device(ctx, &out_mem_27302, &res_mem_27261,
                            "res_mem_27261") != 0)
        return 1;
    scalar_out_27301 = CVA_20194;
    *out_scalar_out_27549 = scalar_out_27301;
    (*out_mem_p_27550).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_27550, &out_mem_27302,
                            "out_mem_27302") != 0)
        return 1;
    *out_out_arrsizze_27551 = out_arrsizze_27303;
    if (memblock_unref_device(ctx, &res_mem_27261, "res_mem_27261") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27211, "mem_27211") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27226, "mem_27226") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27208, "mem_27208") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27205, "mem_27205") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27201, "mem_27201") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27198, "res_mem_27198") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27197, "res_mem_27197") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27196, "res_mem_27196") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27195, "res_mem_27195") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_27307,
                              "group_res_arr_mem_27307") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27176, "mem_27176") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_27302, "out_mem_27302") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
static int futrts_test(struct futhark_context *ctx, float *out_scalar_out_27624,
                       int64_t paths_20195, int64_t steps_20196)
{
    (void) ctx;
    
    int err = 0;
    float scalar_out_27301;
    struct memblock_device mem_27172;
    
    mem_27172.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27172, 16, "mem_27172")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzistatic_array_27302 =
                           ctx->testzistatic_array_27302;
    
    if (4 * (int32_t) sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     testzistatic_array_27302.mem,
                                                     mem_27172.mem, 0, 0, 4 *
                                                     (int32_t) sizeof(float), 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    
    struct memblock_device mem_27174;
    
    mem_27174.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27174, 32, "mem_27174")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzistatic_array_27303 =
                           ctx->testzistatic_array_27303;
    
    if (4 * (int32_t) sizeof(int64_t) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     testzistatic_array_27303.mem,
                                                     mem_27174.mem, 0, 0, 4 *
                                                     (int32_t) sizeof(int64_t),
                                                     0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    
    struct memblock_device mem_27176;
    
    mem_27176.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27176, 16, "mem_27176")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzistatic_array_27304 =
                           ctx->testzistatic_array_27304;
    
    if (4 * (int32_t) sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     testzistatic_array_27304.mem,
                                                     mem_27176.mem, 0, 0, 4 *
                                                     (int32_t) sizeof(float), 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    
    int64_t segred_group_sizze_22971;
    
    segred_group_sizze_22971 = ctx->sizes.testzisegred_group_sizze_22970;
    
    int64_t num_groups_22973;
    int32_t max_num_groups_27305;
    
    max_num_groups_27305 = ctx->sizes.testzisegred_num_groups_22972;
    num_groups_22973 = sext_i64_i32(smax64(1, smin64(sdiv_up64(4,
                                                               sext_i32_i64(segred_group_sizze_22971)),
                                                     sext_i32_i64(max_num_groups_27305))));
    
    struct memblock_device mem_27179;
    
    mem_27179.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27179, 4, "mem_27179")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzicounter_mem_27306 =
                           ctx->testzicounter_mem_27306;
    struct memblock_device group_res_arr_mem_27308;
    
    group_res_arr_mem_27308.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_27308,
                              (int32_t) sizeof(float) *
                              (segred_group_sizze_22971 * num_groups_22973),
                              "group_res_arr_mem_27308")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_27310;
    
    num_threads_27310 = num_groups_22973 * segred_group_sizze_22971;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_22978, 1,
                                            (int32_t) sizeof(float) *
                                            segred_group_sizze_22971, NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_22978, 2,
                                            (int32_t) sizeof(bool), NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_22978, 3,
                                            sizeof(num_groups_22973),
                                            &num_groups_22973));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_22978, 4,
                                            sizeof(mem_27174.mem),
                                            &mem_27174.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_22978, 5,
                                            sizeof(mem_27176.mem),
                                            &mem_27176.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_22978, 6,
                                            sizeof(mem_27179.mem),
                                            &mem_27179.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_22978, 7,
                                            sizeof(testzicounter_mem_27306.mem),
                                            &testzicounter_mem_27306.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_22978, 8,
                                            sizeof(group_res_arr_mem_27308.mem),
                                            &group_res_arr_mem_27308.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_22978, 9,
                                            sizeof(num_threads_27310),
                                            &num_threads_27310));
    if (1 * ((size_t) num_groups_22973 * (size_t) segred_group_sizze_22971) !=
        0) {
        const size_t global_work_sizze_27629[1] = {(size_t) num_groups_22973 *
                     (size_t) segred_group_sizze_22971};
        const size_t local_work_sizze_27633[1] = {segred_group_sizze_22971};
        int64_t time_start_27630 = 0, time_end_27631 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segred_nonseg_22978");
            fprintf(stderr, "%zu", global_work_sizze_27629[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_27633[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) (0 + (int32_t) sizeof(float) *
                           segred_group_sizze_22971 + (int32_t) sizeof(bool)));
            time_start_27630 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegred_nonseg_22978,
                                                        1, NULL,
                                                        global_work_sizze_27629,
                                                        local_work_sizze_27633,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegred_nonseg_22978_runs,
                                                                                                  &ctx->testzisegred_nonseg_22978_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_27631 = get_wall_time();
            
            long time_diff_27632 = time_end_27631 - time_start_27630;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "test.segred_nonseg_22978", time_diff_27632);
        }
    }
    
    float read_res_27634;
    
    OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                 mem_27179.mem,
                                                 ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                 0 * sizeof(float),
                                                 sizeof(float), &read_res_27634,
                                                 0, NULL,
                                                 ctx->profiling_paused ||
                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                           &ctx->copy_scalar_from_dev_runs,
                                                                                           &ctx->copy_scalar_from_dev_total_runtime)));
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
        return 1;
    
    float res_20200 = read_res_27634;
    
    if (memblock_unref_device(ctx, &mem_27179, "mem_27179") != 0)
        return 1;
    
    float res_20208 = sitofp_i64_f32(steps_20196);
    float dt_20209 = res_20200 / res_20208;
    bool suff_outer_par_22980;
    
    suff_outer_par_22980 = ctx->sizes.testzisuff_outer_par_0 <= 4;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_outer_par_0", 4);
    
    int64_t segmap_group_sizze_23048;
    
    segmap_group_sizze_23048 = ctx->sizes.testzisegmap_group_sizze_22984;
    
    int64_t segmap_group_sizze_23197;
    
    segmap_group_sizze_23197 = ctx->sizes.testzisegmap_group_sizze_23133;
    
    struct memblock_device res_mem_27198;
    
    res_mem_27198.references = NULL;
    
    struct memblock_device res_mem_27199;
    
    res_mem_27199.references = NULL;
    
    struct memblock_device res_mem_27200;
    
    res_mem_27200.references = NULL;
    
    struct memblock_device res_mem_27201;
    
    res_mem_27201.references = NULL;
    
    int32_t local_memory_capacity_27348;
    
    local_memory_capacity_27348 = ctx->opencl.max_local_memory;
    if (sle64(0, sext_i32_i64(local_memory_capacity_27348)) &&
        suff_outer_par_22980) {
        int64_t segmap_usable_groups_23049 = sdiv_up64(4,
                                                       segmap_group_sizze_23048);
        struct memblock_device mem_27181;
        
        mem_27181.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27181, 16, "mem_27181")) {
            err = 1;
            goto cleanup;
        }
        if (4 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27176.mem,
                                                         mem_27181.mem, 0, 0,
                                                         4 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27183;
        
        mem_27183.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27183, 32, "mem_27183")) {
            err = 1;
            goto cleanup;
        }
        if (4 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27174.mem,
                                                         mem_27183.mem, 0, 0,
                                                         4 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27185;
        
        mem_27185.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27185, 16, "mem_27185")) {
            err = 1;
            goto cleanup;
        }
        if (4 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27172.mem,
                                                         mem_27185.mem, 0, 0,
                                                         4 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27188;
        
        mem_27188.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27188, 16, "mem_27188")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_22982, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_22982, 3,
                                                sizeof(mem_27174.mem),
                                                &mem_27174.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_22982, 4,
                                                sizeof(mem_27176.mem),
                                                &mem_27176.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_22982, 5,
                                                sizeof(mem_27188.mem),
                                                &mem_27188.mem));
        if (1 * ((size_t) segmap_usable_groups_23049 *
                 (size_t) segmap_group_sizze_23048) != 0) {
            const size_t global_work_sizze_27635[1] =
                         {(size_t) segmap_usable_groups_23049 *
                         (size_t) segmap_group_sizze_23048};
            const size_t local_work_sizze_27639[1] = {segmap_group_sizze_23048};
            int64_t time_start_27636 = 0, time_end_27637 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_22982");
                fprintf(stderr, "%zu", global_work_sizze_27635[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_27639[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_27636 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_22982,
                                                            1, NULL,
                                                            global_work_sizze_27635,
                                                            local_work_sizze_27639,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_22982_runs,
                                                                                                      &ctx->testzisegmap_22982_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_27637 = get_wall_time();
                
                long time_diff_27638 = time_end_27637 - time_start_27636;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_22982", time_diff_27638);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_set_device(ctx, &res_mem_27198, &mem_27188, "mem_27188") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27199, &mem_27185, "mem_27185") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27200, &mem_27183, "mem_27183") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27201, &mem_27181, "mem_27181") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27188, "mem_27188") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27185, "mem_27185") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27183, "mem_27183") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27181, "mem_27181") != 0)
            return 1;
    } else {
        int64_t segmap_usable_groups_23198 = sdiv_up64(4,
                                                       segmap_group_sizze_23197);
        struct memblock_device mem_27190;
        
        mem_27190.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27190, 16, "mem_27190")) {
            err = 1;
            goto cleanup;
        }
        if (4 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27176.mem,
                                                         mem_27190.mem, 0, 0,
                                                         4 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27192;
        
        mem_27192.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27192, 32, "mem_27192")) {
            err = 1;
            goto cleanup;
        }
        if (4 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27174.mem,
                                                         mem_27192.mem, 0, 0,
                                                         4 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27194;
        
        mem_27194.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27194, 16, "mem_27194")) {
            err = 1;
            goto cleanup;
        }
        if (4 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27172.mem,
                                                         mem_27194.mem, 0, 0,
                                                         4 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27197;
        
        mem_27197.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27197, 16, "mem_27197")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23131, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23131, 3,
                                                sizeof(mem_27174.mem),
                                                &mem_27174.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23131, 4,
                                                sizeof(mem_27176.mem),
                                                &mem_27176.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23131, 5,
                                                sizeof(mem_27197.mem),
                                                &mem_27197.mem));
        if (1 * ((size_t) segmap_usable_groups_23198 *
                 (size_t) segmap_group_sizze_23197) != 0) {
            const size_t global_work_sizze_27640[1] =
                         {(size_t) segmap_usable_groups_23198 *
                         (size_t) segmap_group_sizze_23197};
            const size_t local_work_sizze_27644[1] = {segmap_group_sizze_23197};
            int64_t time_start_27641 = 0, time_end_27642 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_23131");
                fprintf(stderr, "%zu", global_work_sizze_27640[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_27644[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_27641 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_23131,
                                                            1, NULL,
                                                            global_work_sizze_27640,
                                                            local_work_sizze_27644,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_23131_runs,
                                                                                                      &ctx->testzisegmap_23131_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_27642 = get_wall_time();
                
                long time_diff_27643 = time_end_27642 - time_start_27641;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_23131", time_diff_27643);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_set_device(ctx, &res_mem_27198, &mem_27197, "mem_27197") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27199, &mem_27194, "mem_27194") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27200, &mem_27192, "mem_27192") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27201, &mem_27190, "mem_27190") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27197, "mem_27197") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27194, "mem_27194") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27192, "mem_27192") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27190, "mem_27190") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_27172, "mem_27172") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27174, "mem_27174") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27176, "mem_27176") != 0)
        return 1;
    
    float sims_per_year_20275 = res_20208 / res_20200;
    bool bounds_invalid_upwards_20276 = slt64(steps_20196, 1);
    bool valid_20277 = !bounds_invalid_upwards_20276;
    bool range_valid_c_20278;
    
    if (!valid_20277) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 1, "..", 2, "...", steps_20196,
                               " is invalid.",
                               "-> #0  cva-map.fut:70:56-67\n   #1  cva-map.fut:122:17-44\n   #2  cva-map.fut:161:3-163:35\n   #3  cva-map.fut:160:1-163:43\n");
        if (memblock_unref_device(ctx, &res_mem_27201, "res_mem_27201") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27200, "res_mem_27200") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27199, "res_mem_27199") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27198, "res_mem_27198") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27308,
                                  "group_res_arr_mem_27308") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27179, "mem_27179") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27176, "mem_27176") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27174, "mem_27174") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27172, "mem_27172") != 0)
            return 1;
        return 1;
    }
    
    bool bounds_invalid_upwards_20284 = slt64(paths_20195, 0);
    bool valid_20285 = !bounds_invalid_upwards_20284;
    bool range_valid_c_20286;
    
    if (!valid_20285) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", paths_20195,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:126:11-16\n   #2  lib/github.com/diku-dk/cpprandom/random.fut:174:8-56\n   #3  cva-map.fut:125:19-49\n   #4  cva-map.fut:161:3-163:35\n   #5  cva-map.fut:160:1-163:43\n");
        if (memblock_unref_device(ctx, &res_mem_27201, "res_mem_27201") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27200, "res_mem_27200") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27199, "res_mem_27199") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27198, "res_mem_27198") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27308,
                                  "group_res_arr_mem_27308") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27179, "mem_27179") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27176, "mem_27176") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27174, "mem_27174") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27172, "mem_27172") != 0)
            return 1;
        return 1;
    }
    
    int64_t upper_bound_20289 = sub64(steps_20196, 1);
    float res_20290;
    
    res_20290 = futrts_sqrt32(dt_20209);
    
    int64_t segmap_group_sizze_23621;
    
    segmap_group_sizze_23621 = ctx->sizes.testzisegmap_group_sizze_23604;
    
    int64_t segmap_usable_groups_23622 = sdiv_up64(paths_20195,
                                                   segmap_group_sizze_23621);
    int64_t bytes_27203 = 4 * paths_20195;
    struct memblock_device mem_27204;
    
    mem_27204.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27204, bytes_27203, "mem_27204")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23602, 1,
                                            sizeof(paths_20195), &paths_20195));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23602, 2,
                                            sizeof(mem_27204.mem),
                                            &mem_27204.mem));
    if (1 * ((size_t) segmap_usable_groups_23622 *
             (size_t) segmap_group_sizze_23621) != 0) {
        const size_t global_work_sizze_27645[1] =
                     {(size_t) segmap_usable_groups_23622 *
                     (size_t) segmap_group_sizze_23621};
        const size_t local_work_sizze_27649[1] = {segmap_group_sizze_23621};
        int64_t time_start_27646 = 0, time_end_27647 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segmap_23602");
            fprintf(stderr, "%zu", global_work_sizze_27645[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_27649[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_27646 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegmap_23602,
                                                        1, NULL,
                                                        global_work_sizze_27645,
                                                        local_work_sizze_27649,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegmap_23602_runs,
                                                                                                  &ctx->testzisegmap_23602_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_27647 = get_wall_time();
            
            long time_diff_27648 = time_end_27647 - time_start_27646;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "test.segmap_23602",
                    time_diff_27648);
        }
    }
    
    int64_t nest_sizze_23645 = paths_20195 * steps_20196;
    int64_t segmap_group_sizze_23646;
    
    segmap_group_sizze_23646 = ctx->sizes.testzisegmap_group_sizze_23541;
    
    int64_t segmap_usable_groups_23647 = sdiv_up64(nest_sizze_23645,
                                                   segmap_group_sizze_23646);
    int64_t bytes_27206 = 4 * nest_sizze_23645;
    struct memblock_device mem_27208;
    
    mem_27208.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27208, bytes_27206, "mem_27208")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23538, 1,
                                            sizeof(paths_20195), &paths_20195));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23538, 2,
                                            sizeof(steps_20196), &steps_20196));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23538, 3,
                                            sizeof(mem_27204.mem),
                                            &mem_27204.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23538, 4,
                                            sizeof(mem_27208.mem),
                                            &mem_27208.mem));
    if (1 * ((size_t) segmap_usable_groups_23647 *
             (size_t) segmap_group_sizze_23646) != 0) {
        const size_t global_work_sizze_27650[1] =
                     {(size_t) segmap_usable_groups_23647 *
                     (size_t) segmap_group_sizze_23646};
        const size_t local_work_sizze_27654[1] = {segmap_group_sizze_23646};
        int64_t time_start_27651 = 0, time_end_27652 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segmap_23538");
            fprintf(stderr, "%zu", global_work_sizze_27650[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_27654[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_27651 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegmap_23538,
                                                        1, NULL,
                                                        global_work_sizze_27650,
                                                        local_work_sizze_27654,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegmap_23538_runs,
                                                                                                  &ctx->testzisegmap_23538_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_27652 = get_wall_time();
            
            long time_diff_27653 = time_end_27652 - time_start_27651;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "test.segmap_23538",
                    time_diff_27653);
        }
    }
    if (memblock_unref_device(ctx, &mem_27204, "mem_27204") != 0)
        return 1;
    
    int64_t segmap_group_sizze_23691;
    
    segmap_group_sizze_23691 = ctx->sizes.testzisegmap_group_sizze_23442;
    
    int64_t num_groups_23692;
    int32_t max_num_groups_27359;
    
    max_num_groups_27359 = ctx->sizes.testzisegmap_num_groups_23444;
    num_groups_23692 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_20195,
                                                               sext_i32_i64(segmap_group_sizze_23691)),
                                                     sext_i32_i64(max_num_groups_27359))));
    
    struct memblock_device mem_27211;
    
    mem_27211.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27211, bytes_27206, "mem_27211")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27211, 0, mem_27208, 0,
                                              1, steps_20196, paths_20195) !=
        0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &mem_27208, "mem_27208") != 0)
        return 1;
    
    struct memblock_device mem_27229;
    
    mem_27229.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27229, bytes_27206, "mem_27229")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_27213 = 4 * steps_20196;
    int64_t num_threads_27280 = segmap_group_sizze_23691 * num_groups_23692;
    int64_t total_sizze_27281 = bytes_27213 * num_threads_27280;
    struct memblock_device mem_27214;
    
    mem_27214.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27214, total_sizze_27281,
                              "mem_27214")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23440, 1,
                                            sizeof(ctx->failure_is_an_option),
                                            &ctx->failure_is_an_option));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23440, 3,
                                            sizeof(paths_20195), &paths_20195));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23440, 4,
                                            sizeof(steps_20196), &steps_20196));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23440, 5,
                                            sizeof(dt_20209), &dt_20209));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23440, 6,
                                            sizeof(upper_bound_20289),
                                            &upper_bound_20289));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23440, 7,
                                            sizeof(res_20290), &res_20290));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23440, 8,
                                            sizeof(num_groups_23692),
                                            &num_groups_23692));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23440, 9,
                                            sizeof(mem_27211.mem),
                                            &mem_27211.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23440, 10,
                                            sizeof(mem_27214.mem),
                                            &mem_27214.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23440, 11,
                                            sizeof(mem_27229.mem),
                                            &mem_27229.mem));
    if (1 * ((size_t) num_groups_23692 * (size_t) segmap_group_sizze_23691) !=
        0) {
        const size_t global_work_sizze_27655[1] = {(size_t) num_groups_23692 *
                     (size_t) segmap_group_sizze_23691};
        const size_t local_work_sizze_27659[1] = {segmap_group_sizze_23691};
        int64_t time_start_27656 = 0, time_end_27657 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segmap_23440");
            fprintf(stderr, "%zu", global_work_sizze_27655[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_27659[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_27656 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegmap_23440,
                                                        1, NULL,
                                                        global_work_sizze_27655,
                                                        local_work_sizze_27659,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegmap_23440_runs,
                                                                                                  &ctx->testzisegmap_23440_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_27657 = get_wall_time();
            
            long time_diff_27658 = time_end_27657 - time_start_27656;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "test.segmap_23440",
                    time_diff_27658);
        }
    }
    ctx->failure_is_an_option = 1;
    if (memblock_unref_device(ctx, &mem_27211, "mem_27211") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27214, "mem_27214") != 0)
        return 1;
    
    float res_20352 = sitofp_i64_f32(paths_20195);
    bool suff_outer_redomap_23718;
    
    suff_outer_redomap_23718 = ctx->sizes.testzisuff_outer_redomap_5 <=
        steps_20196;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_outer_redomap_5",
                steps_20196);
    
    int64_t segred_group_sizze_23730;
    
    segred_group_sizze_23730 = ctx->sizes.testzisegred_group_sizze_23720;
    
    int64_t num_groups_23731;
    int32_t max_num_groups_27371;
    
    max_num_groups_27371 = ctx->sizes.testzisegred_num_groups_23722;
    num_groups_23731 = sext_i64_i32(smax64(1, smin64(sdiv_up64(steps_20196,
                                                               sext_i32_i64(segred_group_sizze_23730)),
                                                     sext_i32_i64(max_num_groups_27371))));
    
    bool suff_outer_par_24591;
    
    suff_outer_par_24591 = ctx->sizes.testzisuff_outer_par_6 <= steps_20196;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_outer_par_6",
                steps_20196);
    
    int64_t max_group_sizze_24594;
    
    max_group_sizze_24594 = ctx->opencl.max_group_size;
    
    bool fits_24595 = sle64(paths_20195, max_group_sizze_24594);
    bool suff_intra_par_24597;
    
    suff_intra_par_24597 = ctx->sizes.testzisuff_intra_par_7 <= paths_20195;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_intra_par_7",
                paths_20195);
    
    bool intra_suff_and_fits_24598 = fits_24595 && suff_intra_par_24597;
    int64_t segmap_group_sizze_24601;
    
    segmap_group_sizze_24601 = ctx->sizes.testzisegmap_group_sizze_23880;
    
    int64_t segred_group_sizze_24873;
    
    segred_group_sizze_24873 = ctx->sizes.testzisegred_group_sizze_24312;
    
    int64_t num_groups_24874;
    int32_t max_num_groups_27372;
    
    max_num_groups_27372 = ctx->sizes.testzisegred_num_groups_24314;
    num_groups_24874 = sext_i64_i32(smax64(1, smin64(sdiv_up64(nest_sizze_23645,
                                                               sext_i32_i64(segred_group_sizze_24873)),
                                                     sext_i32_i64(max_num_groups_27372))));
    
    int64_t segmap_group_sizze_24984;
    
    segmap_group_sizze_24984 = ctx->sizes.testzisegmap_group_sizze_24285;
    
    int64_t segred_group_sizze_25010;
    
    segred_group_sizze_25010 = ctx->sizes.testzisegred_group_sizze_24581;
    
    int64_t num_groups_25011;
    int32_t max_num_groups_27373;
    
    max_num_groups_27373 = ctx->sizes.testzisegred_num_groups_24583;
    num_groups_25011 = sext_i64_i32(smax64(1, smin64(sdiv_up64(steps_20196,
                                                               sext_i32_i64(segred_group_sizze_25010)),
                                                     sext_i32_i64(max_num_groups_27373))));
    
    float res_20359;
    int32_t local_memory_capacity_27528;
    
    local_memory_capacity_27528 = ctx->opencl.max_local_memory;
    if (sle64((int32_t) sizeof(bool) + (int32_t) sizeof(float) *
              segred_group_sizze_23730,
              sext_i32_i64(local_memory_capacity_27528)) &&
        suff_outer_redomap_23718) {
        struct memblock_device mem_27232;
        
        mem_27232.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27232, 4, "mem_27232")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device testzicounter_mem_27374 =
                               ctx->testzicounter_mem_27374;
        struct memblock_device group_res_arr_mem_27376;
        
        group_res_arr_mem_27376.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_27376,
                                  (int32_t) sizeof(float) *
                                  (segred_group_sizze_23730 * num_groups_23731),
                                  "group_res_arr_mem_27376")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_27378;
        
        num_threads_27378 = num_groups_23731 * segred_group_sizze_23730;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                3, (int32_t) sizeof(float) *
                                                segred_group_sizze_23730,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                4, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                5, sizeof(paths_20195),
                                                &paths_20195));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                6, sizeof(steps_20196),
                                                &steps_20196));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                7, sizeof(sims_per_year_20275),
                                                &sims_per_year_20275));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                8, sizeof(res_20352),
                                                &res_20352));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                9, sizeof(num_groups_23731),
                                                &num_groups_23731));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                10, sizeof(res_mem_27198.mem),
                                                &res_mem_27198.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                11, sizeof(res_mem_27199.mem),
                                                &res_mem_27199.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                12, sizeof(res_mem_27200.mem),
                                                &res_mem_27200.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                13, sizeof(res_mem_27201.mem),
                                                &res_mem_27201.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                14, sizeof(mem_27229.mem),
                                                &mem_27229.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                15, sizeof(mem_27232.mem),
                                                &mem_27232.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                16,
                                                sizeof(testzicounter_mem_27374.mem),
                                                &testzicounter_mem_27374.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                17,
                                                sizeof(group_res_arr_mem_27376.mem),
                                                &group_res_arr_mem_27376.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_23728,
                                                18, sizeof(num_threads_27378),
                                                &num_threads_27378));
        if (1 * ((size_t) num_groups_23731 *
                 (size_t) segred_group_sizze_23730) != 0) {
            const size_t global_work_sizze_27661[1] =
                         {(size_t) num_groups_23731 *
                         (size_t) segred_group_sizze_23730};
            const size_t local_work_sizze_27665[1] = {segred_group_sizze_23730};
            int64_t time_start_27662 = 0, time_end_27663 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segred_nonseg_23728");
                fprintf(stderr, "%zu", global_work_sizze_27661[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_27665[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(float) *
                               segred_group_sizze_23730 +
                               (int32_t) sizeof(bool)));
                time_start_27662 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegred_nonseg_23728,
                                                            1, NULL,
                                                            global_work_sizze_27661,
                                                            local_work_sizze_27665,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegred_nonseg_23728_runs,
                                                                                                      &ctx->testzisegred_nonseg_23728_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_27663 = get_wall_time();
                
                long time_diff_27664 = time_end_27663 - time_start_27662;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segred_nonseg_23728", time_diff_27664);
            }
        }
        ctx->failure_is_an_option = 1;
        
        float read_res_27666;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27232.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(float),
                                                     sizeof(float),
                                                     &read_res_27666, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        float res_23866 = read_res_27666;
        
        if (memblock_unref_device(ctx, &mem_27232, "mem_27232") != 0)
            return 1;
        res_20359 = res_23866;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27376,
                                  "group_res_arr_mem_27376") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27232, "mem_27232") != 0)
            return 1;
    } else {
        struct memblock_device res_map_acc_mem_27247;
        
        res_map_acc_mem_27247.references = NULL;
        
        int32_t local_memory_capacity_27497;
        
        local_memory_capacity_27497 = ctx->opencl.max_local_memory;
        if (sle64(0, sext_i32_i64(local_memory_capacity_27497)) &&
            suff_outer_par_24591) {
            int64_t segmap_usable_groups_24602 = sdiv_up64(steps_20196,
                                                           segmap_group_sizze_24601);
            struct memblock_device mem_27235;
            
            mem_27235.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27235, bytes_27213,
                                      "mem_27235")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegMap");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23878, 1,
                                                    sizeof(ctx->failure_is_an_option),
                                                    &ctx->failure_is_an_option));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23878, 3,
                                                    sizeof(paths_20195),
                                                    &paths_20195));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23878, 4,
                                                    sizeof(steps_20196),
                                                    &steps_20196));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23878, 5,
                                                    sizeof(sims_per_year_20275),
                                                    &sims_per_year_20275));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23878, 6,
                                                    sizeof(res_20352),
                                                    &res_20352));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23878, 7,
                                                    sizeof(res_mem_27198.mem),
                                                    &res_mem_27198.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23878, 8,
                                                    sizeof(res_mem_27199.mem),
                                                    &res_mem_27199.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23878, 9,
                                                    sizeof(res_mem_27200.mem),
                                                    &res_mem_27200.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23878, 10,
                                                    sizeof(res_mem_27201.mem),
                                                    &res_mem_27201.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23878, 11,
                                                    sizeof(mem_27229.mem),
                                                    &mem_27229.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_23878, 12,
                                                    sizeof(mem_27235.mem),
                                                    &mem_27235.mem));
            if (1 * ((size_t) segmap_usable_groups_24602 *
                     (size_t) segmap_group_sizze_24601) != 0) {
                const size_t global_work_sizze_27667[1] =
                             {(size_t) segmap_usable_groups_24602 *
                             (size_t) segmap_group_sizze_24601};
                const size_t local_work_sizze_27671[1] =
                             {segmap_group_sizze_24601};
                int64_t time_start_27668 = 0, time_end_27669 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.segmap_23878");
                    fprintf(stderr, "%zu", global_work_sizze_27667[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_27671[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_27668 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testzisegmap_23878,
                                                                1, NULL,
                                                                global_work_sizze_27667,
                                                                local_work_sizze_27671,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testzisegmap_23878_runs,
                                                                                                          &ctx->testzisegmap_23878_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_27669 = get_wall_time();
                    
                    long time_diff_27670 = time_end_27669 - time_start_27668;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.segmap_23878", time_diff_27670);
                }
            }
            ctx->failure_is_an_option = 1;
            if (memblock_set_device(ctx, &res_map_acc_mem_27247, &mem_27235,
                                    "mem_27235") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27235, "mem_27235") != 0)
                return 1;
        } else {
            struct memblock_device res_map_acc_mem_27246;
            
            res_map_acc_mem_27246.references = NULL;
            
            int32_t local_memory_capacity_27496;
            
            local_memory_capacity_27496 = ctx->opencl.max_local_memory;
            if (sle64((int32_t) sizeof(float) * paths_20195,
                      sext_i32_i64(local_memory_capacity_27496)) &&
                intra_suff_and_fits_24598) {
                struct memblock_device mem_27239;
                
                mem_27239.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27239, bytes_27213,
                                          "mem_27239")) {
                    err = 1;
                    goto cleanup;
                }
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_23876,
                                                        1,
                                                        sizeof(ctx->failure_is_an_option),
                                                        &ctx->failure_is_an_option));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_23876,
                                                        3,
                                                        (int32_t) sizeof(float) *
                                                        paths_20195, NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_23876,
                                                        4, sizeof(paths_20195),
                                                        &paths_20195));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_23876,
                                                        5,
                                                        sizeof(sims_per_year_20275),
                                                        &sims_per_year_20275));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_23876,
                                                        6, sizeof(res_20352),
                                                        &res_20352));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_23876,
                                                        7,
                                                        sizeof(res_mem_27198.mem),
                                                        &res_mem_27198.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_23876,
                                                        8,
                                                        sizeof(res_mem_27199.mem),
                                                        &res_mem_27199.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_23876,
                                                        9,
                                                        sizeof(res_mem_27200.mem),
                                                        &res_mem_27200.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_23876,
                                                        10,
                                                        sizeof(res_mem_27201.mem),
                                                        &res_mem_27201.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_23876,
                                                        11,
                                                        sizeof(mem_27229.mem),
                                                        &mem_27229.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_23876,
                                                        12,
                                                        sizeof(mem_27239.mem),
                                                        &mem_27239.mem));
                if (1 * ((size_t) steps_20196 * (size_t) paths_20195) != 0) {
                    const size_t global_work_sizze_27672[1] =
                                 {(size_t) steps_20196 * (size_t) paths_20195};
                    const size_t local_work_sizze_27676[1] = {paths_20195};
                    int64_t time_start_27673 = 0, time_end_27674 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.segmap_intragroup_23876");
                        fprintf(stderr, "%zu", global_work_sizze_27672[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_27676[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(float) *
                                       paths_20195));
                        time_start_27673 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testzisegmap_intragroup_23876,
                                                                    1, NULL,
                                                                    global_work_sizze_27672,
                                                                    local_work_sizze_27676,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testzisegmap_intragroup_23876_runs,
                                                                                                              &ctx->testzisegmap_intragroup_23876_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_27674 = get_wall_time();
                        
                        long time_diff_27675 = time_end_27674 -
                             time_start_27673;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.segmap_intragroup_23876",
                                time_diff_27675);
                    }
                }
                ctx->failure_is_an_option = 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_27246, &mem_27239,
                                        "mem_27239") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27239, "mem_27239") != 0)
                    return 1;
            } else {
                struct memblock_device mem_27242;
                
                mem_27242.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27242, bytes_27213,
                                          "mem_27242")) {
                    err = 1;
                    goto cleanup;
                }
                if (slt64(paths_20195 * 2, segred_group_sizze_24873)) {
                    int64_t segment_sizze_nonzzero_27427 = smax64(1,
                                                                  paths_20195);
                    int64_t num_threads_27428 = num_groups_24874 *
                            segred_group_sizze_24873;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-small");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) steps_20196, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) paths_20195, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segments_per_group",
                                (long long) squot64(segred_group_sizze_24873,
                                                    segment_sizze_nonzzero_27427),
                                '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "required_groups",
                                (long long) sext_i64_i32(sdiv_up64(steps_20196,
                                                                   squot64(segred_group_sizze_24873,
                                                                           segment_sizze_nonzzero_27427))),
                                '\n');
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_24318,
                                                            1,
                                                            sizeof(ctx->failure_is_an_option),
                                                            &ctx->failure_is_an_option));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_24318,
                                                            3,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_24873,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_24318,
                                                            4,
                                                            sizeof(paths_20195),
                                                            &paths_20195));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_24318,
                                                            5,
                                                            sizeof(steps_20196),
                                                            &steps_20196));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_24318,
                                                            6,
                                                            sizeof(sims_per_year_20275),
                                                            &sims_per_year_20275));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_24318,
                                                            7,
                                                            sizeof(num_groups_24874),
                                                            &num_groups_24874));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_24318,
                                                            8,
                                                            sizeof(res_mem_27198.mem),
                                                            &res_mem_27198.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_24318,
                                                            9,
                                                            sizeof(res_mem_27199.mem),
                                                            &res_mem_27199.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_24318,
                                                            10,
                                                            sizeof(res_mem_27200.mem),
                                                            &res_mem_27200.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_24318,
                                                            11,
                                                            sizeof(res_mem_27201.mem),
                                                            &res_mem_27201.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_24318,
                                                            12,
                                                            sizeof(mem_27229.mem),
                                                            &mem_27229.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_24318,
                                                            13,
                                                            sizeof(mem_27242.mem),
                                                            &mem_27242.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_24318,
                                                            14,
                                                            sizeof(segment_sizze_nonzzero_27427),
                                                            &segment_sizze_nonzzero_27427));
                    if (1 * ((size_t) num_groups_24874 *
                             (size_t) segred_group_sizze_24873) != 0) {
                        const size_t global_work_sizze_27677[1] =
                                     {(size_t) num_groups_24874 *
                                     (size_t) segred_group_sizze_24873};
                        const size_t local_work_sizze_27681[1] =
                                     {segred_group_sizze_24873};
                        int64_t time_start_27678 = 0, time_end_27679 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.segred_small_24318");
                            fprintf(stderr, "%zu", global_work_sizze_27677[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_27681[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(float) *
                                           segred_group_sizze_24873));
                            time_start_27678 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testzisegred_small_24318,
                                                                        1, NULL,
                                                                        global_work_sizze_27677,
                                                                        local_work_sizze_27681,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testzisegred_small_24318_runs,
                                                                                                                  &ctx->testzisegred_small_24318_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_27679 = get_wall_time();
                            
                            long time_diff_27680 = time_end_27679 -
                                 time_start_27678;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.segred_small_24318", time_diff_27680);
                        }
                    }
                    ctx->failure_is_an_option = 1;
                } else {
                    int64_t groups_per_segment_27450 =
                            sdiv_up64(num_groups_24874, smax64(1, steps_20196));
                    int64_t elements_per_thread_27451 = sdiv_up64(paths_20195,
                                                                  segred_group_sizze_24873 *
                                                                  groups_per_segment_27450);
                    int64_t virt_num_groups_27452 = groups_per_segment_27450 *
                            steps_20196;
                    int64_t num_threads_27453 = num_groups_24874 *
                            segred_group_sizze_24873;
                    int64_t threads_per_segment_27454 =
                            groups_per_segment_27450 * segred_group_sizze_24873;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-large");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) steps_20196, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) paths_20195, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                                (long long) virt_num_groups_27452, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_groups",
                                (long long) num_groups_24874, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "group_size",
                                (long long) segred_group_sizze_24873, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                                (long long) elements_per_thread_27451, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                                (long long) groups_per_segment_27450, '\n');
                    
                    struct memblock_device group_res_arr_mem_27455;
                    
                    group_res_arr_mem_27455.references = NULL;
                    if (memblock_alloc_device(ctx, &group_res_arr_mem_27455,
                                              (int32_t) sizeof(float) *
                                              (segred_group_sizze_24873 *
                                               virt_num_groups_27452),
                                              "group_res_arr_mem_27455")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device testzicounter_mem_27457 =
                                           ctx->testzicounter_mem_27457;
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            1,
                                                            sizeof(ctx->failure_is_an_option),
                                                            &ctx->failure_is_an_option));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            3,
                                                            (int32_t) sizeof(bool),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            4,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_24873,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            5,
                                                            sizeof(paths_20195),
                                                            &paths_20195));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            6,
                                                            sizeof(sims_per_year_20275),
                                                            &sims_per_year_20275));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            7,
                                                            sizeof(num_groups_24874),
                                                            &num_groups_24874));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            8,
                                                            sizeof(res_mem_27198.mem),
                                                            &res_mem_27198.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            9,
                                                            sizeof(res_mem_27199.mem),
                                                            &res_mem_27199.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            10,
                                                            sizeof(res_mem_27200.mem),
                                                            &res_mem_27200.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            11,
                                                            sizeof(res_mem_27201.mem),
                                                            &res_mem_27201.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            12,
                                                            sizeof(mem_27229.mem),
                                                            &mem_27229.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            13,
                                                            sizeof(mem_27242.mem),
                                                            &mem_27242.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            14,
                                                            sizeof(groups_per_segment_27450),
                                                            &groups_per_segment_27450));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            15,
                                                            sizeof(elements_per_thread_27451),
                                                            &elements_per_thread_27451));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            16,
                                                            sizeof(virt_num_groups_27452),
                                                            &virt_num_groups_27452));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            17,
                                                            sizeof(threads_per_segment_27454),
                                                            &threads_per_segment_27454));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            18,
                                                            sizeof(group_res_arr_mem_27455.mem),
                                                            &group_res_arr_mem_27455.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_24318,
                                                            19,
                                                            sizeof(testzicounter_mem_27457.mem),
                                                            &testzicounter_mem_27457.mem));
                    if (1 * ((size_t) num_groups_24874 *
                             (size_t) segred_group_sizze_24873) != 0) {
                        const size_t global_work_sizze_27683[1] =
                                     {(size_t) num_groups_24874 *
                                     (size_t) segred_group_sizze_24873};
                        const size_t local_work_sizze_27687[1] =
                                     {segred_group_sizze_24873};
                        int64_t time_start_27684 = 0, time_end_27685 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.segred_large_24318");
                            fprintf(stderr, "%zu", global_work_sizze_27683[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_27687[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(bool) +
                                           (int32_t) sizeof(float) *
                                           segred_group_sizze_24873));
                            time_start_27684 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testzisegred_large_24318,
                                                                        1, NULL,
                                                                        global_work_sizze_27683,
                                                                        local_work_sizze_27687,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testzisegred_large_24318_runs,
                                                                                                                  &ctx->testzisegred_large_24318_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_27685 = get_wall_time();
                            
                            long time_diff_27686 = time_end_27685 -
                                 time_start_27684;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.segred_large_24318", time_diff_27686);
                        }
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_27455,
                                              "group_res_arr_mem_27455") != 0)
                        return 1;
                }
                
                int64_t segmap_usable_groups_24985 = sdiv_up64(steps_20196,
                                                               segmap_group_sizze_24984);
                struct memblock_device mem_27245;
                
                mem_27245.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27245, bytes_27213,
                                          "mem_27245")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_24283,
                                                        1, sizeof(steps_20196),
                                                        &steps_20196));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_24283,
                                                        2,
                                                        sizeof(sims_per_year_20275),
                                                        &sims_per_year_20275));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_24283,
                                                        3, sizeof(res_20352),
                                                        &res_20352));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_24283,
                                                        4,
                                                        sizeof(mem_27242.mem),
                                                        &mem_27242.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_24283,
                                                        5,
                                                        sizeof(mem_27245.mem),
                                                        &mem_27245.mem));
                if (1 * ((size_t) segmap_usable_groups_24985 *
                         (size_t) segmap_group_sizze_24984) != 0) {
                    const size_t global_work_sizze_27688[1] =
                                 {(size_t) segmap_usable_groups_24985 *
                                 (size_t) segmap_group_sizze_24984};
                    const size_t local_work_sizze_27692[1] =
                                 {segmap_group_sizze_24984};
                    int64_t time_start_27689 = 0, time_end_27690 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.segmap_24283");
                        fprintf(stderr, "%zu", global_work_sizze_27688[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_27692[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_27689 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testzisegmap_24283,
                                                                    1, NULL,
                                                                    global_work_sizze_27688,
                                                                    local_work_sizze_27692,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testzisegmap_24283_runs,
                                                                                                              &ctx->testzisegmap_24283_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_27690 = get_wall_time();
                        
                        long time_diff_27691 = time_end_27690 -
                             time_start_27689;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.segmap_24283", time_diff_27691);
                    }
                }
                if (memblock_unref_device(ctx, &mem_27242, "mem_27242") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_27246, &mem_27245,
                                        "mem_27245") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27245, "mem_27245") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27242, "mem_27242") != 0)
                    return 1;
            }
            if (memblock_set_device(ctx, &res_map_acc_mem_27247,
                                    &res_map_acc_mem_27246,
                                    "res_map_acc_mem_27246") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_map_acc_mem_27246,
                                      "res_map_acc_mem_27246") != 0)
                return 1;
        }
        
        struct memblock_device mem_27250;
        
        mem_27250.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27250, 4, "mem_27250")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device testzicounter_mem_27498 =
                               ctx->testzicounter_mem_27498;
        struct memblock_device group_res_arr_mem_27500;
        
        group_res_arr_mem_27500.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_27500,
                                  (int32_t) sizeof(float) *
                                  (segred_group_sizze_25010 * num_groups_25011),
                                  "group_res_arr_mem_27500")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_27502;
        
        num_threads_27502 = num_groups_25011 * segred_group_sizze_25010;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_24589,
                                                1, (int32_t) sizeof(float) *
                                                segred_group_sizze_25010,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_24589,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_24589,
                                                3, sizeof(steps_20196),
                                                &steps_20196));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_24589,
                                                4, sizeof(num_groups_25011),
                                                &num_groups_25011));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_24589,
                                                5,
                                                sizeof(res_map_acc_mem_27247.mem),
                                                &res_map_acc_mem_27247.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_24589,
                                                6, sizeof(mem_27250.mem),
                                                &mem_27250.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_24589,
                                                7,
                                                sizeof(testzicounter_mem_27498.mem),
                                                &testzicounter_mem_27498.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_24589,
                                                8,
                                                sizeof(group_res_arr_mem_27500.mem),
                                                &group_res_arr_mem_27500.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_24589,
                                                9, sizeof(num_threads_27502),
                                                &num_threads_27502));
        if (1 * ((size_t) num_groups_25011 *
                 (size_t) segred_group_sizze_25010) != 0) {
            const size_t global_work_sizze_27694[1] =
                         {(size_t) num_groups_25011 *
                         (size_t) segred_group_sizze_25010};
            const size_t local_work_sizze_27698[1] = {segred_group_sizze_25010};
            int64_t time_start_27695 = 0, time_end_27696 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segred_nonseg_24589");
                fprintf(stderr, "%zu", global_work_sizze_27694[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_27698[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(float) *
                               segred_group_sizze_25010 +
                               (int32_t) sizeof(bool)));
                time_start_27695 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegred_nonseg_24589,
                                                            1, NULL,
                                                            global_work_sizze_27694,
                                                            local_work_sizze_27698,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegred_nonseg_24589_runs,
                                                                                                      &ctx->testzisegred_nonseg_24589_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_27696 = get_wall_time();
                
                long time_diff_27697 = time_end_27696 - time_start_27695;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segred_nonseg_24589", time_diff_27697);
            }
        }
        if (memblock_unref_device(ctx, &res_map_acc_mem_27247,
                                  "res_map_acc_mem_27247") != 0)
            return 1;
        
        float read_res_27699;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27250.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(float),
                                                     sizeof(float),
                                                     &read_res_27699, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        float res_25018 = read_res_27699;
        
        if (memblock_unref_device(ctx, &mem_27250, "mem_27250") != 0)
            return 1;
        res_20359 = res_25018;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27500,
                                  "group_res_arr_mem_27500") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27250, "mem_27250") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_map_acc_mem_27247,
                                  "res_map_acc_mem_27247") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &res_mem_27198, "res_mem_27198") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27199, "res_mem_27199") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27200, "res_mem_27200") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27201, "res_mem_27201") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27229, "mem_27229") != 0)
        return 1;
    
    float CVA_20493 = 6.0e-3F * res_20359;
    
    scalar_out_27301 = CVA_20493;
    *out_scalar_out_27624 = scalar_out_27301;
    if (memblock_unref_device(ctx, &mem_27214, "mem_27214") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27229, "mem_27229") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27211, "mem_27211") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27208, "mem_27208") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27204, "mem_27204") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27201, "res_mem_27201") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27200, "res_mem_27200") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27199, "res_mem_27199") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27198, "res_mem_27198") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_27308,
                              "group_res_arr_mem_27308") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27179, "mem_27179") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27176, "mem_27176") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27174, "mem_27174") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27172, "mem_27172") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
static int futrts_test2(struct futhark_context *ctx,
                        float *out_scalar_out_27700, int64_t paths_20494,
                        int64_t steps_20495, int64_t numswaps_20496)
{
    (void) ctx;
    
    int err = 0;
    float scalar_out_27301;
    bool bounds_invalid_upwards_20497 = slt64(numswaps_20496, 0);
    bool valid_20498 = !bounds_invalid_upwards_20497;
    bool range_valid_c_20499;
    
    if (!valid_20498) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", numswaps_20496,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:126:11-16\n   #2  lib/github.com/diku-dk/cpprandom/random.fut:174:8-56\n   #3  cva-map.fut:179:29-62\n   #4  cva-map.fut:179:19-93\n   #5  cva-map.fut:177:1-183:76\n");
        return 1;
    }
    
    float res_20513 = sitofp_i64_f32(numswaps_20496);
    float res_20514 = res_20513 - 1.0F;
    int64_t segred_group_sizze_25022;
    
    segred_group_sizze_25022 = ctx->sizes.test2zisegred_group_sizze_25021;
    
    int64_t num_groups_25024;
    int32_t max_num_groups_27302;
    
    max_num_groups_27302 = ctx->sizes.test2zisegred_num_groups_25023;
    num_groups_25024 = sext_i64_i32(smax64(1, smin64(sdiv_up64(numswaps_20496,
                                                               sext_i32_i64(segred_group_sizze_25022)),
                                                     sext_i32_i64(max_num_groups_27302))));
    
    struct memblock_device mem_27173;
    
    mem_27173.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27173, 4, "mem_27173")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_27174 = 4 * numswaps_20496;
    struct memblock_device mem_27175;
    
    mem_27175.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27175, bytes_27174, "mem_27175")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_27176 = 8 * numswaps_20496;
    struct memblock_device mem_27177;
    
    mem_27177.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27177, bytes_27176, "mem_27177")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27179;
    
    mem_27179.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27179, bytes_27174, "mem_27179")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device test2zicounter_mem_27303 =
                           ctx->test2zicounter_mem_27303;
    struct memblock_device group_res_arr_mem_27305;
    
    group_res_arr_mem_27305.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_27305,
                              (int32_t) sizeof(float) *
                              (segred_group_sizze_25022 * num_groups_25024),
                              "group_res_arr_mem_27305")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_27307;
    
    num_threads_27307 = num_groups_25024 * segred_group_sizze_25022;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25032, 1,
                                            (int32_t) sizeof(float) *
                                            segred_group_sizze_25022, NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25032, 2,
                                            (int32_t) sizeof(bool), NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25032, 3,
                                            sizeof(numswaps_20496),
                                            &numswaps_20496));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25032, 4,
                                            sizeof(res_20514), &res_20514));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25032, 5,
                                            sizeof(num_groups_25024),
                                            &num_groups_25024));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25032, 6,
                                            sizeof(mem_27173.mem),
                                            &mem_27173.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25032, 7,
                                            sizeof(mem_27175.mem),
                                            &mem_27175.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25032, 8,
                                            sizeof(mem_27177.mem),
                                            &mem_27177.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25032, 9,
                                            sizeof(mem_27179.mem),
                                            &mem_27179.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25032, 10,
                                            sizeof(test2zicounter_mem_27303.mem),
                                            &test2zicounter_mem_27303.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25032, 11,
                                            sizeof(group_res_arr_mem_27305.mem),
                                            &group_res_arr_mem_27305.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25032, 12,
                                            sizeof(num_threads_27307),
                                            &num_threads_27307));
    if (1 * ((size_t) num_groups_25024 * (size_t) segred_group_sizze_25022) !=
        0) {
        const size_t global_work_sizze_27702[1] = {(size_t) num_groups_25024 *
                     (size_t) segred_group_sizze_25022};
        const size_t local_work_sizze_27706[1] = {segred_group_sizze_25022};
        int64_t time_start_27703 = 0, time_end_27704 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test2.segred_nonseg_25032");
            fprintf(stderr, "%zu", global_work_sizze_27702[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_27706[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) (0 + (int32_t) sizeof(float) *
                           segred_group_sizze_25022 + (int32_t) sizeof(bool)));
            time_start_27703 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->test2zisegred_nonseg_25032,
                                                        1, NULL,
                                                        global_work_sizze_27702,
                                                        local_work_sizze_27706,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->test2zisegred_nonseg_25032_runs,
                                                                                                  &ctx->test2zisegred_nonseg_25032_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_27704 = get_wall_time();
            
            long time_diff_27705 = time_end_27704 - time_start_27703;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "test2.segred_nonseg_25032", time_diff_27705);
        }
    }
    
    float read_res_27707;
    
    OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                 mem_27173.mem,
                                                 ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                 0 * sizeof(float),
                                                 sizeof(float), &read_res_27707,
                                                 0, NULL,
                                                 ctx->profiling_paused ||
                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                           &ctx->copy_scalar_from_dev_runs,
                                                                                           &ctx->copy_scalar_from_dev_total_runtime)));
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
        return 1;
    
    float res_20526 = read_res_27707;
    
    if (memblock_unref_device(ctx, &mem_27173, "mem_27173") != 0)
        return 1;
    
    float res_20564 = sitofp_i64_f32(steps_20495);
    float dt_20565 = res_20526 / res_20564;
    bool suff_outer_par_25034;
    
    suff_outer_par_25034 = ctx->sizes.test2zisuff_outer_par_0 <= numswaps_20496;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test2.suff_outer_par_0",
                numswaps_20496);
    
    int64_t segmap_group_sizze_25102;
    
    segmap_group_sizze_25102 = ctx->sizes.test2zisegmap_group_sizze_25038;
    
    int64_t segmap_group_sizze_25251;
    
    segmap_group_sizze_25251 = ctx->sizes.test2zisegmap_group_sizze_25187;
    
    struct memblock_device res_mem_27198;
    
    res_mem_27198.references = NULL;
    
    struct memblock_device res_mem_27199;
    
    res_mem_27199.references = NULL;
    
    struct memblock_device res_mem_27200;
    
    res_mem_27200.references = NULL;
    
    struct memblock_device res_mem_27201;
    
    res_mem_27201.references = NULL;
    
    int32_t local_memory_capacity_27345;
    
    local_memory_capacity_27345 = ctx->opencl.max_local_memory;
    if (sle64(0, sext_i32_i64(local_memory_capacity_27345)) &&
        suff_outer_par_25034) {
        int64_t segmap_usable_groups_25103 = sdiv_up64(numswaps_20496,
                                                       segmap_group_sizze_25102);
        struct memblock_device mem_27182;
        
        mem_27182.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27182, bytes_27174, "mem_27182")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27184;
        
        mem_27184.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27184, bytes_27174, "mem_27184")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27186;
        
        mem_27186.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27186, bytes_27176, "mem_27186")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27188;
        
        mem_27188.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27188, bytes_27174, "mem_27188")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25036, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25036, 3,
                                                sizeof(numswaps_20496),
                                                &numswaps_20496));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25036, 4,
                                                sizeof(mem_27175.mem),
                                                &mem_27175.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25036, 5,
                                                sizeof(mem_27177.mem),
                                                &mem_27177.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25036, 6,
                                                sizeof(mem_27179.mem),
                                                &mem_27179.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25036, 7,
                                                sizeof(mem_27182.mem),
                                                &mem_27182.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25036, 8,
                                                sizeof(mem_27184.mem),
                                                &mem_27184.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25036, 9,
                                                sizeof(mem_27186.mem),
                                                &mem_27186.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25036, 10,
                                                sizeof(mem_27188.mem),
                                                &mem_27188.mem));
        if (1 * ((size_t) segmap_usable_groups_25103 *
                 (size_t) segmap_group_sizze_25102) != 0) {
            const size_t global_work_sizze_27708[1] =
                         {(size_t) segmap_usable_groups_25103 *
                         (size_t) segmap_group_sizze_25102};
            const size_t local_work_sizze_27712[1] = {segmap_group_sizze_25102};
            int64_t time_start_27709 = 0, time_end_27710 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test2.segmap_25036");
                fprintf(stderr, "%zu", global_work_sizze_27708[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_27712[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_27709 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->test2zisegmap_25036,
                                                            1, NULL,
                                                            global_work_sizze_27708,
                                                            local_work_sizze_27712,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->test2zisegmap_25036_runs,
                                                                                                      &ctx->test2zisegmap_25036_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_27710 = get_wall_time();
                
                long time_diff_27711 = time_end_27710 - time_start_27709;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test2.segmap_25036", time_diff_27711);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_set_device(ctx, &res_mem_27198, &mem_27182, "mem_27182") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27199, &mem_27184, "mem_27184") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27200, &mem_27186, "mem_27186") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27201, &mem_27188, "mem_27188") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27188, "mem_27188") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27186, "mem_27186") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27184, "mem_27184") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27182, "mem_27182") != 0)
            return 1;
    } else {
        int64_t segmap_usable_groups_25252 = sdiv_up64(numswaps_20496,
                                                       segmap_group_sizze_25251);
        struct memblock_device mem_27191;
        
        mem_27191.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27191, bytes_27174, "mem_27191")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27193;
        
        mem_27193.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27193, bytes_27174, "mem_27193")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27195;
        
        mem_27195.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27195, bytes_27176, "mem_27195")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27197;
        
        mem_27197.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27197, bytes_27174, "mem_27197")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25185, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25185, 3,
                                                sizeof(numswaps_20496),
                                                &numswaps_20496));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25185, 4,
                                                sizeof(mem_27175.mem),
                                                &mem_27175.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25185, 5,
                                                sizeof(mem_27177.mem),
                                                &mem_27177.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25185, 6,
                                                sizeof(mem_27179.mem),
                                                &mem_27179.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25185, 7,
                                                sizeof(mem_27191.mem),
                                                &mem_27191.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25185, 8,
                                                sizeof(mem_27193.mem),
                                                &mem_27193.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25185, 9,
                                                sizeof(mem_27195.mem),
                                                &mem_27195.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25185, 10,
                                                sizeof(mem_27197.mem),
                                                &mem_27197.mem));
        if (1 * ((size_t) segmap_usable_groups_25252 *
                 (size_t) segmap_group_sizze_25251) != 0) {
            const size_t global_work_sizze_27713[1] =
                         {(size_t) segmap_usable_groups_25252 *
                         (size_t) segmap_group_sizze_25251};
            const size_t local_work_sizze_27717[1] = {segmap_group_sizze_25251};
            int64_t time_start_27714 = 0, time_end_27715 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test2.segmap_25185");
                fprintf(stderr, "%zu", global_work_sizze_27713[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_27717[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_27714 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->test2zisegmap_25185,
                                                            1, NULL,
                                                            global_work_sizze_27713,
                                                            local_work_sizze_27717,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->test2zisegmap_25185_runs,
                                                                                                      &ctx->test2zisegmap_25185_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_27715 = get_wall_time();
                
                long time_diff_27716 = time_end_27715 - time_start_27714;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test2.segmap_25185", time_diff_27716);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_set_device(ctx, &res_mem_27198, &mem_27191, "mem_27191") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27199, &mem_27193, "mem_27193") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27200, &mem_27195, "mem_27195") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27201, &mem_27197, "mem_27197") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27197, "mem_27197") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27195, "mem_27195") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27193, "mem_27193") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27191, "mem_27191") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_27175, "mem_27175") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27177, "mem_27177") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27179, "mem_27179") != 0)
        return 1;
    
    float sims_per_year_20630 = res_20564 / res_20526;
    bool bounds_invalid_upwards_20631 = slt64(steps_20495, 1);
    bool valid_20632 = !bounds_invalid_upwards_20631;
    bool range_valid_c_20633;
    
    if (!valid_20632) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 1, "..", 2, "...", steps_20495,
                               " is invalid.",
                               "-> #0  cva-map.fut:70:56-67\n   #1  cva-map.fut:122:17-44\n   #2  cva-map.fut:183:8-68\n   #3  cva-map.fut:177:1-183:76\n");
        if (memblock_unref_device(ctx, &res_mem_27201, "res_mem_27201") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27200, "res_mem_27200") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27199, "res_mem_27199") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27198, "res_mem_27198") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27305,
                                  "group_res_arr_mem_27305") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27179, "mem_27179") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27177, "mem_27177") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27175, "mem_27175") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27173, "mem_27173") != 0)
            return 1;
        return 1;
    }
    
    bool bounds_invalid_upwards_20639 = slt64(paths_20494, 0);
    bool valid_20640 = !bounds_invalid_upwards_20639;
    bool range_valid_c_20641;
    
    if (!valid_20640) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", paths_20494,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:126:11-16\n   #2  lib/github.com/diku-dk/cpprandom/random.fut:174:8-56\n   #3  cva-map.fut:125:19-49\n   #4  cva-map.fut:183:8-68\n   #5  cva-map.fut:177:1-183:76\n");
        if (memblock_unref_device(ctx, &res_mem_27201, "res_mem_27201") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27200, "res_mem_27200") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27199, "res_mem_27199") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27198, "res_mem_27198") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27305,
                                  "group_res_arr_mem_27305") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27179, "mem_27179") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27177, "mem_27177") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27175, "mem_27175") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27173, "mem_27173") != 0)
            return 1;
        return 1;
    }
    
    int64_t upper_bound_20644 = sub64(steps_20495, 1);
    float res_20645;
    
    res_20645 = futrts_sqrt32(dt_20565);
    
    int64_t segmap_group_sizze_25675;
    
    segmap_group_sizze_25675 = ctx->sizes.test2zisegmap_group_sizze_25658;
    
    int64_t segmap_usable_groups_25676 = sdiv_up64(paths_20494,
                                                   segmap_group_sizze_25675);
    int64_t bytes_27203 = 4 * paths_20494;
    struct memblock_device mem_27204;
    
    mem_27204.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27204, bytes_27203, "mem_27204")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25656, 1,
                                            sizeof(paths_20494), &paths_20494));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25656, 2,
                                            sizeof(mem_27204.mem),
                                            &mem_27204.mem));
    if (1 * ((size_t) segmap_usable_groups_25676 *
             (size_t) segmap_group_sizze_25675) != 0) {
        const size_t global_work_sizze_27718[1] =
                     {(size_t) segmap_usable_groups_25676 *
                     (size_t) segmap_group_sizze_25675};
        const size_t local_work_sizze_27722[1] = {segmap_group_sizze_25675};
        int64_t time_start_27719 = 0, time_end_27720 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test2.segmap_25656");
            fprintf(stderr, "%zu", global_work_sizze_27718[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_27722[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_27719 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->test2zisegmap_25656,
                                                        1, NULL,
                                                        global_work_sizze_27718,
                                                        local_work_sizze_27722,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->test2zisegmap_25656_runs,
                                                                                                  &ctx->test2zisegmap_25656_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_27720 = get_wall_time();
            
            long time_diff_27721 = time_end_27720 - time_start_27719;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "test2.segmap_25656",
                    time_diff_27721);
        }
    }
    
    int64_t nest_sizze_25699 = paths_20494 * steps_20495;
    int64_t segmap_group_sizze_25700;
    
    segmap_group_sizze_25700 = ctx->sizes.test2zisegmap_group_sizze_25595;
    
    int64_t segmap_usable_groups_25701 = sdiv_up64(nest_sizze_25699,
                                                   segmap_group_sizze_25700);
    int64_t bytes_27206 = 4 * nest_sizze_25699;
    struct memblock_device mem_27208;
    
    mem_27208.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27208, bytes_27206, "mem_27208")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25592, 1,
                                            sizeof(paths_20494), &paths_20494));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25592, 2,
                                            sizeof(steps_20495), &steps_20495));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25592, 3,
                                            sizeof(mem_27204.mem),
                                            &mem_27204.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25592, 4,
                                            sizeof(mem_27208.mem),
                                            &mem_27208.mem));
    if (1 * ((size_t) segmap_usable_groups_25701 *
             (size_t) segmap_group_sizze_25700) != 0) {
        const size_t global_work_sizze_27723[1] =
                     {(size_t) segmap_usable_groups_25701 *
                     (size_t) segmap_group_sizze_25700};
        const size_t local_work_sizze_27727[1] = {segmap_group_sizze_25700};
        int64_t time_start_27724 = 0, time_end_27725 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test2.segmap_25592");
            fprintf(stderr, "%zu", global_work_sizze_27723[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_27727[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_27724 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->test2zisegmap_25592,
                                                        1, NULL,
                                                        global_work_sizze_27723,
                                                        local_work_sizze_27727,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->test2zisegmap_25592_runs,
                                                                                                  &ctx->test2zisegmap_25592_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_27725 = get_wall_time();
            
            long time_diff_27726 = time_end_27725 - time_start_27724;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "test2.segmap_25592",
                    time_diff_27726);
        }
    }
    if (memblock_unref_device(ctx, &mem_27204, "mem_27204") != 0)
        return 1;
    
    int64_t segmap_group_sizze_25745;
    
    segmap_group_sizze_25745 = ctx->sizes.test2zisegmap_group_sizze_25496;
    
    int64_t num_groups_25746;
    int32_t max_num_groups_27356;
    
    max_num_groups_27356 = ctx->sizes.test2zisegmap_num_groups_25498;
    num_groups_25746 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_20494,
                                                               sext_i32_i64(segmap_group_sizze_25745)),
                                                     sext_i32_i64(max_num_groups_27356))));
    
    struct memblock_device mem_27211;
    
    mem_27211.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27211, bytes_27206, "mem_27211")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27211, 0, mem_27208, 0,
                                              1, steps_20495, paths_20494) !=
        0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &mem_27208, "mem_27208") != 0)
        return 1;
    
    struct memblock_device mem_27229;
    
    mem_27229.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27229, bytes_27206, "mem_27229")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_27213 = 4 * steps_20495;
    int64_t num_threads_27293 = segmap_group_sizze_25745 * num_groups_25746;
    int64_t total_sizze_27294 = bytes_27213 * num_threads_27293;
    struct memblock_device mem_27214;
    
    mem_27214.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27214, total_sizze_27294,
                              "mem_27214")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25494, 1,
                                            sizeof(ctx->failure_is_an_option),
                                            &ctx->failure_is_an_option));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25494, 3,
                                            sizeof(paths_20494), &paths_20494));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25494, 4,
                                            sizeof(steps_20495), &steps_20495));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25494, 5,
                                            sizeof(dt_20565), &dt_20565));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25494, 6,
                                            sizeof(upper_bound_20644),
                                            &upper_bound_20644));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25494, 7,
                                            sizeof(res_20645), &res_20645));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25494, 8,
                                            sizeof(num_groups_25746),
                                            &num_groups_25746));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25494, 9,
                                            sizeof(mem_27211.mem),
                                            &mem_27211.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25494, 10,
                                            sizeof(mem_27214.mem),
                                            &mem_27214.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25494, 11,
                                            sizeof(mem_27229.mem),
                                            &mem_27229.mem));
    if (1 * ((size_t) num_groups_25746 * (size_t) segmap_group_sizze_25745) !=
        0) {
        const size_t global_work_sizze_27728[1] = {(size_t) num_groups_25746 *
                     (size_t) segmap_group_sizze_25745};
        const size_t local_work_sizze_27732[1] = {segmap_group_sizze_25745};
        int64_t time_start_27729 = 0, time_end_27730 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test2.segmap_25494");
            fprintf(stderr, "%zu", global_work_sizze_27728[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_27732[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_27729 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->test2zisegmap_25494,
                                                        1, NULL,
                                                        global_work_sizze_27728,
                                                        local_work_sizze_27732,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->test2zisegmap_25494_runs,
                                                                                                  &ctx->test2zisegmap_25494_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_27730 = get_wall_time();
            
            long time_diff_27731 = time_end_27730 - time_start_27729;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "test2.segmap_25494",
                    time_diff_27731);
        }
    }
    ctx->failure_is_an_option = 1;
    if (memblock_unref_device(ctx, &mem_27211, "mem_27211") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27214, "mem_27214") != 0)
        return 1;
    
    float res_20707 = sitofp_i64_f32(paths_20494);
    bool suff_outer_redomap_25772;
    
    suff_outer_redomap_25772 = ctx->sizes.test2zisuff_outer_redomap_5 <=
        steps_20495;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test2.suff_outer_redomap_5",
                steps_20495);
    
    int64_t segred_group_sizze_25784;
    
    segred_group_sizze_25784 = ctx->sizes.test2zisegred_group_sizze_25774;
    
    int64_t num_groups_25785;
    int32_t max_num_groups_27368;
    
    max_num_groups_27368 = ctx->sizes.test2zisegred_num_groups_25776;
    num_groups_25785 = sext_i64_i32(smax64(1, smin64(sdiv_up64(steps_20495,
                                                               sext_i32_i64(segred_group_sizze_25784)),
                                                     sext_i32_i64(max_num_groups_27368))));
    
    bool suff_outer_par_26645;
    
    suff_outer_par_26645 = ctx->sizes.test2zisuff_outer_par_6 <= steps_20495;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test2.suff_outer_par_6",
                steps_20495);
    
    int64_t max_group_sizze_26648;
    
    max_group_sizze_26648 = ctx->opencl.max_group_size;
    
    bool fits_26649 = sle64(paths_20494, max_group_sizze_26648);
    bool suff_intra_par_26651;
    
    suff_intra_par_26651 = ctx->sizes.test2zisuff_intra_par_7 <= paths_20494;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test2.suff_intra_par_7",
                paths_20494);
    
    bool intra_suff_and_fits_26652 = fits_26649 && suff_intra_par_26651;
    int64_t segmap_group_sizze_26655;
    
    segmap_group_sizze_26655 = ctx->sizes.test2zisegmap_group_sizze_25934;
    
    int64_t segred_group_sizze_26927;
    
    segred_group_sizze_26927 = ctx->sizes.test2zisegred_group_sizze_26366;
    
    int64_t num_groups_26928;
    int32_t max_num_groups_27369;
    
    max_num_groups_27369 = ctx->sizes.test2zisegred_num_groups_26368;
    num_groups_26928 = sext_i64_i32(smax64(1, smin64(sdiv_up64(nest_sizze_25699,
                                                               sext_i32_i64(segred_group_sizze_26927)),
                                                     sext_i32_i64(max_num_groups_27369))));
    
    int64_t segmap_group_sizze_27038;
    
    segmap_group_sizze_27038 = ctx->sizes.test2zisegmap_group_sizze_26339;
    
    int64_t segred_group_sizze_27064;
    
    segred_group_sizze_27064 = ctx->sizes.test2zisegred_group_sizze_26635;
    
    int64_t num_groups_27065;
    int32_t max_num_groups_27370;
    
    max_num_groups_27370 = ctx->sizes.test2zisegred_num_groups_26637;
    num_groups_27065 = sext_i64_i32(smax64(1, smin64(sdiv_up64(steps_20495,
                                                               sext_i32_i64(segred_group_sizze_27064)),
                                                     sext_i32_i64(max_num_groups_27370))));
    
    float res_20714;
    int32_t local_memory_capacity_27525;
    
    local_memory_capacity_27525 = ctx->opencl.max_local_memory;
    if (sle64((int32_t) sizeof(bool) + (int32_t) sizeof(float) *
              segred_group_sizze_25784,
              sext_i32_i64(local_memory_capacity_27525)) &&
        suff_outer_redomap_25772) {
        struct memblock_device mem_27232;
        
        mem_27232.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27232, 4, "mem_27232")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device test2zicounter_mem_27371 =
                               ctx->test2zicounter_mem_27371;
        struct memblock_device group_res_arr_mem_27373;
        
        group_res_arr_mem_27373.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_27373,
                                  (int32_t) sizeof(float) *
                                  (segred_group_sizze_25784 * num_groups_25785),
                                  "group_res_arr_mem_27373")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_27375;
        
        num_threads_27375 = num_groups_25785 * segred_group_sizze_25784;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                3, (int32_t) sizeof(float) *
                                                segred_group_sizze_25784,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                4, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                5, sizeof(paths_20494),
                                                &paths_20494));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                6, sizeof(steps_20495),
                                                &steps_20495));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                7, sizeof(numswaps_20496),
                                                &numswaps_20496));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                8, sizeof(sims_per_year_20630),
                                                &sims_per_year_20630));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                9, sizeof(res_20707),
                                                &res_20707));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                10, sizeof(num_groups_25785),
                                                &num_groups_25785));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                11, sizeof(res_mem_27198.mem),
                                                &res_mem_27198.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                12, sizeof(res_mem_27199.mem),
                                                &res_mem_27199.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                13, sizeof(res_mem_27200.mem),
                                                &res_mem_27200.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                14, sizeof(res_mem_27201.mem),
                                                &res_mem_27201.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                15, sizeof(mem_27229.mem),
                                                &mem_27229.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                16, sizeof(mem_27232.mem),
                                                &mem_27232.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                17,
                                                sizeof(test2zicounter_mem_27371.mem),
                                                &test2zicounter_mem_27371.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                18,
                                                sizeof(group_res_arr_mem_27373.mem),
                                                &group_res_arr_mem_27373.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_25782,
                                                19, sizeof(num_threads_27375),
                                                &num_threads_27375));
        if (1 * ((size_t) num_groups_25785 *
                 (size_t) segred_group_sizze_25784) != 0) {
            const size_t global_work_sizze_27734[1] =
                         {(size_t) num_groups_25785 *
                         (size_t) segred_group_sizze_25784};
            const size_t local_work_sizze_27738[1] = {segred_group_sizze_25784};
            int64_t time_start_27735 = 0, time_end_27736 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test2.segred_nonseg_25782");
                fprintf(stderr, "%zu", global_work_sizze_27734[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_27738[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(float) *
                               segred_group_sizze_25784 +
                               (int32_t) sizeof(bool)));
                time_start_27735 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->test2zisegred_nonseg_25782,
                                                            1, NULL,
                                                            global_work_sizze_27734,
                                                            local_work_sizze_27738,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->test2zisegred_nonseg_25782_runs,
                                                                                                      &ctx->test2zisegred_nonseg_25782_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_27736 = get_wall_time();
                
                long time_diff_27737 = time_end_27736 - time_start_27735;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test2.segred_nonseg_25782", time_diff_27737);
            }
        }
        ctx->failure_is_an_option = 1;
        
        float read_res_27739;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27232.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(float),
                                                     sizeof(float),
                                                     &read_res_27739, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        float res_25920 = read_res_27739;
        
        if (memblock_unref_device(ctx, &mem_27232, "mem_27232") != 0)
            return 1;
        res_20714 = res_25920;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27373,
                                  "group_res_arr_mem_27373") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27232, "mem_27232") != 0)
            return 1;
    } else {
        struct memblock_device res_map_acc_mem_27247;
        
        res_map_acc_mem_27247.references = NULL;
        
        int32_t local_memory_capacity_27494;
        
        local_memory_capacity_27494 = ctx->opencl.max_local_memory;
        if (sle64(0, sext_i32_i64(local_memory_capacity_27494)) &&
            suff_outer_par_26645) {
            int64_t segmap_usable_groups_26656 = sdiv_up64(steps_20495,
                                                           segmap_group_sizze_26655);
            struct memblock_device mem_27235;
            
            mem_27235.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27235, bytes_27213,
                                      "mem_27235")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegMap");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25932, 1,
                                                    sizeof(ctx->failure_is_an_option),
                                                    &ctx->failure_is_an_option));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25932, 3,
                                                    sizeof(paths_20494),
                                                    &paths_20494));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25932, 4,
                                                    sizeof(steps_20495),
                                                    &steps_20495));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25932, 5,
                                                    sizeof(numswaps_20496),
                                                    &numswaps_20496));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25932, 6,
                                                    sizeof(sims_per_year_20630),
                                                    &sims_per_year_20630));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25932, 7,
                                                    sizeof(res_20707),
                                                    &res_20707));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25932, 8,
                                                    sizeof(res_mem_27198.mem),
                                                    &res_mem_27198.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25932, 9,
                                                    sizeof(res_mem_27199.mem),
                                                    &res_mem_27199.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25932,
                                                    10,
                                                    sizeof(res_mem_27200.mem),
                                                    &res_mem_27200.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25932,
                                                    11,
                                                    sizeof(res_mem_27201.mem),
                                                    &res_mem_27201.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25932,
                                                    12, sizeof(mem_27229.mem),
                                                    &mem_27229.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_25932,
                                                    13, sizeof(mem_27235.mem),
                                                    &mem_27235.mem));
            if (1 * ((size_t) segmap_usable_groups_26656 *
                     (size_t) segmap_group_sizze_26655) != 0) {
                const size_t global_work_sizze_27740[1] =
                             {(size_t) segmap_usable_groups_26656 *
                             (size_t) segmap_group_sizze_26655};
                const size_t local_work_sizze_27744[1] =
                             {segmap_group_sizze_26655};
                int64_t time_start_27741 = 0, time_end_27742 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test2.segmap_25932");
                    fprintf(stderr, "%zu", global_work_sizze_27740[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_27744[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_27741 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->test2zisegmap_25932,
                                                                1, NULL,
                                                                global_work_sizze_27740,
                                                                local_work_sizze_27744,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->test2zisegmap_25932_runs,
                                                                                                          &ctx->test2zisegmap_25932_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_27742 = get_wall_time();
                    
                    long time_diff_27743 = time_end_27742 - time_start_27741;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test2.segmap_25932", time_diff_27743);
                }
            }
            ctx->failure_is_an_option = 1;
            if (memblock_set_device(ctx, &res_map_acc_mem_27247, &mem_27235,
                                    "mem_27235") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27235, "mem_27235") != 0)
                return 1;
        } else {
            struct memblock_device res_map_acc_mem_27246;
            
            res_map_acc_mem_27246.references = NULL;
            
            int32_t local_memory_capacity_27493;
            
            local_memory_capacity_27493 = ctx->opencl.max_local_memory;
            if (sle64((int32_t) sizeof(float) * paths_20494,
                      sext_i32_i64(local_memory_capacity_27493)) &&
                intra_suff_and_fits_26652) {
                struct memblock_device mem_27239;
                
                mem_27239.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27239, bytes_27213,
                                          "mem_27239")) {
                    err = 1;
                    goto cleanup;
                }
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_intragroup_25930,
                                                        1,
                                                        sizeof(ctx->failure_is_an_option),
                                                        &ctx->failure_is_an_option));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_intragroup_25930,
                                                        3,
                                                        (int32_t) sizeof(float) *
                                                        paths_20494, NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_intragroup_25930,
                                                        4, sizeof(paths_20494),
                                                        &paths_20494));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_intragroup_25930,
                                                        5,
                                                        sizeof(numswaps_20496),
                                                        &numswaps_20496));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_intragroup_25930,
                                                        6,
                                                        sizeof(sims_per_year_20630),
                                                        &sims_per_year_20630));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_intragroup_25930,
                                                        7, sizeof(res_20707),
                                                        &res_20707));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_intragroup_25930,
                                                        8,
                                                        sizeof(res_mem_27198.mem),
                                                        &res_mem_27198.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_intragroup_25930,
                                                        9,
                                                        sizeof(res_mem_27199.mem),
                                                        &res_mem_27199.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_intragroup_25930,
                                                        10,
                                                        sizeof(res_mem_27200.mem),
                                                        &res_mem_27200.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_intragroup_25930,
                                                        11,
                                                        sizeof(res_mem_27201.mem),
                                                        &res_mem_27201.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_intragroup_25930,
                                                        12,
                                                        sizeof(mem_27229.mem),
                                                        &mem_27229.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_intragroup_25930,
                                                        13,
                                                        sizeof(mem_27239.mem),
                                                        &mem_27239.mem));
                if (1 * ((size_t) steps_20495 * (size_t) paths_20494) != 0) {
                    const size_t global_work_sizze_27745[1] =
                                 {(size_t) steps_20495 * (size_t) paths_20494};
                    const size_t local_work_sizze_27749[1] = {paths_20494};
                    int64_t time_start_27746 = 0, time_end_27747 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test2.segmap_intragroup_25930");
                        fprintf(stderr, "%zu", global_work_sizze_27745[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_27749[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(float) *
                                       paths_20494));
                        time_start_27746 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->test2zisegmap_intragroup_25930,
                                                                    1, NULL,
                                                                    global_work_sizze_27745,
                                                                    local_work_sizze_27749,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->test2zisegmap_intragroup_25930_runs,
                                                                                                              &ctx->test2zisegmap_intragroup_25930_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_27747 = get_wall_time();
                        
                        long time_diff_27748 = time_end_27747 -
                             time_start_27746;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test2.segmap_intragroup_25930",
                                time_diff_27748);
                    }
                }
                ctx->failure_is_an_option = 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_27246, &mem_27239,
                                        "mem_27239") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27239, "mem_27239") != 0)
                    return 1;
            } else {
                struct memblock_device mem_27242;
                
                mem_27242.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27242, bytes_27213,
                                          "mem_27242")) {
                    err = 1;
                    goto cleanup;
                }
                if (slt64(paths_20494 * 2, segred_group_sizze_26927)) {
                    int64_t segment_sizze_nonzzero_27424 = smax64(1,
                                                                  paths_20494);
                    int64_t num_threads_27425 = num_groups_26928 *
                            segred_group_sizze_26927;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-small");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) steps_20495, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) paths_20494, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segments_per_group",
                                (long long) squot64(segred_group_sizze_26927,
                                                    segment_sizze_nonzzero_27424),
                                '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "required_groups",
                                (long long) sext_i64_i32(sdiv_up64(steps_20495,
                                                                   squot64(segred_group_sizze_26927,
                                                                           segment_sizze_nonzzero_27424))),
                                '\n');
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_small_26372,
                                                            1,
                                                            sizeof(ctx->failure_is_an_option),
                                                            &ctx->failure_is_an_option));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_small_26372,
                                                            3,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_26927,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_small_26372,
                                                            4,
                                                            sizeof(paths_20494),
                                                            &paths_20494));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_small_26372,
                                                            5,
                                                            sizeof(steps_20495),
                                                            &steps_20495));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_small_26372,
                                                            6,
                                                            sizeof(numswaps_20496),
                                                            &numswaps_20496));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_small_26372,
                                                            7,
                                                            sizeof(sims_per_year_20630),
                                                            &sims_per_year_20630));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_small_26372,
                                                            8,
                                                            sizeof(num_groups_26928),
                                                            &num_groups_26928));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_small_26372,
                                                            9,
                                                            sizeof(res_mem_27198.mem),
                                                            &res_mem_27198.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_small_26372,
                                                            10,
                                                            sizeof(res_mem_27199.mem),
                                                            &res_mem_27199.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_small_26372,
                                                            11,
                                                            sizeof(res_mem_27200.mem),
                                                            &res_mem_27200.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_small_26372,
                                                            12,
                                                            sizeof(res_mem_27201.mem),
                                                            &res_mem_27201.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_small_26372,
                                                            13,
                                                            sizeof(mem_27229.mem),
                                                            &mem_27229.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_small_26372,
                                                            14,
                                                            sizeof(mem_27242.mem),
                                                            &mem_27242.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_small_26372,
                                                            15,
                                                            sizeof(segment_sizze_nonzzero_27424),
                                                            &segment_sizze_nonzzero_27424));
                    if (1 * ((size_t) num_groups_26928 *
                             (size_t) segred_group_sizze_26927) != 0) {
                        const size_t global_work_sizze_27750[1] =
                                     {(size_t) num_groups_26928 *
                                     (size_t) segred_group_sizze_26927};
                        const size_t local_work_sizze_27754[1] =
                                     {segred_group_sizze_26927};
                        int64_t time_start_27751 = 0, time_end_27752 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test2.segred_small_26372");
                            fprintf(stderr, "%zu", global_work_sizze_27750[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_27754[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(float) *
                                           segred_group_sizze_26927));
                            time_start_27751 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->test2zisegred_small_26372,
                                                                        1, NULL,
                                                                        global_work_sizze_27750,
                                                                        local_work_sizze_27754,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->test2zisegred_small_26372_runs,
                                                                                                                  &ctx->test2zisegred_small_26372_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_27752 = get_wall_time();
                            
                            long time_diff_27753 = time_end_27752 -
                                 time_start_27751;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test2.segred_small_26372",
                                    time_diff_27753);
                        }
                    }
                    ctx->failure_is_an_option = 1;
                } else {
                    int64_t groups_per_segment_27447 =
                            sdiv_up64(num_groups_26928, smax64(1, steps_20495));
                    int64_t elements_per_thread_27448 = sdiv_up64(paths_20494,
                                                                  segred_group_sizze_26927 *
                                                                  groups_per_segment_27447);
                    int64_t virt_num_groups_27449 = groups_per_segment_27447 *
                            steps_20495;
                    int64_t num_threads_27450 = num_groups_26928 *
                            segred_group_sizze_26927;
                    int64_t threads_per_segment_27451 =
                            groups_per_segment_27447 * segred_group_sizze_26927;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-large");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) steps_20495, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) paths_20494, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                                (long long) virt_num_groups_27449, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_groups",
                                (long long) num_groups_26928, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "group_size",
                                (long long) segred_group_sizze_26927, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                                (long long) elements_per_thread_27448, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                                (long long) groups_per_segment_27447, '\n');
                    
                    struct memblock_device group_res_arr_mem_27452;
                    
                    group_res_arr_mem_27452.references = NULL;
                    if (memblock_alloc_device(ctx, &group_res_arr_mem_27452,
                                              (int32_t) sizeof(float) *
                                              (segred_group_sizze_26927 *
                                               virt_num_groups_27449),
                                              "group_res_arr_mem_27452")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device test2zicounter_mem_27454 =
                                           ctx->test2zicounter_mem_27454;
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            1,
                                                            sizeof(ctx->failure_is_an_option),
                                                            &ctx->failure_is_an_option));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            3,
                                                            (int32_t) sizeof(bool),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            4,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_26927,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            5,
                                                            sizeof(paths_20494),
                                                            &paths_20494));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            6,
                                                            sizeof(numswaps_20496),
                                                            &numswaps_20496));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            7,
                                                            sizeof(sims_per_year_20630),
                                                            &sims_per_year_20630));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            8,
                                                            sizeof(num_groups_26928),
                                                            &num_groups_26928));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            9,
                                                            sizeof(res_mem_27198.mem),
                                                            &res_mem_27198.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            10,
                                                            sizeof(res_mem_27199.mem),
                                                            &res_mem_27199.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            11,
                                                            sizeof(res_mem_27200.mem),
                                                            &res_mem_27200.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            12,
                                                            sizeof(res_mem_27201.mem),
                                                            &res_mem_27201.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            13,
                                                            sizeof(mem_27229.mem),
                                                            &mem_27229.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            14,
                                                            sizeof(mem_27242.mem),
                                                            &mem_27242.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            15,
                                                            sizeof(groups_per_segment_27447),
                                                            &groups_per_segment_27447));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            16,
                                                            sizeof(elements_per_thread_27448),
                                                            &elements_per_thread_27448));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            17,
                                                            sizeof(virt_num_groups_27449),
                                                            &virt_num_groups_27449));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            18,
                                                            sizeof(threads_per_segment_27451),
                                                            &threads_per_segment_27451));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            19,
                                                            sizeof(group_res_arr_mem_27452.mem),
                                                            &group_res_arr_mem_27452.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_large_26372,
                                                            20,
                                                            sizeof(test2zicounter_mem_27454.mem),
                                                            &test2zicounter_mem_27454.mem));
                    if (1 * ((size_t) num_groups_26928 *
                             (size_t) segred_group_sizze_26927) != 0) {
                        const size_t global_work_sizze_27756[1] =
                                     {(size_t) num_groups_26928 *
                                     (size_t) segred_group_sizze_26927};
                        const size_t local_work_sizze_27760[1] =
                                     {segred_group_sizze_26927};
                        int64_t time_start_27757 = 0, time_end_27758 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test2.segred_large_26372");
                            fprintf(stderr, "%zu", global_work_sizze_27756[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_27760[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(bool) +
                                           (int32_t) sizeof(float) *
                                           segred_group_sizze_26927));
                            time_start_27757 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->test2zisegred_large_26372,
                                                                        1, NULL,
                                                                        global_work_sizze_27756,
                                                                        local_work_sizze_27760,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->test2zisegred_large_26372_runs,
                                                                                                                  &ctx->test2zisegred_large_26372_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_27758 = get_wall_time();
                            
                            long time_diff_27759 = time_end_27758 -
                                 time_start_27757;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test2.segred_large_26372",
                                    time_diff_27759);
                        }
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_27452,
                                              "group_res_arr_mem_27452") != 0)
                        return 1;
                }
                
                int64_t segmap_usable_groups_27039 = sdiv_up64(steps_20495,
                                                               segmap_group_sizze_27038);
                struct memblock_device mem_27245;
                
                mem_27245.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27245, bytes_27213,
                                          "mem_27245")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_26337,
                                                        1, sizeof(steps_20495),
                                                        &steps_20495));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_26337,
                                                        2,
                                                        sizeof(sims_per_year_20630),
                                                        &sims_per_year_20630));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_26337,
                                                        3, sizeof(res_20707),
                                                        &res_20707));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_26337,
                                                        4,
                                                        sizeof(mem_27242.mem),
                                                        &mem_27242.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegmap_26337,
                                                        5,
                                                        sizeof(mem_27245.mem),
                                                        &mem_27245.mem));
                if (1 * ((size_t) segmap_usable_groups_27039 *
                         (size_t) segmap_group_sizze_27038) != 0) {
                    const size_t global_work_sizze_27761[1] =
                                 {(size_t) segmap_usable_groups_27039 *
                                 (size_t) segmap_group_sizze_27038};
                    const size_t local_work_sizze_27765[1] =
                                 {segmap_group_sizze_27038};
                    int64_t time_start_27762 = 0, time_end_27763 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test2.segmap_26337");
                        fprintf(stderr, "%zu", global_work_sizze_27761[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_27765[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_27762 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->test2zisegmap_26337,
                                                                    1, NULL,
                                                                    global_work_sizze_27761,
                                                                    local_work_sizze_27765,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->test2zisegmap_26337_runs,
                                                                                                              &ctx->test2zisegmap_26337_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_27763 = get_wall_time();
                        
                        long time_diff_27764 = time_end_27763 -
                             time_start_27762;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test2.segmap_26337", time_diff_27764);
                    }
                }
                if (memblock_unref_device(ctx, &mem_27242, "mem_27242") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_27246, &mem_27245,
                                        "mem_27245") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27245, "mem_27245") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27242, "mem_27242") != 0)
                    return 1;
            }
            if (memblock_set_device(ctx, &res_map_acc_mem_27247,
                                    &res_map_acc_mem_27246,
                                    "res_map_acc_mem_27246") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_map_acc_mem_27246,
                                      "res_map_acc_mem_27246") != 0)
                return 1;
        }
        
        struct memblock_device mem_27250;
        
        mem_27250.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27250, 4, "mem_27250")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device test2zicounter_mem_27495 =
                               ctx->test2zicounter_mem_27495;
        struct memblock_device group_res_arr_mem_27497;
        
        group_res_arr_mem_27497.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_27497,
                                  (int32_t) sizeof(float) *
                                  (segred_group_sizze_27064 * num_groups_27065),
                                  "group_res_arr_mem_27497")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_27499;
        
        num_threads_27499 = num_groups_27065 * segred_group_sizze_27064;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_26643,
                                                1, (int32_t) sizeof(float) *
                                                segred_group_sizze_27064,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_26643,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_26643,
                                                3, sizeof(steps_20495),
                                                &steps_20495));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_26643,
                                                4, sizeof(num_groups_27065),
                                                &num_groups_27065));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_26643,
                                                5,
                                                sizeof(res_map_acc_mem_27247.mem),
                                                &res_map_acc_mem_27247.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_26643,
                                                6, sizeof(mem_27250.mem),
                                                &mem_27250.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_26643,
                                                7,
                                                sizeof(test2zicounter_mem_27495.mem),
                                                &test2zicounter_mem_27495.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_26643,
                                                8,
                                                sizeof(group_res_arr_mem_27497.mem),
                                                &group_res_arr_mem_27497.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->test2zisegred_nonseg_26643,
                                                9, sizeof(num_threads_27499),
                                                &num_threads_27499));
        if (1 * ((size_t) num_groups_27065 *
                 (size_t) segred_group_sizze_27064) != 0) {
            const size_t global_work_sizze_27767[1] =
                         {(size_t) num_groups_27065 *
                         (size_t) segred_group_sizze_27064};
            const size_t local_work_sizze_27771[1] = {segred_group_sizze_27064};
            int64_t time_start_27768 = 0, time_end_27769 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test2.segred_nonseg_26643");
                fprintf(stderr, "%zu", global_work_sizze_27767[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_27771[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(float) *
                               segred_group_sizze_27064 +
                               (int32_t) sizeof(bool)));
                time_start_27768 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->test2zisegred_nonseg_26643,
                                                            1, NULL,
                                                            global_work_sizze_27767,
                                                            local_work_sizze_27771,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->test2zisegred_nonseg_26643_runs,
                                                                                                      &ctx->test2zisegred_nonseg_26643_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_27769 = get_wall_time();
                
                long time_diff_27770 = time_end_27769 - time_start_27768;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test2.segred_nonseg_26643", time_diff_27770);
            }
        }
        if (memblock_unref_device(ctx, &res_map_acc_mem_27247,
                                  "res_map_acc_mem_27247") != 0)
            return 1;
        
        float read_res_27772;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27250.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(float),
                                                     sizeof(float),
                                                     &read_res_27772, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        float res_27072 = read_res_27772;
        
        if (memblock_unref_device(ctx, &mem_27250, "mem_27250") != 0)
            return 1;
        res_20714 = res_27072;
        if (memblock_unref_device(ctx, &group_res_arr_mem_27497,
                                  "group_res_arr_mem_27497") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27250, "mem_27250") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_map_acc_mem_27247,
                                  "res_map_acc_mem_27247") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &res_mem_27198, "res_mem_27198") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27199, "res_mem_27199") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27200, "res_mem_27200") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27201, "res_mem_27201") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27229, "mem_27229") != 0)
        return 1;
    
    float CVA_20848 = 6.0e-3F * res_20714;
    
    scalar_out_27301 = CVA_20848;
    *out_scalar_out_27700 = scalar_out_27301;
    if (memblock_unref_device(ctx, &mem_27214, "mem_27214") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27229, "mem_27229") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27211, "mem_27211") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27208, "mem_27208") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27204, "mem_27204") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27201, "res_mem_27201") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27200, "res_mem_27200") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27199, "res_mem_27199") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27198, "res_mem_27198") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_27305,
                              "group_res_arr_mem_27305") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27179, "mem_27179") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27177, "mem_27177") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27175, "mem_27175") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27173, "mem_27173") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
struct futhark_i64_1d {
    struct memblock_device mem;
    int64_t shape[1];
} ;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const
                                          int64_t *data, int64_t dim0)
{
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr =
                          (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(int64_t),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(int64_t) > 0)
        OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                      arr->mem.mem, CL_TRUE, 0,
                                                      (size_t) dim0 *
                                                      sizeof(int64_t), data + 0,
                                                      0, NULL,
                                                      ctx->profiling_paused ||
                                                      !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                &ctx->copy_dev_to_host_runs,
                                                                                                &ctx->copy_dev_to_host_total_runtime)));
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0)
{
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr =
                          (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(int64_t),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(int64_t) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue, data,
                                                     arr->mem.mem, offset, 0,
                                                     (size_t) dim0 *
                                                     sizeof(int64_t), 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx,
                          struct futhark_i64_1d *arr, int64_t *data)
{
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * sizeof(int64_t) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     arr->mem.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0, (size_t) arr->shape[0] *
                                                     sizeof(int64_t), data + 0,
                                                     0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_host_to_dev_runs,
                                                                                               &ctx->copy_host_to_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
    }
    lock_unlock(&ctx->lock);
    return 0;
}
cl_mem futhark_values_raw_i64_1d(struct futhark_context *ctx,
                                 struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx,
                                    struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_1d {
    struct memblock_device mem;
    int64_t shape[1];
} ;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const
                                          float *data, int64_t dim0)
{
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr =
                          (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(float),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(float) > 0)
        OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                      arr->mem.mem, CL_TRUE, 0,
                                                      (size_t) dim0 *
                                                      sizeof(float), data + 0,
                                                      0, NULL,
                                                      ctx->profiling_paused ||
                                                      !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                &ctx->copy_dev_to_host_runs,
                                                                                                &ctx->copy_dev_to_host_total_runtime)));
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0)
{
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr =
                          (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(float),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue, data,
                                                     arr->mem.mem, offset, 0,
                                                     (size_t) dim0 *
                                                     sizeof(float), 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_1d(struct futhark_context *ctx,
                          struct futhark_f32_1d *arr, float *data)
{
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     arr->mem.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0, (size_t) arr->shape[0] *
                                                     sizeof(float), data + 0, 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_host_to_dev_runs,
                                                                                               &ctx->copy_host_to_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
    }
    lock_unlock(&ctx->lock);
    return 0;
}
cl_mem futhark_values_raw_f32_1d(struct futhark_context *ctx,
                                 struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx,
                                    struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
int futhark_entry_main(struct futhark_context *ctx, float *out0,
                       struct futhark_f32_1d **out1, const int64_t in0, const
                       int64_t in1, const struct futhark_f32_1d *in2, const
                       struct futhark_i64_1d *in3, const
                       struct futhark_f32_1d *in4, const float in5, const
                       float in6, const float in7, const float in8)
{
    struct memblock_device swap_term_mem_27171;
    
    swap_term_mem_27171.references = NULL;
    
    struct memblock_device payments_mem_27172;
    
    payments_mem_27172.references = NULL;
    
    struct memblock_device notional_mem_27173;
    
    notional_mem_27173.references = NULL;
    
    int64_t n_19755;
    int64_t n_19756;
    int64_t n_19757;
    int64_t paths_19758;
    int64_t steps_19759;
    float a_19763;
    float b_19764;
    float sigma_19765;
    float r0_19766;
    float scalar_out_27301;
    struct memblock_device out_mem_27302;
    
    out_mem_27302.references = NULL;
    
    int64_t out_arrsizze_27303;
    
    lock_lock(&ctx->lock);
    paths_19758 = in0;
    steps_19759 = in1;
    swap_term_mem_27171 = in2->mem;
    n_19755 = in2->shape[0];
    payments_mem_27172 = in3->mem;
    n_19756 = in3->shape[0];
    notional_mem_27173 = in4->mem;
    n_19757 = in4->shape[0];
    a_19763 = in5;
    b_19764 = in6;
    sigma_19765 = in7;
    r0_19766 = in8;
    
    int ret = futrts_main(ctx, &scalar_out_27301, &out_mem_27302,
                          &out_arrsizze_27303, swap_term_mem_27171,
                          payments_mem_27172, notional_mem_27173, n_19755,
                          n_19756, n_19757, paths_19758, steps_19759, a_19763,
                          b_19764, sigma_19765, r0_19766);
    
    if (ret == 0) {
        *out0 = scalar_out_27301;
        assert((*out1 =
                (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) !=
            NULL);
        (*out1)->mem = out_mem_27302;
        (*out1)->shape[0] = out_arrsizze_27303;
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_test(struct futhark_context *ctx, float *out0, const
                       int64_t in0, const int64_t in1)
{
    int64_t paths_20195;
    int64_t steps_20196;
    float scalar_out_27301;
    
    lock_lock(&ctx->lock);
    paths_20195 = in0;
    steps_20196 = in1;
    
    int ret = futrts_test(ctx, &scalar_out_27301, paths_20195, steps_20196);
    
    if (ret == 0) {
        *out0 = scalar_out_27301;
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_test2(struct futhark_context *ctx, float *out0, const
                        int64_t in0, const int64_t in1, const int64_t in2)
{
    int64_t paths_20494;
    int64_t steps_20495;
    int64_t numswaps_20496;
    float scalar_out_27301;
    
    lock_lock(&ctx->lock);
    paths_20494 = in0;
    steps_20495 = in1;
    numswaps_20496 = in2;
    
    int ret = futrts_test2(ctx, &scalar_out_27301, paths_20494, steps_20495,
                           numswaps_20496);
    
    if (ret == 0) {
        *out0 = scalar_out_27301;
    }
    lock_unlock(&ctx->lock);
    return ret;
}
