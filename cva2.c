#ifdef __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#endif
#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#endif
// Headers

#define _GNU_SOURCE
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#define CL_TARGET_OPENCL_VERSION 120
#define CL_USE_DEPRECATED_OPENCL_1_2_APIS
#ifdef __APPLE__
#define CL_SILENCE_DEPRECATION
#include <OpenCL/cl.h>
#else
#include <CL/cl.h>
#endif


// Initialisation

int futhark_get_num_sizes(void);
const char *futhark_get_size_name(int);
const char *futhark_get_size_class(int);
struct futhark_context_config ;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
void futhark_context_config_add_build_option(struct futhark_context_config *cfg,
                                             const char *opt);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int flag);
void futhark_context_config_set_device(struct futhark_context_config *cfg, const
                                       char *s);
void futhark_context_config_set_platform(struct futhark_context_config *cfg,
                                         const char *s);
void
futhark_context_config_select_device_interactively(struct futhark_context_config *cfg);
void futhark_context_config_list_devices(struct futhark_context_config *cfg);
void futhark_context_config_dump_program_to(struct futhark_context_config *cfg,
                                            const char *path);
void
futhark_context_config_load_program_from(struct futhark_context_config *cfg,
                                         const char *path);
void futhark_context_config_dump_binary_to(struct futhark_context_config *cfg,
                                           const char *path);
void futhark_context_config_load_binary_from(struct futhark_context_config *cfg,
                                             const char *path);
void
futhark_context_config_set_default_group_size(struct futhark_context_config *cfg,
                                              int size);
void
futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg,
                                              int num);
void
futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg,
                                             int num);
void
futhark_context_config_set_default_threshold(struct futhark_context_config *cfg,
                                             int num);
int futhark_context_config_set_size(struct futhark_context_config *cfg, const
                                    char *size_name, size_t size_value);
struct futhark_context ;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
struct futhark_context
*futhark_context_new_with_command_queue(struct futhark_context_config *cfg,
                                        cl_command_queue queue);
void futhark_context_free(struct futhark_context *ctx);
cl_command_queue futhark_context_get_command_queue(struct futhark_context *ctx);

// Arrays

struct futhark_f32_1d ;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const
                                          float *data, int64_t dim0);
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0);
int futhark_free_f32_1d(struct futhark_context *ctx,
                        struct futhark_f32_1d *arr);
int futhark_values_f32_1d(struct futhark_context *ctx,
                          struct futhark_f32_1d *arr, float *data);
cl_mem futhark_values_raw_f32_1d(struct futhark_context *ctx,
                                 struct futhark_f32_1d *arr);
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx,
                                    struct futhark_f32_1d *arr);
struct futhark_i64_1d ;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const
                                          int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx,
                        struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx,
                          struct futhark_i64_1d *arr, int64_t *data);
cl_mem futhark_values_raw_i64_1d(struct futhark_context *ctx,
                                 struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx,
                                    struct futhark_i64_1d *arr);

// Opaque values


// Entry points

int futhark_entry_main(struct futhark_context *ctx, float *out0,
                       struct futhark_f32_1d **out1, const int64_t in0, const
                       int64_t in1, const struct futhark_f32_1d *in2, const
                       struct futhark_i64_1d *in3, const
                       struct futhark_f32_1d *in4, const float in5, const
                       float in6, const float in7, const float in8);
int futhark_entry_test(struct futhark_context *ctx, float *out0, const
                       int64_t in0, const int64_t in1);

// Miscellaneous

int futhark_context_sync(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
#define FUTHARK_BACKEND_opencl
#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}


static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                            const char *msg, ...)
{
  if (errval) {
    char str[256];
    char errnum[10];
    sprintf(errnum, "%d", errval);
    sprintf(str, "ERROR: %s in %s() at line %d with error code %s\n", msg, fun, line,
            sets_errno ? strerror(errno) : errnum);
    fprintf(stderr, "%s", str);
    exit(errval);
  }
}

#define CHECK_ERR(err, msg...) check_err(err, 0, __func__, __LINE__, msg)
#define CHECK_ERRNO(err, msg...) check_err(err, 1, __func__, __LINE__, msg)

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  unsigned char *s;
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  fseek(f, 0, SEEK_END);
  size_t src_size = ftell(f);
  fseek(f, 0, SEEK_SET);
  s = (unsigned char*) malloc(src_size + 1);
  if (fread(s, 1, src_size, f) != src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }
  fclose(f);

  if (size) {
    *size = src_size;
  }

  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

// End of util.h.

// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}


static inline uint64_t rdtsc() {
  unsigned int hi, lo;
  __asm__ __volatile__("rdtsc" : "=a"(lo), "=d"(hi));
  return  ((uint64_t) lo) | (((uint64_t) hi) << 32);
}

static inline void rdtsc_wait(uint64_t n) {
  const uint64_t start = rdtsc();
  while (rdtsc() < (start + n)) {
    __asm__("PAUSE");
  }
}
static inline void spin_for(uint64_t nb_cycles) {
  rdtsc_wait(nb_cycles);
}


#endif

// End of timing.h.

#include <string.h>
#include <inttypes.h>
#include <errno.h>
#include <ctype.h>
#include <errno.h>
#include <getopt.h>
// Start of values.h.

//// Text I/O

typedef int (*writer)(FILE*, const void*);
typedef int (*bin_reader)(void*);
typedef int (*str_reader)(const char *, void*);

struct array_reader {
  char* elems;
  int64_t n_elems_space;
  int64_t elem_size;
  int64_t n_elems_used;
  int64_t *shape;
  str_reader elem_reader;
};

static void skipspaces() {
  int c;
  do {
    c = getchar();
  } while (isspace(c));

  if (c != EOF) {
    ungetc(c, stdin);
  }
}

static int constituent(char c) {
  return isalnum(c) || c == '.' || c == '-' || c == '+' || c == '_';
}

// Produces an empty token only on EOF.
static void next_token(char *buf, int bufsize) {
 start:
  skipspaces();

  int i = 0;
  while (i < bufsize) {
    int c = getchar();
    buf[i] = (char)c;

    if (c == EOF) {
      buf[i] = 0;
      return;
    } else if (c == '-' && i == 1 && buf[0] == '-') {
      // Line comment, so skip to end of line and start over.
      for (; c != '\n' && c != EOF; c = getchar());
      goto start;
    } else if (!constituent((char)c)) {
      if (i == 0) {
        // We permit single-character tokens that are not
        // constituents; this lets things like ']' and ',' be
        // tokens.
        buf[i+1] = 0;
        return;
      } else {
        ungetc(c, stdin);
        buf[i] = 0;
        return;
      }
    }

    i++;
  }

  buf[bufsize-1] = 0;
}

static int next_token_is(char *buf, int bufsize, const char* expected) {
  next_token(buf, bufsize);
  return strcmp(buf, expected) == 0;
}

static void remove_underscores(char *buf) {
  char *w = buf;

  for (char *r = buf; *r; r++) {
    if (*r != '_') {
      *w++ = *r;
    }
  }

  *w++ = 0;
}

static int read_str_elem(char *buf, struct array_reader *reader) {
  int ret;
  if (reader->n_elems_used == reader->n_elems_space) {
    reader->n_elems_space *= 2;
    reader->elems = (char*) realloc(reader->elems,
                                    (size_t)(reader->n_elems_space * reader->elem_size));
  }

  ret = reader->elem_reader(buf, reader->elems + reader->n_elems_used * reader->elem_size);

  if (ret == 0) {
    reader->n_elems_used++;
  }

  return ret;
}

static int read_str_array_elems(char *buf, int bufsize,
                                struct array_reader *reader, int64_t dims) {
  int ret;
  int first = 1;
  char *knows_dimsize = (char*) calloc((size_t)dims, sizeof(char));
  int cur_dim = dims-1;
  int64_t *elems_read_in_dim = (int64_t*) calloc((size_t)dims, sizeof(int64_t));

  while (1) {
    next_token(buf, bufsize);

    if (strcmp(buf, "]") == 0) {
      if (knows_dimsize[cur_dim]) {
        if (reader->shape[cur_dim] != elems_read_in_dim[cur_dim]) {
          ret = 1;
          break;
        }
      } else {
        knows_dimsize[cur_dim] = 1;
        reader->shape[cur_dim] = elems_read_in_dim[cur_dim];
      }
      if (cur_dim == 0) {
        ret = 0;
        break;
      } else {
        cur_dim--;
        elems_read_in_dim[cur_dim]++;
      }
    } else if (strcmp(buf, ",") == 0) {
      next_token(buf, bufsize);
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        first = 1;
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else if (cur_dim == dims - 1) {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
      } else {
        ret = 1;
        break;
      }
    } else if (strlen(buf) == 0) {
      // EOF
      ret = 1;
      break;
    } else if (first) {
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
        first = 0;
      }
    } else {
      ret = 1;
      break;
    }
  }

  free(knows_dimsize);
  free(elems_read_in_dim);
  return ret;
}

static int read_str_empty_array(char *buf, int bufsize,
                                const char *type_name, int64_t *shape, int64_t dims) {
  if (strlen(buf) == 0) {
    // EOF
    return 1;
  }

  if (strcmp(buf, "empty") != 0) {
    return 1;
  }

  if (!next_token_is(buf, bufsize, "(")) {
    return 1;
  }

  for (int i = 0; i < dims; i++) {
    if (!next_token_is(buf, bufsize, "[")) {
      return 1;
    }

    next_token(buf, bufsize);

    if (sscanf(buf, "%"SCNu64, (uint64_t*)&shape[i]) != 1) {
      return 1;
    }

    if (!next_token_is(buf, bufsize, "]")) {
      return 1;
    }
  }

  if (!next_token_is(buf, bufsize, type_name)) {
    return 1;
  }


  if (!next_token_is(buf, bufsize, ")")) {
    return 1;
  }

  // Check whether the array really is empty.
  for (int i = 0; i < dims; i++) {
    if (shape[i] == 0) {
      return 0;
    }
  }

  // Not an empty array!
  return 1;
}

static int read_str_array(int64_t elem_size, str_reader elem_reader,
                          const char *type_name,
                          void **data, int64_t *shape, int64_t dims) {
  int ret;
  struct array_reader reader;
  char buf[100];

  int dims_seen;
  for (dims_seen = 0; dims_seen < dims; dims_seen++) {
    if (!next_token_is(buf, sizeof(buf), "[")) {
      break;
    }
  }

  if (dims_seen == 0) {
    return read_str_empty_array(buf, sizeof(buf), type_name, shape, dims);
  }

  if (dims_seen != dims) {
    return 1;
  }

  reader.shape = shape;
  reader.n_elems_used = 0;
  reader.elem_size = elem_size;
  reader.n_elems_space = 16;
  reader.elems = (char*) realloc(*data, (size_t)(elem_size*reader.n_elems_space));
  reader.elem_reader = elem_reader;

  ret = read_str_array_elems(buf, sizeof(buf), &reader, dims);

  *data = reader.elems;

  return ret;
}

#define READ_STR(MACRO, PTR, SUFFIX)                                   \
  remove_underscores(buf);                                              \
  int j;                                                                \
  if (sscanf(buf, "%"MACRO"%n", (PTR*)dest, &j) == 1) {                 \
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, SUFFIX) == 0);     \
  } else {                                                              \
    return 1;                                                           \
  }

static int read_str_i8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNi8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(int8_t*)dest = (int8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "i8") == 0);
  } else {
    return 1;
  }
}

static int read_str_u8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNu8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(uint8_t*)dest = (uint8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "u8") == 0);
  } else {
    return 1;
  }
}

static int read_str_i16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "i16");
}

static int read_str_u16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "u16");
}

static int read_str_i32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "i32");
}

static int read_str_u32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "u32");
}

static int read_str_i64(char *buf, void* dest) {
  READ_STR(SCNi64, int64_t, "i64");
}

static int read_str_u64(char *buf, void* dest) {
  // FIXME: This is not correct, as SCNu64 only permits decimal
  // literals.  However, SCNi64 does not handle very large numbers
  // correctly (it's really for signed numbers, so that's fair).
  READ_STR(SCNu64, uint64_t, "u64");
}

static int read_str_f32(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f32.nan") == 0) {
    *(float*)dest = NAN;
    return 0;
  } else if (strcmp(buf, "f32.inf") == 0) {
    *(float*)dest = INFINITY;
    return 0;
  } else if (strcmp(buf, "-f32.inf") == 0) {
    *(float*)dest = -INFINITY;
    return 0;
  } else {
    READ_STR("f", float, "f32");
  }
}

static int read_str_f64(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f64.nan") == 0) {
    *(double*)dest = NAN;
    return 0;
  } else if (strcmp(buf, "f64.inf") == 0) {
    *(double*)dest = INFINITY;
    return 0;
  } else if (strcmp(buf, "-f64.inf") == 0) {
    *(double*)dest = -INFINITY;
    return 0;
  } else {
    READ_STR("lf", double, "f64");
  }
}

static int read_str_bool(char *buf, void* dest) {
  if (strcmp(buf, "true") == 0) {
    *(char*)dest = 1;
    return 0;
  } else if (strcmp(buf, "false") == 0) {
    *(char*)dest = 0;
    return 0;
  } else {
    return 1;
  }
}

static int write_str_i8(FILE *out, int8_t *src) {
  return fprintf(out, "%hhdi8", *src);
}

static int write_str_u8(FILE *out, uint8_t *src) {
  return fprintf(out, "%hhuu8", *src);
}

static int write_str_i16(FILE *out, int16_t *src) {
  return fprintf(out, "%hdi16", *src);
}

static int write_str_u16(FILE *out, uint16_t *src) {
  return fprintf(out, "%huu16", *src);
}

static int write_str_i32(FILE *out, int32_t *src) {
  return fprintf(out, "%di32", *src);
}

static int write_str_u32(FILE *out, uint32_t *src) {
  return fprintf(out, "%uu32", *src);
}

static int write_str_i64(FILE *out, int64_t *src) {
  return fprintf(out, "%"PRIi64"i64", *src);
}

static int write_str_u64(FILE *out, uint64_t *src) {
  return fprintf(out, "%"PRIu64"u64", *src);
}

static int write_str_f32(FILE *out, float *src) {
  float x = *src;
  if (isnan(x)) {
    return fprintf(out, "f32.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f32.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f32.inf");
  } else {
    return fprintf(out, "%.6ff32", x);
  }
}

static int write_str_f64(FILE *out, double *src) {
  double x = *src;
  if (isnan(x)) {
    return fprintf(out, "f64.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f64.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f64.inf");
  } else {
    return fprintf(out, "%.6ff64", *src);
  }
}

static int write_str_bool(FILE *out, void *src) {
  return fprintf(out, *(char*)src ? "true" : "false");
}

//// Binary I/O

#define BINARY_FORMAT_VERSION 2
#define IS_BIG_ENDIAN (!*(unsigned char *)&(uint16_t){1})

static void flip_bytes(int elem_size, unsigned char *elem) {
  for (int j=0; j<elem_size/2; j++) {
    unsigned char head = elem[j];
    int tail_index = elem_size-1-j;
    elem[j] = elem[tail_index];
    elem[tail_index] = head;
  }
}

// On Windows we need to explicitly set the file mode to not mangle
// newline characters.  On *nix there is no difference.
#ifdef _WIN32
#include <io.h>
#include <fcntl.h>
static void set_binary_mode(FILE *f) {
  setmode(fileno(f), O_BINARY);
}
#else
static void set_binary_mode(FILE *f) {
  (void)f;
}
#endif

static int read_byte(void* dest) {
  int num_elems_read = fread(dest, 1, 1, stdin);
  return num_elems_read == 1 ? 0 : 1;
}

//// Types

struct primtype_info_t {
  const char binname[4]; // Used for parsing binary data.
  const char* type_name; // Same name as in Futhark.
  const int64_t size; // in bytes
  const writer write_str; // Write in text format.
  const str_reader read_str; // Read in text format.
};

static const struct primtype_info_t i8_info =
  {.binname = "  i8", .type_name = "i8",   .size = 1,
   .write_str = (writer)write_str_i8, .read_str = (str_reader)read_str_i8};
static const struct primtype_info_t i16_info =
  {.binname = " i16", .type_name = "i16",  .size = 2,
   .write_str = (writer)write_str_i16, .read_str = (str_reader)read_str_i16};
static const struct primtype_info_t i32_info =
  {.binname = " i32", .type_name = "i32",  .size = 4,
   .write_str = (writer)write_str_i32, .read_str = (str_reader)read_str_i32};
static const struct primtype_info_t i64_info =
  {.binname = " i64", .type_name = "i64",  .size = 8,
   .write_str = (writer)write_str_i64, .read_str = (str_reader)read_str_i64};
static const struct primtype_info_t u8_info =
  {.binname = "  u8", .type_name = "u8",   .size = 1,
   .write_str = (writer)write_str_u8, .read_str = (str_reader)read_str_u8};
static const struct primtype_info_t u16_info =
  {.binname = " u16", .type_name = "u16",  .size = 2,
   .write_str = (writer)write_str_u16, .read_str = (str_reader)read_str_u16};
static const struct primtype_info_t u32_info =
  {.binname = " u32", .type_name = "u32",  .size = 4,
   .write_str = (writer)write_str_u32, .read_str = (str_reader)read_str_u32};
static const struct primtype_info_t u64_info =
  {.binname = " u64", .type_name = "u64",  .size = 8,
   .write_str = (writer)write_str_u64, .read_str = (str_reader)read_str_u64};
static const struct primtype_info_t f32_info =
  {.binname = " f32", .type_name = "f32",  .size = 4,
   .write_str = (writer)write_str_f32, .read_str = (str_reader)read_str_f32};
static const struct primtype_info_t f64_info =
  {.binname = " f64", .type_name = "f64",  .size = 8,
   .write_str = (writer)write_str_f64, .read_str = (str_reader)read_str_f64};
static const struct primtype_info_t bool_info =
  {.binname = "bool", .type_name = "bool", .size = 1,
   .write_str = (writer)write_str_bool, .read_str = (str_reader)read_str_bool};

static const struct primtype_info_t* primtypes[] = {
  &i8_info, &i16_info, &i32_info, &i64_info,
  &u8_info, &u16_info, &u32_info, &u64_info,
  &f32_info, &f64_info,
  &bool_info,
  NULL // NULL-terminated
};

// General value interface.  All endian business taken care of at
// lower layers.

static int read_is_binary() {
  skipspaces();
  int c = getchar();
  if (c == 'b') {
    int8_t bin_version;
    int ret = read_byte(&bin_version);

    if (ret != 0) { futhark_panic(1, "binary-input: could not read version.\n"); }

    if (bin_version != BINARY_FORMAT_VERSION) {
      futhark_panic(1, "binary-input: File uses version %i, but I only understand version %i.\n",
            bin_version, BINARY_FORMAT_VERSION);
    }

    return 1;
  }
  ungetc(c, stdin);
  return 0;
}

static const struct primtype_info_t* read_bin_read_type_enum() {
  char read_binname[4];

  int num_matched = scanf("%4c", read_binname);
  if (num_matched != 1) { futhark_panic(1, "binary-input: Couldn't read element type.\n"); }

  const struct primtype_info_t **type = primtypes;

  for (; *type != NULL; type++) {
    // I compare the 4 characters manually instead of using strncmp because
    // this allows any value to be used, also NULL bytes
    if (memcmp(read_binname, (*type)->binname, 4) == 0) {
      return *type;
    }
  }
  futhark_panic(1, "binary-input: Did not recognize the type '%s'.\n", read_binname);
  return NULL;
}

static void read_bin_ensure_scalar(const struct primtype_info_t *expected_type) {
  int8_t bin_dims;
  int ret = read_byte(&bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != 0) {
    futhark_panic(1, "binary-input: Expected scalar (0 dimensions), but got array with %i dimensions.\n",
          bin_dims);
  }

  const struct primtype_info_t *bin_type = read_bin_read_type_enum();
  if (bin_type != expected_type) {
    futhark_panic(1, "binary-input: Expected scalar of type %s but got scalar of type %s.\n",
          expected_type->type_name,
          bin_type->type_name);
  }
}

//// High-level interface

static int read_bin_array(const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  int ret;

  int8_t bin_dims;
  ret = read_byte(&bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != dims) {
    futhark_panic(1, "binary-input: Expected %i dimensions, but got array with %i dimensions.\n",
          dims, bin_dims);
  }

  const struct primtype_info_t *bin_primtype = read_bin_read_type_enum();
  if (expected_type != bin_primtype) {
    futhark_panic(1, "binary-input: Expected %iD-array with element type '%s' but got %iD-array with element type '%s'.\n",
          dims, expected_type->type_name, dims, bin_primtype->type_name);
  }

  int64_t elem_count = 1;
  for (int i=0; i<dims; i++) {
    int64_t bin_shape;
    ret = fread(&bin_shape, sizeof(bin_shape), 1, stdin);
    if (ret != 1) {
      futhark_panic(1, "binary-input: Couldn't read size for dimension %i of array.\n", i);
    }
    if (IS_BIG_ENDIAN) {
      flip_bytes(sizeof(bin_shape), (unsigned char*) &bin_shape);
    }
    elem_count *= bin_shape;
    shape[i] = bin_shape;
  }

  int64_t elem_size = expected_type->size;
  void* tmp = realloc(*data, (size_t)(elem_count * elem_size));
  if (tmp == NULL) {
    futhark_panic(1, "binary-input: Failed to allocate array of size %i.\n",
          elem_count * elem_size);
  }
  *data = tmp;

  int64_t num_elems_read = (int64_t)fread(*data, (size_t)elem_size, (size_t)elem_count, stdin);
  if (num_elems_read != elem_count) {
    futhark_panic(1, "binary-input: tried to read %i elements of an array, but only got %i elements.\n",
          elem_count, num_elems_read);
  }

  // If we're on big endian platform we must change all multibyte elements
  // from using little endian to big endian
  if (IS_BIG_ENDIAN && elem_size != 1) {
    flip_bytes(elem_size, (unsigned char*) *data);
  }

  return 0;
}

static int read_array(const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  if (!read_is_binary()) {
    return read_str_array(expected_type->size, (str_reader)expected_type->read_str, expected_type->type_name, data, shape, dims);
  } else {
    return read_bin_array(expected_type, data, shape, dims);
  }
}

static int end_of_input() {
  skipspaces();
  char token[2];
  next_token(token, sizeof(token));
  if (strcmp(token, "") == 0) {
    return 0;
  } else {
    return 1;
  }
}

static int write_str_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  if (rank==0) {
    elem_type->write_str(out, (void*)data);
  } else {
    int64_t len = (int64_t)shape[0];
    int64_t slice_size = 1;

    int64_t elem_size = elem_type->size;
    for (int8_t i = 1; i < rank; i++) {
      slice_size *= shape[i];
    }

    if (len*slice_size == 0) {
      printf("empty(");
      for (int64_t i = 0; i < rank; i++) {
        printf("[%"PRIi64"]", shape[i]);
      }
      printf("%s", elem_type->type_name);
      printf(")");
    } else if (rank==1) {
      putchar('[');
      for (int64_t i = 0; i < len; i++) {
        elem_type->write_str(out, (void*) (data + i * elem_size));
        if (i != len-1) {
          printf(", ");
        }
      }
      putchar(']');
    } else {
      putchar('[');
      for (int64_t i = 0; i < len; i++) {
        write_str_array(out, elem_type, data + i * slice_size * elem_size, shape+1, rank-1);
        if (i != len-1) {
          printf(", ");
        }
      }
      putchar(']');
    }
  }
  return 0;
}

static int write_bin_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  int64_t num_elems = 1;
  for (int64_t i = 0; i < rank; i++) {
    num_elems *= shape[i];
  }

  fputc('b', out);
  fputc((char)BINARY_FORMAT_VERSION, out);
  fwrite(&rank, sizeof(int8_t), 1, out);
  fputs(elem_type->binname, out);
  if (shape != NULL) {
    fwrite(shape, sizeof(int64_t), (size_t)rank, out);
  }

  if (IS_BIG_ENDIAN) {
    for (int64_t i = 0; i < num_elems; i++) {
      const unsigned char *elem = data+i*elem_type->size;
      for (int64_t j = 0; j < elem_type->size; j++) {
        fwrite(&elem[elem_type->size-j], 1, 1, out);
      }
    }
  } else {
    fwrite(data, (size_t)elem_type->size, (size_t)num_elems, out);
  }

  return 0;
}

static int write_array(FILE *out, int write_binary,
                       const struct primtype_info_t *elem_type,
                       const void *data,
                       const int64_t *shape,
                       const int8_t rank) {
  if (write_binary) {
    return write_bin_array(out, elem_type, data, shape, rank);
  } else {
    return write_str_array(out, elem_type, data, shape, rank);
  }
}

static int read_scalar(const struct primtype_info_t *expected_type, void *dest) {
  if (!read_is_binary()) {
    char buf[100];
    next_token(buf, sizeof(buf));
    return expected_type->read_str(buf, dest);
  } else {
    read_bin_ensure_scalar(expected_type);
    int64_t elem_size = expected_type->size;
    int num_elems_read = fread(dest, (size_t)elem_size, 1, stdin);
    if (IS_BIG_ENDIAN) {
      flip_bytes(elem_size, (unsigned char*) dest);
    }
    return num_elems_read == 1 ? 0 : 1;
  }
}

static int write_scalar(FILE *out, int write_binary, const struct primtype_info_t *type, void *src) {
  if (write_binary) {
    return write_bin_array(out, type, src, NULL, 0);
  } else {
    return type->write_str(out, src);
  }
}

// End of values.h.

#define __private
static int binary_output = 0;
static FILE *runtime_file;
static int perform_warmup = 0;
static int num_runs = 1;
static const char *entry_point = "main";
// Start of tuning.h.

static char* load_tuning_file(const char *fname,
                              void *cfg,
                              int (*set_size)(void*, const char*, size_t)) {
  const int max_line_len = 1024;
  char* line = (char*) malloc(max_line_len);

  FILE *f = fopen(fname, "r");

  if (f == NULL) {
    snprintf(line, max_line_len, "Cannot open file: %s", strerror(errno));
    return line;
  }

  int lineno = 0;
  while (fgets(line, max_line_len, f) != NULL) {
    lineno++;
    char *eql = strstr(line, "=");
    if (eql) {
      *eql = 0;
      int value = atoi(eql+1);
      if (set_size(cfg, line, value) != 0) {
        strncpy(eql+1, line, max_line_len-strlen(line)-1);
        snprintf(line, max_line_len, "Unknown name '%s' on line %d.", eql+1, lineno);
        return line;
      }
    } else {
      snprintf(line, max_line_len, "Invalid line %d (must be of form 'name=int').",
               lineno);
      return line;
    }
  }

  free(line);

  return NULL;
}

// End of tuning.h.

int parse_options(struct futhark_context_config *cfg, int argc,
                  char *const argv[])
{
    int ch;
    static struct option long_options[] = {{"write-runtime-to",
                                            required_argument, NULL, 1},
                                           {"runs", required_argument, NULL, 2},
                                           {"debugging", no_argument, NULL, 3},
                                           {"log", no_argument, NULL, 4},
                                           {"entry-point", required_argument,
                                            NULL, 5}, {"binary-output",
                                                       no_argument, NULL, 6},
                                           {"help", no_argument, NULL, 7},
                                           {"device", required_argument, NULL,
                                            8}, {"default-group-size",
                                                 required_argument, NULL, 9},
                                           {"default-num-groups",
                                            required_argument, NULL, 10},
                                           {"default-tile-size",
                                            required_argument, NULL, 11},
                                           {"default-threshold",
                                            required_argument, NULL, 12},
                                           {"print-sizes", no_argument, NULL,
                                            13}, {"size", required_argument,
                                                  NULL, 14}, {"tuning",
                                                              required_argument,
                                                              NULL, 15},
                                           {"platform", required_argument, NULL,
                                            16}, {"dump-opencl",
                                                  required_argument, NULL, 17},
                                           {"load-opencl", required_argument,
                                            NULL, 18}, {"dump-opencl-binary",
                                                        required_argument, NULL,
                                                        19},
                                           {"load-opencl-binary",
                                            required_argument, NULL, 20},
                                           {"build-option", required_argument,
                                            NULL, 21}, {"profile", no_argument,
                                                        NULL, 22},
                                           {"list-devices", no_argument, NULL,
                                            23}, {0, 0, 0, 0}};
    static char *option_descriptions =
                "  -t/--write-runtime-to FILE Print the time taken to execute the program to the indicated file, an integral number of microseconds.\n  -r/--runs INT              Perform NUM runs of the program.\n  -D/--debugging             Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                   Print various low-overhead logging information to stderr while running.\n  -e/--entry-point NAME      The entry point to run. Defaults to main.\n  -b/--binary-output         Print the program result in the binary output format.\n  -h/--help                  Print help information and exit.\n  -d/--device NAME           Use the first OpenCL device whose name contains the given string.\n  --default-group-size INT   The default size of OpenCL workgroups that are launched.\n  --default-num-groups INT   The default number of OpenCL workgroups that are launched.\n  --default-tile-size INT    The default tile size used when performing two-dimensional tiling.\n  --default-threshold INT    The default parallelism threshold.\n  --print-sizes              Print all sizes that can be set with -size or --tuning.\n  --size ASSIGNMENT          Set a configurable run-time parameter to the given value.\n  --tuning FILE              Read size=value assignments from the given file.\n  -p/--platform NAME         Use the first OpenCL platform whose name contains the given string.\n  --dump-opencl FILE         Dump the embedded OpenCL program to the indicated file.\n  --load-opencl FILE         Instead of using the embedded OpenCL program, load it from the indicated file.\n  --dump-opencl-binary FILE  Dump the compiled version of the embedded OpenCL program to the indicated file.\n  --load-opencl-binary FILE  Load an OpenCL binary from the indicated file.\n  --build-option OPT         Add an additional build option to the string passed to clBuildProgram().\n  -P/--profile               Gather profiling data while executing and print out a summary at the end.\n  --list-devices             List all OpenCL devices and platforms available on the system.\n";
    
    while ((ch = getopt_long(argc, argv, ":t:r:DLe:bhd:p:P", long_options,
                             NULL)) != -1) {
        if (ch == 1 || ch == 't') {
            runtime_file = fopen(optarg, "w");
            if (runtime_file == NULL)
                futhark_panic(1, "Cannot open %s: %s\n", optarg,
                              strerror(errno));
        }
        if (ch == 2 || ch == 'r') {
            num_runs = atoi(optarg);
            perform_warmup = 1;
            if (num_runs <= 0)
                futhark_panic(1, "Need a positive number of runs, not %s\n",
                              optarg);
        }
        if (ch == 3 || ch == 'D')
            futhark_context_config_set_debugging(cfg, 1);
        if (ch == 4 || ch == 'L')
            futhark_context_config_set_logging(cfg, 1);
        if (ch == 5 || ch == 'e') {
            if (entry_point != NULL)
                entry_point = optarg;
        }
        if (ch == 6 || ch == 'b')
            binary_output = 1;
        if (ch == 7 || ch == 'h') {
            printf("Usage: %s [OPTION]...\nOptions:\n\n%s\nFor more information, consult the Futhark User's Guide or the man pages.\n",
                   fut_progname, option_descriptions);
            exit(0);
        }
        if (ch == 8 || ch == 'd')
            futhark_context_config_set_device(cfg, optarg);
        if (ch == 9)
            futhark_context_config_set_default_group_size(cfg, atoi(optarg));
        if (ch == 10)
            futhark_context_config_set_default_num_groups(cfg, atoi(optarg));
        if (ch == 11)
            futhark_context_config_set_default_tile_size(cfg, atoi(optarg));
        if (ch == 12)
            futhark_context_config_set_default_threshold(cfg, atoi(optarg));
        if (ch == 13) {
            int n = futhark_get_num_sizes();
            
            for (int i = 0; i < n; i++)
                printf("%s (%s)\n", futhark_get_size_name(i),
                       futhark_get_size_class(i));
            exit(0);
        }
        if (ch == 14) {
            char *name = optarg;
            char *equals = strstr(optarg, "=");
            char *value_str = equals != NULL ? equals + 1 : optarg;
            int value = atoi(value_str);
            
            if (equals != NULL) {
                *equals = 0;
                if (futhark_context_config_set_size(cfg, name, value) != 0)
                    futhark_panic(1, "Unknown size: %s\n", name);
            } else
                futhark_panic(1, "Invalid argument for size option: %s\n",
                              optarg);
        }
        if (ch == 15) {
            char *ret = load_tuning_file(optarg, cfg, (int (*)(void *, const
                                                               char *,
                                                               size_t)) futhark_context_config_set_size);
            
            if (ret != NULL)
                futhark_panic(1, "When loading tuning from '%s': %s\n", optarg,
                              ret);
        }
        if (ch == 16 || ch == 'p')
            futhark_context_config_set_platform(cfg, optarg);
        if (ch == 17) {
            futhark_context_config_dump_program_to(cfg, optarg);
            entry_point = NULL;
        }
        if (ch == 18)
            futhark_context_config_load_program_from(cfg, optarg);
        if (ch == 19) {
            futhark_context_config_dump_binary_to(cfg, optarg);
            entry_point = NULL;
        }
        if (ch == 20)
            futhark_context_config_load_binary_from(cfg, optarg);
        if (ch == 21)
            futhark_context_config_add_build_option(cfg, optarg);
        if (ch == 22 || ch == 'P')
            futhark_context_config_set_profiling(cfg, 1);
        if (ch == 23) {
            futhark_context_config_list_devices(cfg);
            entry_point = NULL;
        }
        if (ch == ':')
            futhark_panic(-1, "Missing argument for option %s\n", argv[optind -
                                                                       1]);
        if (ch == '?') {
            fprintf(stderr, "Usage: %s: %s\n", fut_progname,
                    "  -t/--write-runtime-to FILE Print the time taken to execute the program to the indicated file, an integral number of microseconds.\n  -r/--runs INT              Perform NUM runs of the program.\n  -D/--debugging             Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                   Print various low-overhead logging information to stderr while running.\n  -e/--entry-point NAME      The entry point to run. Defaults to main.\n  -b/--binary-output         Print the program result in the binary output format.\n  -h/--help                  Print help information and exit.\n  -d/--device NAME           Use the first OpenCL device whose name contains the given string.\n  --default-group-size INT   The default size of OpenCL workgroups that are launched.\n  --default-num-groups INT   The default number of OpenCL workgroups that are launched.\n  --default-tile-size INT    The default tile size used when performing two-dimensional tiling.\n  --default-threshold INT    The default parallelism threshold.\n  --print-sizes              Print all sizes that can be set with -size or --tuning.\n  --size ASSIGNMENT          Set a configurable run-time parameter to the given value.\n  --tuning FILE              Read size=value assignments from the given file.\n  -p/--platform NAME         Use the first OpenCL platform whose name contains the given string.\n  --dump-opencl FILE         Dump the embedded OpenCL program to the indicated file.\n  --load-opencl FILE         Instead of using the embedded OpenCL program, load it from the indicated file.\n  --dump-opencl-binary FILE  Dump the compiled version of the embedded OpenCL program to the indicated file.\n  --load-opencl-binary FILE  Load an OpenCL binary from the indicated file.\n  --build-option OPT         Add an additional build option to the string passed to clBuildProgram().\n  -P/--profile               Gather profiling data while executing and print out a summary at the end.\n  --list-devices             List all OpenCL devices and platforms available on the system.\n");
            futhark_panic(1, "Unknown option: %s\n", argv[optind - 1]);
        }
    }
    return optind;
}
static void futrts_cli_entry_main(struct futhark_context *ctx)
{
    int64_t t_start, t_end;
    int time_runs = 0, profile_run = 0;
    
    // We do not want to profile all the initialisation.
    futhark_context_pause_profiling(ctx);
    // Declare and read input.
    set_binary_mode(stdin);
    
    int64_t read_value_29354;
    
    if (read_scalar(&i64_info, &read_value_29354) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      0, i64_info.type_name, strerror(errno));
    
    int64_t read_value_29355;
    
    if (read_scalar(&i64_info, &read_value_29355) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      1, i64_info.type_name, strerror(errno));
    
    struct futhark_f32_1d *read_value_29356;
    int64_t read_shape_29357[1];
    float *read_arr_29358 = NULL;
    
    errno = 0;
    if (read_array(&f32_info, (void **) &read_arr_29358, read_shape_29357, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s%s (errno: %s).\n", 2,
                      "[]", f32_info.type_name, strerror(errno));
    
    struct futhark_i64_1d *read_value_29359;
    int64_t read_shape_29360[1];
    int64_t *read_arr_29361 = NULL;
    
    errno = 0;
    if (read_array(&i64_info, (void **) &read_arr_29361, read_shape_29360, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s%s (errno: %s).\n", 3,
                      "[]", i64_info.type_name, strerror(errno));
    
    struct futhark_f32_1d *read_value_29362;
    int64_t read_shape_29363[1];
    float *read_arr_29364 = NULL;
    
    errno = 0;
    if (read_array(&f32_info, (void **) &read_arr_29364, read_shape_29363, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s%s (errno: %s).\n", 4,
                      "[]", f32_info.type_name, strerror(errno));
    
    float read_value_29365;
    
    if (read_scalar(&f32_info, &read_value_29365) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      5, f32_info.type_name, strerror(errno));
    
    float read_value_29366;
    
    if (read_scalar(&f32_info, &read_value_29366) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      6, f32_info.type_name, strerror(errno));
    
    float read_value_29367;
    
    if (read_scalar(&f32_info, &read_value_29367) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      7, f32_info.type_name, strerror(errno));
    
    float read_value_29368;
    
    if (read_scalar(&f32_info, &read_value_29368) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      8, f32_info.type_name, strerror(errno));
    if (end_of_input() != 0)
        futhark_panic(1, "Expected EOF on stdin after reading input for %s.\n",
                      "\"main\"");
    
    float result_29369;
    struct futhark_f32_1d *result_29370;
    
    if (perform_warmup) {
        int r;
        
        ;
        ;
        assert((read_value_29356 = futhark_new_f32_1d(ctx, read_arr_29358,
                                                      read_shape_29357[0])) !=
            0);
        assert((read_value_29359 = futhark_new_i64_1d(ctx, read_arr_29361,
                                                      read_shape_29360[0])) !=
            0);
        assert((read_value_29362 = futhark_new_f32_1d(ctx, read_arr_29364,
                                                      read_shape_29363[0])) !=
            0);
        ;
        ;
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_main(ctx, &result_29369, &result_29370,
                               read_value_29354, read_value_29355,
                               read_value_29356, read_value_29359,
                               read_value_29362, read_value_29365,
                               read_value_29366, read_value_29367,
                               read_value_29368);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        assert(futhark_free_f32_1d(ctx, read_value_29356) == 0);
        assert(futhark_free_i64_1d(ctx, read_value_29359) == 0);
        assert(futhark_free_f32_1d(ctx, read_value_29362) == 0);
        ;
        ;
        ;
        ;
        ;
        assert(futhark_free_f32_1d(ctx, result_29370) == 0);
    }
    time_runs = 1;
    // Proper run.
    for (int run = 0; run < num_runs; run++) {
        // Only profile last run.
        profile_run = run == num_runs - 1;
        
        int r;
        
        ;
        ;
        assert((read_value_29356 = futhark_new_f32_1d(ctx, read_arr_29358,
                                                      read_shape_29357[0])) !=
            0);
        assert((read_value_29359 = futhark_new_i64_1d(ctx, read_arr_29361,
                                                      read_shape_29360[0])) !=
            0);
        assert((read_value_29362 = futhark_new_f32_1d(ctx, read_arr_29364,
                                                      read_shape_29363[0])) !=
            0);
        ;
        ;
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_main(ctx, &result_29369, &result_29370,
                               read_value_29354, read_value_29355,
                               read_value_29356, read_value_29359,
                               read_value_29362, read_value_29365,
                               read_value_29366, read_value_29367,
                               read_value_29368);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        assert(futhark_free_f32_1d(ctx, read_value_29356) == 0);
        assert(futhark_free_i64_1d(ctx, read_value_29359) == 0);
        assert(futhark_free_f32_1d(ctx, read_value_29362) == 0);
        ;
        ;
        ;
        ;
        if (run < num_runs - 1) {
            ;
            assert(futhark_free_f32_1d(ctx, result_29370) == 0);
        }
    }
    ;
    ;
    free(read_arr_29358);
    free(read_arr_29361);
    free(read_arr_29364);
    ;
    ;
    ;
    ;
    if (binary_output)
        set_binary_mode(stdout);
    write_scalar(stdout, binary_output, &f32_info, &result_29369);
    printf("\n");
    {
        float *arr = calloc(sizeof(float), futhark_shape_f32_1d(ctx,
                                                                result_29370)[0]);
        
        assert(arr != NULL);
        assert(futhark_values_f32_1d(ctx, result_29370, arr) == 0);
        write_array(stdout, binary_output, &f32_info, arr,
                    futhark_shape_f32_1d(ctx, result_29370), 1);
        free(arr);
    }
    printf("\n");
    ;
    assert(futhark_free_f32_1d(ctx, result_29370) == 0);
}
static void futrts_cli_entry_test(struct futhark_context *ctx)
{
    int64_t t_start, t_end;
    int time_runs = 0, profile_run = 0;
    
    // We do not want to profile all the initialisation.
    futhark_context_pause_profiling(ctx);
    // Declare and read input.
    set_binary_mode(stdin);
    
    int64_t read_value_29371;
    
    if (read_scalar(&i64_info, &read_value_29371) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      0, i64_info.type_name, strerror(errno));
    
    int64_t read_value_29372;
    
    if (read_scalar(&i64_info, &read_value_29372) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      1, i64_info.type_name, strerror(errno));
    if (end_of_input() != 0)
        futhark_panic(1, "Expected EOF on stdin after reading input for %s.\n",
                      "\"test\"");
    
    float result_29373;
    
    if (perform_warmup) {
        int r;
        
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_test(ctx, &result_29373, read_value_29371,
                               read_value_29372);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        ;
    }
    time_runs = 1;
    // Proper run.
    for (int run = 0; run < num_runs; run++) {
        // Only profile last run.
        profile_run = run == num_runs - 1;
        
        int r;
        
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_test(ctx, &result_29373, read_value_29371,
                               read_value_29372);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        if (run < num_runs - 1) {
            ;
        }
    }
    ;
    ;
    if (binary_output)
        set_binary_mode(stdout);
    write_scalar(stdout, binary_output, &f32_info, &result_29373);
    printf("\n");
    ;
}
typedef void entry_point_fun(struct futhark_context *);
struct entry_point_entry {
    const char *name;
    entry_point_fun *fun;
} ;
int main(int argc, char **argv)
{
    fut_progname = argv[0];
    
    struct entry_point_entry entry_points[] = {{.name ="main", .fun =
                                                futrts_cli_entry_main}, {.name =
                                                                         "test",
                                                                         .fun =
                                                                         futrts_cli_entry_test}};
    struct futhark_context_config *cfg = futhark_context_config_new();
    
    assert(cfg != NULL);
    
    int parsed_options = parse_options(cfg, argc, argv);
    
    argc -= parsed_options;
    argv += parsed_options;
    if (argc != 0)
        futhark_panic(1, "Excess non-option: %s\n", argv[0]);
    
    struct futhark_context *ctx = futhark_context_new(cfg);
    
    assert(ctx != NULL);
    
    char *error = futhark_context_get_error(ctx);
    
    if (error != NULL)
        futhark_panic(1, "%s", error);
    if (entry_point != NULL) {
        int num_entry_points = sizeof(entry_points) / sizeof(entry_points[0]);
        entry_point_fun *entry_point_fun = NULL;
        
        for (int i = 0; i < num_entry_points; i++) {
            if (strcmp(entry_points[i].name, entry_point) == 0) {
                entry_point_fun = entry_points[i].fun;
                break;
            }
        }
        if (entry_point_fun == NULL) {
            fprintf(stderr,
                    "No entry point '%s'.  Select another with --entry-point.  Options are:\n",
                    entry_point);
            for (int i = 0; i < num_entry_points; i++)
                fprintf(stderr, "%s\n", entry_points[i].name);
            return 1;
        }
        entry_point_fun(ctx);
        if (runtime_file != NULL)
            fclose(runtime_file);
        
        char *report = futhark_context_report(ctx);
        
        fputs(report, stderr);
        free(report);
    }
    futhark_context_free(ctx);
    futhark_context_config_free(cfg);
    return 0;
}
#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <inttypes.h>
#include <ctype.h>
#include <errno.h>
#include <assert.h>
#define CL_TARGET_OPENCL_VERSION 120
#define CL_USE_DEPRECATED_OPENCL_1_2_APIS
#ifdef __APPLE__
#define CL_SILENCE_DEPRECATION
#include <OpenCL/cl.h>
#else
#include <CL/cl.h>
#endif

// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.

static inline uint8_t add8(uint8_t x, uint8_t y)
{
    return x + y;
}
static inline uint16_t add16(uint16_t x, uint16_t y)
{
    return x + y;
}
static inline uint32_t add32(uint32_t x, uint32_t y)
{
    return x + y;
}
static inline uint64_t add64(uint64_t x, uint64_t y)
{
    return x + y;
}
static inline uint8_t sub8(uint8_t x, uint8_t y)
{
    return x - y;
}
static inline uint16_t sub16(uint16_t x, uint16_t y)
{
    return x - y;
}
static inline uint32_t sub32(uint32_t x, uint32_t y)
{
    return x - y;
}
static inline uint64_t sub64(uint64_t x, uint64_t y)
{
    return x - y;
}
static inline uint8_t mul8(uint8_t x, uint8_t y)
{
    return x * y;
}
static inline uint16_t mul16(uint16_t x, uint16_t y)
{
    return x * y;
}
static inline uint32_t mul32(uint32_t x, uint32_t y)
{
    return x * y;
}
static inline uint64_t mul64(uint64_t x, uint64_t y)
{
    return x * y;
}
static inline uint8_t udiv8(uint8_t x, uint8_t y)
{
    return x / y;
}
static inline uint16_t udiv16(uint16_t x, uint16_t y)
{
    return x / y;
}
static inline uint32_t udiv32(uint32_t x, uint32_t y)
{
    return x / y;
}
static inline uint64_t udiv64(uint64_t x, uint64_t y)
{
    return x / y;
}
static inline uint8_t udiv_up8(uint8_t x, uint8_t y)
{
    return (x + y - 1) / y;
}
static inline uint16_t udiv_up16(uint16_t x, uint16_t y)
{
    return (x + y - 1) / y;
}
static inline uint32_t udiv_up32(uint32_t x, uint32_t y)
{
    return (x + y - 1) / y;
}
static inline uint64_t udiv_up64(uint64_t x, uint64_t y)
{
    return (x + y - 1) / y;
}
static inline uint8_t umod8(uint8_t x, uint8_t y)
{
    return x % y;
}
static inline uint16_t umod16(uint16_t x, uint16_t y)
{
    return x % y;
}
static inline uint32_t umod32(uint32_t x, uint32_t y)
{
    return x % y;
}
static inline uint64_t umod64(uint64_t x, uint64_t y)
{
    return x % y;
}
static inline uint8_t udiv_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint16_t udiv_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint32_t udiv_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint64_t udiv_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint8_t umod_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint16_t umod_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint32_t umod_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint64_t umod_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int8_t sdiv8(int8_t x, int8_t y)
{
    int8_t q = x / y;
    int8_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int16_t sdiv16(int16_t x, int16_t y)
{
    int16_t q = x / y;
    int16_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int32_t sdiv32(int32_t x, int32_t y)
{
    int32_t q = x / y;
    int32_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int64_t sdiv64(int64_t x, int64_t y)
{
    int64_t q = x / y;
    int64_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int8_t sdiv_up8(int8_t x, int8_t y)
{
    return sdiv8(x + y - 1, y);
}
static inline int16_t sdiv_up16(int16_t x, int16_t y)
{
    return sdiv16(x + y - 1, y);
}
static inline int32_t sdiv_up32(int32_t x, int32_t y)
{
    return sdiv32(x + y - 1, y);
}
static inline int64_t sdiv_up64(int64_t x, int64_t y)
{
    return sdiv64(x + y - 1, y);
}
static inline int8_t smod8(int8_t x, int8_t y)
{
    int8_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int16_t smod16(int16_t x, int16_t y)
{
    int16_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int32_t smod32(int32_t x, int32_t y)
{
    int32_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int64_t smod64(int64_t x, int64_t y)
{
    int64_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int8_t sdiv_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : sdiv8(x, y);
}
static inline int16_t sdiv_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : sdiv16(x, y);
}
static inline int32_t sdiv_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : sdiv32(x, y);
}
static inline int64_t sdiv_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : sdiv64(x, y);
}
static inline int8_t sdiv_up_safe8(int8_t x, int8_t y)
{
    return sdiv_safe8(x + y - 1, y);
}
static inline int16_t sdiv_up_safe16(int16_t x, int16_t y)
{
    return sdiv_safe16(x + y - 1, y);
}
static inline int32_t sdiv_up_safe32(int32_t x, int32_t y)
{
    return sdiv_safe32(x + y - 1, y);
}
static inline int64_t sdiv_up_safe64(int64_t x, int64_t y)
{
    return sdiv_safe64(x + y - 1, y);
}
static inline int8_t smod_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : smod8(x, y);
}
static inline int16_t smod_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : smod16(x, y);
}
static inline int32_t smod_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : smod32(x, y);
}
static inline int64_t smod_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : smod64(x, y);
}
static inline int8_t squot8(int8_t x, int8_t y)
{
    return x / y;
}
static inline int16_t squot16(int16_t x, int16_t y)
{
    return x / y;
}
static inline int32_t squot32(int32_t x, int32_t y)
{
    return x / y;
}
static inline int64_t squot64(int64_t x, int64_t y)
{
    return x / y;
}
static inline int8_t srem8(int8_t x, int8_t y)
{
    return x % y;
}
static inline int16_t srem16(int16_t x, int16_t y)
{
    return x % y;
}
static inline int32_t srem32(int32_t x, int32_t y)
{
    return x % y;
}
static inline int64_t srem64(int64_t x, int64_t y)
{
    return x % y;
}
static inline int8_t squot_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int16_t squot_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int32_t squot_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int64_t squot_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int8_t srem_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int16_t srem_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int32_t srem_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int64_t srem_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int8_t smin8(int8_t x, int8_t y)
{
    return x < y ? x : y;
}
static inline int16_t smin16(int16_t x, int16_t y)
{
    return x < y ? x : y;
}
static inline int32_t smin32(int32_t x, int32_t y)
{
    return x < y ? x : y;
}
static inline int64_t smin64(int64_t x, int64_t y)
{
    return x < y ? x : y;
}
static inline uint8_t umin8(uint8_t x, uint8_t y)
{
    return x < y ? x : y;
}
static inline uint16_t umin16(uint16_t x, uint16_t y)
{
    return x < y ? x : y;
}
static inline uint32_t umin32(uint32_t x, uint32_t y)
{
    return x < y ? x : y;
}
static inline uint64_t umin64(uint64_t x, uint64_t y)
{
    return x < y ? x : y;
}
static inline int8_t smax8(int8_t x, int8_t y)
{
    return x < y ? y : x;
}
static inline int16_t smax16(int16_t x, int16_t y)
{
    return x < y ? y : x;
}
static inline int32_t smax32(int32_t x, int32_t y)
{
    return x < y ? y : x;
}
static inline int64_t smax64(int64_t x, int64_t y)
{
    return x < y ? y : x;
}
static inline uint8_t umax8(uint8_t x, uint8_t y)
{
    return x < y ? y : x;
}
static inline uint16_t umax16(uint16_t x, uint16_t y)
{
    return x < y ? y : x;
}
static inline uint32_t umax32(uint32_t x, uint32_t y)
{
    return x < y ? y : x;
}
static inline uint64_t umax64(uint64_t x, uint64_t y)
{
    return x < y ? y : x;
}
static inline uint8_t shl8(uint8_t x, uint8_t y)
{
    return x << y;
}
static inline uint16_t shl16(uint16_t x, uint16_t y)
{
    return x << y;
}
static inline uint32_t shl32(uint32_t x, uint32_t y)
{
    return x << y;
}
static inline uint64_t shl64(uint64_t x, uint64_t y)
{
    return x << y;
}
static inline uint8_t lshr8(uint8_t x, uint8_t y)
{
    return x >> y;
}
static inline uint16_t lshr16(uint16_t x, uint16_t y)
{
    return x >> y;
}
static inline uint32_t lshr32(uint32_t x, uint32_t y)
{
    return x >> y;
}
static inline uint64_t lshr64(uint64_t x, uint64_t y)
{
    return x >> y;
}
static inline int8_t ashr8(int8_t x, int8_t y)
{
    return x >> y;
}
static inline int16_t ashr16(int16_t x, int16_t y)
{
    return x >> y;
}
static inline int32_t ashr32(int32_t x, int32_t y)
{
    return x >> y;
}
static inline int64_t ashr64(int64_t x, int64_t y)
{
    return x >> y;
}
static inline uint8_t and8(uint8_t x, uint8_t y)
{
    return x & y;
}
static inline uint16_t and16(uint16_t x, uint16_t y)
{
    return x & y;
}
static inline uint32_t and32(uint32_t x, uint32_t y)
{
    return x & y;
}
static inline uint64_t and64(uint64_t x, uint64_t y)
{
    return x & y;
}
static inline uint8_t or8(uint8_t x, uint8_t y)
{
    return x | y;
}
static inline uint16_t or16(uint16_t x, uint16_t y)
{
    return x | y;
}
static inline uint32_t or32(uint32_t x, uint32_t y)
{
    return x | y;
}
static inline uint64_t or64(uint64_t x, uint64_t y)
{
    return x | y;
}
static inline uint8_t xor8(uint8_t x, uint8_t y)
{
    return x ^ y;
}
static inline uint16_t xor16(uint16_t x, uint16_t y)
{
    return x ^ y;
}
static inline uint32_t xor32(uint32_t x, uint32_t y)
{
    return x ^ y;
}
static inline uint64_t xor64(uint64_t x, uint64_t y)
{
    return x ^ y;
}
static inline bool ult8(uint8_t x, uint8_t y)
{
    return x < y;
}
static inline bool ult16(uint16_t x, uint16_t y)
{
    return x < y;
}
static inline bool ult32(uint32_t x, uint32_t y)
{
    return x < y;
}
static inline bool ult64(uint64_t x, uint64_t y)
{
    return x < y;
}
static inline bool ule8(uint8_t x, uint8_t y)
{
    return x <= y;
}
static inline bool ule16(uint16_t x, uint16_t y)
{
    return x <= y;
}
static inline bool ule32(uint32_t x, uint32_t y)
{
    return x <= y;
}
static inline bool ule64(uint64_t x, uint64_t y)
{
    return x <= y;
}
static inline bool slt8(int8_t x, int8_t y)
{
    return x < y;
}
static inline bool slt16(int16_t x, int16_t y)
{
    return x < y;
}
static inline bool slt32(int32_t x, int32_t y)
{
    return x < y;
}
static inline bool slt64(int64_t x, int64_t y)
{
    return x < y;
}
static inline bool sle8(int8_t x, int8_t y)
{
    return x <= y;
}
static inline bool sle16(int16_t x, int16_t y)
{
    return x <= y;
}
static inline bool sle32(int32_t x, int32_t y)
{
    return x <= y;
}
static inline bool sle64(int64_t x, int64_t y)
{
    return x <= y;
}
static inline int8_t pow8(int8_t x, int8_t y)
{
    int8_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int16_t pow16(int16_t x, int16_t y)
{
    int16_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int32_t pow32(int32_t x, int32_t y)
{
    int32_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int64_t pow64(int64_t x, int64_t y)
{
    int64_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline bool itob_i8_bool(int8_t x)
{
    return x;
}
static inline bool itob_i16_bool(int16_t x)
{
    return x;
}
static inline bool itob_i32_bool(int32_t x)
{
    return x;
}
static inline bool itob_i64_bool(int64_t x)
{
    return x;
}
static inline int8_t btoi_bool_i8(bool x)
{
    return x;
}
static inline int16_t btoi_bool_i16(bool x)
{
    return x;
}
static inline int32_t btoi_bool_i32(bool x)
{
    return x;
}
static inline int64_t btoi_bool_i64(bool x)
{
    return x;
}
#define sext_i8_i8(x) ((int8_t) (int8_t) x)
#define sext_i8_i16(x) ((int16_t) (int8_t) x)
#define sext_i8_i32(x) ((int32_t) (int8_t) x)
#define sext_i8_i64(x) ((int64_t) (int8_t) x)
#define sext_i16_i8(x) ((int8_t) (int16_t) x)
#define sext_i16_i16(x) ((int16_t) (int16_t) x)
#define sext_i16_i32(x) ((int32_t) (int16_t) x)
#define sext_i16_i64(x) ((int64_t) (int16_t) x)
#define sext_i32_i8(x) ((int8_t) (int32_t) x)
#define sext_i32_i16(x) ((int16_t) (int32_t) x)
#define sext_i32_i32(x) ((int32_t) (int32_t) x)
#define sext_i32_i64(x) ((int64_t) (int32_t) x)
#define sext_i64_i8(x) ((int8_t) (int64_t) x)
#define sext_i64_i16(x) ((int16_t) (int64_t) x)
#define sext_i64_i32(x) ((int32_t) (int64_t) x)
#define sext_i64_i64(x) ((int64_t) (int64_t) x)
#define zext_i8_i8(x) ((int8_t) (uint8_t) x)
#define zext_i8_i16(x) ((int16_t) (uint8_t) x)
#define zext_i8_i32(x) ((int32_t) (uint8_t) x)
#define zext_i8_i64(x) ((int64_t) (uint8_t) x)
#define zext_i16_i8(x) ((int8_t) (uint16_t) x)
#define zext_i16_i16(x) ((int16_t) (uint16_t) x)
#define zext_i16_i32(x) ((int32_t) (uint16_t) x)
#define zext_i16_i64(x) ((int64_t) (uint16_t) x)
#define zext_i32_i8(x) ((int8_t) (uint32_t) x)
#define zext_i32_i16(x) ((int16_t) (uint32_t) x)
#define zext_i32_i32(x) ((int32_t) (uint32_t) x)
#define zext_i32_i64(x) ((int64_t) (uint32_t) x)
#define zext_i64_i8(x) ((int8_t) (uint64_t) x)
#define zext_i64_i16(x) ((int16_t) (uint64_t) x)
#define zext_i64_i32(x) ((int32_t) (uint64_t) x)
#define zext_i64_i64(x) ((int64_t) (uint64_t) x)
#if defined(__OPENCL_VERSION__)
static int32_t futrts_popc8(int8_t x)
{
    return popcount(x);
}
static int32_t futrts_popc16(int16_t x)
{
    return popcount(x);
}
static int32_t futrts_popc32(int32_t x)
{
    return popcount(x);
}
static int32_t futrts_popc64(int64_t x)
{
    return popcount(x);
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_popc8(int8_t x)
{
    return __popc(zext_i8_i32(x));
}
static int32_t futrts_popc16(int16_t x)
{
    return __popc(zext_i16_i32(x));
}
static int32_t futrts_popc32(int32_t x)
{
    return __popc(x);
}
static int32_t futrts_popc64(int64_t x)
{
    return __popcll(x);
}
#else
static int32_t futrts_popc8(int8_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc16(int16_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc32(int32_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc64(int64_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
#endif
#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    return mul_hi(a, b);
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    return mul_hi(a, b);
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    return mul_hi(a, b);
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    return mul_hi(a, b);
}
#elif defined(__CUDA_ARCH__)
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    uint16_t aa = a;
    uint16_t bb = b;
    
    return aa * bb >> 8;
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    uint32_t aa = a;
    uint32_t bb = b;
    
    return aa * bb >> 16;
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    return mulhi(a, b);
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    return mul64hi(a, b);
}
#else
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    uint16_t aa = a;
    uint16_t bb = b;
    
    return aa * bb >> 8;
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    uint32_t aa = a;
    uint32_t bb = b;
    
    return aa * bb >> 16;
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    uint64_t aa = a;
    uint64_t bb = b;
    
    return aa * bb >> 32;
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    __uint128_t aa = a;
    __uint128_t bb = b;
    
    return aa * bb >> 64;
}
#endif
#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)
{
    return mad_hi(a, b, c);
}
static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)
{
    return mad_hi(a, b, c);
}
static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)
{
    return mad_hi(a, b, c);
}
static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)
{
    return mad_hi(a, b, c);
}
#else
static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)
{
    return futrts_mul_hi8(a, b) + c;
}
static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)
{
    return futrts_mul_hi16(a, b) + c;
}
static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)
{
    return futrts_mul_hi32(a, b) + c;
}
static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)
{
    return futrts_mul_hi64(a, b) + c;
}
#endif
#if defined(__OPENCL_VERSION__)
static int32_t futrts_clzz8(int8_t x)
{
    return clz(x);
}
static int32_t futrts_clzz16(int16_t x)
{
    return clz(x);
}
static int32_t futrts_clzz32(int32_t x)
{
    return clz(x);
}
static int32_t futrts_clzz64(int64_t x)
{
    return clz(x);
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_clzz8(int8_t x)
{
    return __clz(zext_i8_i32(x)) - 24;
}
static int32_t futrts_clzz16(int16_t x)
{
    return __clz(zext_i16_i32(x)) - 16;
}
static int32_t futrts_clzz32(int32_t x)
{
    return __clz(x);
}
static int32_t futrts_clzz64(int64_t x)
{
    return __clzll(x);
}
#else
static int32_t futrts_clzz8(int8_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz16(int16_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz32(int32_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz64(int64_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
#endif
#if defined(__OPENCL_VERSION__)
static int32_t futrts_ctzz8(int8_t x)
{
    int i = 0;
    
    for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz16(int16_t x)
{
    int i = 0;
    
    for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz32(int32_t x)
{
    int i = 0;
    
    for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz64(int64_t x)
{
    int i = 0;
    
    for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_ctzz8(int8_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 8 : y - 1;
}
static int32_t futrts_ctzz16(int16_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 16 : y - 1;
}
static int32_t futrts_ctzz32(int32_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 32 : y - 1;
}
static int32_t futrts_ctzz64(int64_t x)
{
    int y = __ffsll(x);
    
    return y == 0 ? 64 : y - 1;
}
#else
static int32_t futrts_ctzz8(int8_t x)
{
    return x == 0 ? 8 : __builtin_ctz((uint32_t) x);
}
static int32_t futrts_ctzz16(int16_t x)
{
    return x == 0 ? 16 : __builtin_ctz((uint32_t) x);
}
static int32_t futrts_ctzz32(int32_t x)
{
    return x == 0 ? 32 : __builtin_ctz(x);
}
static int32_t futrts_ctzz64(int64_t x)
{
    return x == 0 ? 64 : __builtin_ctzl(x);
}
#endif
static inline float fdiv32(float x, float y)
{
    return x / y;
}
static inline float fadd32(float x, float y)
{
    return x + y;
}
static inline float fsub32(float x, float y)
{
    return x - y;
}
static inline float fmul32(float x, float y)
{
    return x * y;
}
static inline float fmin32(float x, float y)
{
    return fmin(x, y);
}
static inline float fmax32(float x, float y)
{
    return fmax(x, y);
}
static inline float fpow32(float x, float y)
{
    return pow(x, y);
}
static inline bool cmplt32(float x, float y)
{
    return x < y;
}
static inline bool cmple32(float x, float y)
{
    return x <= y;
}
static inline float sitofp_i8_f32(int8_t x)
{
    return (float) x;
}
static inline float sitofp_i16_f32(int16_t x)
{
    return (float) x;
}
static inline float sitofp_i32_f32(int32_t x)
{
    return (float) x;
}
static inline float sitofp_i64_f32(int64_t x)
{
    return (float) x;
}
static inline float uitofp_i8_f32(uint8_t x)
{
    return (float) x;
}
static inline float uitofp_i16_f32(uint16_t x)
{
    return (float) x;
}
static inline float uitofp_i32_f32(uint32_t x)
{
    return (float) x;
}
static inline float uitofp_i64_f32(uint64_t x)
{
    return (float) x;
}
static inline int8_t fptosi_f32_i8(float x)
{
    return (int8_t) x;
}
static inline int16_t fptosi_f32_i16(float x)
{
    return (int16_t) x;
}
static inline int32_t fptosi_f32_i32(float x)
{
    return (int32_t) x;
}
static inline int64_t fptosi_f32_i64(float x)
{
    return (int64_t) x;
}
static inline uint8_t fptoui_f32_i8(float x)
{
    return (uint8_t) x;
}
static inline uint16_t fptoui_f32_i16(float x)
{
    return (uint16_t) x;
}
static inline uint32_t fptoui_f32_i32(float x)
{
    return (uint32_t) x;
}
static inline uint64_t fptoui_f32_i64(float x)
{
    return (uint64_t) x;
}
static inline double fdiv64(double x, double y)
{
    return x / y;
}
static inline double fadd64(double x, double y)
{
    return x + y;
}
static inline double fsub64(double x, double y)
{
    return x - y;
}
static inline double fmul64(double x, double y)
{
    return x * y;
}
static inline double fmin64(double x, double y)
{
    return fmin(x, y);
}
static inline double fmax64(double x, double y)
{
    return fmax(x, y);
}
static inline double fpow64(double x, double y)
{
    return pow(x, y);
}
static inline bool cmplt64(double x, double y)
{
    return x < y;
}
static inline bool cmple64(double x, double y)
{
    return x <= y;
}
static inline double sitofp_i8_f64(int8_t x)
{
    return (double) x;
}
static inline double sitofp_i16_f64(int16_t x)
{
    return (double) x;
}
static inline double sitofp_i32_f64(int32_t x)
{
    return (double) x;
}
static inline double sitofp_i64_f64(int64_t x)
{
    return (double) x;
}
static inline double uitofp_i8_f64(uint8_t x)
{
    return (double) x;
}
static inline double uitofp_i16_f64(uint16_t x)
{
    return (double) x;
}
static inline double uitofp_i32_f64(uint32_t x)
{
    return (double) x;
}
static inline double uitofp_i64_f64(uint64_t x)
{
    return (double) x;
}
static inline int8_t fptosi_f64_i8(double x)
{
    return (int8_t) x;
}
static inline int16_t fptosi_f64_i16(double x)
{
    return (int16_t) x;
}
static inline int32_t fptosi_f64_i32(double x)
{
    return (int32_t) x;
}
static inline int64_t fptosi_f64_i64(double x)
{
    return (int64_t) x;
}
static inline uint8_t fptoui_f64_i8(double x)
{
    return (uint8_t) x;
}
static inline uint16_t fptoui_f64_i16(double x)
{
    return (uint16_t) x;
}
static inline uint32_t fptoui_f64_i32(double x)
{
    return (uint32_t) x;
}
static inline uint64_t fptoui_f64_i64(double x)
{
    return (uint64_t) x;
}
static inline float fpconv_f32_f32(float x)
{
    return (float) x;
}
static inline double fpconv_f32_f64(float x)
{
    return (double) x;
}
static inline float fpconv_f64_f32(double x)
{
    return (float) x;
}
static inline double fpconv_f64_f64(double x)
{
    return (double) x;
}
static inline float futrts_log32(float x)
{
    return log(x);
}
static inline float futrts_log2_32(float x)
{
    return log2(x);
}
static inline float futrts_log10_32(float x)
{
    return log10(x);
}
static inline float futrts_sqrt32(float x)
{
    return sqrt(x);
}
static inline float futrts_exp32(float x)
{
    return exp(x);
}
static inline float futrts_cos32(float x)
{
    return cos(x);
}
static inline float futrts_sin32(float x)
{
    return sin(x);
}
static inline float futrts_tan32(float x)
{
    return tan(x);
}
static inline float futrts_acos32(float x)
{
    return acos(x);
}
static inline float futrts_asin32(float x)
{
    return asin(x);
}
static inline float futrts_atan32(float x)
{
    return atan(x);
}
static inline float futrts_cosh32(float x)
{
    return cosh(x);
}
static inline float futrts_sinh32(float x)
{
    return sinh(x);
}
static inline float futrts_tanh32(float x)
{
    return tanh(x);
}
static inline float futrts_acosh32(float x)
{
    return acosh(x);
}
static inline float futrts_asinh32(float x)
{
    return asinh(x);
}
static inline float futrts_atanh32(float x)
{
    return atanh(x);
}
static inline float futrts_atan2_32(float x, float y)
{
    return atan2(x, y);
}
static inline float futrts_gamma32(float x)
{
    return tgamma(x);
}
static inline float futrts_lgamma32(float x)
{
    return lgamma(x);
}
static inline bool futrts_isnan32(float x)
{
    return isnan(x);
}
static inline bool futrts_isinf32(float x)
{
    return isinf(x);
}
static inline int32_t futrts_to_bits32(float x)
{
    union {
        float f;
        int32_t t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline float futrts_from_bits32(int32_t x)
{
    union {
        int32_t f;
        float t;
    } p;
    
    p.f = x;
    return p.t;
}
#ifdef __OPENCL_VERSION__
static inline float fmod32(float x, float y)
{
    return fmod(x, y);
}
static inline float futrts_round32(float x)
{
    return rint(x);
}
static inline float futrts_floor32(float x)
{
    return floor(x);
}
static inline float futrts_ceil32(float x)
{
    return ceil(x);
}
static inline float futrts_lerp32(float v0, float v1, float t)
{
    return mix(v0, v1, t);
}
static inline float futrts_mad32(float a, float b, float c)
{
    return mad(a, b, c);
}
static inline float futrts_fma32(float a, float b, float c)
{
    return fma(a, b, c);
}
#else
static inline float fmod32(float x, float y)
{
    return fmodf(x, y);
}
static inline float futrts_round32(float x)
{
    return rintf(x);
}
static inline float futrts_floor32(float x)
{
    return floorf(x);
}
static inline float futrts_ceil32(float x)
{
    return ceilf(x);
}
static inline float futrts_lerp32(float v0, float v1, float t)
{
    return v0 + (v1 - v0) * t;
}
static inline float futrts_mad32(float a, float b, float c)
{
    return a * b + c;
}
static inline float futrts_fma32(float a, float b, float c)
{
    return fmaf(a, b, c);
}
#endif
static inline double futrts_log64(double x)
{
    return log(x);
}
static inline double futrts_log2_64(double x)
{
    return log2(x);
}
static inline double futrts_log10_64(double x)
{
    return log10(x);
}
static inline double futrts_sqrt64(double x)
{
    return sqrt(x);
}
static inline double futrts_exp64(double x)
{
    return exp(x);
}
static inline double futrts_cos64(double x)
{
    return cos(x);
}
static inline double futrts_sin64(double x)
{
    return sin(x);
}
static inline double futrts_tan64(double x)
{
    return tan(x);
}
static inline double futrts_acos64(double x)
{
    return acos(x);
}
static inline double futrts_asin64(double x)
{
    return asin(x);
}
static inline double futrts_atan64(double x)
{
    return atan(x);
}
static inline double futrts_cosh64(double x)
{
    return cosh(x);
}
static inline double futrts_sinh64(double x)
{
    return sinh(x);
}
static inline double futrts_tanh64(double x)
{
    return tanh(x);
}
static inline double futrts_acosh64(double x)
{
    return acosh(x);
}
static inline double futrts_asinh64(double x)
{
    return asinh(x);
}
static inline double futrts_atanh64(double x)
{
    return atanh(x);
}
static inline double futrts_atan2_64(double x, double y)
{
    return atan2(x, y);
}
static inline double futrts_gamma64(double x)
{
    return tgamma(x);
}
static inline double futrts_lgamma64(double x)
{
    return lgamma(x);
}
static inline double futrts_fma64(double a, double b, double c)
{
    return fma(a, b, c);
}
static inline double futrts_round64(double x)
{
    return rint(x);
}
static inline double futrts_ceil64(double x)
{
    return ceil(x);
}
static inline double futrts_floor64(double x)
{
    return floor(x);
}
static inline bool futrts_isnan64(double x)
{
    return isnan(x);
}
static inline bool futrts_isinf64(double x)
{
    return isinf(x);
}
static inline int64_t futrts_to_bits64(double x)
{
    union {
        double f;
        int64_t t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline double futrts_from_bits64(int64_t x)
{
    union {
        int64_t f;
        double t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline double fmod64(double x, double y)
{
    return fmod(x, y);
}
#ifdef __OPENCL_VERSION__
static inline double futrts_lerp64(double v0, double v1, double t)
{
    return mix(v0, v1, t);
}
static inline double futrts_mad64(double a, double b, double c)
{
    return mad(a, b, c);
}
#else
static inline double futrts_lerp64(double v0, double v1, double t)
{
    return v0 + (v1 - v0) * t;
}
static inline double futrts_mad64(double a, double b, double c)
{
    return a * b + c;
}
#endif
int init_constants(struct futhark_context *);
int free_constants(struct futhark_context *);
static int32_t mainzicounter_mem_realtype_28913[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_28920[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_28932[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_28989[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzihist_locks_mem_realtype_29001[100151];
static int32_t mainzicounter_mem_realtype_29012[10240];
static int32_t mainzicounter_mem_realtype_29089[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_29116[10240];
static int32_t mainzicounter_mem_realtype_29127[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static float testzistatic_array_realtype_29135[9] = {1.0F, -0.5F, 1.0F, 1.0F,
                                                     1.0F, 1.0F, 1.0F, 1.0F,
                                                     1.0F};
static int64_t testzistatic_array_realtype_29136[9] = {10, 20, 5, 5, 50, 20, 30,
                                                       15, 18};
static float testzistatic_array_realtype_29137[9] = {1.0F, 0.5F, 0.25F, 0.1F,
                                                     0.3F, 0.1F, 2.0F, 3.0F,
                                                     1.0F};
static int32_t testzicounter_mem_realtype_29138[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_29145[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_29157[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_29214[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzihist_locks_mem_realtype_29226[100151];
static int32_t testzicounter_mem_realtype_29237[10240];
static int32_t testzicounter_mem_realtype_29314[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_29336[10240];
static int32_t testzicounter_mem_realtype_29347[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
struct memblock_device {
    int *references;
    cl_mem mem;
    int64_t size;
    const char *desc;
} ;
struct memblock {
    int *references;
    char *mem;
    int64_t size;
    const char *desc;
} ;
typedef cl_mem fl_mem_t;
// Start of free_list.h.

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem_t mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries;        // Pointer to entries.
  int capacity;                           // Number of entries.
  int used;                               // Number of valid entries.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
}

static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem_t mem, const char *tag) {
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size,
                          size_t *size_out, fl_mem_t *mem_out) {
  int size_match = -1;
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid &&
        size <= l->entries[i].size &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    return 0;
  } else {
    return 1;
  }
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem_t *mem_out) {
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      return 0;
    }
  }

  return 1;
}

// End of free_list.h.

// Start of opencl.h.

#define OPENCL_SUCCEED_FATAL(e) opencl_succeed_fatal(e, #e, __FILE__, __LINE__)
#define OPENCL_SUCCEED_NONFATAL(e) opencl_succeed_nonfatal(e, #e, __FILE__, __LINE__)
// Take care not to override an existing error.
#define OPENCL_SUCCEED_OR_RETURN(e) {             \
    char *serror = OPENCL_SUCCEED_NONFATAL(e);    \
    if (serror) {                                 \
      if (!ctx->error) {                          \
        ctx->error = serror;                      \
        return bad;                               \
      } else {                                    \
        free(serror);                             \
      }                                           \
    }                                             \
  }

// OPENCL_SUCCEED_OR_RETURN returns the value of the variable 'bad' in
// scope.  By default, it will be this one.  Create a local variable
// of some other type if needed.  This is a bit of a hack, but it
// saves effort in the code generator.
static const int bad = 1;

struct opencl_config {
  int debugging;
  int profiling;
  int logging;
  int preferred_device_num;
  const char *preferred_platform;
  const char *preferred_device;
  int ignore_blacklist;

  const char* dump_program_to;
  const char* load_program_from;
  const char* dump_binary_to;
  const char* load_binary_from;

  size_t default_group_size;
  size_t default_num_groups;
  size_t default_tile_size;
  size_t default_threshold;

  int default_group_size_changed;
  int default_tile_size_changed;

  int num_sizes;
  const char **size_names;
  const char **size_vars;
  size_t *size_values;
  const char **size_classes;
};

static void opencl_config_init(struct opencl_config *cfg,
                               int num_sizes,
                               const char *size_names[],
                               const char *size_vars[],
                               size_t *size_values,
                               const char *size_classes[]) {
  cfg->debugging = 0;
  cfg->logging = 0;
  cfg->profiling = 0;
  cfg->preferred_device_num = 0;
  cfg->preferred_platform = "";
  cfg->preferred_device = "";
  cfg->ignore_blacklist = 0;
  cfg->dump_program_to = NULL;
  cfg->load_program_from = NULL;
  cfg->dump_binary_to = NULL;
  cfg->load_binary_from = NULL;

  // The following are dummy sizes that mean the concrete defaults
  // will be set during initialisation via hardware-inspection-based
  // heuristics.
  cfg->default_group_size = 0;
  cfg->default_num_groups = 0;
  cfg->default_tile_size = 0;
  cfg->default_threshold = 0;

  cfg->default_group_size_changed = 0;
  cfg->default_tile_size_changed = 0;

  cfg->num_sizes = num_sizes;
  cfg->size_names = size_names;
  cfg->size_vars = size_vars;
  cfg->size_values = size_values;
  cfg->size_classes = size_classes;
}

// A record of something that happened.
struct profiling_record {
  cl_event *event;
  int *runs;
  int64_t *runtime;
};

struct opencl_context {
  cl_device_id device;
  cl_context ctx;
  cl_command_queue queue;

  struct opencl_config cfg;

  struct free_list free_list;

  size_t max_group_size;
  size_t max_num_groups;
  size_t max_tile_size;
  size_t max_threshold;
  size_t max_local_memory;

  size_t lockstep_width;

  struct profiling_record *profiling_records;
  int profiling_records_capacity;
  int profiling_records_used;
};

struct opencl_device_option {
  cl_platform_id platform;
  cl_device_id device;
  cl_device_type device_type;
  char *platform_name;
  char *device_name;
};

// This function must be defined by the user.  It is invoked by
// setup_opencl() after the platform and device has been found, but
// before the program is loaded.  Its intended use is to tune
// constants based on the selected platform and device.
static void post_opencl_setup(struct opencl_context*, struct opencl_device_option*);

static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

static const char* opencl_error_string(cl_int err)
{
    switch (err) {
        case CL_SUCCESS:                            return "Success!";
        case CL_DEVICE_NOT_FOUND:                   return "Device not found.";
        case CL_DEVICE_NOT_AVAILABLE:               return "Device not available";
        case CL_COMPILER_NOT_AVAILABLE:             return "Compiler not available";
        case CL_MEM_OBJECT_ALLOCATION_FAILURE:      return "Memory object allocation failure";
        case CL_OUT_OF_RESOURCES:                   return "Out of resources";
        case CL_OUT_OF_HOST_MEMORY:                 return "Out of host memory";
        case CL_PROFILING_INFO_NOT_AVAILABLE:       return "Profiling information not available";
        case CL_MEM_COPY_OVERLAP:                   return "Memory copy overlap";
        case CL_IMAGE_FORMAT_MISMATCH:              return "Image format mismatch";
        case CL_IMAGE_FORMAT_NOT_SUPPORTED:         return "Image format not supported";
        case CL_BUILD_PROGRAM_FAILURE:              return "Program build failure";
        case CL_MAP_FAILURE:                        return "Map failure";
        case CL_INVALID_VALUE:                      return "Invalid value";
        case CL_INVALID_DEVICE_TYPE:                return "Invalid device type";
        case CL_INVALID_PLATFORM:                   return "Invalid platform";
        case CL_INVALID_DEVICE:                     return "Invalid device";
        case CL_INVALID_CONTEXT:                    return "Invalid context";
        case CL_INVALID_QUEUE_PROPERTIES:           return "Invalid queue properties";
        case CL_INVALID_COMMAND_QUEUE:              return "Invalid command queue";
        case CL_INVALID_HOST_PTR:                   return "Invalid host pointer";
        case CL_INVALID_MEM_OBJECT:                 return "Invalid memory object";
        case CL_INVALID_IMAGE_FORMAT_DESCRIPTOR:    return "Invalid image format descriptor";
        case CL_INVALID_IMAGE_SIZE:                 return "Invalid image size";
        case CL_INVALID_SAMPLER:                    return "Invalid sampler";
        case CL_INVALID_BINARY:                     return "Invalid binary";
        case CL_INVALID_BUILD_OPTIONS:              return "Invalid build options";
        case CL_INVALID_PROGRAM:                    return "Invalid program";
        case CL_INVALID_PROGRAM_EXECUTABLE:         return "Invalid program executable";
        case CL_INVALID_KERNEL_NAME:                return "Invalid kernel name";
        case CL_INVALID_KERNEL_DEFINITION:          return "Invalid kernel definition";
        case CL_INVALID_KERNEL:                     return "Invalid kernel";
        case CL_INVALID_ARG_INDEX:                  return "Invalid argument index";
        case CL_INVALID_ARG_VALUE:                  return "Invalid argument value";
        case CL_INVALID_ARG_SIZE:                   return "Invalid argument size";
        case CL_INVALID_KERNEL_ARGS:                return "Invalid kernel arguments";
        case CL_INVALID_WORK_DIMENSION:             return "Invalid work dimension";
        case CL_INVALID_WORK_GROUP_SIZE:            return "Invalid work group size";
        case CL_INVALID_WORK_ITEM_SIZE:             return "Invalid work item size";
        case CL_INVALID_GLOBAL_OFFSET:              return "Invalid global offset";
        case CL_INVALID_EVENT_WAIT_LIST:            return "Invalid event wait list";
        case CL_INVALID_EVENT:                      return "Invalid event";
        case CL_INVALID_OPERATION:                  return "Invalid operation";
        case CL_INVALID_GL_OBJECT:                  return "Invalid OpenGL object";
        case CL_INVALID_BUFFER_SIZE:                return "Invalid buffer size";
        case CL_INVALID_MIP_LEVEL:                  return "Invalid mip-map level";
        default:                                    return "Unknown";
    }
}

static void opencl_succeed_fatal(unsigned int ret,
                                 const char *call,
                                 const char *file,
                                 int line) {
  if (ret != CL_SUCCESS) {
    futhark_panic(-1, "%s:%d: OpenCL call\n  %s\nfailed with error code %d (%s)\n",
          file, line, call, ret, opencl_error_string(ret));
  }
}

static char* opencl_succeed_nonfatal(unsigned int ret,
                                     const char *call,
                                     const char *file,
                                     int line) {
  if (ret != CL_SUCCESS) {
    return msgprintf("%s:%d: OpenCL call\n  %s\nfailed with error code %d (%s)\n",
                     file, line, call, ret, opencl_error_string(ret));
  } else {
    return NULL;
  }
}

static void set_preferred_platform(struct opencl_config *cfg, const char *s) {
  cfg->preferred_platform = s;
  cfg->ignore_blacklist = 1;
}

static void set_preferred_device(struct opencl_config *cfg, const char *s) {
  int x = 0;
  if (*s == '#') {
    s++;
    while (isdigit(*s)) {
      x = x * 10 + (*s++)-'0';
    }
    // Skip trailing spaces.
    while (isspace(*s)) {
      s++;
    }
  }
  cfg->preferred_device = s;
  cfg->preferred_device_num = x;
  cfg->ignore_blacklist = 1;
}

static char* opencl_platform_info(cl_platform_id platform,
                                  cl_platform_info param) {
  size_t req_bytes;
  char *info;

  OPENCL_SUCCEED_FATAL(clGetPlatformInfo(platform, param, 0, NULL, &req_bytes));

  info = (char*) malloc(req_bytes);

  OPENCL_SUCCEED_FATAL(clGetPlatformInfo(platform, param, req_bytes, info, NULL));

  return info;
}

static char* opencl_device_info(cl_device_id device,
                                cl_device_info param) {
  size_t req_bytes;
  char *info;

  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device, param, 0, NULL, &req_bytes));

  info = (char*) malloc(req_bytes);

  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device, param, req_bytes, info, NULL));

  return info;
}

static void opencl_all_device_options(struct opencl_device_option **devices_out,
                                      size_t *num_devices_out) {
  size_t num_devices = 0, num_devices_added = 0;

  cl_platform_id *all_platforms;
  cl_uint *platform_num_devices;

  cl_uint num_platforms;

  // Find the number of platforms.
  OPENCL_SUCCEED_FATAL(clGetPlatformIDs(0, NULL, &num_platforms));

  // Make room for them.
  all_platforms = calloc(num_platforms, sizeof(cl_platform_id));
  platform_num_devices = calloc(num_platforms, sizeof(cl_uint));

  // Fetch all the platforms.
  OPENCL_SUCCEED_FATAL(clGetPlatformIDs(num_platforms, all_platforms, NULL));

  // Count the number of devices for each platform, as well as the
  // total number of devices.
  for (cl_uint i = 0; i < num_platforms; i++) {
    if (clGetDeviceIDs(all_platforms[i], CL_DEVICE_TYPE_ALL,
                       0, NULL, &platform_num_devices[i]) == CL_SUCCESS) {
      num_devices += platform_num_devices[i];
    } else {
      platform_num_devices[i] = 0;
    }
  }

  // Make room for all the device options.
  struct opencl_device_option *devices =
    calloc(num_devices, sizeof(struct opencl_device_option));

  // Loop through the platforms, getting information about their devices.
  for (cl_uint i = 0; i < num_platforms; i++) {
    cl_platform_id platform = all_platforms[i];
    cl_uint num_platform_devices = platform_num_devices[i];

    if (num_platform_devices == 0) {
      continue;
    }

    char *platform_name = opencl_platform_info(platform, CL_PLATFORM_NAME);
    cl_device_id *platform_devices =
      calloc(num_platform_devices, sizeof(cl_device_id));

    // Fetch all the devices.
    OPENCL_SUCCEED_FATAL(clGetDeviceIDs(platform, CL_DEVICE_TYPE_ALL,
                                  num_platform_devices, platform_devices, NULL));

    // Loop through the devices, adding them to the devices array.
    for (cl_uint i = 0; i < num_platform_devices; i++) {
      char *device_name = opencl_device_info(platform_devices[i], CL_DEVICE_NAME);
      devices[num_devices_added].platform = platform;
      devices[num_devices_added].device = platform_devices[i];
      OPENCL_SUCCEED_FATAL(clGetDeviceInfo(platform_devices[i], CL_DEVICE_TYPE,
                                     sizeof(cl_device_type),
                                     &devices[num_devices_added].device_type,
                                     NULL));
      // We don't want the structs to share memory, so copy the platform name.
      // Each device name is already unique.
      devices[num_devices_added].platform_name = strclone(platform_name);
      devices[num_devices_added].device_name = device_name;
      num_devices_added++;
    }
    free(platform_devices);
    free(platform_name);
  }
  free(all_platforms);
  free(platform_num_devices);

  *devices_out = devices;
  *num_devices_out = num_devices;
}

// Returns 0 on success.
static int list_devices(struct opencl_config *cfg) {
  struct opencl_device_option *devices;
  size_t num_devices;

  opencl_all_device_options(&devices, &num_devices);

  const char *cur_platform = "";
  for (size_t i = 0; i < num_devices; i++) {
    struct opencl_device_option device = devices[i];
    if (strcmp(cur_platform, device.platform_name) != 0) {
      printf("Platform: %s\n", device.platform_name);
      cur_platform = device.platform_name;
    }
    printf("[%d]: %s\n", (int)i, device.device_name);
  }

  // Free all the platform and device names.
  for (size_t j = 0; j < num_devices; j++) {
    free(devices[j].platform_name);
    free(devices[j].device_name);
  }
  free(devices);

  return 0;
}

// Returns 0 on success.
static int select_device_interactively(struct opencl_config *cfg) {
  struct opencl_device_option *devices;
  size_t num_devices;
  int ret = 1;

  opencl_all_device_options(&devices, &num_devices);

  printf("Choose OpenCL device:\n");
  const char *cur_platform = "";
  for (size_t i = 0; i < num_devices; i++) {
    struct opencl_device_option device = devices[i];
    if (strcmp(cur_platform, device.platform_name) != 0) {
      printf("Platform: %s\n", device.platform_name);
      cur_platform = device.platform_name;
    }
    printf("[%d] %s\n", (int)i, device.device_name);
  }

  int selection;
  printf("Choice: ");
  if (scanf("%d", &selection) == 1) {
    ret = 0;
    cfg->preferred_platform = "";
    cfg->preferred_device = "";
    cfg->preferred_device_num = selection;
    cfg->ignore_blacklist = 1;
  }

  // Free all the platform and device names.
  for (size_t j = 0; j < num_devices; j++) {
    free(devices[j].platform_name);
    free(devices[j].device_name);
  }
  free(devices);

  return ret;
}

static int is_blacklisted(const char *platform_name, const char *device_name,
                          const struct opencl_config *cfg) {
  if (strcmp(cfg->preferred_platform, "") != 0 ||
      strcmp(cfg->preferred_device, "") != 0) {
    return 0;
  } else if (strstr(platform_name, "Apple") != NULL &&
             strstr(device_name, "Intel(R) Core(TM)") != NULL) {
    return 1;
  } else {
    return 0;
  }
}

static struct opencl_device_option get_preferred_device(const struct opencl_config *cfg) {
  struct opencl_device_option *devices;
  size_t num_devices;

  opencl_all_device_options(&devices, &num_devices);

  int num_device_matches = 0;

  for (size_t i = 0; i < num_devices; i++) {
    struct opencl_device_option device = devices[i];
    if (strstr(device.platform_name, cfg->preferred_platform) != NULL &&
        strstr(device.device_name, cfg->preferred_device) != NULL &&
        (cfg->ignore_blacklist ||
         !is_blacklisted(device.platform_name, device.device_name, cfg)) &&
        num_device_matches++ == cfg->preferred_device_num) {
      // Free all the platform and device names, except the ones we have chosen.
      for (size_t j = 0; j < num_devices; j++) {
        if (j != i) {
          free(devices[j].platform_name);
          free(devices[j].device_name);
        }
      }
      free(devices);
      return device;
    }
  }

  futhark_panic(1, "Could not find acceptable OpenCL device.\n");
  exit(1); // Never reached
}

static void describe_device_option(struct opencl_device_option device) {
  fprintf(stderr, "Using platform: %s\n", device.platform_name);
  fprintf(stderr, "Using device: %s\n", device.device_name);
}

static cl_build_status build_opencl_program(cl_program program, cl_device_id device, const char* options) {
  cl_int clBuildProgram_error = clBuildProgram(program, 1, &device, options, NULL, NULL);

  // Avoid termination due to CL_BUILD_PROGRAM_FAILURE
  if (clBuildProgram_error != CL_SUCCESS &&
      clBuildProgram_error != CL_BUILD_PROGRAM_FAILURE) {
    OPENCL_SUCCEED_FATAL(clBuildProgram_error);
  }

  cl_build_status build_status;
  OPENCL_SUCCEED_FATAL(clGetProgramBuildInfo(program,
                                             device,
                                             CL_PROGRAM_BUILD_STATUS,
                                             sizeof(cl_build_status),
                                             &build_status,
                                             NULL));

  if (build_status != CL_SUCCESS) {
    char *build_log;
    size_t ret_val_size;
    OPENCL_SUCCEED_FATAL(clGetProgramBuildInfo(program, device, CL_PROGRAM_BUILD_LOG, 0, NULL, &ret_val_size));

    build_log = (char*) malloc(ret_val_size+1);
    OPENCL_SUCCEED_FATAL(clGetProgramBuildInfo(program, device, CL_PROGRAM_BUILD_LOG, ret_val_size, build_log, NULL));

    // The spec technically does not say whether the build log is zero-terminated, so let's be careful.
    build_log[ret_val_size] = '\0';

    fprintf(stderr, "Build log:\n%s\n", build_log);

    free(build_log);
  }

  return build_status;
}

// Fields in a bitmask indicating which types we must be sure are
// available.
enum opencl_required_type { OPENCL_F64 = 1 };

// We take as input several strings representing the program, because
// C does not guarantee that the compiler supports particularly large
// literals.  Notably, Visual C has a limit of 2048 characters.  The
// array must be NULL-terminated.
static cl_program setup_opencl_with_command_queue(struct opencl_context *ctx,
                                                  cl_command_queue queue,
                                                  const char *srcs[],
                                                  int required_types,
                                                  const char *extra_build_opts[]) {
  int error;

  free_list_init(&ctx->free_list);
  ctx->queue = queue;

  OPENCL_SUCCEED_FATAL(clGetCommandQueueInfo(ctx->queue, CL_QUEUE_CONTEXT, sizeof(cl_context), &ctx->ctx, NULL));

  // Fill out the device info.  This is redundant work if we are
  // called from setup_opencl() (which is the common case), but I
  // doubt it matters much.
  struct opencl_device_option device_option;
  OPENCL_SUCCEED_FATAL(clGetCommandQueueInfo(ctx->queue, CL_QUEUE_DEVICE,
                                       sizeof(cl_device_id),
                                       &device_option.device,
                                       NULL));
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_PLATFORM,
                                 sizeof(cl_platform_id),
                                 &device_option.platform,
                                 NULL));
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_TYPE,
                                 sizeof(cl_device_type),
                                 &device_option.device_type,
                                 NULL));
  device_option.platform_name = opencl_platform_info(device_option.platform, CL_PLATFORM_NAME);
  device_option.device_name = opencl_device_info(device_option.device, CL_DEVICE_NAME);

  ctx->device = device_option.device;

  if (required_types & OPENCL_F64) {
    cl_uint supported;
    OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_PREFERRED_VECTOR_WIDTH_DOUBLE,
                                   sizeof(cl_uint), &supported, NULL));
    if (!supported) {
      futhark_panic(1, "Program uses double-precision floats, but this is not supported on the chosen device: %s\n",
            device_option.device_name);
    }
  }

  size_t max_group_size;
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_MAX_WORK_GROUP_SIZE,
                                 sizeof(size_t), &max_group_size, NULL));

  size_t max_tile_size = sqrt(max_group_size);

  cl_ulong max_local_memory;
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_LOCAL_MEM_SIZE,
                                       sizeof(size_t), &max_local_memory, NULL));

  // Futhark reserves 4 bytes for bookkeeping information.
  max_local_memory -= 4;

  // The OpenCL implementation may reserve some local memory bytes for
  // various purposes.  In principle, we should use
  // clGetKernelWorkGroupInfo() to figure out for each kernel how much
  // is actually available, but our current code generator design
  // makes this infeasible.  Instead, we have this nasty hack where we
  // arbitrarily subtract some bytes, based on empirical measurements
  // (but which might be arbitrarily wrong).  Fortunately, we rarely
  // try to really push the local memory usage.
  if (strstr(device_option.platform_name, "NVIDIA CUDA") != NULL) {
    max_local_memory -= 12;
  } else if (strstr(device_option.platform_name, "AMD") != NULL) {
    max_local_memory -= 16;
  }

  // Make sure this function is defined.
  post_opencl_setup(ctx, &device_option);

  if (max_group_size < ctx->cfg.default_group_size) {
    if (ctx->cfg.default_group_size_changed) {
      fprintf(stderr, "Note: Device limits default group size to %zu (down from %zu).\n",
              max_group_size, ctx->cfg.default_group_size);
    }
    ctx->cfg.default_group_size = max_group_size;
  }

  if (max_tile_size < ctx->cfg.default_tile_size) {
    if (ctx->cfg.default_tile_size_changed) {
      fprintf(stderr, "Note: Device limits default tile size to %zu (down from %zu).\n",
              max_tile_size, ctx->cfg.default_tile_size);
    }
    ctx->cfg.default_tile_size = max_tile_size;
  }

  ctx->max_group_size = max_group_size;
  ctx->max_tile_size = max_tile_size; // No limit.
  ctx->max_threshold = ctx->max_num_groups = 0; // No limit.
  ctx->max_local_memory = max_local_memory;

  // Now we go through all the sizes, clamp them to the valid range,
  // or set them to the default.
  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    const char *size_class = ctx->cfg.size_classes[i];
    size_t *size_value = &ctx->cfg.size_values[i];
    const char* size_name = ctx->cfg.size_names[i];
    size_t max_value = 0, default_value = 0;
    if (strstr(size_class, "group_size") == size_class) {
      max_value = max_group_size;
      default_value = ctx->cfg.default_group_size;
    } else if (strstr(size_class, "num_groups") == size_class) {
      max_value = max_group_size; // Futhark assumes this constraint.
      default_value = ctx->cfg.default_num_groups;
      // XXX: as a quick and dirty hack, use twice as many threads for
      // histograms by default.  We really should just be smarter
      // about sizes somehow.
      if (strstr(size_name, ".seghist_") != NULL) {
        default_value *= 2;
      }
    } else if (strstr(size_class, "tile_size") == size_class) {
      max_value = sqrt(max_group_size);
      default_value = ctx->cfg.default_tile_size;
    } else if (strstr(size_class, "threshold") == size_class) {
      // Threshold can be as large as it takes.
      default_value = ctx->cfg.default_threshold;
    } else {
      // Bespoke sizes have no limit or default.
    }
    if (*size_value == 0) {
      *size_value = default_value;
    } else if (max_value > 0 && *size_value > max_value) {
      fprintf(stderr, "Note: Device limits %s to %d (down from %d)\n",
              size_name, (int)max_value, (int)*size_value);
      *size_value = max_value;
    }
  }

  if (ctx->lockstep_width == 0) {
    ctx->lockstep_width = 1;
  }

  if (ctx->cfg.logging) {
    fprintf(stderr, "Lockstep width: %d\n", (int)ctx->lockstep_width);
    fprintf(stderr, "Default group size: %d\n", (int)ctx->cfg.default_group_size);
    fprintf(stderr, "Default number of groups: %d\n", (int)ctx->cfg.default_num_groups);
  }

  char *fut_opencl_src = NULL;
  cl_program prog;
  error = CL_SUCCESS;

  if (ctx->cfg.load_binary_from == NULL) {
    size_t src_size = 0;

    // Maybe we have to read OpenCL source from somewhere else (used for debugging).
    if (ctx->cfg.load_program_from != NULL) {
      fut_opencl_src = slurp_file(ctx->cfg.load_program_from, NULL);
      assert(fut_opencl_src != NULL);
    } else {
      // Construct the OpenCL source concatenating all the fragments.
      for (const char **src = srcs; src && *src; src++) {
        src_size += strlen(*src);
      }

      fut_opencl_src = (char*) malloc(src_size + 1);

      size_t n, i;
      for (i = 0, n = 0; srcs && srcs[i]; i++) {
        strncpy(fut_opencl_src+n, srcs[i], src_size-n);
        n += strlen(srcs[i]);
      }
      fut_opencl_src[src_size] = 0;
    }

    if (ctx->cfg.dump_program_to != NULL) {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "Dumping OpenCL source to %s...\n", ctx->cfg.dump_program_to);
      }

      dump_file(ctx->cfg.dump_program_to, fut_opencl_src, strlen(fut_opencl_src));
    }

    if (ctx->cfg.debugging) {
      fprintf(stderr, "Creating OpenCL program...\n");
    }

    const char* src_ptr[] = {fut_opencl_src};
    prog = clCreateProgramWithSource(ctx->ctx, 1, src_ptr, &src_size, &error);
    OPENCL_SUCCEED_FATAL(error);
  } else {
    if (ctx->cfg.debugging) {
      fprintf(stderr, "Loading OpenCL binary from %s...\n", ctx->cfg.load_binary_from);
    }
    size_t binary_size;
    unsigned char *fut_opencl_bin =
      (unsigned char*) slurp_file(ctx->cfg.load_binary_from, &binary_size);
    assert(fut_opencl_bin != NULL);
    const unsigned char *binaries[1] = { fut_opencl_bin };
    cl_int status = 0;

    prog = clCreateProgramWithBinary(ctx->ctx, 1, &device_option.device,
                                     &binary_size, binaries,
                                     &status, &error);

    OPENCL_SUCCEED_FATAL(status);
    OPENCL_SUCCEED_FATAL(error);
  }

  int compile_opts_size = 1024;

  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    compile_opts_size += strlen(ctx->cfg.size_names[i]) + 20;
  }

  for (int i = 0; extra_build_opts[i] != NULL; i++) {
    compile_opts_size += strlen(extra_build_opts[i] + 1);
  }

  char *compile_opts = (char*) malloc(compile_opts_size);

  int w = snprintf(compile_opts, compile_opts_size,
                   "-DLOCKSTEP_WIDTH=%d ",
                   (int)ctx->lockstep_width);

  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    w += snprintf(compile_opts+w, compile_opts_size-w,
                  "-D%s=%d ",
                  ctx->cfg.size_vars[i],
                  (int)ctx->cfg.size_values[i]);
  }

  for (int i = 0; extra_build_opts[i] != NULL; i++) {
    w += snprintf(compile_opts+w, compile_opts_size-w,
                  "%s ", extra_build_opts[i]);
  }

  if (ctx->cfg.debugging) {
    fprintf(stderr, "OpenCL compiler options: %s\n", compile_opts);
    fprintf(stderr, "Building OpenCL program...\n");
  }
  OPENCL_SUCCEED_FATAL(build_opencl_program(prog, device_option.device, compile_opts));

  free(compile_opts);
  free(fut_opencl_src);

  if (ctx->cfg.dump_binary_to != NULL) {
    if (ctx->cfg.debugging) {
      fprintf(stderr, "Dumping OpenCL binary to %s...\n", ctx->cfg.dump_binary_to);
    }

    size_t binary_size;
    OPENCL_SUCCEED_FATAL(clGetProgramInfo(prog, CL_PROGRAM_BINARY_SIZES,
                                          sizeof(size_t), &binary_size, NULL));
    unsigned char *binary = (unsigned char*) malloc(binary_size);
    unsigned char *binaries[1] = { binary };
    OPENCL_SUCCEED_FATAL(clGetProgramInfo(prog, CL_PROGRAM_BINARIES,
                                          sizeof(unsigned char*), binaries, NULL));

    dump_file(ctx->cfg.dump_binary_to, binary, binary_size);
  }

  return prog;
}

static cl_program setup_opencl(struct opencl_context *ctx,
                               const char *srcs[],
                               int required_types,
                               const char *extra_build_opts[]) {

  ctx->lockstep_width = 0; // Real value set later.

  struct opencl_device_option device_option = get_preferred_device(&ctx->cfg);

  if (ctx->cfg.logging) {
    describe_device_option(device_option);
  }

  // Note that NVIDIA's OpenCL requires the platform property
  cl_context_properties properties[] = {
    CL_CONTEXT_PLATFORM,
    (cl_context_properties)device_option.platform,
    0
  };

  cl_int clCreateContext_error;
  ctx->ctx = clCreateContext(properties, 1, &device_option.device, NULL, NULL, &clCreateContext_error);
  OPENCL_SUCCEED_FATAL(clCreateContext_error);

  cl_int clCreateCommandQueue_error;
  cl_command_queue queue =
    clCreateCommandQueue(ctx->ctx,
                         device_option.device,
                         ctx->cfg.profiling ? CL_QUEUE_PROFILING_ENABLE : 0,
                         &clCreateCommandQueue_error);
  OPENCL_SUCCEED_FATAL(clCreateCommandQueue_error);

  return setup_opencl_with_command_queue(ctx, queue, srcs, required_types, extra_build_opts);
}

// Count up the runtime all the profiling_records that occured during execution.
// Also clears the buffer of profiling_records.
static cl_int opencl_tally_profiling_records(struct opencl_context *ctx) {
  cl_int err;
  for (int i = 0; i < ctx->profiling_records_used; i++) {
    struct profiling_record record = ctx->profiling_records[i];

    cl_ulong start_t, end_t;

    if ((err = clGetEventProfilingInfo(*record.event,
                                       CL_PROFILING_COMMAND_START,
                                       sizeof(start_t),
                                       &start_t,
                                       NULL)) != CL_SUCCESS) {
      return err;
    }

    if ((err = clGetEventProfilingInfo(*record.event,
                                       CL_PROFILING_COMMAND_END,
                                       sizeof(end_t),
                                       &end_t,
                                       NULL)) != CL_SUCCESS) {
      return err;
    }

    // OpenCL provides nanosecond resolution, but we want
    // microseconds.
    *record.runs += 1;
    *record.runtime += (end_t - start_t)/1000;

    if ((err = clReleaseEvent(*record.event)) != CL_SUCCESS) {
      return err;
    }
    free(record.event);
  }

  ctx->profiling_records_used = 0;

  return CL_SUCCESS;
}

// If profiling, produce an event associated with a profiling record.
static cl_event* opencl_get_event(struct opencl_context *ctx, int *runs, int64_t *runtime) {
    if (ctx->profiling_records_used == ctx->profiling_records_capacity) {
      ctx->profiling_records_capacity *= 2;
      ctx->profiling_records =
        realloc(ctx->profiling_records,
                ctx->profiling_records_capacity *
                sizeof(struct profiling_record));
    }
    cl_event *event = malloc(sizeof(cl_event));
    ctx->profiling_records[ctx->profiling_records_used].event = event;
    ctx->profiling_records[ctx->profiling_records_used].runs = runs;
    ctx->profiling_records[ctx->profiling_records_used].runtime = runtime;
    ctx->profiling_records_used++;
    return event;
}

// Allocate memory from driver. The problem is that OpenCL may perform
// lazy allocation, so we cannot know whether an allocation succeeded
// until the first time we try to use it.  Hence we immediately
// perform a write to see if the allocation succeeded.  This is slow,
// but the assumption is that this operation will be rare (most things
// will go through the free list).
static int opencl_alloc_actual(struct opencl_context *ctx, size_t size, cl_mem *mem_out) {
  int error;
  *mem_out = clCreateBuffer(ctx->ctx, CL_MEM_READ_WRITE, size, NULL, &error);

  if (error != CL_SUCCESS) {
    return error;
  }

  int x = 2;
  error = clEnqueueWriteBuffer(ctx->queue, *mem_out, 1, 0, sizeof(x), &x, 0, NULL, NULL);

  // No need to wait for completion here. clWaitForEvents() cannot
  // return mem object allocation failures. This implies that the
  // buffer is faulted onto the device on enqueue. (Observation by
  // Andreas Kloeckner.)

  return error;
}

static int opencl_alloc(struct opencl_context *ctx, size_t min_size, const char *tag, cl_mem *mem_out) {
  (void)tag;
  if (min_size < sizeof(int)) {
    min_size = sizeof(int);
  }

  size_t size;

  if (free_list_find(&ctx->free_list, min_size, &size, mem_out) == 0) {
    // Successfully found a free block.  Is it big enough?
    //
    // FIXME: we might also want to check whether the block is *too
    // big*, to avoid internal fragmentation.  However, this can
    // sharply impact performance on programs where arrays change size
    // frequently.  Fortunately, such allocations are usually fairly
    // short-lived, as they are necessarily within a loop, so the risk
    // of internal fragmentation resulting in an OOM situation is
    // limited.  However, it would be preferable if we could go back
    // and *shrink* oversize allocations when we encounter an OOM
    // condition.  That is technically feasible, since we do not
    // expose OpenCL pointer values directly to the application, but
    // instead rely on a level of indirection.
    if (size >= min_size) {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "No need to allocate: Found a block in the free list.\n");
      }

      return CL_SUCCESS;
    } else {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "Found a free block, but it was too small.\n");
      }

      // Not just right - free it.
      int error = clReleaseMemObject(*mem_out);
      if (error != CL_SUCCESS) {
        return error;
      }
    }
  }

  // We have to allocate a new block from the driver.  If the
  // allocation does not succeed, then we might be in an out-of-memory
  // situation.  We now start freeing things from the free list until
  // we think we have freed enough that the allocation will succeed.
  // Since we don't know how far the allocation is from fitting, we
  // have to check after every deallocation.  This might be pretty
  // expensive.  Let's hope that this case is hit rarely.

  if (ctx->cfg.debugging) {
    fprintf(stderr, "Actually allocating the desired block.\n");
  }

  int error = opencl_alloc_actual(ctx, min_size, mem_out);

  while (error == CL_MEM_OBJECT_ALLOCATION_FAILURE) {
    if (ctx->cfg.debugging) {
      fprintf(stderr, "Out of OpenCL memory: releasing entry from the free list...\n");
    }
    cl_mem mem;
    if (free_list_first(&ctx->free_list, &mem) == 0) {
      error = clReleaseMemObject(mem);
      if (error != CL_SUCCESS) {
        return error;
      }
    } else {
      break;
    }
    error = opencl_alloc_actual(ctx, min_size, mem_out);
  }

  return error;
}

static int opencl_free(struct opencl_context *ctx, cl_mem mem, const char *tag) {
  size_t size;
  cl_mem existing_mem;

  // If there is already a block with this tag, then remove it.
  if (free_list_find(&ctx->free_list, -1, &size, &existing_mem) == 0) {
    int error = clReleaseMemObject(existing_mem);
    if (error != CL_SUCCESS) {
      return error;
    }
  }

  int error = clGetMemObjectInfo(mem, CL_MEM_SIZE, sizeof(size_t), &size, NULL);

  if (error == CL_SUCCESS) {
    free_list_insert(&ctx->free_list, size, mem, tag);
  }

  return error;
}

static int opencl_free_all(struct opencl_context *ctx) {
  cl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, &mem) == 0) {
    int error = clReleaseMemObject(mem);
    if (error != CL_SUCCESS) {
      return error;
    }
  }

  return CL_SUCCESS;
}

// Free everything that belongs to 'ctx', but do not free 'ctx'
// itself.
static void teardown_opencl(struct opencl_context *ctx) {
  (void)opencl_tally_profiling_records(ctx);
  free(ctx->profiling_records);
  (void)opencl_free_all(ctx);
  (void)clReleaseCommandQueue(ctx->queue);
  (void)clReleaseContext(ctx->ctx);
}

// End of opencl.h.

static const char *opencl_program[] =
                  {"#ifdef cl_clang_storage_class_specifiers\n#pragma OPENCL EXTENSION cl_clang_storage_class_specifiers : enable\n#endif\n#pragma OPENCL EXTENSION cl_khr_byte_addressable_store : enable\n__kernel void dummy_kernel(__global unsigned char *dummy, int n)\n{\n    const int thread_gid = get_global_id(0);\n    \n    if (thread_gid >= n)\n        return;\n}\ntypedef char int8_t;\ntypedef short int16_t;\ntypedef int int32_t;\ntypedef long int64_t;\ntypedef uchar uint8_t;\ntypedef ushort uint16_t;\ntypedef uint uint32_t;\ntypedef ulong uint64_t;\n#ifdef cl_nv_pragma_unroll\nstatic inline void mem_fence_global()\n{\n    asm(\"membar.gl;\");\n}\n#else\nstatic inline void mem_fence_global()\n{\n    mem_fence(CLK_LOCAL_MEM_FENCE | CLK_GLOBAL_MEM_FENCE);\n}\n#endif\nstatic inline void mem_fence_local()\n{\n    mem_fence(CLK_LOCAL_MEM_FENCE);\n}\nstatic inline uint8_t add8(uint8_t x, uint8_t y)\n{\n    return x + y;\n}\nstatic inline uint16_t add16(uint16_t x, uint16_t y)\n{\n    return x + y;\n}\nstatic inline uint32_t add32(uint32_t x, uint32_t y)\n{\n    return x + y;\n}\nstatic inline uint64_t add64(uint64_t x, uint64_t y)\n{\n    return x + y;\n}\nstatic inline uint8_t sub8(uint8_t x, uint8_t y)\n{\n    return x - y;\n}\nstatic inline uint16_t sub16(uint16_t x, uint16_t y)\n{\n    return x - y;\n}\nstatic inline uint32_t sub32(uint32_t x, uint32_t y)\n{\n    return x - y;\n}\nstatic inline uint64_t sub64(uint64_t x, uint64_t y)\n{\n    return x - y;\n}\nstatic inline uint8_t mul8(uint8_t x, uint8_t y)\n{\n    return x * y;\n}\nstatic inline uint16_t mul16(uint16_t x, uint16_t y)\n{\n    return x * y;\n}\nstatic inline uint32_t mul32(uint32_t x, uint32_t y)\n{\n    return x * y;\n}\nstatic inline uint64_t mul64(uint64_t x, uint64_t y)\n{\n    return x * y;\n}\nstatic inline uint8_t udiv8(uint8_t x, uint8_t y)\n{\n    return x / y;\n}\nstatic inline uint16_t udiv16(uint16_t x, uint16_t y)\n{\n    return x / y;\n}\nstatic inline uint32_t udiv32(uint32_t x, uint32_t y)\n{\n    return x / y;\n}\nstatic inline uint64_t udiv64(uint64_t x, uint64_t y)\n{\n    return x / y;\n}\nstatic ",
                   "inline uint8_t udiv_up8(uint8_t x, uint8_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint16_t udiv_up16(uint16_t x, uint16_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint32_t udiv_up32(uint32_t x, uint32_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint64_t udiv_up64(uint64_t x, uint64_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint8_t umod8(uint8_t x, uint8_t y)\n{\n    return x % y;\n}\nstatic inline uint16_t umod16(uint16_t x, uint16_t y)\n{\n    return x % y;\n}\nstatic inline uint32_t umod32(uint32_t x, uint32_t y)\n{\n    return x % y;\n}\nstatic inline uint64_t umod64(uint64_t x, uint64_t y)\n{\n    return x % y;\n}\nstatic inline uint8_t udiv_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint16_t udiv_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint32_t udiv_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint64_t udiv_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint8_t umod_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint16_t umod_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint32_t umod_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint64_t umod_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int8_t sdiv8(int8_t x, int8_t y)\n{\n    int8_t q = x / y;\n    int8_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int16_t sdiv16(int16",
                   "_t x, int16_t y)\n{\n    int16_t q = x / y;\n    int16_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int32_t sdiv32(int32_t x, int32_t y)\n{\n    int32_t q = x / y;\n    int32_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int64_t sdiv64(int64_t x, int64_t y)\n{\n    int64_t q = x / y;\n    int64_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int8_t sdiv_up8(int8_t x, int8_t y)\n{\n    return sdiv8(x + y - 1, y);\n}\nstatic inline int16_t sdiv_up16(int16_t x, int16_t y)\n{\n    return sdiv16(x + y - 1, y);\n}\nstatic inline int32_t sdiv_up32(int32_t x, int32_t y)\n{\n    return sdiv32(x + y - 1, y);\n}\nstatic inline int64_t sdiv_up64(int64_t x, int64_t y)\n{\n    return sdiv64(x + y - 1, y);\n}\nstatic inline int8_t smod8(int8_t x, int8_t y)\n{\n    int8_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int16_t smod16(int16_t x, int16_t y)\n{\n    int16_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int32_t smod32(int32_t x, int32_t y)\n{\n    int32_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int64_t smod64(int64_t x, int64_t y)\n{\n    int64_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int8_t sdiv_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : sdiv8(x, y);\n}\nstatic inline int16_t sdiv_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : sdiv16(x, y);\n}\nstatic inline int32_t sdiv_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : sdiv32(x, y);\n}\nstatic inline int64_t sdiv_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : sdiv64(x, y);\n}\nstatic inline int8_t sdiv_up_safe8(int8_t x, int8_t y)\n{\n    return sdiv_safe8(x + y - 1, y);\n}\nstatic inline int16_t sdiv_up_safe16(int16_t x, int16_t y)\n{\n    return sdiv_safe16(x + y - 1, y",
                   ");\n}\nstatic inline int32_t sdiv_up_safe32(int32_t x, int32_t y)\n{\n    return sdiv_safe32(x + y - 1, y);\n}\nstatic inline int64_t sdiv_up_safe64(int64_t x, int64_t y)\n{\n    return sdiv_safe64(x + y - 1, y);\n}\nstatic inline int8_t smod_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : smod8(x, y);\n}\nstatic inline int16_t smod_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : smod16(x, y);\n}\nstatic inline int32_t smod_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : smod32(x, y);\n}\nstatic inline int64_t smod_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : smod64(x, y);\n}\nstatic inline int8_t squot8(int8_t x, int8_t y)\n{\n    return x / y;\n}\nstatic inline int16_t squot16(int16_t x, int16_t y)\n{\n    return x / y;\n}\nstatic inline int32_t squot32(int32_t x, int32_t y)\n{\n    return x / y;\n}\nstatic inline int64_t squot64(int64_t x, int64_t y)\n{\n    return x / y;\n}\nstatic inline int8_t srem8(int8_t x, int8_t y)\n{\n    return x % y;\n}\nstatic inline int16_t srem16(int16_t x, int16_t y)\n{\n    return x % y;\n}\nstatic inline int32_t srem32(int32_t x, int32_t y)\n{\n    return x % y;\n}\nstatic inline int64_t srem64(int64_t x, int64_t y)\n{\n    return x % y;\n}\nstatic inline int8_t squot_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int16_t squot_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int32_t squot_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int64_t squot_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int8_t srem_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int16_t srem_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int32_t srem_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int64_t srem_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int8_t smin8(int8_t x, int8_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int16_t smi",
                   "n16(int16_t x, int16_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int32_t smin32(int32_t x, int32_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int64_t smin64(int64_t x, int64_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint8_t umin8(uint8_t x, uint8_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint16_t umin16(uint16_t x, uint16_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint32_t umin32(uint32_t x, uint32_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint64_t umin64(uint64_t x, uint64_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int8_t smax8(int8_t x, int8_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int16_t smax16(int16_t x, int16_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int32_t smax32(int32_t x, int32_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int64_t smax64(int64_t x, int64_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint8_t umax8(uint8_t x, uint8_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint16_t umax16(uint16_t x, uint16_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint32_t umax32(uint32_t x, uint32_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint64_t umax64(uint64_t x, uint64_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint8_t shl8(uint8_t x, uint8_t y)\n{\n    return x << y;\n}\nstatic inline uint16_t shl16(uint16_t x, uint16_t y)\n{\n    return x << y;\n}\nstatic inline uint32_t shl32(uint32_t x, uint32_t y)\n{\n    return x << y;\n}\nstatic inline uint64_t shl64(uint64_t x, uint64_t y)\n{\n    return x << y;\n}\nstatic inline uint8_t lshr8(uint8_t x, uint8_t y)\n{\n    return x >> y;\n}\nstatic inline uint16_t lshr16(uint16_t x, uint16_t y)\n{\n    return x >> y;\n}\nstatic inline uint32_t lshr32(uint32_t x, uint32_t y)\n{\n    return x >> y;\n}\nstatic inline uint64_t lshr64(uint64_t x, uint64_t y)\n{\n    return x >> y;\n}\nstatic inline int8_t ashr8(int8_t x, int8_t y)\n{\n    return x >> y;\n}\nstatic inline int16_t ashr16(int16_t x, int16_t y)\n{\n    return x >> y;\n}\nstatic inline int32_t ashr32(int32_t x, int32_t y)",
                   "\n{\n    return x >> y;\n}\nstatic inline int64_t ashr64(int64_t x, int64_t y)\n{\n    return x >> y;\n}\nstatic inline uint8_t and8(uint8_t x, uint8_t y)\n{\n    return x & y;\n}\nstatic inline uint16_t and16(uint16_t x, uint16_t y)\n{\n    return x & y;\n}\nstatic inline uint32_t and32(uint32_t x, uint32_t y)\n{\n    return x & y;\n}\nstatic inline uint64_t and64(uint64_t x, uint64_t y)\n{\n    return x & y;\n}\nstatic inline uint8_t or8(uint8_t x, uint8_t y)\n{\n    return x | y;\n}\nstatic inline uint16_t or16(uint16_t x, uint16_t y)\n{\n    return x | y;\n}\nstatic inline uint32_t or32(uint32_t x, uint32_t y)\n{\n    return x | y;\n}\nstatic inline uint64_t or64(uint64_t x, uint64_t y)\n{\n    return x | y;\n}\nstatic inline uint8_t xor8(uint8_t x, uint8_t y)\n{\n    return x ^ y;\n}\nstatic inline uint16_t xor16(uint16_t x, uint16_t y)\n{\n    return x ^ y;\n}\nstatic inline uint32_t xor32(uint32_t x, uint32_t y)\n{\n    return x ^ y;\n}\nstatic inline uint64_t xor64(uint64_t x, uint64_t y)\n{\n    return x ^ y;\n}\nstatic inline bool ult8(uint8_t x, uint8_t y)\n{\n    return x < y;\n}\nstatic inline bool ult16(uint16_t x, uint16_t y)\n{\n    return x < y;\n}\nstatic inline bool ult32(uint32_t x, uint32_t y)\n{\n    return x < y;\n}\nstatic inline bool ult64(uint64_t x, uint64_t y)\n{\n    return x < y;\n}\nstatic inline bool ule8(uint8_t x, uint8_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule16(uint16_t x, uint16_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule32(uint32_t x, uint32_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule64(uint64_t x, uint64_t y)\n{\n    return x <= y;\n}\nstatic inline bool slt8(int8_t x, int8_t y)\n{\n    return x < y;\n}\nstatic inline bool slt16(int16_t x, int16_t y)\n{\n    return x < y;\n}\nstatic inline bool slt32(int32_t x, int32_t y)\n{\n    return x < y;\n}\nstatic inline bool slt64(int64_t x, int64_t y)\n{\n    return x < y;\n}\nstatic inline bool sle8(int8_t x, int8_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle16(int16_t x, int16_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle32(int32_t x, int32_",
                   "t y)\n{\n    return x <= y;\n}\nstatic inline bool sle64(int64_t x, int64_t y)\n{\n    return x <= y;\n}\nstatic inline int8_t pow8(int8_t x, int8_t y)\n{\n    int8_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int16_t pow16(int16_t x, int16_t y)\n{\n    int16_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int32_t pow32(int32_t x, int32_t y)\n{\n    int32_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int64_t pow64(int64_t x, int64_t y)\n{\n    int64_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline bool itob_i8_bool(int8_t x)\n{\n    return x;\n}\nstatic inline bool itob_i16_bool(int16_t x)\n{\n    return x;\n}\nstatic inline bool itob_i32_bool(int32_t x)\n{\n    return x;\n}\nstatic inline bool itob_i64_bool(int64_t x)\n{\n    return x;\n}\nstatic inline int8_t btoi_bool_i8(bool x)\n{\n    return x;\n}\nstatic inline int16_t btoi_bool_i16(bool x)\n{\n    return x;\n}\nstatic inline int32_t btoi_bool_i32(bool x)\n{\n    return x;\n}\nstatic inline int64_t btoi_bool_i64(bool x)\n{\n    return x;\n}\n#define sext_i8_i8(x) ((int8_t) (int8_t) x)\n#define sext_i8_i16(x) ((int16_t) (int8_t) x)\n#define sext_i8_i32(x) ((int32_t) (int8_t) x)\n#define sext_i8_i64(x) ((int64_t) (int8_t) x)\n#define sext_i16_i8(x) ((int8_t) (int16_t) x)\n#define sext_i16_i16(x) ((int16_t) (int16_t) x)\n#define sext_i16_i32(x) ((int32_t) (int16_t) x)\n#define sext_i16_i64(x) ((int64_t) (int16_t) x)\n#define sext_i32_i8(x) ((int8_t) (int32_t) x)\n#define sext_i32_i16(x) ((int16_t) (int32_t) x)\n#define sext_i32_i32(x) ((int32_t) (int32_t) x)\n#define sext_i32_i64(x) ((int64_t) (int32_t) x)\n#defi",
                   "ne sext_i64_i8(x) ((int8_t) (int64_t) x)\n#define sext_i64_i16(x) ((int16_t) (int64_t) x)\n#define sext_i64_i32(x) ((int32_t) (int64_t) x)\n#define sext_i64_i64(x) ((int64_t) (int64_t) x)\n#define zext_i8_i8(x) ((int8_t) (uint8_t) x)\n#define zext_i8_i16(x) ((int16_t) (uint8_t) x)\n#define zext_i8_i32(x) ((int32_t) (uint8_t) x)\n#define zext_i8_i64(x) ((int64_t) (uint8_t) x)\n#define zext_i16_i8(x) ((int8_t) (uint16_t) x)\n#define zext_i16_i16(x) ((int16_t) (uint16_t) x)\n#define zext_i16_i32(x) ((int32_t) (uint16_t) x)\n#define zext_i16_i64(x) ((int64_t) (uint16_t) x)\n#define zext_i32_i8(x) ((int8_t) (uint32_t) x)\n#define zext_i32_i16(x) ((int16_t) (uint32_t) x)\n#define zext_i32_i32(x) ((int32_t) (uint32_t) x)\n#define zext_i32_i64(x) ((int64_t) (uint32_t) x)\n#define zext_i64_i8(x) ((int8_t) (uint64_t) x)\n#define zext_i64_i16(x) ((int16_t) (uint64_t) x)\n#define zext_i64_i32(x) ((int32_t) (uint64_t) x)\n#define zext_i64_i64(x) ((int64_t) (uint64_t) x)\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_popc8(int8_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    return popcount(x);\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_popc8(int8_t x)\n{\n    return __popc(zext_i8_i32(x));\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    return __popc(zext_i16_i32(x));\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    return __popc(x);\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    return __popcll(x);\n}\n#else\nstatic int32_t futrts_popc8(int8_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    int c = 0;\n    \n    for ",
                   "(; x; ++c)\n        x &= x - 1;\n    return c;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    return mul_hi(a, b);\n}\n#elif defined(__CUDA_ARCH__)\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    uint16_t aa = a;\n    uint16_t bb = b;\n    \n    return aa * bb >> 8;\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    uint32_t aa = a;\n    uint32_t bb = b;\n    \n    return aa * bb >> 16;\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    return mulhi(a, b);\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    return mul64hi(a, b);\n}\n#else\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    uint16_t aa = a;\n    uint16_t bb = b;\n    \n    return aa * bb >> 8;\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    uint32_t aa = a;\n    uint32_t bb = b;\n    \n    return aa * bb >> 16;\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    uint64_t aa = a;\n    uint64_t bb = b;\n    \n    return aa * bb >> 32;\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    __uint128_t aa = a;\n    __uint128_t bb = b;\n    \n    return aa * bb >> 64;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)\n{\n    return mad_hi(a, b, c);\n}\n#else\nstatic uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)\n{\n    return futrts_mul_hi8(a, b) + c;\n}\nstatic uint16_t futrts_mad_hi16(uin",
                   "t16_t a, uint16_t b, uint16_t c)\n{\n    return futrts_mul_hi16(a, b) + c;\n}\nstatic uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)\n{\n    return futrts_mul_hi32(a, b) + c;\n}\nstatic uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)\n{\n    return futrts_mul_hi64(a, b) + c;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    return clz(x);\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    return __clz(zext_i8_i32(x)) - 24;\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    return __clz(zext_i16_i32(x)) - 16;\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    return __clz(x);\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    return __clzll(x);\n}\n#else\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    int i = 0;\n    \n    for (; i < 8 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz16(int16_t ",
                   "x)\n{\n    int i = 0;\n    \n    for (; i < 16 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    int i = 0;\n    \n    for (; i < 32 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    int i = 0;\n    \n    for (; i < 64 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 8 : y - 1;\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 16 : y - 1;\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 32 : y - 1;\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    int y = __ffsll(x);\n    \n    return y == 0 ? 64 : y - 1;\n}\n#else\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    return x == 0 ? 8 : __builtin_ctz((uint32_t) x);\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    return x == 0 ? 16 : __builtin_ctz((uint32_t) x);\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    return x == 0 ? 32 : __builtin_ctz(x);\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    return x == 0 ? 64 : __builtin_ctzl(x);\n}\n#endif\nstatic inline float fdiv32(float x, float y)\n{\n    return x / y;\n}\nstatic inline float fadd32(float x, float y)\n{\n    return x + y;\n}\nstatic inline float fsub32(float x, float y)\n{\n    return x - y;\n}\nstatic inline float fmul32(float x, float y)\n{\n    return x * y;\n}\nstatic inline float fmin32(float x, float y)\n{\n    return fmin(x, y);\n}\nstatic inline float fmax32(float x, float y)\n{\n    return fmax(x, y);\n}\nstatic inline float fpow32(float x, float y)\n{\n    return pow(x, y);\n}\nstatic inline bool cmplt32(float x, float y)\n{\n    return x < y;\n}\nstatic inline bool cmple32(float x, float y)\n{\n    return x <= y;\n}\nstatic inline float sitofp_i8_f32(int8_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i16_f32(int16_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i32_f32(int32_t x)",
                   "\n{\n    return (float) x;\n}\nstatic inline float sitofp_i64_f32(int64_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i8_f32(uint8_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i16_f32(uint16_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i32_f32(uint32_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i64_f32(uint64_t x)\n{\n    return (float) x;\n}\nstatic inline int8_t fptosi_f32_i8(float x)\n{\n    return (int8_t) x;\n}\nstatic inline int16_t fptosi_f32_i16(float x)\n{\n    return (int16_t) x;\n}\nstatic inline int32_t fptosi_f32_i32(float x)\n{\n    return (int32_t) x;\n}\nstatic inline int64_t fptosi_f32_i64(float x)\n{\n    return (int64_t) x;\n}\nstatic inline uint8_t fptoui_f32_i8(float x)\n{\n    return (uint8_t) x;\n}\nstatic inline uint16_t fptoui_f32_i16(float x)\n{\n    return (uint16_t) x;\n}\nstatic inline uint32_t fptoui_f32_i32(float x)\n{\n    return (uint32_t) x;\n}\nstatic inline uint64_t fptoui_f32_i64(float x)\n{\n    return (uint64_t) x;\n}\nstatic inline float futrts_log32(float x)\n{\n    return log(x);\n}\nstatic inline float futrts_log2_32(float x)\n{\n    return log2(x);\n}\nstatic inline float futrts_log10_32(float x)\n{\n    return log10(x);\n}\nstatic inline float futrts_sqrt32(float x)\n{\n    return sqrt(x);\n}\nstatic inline float futrts_exp32(float x)\n{\n    return exp(x);\n}\nstatic inline float futrts_cos32(float x)\n{\n    return cos(x);\n}\nstatic inline float futrts_sin32(float x)\n{\n    return sin(x);\n}\nstatic inline float futrts_tan32(float x)\n{\n    return tan(x);\n}\nstatic inline float futrts_acos32(float x)\n{\n    return acos(x);\n}\nstatic inline float futrts_asin32(float x)\n{\n    return asin(x);\n}\nstatic inline float futrts_atan32(float x)\n{\n    return atan(x);\n}\nstatic inline float futrts_cosh32(float x)\n{\n    return cosh(x);\n}\nstatic inline float futrts_sinh32(float x)\n{\n    return sinh(x);\n}\nstatic inline float futrts_tanh32(float x)\n{\n    return tanh(x);\n}\nstatic inline float futrts_acosh32(float x)\n{\n    return acosh(x);\n}\nstatic inline fl",
                   "oat futrts_asinh32(float x)\n{\n    return asinh(x);\n}\nstatic inline float futrts_atanh32(float x)\n{\n    return atanh(x);\n}\nstatic inline float futrts_atan2_32(float x, float y)\n{\n    return atan2(x, y);\n}\nstatic inline float futrts_gamma32(float x)\n{\n    return tgamma(x);\n}\nstatic inline float futrts_lgamma32(float x)\n{\n    return lgamma(x);\n}\nstatic inline bool futrts_isnan32(float x)\n{\n    return isnan(x);\n}\nstatic inline bool futrts_isinf32(float x)\n{\n    return isinf(x);\n}\nstatic inline int32_t futrts_to_bits32(float x)\n{\n    union {\n        float f;\n        int32_t t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\nstatic inline float futrts_from_bits32(int32_t x)\n{\n    union {\n        int32_t f;\n        float t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\n#ifdef __OPENCL_VERSION__\nstatic inline float fmod32(float x, float y)\n{\n    return fmod(x, y);\n}\nstatic inline float futrts_round32(float x)\n{\n    return rint(x);\n}\nstatic inline float futrts_floor32(float x)\n{\n    return floor(x);\n}\nstatic inline float futrts_ceil32(float x)\n{\n    return ceil(x);\n}\nstatic inline float futrts_lerp32(float v0, float v1, float t)\n{\n    return mix(v0, v1, t);\n}\nstatic inline float futrts_mad32(float a, float b, float c)\n{\n    return mad(a, b, c);\n}\nstatic inline float futrts_fma32(float a, float b, float c)\n{\n    return fma(a, b, c);\n}\n#else\nstatic inline float fmod32(float x, float y)\n{\n    return fmodf(x, y);\n}\nstatic inline float futrts_round32(float x)\n{\n    return rintf(x);\n}\nstatic inline float futrts_floor32(float x)\n{\n    return floorf(x);\n}\nstatic inline float futrts_ceil32(float x)\n{\n    return ceilf(x);\n}\nstatic inline float futrts_lerp32(float v0, float v1, float t)\n{\n    return v0 + (v1 - v0) * t;\n}\nstatic inline float futrts_mad32(float a, float b, float c)\n{\n    return a * b + c;\n}\nstatic inline float futrts_fma32(float a, float b, float c)\n{\n    return fmaf(a, b, c);\n}\n#endif\n// Start of atomics.h\n\ninline int32_t atomic_add_i32_global(volatile __global int32_t *p, ",
                   "int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\ninline int32_t atomic_add_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\ninline float atomic_fadd_f32_global(volatile __global float *p, float x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg((volatile __global int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\ninline float atomic_fadd_f32_local(volatile __local float *p, float x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg((volatile __local int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\ninline int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline int32_t atomic_smax_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline int32_t atomic_smin_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p",
                   ", x);\n#endif\n}\n\ninline uint32_t atomic_umax_i32_local(volatile __local uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline uint32_t atomic_umin_i32_local(volatile __local uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\ninline int32_t atomic_and_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\ninline int32_t atomic_or_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\ninline int32_t atomic_or_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\ninline int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xor_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xchg_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t",
                   " atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                         int32_t cmp, int32_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\ninline int32_t atomic_cmpxchg_i32_local(volatile __local int32_t *p,\n                                         int32_t cmp, int32_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\n// End of atomics.h\n\n\n\n\n__kernel void builtinzhreplicate_f32zireplicate_28708(__global\n                                                      unsigned char *mem_28704,\n                                                      int32_t num_elems_28705,\n                                                      float val_28706)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t replicate_gtid_28708;\n    int32_t replicate_ltid_28709;\n    int32_t replicate_gid_28710;\n    \n    replicate_gtid_28708 = get_global_id(0);\n    replicate_ltid_28709 = get_local_id(0);\n    replicate_gid_28710 = get_group_id(0);\n    if (slt64(replicate_gtid_28708, num_elems_28705)) {\n        ((__global float *) mem_28704)[sext_i32_i64(replicate_gtid_28708)] =\n            val_28706;\n    }\n    \n  error_0:\n    return;\n}\n__kernel void builtinzhreplicate_i64zireplicate_28299(__global\n                                                      unsigned char *mem_28295,\n                                                      int32_t num_elems_28296,\n                                                      int64_t val_28297)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t replicate_gtid_28299;\n    int32_t replicate_ltid_28300;\n    int32_t replicate_gid_28301;\n    \n    replicate_gtid_28299 = get_global_id(0);\n    replicate_ltid_28300 = get_local_id(0);\n    replicate_gid_28301 = get_group_id(0);\n    if (slt64(replicate_gtid_28299, nu",
                   "m_elems_28296)) {\n        ((__global int64_t *) mem_28295)[sext_i32_i64(replicate_gtid_28299)] =\n            val_28297;\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32(__local volatile\n                                    int64_t *block_9_backing_aligned_0,\n                                    int32_t destoffset_1, int32_t srcoffset_3,\n                                    int32_t num_arrays_4, int32_t x_elems_5,\n                                    int32_t y_elems_6, int32_t mulx_7,\n                                    int32_t muly_8, __global\n                                    unsigned char *destmem_0, __global\n                                    unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = get_group_id_2_42 * x_elems_5 * y_elems_6;\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t x_index_31 = get_global_id_0_37;\n    int32_t y_index_32 = get_group_id_1_41 * 32 + get_local_id_1_39;\n    \n    if (slt32(x_index_31, x_elems_5)) {\n        for (int32_t j_43 = 0; j_43 < 4; j_43++) {\n            int32",
                   "_t index_in_35 = (y_index_32 + j_43 * 8) * x_elems_5 +\n                    x_index_31;\n            \n            if (slt32(y_index_32 + j_43 * 8, y_elems_6)) {\n                ((__local float *) block_9)[sext_i32_i64((get_local_id_1_39 +\n                                                          j_43 * 8) * 33 +\n                                            get_local_id_0_38)] = ((__global\n                                                                    float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                                       index_in_35)];\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    x_index_31 = get_group_id_1_41 * 32 + get_local_id_0_38;\n    y_index_32 = get_group_id_0_40 * 32 + get_local_id_1_39;\n    if (slt32(x_index_31, y_elems_6)) {\n        for (int32_t j_43 = 0; j_43 < 4; j_43++) {\n            int32_t index_out_36 = (y_index_32 + j_43 * 8) * y_elems_6 +\n                    x_index_31;\n            \n            if (slt32(y_index_32 + j_43 * 8, x_elems_5)) {\n                ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                               index_out_36)] = ((__local\n                                                                  float *) block_9)[sext_i32_i64(get_local_id_0_38 *\n                                                                                    33 +\n                                                                                    get_local_id_1_39 +\n                                                                                    j_43 *\n                                                                                    8)];\n            }\n        }\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32_low_height(__local volatile\n                                               int64_t *block_9_backing_aligned_0,\n                                               int32_t destoffset_1,\n                   ",
                   "                            int32_t srcoffset_3,\n                                               int32_t num_arrays_4,\n                                               int32_t x_elems_5,\n                                               int32_t y_elems_6,\n                                               int32_t mulx_7, int32_t muly_8,\n                                               __global\n                                               unsigned char *destmem_0,\n                                               __global unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = get_group_id_2_42 * x_elems_5 * y_elems_6;\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t x_index_31 = get_group_id_0_40 * 16 * mulx_7 + get_local_id_0_38 +\n            srem32(get_local_id_1_39, mulx_7) * 16;\n    int32_t y_index_32 = get_group_id_1_41 * 16 + squot32(get_local_id_1_39,\n                                                          mulx_7);\n    int32_t index_in_35 = y_index_32 * x_elems_5 + x_index_31;\n    \n    if (slt32(x_index_31, x_elems_5) && slt32(",
                   "y_index_32, y_elems_6)) {\n        ((__local float *) block_9)[sext_i32_i64(get_local_id_1_39 * 17 +\n                                    get_local_id_0_38)] = ((__global\n                                                            float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                               index_in_35)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    x_index_31 = get_group_id_1_41 * 16 + squot32(get_local_id_0_38, mulx_7);\n    y_index_32 = get_group_id_0_40 * 16 * mulx_7 + get_local_id_1_39 +\n        srem32(get_local_id_0_38, mulx_7) * 16;\n    \n    int32_t index_out_36 = y_index_32 * y_elems_6 + x_index_31;\n    \n    if (slt32(x_index_31, y_elems_6) && slt32(y_index_32, x_elems_5)) {\n        ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                       index_out_36)] = ((__local\n                                                          float *) block_9)[sext_i32_i64(get_local_id_0_38 *\n                                                                            17 +\n                                                                            get_local_id_1_39)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32_low_width(__local volatile\n                                              int64_t *block_9_backing_aligned_0,\n                                              int32_t destoffset_1,\n                                              int32_t srcoffset_3,\n                                              int32_t num_arrays_4,\n                                              int32_t x_elems_5,\n                                              int32_t y_elems_6, int32_t mulx_7,\n                                              int32_t muly_8, __global\n                                              unsigned char *destmem_0, __global\n                                              unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    co",
                   "nst int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = get_group_id_2_42 * x_elems_5 * y_elems_6;\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t x_index_31 = get_group_id_0_40 * 16 + squot32(get_local_id_0_38,\n                                                          muly_8);\n    int32_t y_index_32 = get_group_id_1_41 * 16 * muly_8 + get_local_id_1_39 +\n            srem32(get_local_id_0_38, muly_8) * 16;\n    int32_t index_in_35 = y_index_32 * x_elems_5 + x_index_31;\n    \n    if (slt32(x_index_31, x_elems_5) && slt32(y_index_32, y_elems_6)) {\n        ((__local float *) block_9)[sext_i32_i64(get_local_id_1_39 * 17 +\n                                    get_local_id_0_38)] = ((__global\n                                                            float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                               index_in_35)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    x_index_31 = get_group_id_1_41 * 16 * muly_8 + get_local_id_0_38 +\n        srem32(get_local_id_1_39, muly_8) * 16;\n    y_index_32 = get_group_id_0_40 * 16 + squot32(get_local_id_1_39, muly_8",
                   ");\n    \n    int32_t index_out_36 = y_index_32 * y_elems_6 + x_index_31;\n    \n    if (slt32(x_index_31, y_elems_6) && slt32(y_index_32, x_elems_5)) {\n        ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                       index_out_36)] = ((__local\n                                                          float *) block_9)[sext_i32_i64(get_local_id_0_38 *\n                                                                            17 +\n                                                                            get_local_id_1_39)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32_small(__local volatile\n                                          int64_t *block_9_backing_aligned_0,\n                                          int32_t destoffset_1,\n                                          int32_t srcoffset_3,\n                                          int32_t num_arrays_4,\n                                          int32_t x_elems_5, int32_t y_elems_6,\n                                          int32_t mulx_7, int32_t muly_8,\n                                          __global unsigned char *destmem_0,\n                                          __global unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    ",
                   "\n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = squot32(get_global_id_0_37, y_elems_6 *\n                                          x_elems_5) * (y_elems_6 * x_elems_5);\n    int32_t x_index_31 = squot32(srem32(get_global_id_0_37, y_elems_6 *\n                                        x_elems_5), y_elems_6);\n    int32_t y_index_32 = srem32(get_global_id_0_37, y_elems_6);\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t index_in_35 = y_index_32 * x_elems_5 + x_index_31;\n    int32_t index_out_36 = x_index_31 * y_elems_6 + y_index_32;\n    \n    if (slt32(get_global_id_0_37, x_elems_5 * y_elems_6 * num_arrays_4)) {\n        ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                       index_out_36)] = ((__global\n                                                          float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                             index_in_35)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void mainzicopy_28720(int64_t n_23312, int64_t paths_23315,\n                               int64_t steps_23316, __global\n                               unsigned char *mem_27830, __global\n                               unsigned char *mem_27835)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_28720;\n    int32_t copy_ltid_28721;\n    int32_t copy_gid_28722;\n    \n    copy_gtid_28720 = get_global_id(0);\n    copy_ltid_28721 = get_local_id(0);\n    copy_gid_28722 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_28720), steps_23316 * paths_23315 *\n              n_23312)) {\n        ((__global float *) mem_27835)[squot64(sext_i32_i64(copy_gtid_28720),\n                                               paths_23315 * n_23312) *\n                          ",
                   "             (n_23312 * paths_23315) +\n                                       squot64(sext_i32_i64(copy_gtid_28720) -\n                                               squot64(sext_i32_i64(copy_gtid_28720),\n                                                       paths_23315 * n_23312) *\n                                               (paths_23315 * n_23312),\n                                               n_23312) * n_23312 +\n                                       (sext_i32_i64(copy_gtid_28720) -\n                                        squot64(sext_i32_i64(copy_gtid_28720),\n                                                paths_23315 * n_23312) *\n                                        (paths_23315 * n_23312) -\n                                        squot64(sext_i32_i64(copy_gtid_28720) -\n                                                squot64(sext_i32_i64(copy_gtid_28720),\n                                                        paths_23315 * n_23312) *\n                                                (paths_23315 * n_23312),\n                                                n_23312) * n_23312)] =\n            ((__global\n              float *) mem_27830)[squot64(sext_i32_i64(copy_gtid_28720) -\n                                          squot64(sext_i32_i64(copy_gtid_28720),\n                                                  paths_23315 * n_23312) *\n                                          (paths_23315 * n_23312), n_23312) *\n                                  (n_23312 * steps_23316) +\n                                  squot64(sext_i32_i64(copy_gtid_28720),\n                                          paths_23315 * n_23312) * n_23312 +\n                                  (sext_i32_i64(copy_gtid_28720) -\n                                   squot64(sext_i32_i64(copy_gtid_28720),\n                                           paths_23315 * n_23312) *\n                                   (paths_23315 * n_23312) -\n                                   squot64(sext_i32_i64(copy_gtid_28720) -\n        ",
                   "                                   squot64(sext_i32_i64(copy_gtid_28720),\n                                                   paths_23315 * n_23312) *\n                                           (paths_23315 * n_23312), n_23312) *\n                                   n_23312)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void mainzicopy_28757(int64_t n_23312, int64_t paths_23315,\n                               int64_t steps_23316, __global\n                               unsigned char *mem_27830, __global\n                               unsigned char *mem_27848)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_28757;\n    int32_t copy_ltid_28758;\n    int32_t copy_gid_28759;\n    \n    copy_gtid_28757 = get_global_id(0);\n    copy_ltid_28758 = get_local_id(0);\n    copy_gid_28759 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_28757), steps_23316 * paths_23315 *\n              n_23312)) {\n        ((__global float *) mem_27848)[squot64(sext_i32_i64(copy_gtid_28757),\n                                               paths_23315 * n_23312) *\n                                       (n_23312 * paths_23315) +\n                                       squot64(sext_i32_i64(copy_gtid_28757) -\n                                               squot64(sext_i32_i64(copy_gtid_28757),\n                                                       paths_23315 * n_23312) *\n                                               (paths_23315 * n_23312),\n                                               n_23312) * n_23312 +\n                                       (sext_i32_i64(copy_gtid_28757) -\n                                        squot64(sext_i32_i64(copy_gtid_28757),\n                                                paths_23315 * n_23312) *\n                                        (paths_23315 * n_23312) -\n                                        squot64(sext_i32_i64(copy_gtid_28757) -\n                                                squot64(sext_i32_i6",
                   "4(copy_gtid_28757),\n                                                        paths_23315 * n_23312) *\n                                                (paths_23315 * n_23312),\n                                                n_23312) * n_23312)] =\n            ((__global\n              float *) mem_27830)[squot64(sext_i32_i64(copy_gtid_28757) -\n                                          squot64(sext_i32_i64(copy_gtid_28757),\n                                                  paths_23315 * n_23312) *\n                                          (paths_23315 * n_23312), n_23312) *\n                                  (n_23312 * steps_23316) +\n                                  squot64(sext_i32_i64(copy_gtid_28757),\n                                          paths_23315 * n_23312) * n_23312 +\n                                  (sext_i32_i64(copy_gtid_28757) -\n                                   squot64(sext_i32_i64(copy_gtid_28757),\n                                           paths_23315 * n_23312) *\n                                   (paths_23315 * n_23312) -\n                                   squot64(sext_i32_i64(copy_gtid_28757) -\n                                           squot64(sext_i32_i64(copy_gtid_28757),\n                                                   paths_23315 * n_23312) *\n                                           (paths_23315 * n_23312), n_23312) *\n                                   n_23312)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void mainziscan_stage1_25387(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28221_backing_aligned_0,\n                                      int64_t n_23312, int64_t steps_23316,\n                                      int64_t one_intra_par_min_24696, __global\n                                      unsigned char *res_mem_27722, __global\n                                      unsigned char *res_mem_27723,\n                                      int",
                   "64_t binop_x_27752, __global\n                                      unsigned char *res_mem_27797, __global\n                                      unsigned char *mem_27800, __global\n                                      unsigned char *mem_27802,\n                                      int32_t num_threads_28215)\n{\n    #define segscan_group_sizze_25382 (mainzisegscan_group_sizze_25381)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28221_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28221_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28216;\n    int32_t local_tid_28217;\n    int64_t group_sizze_28220;\n    int32_t wave_sizze_28219;\n    int32_t group_tid_28218;\n    \n    global_tid_28216 = get_global_id(0);\n    local_tid_28217 = get_local_id(0);\n    group_sizze_28220 = get_local_size(0);\n    wave_sizze_28219 = LOCKSTEP_WIDTH;\n    group_tid_28218 = get_group_id(0);\n    \n    int32_t phys_tid_25387;\n    \n    phys_tid_25387 = global_tid_28216;\n    \n    __local char *scan_arr_mem_28221;\n    \n    scan_arr_mem_28221 = (__local char *) scan_arr_mem_28221_backing_0;\n    \n    int64_t x_23515;\n    int64_t x_23516;\n    \n    x_23515 = 0;\n    for (int64_t j_28223 = 0; j_28223 < sdiv_up64(binop_x_27752,\n                                                  sext_i32_i64(num_threads_28215));\n         j_28223++) {\n        int64_t chunk_offset_28224 = segscan_group_sizze_25382 * j_28223 +\n                sext_i32_i64(group_tid_28218) * (segscan_group_sizze_25382 *\n                                                 sdiv_up64(binop_x_27752,\n                                                           sext_i32_i64(num_threads_28215)));\n        int64_t flat_idx_28225 = chunk_offset_28224 +\n                sext_i32_i64(local_tid_28217);\n        int64_t gtid_25386 = flat_idx_28225;\n        \n        // threa",
                   "ds in bounds read input\n        {\n            if (slt64(gtid_25386, binop_x_27752)) {\n                int64_t binop_x_27516 = squot64(gtid_25386,\n                                                one_intra_par_min_24696);\n                int64_t binop_y_27518 = one_intra_par_min_24696 * binop_x_27516;\n                int64_t binop_x_27519 = gtid_25386 - binop_y_27518;\n                int64_t binop_x_27525 = squot64(binop_x_27519, n_23312);\n                int64_t binop_y_27526 = n_23312 * binop_x_27525;\n                int64_t new_index_27527 = binop_x_27519 - binop_y_27526;\n                int64_t x_23518 = ((__global\n                                    int64_t *) res_mem_27722)[new_index_27527];\n                float x_23519 = ((__global\n                                  float *) res_mem_27723)[new_index_27527];\n                float x_23520 = ((__global\n                                  float *) res_mem_27797)[binop_x_27516 *\n                                                          (n_23312 *\n                                                           steps_23316) +\n                                                          binop_x_27525 *\n                                                          n_23312 +\n                                                          new_index_27527];\n                float x_23521 = x_23520 / x_23519;\n                float ceil_arg_23522 = x_23521 - 1.0F;\n                float res_23523;\n                \n                res_23523 = futrts_ceil32(ceil_arg_23522);\n                \n                int64_t res_23524 = fptosi_f32_i64(res_23523);\n                int64_t max_arg_23525 = sub64(x_23518, res_23524);\n                int64_t res_23526 = smax64(0, max_arg_23525);\n                bool cond_23527 = res_23526 == 0;\n                int64_t res_23528;\n                \n                if (cond_23527) {\n                    res_23528 = 1;\n                } else {\n                    res_23528 = res_23526;\n                }\n                /",
                   "/ write to-scan values to parameters\n                {\n                    x_23516 = res_23528;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global int64_t *) mem_27802)[gtid_25386] = res_23528;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_25386, binop_x_27752)) {\n                    x_23516 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_23517 = add64(x_23515, x_23516);\n                \n                ((__local\n                  int64_t *) scan_arr_mem_28221)[sext_i32_i64(local_tid_28217)] =\n                    res_23517;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_28226;\n            int64_t x_28227;\n            int64_t x_28229;\n            int64_t x_28230;\n            bool ltid_in_bounds_28232;\n            \n            ltid_in_bounds_28232 = slt64(sext_i32_i64(local_tid_28217),\n                                         segscan_group_sizze_25382);\n            \n            int32_t skip_threads_28233;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28232) {\n                    x_28227 = ((volatile __local\n                                int64_t *) scan_arr_mem_28221)[sext_i32_i64(local_tid_28217)];\n                    if ((local_tid_28217 - squot32(local_tid_28217, 32) * 32) ==\n                        0) {\n                        x_28226 = x_28227;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28233 = 1;\n                while (slt32(skip_threads_28233, 32)) {\n                    if (sle32(skip_threads_28233, local",
                   "_tid_28217 -\n                              squot32(local_tid_28217, 32) * 32) &&\n                        ltid_in_bounds_28232) {\n                        // read operands\n                        {\n                            x_28226 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28221)[sext_i32_i64(local_tid_28217) -\n                                                                       sext_i32_i64(skip_threads_28233)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_28228 = add64(x_28226, x_28227);\n                            \n                            x_28226 = res_28228;\n                        }\n                    }\n                    if (sle32(wave_sizze_28219, skip_threads_28233)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28233, local_tid_28217 -\n                              squot32(local_tid_28217, 32) * 32) &&\n                        ltid_in_bounds_28232) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28221)[sext_i32_i64(local_tid_28217)] =\n                                x_28226;\n                            x_28227 = x_28226;\n                        }\n                    }\n                    if (sle32(wave_sizze_28219, skip_threads_28233)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28233 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28217 - squot32(local_tid_28217, 32) * 32) ==\n                    31 && ltid_in_bounds_28232) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_2822",
                   "1)[sext_i32_i64(squot32(local_tid_28217,\n                                                                          32))] =\n                        x_28226;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28234;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28217, 32) == 0 &&\n                        ltid_in_bounds_28232) {\n                        x_28230 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28221)[sext_i32_i64(local_tid_28217)];\n                        if ((local_tid_28217 - squot32(local_tid_28217, 32) *\n                             32) == 0) {\n                            x_28229 = x_28230;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28234 = 1;\n                    while (slt32(skip_threads_28234, 32)) {\n                        if (sle32(skip_threads_28234, local_tid_28217 -\n                                  squot32(local_tid_28217, 32) * 32) &&\n                            (squot32(local_tid_28217, 32) == 0 &&\n                             ltid_in_bounds_28232)) {\n                            // read operands\n                            {\n                                x_28229 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28221)[sext_i32_i64(local_tid_28217) -\n                                                                           sext_i32_i64(skip_threads_28234)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_28231 = add64(x_28229, x_28230);\n                                \n                    ",
                   "            x_28229 = res_28231;\n                            }\n                        }\n                        if (sle32(wave_sizze_28219, skip_threads_28234)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28234, local_tid_28217 -\n                                  squot32(local_tid_28217, 32) * 32) &&\n                            (squot32(local_tid_28217, 32) == 0 &&\n                             ltid_in_bounds_28232)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28221)[sext_i32_i64(local_tid_28217)] =\n                                    x_28229;\n                                x_28230 = x_28229;\n                            }\n                        }\n                        if (sle32(wave_sizze_28219, skip_threads_28234)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28234 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28217, 32) == 0 ||\n                      !ltid_in_bounds_28232)) {\n                    // read operands\n                    {\n                        x_28227 = x_28226;\n                        x_28226 = ((__local\n                                    int64_t *) scan_arr_mem_28221)[sext_i32_i64(squot32(local_tid_28217,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28228 = add64(x_28226, x_28227);\n                        \n                        x_28226 = r",
                   "es_28228;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_28221)[sext_i32_i64(local_tid_28217)] =\n                            x_28226;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28217, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_28221)[sext_i32_i64(local_tid_28217)] =\n                        x_28227;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_25386, binop_x_27752)) {\n                    ((__global int64_t *) mem_27800)[gtid_25386] = ((__local\n                                                                     int64_t *) scan_arr_mem_28221)[sext_i32_i64(local_tid_28217)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28235 = 0;\n                bool should_load_carry_28236 = local_tid_28217 == 0 &&\n                     !crosses_segment_28235;\n                \n                if (should_load_carry_28236) {\n                    x_23515 = ((__local\n                                int64_t *) scan_arr_mem_28221)[segscan_group_sizze_25382 -\n                                                               1];\n                }\n                if (!should_load_carry_28236) {\n                    x_23515 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_25382\n}\n__kernel void mainziscan_stage1_25420(__global int *global_failure,\n                                      __local",
                   " volatile\n                                      int64_t *scan_arr_mem_28462_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28460_backing_aligned_1,\n                                      int64_t res_23531, __global\n                                      unsigned char *mem_27807, __global\n                                      unsigned char *mem_27811, __global\n                                      unsigned char *mem_27813,\n                                      int32_t num_threads_28454)\n{\n    #define segscan_group_sizze_25415 (mainzisegscan_group_sizze_25414)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28462_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28462_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28460_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28460_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28455;\n    int32_t local_tid_28456;\n    int64_t group_sizze_28459;\n    int32_t wave_sizze_28458;\n    int32_t group_tid_28457;\n    \n    global_tid_28455 = get_global_id(0);\n    local_tid_28456 = get_local_id(0);\n    group_sizze_28459 = get_local_size(0);\n    wave_sizze_28458 = LOCKSTEP_WIDTH;\n    group_tid_28457 = get_group_id(0);\n    \n    int32_t phys_tid_25420;\n    \n    phys_tid_25420 = global_tid_28455;\n    \n    __local char *scan_arr_mem_28460;\n    __local char *scan_arr_mem_28462;\n    \n    scan_arr_mem_28460 = (__local char *) scan_arr_mem_28460_backing_0;\n    scan_arr_mem_28462 = (__local char *) scan_arr_mem_28462_backing_1;\n    \n    bool x_23550;\n    int64_t x_23551;\n    bool x_23552;\n    int64_t x_23553;\n    \n    x_23550 = 0;\n    x_23551 = 0;\n    for (int64_t j_28464 = 0; j_28464 < sdiv_up",
                   "64(res_23531,\n                                                  sext_i32_i64(num_threads_28454));\n         j_28464++) {\n        int64_t chunk_offset_28465 = segscan_group_sizze_25415 * j_28464 +\n                sext_i32_i64(group_tid_28457) * (segscan_group_sizze_25415 *\n                                                 sdiv_up64(res_23531,\n                                                           sext_i32_i64(num_threads_28454)));\n        int64_t flat_idx_28466 = chunk_offset_28465 +\n                sext_i32_i64(local_tid_28456);\n        int64_t gtid_25419 = flat_idx_28466;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_25419, res_23531)) {\n                int64_t x_23557 = ((__global int64_t *) mem_27807)[gtid_25419];\n                bool res_23558 = slt64(0, x_23557);\n                \n                // write to-scan values to parameters\n                {\n                    x_23552 = res_23558;\n                    x_23553 = x_23557;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_25419, res_23531)) {\n                    x_23552 = 0;\n                    x_23553 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_23554 = x_23550 || x_23552;\n                int64_t res_23555;\n                \n                if (x_23552) {\n                    res_23555 = x_23553;\n                } else {\n                    int64_t res_23556 = add64(x_23551, x_23553);\n                    \n                    res_23555 = res_23556;\n                }\n                ((__local\n                  bool *) scan_arr_mem_28460)[sext_i32_i64(local_tid_28456)] =\n                    res_23554;\n                ((__local",
                   "\n                  int64_t *) scan_arr_mem_28462)[sext_i32_i64(local_tid_28456)] =\n                    res_23555;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28467;\n            int64_t x_28468;\n            bool x_28469;\n            int64_t x_28470;\n            bool x_28474;\n            int64_t x_28475;\n            bool x_28476;\n            int64_t x_28477;\n            bool ltid_in_bounds_28481;\n            \n            ltid_in_bounds_28481 = slt64(sext_i32_i64(local_tid_28456),\n                                         segscan_group_sizze_25415);\n            \n            int32_t skip_threads_28482;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28481) {\n                    x_28469 = ((volatile __local\n                                bool *) scan_arr_mem_28460)[sext_i32_i64(local_tid_28456)];\n                    x_28470 = ((volatile __local\n                                int64_t *) scan_arr_mem_28462)[sext_i32_i64(local_tid_28456)];\n                    if ((local_tid_28456 - squot32(local_tid_28456, 32) * 32) ==\n                        0) {\n                        x_28467 = x_28469;\n                        x_28468 = x_28470;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28482 = 1;\n                while (slt32(skip_threads_28482, 32)) {\n                    if (sle32(skip_threads_28482, local_tid_28456 -\n                              squot32(local_tid_28456, 32) * 32) &&\n                        ltid_in_bounds_28481) {\n                        // read operands\n                        {\n                            x_28467 = ((volatile __local\n                                        bool *) scan_arr_mem_28460)[sext_i32_i64(local_tid_28456) -\n                                                                    sext_i32_i64(skip_threads_28482)];\n                    ",
                   "        x_28468 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28462)[sext_i32_i64(local_tid_28456) -\n                                                                       sext_i32_i64(skip_threads_28482)];\n                        }\n                        // perform operation\n                        {\n                            bool res_28471 = x_28467 || x_28469;\n                            int64_t res_28472;\n                            \n                            if (x_28469) {\n                                res_28472 = x_28470;\n                            } else {\n                                int64_t res_28473 = add64(x_28468, x_28470);\n                                \n                                res_28472 = res_28473;\n                            }\n                            x_28467 = res_28471;\n                            x_28468 = res_28472;\n                        }\n                    }\n                    if (sle32(wave_sizze_28458, skip_threads_28482)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28482, local_tid_28456 -\n                              squot32(local_tid_28456, 32) * 32) &&\n                        ltid_in_bounds_28481) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_28460)[sext_i32_i64(local_tid_28456)] =\n                                x_28467;\n                            x_28469 = x_28467;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28462)[sext_i32_i64(local_tid_28456)] =\n                                x_28468;\n                            x_28470 = x_28468;\n                        }\n                    }\n                    if (sle32(wave_sizze_28458, skip_threads_28482)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                 ",
                   "   }\n                    skip_threads_28482 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28456 - squot32(local_tid_28456, 32) * 32) ==\n                    31 && ltid_in_bounds_28481) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28460)[sext_i32_i64(squot32(local_tid_28456,\n                                                                       32))] =\n                        x_28467;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28462)[sext_i32_i64(squot32(local_tid_28456,\n                                                                          32))] =\n                        x_28468;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28483;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28456, 32) == 0 &&\n                        ltid_in_bounds_28481) {\n                        x_28476 = ((volatile __local\n                                    bool *) scan_arr_mem_28460)[sext_i32_i64(local_tid_28456)];\n                        x_28477 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28462)[sext_i32_i64(local_tid_28456)];\n                        if ((local_tid_28456 - squot32(local_tid_28456, 32) *\n                             32) == 0) {\n                            x_28474 = x_28476;\n                            x_28475 = x_28477;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28483 = 1;\n                    while (slt32(skip_threads_28483, 32",
                   ")) {\n                        if (sle32(skip_threads_28483, local_tid_28456 -\n                                  squot32(local_tid_28456, 32) * 32) &&\n                            (squot32(local_tid_28456, 32) == 0 &&\n                             ltid_in_bounds_28481)) {\n                            // read operands\n                            {\n                                x_28474 = ((volatile __local\n                                            bool *) scan_arr_mem_28460)[sext_i32_i64(local_tid_28456) -\n                                                                        sext_i32_i64(skip_threads_28483)];\n                                x_28475 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28462)[sext_i32_i64(local_tid_28456) -\n                                                                           sext_i32_i64(skip_threads_28483)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28478 = x_28474 || x_28476;\n                                int64_t res_28479;\n                                \n                                if (x_28476) {\n                                    res_28479 = x_28477;\n                                } else {\n                                    int64_t res_28480 = add64(x_28475, x_28477);\n                                    \n                                    res_28479 = res_28480;\n                                }\n                                x_28474 = res_28478;\n                                x_28475 = res_28479;\n                            }\n                        }\n                        if (sle32(wave_sizze_28458, skip_threads_28483)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28483, local_tid_28456 -\n                                  squot32(local_tid_28456, 32) * 32) &&\n                       ",
                   "     (squot32(local_tid_28456, 32) == 0 &&\n                             ltid_in_bounds_28481)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_28460)[sext_i32_i64(local_tid_28456)] =\n                                    x_28474;\n                                x_28476 = x_28474;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28462)[sext_i32_i64(local_tid_28456)] =\n                                    x_28475;\n                                x_28477 = x_28475;\n                            }\n                        }\n                        if (sle32(wave_sizze_28458, skip_threads_28483)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28483 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28456, 32) == 0 ||\n                      !ltid_in_bounds_28481)) {\n                    // read operands\n                    {\n                        x_28469 = x_28467;\n                        x_28470 = x_28468;\n                        x_28467 = ((__local\n                                    bool *) scan_arr_mem_28460)[sext_i32_i64(squot32(local_tid_28456,\n                                                                                     32)) -\n                                                                1];\n                        x_28468 = ((__local\n                                    int64_t *) scan_arr_mem_28462)[sext_i32_i64(squot32(local_tid_28456,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                ",
                   "    // perform operation\n                    {\n                        bool res_28471 = x_28467 || x_28469;\n                        int64_t res_28472;\n                        \n                        if (x_28469) {\n                            res_28472 = x_28470;\n                        } else {\n                            int64_t res_28473 = add64(x_28468, x_28470);\n                            \n                            res_28472 = res_28473;\n                        }\n                        x_28467 = res_28471;\n                        x_28468 = res_28472;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28460)[sext_i32_i64(local_tid_28456)] =\n                            x_28467;\n                        ((__local\n                          int64_t *) scan_arr_mem_28462)[sext_i32_i64(local_tid_28456)] =\n                            x_28468;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28456, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_28460)[sext_i32_i64(local_tid_28456)] =\n                        x_28469;\n                    ((__local\n                      int64_t *) scan_arr_mem_28462)[sext_i32_i64(local_tid_28456)] =\n                        x_28470;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_25419, res_23531)) {\n                    ((__global bool *) mem_27811)[gtid_25419] = ((__local\n                                                                  bool *) scan_arr_mem_28460)[sext_i32_i64(local_tid_28456)];\n                    ((__global int64_t *) mem_27813)[gtid_25419] = ((__local\n                                     ",
                   "                                int64_t *) scan_arr_mem_28462)[sext_i32_i64(local_tid_28456)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28484 = 0;\n                bool should_load_carry_28485 = local_tid_28456 == 0 &&\n                     !crosses_segment_28484;\n                \n                if (should_load_carry_28485) {\n                    x_23550 = ((__local\n                                bool *) scan_arr_mem_28460)[segscan_group_sizze_25415 -\n                                                            1];\n                    x_23551 = ((__local\n                                int64_t *) scan_arr_mem_28462)[segscan_group_sizze_25415 -\n                                                               1];\n                }\n                if (!should_load_carry_28485) {\n                    x_23550 = 0;\n                    x_23551 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_25415\n}\n__kernel void mainziscan_stage1_25428(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28529_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28527_backing_aligned_1,\n                                      int64_t res_23531, __global\n                                      unsigned char *mem_27813, __global\n                                      unsigned char *mem_27816, __global\n                                      unsigned char *mem_27818, __global\n                                      unsigned char *mem_27820,\n                                      int32_t num_threads_28521)\n{\n    #define segscan_group_sizze_25423 (mainzisegscan_group_sizze_254",
                   "22)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28529_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28529_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28527_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28527_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28522;\n    int32_t local_tid_28523;\n    int64_t group_sizze_28526;\n    int32_t wave_sizze_28525;\n    int32_t group_tid_28524;\n    \n    global_tid_28522 = get_global_id(0);\n    local_tid_28523 = get_local_id(0);\n    group_sizze_28526 = get_local_size(0);\n    wave_sizze_28525 = LOCKSTEP_WIDTH;\n    group_tid_28524 = get_group_id(0);\n    \n    int32_t phys_tid_25428;\n    \n    phys_tid_25428 = global_tid_28522;\n    \n    __local char *scan_arr_mem_28527;\n    __local char *scan_arr_mem_28529;\n    \n    scan_arr_mem_28527 = (__local char *) scan_arr_mem_28527_backing_0;\n    scan_arr_mem_28529 = (__local char *) scan_arr_mem_28529_backing_1;\n    \n    bool x_23590;\n    int64_t x_23591;\n    bool x_23592;\n    int64_t x_23593;\n    \n    x_23590 = 0;\n    x_23591 = 0;\n    for (int64_t j_28531 = 0; j_28531 < sdiv_up64(res_23531,\n                                                  sext_i32_i64(num_threads_28521));\n         j_28531++) {\n        int64_t chunk_offset_28532 = segscan_group_sizze_25423 * j_28531 +\n                sext_i32_i64(group_tid_28524) * (segscan_group_sizze_25423 *\n                                                 sdiv_up64(res_23531,\n                                                           sext_i32_i64(num_threads_28521)));\n        int64_t flat_idx_28533 = chunk_offset_28532 +\n                sext_i32_i64(local_tid_28523);\n        int64_t gtid_25427 = flat_idx_28533;\n        \n        // threads in bounds read input\n        {\n     ",
                   "       if (slt64(gtid_25427, res_23531)) {\n                int64_t x_23597 = ((__global int64_t *) mem_27813)[gtid_25427];\n                int64_t i_p_o_27576 = add64(-1, gtid_25427);\n                int64_t rot_i_27577 = smod64(i_p_o_27576, res_23531);\n                int64_t x_23598 = ((__global int64_t *) mem_27813)[rot_i_27577];\n                bool res_23600 = x_23597 == x_23598;\n                bool res_23601 = !res_23600;\n                \n                // write to-scan values to parameters\n                {\n                    x_23592 = res_23601;\n                    x_23593 = 1;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global bool *) mem_27820)[gtid_25427] = res_23601;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_25427, res_23531)) {\n                    x_23592 = 0;\n                    x_23593 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_23594 = x_23590 || x_23592;\n                int64_t res_23595;\n                \n                if (x_23592) {\n                    res_23595 = x_23593;\n                } else {\n                    int64_t res_23596 = add64(x_23591, x_23593);\n                    \n                    res_23595 = res_23596;\n                }\n                ((__local\n                  bool *) scan_arr_mem_28527)[sext_i32_i64(local_tid_28523)] =\n                    res_23594;\n                ((__local\n                  int64_t *) scan_arr_mem_28529)[sext_i32_i64(local_tid_28523)] =\n                    res_23595;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28534;\n            int64_t x_28535;\n            bool x_28536;\n            int64_t x_28537;\n          ",
                   "  bool x_28541;\n            int64_t x_28542;\n            bool x_28543;\n            int64_t x_28544;\n            bool ltid_in_bounds_28548;\n            \n            ltid_in_bounds_28548 = slt64(sext_i32_i64(local_tid_28523),\n                                         segscan_group_sizze_25423);\n            \n            int32_t skip_threads_28549;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28548) {\n                    x_28536 = ((volatile __local\n                                bool *) scan_arr_mem_28527)[sext_i32_i64(local_tid_28523)];\n                    x_28537 = ((volatile __local\n                                int64_t *) scan_arr_mem_28529)[sext_i32_i64(local_tid_28523)];\n                    if ((local_tid_28523 - squot32(local_tid_28523, 32) * 32) ==\n                        0) {\n                        x_28534 = x_28536;\n                        x_28535 = x_28537;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28549 = 1;\n                while (slt32(skip_threads_28549, 32)) {\n                    if (sle32(skip_threads_28549, local_tid_28523 -\n                              squot32(local_tid_28523, 32) * 32) &&\n                        ltid_in_bounds_28548) {\n                        // read operands\n                        {\n                            x_28534 = ((volatile __local\n                                        bool *) scan_arr_mem_28527)[sext_i32_i64(local_tid_28523) -\n                                                                    sext_i32_i64(skip_threads_28549)];\n                            x_28535 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28529)[sext_i32_i64(local_tid_28523) -\n                                                                       sext_i32_i64(skip_threads_28549)];\n                        }\n                        // perf",
                   "orm operation\n                        {\n                            bool res_28538 = x_28534 || x_28536;\n                            int64_t res_28539;\n                            \n                            if (x_28536) {\n                                res_28539 = x_28537;\n                            } else {\n                                int64_t res_28540 = add64(x_28535, x_28537);\n                                \n                                res_28539 = res_28540;\n                            }\n                            x_28534 = res_28538;\n                            x_28535 = res_28539;\n                        }\n                    }\n                    if (sle32(wave_sizze_28525, skip_threads_28549)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28549, local_tid_28523 -\n                              squot32(local_tid_28523, 32) * 32) &&\n                        ltid_in_bounds_28548) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_28527)[sext_i32_i64(local_tid_28523)] =\n                                x_28534;\n                            x_28536 = x_28534;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28529)[sext_i32_i64(local_tid_28523)] =\n                                x_28535;\n                            x_28537 = x_28535;\n                        }\n                    }\n                    if (sle32(wave_sizze_28525, skip_threads_28549)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28549 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28523 - squot32(local_tid_28523, 32) * 32) ==\n                ",
                   "    31 && ltid_in_bounds_28548) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28527)[sext_i32_i64(squot32(local_tid_28523,\n                                                                       32))] =\n                        x_28534;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28529)[sext_i32_i64(squot32(local_tid_28523,\n                                                                          32))] =\n                        x_28535;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28550;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28523, 32) == 0 &&\n                        ltid_in_bounds_28548) {\n                        x_28543 = ((volatile __local\n                                    bool *) scan_arr_mem_28527)[sext_i32_i64(local_tid_28523)];\n                        x_28544 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28529)[sext_i32_i64(local_tid_28523)];\n                        if ((local_tid_28523 - squot32(local_tid_28523, 32) *\n                             32) == 0) {\n                            x_28541 = x_28543;\n                            x_28542 = x_28544;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28550 = 1;\n                    while (slt32(skip_threads_28550, 32)) {\n                        if (sle32(skip_threads_28550, local_tid_28523 -\n                                  squot32(local_tid_28523, 32) * 32) &&\n                            (squot32(local_tid_28523, 32) == 0 &&\n                             ltid_in_bounds_28548)) {\n                            // rea",
                   "d operands\n                            {\n                                x_28541 = ((volatile __local\n                                            bool *) scan_arr_mem_28527)[sext_i32_i64(local_tid_28523) -\n                                                                        sext_i32_i64(skip_threads_28550)];\n                                x_28542 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28529)[sext_i32_i64(local_tid_28523) -\n                                                                           sext_i32_i64(skip_threads_28550)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28545 = x_28541 || x_28543;\n                                int64_t res_28546;\n                                \n                                if (x_28543) {\n                                    res_28546 = x_28544;\n                                } else {\n                                    int64_t res_28547 = add64(x_28542, x_28544);\n                                    \n                                    res_28546 = res_28547;\n                                }\n                                x_28541 = res_28545;\n                                x_28542 = res_28546;\n                            }\n                        }\n                        if (sle32(wave_sizze_28525, skip_threads_28550)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28550, local_tid_28523 -\n                                  squot32(local_tid_28523, 32) * 32) &&\n                            (squot32(local_tid_28523, 32) == 0 &&\n                             ltid_in_bounds_28548)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_28527)[sext_i32_i64(local_",
                   "tid_28523)] =\n                                    x_28541;\n                                x_28543 = x_28541;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28529)[sext_i32_i64(local_tid_28523)] =\n                                    x_28542;\n                                x_28544 = x_28542;\n                            }\n                        }\n                        if (sle32(wave_sizze_28525, skip_threads_28550)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28550 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28523, 32) == 0 ||\n                      !ltid_in_bounds_28548)) {\n                    // read operands\n                    {\n                        x_28536 = x_28534;\n                        x_28537 = x_28535;\n                        x_28534 = ((__local\n                                    bool *) scan_arr_mem_28527)[sext_i32_i64(squot32(local_tid_28523,\n                                                                                     32)) -\n                                                                1];\n                        x_28535 = ((__local\n                                    int64_t *) scan_arr_mem_28529)[sext_i32_i64(squot32(local_tid_28523,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        bool res_28538 = x_28534 || x_28536;\n                        int64_t res_28539;\n                        \n                        if (x_28536) {\n                            res_28539 = x_28537;\n                        } else {\n      ",
                   "                      int64_t res_28540 = add64(x_28535, x_28537);\n                            \n                            res_28539 = res_28540;\n                        }\n                        x_28534 = res_28538;\n                        x_28535 = res_28539;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28527)[sext_i32_i64(local_tid_28523)] =\n                            x_28534;\n                        ((__local\n                          int64_t *) scan_arr_mem_28529)[sext_i32_i64(local_tid_28523)] =\n                            x_28535;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28523, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_28527)[sext_i32_i64(local_tid_28523)] =\n                        x_28536;\n                    ((__local\n                      int64_t *) scan_arr_mem_28529)[sext_i32_i64(local_tid_28523)] =\n                        x_28537;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_25427, res_23531)) {\n                    ((__global bool *) mem_27816)[gtid_25427] = ((__local\n                                                                  bool *) scan_arr_mem_28527)[sext_i32_i64(local_tid_28523)];\n                    ((__global int64_t *) mem_27818)[gtid_25427] = ((__local\n                                                                     int64_t *) scan_arr_mem_28529)[sext_i32_i64(local_tid_28523)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28551",
                   " = 0;\n                bool should_load_carry_28552 = local_tid_28523 == 0 &&\n                     !crosses_segment_28551;\n                \n                if (should_load_carry_28552) {\n                    x_23590 = ((__local\n                                bool *) scan_arr_mem_28527)[segscan_group_sizze_25423 -\n                                                            1];\n                    x_23591 = ((__local\n                                int64_t *) scan_arr_mem_28529)[segscan_group_sizze_25423 -\n                                                               1];\n                }\n                if (!should_load_carry_28552) {\n                    x_23590 = 0;\n                    x_23591 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_25423\n}\n__kernel void mainziscan_stage1_25436(__global int *global_failure,\n                                      int failure_is_an_option, __global\n                                      int64_t *global_failure_args,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28596_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28594_backing_aligned_1,\n                                      int64_t n_23312, int64_t steps_23316,\n                                      float a_23320, float b_23321,\n                                      float sigma_23322, int64_t res_23531,\n                                      int64_t one_intra_par_min_24696, __global\n                                      unsigned char *res_mem_27720, __global\n                                      unsigned char *res_mem_27721, __global\n                                      unsigned char *res_mem_27722, __global\n                                      unsigned char *res_mem_27723,\n                                      int64_t b",
                   "inop_x_27752, __global\n                                      unsigned char *res_mem_27796, __global\n                                      unsigned char *res_mem_27797, __global\n                                      unsigned char *mem_27813, __global\n                                      unsigned char *mem_27818, __global\n                                      unsigned char *mem_27820, __global\n                                      unsigned char *mem_27823, __global\n                                      unsigned char *mem_27825,\n                                      int32_t num_threads_28588)\n{\n    #define segscan_group_sizze_25431 (mainzisegscan_group_sizze_25430)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28596_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28596_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28594_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28594_backing_aligned_1;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_28589;\n    int32_t local_tid_28590;\n    int64_t group_sizze_28593;\n    int32_t wave_sizze_28592;\n    int32_t group_tid_28591;\n    \n    global_tid_28589 = get_global_id(0);\n    local_tid_28590 = get_local_id(0);\n    group_sizze_28593 = get_local_size(0);\n    wave_sizze_28592 = LOCKSTEP_WIDTH;\n    group_tid_28591 = get_group_id(0);\n    \n    int32_t phys_tid_25436;\n    \n    phys_tid_25436 = global_tid_28589;\n    \n    __local char *scan_arr_mem_28594;\n    __local char *scan_arr_mem_28596;\n    \n    scan_arr_mem_28594 = (__local char *) scan_arr_mem_28594_backing_0;\n    scan_arr_mem_28596 = (__local",
                   " char *) scan_arr_mem_28596_backing_1;\n    \n    bool x_23616;\n    float x_23617;\n    bool x_23618;\n    float x_23619;\n    \n    x_23616 = 0;\n    x_23617 = 0.0F;\n    for (int64_t j_28598 = 0; j_28598 < sdiv_up64(res_23531,\n                                                  sext_i32_i64(num_threads_28588));\n         j_28598++) {\n        int64_t chunk_offset_28599 = segscan_group_sizze_25431 * j_28598 +\n                sext_i32_i64(group_tid_28591) * (segscan_group_sizze_25431 *\n                                                 sdiv_up64(res_23531,\n                                                           sext_i32_i64(num_threads_28588)));\n        int64_t flat_idx_28600 = chunk_offset_28599 +\n                sext_i32_i64(local_tid_28590);\n        int64_t gtid_25435 = flat_idx_28600;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_25435, res_23531)) {\n                int64_t x_23624 = ((__global int64_t *) mem_27818)[gtid_25435];\n                int64_t x_23625 = ((__global int64_t *) mem_27813)[gtid_25435];\n                bool x_23626 = ((__global bool *) mem_27820)[gtid_25435];\n                int64_t res_23629 = sub64(x_23624, 1);\n                bool x_23630 = sle64(0, x_23625);\n                bool y_23631 = slt64(x_23625, binop_x_27752);\n                bool bounds_check_23632 = x_23630 && y_23631;\n                bool index_certs_23633;\n                \n                if (!bounds_check_23632) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 10) ==\n                            -1) {\n                            global_failure_args[0] = x_23625;\n                            global_failure_args[1] = binop_x_27752;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t new_index_23634 = squot64(x_23625,\n                  ",
                   "                                one_intra_par_min_24696);\n                int64_t binop_y_23635 = new_index_23634 *\n                        one_intra_par_min_24696;\n                int64_t binop_x_23636 = x_23625 - binop_y_23635;\n                int64_t new_index_23637 = squot64(binop_x_23636, n_23312);\n                int64_t binop_y_23638 = n_23312 * new_index_23637;\n                int64_t new_index_23639 = binop_x_23636 - binop_y_23638;\n                int64_t lifted_0_get_arg_23643 = ((__global\n                                                   int64_t *) res_mem_27722)[new_index_23639];\n                float lifted_0_get_arg_23644 = ((__global\n                                                 float *) res_mem_27723)[new_index_23639];\n                float lifted_0_get_arg_23645 = ((__global\n                                                 float *) res_mem_27797)[new_index_23634 *\n                                                                         (n_23312 *\n                                                                          steps_23316) +\n                                                                         new_index_23637 *\n                                                                         n_23312 +\n                                                                         new_index_23639];\n                float x_23646 = lifted_0_get_arg_23645 / lifted_0_get_arg_23644;\n                float ceil_arg_23647 = x_23646 - 1.0F;\n                float res_23648;\n                \n                res_23648 = futrts_ceil32(ceil_arg_23647);\n                \n                int64_t res_23649 = fptosi_f32_i64(res_23648);\n                int64_t max_arg_23650 = sub64(lifted_0_get_arg_23643,\n                                              res_23649);\n                int64_t res_23651 = smax64(0, max_arg_23650);\n                bool cond_23652 = res_23651 == 0;\n                float res_23653;\n                \n                if (cond_23652) {\n               ",
                   "     res_23653 = 0.0F;\n                } else {\n                    float lifted_0_get_arg_23640 = ((__global\n                                                     float *) res_mem_27796)[new_index_23634 *\n                                                                             (n_23312 *\n                                                                              steps_23316) +\n                                                                             new_index_23637 *\n                                                                             n_23312 +\n                                                                             new_index_23639];\n                    float lifted_0_get_arg_23641 = ((__global\n                                                     float *) res_mem_27720)[new_index_23639];\n                    float lifted_0_get_arg_23642 = ((__global\n                                                     float *) res_mem_27721)[new_index_23639];\n                    float res_23654;\n                    \n                    res_23654 = futrts_ceil32(x_23646);\n                    \n                    float start_23655 = lifted_0_get_arg_23644 * res_23654;\n                    float res_23656;\n                    \n                    res_23656 = futrts_ceil32(ceil_arg_23647);\n                    \n                    int64_t res_23657 = fptosi_f32_i64(res_23656);\n                    int64_t max_arg_23658 = sub64(lifted_0_get_arg_23643,\n                                                  res_23657);\n                    int64_t res_23659 = smax64(0, max_arg_23658);\n                    int64_t sizze_23660 = sub64(res_23659, 1);\n                    bool cond_23661 = res_23629 == 0;\n                    float res_23662;\n                    \n                    if (cond_23661) {\n                        res_23662 = 1.0F;\n                    } else {\n                        res_23662 = 0.0F;\n                    }\n                    \n                    bool cond_23",
                   "663 = slt64(0, res_23629);\n                    float res_23664;\n                    \n                    if (cond_23663) {\n                        float y_23665 = lifted_0_get_arg_23641 *\n                              lifted_0_get_arg_23644;\n                        float res_23666 = res_23662 - y_23665;\n                        \n                        res_23664 = res_23666;\n                    } else {\n                        res_23664 = res_23662;\n                    }\n                    \n                    bool cond_23667 = res_23629 == sizze_23660;\n                    float res_23668;\n                    \n                    if (cond_23667) {\n                        float res_23669 = res_23664 - 1.0F;\n                        \n                        res_23668 = res_23669;\n                    } else {\n                        res_23668 = res_23664;\n                    }\n                    \n                    float res_23670 = lifted_0_get_arg_23642 * res_23668;\n                    float res_23671 = sitofp_i64_f32(res_23629);\n                    float y_23672 = lifted_0_get_arg_23644 * res_23671;\n                    float bondprice_arg_23673 = start_23655 + y_23672;\n                    float y_23674 = bondprice_arg_23673 -\n                          lifted_0_get_arg_23645;\n                    float negate_arg_23675 = a_23320 * y_23674;\n                    float exp_arg_23676 = 0.0F - negate_arg_23675;\n                    float res_23677 = fpow32(2.7182817F, exp_arg_23676);\n                    float x_23678 = 1.0F - res_23677;\n                    float B_23679 = x_23678 / a_23320;\n                    float x_23680 = B_23679 - bondprice_arg_23673;\n                    float x_23681 = lifted_0_get_arg_23645 + x_23680;\n                    float x_23682 = fpow32(a_23320, 2.0F);\n                    float x_23683 = b_23321 * x_23682;\n                    float x_23684 = fpow32(sigma_23322, 2.0F);\n                    float y_23685 = x_23684 / 2.0F;\n                    floa",
                   "t y_23686 = x_23683 - y_23685;\n                    float x_23687 = x_23681 * y_23686;\n                    float A1_23688 = x_23687 / x_23682;\n                    float y_23689 = fpow32(B_23679, 2.0F);\n                    float x_23690 = x_23684 * y_23689;\n                    float y_23691 = 4.0F * a_23320;\n                    float A2_23692 = x_23690 / y_23691;\n                    float exp_arg_23693 = A1_23688 - A2_23692;\n                    float res_23694 = fpow32(2.7182817F, exp_arg_23693);\n                    float negate_arg_23695 = lifted_0_get_arg_23640 * B_23679;\n                    float exp_arg_23696 = 0.0F - negate_arg_23695;\n                    float res_23697 = fpow32(2.7182817F, exp_arg_23696);\n                    float res_23698 = res_23694 * res_23697;\n                    float res_23699 = res_23670 * res_23698;\n                    \n                    res_23653 = res_23699;\n                }\n                // write to-scan values to parameters\n                {\n                    x_23618 = x_23626;\n                    x_23619 = res_23653;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_25435, res_23531)) {\n                    x_23618 = 0;\n                    x_23619 = 0.0F;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_23620 = x_23616 || x_23618;\n                float res_23621;\n                \n                if (x_23618) {\n                    res_23621 = x_23619;\n                } else {\n                    float res_23622 = x_23617 + x_23619;\n                    \n                    res_23621 = res_23622;\n                }\n                ((__local\n                  bool *) scan_arr_mem_28594)[sext_i32_i6",
                   "4(local_tid_28590)] =\n                    res_23620;\n                ((__local\n                  float *) scan_arr_mem_28596)[sext_i32_i64(local_tid_28590)] =\n                    res_23621;\n            }\n            \n          error_0:\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_failure)\n                return;\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28601;\n            float x_28602;\n            bool x_28603;\n            float x_28604;\n            bool x_28608;\n            float x_28609;\n            bool x_28610;\n            float x_28611;\n            bool ltid_in_bounds_28615;\n            \n            ltid_in_bounds_28615 = slt64(sext_i32_i64(local_tid_28590),\n                                         segscan_group_sizze_25431);\n            \n            int32_t skip_threads_28616;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28615) {\n                    x_28603 = ((volatile __local\n                                bool *) scan_arr_mem_28594)[sext_i32_i64(local_tid_28590)];\n                    x_28604 = ((volatile __local\n                                float *) scan_arr_mem_28596)[sext_i32_i64(local_tid_28590)];\n                    if ((local_tid_28590 - squot32(local_tid_28590, 32) * 32) ==\n                        0) {\n                        x_28601 = x_28603;\n                        x_28602 = x_28604;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28616 = 1;\n                while (slt32(skip_threads_28616, 32)) {\n                    if (sle32(skip_threads_28616, local_tid_28590 -\n                              squot32(local_tid_28590, 32) * 32) &&\n                        ltid_in_bounds_28615) {\n                        // read operands\n                        {\n                            x_28601 = ((volatile __local\n                            ",
                   "            bool *) scan_arr_mem_28594)[sext_i32_i64(local_tid_28590) -\n                                                                    sext_i32_i64(skip_threads_28616)];\n                            x_28602 = ((volatile __local\n                                        float *) scan_arr_mem_28596)[sext_i32_i64(local_tid_28590) -\n                                                                     sext_i32_i64(skip_threads_28616)];\n                        }\n                        // perform operation\n                        {\n                            bool res_28605 = x_28601 || x_28603;\n                            float res_28606;\n                            \n                            if (x_28603) {\n                                res_28606 = x_28604;\n                            } else {\n                                float res_28607 = x_28602 + x_28604;\n                                \n                                res_28606 = res_28607;\n                            }\n                            x_28601 = res_28605;\n                            x_28602 = res_28606;\n                        }\n                    }\n                    if (sle32(wave_sizze_28592, skip_threads_28616)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28616, local_tid_28590 -\n                              squot32(local_tid_28590, 32) * 32) &&\n                        ltid_in_bounds_28615) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_28594)[sext_i32_i64(local_tid_28590)] =\n                                x_28601;\n                            x_28603 = x_28601;\n                            ((volatile __local\n                              float *) scan_arr_mem_28596)[sext_i32_i64(local_tid_28590)] =\n                                x_28602;\n                            x_28604 = x_28602;\n           ",
                   "             }\n                    }\n                    if (sle32(wave_sizze_28592, skip_threads_28616)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28616 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28590 - squot32(local_tid_28590, 32) * 32) ==\n                    31 && ltid_in_bounds_28615) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28594)[sext_i32_i64(squot32(local_tid_28590,\n                                                                       32))] =\n                        x_28601;\n                    ((volatile __local\n                      float *) scan_arr_mem_28596)[sext_i32_i64(squot32(local_tid_28590,\n                                                                        32))] =\n                        x_28602;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28617;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28590, 32) == 0 &&\n                        ltid_in_bounds_28615) {\n                        x_28610 = ((volatile __local\n                                    bool *) scan_arr_mem_28594)[sext_i32_i64(local_tid_28590)];\n                        x_28611 = ((volatile __local\n                                    float *) scan_arr_mem_28596)[sext_i32_i64(local_tid_28590)];\n                        if ((local_tid_28590 - squot32(local_tid_28590, 32) *\n                             32) == 0) {\n                            x_28608 = x_28610;\n                            x_28609 = x_28611;\n                        }\n                    }\n                }\n        ",
                   "        // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28617 = 1;\n                    while (slt32(skip_threads_28617, 32)) {\n                        if (sle32(skip_threads_28617, local_tid_28590 -\n                                  squot32(local_tid_28590, 32) * 32) &&\n                            (squot32(local_tid_28590, 32) == 0 &&\n                             ltid_in_bounds_28615)) {\n                            // read operands\n                            {\n                                x_28608 = ((volatile __local\n                                            bool *) scan_arr_mem_28594)[sext_i32_i64(local_tid_28590) -\n                                                                        sext_i32_i64(skip_threads_28617)];\n                                x_28609 = ((volatile __local\n                                            float *) scan_arr_mem_28596)[sext_i32_i64(local_tid_28590) -\n                                                                         sext_i32_i64(skip_threads_28617)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28612 = x_28608 || x_28610;\n                                float res_28613;\n                                \n                                if (x_28610) {\n                                    res_28613 = x_28611;\n                                } else {\n                                    float res_28614 = x_28609 + x_28611;\n                                    \n                                    res_28613 = res_28614;\n                                }\n                                x_28608 = res_28612;\n                                x_28609 = res_28613;\n                            }\n                        }\n                        if (sle32(wave_sizze_28592, skip_threads_28617)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n        ",
                   "                if (sle32(skip_threads_28617, local_tid_28590 -\n                                  squot32(local_tid_28590, 32) * 32) &&\n                            (squot32(local_tid_28590, 32) == 0 &&\n                             ltid_in_bounds_28615)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_28594)[sext_i32_i64(local_tid_28590)] =\n                                    x_28608;\n                                x_28610 = x_28608;\n                                ((volatile __local\n                                  float *) scan_arr_mem_28596)[sext_i32_i64(local_tid_28590)] =\n                                    x_28609;\n                                x_28611 = x_28609;\n                            }\n                        }\n                        if (sle32(wave_sizze_28592, skip_threads_28617)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28617 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28590, 32) == 0 ||\n                      !ltid_in_bounds_28615)) {\n                    // read operands\n                    {\n                        x_28603 = x_28601;\n                        x_28604 = x_28602;\n                        x_28601 = ((__local\n                                    bool *) scan_arr_mem_28594)[sext_i32_i64(squot32(local_tid_28590,\n                                                                                     32)) -\n                                                                1];\n                        x_28602 = ((__local\n                                    float *) scan_arr_mem_28596)[sext_i32_i64(squot32(local_tid_28590,\n                                                 ",
                   "                                     32)) -\n                                                                 1];\n                    }\n                    // perform operation\n                    {\n                        bool res_28605 = x_28601 || x_28603;\n                        float res_28606;\n                        \n                        if (x_28603) {\n                            res_28606 = x_28604;\n                        } else {\n                            float res_28607 = x_28602 + x_28604;\n                            \n                            res_28606 = res_28607;\n                        }\n                        x_28601 = res_28605;\n                        x_28602 = res_28606;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28594)[sext_i32_i64(local_tid_28590)] =\n                            x_28601;\n                        ((__local\n                          float *) scan_arr_mem_28596)[sext_i32_i64(local_tid_28590)] =\n                            x_28602;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28590, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_28594)[sext_i32_i64(local_tid_28590)] =\n                        x_28603;\n                    ((__local\n                      float *) scan_arr_mem_28596)[sext_i32_i64(local_tid_28590)] =\n                        x_28604;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_25435, res_23531)) {\n                    ((__global bool *) mem_27823)[gtid_25435] = ((__local\n                                                                  bool *) scan_arr_mem_28594)[sext_i32_",
                   "i64(local_tid_28590)];\n                    ((__global float *) mem_27825)[gtid_25435] = ((__local\n                                                                   float *) scan_arr_mem_28596)[sext_i32_i64(local_tid_28590)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28618 = 0;\n                bool should_load_carry_28619 = local_tid_28590 == 0 &&\n                     !crosses_segment_28618;\n                \n                if (should_load_carry_28619) {\n                    x_23616 = ((__local\n                                bool *) scan_arr_mem_28594)[segscan_group_sizze_25431 -\n                                                            1];\n                    x_23617 = ((__local\n                                float *) scan_arr_mem_28596)[segscan_group_sizze_25431 -\n                                                             1];\n                }\n                if (!should_load_carry_28619) {\n                    x_23616 = 0;\n                    x_23617 = 0.0F;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_25431\n}\n__kernel void mainziscan_stage1_25488(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28661_backing_aligned_0,\n                                      int64_t res_23531, __global\n                                      unsigned char *mem_27820, __global\n                                      unsigned char *mem_27828,\n                                      int32_t num_threads_28655)\n{\n    #define segscan_group_sizze_25483 (mainzisegscan_group_sizze_25482)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28661_ba",
                   "cking_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28661_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28656;\n    int32_t local_tid_28657;\n    int64_t group_sizze_28660;\n    int32_t wave_sizze_28659;\n    int32_t group_tid_28658;\n    \n    global_tid_28656 = get_global_id(0);\n    local_tid_28657 = get_local_id(0);\n    group_sizze_28660 = get_local_size(0);\n    wave_sizze_28659 = LOCKSTEP_WIDTH;\n    group_tid_28658 = get_group_id(0);\n    \n    int32_t phys_tid_25488;\n    \n    phys_tid_25488 = global_tid_28656;\n    \n    __local char *scan_arr_mem_28661;\n    \n    scan_arr_mem_28661 = (__local char *) scan_arr_mem_28661_backing_0;\n    \n    int64_t x_23723;\n    int64_t x_23724;\n    \n    x_23723 = 0;\n    for (int64_t j_28663 = 0; j_28663 < sdiv_up64(res_23531,\n                                                  sext_i32_i64(num_threads_28655));\n         j_28663++) {\n        int64_t chunk_offset_28664 = segscan_group_sizze_25483 * j_28663 +\n                sext_i32_i64(group_tid_28658) * (segscan_group_sizze_25483 *\n                                                 sdiv_up64(res_23531,\n                                                           sext_i32_i64(num_threads_28655)));\n        int64_t flat_idx_28665 = chunk_offset_28664 +\n                sext_i32_i64(local_tid_28657);\n        int64_t gtid_25487 = flat_idx_28665;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_25487, res_23531)) {\n                int64_t i_p_o_27578 = add64(1, gtid_25487);\n                int64_t rot_i_27579 = smod64(i_p_o_27578, res_23531);\n                bool x_23726 = ((__global bool *) mem_27820)[rot_i_27579];\n                int64_t res_23727 = btoi_bool_i64(x_23726);\n                \n                // write to-scan values to parameters\n                {\n                    x_23724 = res_23727;\n                }\n                // write mapped values results ",
                   "to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_25487, res_23531)) {\n                    x_23724 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_23725 = add64(x_23723, x_23724);\n                \n                ((__local\n                  int64_t *) scan_arr_mem_28661)[sext_i32_i64(local_tid_28657)] =\n                    res_23725;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_28666;\n            int64_t x_28667;\n            int64_t x_28669;\n            int64_t x_28670;\n            bool ltid_in_bounds_28672;\n            \n            ltid_in_bounds_28672 = slt64(sext_i32_i64(local_tid_28657),\n                                         segscan_group_sizze_25483);\n            \n            int32_t skip_threads_28673;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28672) {\n                    x_28667 = ((volatile __local\n                                int64_t *) scan_arr_mem_28661)[sext_i32_i64(local_tid_28657)];\n                    if ((local_tid_28657 - squot32(local_tid_28657, 32) * 32) ==\n                        0) {\n                        x_28666 = x_28667;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28673 = 1;\n                while (slt32(skip_threads_28673, 32)) {\n                    if (sle32(skip_threads_28673, local_tid_28657 -\n                              squot32(local_tid_28657, 32) * 32) &&\n                        ltid_in_bounds_28672) {\n                        // read operands\n                        {\n                            x_28666 = ((volatile __local\n      ",
                   "                                  int64_t *) scan_arr_mem_28661)[sext_i32_i64(local_tid_28657) -\n                                                                       sext_i32_i64(skip_threads_28673)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_28668 = add64(x_28666, x_28667);\n                            \n                            x_28666 = res_28668;\n                        }\n                    }\n                    if (sle32(wave_sizze_28659, skip_threads_28673)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28673, local_tid_28657 -\n                              squot32(local_tid_28657, 32) * 32) &&\n                        ltid_in_bounds_28672) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28661)[sext_i32_i64(local_tid_28657)] =\n                                x_28666;\n                            x_28667 = x_28666;\n                        }\n                    }\n                    if (sle32(wave_sizze_28659, skip_threads_28673)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28673 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28657 - squot32(local_tid_28657, 32) * 32) ==\n                    31 && ltid_in_bounds_28672) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28661)[sext_i32_i64(squot32(local_tid_28657,\n                                                                          32))] =\n                        x_28666;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first",
                   " block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28674;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28657, 32) == 0 &&\n                        ltid_in_bounds_28672) {\n                        x_28670 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28661)[sext_i32_i64(local_tid_28657)];\n                        if ((local_tid_28657 - squot32(local_tid_28657, 32) *\n                             32) == 0) {\n                            x_28669 = x_28670;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28674 = 1;\n                    while (slt32(skip_threads_28674, 32)) {\n                        if (sle32(skip_threads_28674, local_tid_28657 -\n                                  squot32(local_tid_28657, 32) * 32) &&\n                            (squot32(local_tid_28657, 32) == 0 &&\n                             ltid_in_bounds_28672)) {\n                            // read operands\n                            {\n                                x_28669 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28661)[sext_i32_i64(local_tid_28657) -\n                                                                           sext_i32_i64(skip_threads_28674)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_28671 = add64(x_28669, x_28670);\n                                \n                                x_28669 = res_28671;\n                            }\n                        }\n                        if (sle32(wave_sizze_28659, skip_threads_28674)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n           ",
                   "             if (sle32(skip_threads_28674, local_tid_28657 -\n                                  squot32(local_tid_28657, 32) * 32) &&\n                            (squot32(local_tid_28657, 32) == 0 &&\n                             ltid_in_bounds_28672)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28661)[sext_i32_i64(local_tid_28657)] =\n                                    x_28669;\n                                x_28670 = x_28669;\n                            }\n                        }\n                        if (sle32(wave_sizze_28659, skip_threads_28674)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28674 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28657, 32) == 0 ||\n                      !ltid_in_bounds_28672)) {\n                    // read operands\n                    {\n                        x_28667 = x_28666;\n                        x_28666 = ((__local\n                                    int64_t *) scan_arr_mem_28661)[sext_i32_i64(squot32(local_tid_28657,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28668 = add64(x_28666, x_28667);\n                        \n                        x_28666 = res_28668;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_28661)[sext_i32_i64(local_tid_28657)] =\n                            x_28666;\n  ",
                   "                  }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28657, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_28661)[sext_i32_i64(local_tid_28657)] =\n                        x_28667;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_25487, res_23531)) {\n                    ((__global int64_t *) mem_27828)[gtid_25487] = ((__local\n                                                                     int64_t *) scan_arr_mem_28661)[sext_i32_i64(local_tid_28657)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28675 = 0;\n                bool should_load_carry_28676 = local_tid_28657 == 0 &&\n                     !crosses_segment_28675;\n                \n                if (should_load_carry_28676) {\n                    x_23723 = ((__local\n                                int64_t *) scan_arr_mem_28661)[segscan_group_sizze_25483 -\n                                                               1];\n                }\n                if (!should_load_carry_28676) {\n                    x_23723 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_25483\n}\n__kernel void mainziscan_stage2_25387(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28242_backing_aligned_0,\n                                      int64_t binop_x_27752, __global\n                                      unsigned char *mem_27800,\n                                  ",
                   "    int64_t stage1_num_groups_28214,\n                                      int32_t num_threads_28215)\n{\n    #define segscan_group_sizze_25382 (mainzisegscan_group_sizze_25381)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28242_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28242_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28237;\n    int32_t local_tid_28238;\n    int64_t group_sizze_28241;\n    int32_t wave_sizze_28240;\n    int32_t group_tid_28239;\n    \n    global_tid_28237 = get_global_id(0);\n    local_tid_28238 = get_local_id(0);\n    group_sizze_28241 = get_local_size(0);\n    wave_sizze_28240 = LOCKSTEP_WIDTH;\n    group_tid_28239 = get_group_id(0);\n    \n    int32_t phys_tid_25387;\n    \n    phys_tid_25387 = global_tid_28237;\n    \n    __local char *scan_arr_mem_28242;\n    \n    scan_arr_mem_28242 = (__local char *) scan_arr_mem_28242_backing_0;\n    \n    int64_t flat_idx_28244;\n    \n    flat_idx_28244 = (sext_i32_i64(local_tid_28238) + 1) *\n        (segscan_group_sizze_25382 * sdiv_up64(binop_x_27752,\n                                               sext_i32_i64(num_threads_28215))) -\n        1;\n    \n    int64_t gtid_25386;\n    \n    gtid_25386 = flat_idx_28244;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_25386, binop_x_27752)) {\n            ((__local\n              int64_t *) scan_arr_mem_28242)[sext_i32_i64(local_tid_28238)] =\n                ((__global int64_t *) mem_27800)[gtid_25386];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_28242)[sext_i32_i64(local_tid_28238)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_23515;\n    int64_t x_23516;\n    int64_t x_28245;\n    int64_t x_28246;\n    bool ltid_in_bounds_28248;\n    \n    ltid_in_bounds_28248 = slt64(sext_i32",
                   "_i64(local_tid_28238),\n                                 stage1_num_groups_28214);\n    \n    int32_t skip_threads_28249;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28248) {\n            x_23516 = ((volatile __local\n                        int64_t *) scan_arr_mem_28242)[sext_i32_i64(local_tid_28238)];\n            if ((local_tid_28238 - squot32(local_tid_28238, 32) * 32) == 0) {\n                x_23515 = x_23516;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28249 = 1;\n        while (slt32(skip_threads_28249, 32)) {\n            if (sle32(skip_threads_28249, local_tid_28238 -\n                      squot32(local_tid_28238, 32) * 32) &&\n                ltid_in_bounds_28248) {\n                // read operands\n                {\n                    x_23515 = ((volatile __local\n                                int64_t *) scan_arr_mem_28242)[sext_i32_i64(local_tid_28238) -\n                                                               sext_i32_i64(skip_threads_28249)];\n                }\n                // perform operation\n                {\n                    int64_t res_23517 = add64(x_23515, x_23516);\n                    \n                    x_23515 = res_23517;\n                }\n            }\n            if (sle32(wave_sizze_28240, skip_threads_28249)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28249, local_tid_28238 -\n                      squot32(local_tid_28238, 32) * 32) &&\n                ltid_in_bounds_28248) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28242)[sext_i32_i64(local_tid_28238)] =\n                        x_23515;\n                    x_23516 = x_23515;\n                }\n            }\n            if (sle32(wave_sizze_28240, skip_threads_28249)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_th",
                   "reads_28249 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28238 - squot32(local_tid_28238, 32) * 32) == 31 &&\n            ltid_in_bounds_28248) {\n            ((volatile __local\n              int64_t *) scan_arr_mem_28242)[sext_i32_i64(squot32(local_tid_28238,\n                                                                  32))] =\n                x_23515;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28250;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28238, 32) == 0 && ltid_in_bounds_28248) {\n                x_28246 = ((volatile __local\n                            int64_t *) scan_arr_mem_28242)[sext_i32_i64(local_tid_28238)];\n                if ((local_tid_28238 - squot32(local_tid_28238, 32) * 32) ==\n                    0) {\n                    x_28245 = x_28246;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28250 = 1;\n            while (slt32(skip_threads_28250, 32)) {\n                if (sle32(skip_threads_28250, local_tid_28238 -\n                          squot32(local_tid_28238, 32) * 32) &&\n                    (squot32(local_tid_28238, 32) == 0 &&\n                     ltid_in_bounds_28248)) {\n                    // read operands\n                    {\n                        x_28245 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28242)[sext_i32_i64(local_tid_28238) -\n                                                                   sext_i32_i64(skip_threads_28250)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28247 = add64(x_28245, x_28246);\n                        \n                        x_2",
                   "8245 = res_28247;\n                    }\n                }\n                if (sle32(wave_sizze_28240, skip_threads_28250)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28250, local_tid_28238 -\n                          squot32(local_tid_28238, 32) * 32) &&\n                    (squot32(local_tid_28238, 32) == 0 &&\n                     ltid_in_bounds_28248)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28242)[sext_i32_i64(local_tid_28238)] =\n                            x_28245;\n                        x_28246 = x_28245;\n                    }\n                }\n                if (sle32(wave_sizze_28240, skip_threads_28250)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28250 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28238, 32) == 0 || !ltid_in_bounds_28248)) {\n            // read operands\n            {\n                x_23516 = x_23515;\n                x_23515 = ((__local\n                            int64_t *) scan_arr_mem_28242)[sext_i32_i64(squot32(local_tid_28238,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_23517 = add64(x_23515, x_23516);\n                \n                x_23515 = res_23517;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_28242)[sext_i32_i64(local_tid_28238)] =\n                    x_23515;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28238, 32)",
                   " == 0) {\n            ((__local\n              int64_t *) scan_arr_mem_28242)[sext_i32_i64(local_tid_28238)] =\n                x_23516;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_25386, binop_x_27752)) {\n            ((__global int64_t *) mem_27800)[gtid_25386] = ((__local\n                                                             int64_t *) scan_arr_mem_28242)[sext_i32_i64(local_tid_28238)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25382\n}\n__kernel void mainziscan_stage2_25420(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28493_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28491_backing_aligned_1,\n                                      int64_t res_23531, __global\n                                      unsigned char *mem_27811, __global\n                                      unsigned char *mem_27813,\n                                      int64_t stage1_num_groups_28453,\n                                      int32_t num_threads_28454)\n{\n    #define segscan_group_sizze_25415 (mainzisegscan_group_sizze_25414)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28493_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28493_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28491_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28491_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28486;\n    int32_t local_tid_28487;\n    int64_t group_sizze_28490;\n    int32_t wave_sizze_28489;\n    int32_t group_tid_28488;\n    \n    g",
                   "lobal_tid_28486 = get_global_id(0);\n    local_tid_28487 = get_local_id(0);\n    group_sizze_28490 = get_local_size(0);\n    wave_sizze_28489 = LOCKSTEP_WIDTH;\n    group_tid_28488 = get_group_id(0);\n    \n    int32_t phys_tid_25420;\n    \n    phys_tid_25420 = global_tid_28486;\n    \n    __local char *scan_arr_mem_28491;\n    __local char *scan_arr_mem_28493;\n    \n    scan_arr_mem_28491 = (__local char *) scan_arr_mem_28491_backing_0;\n    scan_arr_mem_28493 = (__local char *) scan_arr_mem_28493_backing_1;\n    \n    int64_t flat_idx_28495;\n    \n    flat_idx_28495 = (sext_i32_i64(local_tid_28487) + 1) *\n        (segscan_group_sizze_25415 * sdiv_up64(res_23531,\n                                               sext_i32_i64(num_threads_28454))) -\n        1;\n    \n    int64_t gtid_25419;\n    \n    gtid_25419 = flat_idx_28495;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_25419, res_23531)) {\n            ((__local\n              bool *) scan_arr_mem_28491)[sext_i32_i64(local_tid_28487)] =\n                ((__global bool *) mem_27811)[gtid_25419];\n            ((__local\n              int64_t *) scan_arr_mem_28493)[sext_i32_i64(local_tid_28487)] =\n                ((__global int64_t *) mem_27813)[gtid_25419];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28491)[sext_i32_i64(local_tid_28487)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_28493)[sext_i32_i64(local_tid_28487)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_23550;\n    int64_t x_23551;\n    bool x_23552;\n    int64_t x_23553;\n    bool x_28496;\n    int64_t x_28497;\n    bool x_28498;\n    int64_t x_28499;\n    bool ltid_in_bounds_28503;\n    \n    ltid_in_bounds_28503 = slt64(sext_i32_i64(local_tid_28487),\n                                 stage1_num_groups_28453);\n    \n    int32_t skip_threads_28504;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28503) {\n            x_23552 = ((volatile __loc",
                   "al\n                        bool *) scan_arr_mem_28491)[sext_i32_i64(local_tid_28487)];\n            x_23553 = ((volatile __local\n                        int64_t *) scan_arr_mem_28493)[sext_i32_i64(local_tid_28487)];\n            if ((local_tid_28487 - squot32(local_tid_28487, 32) * 32) == 0) {\n                x_23550 = x_23552;\n                x_23551 = x_23553;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28504 = 1;\n        while (slt32(skip_threads_28504, 32)) {\n            if (sle32(skip_threads_28504, local_tid_28487 -\n                      squot32(local_tid_28487, 32) * 32) &&\n                ltid_in_bounds_28503) {\n                // read operands\n                {\n                    x_23550 = ((volatile __local\n                                bool *) scan_arr_mem_28491)[sext_i32_i64(local_tid_28487) -\n                                                            sext_i32_i64(skip_threads_28504)];\n                    x_23551 = ((volatile __local\n                                int64_t *) scan_arr_mem_28493)[sext_i32_i64(local_tid_28487) -\n                                                               sext_i32_i64(skip_threads_28504)];\n                }\n                // perform operation\n                {\n                    bool res_23554 = x_23550 || x_23552;\n                    int64_t res_23555;\n                    \n                    if (x_23552) {\n                        res_23555 = x_23553;\n                    } else {\n                        int64_t res_23556 = add64(x_23551, x_23553);\n                        \n                        res_23555 = res_23556;\n                    }\n                    x_23550 = res_23554;\n                    x_23551 = res_23555;\n                }\n            }\n            if (sle32(wave_sizze_28489, skip_threads_28504)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28504, local_tid_28487 -\n                     ",
                   " squot32(local_tid_28487, 32) * 32) &&\n                ltid_in_bounds_28503) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28491)[sext_i32_i64(local_tid_28487)] =\n                        x_23550;\n                    x_23552 = x_23550;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28493)[sext_i32_i64(local_tid_28487)] =\n                        x_23551;\n                    x_23553 = x_23551;\n                }\n            }\n            if (sle32(wave_sizze_28489, skip_threads_28504)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28504 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28487 - squot32(local_tid_28487, 32) * 32) == 31 &&\n            ltid_in_bounds_28503) {\n            ((volatile __local\n              bool *) scan_arr_mem_28491)[sext_i32_i64(squot32(local_tid_28487,\n                                                               32))] = x_23550;\n            ((volatile __local\n              int64_t *) scan_arr_mem_28493)[sext_i32_i64(squot32(local_tid_28487,\n                                                                  32))] =\n                x_23551;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28505;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28487, 32) == 0 && ltid_in_bounds_28503) {\n                x_28498 = ((volatile __local\n                            bool *) scan_arr_mem_28491)[sext_i32_i64(local_tid_28487)];\n                x_28499 = ((volatile __local\n                            int64_t *) scan_arr_mem_28493)[sext_i32_i64(local_tid_28487)];\n                if ((local_tid_28487 - squot32(local_tid_28487, 32) * ",
                   "32) ==\n                    0) {\n                    x_28496 = x_28498;\n                    x_28497 = x_28499;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28505 = 1;\n            while (slt32(skip_threads_28505, 32)) {\n                if (sle32(skip_threads_28505, local_tid_28487 -\n                          squot32(local_tid_28487, 32) * 32) &&\n                    (squot32(local_tid_28487, 32) == 0 &&\n                     ltid_in_bounds_28503)) {\n                    // read operands\n                    {\n                        x_28496 = ((volatile __local\n                                    bool *) scan_arr_mem_28491)[sext_i32_i64(local_tid_28487) -\n                                                                sext_i32_i64(skip_threads_28505)];\n                        x_28497 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28493)[sext_i32_i64(local_tid_28487) -\n                                                                   sext_i32_i64(skip_threads_28505)];\n                    }\n                    // perform operation\n                    {\n                        bool res_28500 = x_28496 || x_28498;\n                        int64_t res_28501;\n                        \n                        if (x_28498) {\n                            res_28501 = x_28499;\n                        } else {\n                            int64_t res_28502 = add64(x_28497, x_28499);\n                            \n                            res_28501 = res_28502;\n                        }\n                        x_28496 = res_28500;\n                        x_28497 = res_28501;\n                    }\n                }\n                if (sle32(wave_sizze_28489, skip_threads_28505)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28505, local_tid_28487 -\n                          squot32(local_tid_28487, 32) * 3",
                   "2) &&\n                    (squot32(local_tid_28487, 32) == 0 &&\n                     ltid_in_bounds_28503)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28491)[sext_i32_i64(local_tid_28487)] =\n                            x_28496;\n                        x_28498 = x_28496;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28493)[sext_i32_i64(local_tid_28487)] =\n                            x_28497;\n                        x_28499 = x_28497;\n                    }\n                }\n                if (sle32(wave_sizze_28489, skip_threads_28505)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28505 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28487, 32) == 0 || !ltid_in_bounds_28503)) {\n            // read operands\n            {\n                x_23552 = x_23550;\n                x_23553 = x_23551;\n                x_23550 = ((__local\n                            bool *) scan_arr_mem_28491)[sext_i32_i64(squot32(local_tid_28487,\n                                                                             32)) -\n                                                        1];\n                x_23551 = ((__local\n                            int64_t *) scan_arr_mem_28493)[sext_i32_i64(squot32(local_tid_28487,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_23554 = x_23550 || x_23552;\n                int64_t res_23555;\n                \n                if (x_23552) {\n                    res_23555 = x_23553;\n                } else {\n                    int64_t res_23556 = add64(x_23551, x_23553);",
                   "\n                    \n                    res_23555 = res_23556;\n                }\n                x_23550 = res_23554;\n                x_23551 = res_23555;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28491)[sext_i32_i64(local_tid_28487)] =\n                    x_23550;\n                ((__local\n                  int64_t *) scan_arr_mem_28493)[sext_i32_i64(local_tid_28487)] =\n                    x_23551;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28487, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28491)[sext_i32_i64(local_tid_28487)] =\n                x_23552;\n            ((__local\n              int64_t *) scan_arr_mem_28493)[sext_i32_i64(local_tid_28487)] =\n                x_23553;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_25419, res_23531)) {\n            ((__global bool *) mem_27811)[gtid_25419] = ((__local\n                                                          bool *) scan_arr_mem_28491)[sext_i32_i64(local_tid_28487)];\n            ((__global int64_t *) mem_27813)[gtid_25419] = ((__local\n                                                             int64_t *) scan_arr_mem_28493)[sext_i32_i64(local_tid_28487)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25415\n}\n__kernel void mainziscan_stage2_25428(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28560_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28558_backing_aligned_1,\n                                      int64_t res_23531, __global\n                                      unsigned char *mem_27816, __global\n    ",
                   "                                  unsigned char *mem_27818,\n                                      int64_t stage1_num_groups_28520,\n                                      int32_t num_threads_28521)\n{\n    #define segscan_group_sizze_25423 (mainzisegscan_group_sizze_25422)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28560_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28560_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28558_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28558_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28553;\n    int32_t local_tid_28554;\n    int64_t group_sizze_28557;\n    int32_t wave_sizze_28556;\n    int32_t group_tid_28555;\n    \n    global_tid_28553 = get_global_id(0);\n    local_tid_28554 = get_local_id(0);\n    group_sizze_28557 = get_local_size(0);\n    wave_sizze_28556 = LOCKSTEP_WIDTH;\n    group_tid_28555 = get_group_id(0);\n    \n    int32_t phys_tid_25428;\n    \n    phys_tid_25428 = global_tid_28553;\n    \n    __local char *scan_arr_mem_28558;\n    __local char *scan_arr_mem_28560;\n    \n    scan_arr_mem_28558 = (__local char *) scan_arr_mem_28558_backing_0;\n    scan_arr_mem_28560 = (__local char *) scan_arr_mem_28560_backing_1;\n    \n    int64_t flat_idx_28562;\n    \n    flat_idx_28562 = (sext_i32_i64(local_tid_28554) + 1) *\n        (segscan_group_sizze_25423 * sdiv_up64(res_23531,\n                                               sext_i32_i64(num_threads_28521))) -\n        1;\n    \n    int64_t gtid_25427;\n    \n    gtid_25427 = flat_idx_28562;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_25427, res_23531)) {\n            ((__local\n              bool *) scan_arr_mem_28558)[sext_i32_i64(local_tid_28554)] =\n                ((__g",
                   "lobal bool *) mem_27816)[gtid_25427];\n            ((__local\n              int64_t *) scan_arr_mem_28560)[sext_i32_i64(local_tid_28554)] =\n                ((__global int64_t *) mem_27818)[gtid_25427];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28558)[sext_i32_i64(local_tid_28554)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_28560)[sext_i32_i64(local_tid_28554)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_23590;\n    int64_t x_23591;\n    bool x_23592;\n    int64_t x_23593;\n    bool x_28563;\n    int64_t x_28564;\n    bool x_28565;\n    int64_t x_28566;\n    bool ltid_in_bounds_28570;\n    \n    ltid_in_bounds_28570 = slt64(sext_i32_i64(local_tid_28554),\n                                 stage1_num_groups_28520);\n    \n    int32_t skip_threads_28571;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28570) {\n            x_23592 = ((volatile __local\n                        bool *) scan_arr_mem_28558)[sext_i32_i64(local_tid_28554)];\n            x_23593 = ((volatile __local\n                        int64_t *) scan_arr_mem_28560)[sext_i32_i64(local_tid_28554)];\n            if ((local_tid_28554 - squot32(local_tid_28554, 32) * 32) == 0) {\n                x_23590 = x_23592;\n                x_23591 = x_23593;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28571 = 1;\n        while (slt32(skip_threads_28571, 32)) {\n            if (sle32(skip_threads_28571, local_tid_28554 -\n                      squot32(local_tid_28554, 32) * 32) &&\n                ltid_in_bounds_28570) {\n                // read operands\n                {\n                    x_23590 = ((volatile __local\n                                bool *) scan_arr_mem_28558)[sext_i32_i64(local_tid_28554) -\n                                                            sext_i32_i64(skip_threads_28571)];\n                    x_23591 = ((volatile __local\n                         ",
                   "       int64_t *) scan_arr_mem_28560)[sext_i32_i64(local_tid_28554) -\n                                                               sext_i32_i64(skip_threads_28571)];\n                }\n                // perform operation\n                {\n                    bool res_23594 = x_23590 || x_23592;\n                    int64_t res_23595;\n                    \n                    if (x_23592) {\n                        res_23595 = x_23593;\n                    } else {\n                        int64_t res_23596 = add64(x_23591, x_23593);\n                        \n                        res_23595 = res_23596;\n                    }\n                    x_23590 = res_23594;\n                    x_23591 = res_23595;\n                }\n            }\n            if (sle32(wave_sizze_28556, skip_threads_28571)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28571, local_tid_28554 -\n                      squot32(local_tid_28554, 32) * 32) &&\n                ltid_in_bounds_28570) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28558)[sext_i32_i64(local_tid_28554)] =\n                        x_23590;\n                    x_23592 = x_23590;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28560)[sext_i32_i64(local_tid_28554)] =\n                        x_23591;\n                    x_23593 = x_23591;\n                }\n            }\n            if (sle32(wave_sizze_28556, skip_threads_28571)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28571 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28554 - squot32(local_tid_28554, 32) * 32) == 31 &&\n            ltid_in_bounds_28570) {\n            ((volatile __local\n              bool *) scan_arr_mem_28558)[sext_i32_i64(squot32(local_tid_28554",
                   ",\n                                                               32))] = x_23590;\n            ((volatile __local\n              int64_t *) scan_arr_mem_28560)[sext_i32_i64(squot32(local_tid_28554,\n                                                                  32))] =\n                x_23591;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28572;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28554, 32) == 0 && ltid_in_bounds_28570) {\n                x_28565 = ((volatile __local\n                            bool *) scan_arr_mem_28558)[sext_i32_i64(local_tid_28554)];\n                x_28566 = ((volatile __local\n                            int64_t *) scan_arr_mem_28560)[sext_i32_i64(local_tid_28554)];\n                if ((local_tid_28554 - squot32(local_tid_28554, 32) * 32) ==\n                    0) {\n                    x_28563 = x_28565;\n                    x_28564 = x_28566;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28572 = 1;\n            while (slt32(skip_threads_28572, 32)) {\n                if (sle32(skip_threads_28572, local_tid_28554 -\n                          squot32(local_tid_28554, 32) * 32) &&\n                    (squot32(local_tid_28554, 32) == 0 &&\n                     ltid_in_bounds_28570)) {\n                    // read operands\n                    {\n                        x_28563 = ((volatile __local\n                                    bool *) scan_arr_mem_28558)[sext_i32_i64(local_tid_28554) -\n                                                                sext_i32_i64(skip_threads_28572)];\n                        x_28564 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28560)[sext_i32_i64(local_tid_28554) -\n                                                       ",
                   "            sext_i32_i64(skip_threads_28572)];\n                    }\n                    // perform operation\n                    {\n                        bool res_28567 = x_28563 || x_28565;\n                        int64_t res_28568;\n                        \n                        if (x_28565) {\n                            res_28568 = x_28566;\n                        } else {\n                            int64_t res_28569 = add64(x_28564, x_28566);\n                            \n                            res_28568 = res_28569;\n                        }\n                        x_28563 = res_28567;\n                        x_28564 = res_28568;\n                    }\n                }\n                if (sle32(wave_sizze_28556, skip_threads_28572)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28572, local_tid_28554 -\n                          squot32(local_tid_28554, 32) * 32) &&\n                    (squot32(local_tid_28554, 32) == 0 &&\n                     ltid_in_bounds_28570)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28558)[sext_i32_i64(local_tid_28554)] =\n                            x_28563;\n                        x_28565 = x_28563;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28560)[sext_i32_i64(local_tid_28554)] =\n                            x_28564;\n                        x_28566 = x_28564;\n                    }\n                }\n                if (sle32(wave_sizze_28556, skip_threads_28572)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28572 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28554, 32) == 0 || !ltid_in_bounds_28570)) {\n            // read operands\n            {\n      ",
                   "          x_23592 = x_23590;\n                x_23593 = x_23591;\n                x_23590 = ((__local\n                            bool *) scan_arr_mem_28558)[sext_i32_i64(squot32(local_tid_28554,\n                                                                             32)) -\n                                                        1];\n                x_23591 = ((__local\n                            int64_t *) scan_arr_mem_28560)[sext_i32_i64(squot32(local_tid_28554,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_23594 = x_23590 || x_23592;\n                int64_t res_23595;\n                \n                if (x_23592) {\n                    res_23595 = x_23593;\n                } else {\n                    int64_t res_23596 = add64(x_23591, x_23593);\n                    \n                    res_23595 = res_23596;\n                }\n                x_23590 = res_23594;\n                x_23591 = res_23595;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28558)[sext_i32_i64(local_tid_28554)] =\n                    x_23590;\n                ((__local\n                  int64_t *) scan_arr_mem_28560)[sext_i32_i64(local_tid_28554)] =\n                    x_23591;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28554, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28558)[sext_i32_i64(local_tid_28554)] =\n                x_23592;\n            ((__local\n              int64_t *) scan_arr_mem_28560)[sext_i32_i64(local_tid_28554)] =\n                x_23593;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_25427, res_23531)) {\n   ",
                   "         ((__global bool *) mem_27816)[gtid_25427] = ((__local\n                                                          bool *) scan_arr_mem_28558)[sext_i32_i64(local_tid_28554)];\n            ((__global int64_t *) mem_27818)[gtid_25427] = ((__local\n                                                             int64_t *) scan_arr_mem_28560)[sext_i32_i64(local_tid_28554)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25423\n}\n__kernel void mainziscan_stage2_25436(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28627_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28625_backing_aligned_1,\n                                      int64_t res_23531, __global\n                                      unsigned char *mem_27823, __global\n                                      unsigned char *mem_27825,\n                                      int64_t stage1_num_groups_28587,\n                                      int32_t num_threads_28588)\n{\n    #define segscan_group_sizze_25431 (mainzisegscan_group_sizze_25430)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28627_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28627_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28625_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28625_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28620;\n    int32_t local_tid_28621;\n    int64_t group_sizze_28624;\n    int32_t wave_sizze_28623;\n    int32_t group_tid_28622;\n    \n    global_tid_28620 = get_global_id(0);\n    local_tid_28621 = get_local_id(0);\n    group_sizze_28624 = get_l",
                   "ocal_size(0);\n    wave_sizze_28623 = LOCKSTEP_WIDTH;\n    group_tid_28622 = get_group_id(0);\n    \n    int32_t phys_tid_25436;\n    \n    phys_tid_25436 = global_tid_28620;\n    \n    __local char *scan_arr_mem_28625;\n    __local char *scan_arr_mem_28627;\n    \n    scan_arr_mem_28625 = (__local char *) scan_arr_mem_28625_backing_0;\n    scan_arr_mem_28627 = (__local char *) scan_arr_mem_28627_backing_1;\n    \n    int64_t flat_idx_28629;\n    \n    flat_idx_28629 = (sext_i32_i64(local_tid_28621) + 1) *\n        (segscan_group_sizze_25431 * sdiv_up64(res_23531,\n                                               sext_i32_i64(num_threads_28588))) -\n        1;\n    \n    int64_t gtid_25435;\n    \n    gtid_25435 = flat_idx_28629;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_25435, res_23531)) {\n            ((__local\n              bool *) scan_arr_mem_28625)[sext_i32_i64(local_tid_28621)] =\n                ((__global bool *) mem_27823)[gtid_25435];\n            ((__local\n              float *) scan_arr_mem_28627)[sext_i32_i64(local_tid_28621)] =\n                ((__global float *) mem_27825)[gtid_25435];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28625)[sext_i32_i64(local_tid_28621)] = 0;\n            ((__local\n              float *) scan_arr_mem_28627)[sext_i32_i64(local_tid_28621)] =\n                0.0F;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_23616;\n    float x_23617;\n    bool x_23618;\n    float x_23619;\n    bool x_28630;\n    float x_28631;\n    bool x_28632;\n    float x_28633;\n    bool ltid_in_bounds_28637;\n    \n    ltid_in_bounds_28637 = slt64(sext_i32_i64(local_tid_28621),\n                                 stage1_num_groups_28587);\n    \n    int32_t skip_threads_28638;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28637) {\n            x_23618 = ((volatile __local\n                        bool *) scan_arr_mem_28625)[sext_i32_i64(local_tid_28621)];\n            ",
                   "x_23619 = ((volatile __local\n                        float *) scan_arr_mem_28627)[sext_i32_i64(local_tid_28621)];\n            if ((local_tid_28621 - squot32(local_tid_28621, 32) * 32) == 0) {\n                x_23616 = x_23618;\n                x_23617 = x_23619;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28638 = 1;\n        while (slt32(skip_threads_28638, 32)) {\n            if (sle32(skip_threads_28638, local_tid_28621 -\n                      squot32(local_tid_28621, 32) * 32) &&\n                ltid_in_bounds_28637) {\n                // read operands\n                {\n                    x_23616 = ((volatile __local\n                                bool *) scan_arr_mem_28625)[sext_i32_i64(local_tid_28621) -\n                                                            sext_i32_i64(skip_threads_28638)];\n                    x_23617 = ((volatile __local\n                                float *) scan_arr_mem_28627)[sext_i32_i64(local_tid_28621) -\n                                                             sext_i32_i64(skip_threads_28638)];\n                }\n                // perform operation\n                {\n                    bool res_23620 = x_23616 || x_23618;\n                    float res_23621;\n                    \n                    if (x_23618) {\n                        res_23621 = x_23619;\n                    } else {\n                        float res_23622 = x_23617 + x_23619;\n                        \n                        res_23621 = res_23622;\n                    }\n                    x_23616 = res_23620;\n                    x_23617 = res_23621;\n                }\n            }\n            if (sle32(wave_sizze_28623, skip_threads_28638)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28638, local_tid_28621 -\n                      squot32(local_tid_28621, 32) * 32) &&\n                ltid_in_bounds_28637) {\n                // write result\n    ",
                   "            {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28625)[sext_i32_i64(local_tid_28621)] =\n                        x_23616;\n                    x_23618 = x_23616;\n                    ((volatile __local\n                      float *) scan_arr_mem_28627)[sext_i32_i64(local_tid_28621)] =\n                        x_23617;\n                    x_23619 = x_23617;\n                }\n            }\n            if (sle32(wave_sizze_28623, skip_threads_28638)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28638 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28621 - squot32(local_tid_28621, 32) * 32) == 31 &&\n            ltid_in_bounds_28637) {\n            ((volatile __local\n              bool *) scan_arr_mem_28625)[sext_i32_i64(squot32(local_tid_28621,\n                                                               32))] = x_23616;\n            ((volatile __local\n              float *) scan_arr_mem_28627)[sext_i32_i64(squot32(local_tid_28621,\n                                                                32))] = x_23617;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28639;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28621, 32) == 0 && ltid_in_bounds_28637) {\n                x_28632 = ((volatile __local\n                            bool *) scan_arr_mem_28625)[sext_i32_i64(local_tid_28621)];\n                x_28633 = ((volatile __local\n                            float *) scan_arr_mem_28627)[sext_i32_i64(local_tid_28621)];\n                if ((local_tid_28621 - squot32(local_tid_28621, 32) * 32) ==\n                    0) {\n                    x_28630 = x_28632;\n                    x_28631 = x_28633;\n                }\n           ",
                   " }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28639 = 1;\n            while (slt32(skip_threads_28639, 32)) {\n                if (sle32(skip_threads_28639, local_tid_28621 -\n                          squot32(local_tid_28621, 32) * 32) &&\n                    (squot32(local_tid_28621, 32) == 0 &&\n                     ltid_in_bounds_28637)) {\n                    // read operands\n                    {\n                        x_28630 = ((volatile __local\n                                    bool *) scan_arr_mem_28625)[sext_i32_i64(local_tid_28621) -\n                                                                sext_i32_i64(skip_threads_28639)];\n                        x_28631 = ((volatile __local\n                                    float *) scan_arr_mem_28627)[sext_i32_i64(local_tid_28621) -\n                                                                 sext_i32_i64(skip_threads_28639)];\n                    }\n                    // perform operation\n                    {\n                        bool res_28634 = x_28630 || x_28632;\n                        float res_28635;\n                        \n                        if (x_28632) {\n                            res_28635 = x_28633;\n                        } else {\n                            float res_28636 = x_28631 + x_28633;\n                            \n                            res_28635 = res_28636;\n                        }\n                        x_28630 = res_28634;\n                        x_28631 = res_28635;\n                    }\n                }\n                if (sle32(wave_sizze_28623, skip_threads_28639)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28639, local_tid_28621 -\n                          squot32(local_tid_28621, 32) * 32) &&\n                    (squot32(local_tid_28621, 32) == 0 &&\n                     ltid_in_bounds_28637)) {\n                    // write result\n       ",
                   "             {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28625)[sext_i32_i64(local_tid_28621)] =\n                            x_28630;\n                        x_28632 = x_28630;\n                        ((volatile __local\n                          float *) scan_arr_mem_28627)[sext_i32_i64(local_tid_28621)] =\n                            x_28631;\n                        x_28633 = x_28631;\n                    }\n                }\n                if (sle32(wave_sizze_28623, skip_threads_28639)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28639 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28621, 32) == 0 || !ltid_in_bounds_28637)) {\n            // read operands\n            {\n                x_23618 = x_23616;\n                x_23619 = x_23617;\n                x_23616 = ((__local\n                            bool *) scan_arr_mem_28625)[sext_i32_i64(squot32(local_tid_28621,\n                                                                             32)) -\n                                                        1];\n                x_23617 = ((__local\n                            float *) scan_arr_mem_28627)[sext_i32_i64(squot32(local_tid_28621,\n                                                                              32)) -\n                                                         1];\n            }\n            // perform operation\n            {\n                bool res_23620 = x_23616 || x_23618;\n                float res_23621;\n                \n                if (x_23618) {\n                    res_23621 = x_23619;\n                } else {\n                    float res_23622 = x_23617 + x_23619;\n                    \n                    res_23621 = res_23622;\n                }\n                x_23616 = res_23620;\n                x_23617 = res_23621;\n            }\n",
                   "            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28625)[sext_i32_i64(local_tid_28621)] =\n                    x_23616;\n                ((__local\n                  float *) scan_arr_mem_28627)[sext_i32_i64(local_tid_28621)] =\n                    x_23617;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28621, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28625)[sext_i32_i64(local_tid_28621)] =\n                x_23618;\n            ((__local\n              float *) scan_arr_mem_28627)[sext_i32_i64(local_tid_28621)] =\n                x_23619;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_25435, res_23531)) {\n            ((__global bool *) mem_27823)[gtid_25435] = ((__local\n                                                          bool *) scan_arr_mem_28625)[sext_i32_i64(local_tid_28621)];\n            ((__global float *) mem_27825)[gtid_25435] = ((__local\n                                                           float *) scan_arr_mem_28627)[sext_i32_i64(local_tid_28621)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25431\n}\n__kernel void mainziscan_stage2_25488(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28682_backing_aligned_0,\n                                      int64_t res_23531, __global\n                                      unsigned char *mem_27828,\n                                      int64_t stage1_num_groups_28654,\n                                      int32_t num_threads_28655)\n{\n    #define segscan_group_sizze_25483 (mainzisegscan_group_sizze_25482)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *re",
                   "strict scan_arr_mem_28682_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28682_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28677;\n    int32_t local_tid_28678;\n    int64_t group_sizze_28681;\n    int32_t wave_sizze_28680;\n    int32_t group_tid_28679;\n    \n    global_tid_28677 = get_global_id(0);\n    local_tid_28678 = get_local_id(0);\n    group_sizze_28681 = get_local_size(0);\n    wave_sizze_28680 = LOCKSTEP_WIDTH;\n    group_tid_28679 = get_group_id(0);\n    \n    int32_t phys_tid_25488;\n    \n    phys_tid_25488 = global_tid_28677;\n    \n    __local char *scan_arr_mem_28682;\n    \n    scan_arr_mem_28682 = (__local char *) scan_arr_mem_28682_backing_0;\n    \n    int64_t flat_idx_28684;\n    \n    flat_idx_28684 = (sext_i32_i64(local_tid_28678) + 1) *\n        (segscan_group_sizze_25483 * sdiv_up64(res_23531,\n                                               sext_i32_i64(num_threads_28655))) -\n        1;\n    \n    int64_t gtid_25487;\n    \n    gtid_25487 = flat_idx_28684;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_25487, res_23531)) {\n            ((__local\n              int64_t *) scan_arr_mem_28682)[sext_i32_i64(local_tid_28678)] =\n                ((__global int64_t *) mem_27828)[gtid_25487];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_28682)[sext_i32_i64(local_tid_28678)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_23723;\n    int64_t x_23724;\n    int64_t x_28685;\n    int64_t x_28686;\n    bool ltid_in_bounds_28688;\n    \n    ltid_in_bounds_28688 = slt64(sext_i32_i64(local_tid_28678),\n                                 stage1_num_groups_28654);\n    \n    int32_t skip_threads_28689;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28688) {\n            x_23724 = ((volatile __local\n                        int64_t *) scan_arr_mem_28682)[sext_i32_i",
                   "64(local_tid_28678)];\n            if ((local_tid_28678 - squot32(local_tid_28678, 32) * 32) == 0) {\n                x_23723 = x_23724;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28689 = 1;\n        while (slt32(skip_threads_28689, 32)) {\n            if (sle32(skip_threads_28689, local_tid_28678 -\n                      squot32(local_tid_28678, 32) * 32) &&\n                ltid_in_bounds_28688) {\n                // read operands\n                {\n                    x_23723 = ((volatile __local\n                                int64_t *) scan_arr_mem_28682)[sext_i32_i64(local_tid_28678) -\n                                                               sext_i32_i64(skip_threads_28689)];\n                }\n                // perform operation\n                {\n                    int64_t res_23725 = add64(x_23723, x_23724);\n                    \n                    x_23723 = res_23725;\n                }\n            }\n            if (sle32(wave_sizze_28680, skip_threads_28689)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28689, local_tid_28678 -\n                      squot32(local_tid_28678, 32) * 32) &&\n                ltid_in_bounds_28688) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28682)[sext_i32_i64(local_tid_28678)] =\n                        x_23723;\n                    x_23724 = x_23723;\n                }\n            }\n            if (sle32(wave_sizze_28680, skip_threads_28689)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28689 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28678 - squot32(local_tid_28678, 32) * 32) == 31 &&\n            ltid_in_bounds_28688) {\n            ((volatile __local\n              int64_t *) sca",
                   "n_arr_mem_28682)[sext_i32_i64(squot32(local_tid_28678,\n                                                                  32))] =\n                x_23723;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28690;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28678, 32) == 0 && ltid_in_bounds_28688) {\n                x_28686 = ((volatile __local\n                            int64_t *) scan_arr_mem_28682)[sext_i32_i64(local_tid_28678)];\n                if ((local_tid_28678 - squot32(local_tid_28678, 32) * 32) ==\n                    0) {\n                    x_28685 = x_28686;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28690 = 1;\n            while (slt32(skip_threads_28690, 32)) {\n                if (sle32(skip_threads_28690, local_tid_28678 -\n                          squot32(local_tid_28678, 32) * 32) &&\n                    (squot32(local_tid_28678, 32) == 0 &&\n                     ltid_in_bounds_28688)) {\n                    // read operands\n                    {\n                        x_28685 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28682)[sext_i32_i64(local_tid_28678) -\n                                                                   sext_i32_i64(skip_threads_28690)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28687 = add64(x_28685, x_28686);\n                        \n                        x_28685 = res_28687;\n                    }\n                }\n                if (sle32(wave_sizze_28680, skip_threads_28690)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28690, local_tid_28678 -\n                          squot32(local_tid_28678, ",
                   "32) * 32) &&\n                    (squot32(local_tid_28678, 32) == 0 &&\n                     ltid_in_bounds_28688)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28682)[sext_i32_i64(local_tid_28678)] =\n                            x_28685;\n                        x_28686 = x_28685;\n                    }\n                }\n                if (sle32(wave_sizze_28680, skip_threads_28690)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28690 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28678, 32) == 0 || !ltid_in_bounds_28688)) {\n            // read operands\n            {\n                x_23724 = x_23723;\n                x_23723 = ((__local\n                            int64_t *) scan_arr_mem_28682)[sext_i32_i64(squot32(local_tid_28678,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_23725 = add64(x_23723, x_23724);\n                \n                x_23723 = res_23725;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_28682)[sext_i32_i64(local_tid_28678)] =\n                    x_23723;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28678, 32) == 0) {\n            ((__local\n              int64_t *) scan_arr_mem_28682)[sext_i32_i64(local_tid_28678)] =\n                x_23724;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_25487, res_23531)) {\n            ((__global int6",
                   "4_t *) mem_27828)[gtid_25487] = ((__local\n                                                             int64_t *) scan_arr_mem_28682)[sext_i32_i64(local_tid_28678)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25483\n}\n__kernel void mainziscan_stage3_25387(__global int *global_failure,\n                                      int64_t num_groups_25384,\n                                      int64_t binop_x_27752, __global\n                                      unsigned char *mem_27800,\n                                      int32_t num_threads_28215,\n                                      int32_t required_groups_28251)\n{\n    #define segscan_group_sizze_25382 (mainzisegscan_group_sizze_25381)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28252;\n    int32_t local_tid_28253;\n    int64_t group_sizze_28256;\n    int32_t wave_sizze_28255;\n    int32_t group_tid_28254;\n    \n    global_tid_28252 = get_global_id(0);\n    local_tid_28253 = get_local_id(0);\n    group_sizze_28256 = get_local_size(0);\n    wave_sizze_28255 = LOCKSTEP_WIDTH;\n    group_tid_28254 = get_group_id(0);\n    \n    int32_t phys_tid_25387;\n    \n    phys_tid_25387 = global_tid_28252;\n    \n    int32_t phys_group_id_28257;\n    \n    phys_group_id_28257 = get_group_id(0);\n    for (int32_t i_28258 = 0; i_28258 < sdiv_up32(required_groups_28251 -\n                                                  phys_group_id_28257,\n                                                  sext_i64_i32(num_groups_25384));\n         i_28258++) {\n        int32_t virt_group_id_28259 = phys_group_id_28257 + i_28258 *\n                sext_i64_i32(num_groups_25384);\n        int64_t flat_idx_28260 = sext_i32_i64(virt_group_id_28259) *\n                segscan_group_sizze_25382 + sext_i32_i64(local_tid_28253);\n        int64_t gtid_25386 = flat_idx_28260;\n        int64_t orig_group_28261 = squot64(flat_idx",
                   "_28260,\n                                           segscan_group_sizze_25382 *\n                                           sdiv_up64(binop_x_27752,\n                                                     sext_i32_i64(num_threads_28215)));\n        int64_t carry_in_flat_idx_28262 = orig_group_28261 *\n                (segscan_group_sizze_25382 * sdiv_up64(binop_x_27752,\n                                                       sext_i32_i64(num_threads_28215))) -\n                1;\n        \n        if (slt64(gtid_25386, binop_x_27752)) {\n            if (!(orig_group_28261 == 0 || flat_idx_28260 == (orig_group_28261 +\n                                                              1) *\n                  (segscan_group_sizze_25382 * sdiv_up64(binop_x_27752,\n                                                         sext_i32_i64(num_threads_28215))) -\n                  1)) {\n                int64_t x_23515;\n                int64_t x_23516;\n                \n                x_23515 = ((__global\n                            int64_t *) mem_27800)[carry_in_flat_idx_28262];\n                x_23516 = ((__global int64_t *) mem_27800)[gtid_25386];\n                \n                int64_t res_23517;\n                \n                res_23517 = add64(x_23515, x_23516);\n                x_23515 = res_23517;\n                ((__global int64_t *) mem_27800)[gtid_25386] = x_23515;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25382\n}\n__kernel void mainziscan_stage3_25420(__global int *global_failure,\n                                      int64_t res_23531,\n                                      int64_t num_groups_25417, __global\n                                      unsigned char *mem_27811, __global\n                                      unsigned char *mem_27813,\n                                      int32_t num_threads_28454,\n                                      int32_t required_groups_28506)\n{\n  ",
                   "  #define segscan_group_sizze_25415 (mainzisegscan_group_sizze_25414)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28507;\n    int32_t local_tid_28508;\n    int64_t group_sizze_28511;\n    int32_t wave_sizze_28510;\n    int32_t group_tid_28509;\n    \n    global_tid_28507 = get_global_id(0);\n    local_tid_28508 = get_local_id(0);\n    group_sizze_28511 = get_local_size(0);\n    wave_sizze_28510 = LOCKSTEP_WIDTH;\n    group_tid_28509 = get_group_id(0);\n    \n    int32_t phys_tid_25420;\n    \n    phys_tid_25420 = global_tid_28507;\n    \n    int32_t phys_group_id_28512;\n    \n    phys_group_id_28512 = get_group_id(0);\n    for (int32_t i_28513 = 0; i_28513 < sdiv_up32(required_groups_28506 -\n                                                  phys_group_id_28512,\n                                                  sext_i64_i32(num_groups_25417));\n         i_28513++) {\n        int32_t virt_group_id_28514 = phys_group_id_28512 + i_28513 *\n                sext_i64_i32(num_groups_25417);\n        int64_t flat_idx_28515 = sext_i32_i64(virt_group_id_28514) *\n                segscan_group_sizze_25415 + sext_i32_i64(local_tid_28508);\n        int64_t gtid_25419 = flat_idx_28515;\n        int64_t orig_group_28516 = squot64(flat_idx_28515,\n                                           segscan_group_sizze_25415 *\n                                           sdiv_up64(res_23531,\n                                                     sext_i32_i64(num_threads_28454)));\n        int64_t carry_in_flat_idx_28517 = orig_group_28516 *\n                (segscan_group_sizze_25415 * sdiv_up64(res_23531,\n                                                       sext_i32_i64(num_threads_28454))) -\n                1;\n        \n        if (slt64(gtid_25419, res_23531)) {\n            if (!(orig_group_28516 == 0 || flat_idx_28515 == (orig_group_28516 +\n                                                   ",
                   "           1) *\n                  (segscan_group_sizze_25415 * sdiv_up64(res_23531,\n                                                         sext_i32_i64(num_threads_28454))) -\n                  1)) {\n                bool x_23550;\n                int64_t x_23551;\n                bool x_23552;\n                int64_t x_23553;\n                \n                x_23550 = ((__global\n                            bool *) mem_27811)[carry_in_flat_idx_28517];\n                x_23551 = ((__global\n                            int64_t *) mem_27813)[carry_in_flat_idx_28517];\n                x_23552 = ((__global bool *) mem_27811)[gtid_25419];\n                x_23553 = ((__global int64_t *) mem_27813)[gtid_25419];\n                \n                bool res_23554;\n                \n                res_23554 = x_23550 || x_23552;\n                \n                int64_t res_23555;\n                \n                if (x_23552) {\n                    res_23555 = x_23553;\n                } else {\n                    int64_t res_23556 = add64(x_23551, x_23553);\n                    \n                    res_23555 = res_23556;\n                }\n                x_23550 = res_23554;\n                x_23551 = res_23555;\n                ((__global bool *) mem_27811)[gtid_25419] = x_23550;\n                ((__global int64_t *) mem_27813)[gtid_25419] = x_23551;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25415\n}\n__kernel void mainziscan_stage3_25428(__global int *global_failure,\n                                      int64_t res_23531,\n                                      int64_t num_groups_25425, __global\n                                      unsigned char *mem_27816, __global\n                                      unsigned char *mem_27818,\n                                      int32_t num_threads_28521,\n                                      int32_t required_groups_28573)\n{\n    #define segscan_g",
                   "roup_sizze_25423 (mainzisegscan_group_sizze_25422)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28574;\n    int32_t local_tid_28575;\n    int64_t group_sizze_28578;\n    int32_t wave_sizze_28577;\n    int32_t group_tid_28576;\n    \n    global_tid_28574 = get_global_id(0);\n    local_tid_28575 = get_local_id(0);\n    group_sizze_28578 = get_local_size(0);\n    wave_sizze_28577 = LOCKSTEP_WIDTH;\n    group_tid_28576 = get_group_id(0);\n    \n    int32_t phys_tid_25428;\n    \n    phys_tid_25428 = global_tid_28574;\n    \n    int32_t phys_group_id_28579;\n    \n    phys_group_id_28579 = get_group_id(0);\n    for (int32_t i_28580 = 0; i_28580 < sdiv_up32(required_groups_28573 -\n                                                  phys_group_id_28579,\n                                                  sext_i64_i32(num_groups_25425));\n         i_28580++) {\n        int32_t virt_group_id_28581 = phys_group_id_28579 + i_28580 *\n                sext_i64_i32(num_groups_25425);\n        int64_t flat_idx_28582 = sext_i32_i64(virt_group_id_28581) *\n                segscan_group_sizze_25423 + sext_i32_i64(local_tid_28575);\n        int64_t gtid_25427 = flat_idx_28582;\n        int64_t orig_group_28583 = squot64(flat_idx_28582,\n                                           segscan_group_sizze_25423 *\n                                           sdiv_up64(res_23531,\n                                                     sext_i32_i64(num_threads_28521)));\n        int64_t carry_in_flat_idx_28584 = orig_group_28583 *\n                (segscan_group_sizze_25423 * sdiv_up64(res_23531,\n                                                       sext_i32_i64(num_threads_28521))) -\n                1;\n        \n        if (slt64(gtid_25427, res_23531)) {\n            if (!(orig_group_28583 == 0 || flat_idx_28582 == (orig_group_28583 +\n                                                              1) *\n   ",
                   "               (segscan_group_sizze_25423 * sdiv_up64(res_23531,\n                                                         sext_i32_i64(num_threads_28521))) -\n                  1)) {\n                bool x_23590;\n                int64_t x_23591;\n                bool x_23592;\n                int64_t x_23593;\n                \n                x_23590 = ((__global\n                            bool *) mem_27816)[carry_in_flat_idx_28584];\n                x_23591 = ((__global\n                            int64_t *) mem_27818)[carry_in_flat_idx_28584];\n                x_23592 = ((__global bool *) mem_27816)[gtid_25427];\n                x_23593 = ((__global int64_t *) mem_27818)[gtid_25427];\n                \n                bool res_23594;\n                \n                res_23594 = x_23590 || x_23592;\n                \n                int64_t res_23595;\n                \n                if (x_23592) {\n                    res_23595 = x_23593;\n                } else {\n                    int64_t res_23596 = add64(x_23591, x_23593);\n                    \n                    res_23595 = res_23596;\n                }\n                x_23590 = res_23594;\n                x_23591 = res_23595;\n                ((__global bool *) mem_27816)[gtid_25427] = x_23590;\n                ((__global int64_t *) mem_27818)[gtid_25427] = x_23591;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25423\n}\n__kernel void mainziscan_stage3_25436(__global int *global_failure,\n                                      int64_t res_23531,\n                                      int64_t num_groups_25433, __global\n                                      unsigned char *mem_27823, __global\n                                      unsigned char *mem_27825,\n                                      int32_t num_threads_28588,\n                                      int32_t required_groups_28640)\n{\n    #define segscan_group_sizze_25431 (m",
                   "ainzisegscan_group_sizze_25430)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28641;\n    int32_t local_tid_28642;\n    int64_t group_sizze_28645;\n    int32_t wave_sizze_28644;\n    int32_t group_tid_28643;\n    \n    global_tid_28641 = get_global_id(0);\n    local_tid_28642 = get_local_id(0);\n    group_sizze_28645 = get_local_size(0);\n    wave_sizze_28644 = LOCKSTEP_WIDTH;\n    group_tid_28643 = get_group_id(0);\n    \n    int32_t phys_tid_25436;\n    \n    phys_tid_25436 = global_tid_28641;\n    \n    int32_t phys_group_id_28646;\n    \n    phys_group_id_28646 = get_group_id(0);\n    for (int32_t i_28647 = 0; i_28647 < sdiv_up32(required_groups_28640 -\n                                                  phys_group_id_28646,\n                                                  sext_i64_i32(num_groups_25433));\n         i_28647++) {\n        int32_t virt_group_id_28648 = phys_group_id_28646 + i_28647 *\n                sext_i64_i32(num_groups_25433);\n        int64_t flat_idx_28649 = sext_i32_i64(virt_group_id_28648) *\n                segscan_group_sizze_25431 + sext_i32_i64(local_tid_28642);\n        int64_t gtid_25435 = flat_idx_28649;\n        int64_t orig_group_28650 = squot64(flat_idx_28649,\n                                           segscan_group_sizze_25431 *\n                                           sdiv_up64(res_23531,\n                                                     sext_i32_i64(num_threads_28588)));\n        int64_t carry_in_flat_idx_28651 = orig_group_28650 *\n                (segscan_group_sizze_25431 * sdiv_up64(res_23531,\n                                                       sext_i32_i64(num_threads_28588))) -\n                1;\n        \n        if (slt64(gtid_25435, res_23531)) {\n            if (!(orig_group_28650 == 0 || flat_idx_28649 == (orig_group_28650 +\n                                                              1) *\n                  (seg",
                   "scan_group_sizze_25431 * sdiv_up64(res_23531,\n                                                         sext_i32_i64(num_threads_28588))) -\n                  1)) {\n                bool x_23616;\n                float x_23617;\n                bool x_23618;\n                float x_23619;\n                \n                x_23616 = ((__global\n                            bool *) mem_27823)[carry_in_flat_idx_28651];\n                x_23617 = ((__global\n                            float *) mem_27825)[carry_in_flat_idx_28651];\n                x_23618 = ((__global bool *) mem_27823)[gtid_25435];\n                x_23619 = ((__global float *) mem_27825)[gtid_25435];\n                \n                bool res_23620;\n                \n                res_23620 = x_23616 || x_23618;\n                \n                float res_23621;\n                \n                if (x_23618) {\n                    res_23621 = x_23619;\n                } else {\n                    float res_23622 = x_23617 + x_23619;\n                    \n                    res_23621 = res_23622;\n                }\n                x_23616 = res_23620;\n                x_23617 = res_23621;\n                ((__global bool *) mem_27823)[gtid_25435] = x_23616;\n                ((__global float *) mem_27825)[gtid_25435] = x_23617;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25431\n}\n__kernel void mainziscan_stage3_25488(__global int *global_failure,\n                                      int64_t res_23531,\n                                      int64_t num_groups_25485, __global\n                                      unsigned char *mem_27828,\n                                      int32_t num_threads_28655,\n                                      int32_t required_groups_28691)\n{\n    #define segscan_group_sizze_25483 (mainzisegscan_group_sizze_25482)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int b",
                   "lock_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28692;\n    int32_t local_tid_28693;\n    int64_t group_sizze_28696;\n    int32_t wave_sizze_28695;\n    int32_t group_tid_28694;\n    \n    global_tid_28692 = get_global_id(0);\n    local_tid_28693 = get_local_id(0);\n    group_sizze_28696 = get_local_size(0);\n    wave_sizze_28695 = LOCKSTEP_WIDTH;\n    group_tid_28694 = get_group_id(0);\n    \n    int32_t phys_tid_25488;\n    \n    phys_tid_25488 = global_tid_28692;\n    \n    int32_t phys_group_id_28697;\n    \n    phys_group_id_28697 = get_group_id(0);\n    for (int32_t i_28698 = 0; i_28698 < sdiv_up32(required_groups_28691 -\n                                                  phys_group_id_28697,\n                                                  sext_i64_i32(num_groups_25485));\n         i_28698++) {\n        int32_t virt_group_id_28699 = phys_group_id_28697 + i_28698 *\n                sext_i64_i32(num_groups_25485);\n        int64_t flat_idx_28700 = sext_i32_i64(virt_group_id_28699) *\n                segscan_group_sizze_25483 + sext_i32_i64(local_tid_28693);\n        int64_t gtid_25487 = flat_idx_28700;\n        int64_t orig_group_28701 = squot64(flat_idx_28700,\n                                           segscan_group_sizze_25483 *\n                                           sdiv_up64(res_23531,\n                                                     sext_i32_i64(num_threads_28655)));\n        int64_t carry_in_flat_idx_28702 = orig_group_28701 *\n                (segscan_group_sizze_25483 * sdiv_up64(res_23531,\n                                                       sext_i32_i64(num_threads_28655))) -\n                1;\n        \n        if (slt64(gtid_25487, res_23531)) {\n            if (!(orig_group_28701 == 0 || flat_idx_28700 == (orig_group_28701 +\n                                                              1) *\n                  (segscan_group_sizze_25483 * sdiv_up64(res_23531,\n                                                         sext_i32_",
                   "i64(num_threads_28655))) -\n                  1)) {\n                int64_t x_23723;\n                int64_t x_23724;\n                \n                x_23723 = ((__global\n                            int64_t *) mem_27828)[carry_in_flat_idx_28702];\n                x_23724 = ((__global int64_t *) mem_27828)[gtid_25487];\n                \n                int64_t res_23725;\n                \n                res_23725 = add64(x_23723, x_23724);\n                x_23723 = res_23725;\n                ((__global int64_t *) mem_27828)[gtid_25487] = x_23723;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_25483\n}\n__kernel void mainziseghist_global_25405(__global int *global_failure,\n                                         int64_t res_23531,\n                                         int64_t num_groups_25402,\n                                         int64_t binop_x_27752, __global\n                                         unsigned char *mem_27800,\n                                         int32_t num_subhistos_28304, __global\n                                         unsigned char *res_subhistos_mem_28305,\n                                         __global\n                                         unsigned char *mainzihist_locks_mem_28375,\n                                         int32_t chk_i_28377,\n                                         int64_t hist_H_chk_28378)\n{\n    #define seghist_group_sizze_25400 (mainziseghist_group_sizze_25399)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28379;\n    int32_t local_tid_28380;\n    int64_t group_sizze_28383;\n    int32_t wave_sizze_28382;\n    int32_t group_tid_28381;\n    \n    global_tid_28379 = get_global_id(0);\n    local_tid_28380 = get_local_id(0);\n    group_sizze_28383 = get_local_size(0);\n    wave_sizze_28382 = LOCKST",
                   "EP_WIDTH;\n    group_tid_28381 = get_group_id(0);\n    \n    int32_t phys_tid_25405;\n    \n    phys_tid_25405 = global_tid_28379;\n    \n    int32_t subhisto_ind_28384;\n    \n    subhisto_ind_28384 = squot32(global_tid_28379,\n                                 sdiv_up32(sext_i64_i32(seghist_group_sizze_25400 *\n                                           num_groups_25402),\n                                           num_subhistos_28304));\n    for (int64_t i_28385 = 0; i_28385 < sdiv_up64(binop_x_27752 -\n                                                  sext_i32_i64(global_tid_28379),\n                                                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_25400 *\n                                                  num_groups_25402)));\n         i_28385++) {\n        int32_t gtid_25404 = sext_i64_i32(i_28385 *\n                sext_i32_i64(sext_i64_i32(seghist_group_sizze_25400 *\n                num_groups_25402)) + sext_i32_i64(global_tid_28379));\n        \n        if (slt64(i_28385 *\n                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_25400 *\n                  num_groups_25402)) + sext_i32_i64(global_tid_28379),\n                  binop_x_27752)) {\n            int64_t i_p_o_27572 = add64(-1, gtid_25404);\n            int64_t rot_i_27573 = smod64(i_p_o_27572, binop_x_27752);\n            bool cond_25411 = gtid_25404 == 0;\n            int64_t res_25412;\n            \n            if (cond_25411) {\n                res_25412 = 0;\n            } else {\n                int64_t x_25410 = ((__global int64_t *) mem_27800)[rot_i_27573];\n                \n                res_25412 = x_25410;\n            }\n            // save map-out results\n            { }\n            // perform atomic updates\n            {\n                if (sle64(sext_i32_i64(chk_i_28377) * hist_H_chk_28378,\n                          res_25412) && (slt64(res_25412,\n                                               sext_i32_i64(chk_i_28377) *\n                                               hist_H_chk_",
                   "28378 +\n                                               hist_H_chk_28378) &&\n                                         slt64(res_25412, res_23531))) {\n                    int64_t x_25406;\n                    int64_t x_25407;\n                    \n                    x_25407 = gtid_25404;\n                    \n                    int32_t old_28386;\n                    volatile bool continue_28387;\n                    \n                    continue_28387 = 1;\n                    while (continue_28387) {\n                        old_28386 =\n                            atomic_cmpxchg_i32_global(&((volatile __global\n                                                         int *) mainzihist_locks_mem_28375)[srem64(sext_i32_i64(subhisto_ind_28384) *\n                                                                                                   res_23531 +\n                                                                                                   res_25412,\n                                                                                                   100151)],\n                                                      0, 1);\n                        if (old_28386 == 0) {\n                            int64_t x_25406;\n                            \n                            // bind lhs\n                            {\n                                x_25406 = ((volatile __global\n                                            int64_t *) res_subhistos_mem_28305)[sext_i32_i64(subhisto_ind_28384) *\n                                                                                res_23531 +\n                                                                                res_25412];\n                            }\n                            // execute operation\n                            {\n                                int64_t res_25408 = smax64(x_25406, x_25407);\n                                \n                                x_25406 = res_25408;\n                            }\n        ",
                   "                    // update global result\n                            {\n                                ((volatile __global\n                                  int64_t *) res_subhistos_mem_28305)[sext_i32_i64(subhisto_ind_28384) *\n                                                                      res_23531 +\n                                                                      res_25412] =\n                                    x_25406;\n                            }\n                            mem_fence_global();\n                            old_28386 =\n                                atomic_cmpxchg_i32_global(&((volatile __global\n                                                             int *) mainzihist_locks_mem_28375)[srem64(sext_i32_i64(subhisto_ind_28384) *\n                                                                                                       res_23531 +\n                                                                                                       res_25412,\n                                                                                                       100151)],\n                                                          1, 0);\n                            continue_28387 = 0;\n                        }\n                        mem_fence_global();\n                    }\n                }\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef seghist_group_sizze_25400\n}\n__kernel void mainziseghist_local_25405(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *locks_mem_28345_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *subhistogram_local_mem_28343_backing_aligned_1,\n                                        int64_t res_23531,\n                                        int64_t binop_x_27752, __global\n                                        unsigned char *mem_27800, ",
                   "__global\n                                        unsigned char *res_subhistos_mem_28305,\n                                        int32_t max_group_sizze_28314,\n                                        int64_t num_groups_28315,\n                                        int32_t hist_M_28321,\n                                        int32_t chk_i_28326,\n                                        int64_t num_segments_28327,\n                                        int64_t hist_H_chk_28328,\n                                        int64_t histo_sizze_28329,\n                                        int32_t init_per_thread_28330)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict locks_mem_28345_backing_1 =\n                          (__local volatile\n                           char *) locks_mem_28345_backing_aligned_0;\n    __local volatile char *restrict subhistogram_local_mem_28343_backing_0 =\n                          (__local volatile\n                           char *) subhistogram_local_mem_28343_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28331;\n    int32_t local_tid_28332;\n    int64_t group_sizze_28335;\n    int32_t wave_sizze_28334;\n    int32_t group_tid_28333;\n    \n    global_tid_28331 = get_global_id(0);\n    local_tid_28332 = get_local_id(0);\n    group_sizze_28335 = get_local_size(0);\n    wave_sizze_28334 = LOCKSTEP_WIDTH;\n    group_tid_28333 = get_group_id(0);\n    \n    int32_t phys_tid_25405;\n    \n    phys_tid_25405 = global_tid_28331;\n    \n    int32_t phys_group_id_28336;\n    \n    phys_group_id_28336 = get_group_id(0);\n    for (int32_t i_28337 = 0; i_28337 <\n         sdiv_up32(sext_i64_i32(num_groups_28315 * num_segments_28327) -\n                   phys_group_id_28336, sext_i64_i32(num_groups_28315));\n         i_28337++) {\n        int32_t virt_group_id_28338 = phys_group_id_28336 + i_28337 *\n                sext_i64_i32(num_groups_28315);\n     ",
                   "   int32_t flat_segment_id_28339 = squot32(virt_group_id_28338,\n                                                sext_i64_i32(num_groups_28315));\n        int32_t gid_in_segment_28340 = srem32(virt_group_id_28338,\n                                              sext_i64_i32(num_groups_28315));\n        int32_t pgtid_in_segment_28341 = gid_in_segment_28340 *\n                sext_i64_i32(max_group_sizze_28314) + local_tid_28332;\n        int32_t threads_per_segment_28342 = sext_i64_i32(num_groups_28315 *\n                max_group_sizze_28314);\n        __local char *subhistogram_local_mem_28343;\n        \n        subhistogram_local_mem_28343 = (__local\n                                        char *) subhistogram_local_mem_28343_backing_0;\n        \n        __local char *locks_mem_28345;\n        \n        locks_mem_28345 = (__local char *) locks_mem_28345_backing_1;\n        // All locks start out unlocked\n        {\n            for (int64_t i_28347 = 0; i_28347 < sdiv_up64(hist_M_28321 *\n                                                          hist_H_chk_28328 -\n                                                          sext_i32_i64(local_tid_28332),\n                                                          max_group_sizze_28314);\n                 i_28347++) {\n                ((__local int32_t *) locks_mem_28345)[squot64(i_28347 *\n                                                              max_group_sizze_28314 +\n                                                              sext_i32_i64(local_tid_28332),\n                                                              hist_H_chk_28328) *\n                                                      hist_H_chk_28328 +\n                                                      (i_28347 *\n                                                       max_group_sizze_28314 +\n                                                       sext_i32_i64(local_tid_28332) -\n                                                       squot64(i_28347 *\n                       ",
                   "                                        max_group_sizze_28314 +\n                                                               sext_i32_i64(local_tid_28332),\n                                                               hist_H_chk_28328) *\n                                                       hist_H_chk_28328)] = 0;\n            }\n        }\n        \n        int32_t thread_local_subhisto_i_28348;\n        \n        thread_local_subhisto_i_28348 = srem32(local_tid_28332, hist_M_28321);\n        // initialize histograms in local memory\n        {\n            for (int32_t local_i_28349 = 0; local_i_28349 <\n                 init_per_thread_28330; local_i_28349++) {\n                int32_t j_28350 = local_i_28349 *\n                        sext_i64_i32(max_group_sizze_28314) + local_tid_28332;\n                int32_t j_offset_28351 = hist_M_28321 *\n                        sext_i64_i32(histo_sizze_28329) * gid_in_segment_28340 +\n                        j_28350;\n                int32_t local_subhisto_i_28352 = squot32(j_28350,\n                                                         sext_i64_i32(histo_sizze_28329));\n                int32_t global_subhisto_i_28353 = squot32(j_offset_28351,\n                                                          sext_i64_i32(histo_sizze_28329));\n                \n                if (slt32(j_28350, hist_M_28321 *\n                          sext_i64_i32(histo_sizze_28329))) {\n                    // First subhistogram is initialised from global memory; others with neutral element.\n                    {\n                        if (global_subhisto_i_28353 == 0) {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_28343)[sext_i32_i64(local_subhisto_i_28352) *\n                                                                       hist_H_chk_28328 +\n                                                                       sext_i32_i64(srem32(j_28350,\n                                                         ",
                   "                                  sext_i64_i32(histo_sizze_28329)))] =\n                                ((__global\n                                  int64_t *) res_subhistos_mem_28305)[sext_i32_i64(srem32(j_28350,\n                                                                                          sext_i64_i32(histo_sizze_28329))) +\n                                                                      sext_i32_i64(chk_i_28326) *\n                                                                      hist_H_chk_28328];\n                        } else {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_28343)[sext_i32_i64(local_subhisto_i_28352) *\n                                                                       hist_H_chk_28328 +\n                                                                       sext_i32_i64(srem32(j_28350,\n                                                                                           sext_i64_i32(histo_sizze_28329)))] =\n                                0;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_28354 = 0; i_28354 <\n             sdiv_up32(sext_i64_i32(binop_x_27752) - pgtid_in_segment_28341,\n                       threads_per_segment_28342); i_28354++) {\n            int32_t gtid_25404 = i_28354 * threads_per_segment_28342 +\n                    pgtid_in_segment_28341;\n            int64_t i_p_o_27572 = add64(-1, gtid_25404);\n            int64_t rot_i_27573 = smod64(i_p_o_27572, binop_x_27752);\n            bool cond_25411 = gtid_25404 == 0;\n            int64_t res_25412;\n            \n            if (cond_25411) {\n                res_25412 = 0;\n            } else {\n                int64_t x_25410 = ((__global int64_t *) mem_27800)[rot_i_27573];\n                \n                res_25412 = x_25410;\n            }\n            if (chk_i_28326 == 0) {\n                // save map",
                   "-out results\n                { }\n            }\n            // perform atomic updates\n            {\n                if (slt64(res_25412, res_23531) &&\n                    (sle64(sext_i32_i64(chk_i_28326) * hist_H_chk_28328,\n                           res_25412) && slt64(res_25412,\n                                               sext_i32_i64(chk_i_28326) *\n                                               hist_H_chk_28328 +\n                                               hist_H_chk_28328))) {\n                    int64_t x_25406;\n                    int64_t x_25407;\n                    \n                    x_25407 = gtid_25404;\n                    \n                    int32_t old_28355;\n                    volatile bool continue_28356;\n                    \n                    continue_28356 = 1;\n                    while (continue_28356) {\n                        old_28355 = atomic_cmpxchg_i32_local(&((volatile __local\n                                                                int *) locks_mem_28345)[sext_i32_i64(thread_local_subhisto_i_28348) *\n                                                                                        hist_H_chk_28328 +\n                                                                                        (res_25412 -\n                                                                                         sext_i32_i64(chk_i_28326) *\n                                                                                         hist_H_chk_28328)],\n                                                             0, 1);\n                        if (old_28355 == 0) {\n                            int64_t x_25406;\n                            \n                            // bind lhs\n                            {\n                                x_25406 = ((volatile __local\n                                            int64_t *) subhistogram_local_mem_28343)[sext_i32_i64(thread_local_subhisto_i_28348) *\n                                                         ",
                   "                            hist_H_chk_28328 +\n                                                                                     (res_25412 -\n                                                                                      sext_i32_i64(chk_i_28326) *\n                                                                                      hist_H_chk_28328)];\n                            }\n                            // execute operation\n                            {\n                                int64_t res_25408 = smax64(x_25406, x_25407);\n                                \n                                x_25406 = res_25408;\n                            }\n                            // update global result\n                            {\n                                ((volatile __local\n                                  int64_t *) subhistogram_local_mem_28343)[sext_i32_i64(thread_local_subhisto_i_28348) *\n                                                                           hist_H_chk_28328 +\n                                                                           (res_25412 -\n                                                                            sext_i32_i64(chk_i_28326) *\n                                                                            hist_H_chk_28328)] =\n                                    x_25406;\n                            }\n                            mem_fence_local();\n                            old_28355 =\n                                atomic_cmpxchg_i32_local(&((volatile __local\n                                                            int *) locks_mem_28345)[sext_i32_i64(thread_local_subhisto_i_28348) *\n                                                                                    hist_H_chk_28328 +\n                                                                                    (res_25412 -\n                                                                                     sext_i32_i64(chk_i_28326) *\n             ",
                   "                                                                        hist_H_chk_28328)],\n                                                         1, 0);\n                            continue_28356 = 0;\n                        }\n                        mem_fence_local();\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Compact the multiple local memory subhistograms to result in global memory\n        {\n            int64_t trunc_H_28357 = smin64(hist_H_chk_28328, res_23531 -\n                                           sext_i32_i64(chk_i_28326) *\n                                           hist_H_chk_28328);\n            int32_t histo_sizze_28358 = sext_i64_i32(trunc_H_28357);\n            \n            for (int32_t local_i_28359 = 0; local_i_28359 <\n                 init_per_thread_28330; local_i_28359++) {\n                int32_t j_28360 = local_i_28359 *\n                        sext_i64_i32(max_group_sizze_28314) + local_tid_28332;\n                \n                if (slt32(j_28360, histo_sizze_28358)) {\n                    int64_t x_25406;\n                    int64_t x_25407;\n                    \n                    // Read values from subhistogram 0.\n                    {\n                        x_25406 = ((__local\n                                    int64_t *) subhistogram_local_mem_28343)[sext_i32_i64(j_28360)];\n                    }\n                    // Accumulate based on values in other subhistograms.\n                    {\n                        for (int32_t subhisto_id_28361 = 0; subhisto_id_28361 <\n                             hist_M_28321 - 1; subhisto_id_28361++) {\n                            x_25407 = ((__local\n                                        int64_t *) subhistogram_local_mem_28343)[(sext_i32_i64(subhisto_id_28361) +\n                                                                                  1) *\n                                                                                 h",
                   "ist_H_chk_28328 +\n                                                                                 sext_i32_i64(j_28360)];\n                            \n                            int64_t res_25408;\n                            \n                            res_25408 = smax64(x_25406, x_25407);\n                            x_25406 = res_25408;\n                        }\n                    }\n                    // Put final bucket value in global memory.\n                    {\n                        ((__global\n                          int64_t *) res_subhistos_mem_28305)[srem64(sext_i32_i64(virt_group_id_28338),\n                                                                     num_groups_28315) *\n                                                              res_23531 +\n                                                              (sext_i32_i64(j_28360) +\n                                                               sext_i32_i64(chk_i_28326) *\n                                                               hist_H_chk_28328)] =\n                            x_25406;\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\n__kernel void mainzisegmap_24282(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, int64_t n_23312,\n                                 float a_23320, float r0_23323, float x_23340,\n                                 float x_23342, float y_23344, float y_23345,\n                                 __global unsigned char *swap_term_mem_27668,\n                                 __global unsigned char *payments_mem_27669,\n                                 __global unsigned char *mem_27682, __global\n                                 unsigned char *mem_27696,\n                                 int64_t num_threads_27888)\n{\n    #define segmap_group_sizze_24360 (ma",
                   "inzisegmap_group_sizze_24284)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28122;\n    int32_t local_tid_28123;\n    int64_t group_sizze_28126;\n    int32_t wave_sizze_28125;\n    int32_t group_tid_28124;\n    \n    global_tid_28122 = get_global_id(0);\n    local_tid_28123 = get_local_id(0);\n    group_sizze_28126 = get_local_size(0);\n    wave_sizze_28125 = LOCKSTEP_WIDTH;\n    group_tid_28124 = get_group_id(0);\n    \n    int32_t phys_tid_24282;\n    \n    phys_tid_24282 = global_tid_28122;\n    \n    int64_t gtid_24281;\n    \n    gtid_24281 = sext_i32_i64(group_tid_28124) * segmap_group_sizze_24360 +\n        sext_i32_i64(local_tid_28123);\n    if (slt64(gtid_24281, n_23312)) {\n        float res_24371 = ((__global float *) swap_term_mem_27668)[gtid_24281];\n        int64_t res_24372 = ((__global\n                              int64_t *) payments_mem_27669)[gtid_24281];\n        int64_t range_end_24374 = sub64(res_24372, 1);\n        bool bounds_invalid_upwards_24375 = slt64(range_end_24374, 0);\n        bool valid_24376 = !bounds_invalid_upwards_24375;\n        bool range_valid_c_24377;\n        \n        if (!valid_24376) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 0) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = 1;\n                    global_failure_args[2] = range_end_24374;\n                    ;\n                }\n                return;\n            }\n        }\n        for (int64_t i_27635 = 0; i_27635 < res_24372; i_27635++) {\n            float res_24381 = sitofp_i64_f32(i_27635);\n            float res_24382 = res_24371 * res_24381;\n            \n            ((__global float *) mem_27682)[phys_tid_24282 + i_27635 *\n                                           num_threads_27888] = res_24382;\n        }\n        \n        bool y_24383 = slt64(0, res_24372);\n        bool inde",
                   "x_certs_24384;\n        \n        if (!y_24383) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 1) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_24372;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_24385 = sitofp_i64_f32(range_end_24374);\n        float index_primexp_24386 = res_24371 * binop_y_24385;\n        float negate_arg_24387 = a_23320 * index_primexp_24386;\n        float exp_arg_24388 = 0.0F - negate_arg_24387;\n        float res_24389 = fpow32(2.7182817F, exp_arg_24388);\n        float x_24390 = 1.0F - res_24389;\n        float B_24391 = x_24390 / a_23320;\n        float x_24392 = B_24391 - index_primexp_24386;\n        float x_24393 = y_23344 * x_24392;\n        float A1_24394 = x_24393 / x_23340;\n        float y_24395 = fpow32(B_24391, 2.0F);\n        float x_24396 = x_23342 * y_24395;\n        float A2_24397 = x_24396 / y_23345;\n        float exp_arg_24398 = A1_24394 - A2_24397;\n        float res_24399 = fpow32(2.7182817F, exp_arg_24398);\n        float negate_arg_24400 = r0_23323 * B_24391;\n        float exp_arg_24401 = 0.0F - negate_arg_24400;\n        float res_24402 = fpow32(2.7182817F, exp_arg_24401);\n        float res_24403 = res_24399 * res_24402;\n        bool empty_slice_24404 = range_end_24374 == 0;\n        bool zzero_leq_i_p_m_t_s_24405 = sle64(0, range_end_24374);\n        bool i_p_m_t_s_leq_w_24406 = slt64(range_end_24374, res_24372);\n        bool i_lte_j_24407 = sle64(1, res_24372);\n        bool y_24408 = zzero_leq_i_p_m_t_s_24405 && i_p_m_t_s_leq_w_24406;\n        bool y_24409 = i_lte_j_24407 && y_24408;\n        bool ok_or_empty_24410 = empty_slice_24404 || y_24409;\n        bool index_certs_24411;\n        \n        if (!ok_or_empty_24410) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 2) == -1) {\n                    global_failure_args[0] = 1;\n               ",
                   "     global_failure_args[1] = res_24372;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float res_24413;\n        float redout_27637 = 0.0F;\n        \n        for (int64_t i_27638 = 0; i_27638 < range_end_24374; i_27638++) {\n            int64_t slice_27659 = 1 + i_27638;\n            float x_24417 = ((__global float *) mem_27682)[phys_tid_24282 +\n                                                           slice_27659 *\n                                                           num_threads_27888];\n            float negate_arg_24418 = a_23320 * x_24417;\n            float exp_arg_24419 = 0.0F - negate_arg_24418;\n            float res_24420 = fpow32(2.7182817F, exp_arg_24419);\n            float x_24421 = 1.0F - res_24420;\n            float B_24422 = x_24421 / a_23320;\n            float x_24423 = B_24422 - x_24417;\n            float x_24424 = y_23344 * x_24423;\n            float A1_24425 = x_24424 / x_23340;\n            float y_24426 = fpow32(B_24422, 2.0F);\n            float x_24427 = x_23342 * y_24426;\n            float A2_24428 = x_24427 / y_23345;\n            float exp_arg_24429 = A1_24425 - A2_24428;\n            float res_24430 = fpow32(2.7182817F, exp_arg_24429);\n            float negate_arg_24431 = r0_23323 * B_24422;\n            float exp_arg_24432 = 0.0F - negate_arg_24431;\n            float res_24433 = fpow32(2.7182817F, exp_arg_24432);\n            float res_24434 = res_24430 * res_24433;\n            float res_24416 = res_24434 + redout_27637;\n            float redout_tmp_28128 = res_24416;\n            \n            redout_27637 = redout_tmp_28128;\n        }\n        res_24413 = redout_27637;\n        \n        float x_24435 = 1.0F - res_24403;\n        float y_24436 = res_24371 * res_24413;\n        float res_24437 = x_24435 / y_24436;\n        \n        ((__global float *) mem_27696)[gtid_24281] = res_24437;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_24360\n}\n__kernel void mainzisegmap_24458(__",
                   "global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, int64_t n_23312,\n                                 float a_23320, float r0_23323, float x_23340,\n                                 float x_23342, float y_23344, float y_23345,\n                                 __global unsigned char *swap_term_mem_27668,\n                                 __global unsigned char *payments_mem_27669,\n                                 __global unsigned char *mem_27705, __global\n                                 unsigned char *mem_27719,\n                                 int64_t num_threads_27920)\n{\n    #define segmap_group_sizze_24536 (mainzisegmap_group_sizze_24460)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28159;\n    int32_t local_tid_28160;\n    int64_t group_sizze_28163;\n    int32_t wave_sizze_28162;\n    int32_t group_tid_28161;\n    \n    global_tid_28159 = get_global_id(0);\n    local_tid_28160 = get_local_id(0);\n    group_sizze_28163 = get_local_size(0);\n    wave_sizze_28162 = LOCKSTEP_WIDTH;\n    group_tid_28161 = get_group_id(0);\n    \n    int32_t phys_tid_24458;\n    \n    phys_tid_24458 = global_tid_28159;\n    \n    int64_t gtid_24457;\n    \n    gtid_24457 = sext_i32_i64(group_tid_28161) * segmap_group_sizze_24536 +\n        sext_i32_i64(local_tid_28160);\n    if (slt64(gtid_24457, n_23312)) {\n        float res_24547 = ((__global float *) swap_term_mem_27668)[gtid_24457];\n        int64_t res_24548 = ((__global\n                              int64_t *) payments_mem_27669)[gtid_24457];\n        int64_t range_end_24550 = sub64(res_24548, 1);\n        bool bounds_invalid_upwards_24551 = slt64(range_end_24550, 0);\n        bool valid_24552 = !bounds_invalid_upwards_24551;\n        bool range_valid_c_24553;\n        \n        if (!valid_24552) {\n            {\n            ",
                   "    if (atomic_cmpxchg_i32_global(global_failure, -1, 3) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = 1;\n                    global_failure_args[2] = range_end_24550;\n                    ;\n                }\n                return;\n            }\n        }\n        for (int64_t i_27641 = 0; i_27641 < res_24548; i_27641++) {\n            float res_24557 = sitofp_i64_f32(i_27641);\n            float res_24558 = res_24547 * res_24557;\n            \n            ((__global float *) mem_27705)[phys_tid_24458 + i_27641 *\n                                           num_threads_27920] = res_24558;\n        }\n        \n        bool y_24559 = slt64(0, res_24548);\n        bool index_certs_24560;\n        \n        if (!y_24559) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 4) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_24548;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_24561 = sitofp_i64_f32(range_end_24550);\n        float index_primexp_24562 = res_24547 * binop_y_24561;\n        float negate_arg_24563 = a_23320 * index_primexp_24562;\n        float exp_arg_24564 = 0.0F - negate_arg_24563;\n        float res_24565 = fpow32(2.7182817F, exp_arg_24564);\n        float x_24566 = 1.0F - res_24565;\n        float B_24567 = x_24566 / a_23320;\n        float x_24568 = B_24567 - index_primexp_24562;\n        float x_24569 = y_23344 * x_24568;\n        float A1_24570 = x_24569 / x_23340;\n        float y_24571 = fpow32(B_24567, 2.0F);\n        float x_24572 = x_23342 * y_24571;\n        float A2_24573 = x_24572 / y_23345;\n        float exp_arg_24574 = A1_24570 - A2_24573;\n        float res_24575 = fpow32(2.7182817F, exp_arg_24574);\n        float negate_arg_24576 = r0_23323 * B_24567;\n        float exp_arg_24577 = 0.0F - negate_arg_24576;\n        float res_24578 = fpow32(2.7182817F, e",
                   "xp_arg_24577);\n        float res_24579 = res_24575 * res_24578;\n        bool empty_slice_24580 = range_end_24550 == 0;\n        bool zzero_leq_i_p_m_t_s_24581 = sle64(0, range_end_24550);\n        bool i_p_m_t_s_leq_w_24582 = slt64(range_end_24550, res_24548);\n        bool i_lte_j_24583 = sle64(1, res_24548);\n        bool y_24584 = zzero_leq_i_p_m_t_s_24581 && i_p_m_t_s_leq_w_24582;\n        bool y_24585 = i_lte_j_24583 && y_24584;\n        bool ok_or_empty_24586 = empty_slice_24580 || y_24585;\n        bool index_certs_24587;\n        \n        if (!ok_or_empty_24586) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 5) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = res_24548;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float res_24589;\n        float redout_27643 = 0.0F;\n        \n        for (int64_t i_27644 = 0; i_27644 < range_end_24550; i_27644++) {\n            int64_t slice_27662 = 1 + i_27644;\n            float x_24593 = ((__global float *) mem_27705)[phys_tid_24458 +\n                                                           slice_27662 *\n                                                           num_threads_27920];\n            float negate_arg_24594 = a_23320 * x_24593;\n            float exp_arg_24595 = 0.0F - negate_arg_24594;\n            float res_24596 = fpow32(2.7182817F, exp_arg_24595);\n            float x_24597 = 1.0F - res_24596;\n            float B_24598 = x_24597 / a_23320;\n            float x_24599 = B_24598 - x_24593;\n            float x_24600 = y_23344 * x_24599;\n            float A1_24601 = x_24600 / x_23340;\n            float y_24602 = fpow32(B_24598, 2.0F);\n            float x_24603 = x_23342 * y_24602;\n            float A2_24604 = x_24603 / y_23345;\n            float exp_arg_24605 = A1_24601 - A2_24604;\n            float res_24606 = fpow32(2.7182817F, exp_arg_24605);\n            float negate_arg_24607 = ",
                   "r0_23323 * B_24598;\n            float exp_arg_24608 = 0.0F - negate_arg_24607;\n            float res_24609 = fpow32(2.7182817F, exp_arg_24608);\n            float res_24610 = res_24606 * res_24609;\n            float res_24592 = res_24610 + redout_27643;\n            float redout_tmp_28165 = res_24592;\n            \n            redout_27643 = redout_tmp_28165;\n        }\n        res_24589 = redout_27643;\n        \n        float x_24611 = 1.0F - res_24579;\n        float y_24612 = res_24547 * res_24589;\n        float res_24613 = x_24611 / y_24612;\n        \n        ((__global float *) mem_27719)[gtid_24457] = res_24613;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_24536\n}\n__kernel void mainzisegmap_24960(__global int *global_failure, int64_t n_23312,\n                                 int64_t paths_23315, int64_t steps_23316,\n                                 float sims_per_year_23422, __global\n                                 unsigned char *mem_27795)\n{\n    #define segmap_group_sizze_25370 (mainzisegmap_group_sizze_24964)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28206;\n    int32_t local_tid_28207;\n    int64_t group_sizze_28210;\n    int32_t wave_sizze_28209;\n    int32_t group_tid_28208;\n    \n    global_tid_28206 = get_global_id(0);\n    local_tid_28207 = get_local_id(0);\n    group_sizze_28210 = get_local_size(0);\n    wave_sizze_28209 = LOCKSTEP_WIDTH;\n    group_tid_28208 = get_group_id(0);\n    \n    int32_t phys_tid_24960;\n    \n    phys_tid_24960 = global_tid_28206;\n    \n    int64_t gtid_24957;\n    \n    gtid_24957 = squot64(sext_i32_i64(group_tid_28208) *\n                         segmap_group_sizze_25370 +\n                         sext_i32_i64(local_tid_28207), steps_23316 * n_23312);\n    \n    int64_t gtid_24958;\n    \n    gtid_24958 = squot64(sext_i32_i64(group_tid_28208) *\n                         segmap_group_sizze_25370 +\n     ",
                   "                    sext_i32_i64(local_tid_28207) -\n                         squot64(sext_i32_i64(group_tid_28208) *\n                                 segmap_group_sizze_25370 +\n                                 sext_i32_i64(local_tid_28207), steps_23316 *\n                                 n_23312) * (steps_23316 * n_23312), n_23312);\n    \n    int64_t gtid_24959;\n    \n    gtid_24959 = sext_i32_i64(group_tid_28208) * segmap_group_sizze_25370 +\n        sext_i32_i64(local_tid_28207) - squot64(sext_i32_i64(group_tid_28208) *\n                                                segmap_group_sizze_25370 +\n                                                sext_i32_i64(local_tid_28207),\n                                                steps_23316 * n_23312) *\n        (steps_23316 * n_23312) - squot64(sext_i32_i64(group_tid_28208) *\n                                          segmap_group_sizze_25370 +\n                                          sext_i32_i64(local_tid_28207) -\n                                          squot64(sext_i32_i64(group_tid_28208) *\n                                                  segmap_group_sizze_25370 +\n                                                  sext_i32_i64(local_tid_28207),\n                                                  steps_23316 * n_23312) *\n                                          (steps_23316 * n_23312), n_23312) *\n        n_23312;\n    if ((slt64(gtid_24957, paths_23315) && slt64(gtid_24958, steps_23316)) &&\n        slt64(gtid_24959, n_23312)) {\n        int64_t convop_x_27504 = add64(1, gtid_24958);\n        float binop_x_27505 = sitofp_i64_f32(convop_x_27504);\n        float index_primexp_27506 = binop_x_27505 / sims_per_year_23422;\n        \n        ((__global float *) mem_27795)[gtid_24957 * (n_23312 * steps_23316) +\n                                       gtid_24958 * n_23312 + gtid_24959] =\n            index_primexp_27506;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25370\n}\n__kernel void mainzisegmap_24998(__global int *g",
                   "lobal_failure, int64_t n_23312,\n                                 int64_t paths_23315, int64_t steps_23316,\n                                 __global unsigned char *mem_27785, __global\n                                 unsigned char *mem_27790)\n{\n    #define segmap_group_sizze_25352 (mainzisegmap_group_sizze_25002)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28201;\n    int32_t local_tid_28202;\n    int64_t group_sizze_28205;\n    int32_t wave_sizze_28204;\n    int32_t group_tid_28203;\n    \n    global_tid_28201 = get_global_id(0);\n    local_tid_28202 = get_local_id(0);\n    group_sizze_28205 = get_local_size(0);\n    wave_sizze_28204 = LOCKSTEP_WIDTH;\n    group_tid_28203 = get_group_id(0);\n    \n    int32_t phys_tid_24998;\n    \n    phys_tid_24998 = global_tid_28201;\n    \n    int64_t gtid_24995;\n    \n    gtid_24995 = squot64(sext_i32_i64(group_tid_28203) *\n                         segmap_group_sizze_25352 +\n                         sext_i32_i64(local_tid_28202), steps_23316 * n_23312);\n    \n    int64_t gtid_24996;\n    \n    gtid_24996 = squot64(sext_i32_i64(group_tid_28203) *\n                         segmap_group_sizze_25352 +\n                         sext_i32_i64(local_tid_28202) -\n                         squot64(sext_i32_i64(group_tid_28203) *\n                                 segmap_group_sizze_25352 +\n                                 sext_i32_i64(local_tid_28202), steps_23316 *\n                                 n_23312) * (steps_23316 * n_23312), n_23312);\n    \n    int64_t gtid_24997;\n    \n    gtid_24997 = sext_i32_i64(group_tid_28203) * segmap_group_sizze_25352 +\n        sext_i32_i64(local_tid_28202) - squot64(sext_i32_i64(group_tid_28203) *\n                                                segmap_group_sizze_25352 +\n                                                sext_i32_i64(local_tid_28202),\n                                                steps",
                   "_23316 * n_23312) *\n        (steps_23316 * n_23312) - squot64(sext_i32_i64(group_tid_28203) *\n                                          segmap_group_sizze_25352 +\n                                          sext_i32_i64(local_tid_28202) -\n                                          squot64(sext_i32_i64(group_tid_28203) *\n                                                  segmap_group_sizze_25352 +\n                                                  sext_i32_i64(local_tid_28202),\n                                                  steps_23316 * n_23312) *\n                                          (steps_23316 * n_23312), n_23312) *\n        n_23312;\n    if ((slt64(gtid_24995, paths_23315) && slt64(gtid_24996, steps_23316)) &&\n        slt64(gtid_24997, n_23312)) {\n        float x_25355 = ((__global float *) mem_27785)[gtid_24996 *\n                                                       paths_23315 +\n                                                       gtid_24995];\n        \n        ((__global float *) mem_27790)[gtid_24995 * (n_23312 * steps_23316) +\n                                       gtid_24996 * n_23312 + gtid_24997] =\n            x_25355;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25352\n}\n__kernel void mainzisegmap_25055(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args,\n                                 int64_t paths_23315, int64_t steps_23316,\n                                 float a_23320, float b_23321,\n                                 float sigma_23322, float r0_23323,\n                                 float dt_23338, int64_t upper_bound_23436,\n                                 float res_23437, int64_t num_groups_25307,\n                                 __global unsigned char *mem_27767, __global\n                                 unsigned char *mem_27770, __global\n                                 unsigned char *mem_27785)\n{\n    #define segmap",
                   "_group_sizze_25306 (mainzisegmap_group_sizze_25057)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_28190;\n    int32_t local_tid_28191;\n    int64_t group_sizze_28194;\n    int32_t wave_sizze_28193;\n    int32_t group_tid_28192;\n    \n    global_tid_28190 = get_global_id(0);\n    local_tid_28191 = get_local_id(0);\n    group_sizze_28194 = get_local_size(0);\n    wave_sizze_28193 = LOCKSTEP_WIDTH;\n    group_tid_28192 = get_group_id(0);\n    \n    int32_t phys_tid_25055;\n    \n    phys_tid_25055 = global_tid_28190;\n    \n    int32_t phys_group_id_28195;\n    \n    phys_group_id_28195 = get_group_id(0);\n    for (int32_t i_28196 = 0; i_28196 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(paths_23315,\n                                          segmap_group_sizze_25306)) -\n                   phys_group_id_28195, sext_i64_i32(num_groups_25307));\n         i_28196++) {\n        int32_t virt_group_id_28197 = phys_group_id_28195 + i_28196 *\n                sext_i64_i32(num_groups_25307);\n        int64_t gtid_25054 = sext_i32_i64(virt_group_id_28197) *\n                segmap_group_sizze_25306 + sext_i32_i64(local_tid_28191);\n        \n        if (slt64(gtid_25054, paths_23315)) {\n            for (int64_t i_28198 = 0; i_28198 < steps_23316; i_28198++) {\n                ((__global float *) mem_27770)[phys_tid_25055 + i_28198 *\n                                               (num_groups_25307 *\n                                                segmap_group_sizze_25306)] =\n                    r0_23323;\n            }\n            for (int64_t i_25313 = 0; i_25313 < upper_bound_23436; i_25313++) {\n                bool y_25315 = slt64(i_25313, steps_23316);\n                bool index_certs_25316;\n    ",
                   "            \n                if (!y_25315) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 8) ==\n                            -1) {\n                            global_failure_args[0] = i_25313;\n                            global_failure_args[1] = steps_23316;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float shortstep_arg_25317 = ((__global\n                                              float *) mem_27767)[i_25313 *\n                                                                  paths_23315 +\n                                                                  gtid_25054];\n                float shortstep_arg_25318 = ((__global\n                                              float *) mem_27770)[phys_tid_25055 +\n                                                                  i_25313 *\n                                                                  (num_groups_25307 *\n                                                                   segmap_group_sizze_25306)];\n                float y_25319 = b_23321 - shortstep_arg_25318;\n                float x_25320 = a_23320 * y_25319;\n                float x_25321 = dt_23338 * x_25320;\n                float x_25322 = res_23437 * shortstep_arg_25317;\n                float y_25323 = sigma_23322 * x_25322;\n                float delta_r_25324 = x_25321 + y_25323;\n                float res_25325 = shortstep_arg_25318 + delta_r_25324;\n                int64_t i_25326 = add64(1, i_25313);\n                bool x_25327 = sle64(0, i_25326);\n                bool y_25328 = slt64(i_25326, steps_23316);\n                bool bounds_check_25329 = x_25327 && y_25328;\n                bool index_certs_25330;\n                \n                if (!bounds_check_25329) {\n                    {\n                        if (atomic_cmpxchg_i32_g",
                   "lobal(global_failure, -1, 9) ==\n                            -1) {\n                            global_failure_args[0] = i_25326;\n                            global_failure_args[1] = steps_23316;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                ((__global float *) mem_27770)[phys_tid_25055 + i_25326 *\n                                               (num_groups_25307 *\n                                                segmap_group_sizze_25306)] =\n                    res_25325;\n            }\n            for (int64_t i_28200 = 0; i_28200 < steps_23316; i_28200++) {\n                ((__global float *) mem_27785)[i_28200 * paths_23315 +\n                                               gtid_25054] = ((__global\n                                                               float *) mem_27770)[phys_tid_25055 +\n                                                                                   i_28200 *\n                                                                                   (num_groups_25307 *\n                                                                                    segmap_group_sizze_25306)];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25306\n}\n__kernel void mainzisegmap_25153(__global int *global_failure,\n                                 int64_t paths_23315, int64_t steps_23316,\n                                 __global unsigned char *mem_27760, __global\n                                 unsigned char *mem_27764)\n{\n    #define segmap_group_sizze_25261 (mainzisegmap_group_sizze_25156)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28185;\n    int32_t local_tid_28186;\n    int64_t group_sizze_2",
                   "8189;\n    int32_t wave_sizze_28188;\n    int32_t group_tid_28187;\n    \n    global_tid_28185 = get_global_id(0);\n    local_tid_28186 = get_local_id(0);\n    group_sizze_28189 = get_local_size(0);\n    wave_sizze_28188 = LOCKSTEP_WIDTH;\n    group_tid_28187 = get_group_id(0);\n    \n    int32_t phys_tid_25153;\n    \n    phys_tid_25153 = global_tid_28185;\n    \n    int64_t gtid_25151;\n    \n    gtid_25151 = squot64(sext_i32_i64(group_tid_28187) *\n                         segmap_group_sizze_25261 +\n                         sext_i32_i64(local_tid_28186), steps_23316);\n    \n    int64_t gtid_25152;\n    \n    gtid_25152 = sext_i32_i64(group_tid_28187) * segmap_group_sizze_25261 +\n        sext_i32_i64(local_tid_28186) - squot64(sext_i32_i64(group_tid_28187) *\n                                                segmap_group_sizze_25261 +\n                                                sext_i32_i64(local_tid_28186),\n                                                steps_23316) * steps_23316;\n    if (slt64(gtid_25151, paths_23315) && slt64(gtid_25152, steps_23316)) {\n        int32_t unsign_arg_25264 = ((__global int32_t *) mem_27760)[gtid_25151];\n        int32_t res_25266 = sext_i64_i32(gtid_25152);\n        int32_t x_25267 = lshr32(res_25266, 16);\n        int32_t x_25268 = res_25266 ^ x_25267;\n        int32_t x_25269 = mul32(73244475, x_25268);\n        int32_t x_25270 = lshr32(x_25269, 16);\n        int32_t x_25271 = x_25269 ^ x_25270;\n        int32_t x_25272 = mul32(73244475, x_25271);\n        int32_t x_25273 = lshr32(x_25272, 16);\n        int32_t x_25274 = x_25272 ^ x_25273;\n        int32_t unsign_arg_25275 = unsign_arg_25264 ^ x_25274;\n        int32_t unsign_arg_25276 = mul32(48271, unsign_arg_25275);\n        int32_t unsign_arg_25277 = umod32(unsign_arg_25276, 2147483647);\n        int32_t unsign_arg_25278 = mul32(48271, unsign_arg_25277);\n        int32_t unsign_arg_25279 = umod32(unsign_arg_25278, 2147483647);\n        float res_25280 = uitofp_i32_f32(unsign_arg_25277);\n        float res_252",
                   "81 = res_25280 / 2.1474836e9F;\n        float res_25282 = uitofp_i32_f32(unsign_arg_25279);\n        float res_25283 = res_25282 / 2.1474836e9F;\n        float res_25284;\n        \n        res_25284 = futrts_log32(res_25281);\n        \n        float res_25285 = -2.0F * res_25284;\n        float res_25286;\n        \n        res_25286 = futrts_sqrt32(res_25285);\n        \n        float res_25287 = 6.2831855F * res_25283;\n        float res_25288;\n        \n        res_25288 = futrts_cos32(res_25287);\n        \n        float res_25289 = res_25286 * res_25288;\n        \n        ((__global float *) mem_27764)[gtid_25151 * steps_23316 + gtid_25152] =\n            res_25289;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25261\n}\n__kernel void mainzisegmap_25217(__global int *global_failure,\n                                 int64_t paths_23315, __global\n                                 unsigned char *mem_27760)\n{\n    #define segmap_group_sizze_25236 (mainzisegmap_group_sizze_25219)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28180;\n    int32_t local_tid_28181;\n    int64_t group_sizze_28184;\n    int32_t wave_sizze_28183;\n    int32_t group_tid_28182;\n    \n    global_tid_28180 = get_global_id(0);\n    local_tid_28181 = get_local_id(0);\n    group_sizze_28184 = get_local_size(0);\n    wave_sizze_28183 = LOCKSTEP_WIDTH;\n    group_tid_28182 = get_group_id(0);\n    \n    int32_t phys_tid_25217;\n    \n    phys_tid_25217 = global_tid_28180;\n    \n    int64_t gtid_25216;\n    \n    gtid_25216 = sext_i32_i64(group_tid_28182) * segmap_group_sizze_25236 +\n        sext_i32_i64(local_tid_28181);\n    if (slt64(gtid_25216, paths_23315)) {\n        int32_t res_25240 = sext_i64_i32(gtid_25216);\n        int32_t x_25241 = lshr32(res_25240, 16);\n        int32_t x_25242 = res_25240 ^ x_25241;\n        int32_t x_25243 = mul32(73244475, x_25242);\n        int32_t x_25244 = lshr3",
                   "2(x_25243, 16);\n        int32_t x_25245 = x_25243 ^ x_25244;\n        int32_t x_25246 = mul32(73244475, x_25245);\n        int32_t x_25247 = lshr32(x_25246, 16);\n        int32_t x_25248 = x_25246 ^ x_25247;\n        int32_t unsign_arg_25249 = 777822902 ^ x_25248;\n        int32_t unsign_arg_25250 = mul32(48271, unsign_arg_25249);\n        int32_t unsign_arg_25251 = umod32(unsign_arg_25250, 2147483647);\n        \n        ((__global int32_t *) mem_27760)[gtid_25216] = unsign_arg_25251;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25236\n}\n__kernel void mainzisegmap_25490(__global int *global_failure,\n                                 int64_t res_23531, int64_t num_segments_23729,\n                                 __global unsigned char *mem_27820, __global\n                                 unsigned char *mem_27825, __global\n                                 unsigned char *mem_27828, __global\n                                 unsigned char *mem_27830)\n{\n    #define segmap_group_sizze_25493 (mainzisegmap_group_sizze_25492)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28712;\n    int32_t local_tid_28713;\n    int64_t group_sizze_28716;\n    int32_t wave_sizze_28715;\n    int32_t group_tid_28714;\n    \n    global_tid_28712 = get_global_id(0);\n    local_tid_28713 = get_local_id(0);\n    group_sizze_28716 = get_local_size(0);\n    wave_sizze_28715 = LOCKSTEP_WIDTH;\n    group_tid_28714 = get_group_id(0);\n    \n    int32_t phys_tid_25490;\n    \n    phys_tid_25490 = global_tid_28712;\n    \n    int64_t write_i_25489;\n    \n    write_i_25489 = sext_i32_i64(group_tid_28714) * segmap_group_sizze_25493 +\n        sext_i32_i64(local_tid_28713);\n    if (slt64(write_i_25489, res_23531)) {\n        int64_t i_p_o_27580 = add64(1, write_i_25489);\n        int64_t rot_i_27581 = smod64(i_p_o_27580, res_23531);\n        bool x_23742 = ((__global bool *) mem_27820)[rot_i_2",
                   "7581];\n        float write_value_23743 = ((__global float *) mem_27825)[write_i_25489];\n        int64_t res_23744;\n        \n        if (x_23742) {\n            int64_t x_23741 = ((__global int64_t *) mem_27828)[write_i_25489];\n            int64_t res_23745 = sub64(x_23741, 1);\n            \n            res_23744 = res_23745;\n        } else {\n            res_23744 = -1;\n        }\n        if (sle64(0, res_23744) && slt64(res_23744, num_segments_23729)) {\n            ((__global float *) mem_27830)[res_23744] = write_value_23743;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25493\n}\n__kernel void mainzisegmap_25562(__global int *global_failure, int64_t n_23312,\n                                 int64_t paths_23315, int64_t steps_23316,\n                                 float a_23320, float x_23340, float x_23342,\n                                 float y_23344, float y_23345,\n                                 float sims_per_year_23422, float res_23750,\n                                 __global unsigned char *mem_27852, __global\n                                 unsigned char *mem_27855, __global\n                                 unsigned char *mem_27857)\n{\n    #define segmap_group_sizze_25793 (mainzisegmap_group_sizze_25564)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28762;\n    int32_t local_tid_28763;\n    int64_t group_sizze_28766;\n    int32_t wave_sizze_28765;\n    int32_t group_tid_28764;\n    \n    global_tid_28762 = get_global_id(0);\n    local_tid_28763 = get_local_id(0);\n    group_sizze_28766 = get_local_size(0);\n    wave_sizze_28765 = LOCKSTEP_WIDTH;\n    group_tid_28764 = get_group_id(0);\n    \n    int32_t phys_tid_25562;\n    \n    phys_tid_25562 = global_tid_28762;\n    \n    int64_t gtid_25561;\n    \n    gtid_25561 = sext_i32_i64(group_tid_28764) * segmap_group_sizze_25793 +\n        sext_i32_i64(local_tid_28763);\n    if ",
                   "(slt64(gtid_25561, steps_23316)) {\n        int64_t convop_x_27587 = add64(1, gtid_25561);\n        float binop_x_27588 = sitofp_i64_f32(convop_x_27587);\n        float index_primexp_27589 = binop_x_27588 / sims_per_year_23422;\n        float res_25799;\n        float redout_27649 = 0.0F;\n        \n        for (int64_t i_27650 = 0; i_27650 < paths_23315; i_27650++) {\n            float res_25804;\n            float redout_27651 = 0.0F;\n            \n            for (int64_t i_27652 = 0; i_27652 < n_23312; i_27652++) {\n                float x_25808 = ((__global float *) mem_27852)[i_27650 *\n                                                               (steps_23316 *\n                                                                n_23312) +\n                                                               i_27652 *\n                                                               steps_23316 +\n                                                               gtid_25561];\n                float res_25807 = x_25808 + redout_27651;\n                float redout_tmp_28768 = res_25807;\n                \n                redout_27651 = redout_tmp_28768;\n            }\n            res_25804 = redout_27651;\n            \n            float res_25809 = fmax32(0.0F, res_25804);\n            float res_25802 = res_25809 + redout_27649;\n            float redout_tmp_28767 = res_25802;\n            \n            redout_27649 = redout_tmp_28767;\n        }\n        res_25799 = redout_27649;\n        \n        float res_25810 = res_25799 / res_23750;\n        float negate_arg_25811 = a_23320 * index_primexp_27589;\n        float exp_arg_25812 = 0.0F - negate_arg_25811;\n        float res_25813 = fpow32(2.7182817F, exp_arg_25812);\n        float x_25814 = 1.0F - res_25813;\n        float B_25815 = x_25814 / a_23320;\n        float x_25816 = B_25815 - index_primexp_27589;\n        float x_25817 = y_23344 * x_25816;\n        float A1_25818 = x_25817 / x_23340;\n        float y_25819 = fpow32(B_25815, 2.0F);\n        float x_258",
                   "20 = x_23342 * y_25819;\n        float A2_25821 = x_25820 / y_23345;\n        float exp_arg_25822 = A1_25818 - A2_25821;\n        float res_25823 = fpow32(2.7182817F, exp_arg_25822);\n        float negate_arg_25824 = 5.0e-2F * B_25815;\n        float exp_arg_25825 = 0.0F - negate_arg_25824;\n        float res_25826 = fpow32(2.7182817F, exp_arg_25825);\n        float res_25827 = res_25823 * res_25826;\n        float res_25828 = res_25810 * res_25827;\n        \n        ((__global float *) mem_27855)[gtid_25561] = res_25828;\n        ((__global float *) mem_27857)[gtid_25561] = res_25810;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25793\n}\n__kernel void mainzisegmap_25677(__global int *global_failure,\n                                 int64_t steps_23316, float a_23320,\n                                 float x_23340, float x_23342, float y_23344,\n                                 float y_23345, float sims_per_year_23422,\n                                 float res_23750, __global\n                                 unsigned char *mem_27870, __global\n                                 unsigned char *mem_27873, __global\n                                 unsigned char *mem_27875)\n{\n    #define segmap_group_sizze_25883 (mainzisegmap_group_sizze_25679)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28842;\n    int32_t local_tid_28843;\n    int64_t group_sizze_28846;\n    int32_t wave_sizze_28845;\n    int32_t group_tid_28844;\n    \n    global_tid_28842 = get_global_id(0);\n    local_tid_28843 = get_local_id(0);\n    group_sizze_28846 = get_local_size(0);\n    wave_sizze_28845 = LOCKSTEP_WIDTH;\n    group_tid_28844 = get_group_id(0);\n    \n    int32_t phys_tid_25677;\n    \n    phys_tid_25677 = global_tid_28842;\n    \n    int64_t gtid_25676;\n    \n    gtid_25676 = sext_i32_i64(group_tid_28844) * segmap_group_sizze_25883 +\n        sext_i32_i64(local_tid_28843);\n  ",
                   "  if (slt64(gtid_25676, steps_23316)) {\n        int64_t convop_x_27595 = add64(1, gtid_25676);\n        float binop_x_27596 = sitofp_i64_f32(convop_x_27595);\n        float index_primexp_27597 = binop_x_27596 / sims_per_year_23422;\n        float res_25888 = ((__global float *) mem_27870)[gtid_25676];\n        float res_25889 = res_25888 / res_23750;\n        float negate_arg_25890 = a_23320 * index_primexp_27597;\n        float exp_arg_25891 = 0.0F - negate_arg_25890;\n        float res_25892 = fpow32(2.7182817F, exp_arg_25891);\n        float x_25893 = 1.0F - res_25892;\n        float B_25894 = x_25893 / a_23320;\n        float x_25895 = B_25894 - index_primexp_27597;\n        float x_25896 = y_23344 * x_25895;\n        float A1_25897 = x_25896 / x_23340;\n        float y_25898 = fpow32(B_25894, 2.0F);\n        float x_25899 = x_23342 * y_25898;\n        float A2_25900 = x_25899 / y_23345;\n        float exp_arg_25901 = A1_25897 - A2_25900;\n        float res_25902 = fpow32(2.7182817F, exp_arg_25901);\n        float negate_arg_25903 = 5.0e-2F * B_25894;\n        float exp_arg_25904 = 0.0F - negate_arg_25903;\n        float res_25905 = fpow32(2.7182817F, exp_arg_25904);\n        float res_25906 = res_25902 * res_25905;\n        float res_25907 = res_25889 * res_25906;\n        \n        ((__global float *) mem_27873)[gtid_25676] = res_25907;\n        ((__global float *) mem_27875)[gtid_25676] = res_25889;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_25883\n}\n__kernel void mainzisegmap_intragroup_24699(__global int *global_failure,\n                                            int failure_is_an_option, __global\n                                            int64_t *global_failure_args,\n                                            __local volatile\n                                            int64_t *mem_27749_backing_aligned_0,\n                                            __local volatile\n                                            int64_t *mem_27745_backing_aligned_1,\n          ",
                   "                                  __local volatile\n                                            int64_t *mem_27729_backing_aligned_2,\n                                            __local volatile\n                                            int64_t *mem_27727_backing_aligned_3,\n                                            int64_t n_23312,\n                                            int64_t steps_23316, float a_23320,\n                                            float b_23321, float sigma_23322,\n                                            float r0_23323, float dt_23338,\n                                            float sims_per_year_23422,\n                                            int64_t upper_bound_23436,\n                                            float res_23437,\n                                            int64_t computed_group_sizze_24656,\n                                            __global unsigned char *mem_27753,\n                                            __global unsigned char *mem_27757)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict mem_27749_backing_3 = (__local volatile\n                                                           char *) mem_27749_backing_aligned_0;\n    __local volatile char *restrict mem_27745_backing_2 = (__local volatile\n                                                           char *) mem_27745_backing_aligned_1;\n    __local volatile char *restrict mem_27729_backing_1 = (__local volatile\n                                                           char *) mem_27729_backing_aligned_2;\n    __local volatile char *restrict mem_27727_backing_0 = (__local volatile\n                                                           char *) mem_27727_backing_aligned_3;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    b",
                   "arrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_28168;\n    int32_t local_tid_28169;\n    int64_t group_sizze_28172;\n    int32_t wave_sizze_28171;\n    int32_t group_tid_28170;\n    \n    global_tid_28168 = get_global_id(0);\n    local_tid_28169 = get_local_id(0);\n    group_sizze_28172 = get_local_size(0);\n    wave_sizze_28171 = LOCKSTEP_WIDTH;\n    group_tid_28170 = get_group_id(0);\n    \n    int32_t phys_tid_24699;\n    \n    phys_tid_24699 = group_tid_28170;\n    \n    int32_t ltid_pre_28173;\n    \n    ltid_pre_28173 = local_tid_28169;\n    \n    int32_t ltid_pre_28174;\n    \n    ltid_pre_28174 = squot32(local_tid_28169, sext_i64_i32(n_23312));\n    \n    int32_t ltid_pre_28175;\n    \n    ltid_pre_28175 = local_tid_28169 - squot32(local_tid_28169,\n                                               sext_i64_i32(n_23312)) *\n        sext_i64_i32(n_23312);\n    \n    int64_t gtid_24654;\n    \n    gtid_24654 = sext_i32_i64(group_tid_28170);\n    \n    int32_t res_24854;\n    \n    res_24854 = sext_i64_i32(gtid_24654);\n    \n    int32_t x_24855 = lshr32(res_24854, 16);\n    int32_t x_24856 = res_24854 ^ x_24855;\n    int32_t x_24857 = mul32(73244475, x_24856);\n    int32_t x_24858 = lshr32(x_24857, 16);\n    int32_t x_24859 = x_24857 ^ x_24858;\n    int32_t x_24860 = mul32(73244475, x_24859);\n    int32_t x_24861 = lshr32(x_24860, 16);\n    int32_t x_24862 = x_24860 ^ x_24861;\n    int32_t unsign_arg_24863 = 777822902 ^ x_24862;\n    int32_t unsign_arg_24864 = mul32(48271, unsign_arg_24863);\n    int32_t unsign_arg_24865 = umod32(unsign_arg_24864, 2147483647);\n    __local char *mem_27727;\n    \n    mem_27727 = (__local char *) mem_27727_backing_0;\n    \n    int64_t gtid_24657 = sext_i32_i64(ltid_pre_28173);\n    int32_t phys_tid_24658 = local_tid_28169;\n    \n    if (slt64(gtid_24657, steps_23316)) {\n        int32_t res_24868 = sext_i64_i32(gtid_24657);\n        int32_t x_24869 = lshr32(res_24868, 16);\n        int32_t x_24870 = res_24868 ^ x_24869;\n        int32_t x_24871 = mul32(73244475, x_24870);\n     ",
                   "   int32_t x_24872 = lshr32(x_24871, 16);\n        int32_t x_24873 = x_24871 ^ x_24872;\n        int32_t x_24874 = mul32(73244475, x_24873);\n        int32_t x_24875 = lshr32(x_24874, 16);\n        int32_t x_24876 = x_24874 ^ x_24875;\n        int32_t unsign_arg_24877 = unsign_arg_24865 ^ x_24876;\n        int32_t unsign_arg_24878 = mul32(48271, unsign_arg_24877);\n        int32_t unsign_arg_24879 = umod32(unsign_arg_24878, 2147483647);\n        int32_t unsign_arg_24880 = mul32(48271, unsign_arg_24879);\n        int32_t unsign_arg_24881 = umod32(unsign_arg_24880, 2147483647);\n        float res_24882 = uitofp_i32_f32(unsign_arg_24879);\n        float res_24883 = res_24882 / 2.1474836e9F;\n        float res_24884 = uitofp_i32_f32(unsign_arg_24881);\n        float res_24885 = res_24884 / 2.1474836e9F;\n        float res_24886;\n        \n        res_24886 = futrts_log32(res_24883);\n        \n        float res_24887 = -2.0F * res_24886;\n        float res_24888;\n        \n        res_24888 = futrts_sqrt32(res_24887);\n        \n        float res_24889 = 6.2831855F * res_24885;\n        float res_24890;\n        \n        res_24890 = futrts_cos32(res_24889);\n        \n        float res_24891 = res_24888 * res_24890;\n        \n        ((__local float *) mem_27727)[gtid_24657] = res_24891;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    __local char *mem_27729;\n    \n    mem_27729 = (__local char *) mem_27729_backing_1;\n    for (int64_t i_28176 = 0; i_28176 < sdiv_up64(steps_23316 -\n                                                  sext_i32_i64(local_tid_28169),\n                                                  computed_group_sizze_24656);\n         i_28176++) {\n        ((__local float *) mem_27729)[i_28176 * computed_group_sizze_24656 +\n                                      sext_i32_i64(local_tid_28169)] = r0_23323;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int64_t i_24894 = 0; i_24894 < upper_bound_23436; i_24894++) {\n        bool y_24896 = slt64(i_24894, steps_23316);\n        bool index_c",
                   "erts_24897;\n        \n        if (!y_24896) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 6) == -1) {\n                    global_failure_args[0] = i_24894;\n                    global_failure_args[1] = steps_23316;\n                    ;\n                }\n                local_failure = true;\n                goto error_1;\n            }\n        }\n        \n        float shortstep_arg_24898 = ((__local float *) mem_27727)[i_24894];\n        float shortstep_arg_24899 = ((__local float *) mem_27729)[i_24894];\n        float y_24900 = b_23321 - shortstep_arg_24899;\n        float x_24901 = a_23320 * y_24900;\n        float x_24902 = dt_23338 * x_24901;\n        float x_24903 = res_23437 * shortstep_arg_24898;\n        float y_24904 = sigma_23322 * x_24903;\n        float delta_r_24905 = x_24902 + y_24904;\n        float res_24906 = shortstep_arg_24899 + delta_r_24905;\n        int64_t i_24907 = add64(1, i_24894);\n        bool x_24908 = sle64(0, i_24907);\n        bool y_24909 = slt64(i_24907, steps_23316);\n        bool bounds_check_24910 = x_24908 && y_24909;\n        bool index_certs_24911;\n        \n        if (!bounds_check_24910) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 7) == -1) {\n                    global_failure_args[0] = i_24907;\n                    global_failure_args[1] = steps_23316;\n                    ;\n                }\n                local_failure = true;\n                goto error_1;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_28169 == 0) {\n            ((__local float *) mem_27729)[i_24907] = res_24906;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    __local char *mem_27745;\n    \n    mem_27745 = (__local char *) mem_27745_backing_2;\n    \n    int64_t gtid_24691 = sext_i32_i64(ltid_pre_28174);\n    int64_t gtid_24692 = sext_i32_i64(ltid_pre_28175);\n    int32_t phys_tid_24693 = local_tid_28169;\n    \n    if (slt64(gtid_24691, steps_23316) && sl",
                   "t64(gtid_24692, n_23312)) {\n        float x_24914 = ((__local float *) mem_27729)[gtid_24691];\n        \n        ((__local float *) mem_27745)[gtid_24691 * n_23312 + gtid_24692] =\n            x_24914;\n    }\n    \n  error_1:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    __local char *mem_27749;\n    \n    mem_27749 = (__local char *) mem_27749_backing_3;\n    \n    int64_t gtid_24685 = sext_i32_i64(ltid_pre_28174);\n    int64_t gtid_24686 = sext_i32_i64(ltid_pre_28175);\n    int32_t phys_tid_24687 = local_tid_28169;\n    \n    if (slt64(gtid_24685, steps_23316) && slt64(gtid_24686, n_23312)) {\n        int64_t convop_x_27493 = add64(1, gtid_24685);\n        float binop_x_27494 = sitofp_i64_f32(convop_x_27493);\n        float index_primexp_27495 = binop_x_27494 / sims_per_year_23422;\n        \n        ((__local float *) mem_27749)[gtid_24685 * n_23312 + gtid_24686] =\n            index_primexp_27495;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int64_t i_28178 = 0; i_28178 < sdiv_up64(steps_23316 * n_23312 -\n                                                  sext_i32_i64(local_tid_28169),\n                                                  computed_group_sizze_24656);\n         i_28178++) {\n        ((__global float *) mem_27753)[gtid_24654 * (n_23312 * steps_23316) +\n                                       squot64(i_28178 *\n                                               computed_group_sizze_24656 +\n                                               sext_i32_i64(local_tid_28169),\n                                               n_23312) * n_23312 + (i_28178 *\n                                                                     computed_group_sizze_24656 +\n                                                                     sext_i32_i64(local_tid_28169) -\n                                                                     squot64(i_28178 *\n                                                                             comput",
                   "ed_group_sizze_24656 +\n                                                                             sext_i32_i64(local_tid_28169),\n                                                                             n_23312) *\n                                                                     n_23312)] =\n            ((__local float *) mem_27745)[squot64(i_28178 *\n                                                  computed_group_sizze_24656 +\n                                                  sext_i32_i64(local_tid_28169),\n                                                  n_23312) * n_23312 +\n                                          (i_28178 *\n                                           computed_group_sizze_24656 +\n                                           sext_i32_i64(local_tid_28169) -\n                                           squot64(i_28178 *\n                                                   computed_group_sizze_24656 +\n                                                   sext_i32_i64(local_tid_28169),\n                                                   n_23312) * n_23312)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int64_t i_28179 = 0; i_28179 < sdiv_up64(steps_23316 * n_23312 -\n                                                  sext_i32_i64(local_tid_28169),\n                                                  computed_group_sizze_24656);\n         i_28179++) {\n        ((__global float *) mem_27757)[gtid_24654 * (n_23312 * steps_23316) +\n                                       squot64(i_28179 *\n                                               computed_group_sizze_24656 +\n                                               sext_i32_i64(local_tid_28169),\n                                               n_23312) * n_23312 + (i_28179 *\n                                                                     computed_group_sizze_24656 +\n                                                                     sext_i32_i64(local_tid_28169) -\n                                                  ",
                   "                   squot64(i_28179 *\n                                                                             computed_group_sizze_24656 +\n                                                                             sext_i32_i64(local_tid_28169),\n                                                                             n_23312) *\n                                                                     n_23312)] =\n            ((__local float *) mem_27749)[squot64(i_28179 *\n                                                  computed_group_sizze_24656 +\n                                                  sext_i32_i64(local_tid_28169),\n                                                  n_23312) * n_23312 +\n                                          (i_28179 *\n                                           computed_group_sizze_24656 +\n                                           sext_i32_i64(local_tid_28169) -\n                                           squot64(i_28179 *\n                                                   computed_group_sizze_24656 +\n                                                   sext_i32_i64(local_tid_28169),\n                                                   n_23312) * n_23312)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n  error_3:\n    return;\n}\n__kernel void mainzisegmap_intragroup_25560(__global int *global_failure,\n                                            __local volatile\n                                            int64_t *red_arr_mem_28775_backing_aligned_0,\n                                            int64_t n_23312,\n                                            int64_t paths_23315, float a_23320,\n                                            float x_23340, float x_23342,\n                                            float y_23344, float y_23345,\n                                            float sims_per_year_23422,\n                                            float res_23750,\n                                            int64_t one_intra_par_min_24696,\n",
                   "                                            __global unsigned char *mem_27830,\n                                            __global unsigned char *mem_27861,\n                                            __global unsigned char *mem_27863)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28775_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28775_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28769;\n    int32_t local_tid_28770;\n    int64_t group_sizze_28773;\n    int32_t wave_sizze_28772;\n    int32_t group_tid_28771;\n    \n    global_tid_28769 = get_global_id(0);\n    local_tid_28770 = get_local_id(0);\n    group_sizze_28773 = get_local_size(0);\n    wave_sizze_28772 = LOCKSTEP_WIDTH;\n    group_tid_28771 = get_group_id(0);\n    \n    int32_t phys_tid_25560;\n    \n    phys_tid_25560 = group_tid_28771;\n    \n    int32_t ltid_pre_28774;\n    \n    ltid_pre_28774 = local_tid_28770;\n    \n    int64_t gtid_25555;\n    \n    gtid_25555 = sext_i32_i64(group_tid_28771);\n    \n    int64_t convop_x_27591;\n    \n    convop_x_27591 = add64(1, gtid_25555);\n    \n    float binop_x_27592 = sitofp_i64_f32(convop_x_27591);\n    float index_primexp_27593 = binop_x_27592 / sims_per_year_23422;\n    int64_t binop_y_27665 = n_23312 * gtid_25555;\n    float res_25835;\n    int64_t gtid_25558 = sext_i32_i64(ltid_pre_28774);\n    int32_t phys_tid_25559 = local_tid_28770;\n    __local char *red_arr_mem_28775;\n    \n    red_arr_mem_28775 = (__local char *) red_arr_mem_28775_backing_0;\n    if (slt64(gtid_25558, paths_23315)) {\n        int64_t binop_x_27664 = one_intra_par_min_24696 * gtid_25558;\n        int64_t binop_x_27666 = binop_x_27664 + binop_y_27665;\n        float res_25840;\n        float redout_27653 = 0.0F;\n        \n        for (int64_t i_27654 = 0; i_27654 < n_23312; i_27654++) {\n            int64_t new_index_27667 =",
                   " i_27654 + binop_x_27666;\n            float x_25844 = ((__global float *) mem_27830)[new_index_27667];\n            float res_25843 = x_25844 + redout_27653;\n            float redout_tmp_28777 = res_25843;\n            \n            redout_27653 = redout_tmp_28777;\n        }\n        res_25840 = redout_27653;\n        \n        float res_25845 = fmax32(0.0F, res_25840);\n        \n        ((__local float *) red_arr_mem_28775)[gtid_25558] = res_25845;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28778;\n    int32_t skip_waves_28779;\n    \n    skip_waves_28779 = 1;\n    \n    float x_25836;\n    float x_25837;\n    \n    offset_28778 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28770, sext_i64_i32(paths_23315))) {\n            x_25836 = ((__local\n                        float *) red_arr_mem_28775)[sext_i32_i64(local_tid_28770 +\n                                                    offset_28778)];\n        }\n    }\n    offset_28778 = 1;\n    while (slt32(offset_28778, wave_sizze_28772)) {\n        if (slt32(local_tid_28770 + offset_28778, sext_i64_i32(paths_23315)) &&\n            ((local_tid_28770 - squot32(local_tid_28770, wave_sizze_28772) *\n              wave_sizze_28772) & (2 * offset_28778 - 1)) == 0) {\n            // read array element\n            {\n                x_25837 = ((volatile __local\n                            float *) red_arr_mem_28775)[sext_i32_i64(local_tid_28770 +\n                                                        offset_28778)];\n            }\n            // apply reduction operation\n            {\n                float res_25838 = x_25836 + x_25837;\n                \n                x_25836 = res_25838;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_28775)[sext_i32_i64(local_tid_28770)] =\n                    x_25836;\n            }\n        }\n        offset_28778 *= 2;\n    }\n    while (slt32(skip_waves_28779",
                   ", squot32(sext_i64_i32(paths_23315) +\n                                           wave_sizze_28772 - 1,\n                                           wave_sizze_28772))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28778 = skip_waves_28779 * wave_sizze_28772;\n        if (slt32(local_tid_28770 + offset_28778, sext_i64_i32(paths_23315)) &&\n            ((local_tid_28770 - squot32(local_tid_28770, wave_sizze_28772) *\n              wave_sizze_28772) == 0 && (squot32(local_tid_28770,\n                                                 wave_sizze_28772) & (2 *\n                                                                      skip_waves_28779 -\n                                                                      1)) ==\n             0)) {\n            // read array element\n            {\n                x_25837 = ((__local\n                            float *) red_arr_mem_28775)[sext_i32_i64(local_tid_28770 +\n                                                        offset_28778)];\n            }\n            // apply reduction operation\n            {\n                float res_25838 = x_25836 + x_25837;\n                \n                x_25836 = res_25838;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_28775)[sext_i32_i64(local_tid_28770)] =\n                    x_25836;\n            }\n        }\n        skip_waves_28779 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    res_25835 = ((__local float *) red_arr_mem_28775)[0];\n    \n    float res_25846 = res_25835 / res_23750;\n    float negate_arg_25847 = a_23320 * index_primexp_27593;\n    float exp_arg_25848 = 0.0F - negate_arg_25847;\n    float res_25849 = fpow32(2.7182817F, exp_arg_25848);\n    float x_25850 = 1.0F - res_25849;\n    float B_25851 = x_25850 / a_23320;\n    float x_25852 = B_25851 - index_primexp_27593;\n    float x_25853 = y_23344 * x_25852;\n    float A1_25854 = x_25853 / x_23340;\n    float y_25855 = fpow32(B_25851, 2.0F);\n    float",
                   " x_25856 = x_23342 * y_25855;\n    float A2_25857 = x_25856 / y_23345;\n    float exp_arg_25858 = A1_25854 - A2_25857;\n    float res_25859 = fpow32(2.7182817F, exp_arg_25858);\n    float negate_arg_25860 = 5.0e-2F * B_25851;\n    float exp_arg_25861 = 0.0F - negate_arg_25860;\n    float res_25862 = fpow32(2.7182817F, exp_arg_25861);\n    float res_25863 = res_25859 * res_25862;\n    float res_25864 = res_25846 * res_25863;\n    \n    if (local_tid_28770 == 0) {\n        ((__global float *) mem_27861)[gtid_25555] = res_25864;\n    }\n    if (local_tid_28770 == 0) {\n        ((__global float *) mem_27863)[gtid_25555] = res_25846;\n    }\n    \n  error_2:\n    return;\n}\n__kernel void mainzisegred_large_25712(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_28818_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_28816_backing_aligned_1,\n                                       int64_t n_23312, int64_t paths_23315,\n                                       int64_t steps_23316,\n                                       int64_t num_groups_25868, __global\n                                       unsigned char *mem_27867, __global\n                                       unsigned char *mem_27870,\n                                       int64_t groups_per_segment_28802,\n                                       int64_t elements_per_thread_28803,\n                                       int64_t virt_num_groups_28804,\n                                       int64_t threads_per_segment_28806,\n                                       __global\n                                       unsigned char *group_res_arr_mem_28807,\n                                       __global\n                                       unsigned char *mainzicounter_mem_28809)\n{\n    #define segred_group_sizze_25867 (mainzisegred_group_sizze_25706)\n    \n    const int blo",
                   "ck_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_28818_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_28818_backing_aligned_0;\n    __local volatile char *restrict red_arr_mem_28816_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28816_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28811;\n    int32_t local_tid_28812;\n    int64_t group_sizze_28815;\n    int32_t wave_sizze_28814;\n    int32_t group_tid_28813;\n    \n    global_tid_28811 = get_global_id(0);\n    local_tid_28812 = get_local_id(0);\n    group_sizze_28815 = get_local_size(0);\n    wave_sizze_28814 = LOCKSTEP_WIDTH;\n    group_tid_28813 = get_group_id(0);\n    \n    int32_t phys_tid_25712;\n    \n    phys_tid_25712 = global_tid_28811;\n    \n    __local char *red_arr_mem_28816;\n    \n    red_arr_mem_28816 = (__local char *) red_arr_mem_28816_backing_0;\n    \n    __local char *sync_arr_mem_28818;\n    \n    sync_arr_mem_28818 = (__local char *) sync_arr_mem_28818_backing_1;\n    \n    int32_t phys_group_id_28820;\n    \n    phys_group_id_28820 = get_group_id(0);\n    for (int32_t i_28821 = 0; i_28821 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_28804) - phys_group_id_28820,\n                   sext_i64_i32(num_groups_25868)); i_28821++) {\n        int32_t virt_group_id_28822 = phys_group_id_28820 + i_28821 *\n                sext_i64_i32(num_groups_25868);\n        int32_t flat_segment_id_28823 = squot32(virt_group_id_28822,\n                                                sext_i64_i32(groups_per_segment_28802));\n        int64_t global_tid_28824 = srem64(sext_i32_i64(virt_group_id_28822) *\n                                          segred_group_sizze_25867 +\n                                          sext_i32_i64(local_tid_28812),\n                                          segred_group_sizze_25867 *\n  ",
                   "                                        groups_per_segment_28802);\n        int64_t gtid_25703 = sext_i32_i64(flat_segment_id_28823);\n        int64_t gtid_25711;\n        float x_acc_28825;\n        int64_t chunk_sizze_28826;\n        \n        chunk_sizze_28826 = smin64(elements_per_thread_28803,\n                                   sdiv_up64(paths_23315 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_28824)),\n                                             threads_per_segment_28806));\n        \n        float x_25871;\n        float x_25872;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_28825 = 0.0F;\n        }\n        for (int64_t i_28830 = 0; i_28830 < chunk_sizze_28826; i_28830++) {\n            gtid_25711 = sext_i32_i64(sext_i64_i32(global_tid_28824)) +\n                threads_per_segment_28806 * i_28830;\n            // apply map function\n            {\n                float res_25876;\n                float redout_27655 = 0.0F;\n                \n                for (int64_t i_27656 = 0; i_27656 < n_23312; i_27656++) {\n                    float x_25880 = ((__global float *) mem_27867)[i_27656 *\n                                                                   (steps_23316 *\n                                                                    paths_23315) +\n                                                                   gtid_25711 *\n                                                                   steps_23316 +\n                                                                   gtid_25703];\n                    float res_25879 = x_25880 + redout_27655;\n                    float redout_tmp_28831 = res_25879;\n                    \n                    redout_27655 = redout_tmp_28831;\n                }\n                res_25876 = redout_27655;\n                \n                float res_25881 = fmax32(0.0F, res_25876);\n                \n                // save map-out results\n                { }\n               ",
                   " // load accumulator\n                {\n                    x_25871 = x_acc_28825;\n                }\n                // load new values\n                {\n                    x_25872 = res_25881;\n                }\n                // apply reduction operator\n                {\n                    float res_25873 = x_25871 + x_25872;\n                    \n                    // store in accumulator\n                    {\n                        x_acc_28825 = res_25873;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_25871 = x_acc_28825;\n            ((__local\n              float *) red_arr_mem_28816)[sext_i32_i64(local_tid_28812)] =\n                x_25871;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_28832;\n        int32_t skip_waves_28833;\n        \n        skip_waves_28833 = 1;\n        \n        float x_28827;\n        float x_28828;\n        \n        offset_28832 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_28812,\n                      sext_i64_i32(segred_group_sizze_25867))) {\n                x_28827 = ((__local\n                            float *) red_arr_mem_28816)[sext_i32_i64(local_tid_28812 +\n                                                        offset_28832)];\n            }\n        }\n        offset_28832 = 1;\n        while (slt32(offset_28832, wave_sizze_28814)) {\n            if (slt32(local_tid_28812 + offset_28832,\n                      sext_i64_i32(segred_group_sizze_25867)) &&\n                ((local_tid_28812 - squot32(local_tid_28812, wave_sizze_28814) *\n                  wave_sizze_28814) & (2 * offset_28832 - 1)) == 0) {\n                // read array element\n                {\n                    x_28828 = ((volatile __local\n                                float *) red_arr_mem_28816)[sext_i32_i64(local_tid_28812 +\n                                            ",
                   "                offset_28832)];\n                }\n                // apply reduction operation\n                {\n                    float res_28829 = x_28827 + x_28828;\n                    \n                    x_28827 = res_28829;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      float *) red_arr_mem_28816)[sext_i32_i64(local_tid_28812)] =\n                        x_28827;\n                }\n            }\n            offset_28832 *= 2;\n        }\n        while (slt32(skip_waves_28833,\n                     squot32(sext_i64_i32(segred_group_sizze_25867) +\n                             wave_sizze_28814 - 1, wave_sizze_28814))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_28832 = skip_waves_28833 * wave_sizze_28814;\n            if (slt32(local_tid_28812 + offset_28832,\n                      sext_i64_i32(segred_group_sizze_25867)) &&\n                ((local_tid_28812 - squot32(local_tid_28812, wave_sizze_28814) *\n                  wave_sizze_28814) == 0 && (squot32(local_tid_28812,\n                                                     wave_sizze_28814) & (2 *\n                                                                          skip_waves_28833 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_28828 = ((__local\n                                float *) red_arr_mem_28816)[sext_i32_i64(local_tid_28812 +\n                                                            offset_28832)];\n                }\n                // apply reduction operation\n                {\n                    float res_28829 = x_28827 + x_28828;\n                    \n                    x_28827 = res_28829;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      float *) red_arr_mem_28816)[se",
                   "xt_i32_i64(local_tid_28812)] =\n                        x_28827;\n                }\n            }\n            skip_waves_28833 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_28812) == 0) {\n                x_acc_28825 = x_28827;\n            }\n        }\n        if (groups_per_segment_28802 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_28812 == 0) {\n                    ((__global float *) mem_27870)[gtid_25703] = x_acc_28825;\n                }\n            }\n        } else {\n            int32_t old_counter_28834;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_28812 == 0) {\n                    ((__global\n                      float *) group_res_arr_mem_28807)[sext_i32_i64(virt_group_id_28822) *\n                                                        segred_group_sizze_25867] =\n                        x_acc_28825;\n                    mem_fence_global();\n                    old_counter_28834 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_28809)[sext_i32_i64(srem32(flat_segment_id_28823,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_28818)[0] =\n                        old_counter_28834 == groups_per_segment_28802 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_28835;\n            \n            is_last_group_28835 = ((__local bool *) sync_arr_mem_28818)[0];\n            if (is_last_group_28835) {\n                if (local_tid_28812 == 0) {\n                   ",
                   " old_counter_28834 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_28809)[sext_i32_i64(srem32(flat_segment_id_28823,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_28802));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_28836 =\n                            sdiv_up64(groups_per_segment_28802,\n                                      segred_group_sizze_25867);\n                    \n                    x_25871 = 0.0F;\n                    for (int64_t i_28837 = 0; i_28837 < read_per_thread_28836;\n                         i_28837++) {\n                        int64_t group_res_id_28838 =\n                                sext_i32_i64(local_tid_28812) *\n                                read_per_thread_28836 + i_28837;\n                        int64_t index_of_group_res_28839 =\n                                sext_i32_i64(flat_segment_id_28823) *\n                                groups_per_segment_28802 + group_res_id_28838;\n                        \n                        if (slt64(group_res_id_28838,\n                                  groups_per_segment_28802)) {\n                            x_25872 = ((__global\n                                        float *) group_res_arr_mem_28807)[index_of_group_res_28839 *\n                                                                          segred_group_sizze_25867];\n                            \n                            float res_25873;\n                            \n                            res_25873 = x_25871 + x_25872;\n                            x_25871 = res_25873;\n                        }\n                    }\n                }\n                ((__local\n             ",
                   "     float *) red_arr_mem_28816)[sext_i32_i64(local_tid_28812)] =\n                    x_25871;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_28840;\n                    int32_t skip_waves_28841;\n                    \n                    skip_waves_28841 = 1;\n                    \n                    float x_28827;\n                    float x_28828;\n                    \n                    offset_28840 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_28812,\n                                  sext_i64_i32(segred_group_sizze_25867))) {\n                            x_28827 = ((__local\n                                        float *) red_arr_mem_28816)[sext_i32_i64(local_tid_28812 +\n                                                                    offset_28840)];\n                        }\n                    }\n                    offset_28840 = 1;\n                    while (slt32(offset_28840, wave_sizze_28814)) {\n                        if (slt32(local_tid_28812 + offset_28840,\n                                  sext_i64_i32(segred_group_sizze_25867)) &&\n                            ((local_tid_28812 - squot32(local_tid_28812,\n                                                        wave_sizze_28814) *\n                              wave_sizze_28814) & (2 * offset_28840 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_28828 = ((volatile __local\n                                            float *) red_arr_mem_28816)[sext_i32_i64(local_tid_28812 +\n                                                                        offset_28840)];\n                            }\n                            // apply reduction operation\n                            {\n                                floa",
                   "t res_28829 = x_28827 + x_28828;\n                                \n                                x_28827 = res_28829;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_28816)[sext_i32_i64(local_tid_28812)] =\n                                    x_28827;\n                            }\n                        }\n                        offset_28840 *= 2;\n                    }\n                    while (slt32(skip_waves_28841,\n                                 squot32(sext_i64_i32(segred_group_sizze_25867) +\n                                         wave_sizze_28814 - 1,\n                                         wave_sizze_28814))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_28840 = skip_waves_28841 * wave_sizze_28814;\n                        if (slt32(local_tid_28812 + offset_28840,\n                                  sext_i64_i32(segred_group_sizze_25867)) &&\n                            ((local_tid_28812 - squot32(local_tid_28812,\n                                                        wave_sizze_28814) *\n                              wave_sizze_28814) == 0 &&\n                             (squot32(local_tid_28812, wave_sizze_28814) & (2 *\n                                                                            skip_waves_28841 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_28828 = ((__local\n                                            float *) red_arr_mem_28816)[sext_i32_i64(local_tid_28812 +\n                                                                        offset_28840)];\n                            }\n                            // apply reduction operation\n            ",
                   "                {\n                                float res_28829 = x_28827 + x_28828;\n                                \n                                x_28827 = res_28829;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  float *) red_arr_mem_28816)[sext_i32_i64(local_tid_28812)] =\n                                    x_28827;\n                            }\n                        }\n                        skip_waves_28841 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_28812 == 0) {\n                            ((__global float *) mem_27870)[gtid_25703] =\n                                x_28827;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_25867\n}\n__kernel void mainzisegred_large_28390(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_28428_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_28426_backing_aligned_1,\n                                       int64_t res_23531,\n                                       int64_t num_groups_25402, __global\n                                       unsigned char *mem_27807,\n                                       int32_t num_subhistos_28304, __global\n                                       unsigned char *res_subhistos_mem_28305,\n                                       int64_t groups_per_segment_28412,\n                                       int64_t elements_per_thread_28413,\n                                       int64_t virt_num_groups_28414,\n      ",
                   "                                 int64_t threads_per_segment_28416,\n                                       __global\n                                       unsigned char *group_res_arr_mem_28417,\n                                       __global\n                                       unsigned char *mainzicounter_mem_28419)\n{\n    #define seghist_group_sizze_25400 (mainziseghist_group_sizze_25399)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_28428_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_28428_backing_aligned_0;\n    __local volatile char *restrict red_arr_mem_28426_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28426_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28421;\n    int32_t local_tid_28422;\n    int64_t group_sizze_28425;\n    int32_t wave_sizze_28424;\n    int32_t group_tid_28423;\n    \n    global_tid_28421 = get_global_id(0);\n    local_tid_28422 = get_local_id(0);\n    group_sizze_28425 = get_local_size(0);\n    wave_sizze_28424 = LOCKSTEP_WIDTH;\n    group_tid_28423 = get_group_id(0);\n    \n    int32_t flat_gtid_28390;\n    \n    flat_gtid_28390 = global_tid_28421;\n    \n    __local char *red_arr_mem_28426;\n    \n    red_arr_mem_28426 = (__local char *) red_arr_mem_28426_backing_0;\n    \n    __local char *sync_arr_mem_28428;\n    \n    sync_arr_mem_28428 = (__local char *) sync_arr_mem_28428_backing_1;\n    \n    int32_t phys_group_id_28430;\n    \n    phys_group_id_28430 = get_group_id(0);\n    for (int32_t i_28431 = 0; i_28431 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_28414) - phys_group_id_28430,\n                   sext_i64_i32(num_groups_25402)); i_28431++) {\n        int32_t virt_group_id_28432 = phys_group_id_28430 + i_28431 *\n                sext_i64_i32(num_groups_25402);\n        int32_t flat_segment_",
                   "id_28433 = squot32(virt_group_id_28432,\n                                                sext_i64_i32(groups_per_segment_28412));\n        int64_t global_tid_28434 = srem64(sext_i32_i64(virt_group_id_28432) *\n                                          seghist_group_sizze_25400 +\n                                          sext_i32_i64(local_tid_28422),\n                                          seghist_group_sizze_25400 *\n                                          groups_per_segment_28412);\n        int64_t bucket_id_28388 = sext_i32_i64(flat_segment_id_28433);\n        int64_t subhistogram_id_28389;\n        int64_t x_acc_28435;\n        int64_t chunk_sizze_28436;\n        \n        chunk_sizze_28436 = smin64(elements_per_thread_28413,\n                                   sdiv_up64(num_subhistos_28304 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_28434)),\n                                             threads_per_segment_28416));\n        \n        int64_t x_25406;\n        int64_t x_25407;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_28435 = 0;\n        }\n        for (int64_t i_28440 = 0; i_28440 < chunk_sizze_28436; i_28440++) {\n            subhistogram_id_28389 =\n                sext_i32_i64(sext_i64_i32(global_tid_28434)) +\n                threads_per_segment_28416 * i_28440;\n            // apply map function\n            {\n                // load accumulator\n                {\n                    x_25406 = x_acc_28435;\n                }\n                // load new values\n                {\n                    x_25407 = ((__global\n                                int64_t *) res_subhistos_mem_28305)[subhistogram_id_28389 *\n                                                                    res_23531 +\n                                                                    bucket_id_28388];\n                }\n                // apply reduction operator\n                {\n                    int64_t res_25408 = smax64(",
                   "x_25406, x_25407);\n                    \n                    // store in accumulator\n                    {\n                        x_acc_28435 = res_25408;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_25406 = x_acc_28435;\n            ((__local\n              int64_t *) red_arr_mem_28426)[sext_i32_i64(local_tid_28422)] =\n                x_25406;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_28441;\n        int32_t skip_waves_28442;\n        \n        skip_waves_28442 = 1;\n        \n        int64_t x_28437;\n        int64_t x_28438;\n        \n        offset_28441 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_28422,\n                      sext_i64_i32(seghist_group_sizze_25400))) {\n                x_28437 = ((__local\n                            int64_t *) red_arr_mem_28426)[sext_i32_i64(local_tid_28422 +\n                                                          offset_28441)];\n            }\n        }\n        offset_28441 = 1;\n        while (slt32(offset_28441, wave_sizze_28424)) {\n            if (slt32(local_tid_28422 + offset_28441,\n                      sext_i64_i32(seghist_group_sizze_25400)) &&\n                ((local_tid_28422 - squot32(local_tid_28422, wave_sizze_28424) *\n                  wave_sizze_28424) & (2 * offset_28441 - 1)) == 0) {\n                // read array element\n                {\n                    x_28438 = ((volatile __local\n                                int64_t *) red_arr_mem_28426)[sext_i32_i64(local_tid_28422 +\n                                                              offset_28441)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_28439 = smax64(x_28437, x_28438);\n                    \n                    x_28437 = res_28439;\n                }\n                // write result of op",
                   "eration\n                {\n                    ((volatile __local\n                      int64_t *) red_arr_mem_28426)[sext_i32_i64(local_tid_28422)] =\n                        x_28437;\n                }\n            }\n            offset_28441 *= 2;\n        }\n        while (slt32(skip_waves_28442,\n                     squot32(sext_i64_i32(seghist_group_sizze_25400) +\n                             wave_sizze_28424 - 1, wave_sizze_28424))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_28441 = skip_waves_28442 * wave_sizze_28424;\n            if (slt32(local_tid_28422 + offset_28441,\n                      sext_i64_i32(seghist_group_sizze_25400)) &&\n                ((local_tid_28422 - squot32(local_tid_28422, wave_sizze_28424) *\n                  wave_sizze_28424) == 0 && (squot32(local_tid_28422,\n                                                     wave_sizze_28424) & (2 *\n                                                                          skip_waves_28442 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_28438 = ((__local\n                                int64_t *) red_arr_mem_28426)[sext_i32_i64(local_tid_28422 +\n                                                              offset_28441)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_28439 = smax64(x_28437, x_28438);\n                    \n                    x_28437 = res_28439;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_28426)[sext_i32_i64(local_tid_28422)] =\n                        x_28437;\n                }\n            }\n            skip_waves_28442 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i3",
                   "2_i64(local_tid_28422) == 0) {\n                x_acc_28435 = x_28437;\n            }\n        }\n        if (groups_per_segment_28412 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_28422 == 0) {\n                    ((__global int64_t *) mem_27807)[bucket_id_28388] =\n                        x_acc_28435;\n                }\n            }\n        } else {\n            int32_t old_counter_28443;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_28422 == 0) {\n                    ((__global\n                      int64_t *) group_res_arr_mem_28417)[sext_i32_i64(virt_group_id_28432) *\n                                                          seghist_group_sizze_25400] =\n                        x_acc_28435;\n                    mem_fence_global();\n                    old_counter_28443 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_28419)[sext_i32_i64(srem32(flat_segment_id_28433,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_28428)[0] =\n                        old_counter_28443 == groups_per_segment_28412 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_28444;\n            \n            is_last_group_28444 = ((__local bool *) sync_arr_mem_28428)[0];\n            if (is_last_group_28444) {\n                if (local_tid_28422 == 0) {\n                    old_counter_28443 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_28419)[sext_i32_i64(srem32(flat_segment_id_28433,\n                    ",
                   "                                                                                 10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_28412));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_28445 =\n                            sdiv_up64(groups_per_segment_28412,\n                                      seghist_group_sizze_25400);\n                    \n                    x_25406 = 0;\n                    for (int64_t i_28446 = 0; i_28446 < read_per_thread_28445;\n                         i_28446++) {\n                        int64_t group_res_id_28447 =\n                                sext_i32_i64(local_tid_28422) *\n                                read_per_thread_28445 + i_28446;\n                        int64_t index_of_group_res_28448 =\n                                sext_i32_i64(flat_segment_id_28433) *\n                                groups_per_segment_28412 + group_res_id_28447;\n                        \n                        if (slt64(group_res_id_28447,\n                                  groups_per_segment_28412)) {\n                            x_25407 = ((__global\n                                        int64_t *) group_res_arr_mem_28417)[index_of_group_res_28448 *\n                                                                            seghist_group_sizze_25400];\n                            \n                            int64_t res_25408;\n                            \n                            res_25408 = smax64(x_25406, x_25407);\n                            x_25406 = res_25408;\n                        }\n                    }\n                }\n                ((__local\n                  int64_t *) red_arr_mem_28426)[sext_i32_i64(local_tid_28422)] =\n                    x_25406;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n           ",
                   "         int32_t offset_28449;\n                    int32_t skip_waves_28450;\n                    \n                    skip_waves_28450 = 1;\n                    \n                    int64_t x_28437;\n                    int64_t x_28438;\n                    \n                    offset_28449 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_28422,\n                                  sext_i64_i32(seghist_group_sizze_25400))) {\n                            x_28437 = ((__local\n                                        int64_t *) red_arr_mem_28426)[sext_i32_i64(local_tid_28422 +\n                                                                      offset_28449)];\n                        }\n                    }\n                    offset_28449 = 1;\n                    while (slt32(offset_28449, wave_sizze_28424)) {\n                        if (slt32(local_tid_28422 + offset_28449,\n                                  sext_i64_i32(seghist_group_sizze_25400)) &&\n                            ((local_tid_28422 - squot32(local_tid_28422,\n                                                        wave_sizze_28424) *\n                              wave_sizze_28424) & (2 * offset_28449 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_28438 = ((volatile __local\n                                            int64_t *) red_arr_mem_28426)[sext_i32_i64(local_tid_28422 +\n                                                                          offset_28449)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_28439 = smax64(x_28437, x_28438);\n                                \n                                x_28437 = res_28439;\n                            }\n                            // write result of",
                   " operation\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_28426)[sext_i32_i64(local_tid_28422)] =\n                                    x_28437;\n                            }\n                        }\n                        offset_28449 *= 2;\n                    }\n                    while (slt32(skip_waves_28450,\n                                 squot32(sext_i64_i32(seghist_group_sizze_25400) +\n                                         wave_sizze_28424 - 1,\n                                         wave_sizze_28424))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_28449 = skip_waves_28450 * wave_sizze_28424;\n                        if (slt32(local_tid_28422 + offset_28449,\n                                  sext_i64_i32(seghist_group_sizze_25400)) &&\n                            ((local_tid_28422 - squot32(local_tid_28422,\n                                                        wave_sizze_28424) *\n                              wave_sizze_28424) == 0 &&\n                             (squot32(local_tid_28422, wave_sizze_28424) & (2 *\n                                                                            skip_waves_28450 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_28438 = ((__local\n                                            int64_t *) red_arr_mem_28426)[sext_i32_i64(local_tid_28422 +\n                                                                          offset_28449)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_28439 = smax64(x_28437, x_28438);\n                                \n                                x_28437 = res_28439;\n     ",
                   "                       }\n                            // write result of operation\n                            {\n                                ((__local\n                                  int64_t *) red_arr_mem_28426)[sext_i32_i64(local_tid_28422)] =\n                                    x_28437;\n                            }\n                        }\n                        skip_waves_28450 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_28422 == 0) {\n                            ((__global int64_t *) mem_27807)[bucket_id_28388] =\n                                x_28437;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_25400\n}\n__kernel void mainzisegred_nonseg_24268(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28074_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28072_backing_aligned_1,\n                                        int64_t n_23312,\n                                        int64_t num_groups_24263, __global\n                                        unsigned char *swap_term_mem_27668,\n                                        __global\n                                        unsigned char *payments_mem_27669,\n                                        __global unsigned char *mem_27673,\n                                        __global\n                                        unsigned char *mainzicounter_mem_28062,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28064,\n                                        int64_t num_threads_28066)\n{\n    #",
                   "define segred_group_sizze_24261 (mainzisegred_group_sizze_24260)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28074_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28074_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28072_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28072_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28067;\n    int32_t local_tid_28068;\n    int64_t group_sizze_28071;\n    int32_t wave_sizze_28070;\n    int32_t group_tid_28069;\n    \n    global_tid_28067 = get_global_id(0);\n    local_tid_28068 = get_local_id(0);\n    group_sizze_28071 = get_local_size(0);\n    wave_sizze_28070 = LOCKSTEP_WIDTH;\n    group_tid_28069 = get_group_id(0);\n    \n    int32_t phys_tid_24268;\n    \n    phys_tid_24268 = global_tid_28067;\n    \n    __local char *sync_arr_mem_28072;\n    \n    sync_arr_mem_28072 = (__local char *) sync_arr_mem_28072_backing_0;\n    \n    __local char *red_arr_mem_28074;\n    \n    red_arr_mem_28074 = (__local char *) red_arr_mem_28074_backing_1;\n    \n    int64_t dummy_24266;\n    \n    dummy_24266 = 0;\n    \n    int64_t gtid_24267;\n    \n    gtid_24267 = 0;\n    \n    float x_acc_28076;\n    int64_t chunk_sizze_28077;\n    \n    chunk_sizze_28077 = smin64(sdiv_up64(n_23312,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_24261 *\n                                         num_groups_24263))),\n                               sdiv_up64(n_23312 - sext_i32_i64(phys_tid_24268),\n                                         num_threads_28066));\n    \n    float x_23330;\n    float x_23331;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28076 = -INFINITY;\n    }\n    for (int64_t i_28081 = 0; i_28081 < chunk_sizze_28077; i_28081++) {\n        gtid_24267",
                   " = sext_i32_i64(phys_tid_24268) + num_threads_28066 * i_28081;\n        // apply map function\n        {\n            float x_23333 = ((__global\n                              float *) swap_term_mem_27668)[gtid_24267];\n            int64_t x_23334 = ((__global\n                                int64_t *) payments_mem_27669)[gtid_24267];\n            float res_23335 = sitofp_i64_f32(x_23334);\n            float res_23336 = x_23333 * res_23335;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_23330 = x_acc_28076;\n            }\n            // load new values\n            {\n                x_23331 = res_23336;\n            }\n            // apply reduction operator\n            {\n                float res_23332 = fmax32(x_23330, x_23331);\n                \n                // store in accumulator\n                {\n                    x_acc_28076 = res_23332;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_23330 = x_acc_28076;\n        ((__local float *) red_arr_mem_28074)[sext_i32_i64(local_tid_28068)] =\n            x_23330;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28082;\n    int32_t skip_waves_28083;\n    \n    skip_waves_28083 = 1;\n    \n    float x_28078;\n    float x_28079;\n    \n    offset_28082 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28068, sext_i64_i32(segred_group_sizze_24261))) {\n            x_28078 = ((__local\n                        float *) red_arr_mem_28074)[sext_i32_i64(local_tid_28068 +\n                                                    offset_28082)];\n        }\n    }\n    offset_28082 = 1;\n    while (slt32(offset_28082, wave_sizze_28070)) {\n        if (slt32(local_tid_28068 + offset_28082,\n                  sext_i64_i32(segred_group_sizze_24261)) && ((local_tid_28068 -\n                                                               squot32(loc",
                   "al_tid_28068,\n                                                                       wave_sizze_28070) *\n                                                               wave_sizze_28070) &\n                                                              (2 *\n                                                               offset_28082 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28079 = ((volatile __local\n                            float *) red_arr_mem_28074)[sext_i32_i64(local_tid_28068 +\n                                                        offset_28082)];\n            }\n            // apply reduction operation\n            {\n                float res_28080 = fmax32(x_28078, x_28079);\n                \n                x_28078 = res_28080;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_28074)[sext_i32_i64(local_tid_28068)] =\n                    x_28078;\n            }\n        }\n        offset_28082 *= 2;\n    }\n    while (slt32(skip_waves_28083,\n                 squot32(sext_i64_i32(segred_group_sizze_24261) +\n                         wave_sizze_28070 - 1, wave_sizze_28070))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28082 = skip_waves_28083 * wave_sizze_28070;\n        if (slt32(local_tid_28068 + offset_28082,\n                  sext_i64_i32(segred_group_sizze_24261)) && ((local_tid_28068 -\n                                                               squot32(local_tid_28068,\n                                                                       wave_sizze_28070) *\n                                                               wave_sizze_28070) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28068,\n                                                                       ",
                   "wave_sizze_28070) &\n                                                               (2 *\n                                                                skip_waves_28083 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28079 = ((__local\n                            float *) red_arr_mem_28074)[sext_i32_i64(local_tid_28068 +\n                                                        offset_28082)];\n            }\n            // apply reduction operation\n            {\n                float res_28080 = fmax32(x_28078, x_28079);\n                \n                x_28078 = res_28080;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_28074)[sext_i32_i64(local_tid_28068)] =\n                    x_28078;\n            }\n        }\n        skip_waves_28083 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28068) == 0) {\n            x_acc_28076 = x_28078;\n        }\n    }\n    \n    int32_t old_counter_28084;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28068 == 0) {\n            ((__global\n              float *) group_res_arr_mem_28064)[sext_i32_i64(group_tid_28069) *\n                                                segred_group_sizze_24261] =\n                x_acc_28076;\n            mem_fence_global();\n            old_counter_28084 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28062)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28072)[0] = old_counter_28084 ==\n                num_groups_24263 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28085;\n    \n    is_last_group_2808",
                   "5 = ((__local bool *) sync_arr_mem_28072)[0];\n    if (is_last_group_28085) {\n        if (local_tid_28068 == 0) {\n            old_counter_28084 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28062)[0],\n                                                      (int) (0 -\n                                                             num_groups_24263));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28086 = sdiv_up64(num_groups_24263,\n                                                      segred_group_sizze_24261);\n            \n            x_23330 = -INFINITY;\n            for (int64_t i_28087 = 0; i_28087 < read_per_thread_28086;\n                 i_28087++) {\n                int64_t group_res_id_28088 = sext_i32_i64(local_tid_28068) *\n                        read_per_thread_28086 + i_28087;\n                int64_t index_of_group_res_28089 = group_res_id_28088;\n                \n                if (slt64(group_res_id_28088, num_groups_24263)) {\n                    x_23331 = ((__global\n                                float *) group_res_arr_mem_28064)[index_of_group_res_28089 *\n                                                                  segred_group_sizze_24261];\n                    \n                    float res_23332;\n                    \n                    res_23332 = fmax32(x_23330, x_23331);\n                    x_23330 = res_23332;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_28074)[sext_i32_i64(local_tid_28068)] =\n            x_23330;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28090;\n            int32_t skip_waves_28091;\n            \n            skip_waves_28091 = 1;\n            \n            float x_28078;\n            float x_28079;\n            \n            offset_28090 = 0;\n            // participating threads read initial accumulat",
                   "or\n            {\n                if (slt32(local_tid_28068,\n                          sext_i64_i32(segred_group_sizze_24261))) {\n                    x_28078 = ((__local\n                                float *) red_arr_mem_28074)[sext_i32_i64(local_tid_28068 +\n                                                            offset_28090)];\n                }\n            }\n            offset_28090 = 1;\n            while (slt32(offset_28090, wave_sizze_28070)) {\n                if (slt32(local_tid_28068 + offset_28090,\n                          sext_i64_i32(segred_group_sizze_24261)) &&\n                    ((local_tid_28068 - squot32(local_tid_28068,\n                                                wave_sizze_28070) *\n                      wave_sizze_28070) & (2 * offset_28090 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28079 = ((volatile __local\n                                    float *) red_arr_mem_28074)[sext_i32_i64(local_tid_28068 +\n                                                                offset_28090)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28080 = fmax32(x_28078, x_28079);\n                        \n                        x_28078 = res_28080;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_28074)[sext_i32_i64(local_tid_28068)] =\n                            x_28078;\n                    }\n                }\n                offset_28090 *= 2;\n            }\n            while (slt32(skip_waves_28091,\n                         squot32(sext_i64_i32(segred_group_sizze_24261) +\n                                 wave_sizze_28070 - 1, wave_sizze_28070))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28090 = skip_waves_28091 * wave_sizze_28070;\n                if (slt32(lo",
                   "cal_tid_28068 + offset_28090,\n                          sext_i64_i32(segred_group_sizze_24261)) &&\n                    ((local_tid_28068 - squot32(local_tid_28068,\n                                                wave_sizze_28070) *\n                      wave_sizze_28070) == 0 && (squot32(local_tid_28068,\n                                                         wave_sizze_28070) &\n                                                 (2 * skip_waves_28091 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28079 = ((__local\n                                    float *) red_arr_mem_28074)[sext_i32_i64(local_tid_28068 +\n                                                                offset_28090)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28080 = fmax32(x_28078, x_28079);\n                        \n                        x_28078 = res_28080;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_28074)[sext_i32_i64(local_tid_28068)] =\n                            x_28078;\n                    }\n                }\n                skip_waves_28091 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28068 == 0) {\n                    ((__global float *) mem_27673)[0] = x_28078;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_24261\n}\n__kernel void mainzisegred_nonseg_25397(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28276_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28274_backing_aligned_1,\n  ",
                   "                                      int64_t num_groups_25392,\n                                        int64_t binop_x_27752, __global\n                                        unsigned char *mem_27802, __global\n                                        unsigned char *mem_27805, __global\n                                        unsigned char *mainzicounter_mem_28264,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28266,\n                                        int64_t num_threads_28268)\n{\n    #define segred_group_sizze_25390 (mainzisegred_group_sizze_25389)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28276_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28276_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28274_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28274_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28269;\n    int32_t local_tid_28270;\n    int64_t group_sizze_28273;\n    int32_t wave_sizze_28272;\n    int32_t group_tid_28271;\n    \n    global_tid_28269 = get_global_id(0);\n    local_tid_28270 = get_local_id(0);\n    group_sizze_28273 = get_local_size(0);\n    wave_sizze_28272 = LOCKSTEP_WIDTH;\n    group_tid_28271 = get_group_id(0);\n    \n    int32_t phys_tid_25397;\n    \n    phys_tid_25397 = global_tid_28269;\n    \n    __local char *sync_arr_mem_28274;\n    \n    sync_arr_mem_28274 = (__local char *) sync_arr_mem_28274_backing_0;\n    \n    __local char *red_arr_mem_28276;\n    \n    red_arr_mem_28276 = (__local char *) red_arr_mem_28276_backing_1;\n    \n    int64_t dummy_25395;\n    \n    dummy_25395 = 0;\n    \n    int64_t gtid_25396;\n    \n    gtid_25396 = 0;\n    \n    int64_t x_acc_28278;\n    int64_t chunk_sizze_28279;\n    \n    ",
                   "chunk_sizze_28279 = smin64(sdiv_up64(binop_x_27752,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_25390 *\n                                         num_groups_25392))),\n                               sdiv_up64(binop_x_27752 -\n                                         sext_i32_i64(phys_tid_25397),\n                                         num_threads_28268));\n    \n    int64_t x_23532;\n    int64_t x_23533;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28278 = 0;\n    }\n    for (int64_t i_28283 = 0; i_28283 < chunk_sizze_28279; i_28283++) {\n        gtid_25396 = sext_i32_i64(phys_tid_25397) + num_threads_28268 * i_28283;\n        // apply map function\n        {\n            int64_t x_23535 = ((__global int64_t *) mem_27802)[gtid_25396];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_23532 = x_acc_28278;\n            }\n            // load new values\n            {\n                x_23533 = x_23535;\n            }\n            // apply reduction operator\n            {\n                int64_t res_23534 = add64(x_23532, x_23533);\n                \n                // store in accumulator\n                {\n                    x_acc_28278 = res_23534;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_23532 = x_acc_28278;\n        ((__local int64_t *) red_arr_mem_28276)[sext_i32_i64(local_tid_28270)] =\n            x_23532;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28284;\n    int32_t skip_waves_28285;\n    \n    skip_waves_28285 = 1;\n    \n    int64_t x_28280;\n    int64_t x_28281;\n    \n    offset_28284 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28270, sext_i64_i32(segred_group_sizze_25390))) {\n            x_28280 = ((__local\n                        int64_t *) red_arr_mem_28276)[sext_i32_i64(local_tid_282",
                   "70 +\n                                                      offset_28284)];\n        }\n    }\n    offset_28284 = 1;\n    while (slt32(offset_28284, wave_sizze_28272)) {\n        if (slt32(local_tid_28270 + offset_28284,\n                  sext_i64_i32(segred_group_sizze_25390)) && ((local_tid_28270 -\n                                                               squot32(local_tid_28270,\n                                                                       wave_sizze_28272) *\n                                                               wave_sizze_28272) &\n                                                              (2 *\n                                                               offset_28284 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28281 = ((volatile __local\n                            int64_t *) red_arr_mem_28276)[sext_i32_i64(local_tid_28270 +\n                                                          offset_28284)];\n            }\n            // apply reduction operation\n            {\n                int64_t res_28282 = add64(x_28280, x_28281);\n                \n                x_28280 = res_28282;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_28276)[sext_i32_i64(local_tid_28270)] =\n                    x_28280;\n            }\n        }\n        offset_28284 *= 2;\n    }\n    while (slt32(skip_waves_28285,\n                 squot32(sext_i64_i32(segred_group_sizze_25390) +\n                         wave_sizze_28272 - 1, wave_sizze_28272))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28284 = skip_waves_28285 * wave_sizze_28272;\n        if (slt32(local_tid_28270 + offset_28284,\n                  sext_i64_i32(segred_group_sizze_25390)) && ((local_tid_28270 -\n                                                               squot32(local_tid_28270,\n                        ",
                   "                                               wave_sizze_28272) *\n                                                               wave_sizze_28272) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28270,\n                                                                       wave_sizze_28272) &\n                                                               (2 *\n                                                                skip_waves_28285 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28281 = ((__local\n                            int64_t *) red_arr_mem_28276)[sext_i32_i64(local_tid_28270 +\n                                                          offset_28284)];\n            }\n            // apply reduction operation\n            {\n                int64_t res_28282 = add64(x_28280, x_28281);\n                \n                x_28280 = res_28282;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_28276)[sext_i32_i64(local_tid_28270)] =\n                    x_28280;\n            }\n        }\n        skip_waves_28285 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28270) == 0) {\n            x_acc_28278 = x_28280;\n        }\n    }\n    \n    int32_t old_counter_28286;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28270 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_28266)[sext_i32_i64(group_tid_28271) *\n                                                  segred_group_sizze_25390] =\n                x_acc_28278;\n            mem_fence_global();\n            old_counter_28286 = atomic_add_i32_global(&((volatile __global\n                  ",
                   "                                       int *) mainzicounter_mem_28264)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28274)[0] = old_counter_28286 ==\n                num_groups_25392 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28287;\n    \n    is_last_group_28287 = ((__local bool *) sync_arr_mem_28274)[0];\n    if (is_last_group_28287) {\n        if (local_tid_28270 == 0) {\n            old_counter_28286 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28264)[0],\n                                                      (int) (0 -\n                                                             num_groups_25392));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28288 = sdiv_up64(num_groups_25392,\n                                                      segred_group_sizze_25390);\n            \n            x_23532 = 0;\n            for (int64_t i_28289 = 0; i_28289 < read_per_thread_28288;\n                 i_28289++) {\n                int64_t group_res_id_28290 = sext_i32_i64(local_tid_28270) *\n                        read_per_thread_28288 + i_28289;\n                int64_t index_of_group_res_28291 = group_res_id_28290;\n                \n                if (slt64(group_res_id_28290, num_groups_25392)) {\n                    x_23533 = ((__global\n                                int64_t *) group_res_arr_mem_28266)[index_of_group_res_28291 *\n                                                                    segred_group_sizze_25390];\n                    \n                    int64_t res_23534;\n                    \n                    res_23534 = add64(x_23532, x_23533);\n                    x_23532 = res_23534;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_28276)[sext_i32_i64(local_tid_28270)] =\n          ",
                   "  x_23532;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28292;\n            int32_t skip_waves_28293;\n            \n            skip_waves_28293 = 1;\n            \n            int64_t x_28280;\n            int64_t x_28281;\n            \n            offset_28292 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28270,\n                          sext_i64_i32(segred_group_sizze_25390))) {\n                    x_28280 = ((__local\n                                int64_t *) red_arr_mem_28276)[sext_i32_i64(local_tid_28270 +\n                                                              offset_28292)];\n                }\n            }\n            offset_28292 = 1;\n            while (slt32(offset_28292, wave_sizze_28272)) {\n                if (slt32(local_tid_28270 + offset_28292,\n                          sext_i64_i32(segred_group_sizze_25390)) &&\n                    ((local_tid_28270 - squot32(local_tid_28270,\n                                                wave_sizze_28272) *\n                      wave_sizze_28272) & (2 * offset_28292 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28281 = ((volatile __local\n                                    int64_t *) red_arr_mem_28276)[sext_i32_i64(local_tid_28270 +\n                                                                  offset_28292)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_28282 = add64(x_28280, x_28281);\n                        \n                        x_28280 = res_28282;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28276)[sext_i32_i64(local_tid_28270)] =\n                            x_28280;\n                    }\n ",
                   "               }\n                offset_28292 *= 2;\n            }\n            while (slt32(skip_waves_28293,\n                         squot32(sext_i64_i32(segred_group_sizze_25390) +\n                                 wave_sizze_28272 - 1, wave_sizze_28272))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28292 = skip_waves_28293 * wave_sizze_28272;\n                if (slt32(local_tid_28270 + offset_28292,\n                          sext_i64_i32(segred_group_sizze_25390)) &&\n                    ((local_tid_28270 - squot32(local_tid_28270,\n                                                wave_sizze_28272) *\n                      wave_sizze_28272) == 0 && (squot32(local_tid_28270,\n                                                         wave_sizze_28272) &\n                                                 (2 * skip_waves_28293 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28281 = ((__local\n                                    int64_t *) red_arr_mem_28276)[sext_i32_i64(local_tid_28270 +\n                                                                  offset_28292)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_28282 = add64(x_28280, x_28281);\n                        \n                        x_28280 = res_28282;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_28276)[sext_i32_i64(local_tid_28270)] =\n                            x_28280;\n                    }\n                }\n                skip_waves_28293 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28270 == 0) {\n                    ((__global int64_t *) mem_27805)[0] = x_28280;\n                }\n            }\n        }\n    }\n    \n  error_1",
                   ":\n    return;\n    #undef segred_group_sizze_25390\n}\n__kernel void mainzisegred_nonseg_25507(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28737_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28735_backing_aligned_1,\n                                        int64_t n_23312, int64_t paths_23315,\n                                        int64_t steps_23316, float a_23320,\n                                        float x_23340, float x_23342,\n                                        float y_23344, float y_23345,\n                                        float sims_per_year_23422,\n                                        float res_23750,\n                                        int64_t num_groups_25510, __global\n                                        unsigned char *mem_27839, __global\n                                        unsigned char *mem_27842, __global\n                                        unsigned char *mem_27844, __global\n                                        unsigned char *mainzicounter_mem_28725,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28727,\n                                        int64_t num_threads_28729)\n{\n    #define segred_group_sizze_25509 (mainzisegred_group_sizze_25498)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28737_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28737_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28735_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28735_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int3",
                   "2_t global_tid_28730;\n    int32_t local_tid_28731;\n    int64_t group_sizze_28734;\n    int32_t wave_sizze_28733;\n    int32_t group_tid_28732;\n    \n    global_tid_28730 = get_global_id(0);\n    local_tid_28731 = get_local_id(0);\n    group_sizze_28734 = get_local_size(0);\n    wave_sizze_28733 = LOCKSTEP_WIDTH;\n    group_tid_28732 = get_group_id(0);\n    \n    int32_t phys_tid_25507;\n    \n    phys_tid_25507 = global_tid_28730;\n    \n    __local char *sync_arr_mem_28735;\n    \n    sync_arr_mem_28735 = (__local char *) sync_arr_mem_28735_backing_0;\n    \n    __local char *red_arr_mem_28737;\n    \n    red_arr_mem_28737 = (__local char *) red_arr_mem_28737_backing_1;\n    \n    int64_t dummy_25505;\n    \n    dummy_25505 = 0;\n    \n    int64_t gtid_25506;\n    \n    gtid_25506 = 0;\n    \n    float x_acc_28739;\n    int64_t chunk_sizze_28740;\n    \n    chunk_sizze_28740 = smin64(sdiv_up64(steps_23316,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_25509 *\n                                         num_groups_25510))),\n                               sdiv_up64(steps_23316 -\n                                         sext_i32_i64(phys_tid_25507),\n                                         num_threads_28729));\n    \n    float x_25514;\n    float x_25515;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28739 = 0.0F;\n    }\n    for (int64_t i_28744 = 0; i_28744 < chunk_sizze_28740; i_28744++) {\n        gtid_25506 = sext_i32_i64(phys_tid_25507) + num_threads_28729 * i_28744;\n        // apply map function\n        {\n            int64_t convop_x_27583 = add64(1, gtid_25506);\n            float binop_x_27584 = sitofp_i64_f32(convop_x_27583);\n            float index_primexp_27585 = binop_x_27584 / sims_per_year_23422;\n            float res_25519;\n            float redout_27645 = 0.0F;\n            \n            for (int64_t i_27646 = 0; i_27646 < paths_23315; i_27646++) {\n                float res_25524;\n                float redout_27647 = 0.0F;\n          ",
                   "      \n                for (int64_t i_27648 = 0; i_27648 < n_23312; i_27648++) {\n                    float x_25528 = ((__global float *) mem_27839)[i_27646 *\n                                                                   (steps_23316 *\n                                                                    n_23312) +\n                                                                   i_27648 *\n                                                                   steps_23316 +\n                                                                   gtid_25506];\n                    float res_25527 = x_25528 + redout_27647;\n                    float redout_tmp_28746 = res_25527;\n                    \n                    redout_27647 = redout_tmp_28746;\n                }\n                res_25524 = redout_27647;\n                \n                float res_25529 = fmax32(0.0F, res_25524);\n                float res_25522 = res_25529 + redout_27645;\n                float redout_tmp_28745 = res_25522;\n                \n                redout_27645 = redout_tmp_28745;\n            }\n            res_25519 = redout_27645;\n            \n            float res_25530 = res_25519 / res_23750;\n            float negate_arg_25531 = a_23320 * index_primexp_27585;\n            float exp_arg_25532 = 0.0F - negate_arg_25531;\n            float res_25533 = fpow32(2.7182817F, exp_arg_25532);\n            float x_25534 = 1.0F - res_25533;\n            float B_25535 = x_25534 / a_23320;\n            float x_25536 = B_25535 - index_primexp_27585;\n            float x_25537 = y_23344 * x_25536;\n            float A1_25538 = x_25537 / x_23340;\n            float y_25539 = fpow32(B_25535, 2.0F);\n            float x_25540 = x_23342 * y_25539;\n            float A2_25541 = x_25540 / y_23345;\n            float exp_arg_25542 = A1_25538 - A2_25541;\n            float res_25543 = fpow32(2.7182817F, exp_arg_25542);\n            float negate_arg_25544 = 5.0e-2F * B_25535;\n            float exp_arg_25545 = 0.0F - negate_arg_25544;",
                   "\n            float res_25546 = fpow32(2.7182817F, exp_arg_25545);\n            float res_25547 = res_25543 * res_25546;\n            float res_25548 = res_25530 * res_25547;\n            \n            // save map-out results\n            {\n                ((__global float *) mem_27844)[dummy_25505 * steps_23316 +\n                                               gtid_25506] = res_25530;\n            }\n            // load accumulator\n            {\n                x_25514 = x_acc_28739;\n            }\n            // load new values\n            {\n                x_25515 = res_25548;\n            }\n            // apply reduction operator\n            {\n                float res_25516 = x_25514 + x_25515;\n                \n                // store in accumulator\n                {\n                    x_acc_28739 = res_25516;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_25514 = x_acc_28739;\n        ((__local float *) red_arr_mem_28737)[sext_i32_i64(local_tid_28731)] =\n            x_25514;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28747;\n    int32_t skip_waves_28748;\n    \n    skip_waves_28748 = 1;\n    \n    float x_28741;\n    float x_28742;\n    \n    offset_28747 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28731, sext_i64_i32(segred_group_sizze_25509))) {\n            x_28741 = ((__local\n                        float *) red_arr_mem_28737)[sext_i32_i64(local_tid_28731 +\n                                                    offset_28747)];\n        }\n    }\n    offset_28747 = 1;\n    while (slt32(offset_28747, wave_sizze_28733)) {\n        if (slt32(local_tid_28731 + offset_28747,\n                  sext_i64_i32(segred_group_sizze_25509)) && ((local_tid_28731 -\n                                                               squot32(local_tid_28731,\n                                                                       wave_sizze_28733) *\n         ",
                   "                                                      wave_sizze_28733) &\n                                                              (2 *\n                                                               offset_28747 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28742 = ((volatile __local\n                            float *) red_arr_mem_28737)[sext_i32_i64(local_tid_28731 +\n                                                        offset_28747)];\n            }\n            // apply reduction operation\n            {\n                float res_28743 = x_28741 + x_28742;\n                \n                x_28741 = res_28743;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_28737)[sext_i32_i64(local_tid_28731)] =\n                    x_28741;\n            }\n        }\n        offset_28747 *= 2;\n    }\n    while (slt32(skip_waves_28748,\n                 squot32(sext_i64_i32(segred_group_sizze_25509) +\n                         wave_sizze_28733 - 1, wave_sizze_28733))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28747 = skip_waves_28748 * wave_sizze_28733;\n        if (slt32(local_tid_28731 + offset_28747,\n                  sext_i64_i32(segred_group_sizze_25509)) && ((local_tid_28731 -\n                                                               squot32(local_tid_28731,\n                                                                       wave_sizze_28733) *\n                                                               wave_sizze_28733) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28731,\n                                                                       wave_sizze_28733) &\n                                                               (2 *\n                                 ",
                   "                               skip_waves_28748 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28742 = ((__local\n                            float *) red_arr_mem_28737)[sext_i32_i64(local_tid_28731 +\n                                                        offset_28747)];\n            }\n            // apply reduction operation\n            {\n                float res_28743 = x_28741 + x_28742;\n                \n                x_28741 = res_28743;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_28737)[sext_i32_i64(local_tid_28731)] =\n                    x_28741;\n            }\n        }\n        skip_waves_28748 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28731) == 0) {\n            x_acc_28739 = x_28741;\n        }\n    }\n    \n    int32_t old_counter_28749;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28731 == 0) {\n            ((__global\n              float *) group_res_arr_mem_28727)[sext_i32_i64(group_tid_28732) *\n                                                segred_group_sizze_25509] =\n                x_acc_28739;\n            mem_fence_global();\n            old_counter_28749 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28725)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28735)[0] = old_counter_28749 ==\n                num_groups_25510 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28750;\n    \n    is_last_group_28750 = ((__local bool *) sync_arr_mem_28735)[0];\n    if (is_last_group_28750) {\n        if (local_tid_28731 == 0) {\n            old",
                   "_counter_28749 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28725)[0],\n                                                      (int) (0 -\n                                                             num_groups_25510));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28751 = sdiv_up64(num_groups_25510,\n                                                      segred_group_sizze_25509);\n            \n            x_25514 = 0.0F;\n            for (int64_t i_28752 = 0; i_28752 < read_per_thread_28751;\n                 i_28752++) {\n                int64_t group_res_id_28753 = sext_i32_i64(local_tid_28731) *\n                        read_per_thread_28751 + i_28752;\n                int64_t index_of_group_res_28754 = group_res_id_28753;\n                \n                if (slt64(group_res_id_28753, num_groups_25510)) {\n                    x_25515 = ((__global\n                                float *) group_res_arr_mem_28727)[index_of_group_res_28754 *\n                                                                  segred_group_sizze_25509];\n                    \n                    float res_25516;\n                    \n                    res_25516 = x_25514 + x_25515;\n                    x_25514 = res_25516;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_28737)[sext_i32_i64(local_tid_28731)] =\n            x_25514;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28755;\n            int32_t skip_waves_28756;\n            \n            skip_waves_28756 = 1;\n            \n            float x_28741;\n            float x_28742;\n            \n            offset_28755 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28731,\n                          sext_i64_i32(segred_group_sizze_25509))) {\n           ",
                   "         x_28741 = ((__local\n                                float *) red_arr_mem_28737)[sext_i32_i64(local_tid_28731 +\n                                                            offset_28755)];\n                }\n            }\n            offset_28755 = 1;\n            while (slt32(offset_28755, wave_sizze_28733)) {\n                if (slt32(local_tid_28731 + offset_28755,\n                          sext_i64_i32(segred_group_sizze_25509)) &&\n                    ((local_tid_28731 - squot32(local_tid_28731,\n                                                wave_sizze_28733) *\n                      wave_sizze_28733) & (2 * offset_28755 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28742 = ((volatile __local\n                                    float *) red_arr_mem_28737)[sext_i32_i64(local_tid_28731 +\n                                                                offset_28755)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28743 = x_28741 + x_28742;\n                        \n                        x_28741 = res_28743;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_28737)[sext_i32_i64(local_tid_28731)] =\n                            x_28741;\n                    }\n                }\n                offset_28755 *= 2;\n            }\n            while (slt32(skip_waves_28756,\n                         squot32(sext_i64_i32(segred_group_sizze_25509) +\n                                 wave_sizze_28733 - 1, wave_sizze_28733))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28755 = skip_waves_28756 * wave_sizze_28733;\n                if (slt32(local_tid_28731 + offset_28755,\n                          sext_i64_i32(segred_group_sizze_25509)) &&\n                    ((local_tid_28731 - squot32(",
                   "local_tid_28731,\n                                                wave_sizze_28733) *\n                      wave_sizze_28733) == 0 && (squot32(local_tid_28731,\n                                                         wave_sizze_28733) &\n                                                 (2 * skip_waves_28756 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28742 = ((__local\n                                    float *) red_arr_mem_28737)[sext_i32_i64(local_tid_28731 +\n                                                                offset_28755)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28743 = x_28741 + x_28742;\n                        \n                        x_28741 = res_28743;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_28737)[sext_i32_i64(local_tid_28731)] =\n                            x_28741;\n                    }\n                }\n                skip_waves_28756 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28731 == 0) {\n                    ((__global float *) mem_27842)[0] = x_28741;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_25509\n}\n__kernel void mainzisegred_nonseg_25780(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28861_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28859_backing_aligned_1,\n                                        int64_t steps_23316,\n                                        int64_t num_groups_25912, __global\n                    ",
                   "                    unsigned char *res_map_acc_mem_27878,\n                                        __global unsigned char *mem_27882,\n                                        __global\n                                        unsigned char *mainzicounter_mem_28849,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28851,\n                                        int64_t num_threads_28853)\n{\n    #define segred_group_sizze_25911 (mainzisegred_group_sizze_25772)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28861_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28861_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28859_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28859_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28854;\n    int32_t local_tid_28855;\n    int64_t group_sizze_28858;\n    int32_t wave_sizze_28857;\n    int32_t group_tid_28856;\n    \n    global_tid_28854 = get_global_id(0);\n    local_tid_28855 = get_local_id(0);\n    group_sizze_28858 = get_local_size(0);\n    wave_sizze_28857 = LOCKSTEP_WIDTH;\n    group_tid_28856 = get_group_id(0);\n    \n    int32_t phys_tid_25780;\n    \n    phys_tid_25780 = global_tid_28854;\n    \n    __local char *sync_arr_mem_28859;\n    \n    sync_arr_mem_28859 = (__local char *) sync_arr_mem_28859_backing_0;\n    \n    __local char *red_arr_mem_28861;\n    \n    red_arr_mem_28861 = (__local char *) red_arr_mem_28861_backing_1;\n    \n    int64_t dummy_25778;\n    \n    dummy_25778 = 0;\n    \n    int64_t gtid_25779;\n    \n    gtid_25779 = 0;\n    \n    float x_acc_28863;\n    int64_t chunk_sizze_28864;\n    \n    chunk_sizze_28864 = smin64(sdiv_up64(steps_23316,\n                                         sext_i32_i64(se",
                   "xt_i64_i32(segred_group_sizze_25911 *\n                                         num_groups_25912))),\n                               sdiv_up64(steps_23316 -\n                                         sext_i32_i64(phys_tid_25780),\n                                         num_threads_28853));\n    \n    float x_25915;\n    float x_25916;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28863 = 0.0F;\n    }\n    for (int64_t i_28868 = 0; i_28868 < chunk_sizze_28864; i_28868++) {\n        gtid_25779 = sext_i32_i64(phys_tid_25780) + num_threads_28853 * i_28868;\n        // apply map function\n        {\n            float x_25918 = ((__global\n                              float *) res_map_acc_mem_27878)[gtid_25779];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_25915 = x_acc_28863;\n            }\n            // load new values\n            {\n                x_25916 = x_25918;\n            }\n            // apply reduction operator\n            {\n                float res_25917 = x_25915 + x_25916;\n                \n                // store in accumulator\n                {\n                    x_acc_28863 = res_25917;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_25915 = x_acc_28863;\n        ((__local float *) red_arr_mem_28861)[sext_i32_i64(local_tid_28855)] =\n            x_25915;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28869;\n    int32_t skip_waves_28870;\n    \n    skip_waves_28870 = 1;\n    \n    float x_28865;\n    float x_28866;\n    \n    offset_28869 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28855, sext_i64_i32(segred_group_sizze_25911))) {\n            x_28865 = ((__local\n                        float *) red_arr_mem_28861)[sext_i32_i64(local_tid_28855 +\n                                                    offset_28869)];\n        }\n    }\n",
                   "    offset_28869 = 1;\n    while (slt32(offset_28869, wave_sizze_28857)) {\n        if (slt32(local_tid_28855 + offset_28869,\n                  sext_i64_i32(segred_group_sizze_25911)) && ((local_tid_28855 -\n                                                               squot32(local_tid_28855,\n                                                                       wave_sizze_28857) *\n                                                               wave_sizze_28857) &\n                                                              (2 *\n                                                               offset_28869 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28866 = ((volatile __local\n                            float *) red_arr_mem_28861)[sext_i32_i64(local_tid_28855 +\n                                                        offset_28869)];\n            }\n            // apply reduction operation\n            {\n                float res_28867 = x_28865 + x_28866;\n                \n                x_28865 = res_28867;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_28861)[sext_i32_i64(local_tid_28855)] =\n                    x_28865;\n            }\n        }\n        offset_28869 *= 2;\n    }\n    while (slt32(skip_waves_28870,\n                 squot32(sext_i64_i32(segred_group_sizze_25911) +\n                         wave_sizze_28857 - 1, wave_sizze_28857))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28869 = skip_waves_28870 * wave_sizze_28857;\n        if (slt32(local_tid_28855 + offset_28869,\n                  sext_i64_i32(segred_group_sizze_25911)) && ((local_tid_28855 -\n                                                               squot32(local_tid_28855,\n                                                                       wave_sizze_28857) *\n                                      ",
                   "                         wave_sizze_28857) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28855,\n                                                                       wave_sizze_28857) &\n                                                               (2 *\n                                                                skip_waves_28870 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28866 = ((__local\n                            float *) red_arr_mem_28861)[sext_i32_i64(local_tid_28855 +\n                                                        offset_28869)];\n            }\n            // apply reduction operation\n            {\n                float res_28867 = x_28865 + x_28866;\n                \n                x_28865 = res_28867;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_28861)[sext_i32_i64(local_tid_28855)] =\n                    x_28865;\n            }\n        }\n        skip_waves_28870 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28855) == 0) {\n            x_acc_28863 = x_28865;\n        }\n    }\n    \n    int32_t old_counter_28871;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28855 == 0) {\n            ((__global\n              float *) group_res_arr_mem_28851)[sext_i32_i64(group_tid_28856) *\n                                                segred_group_sizze_25911] =\n                x_acc_28863;\n            mem_fence_global();\n            old_counter_28871 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28849)[0],\n                                                ",
                   "      (int) 1);\n            ((__local bool *) sync_arr_mem_28859)[0] = old_counter_28871 ==\n                num_groups_25912 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28872;\n    \n    is_last_group_28872 = ((__local bool *) sync_arr_mem_28859)[0];\n    if (is_last_group_28872) {\n        if (local_tid_28855 == 0) {\n            old_counter_28871 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28849)[0],\n                                                      (int) (0 -\n                                                             num_groups_25912));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28873 = sdiv_up64(num_groups_25912,\n                                                      segred_group_sizze_25911);\n            \n            x_25915 = 0.0F;\n            for (int64_t i_28874 = 0; i_28874 < read_per_thread_28873;\n                 i_28874++) {\n                int64_t group_res_id_28875 = sext_i32_i64(local_tid_28855) *\n                        read_per_thread_28873 + i_28874;\n                int64_t index_of_group_res_28876 = group_res_id_28875;\n                \n                if (slt64(group_res_id_28875, num_groups_25912)) {\n                    x_25916 = ((__global\n                                float *) group_res_arr_mem_28851)[index_of_group_res_28876 *\n                                                                  segred_group_sizze_25911];\n                    \n                    float res_25917;\n                    \n                    res_25917 = x_25915 + x_25916;\n                    x_25915 = res_25917;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_28861)[sext_i32_i64(local_tid_28855)] =\n            x_25915;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28877;\n ",
                   "           int32_t skip_waves_28878;\n            \n            skip_waves_28878 = 1;\n            \n            float x_28865;\n            float x_28866;\n            \n            offset_28877 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28855,\n                          sext_i64_i32(segred_group_sizze_25911))) {\n                    x_28865 = ((__local\n                                float *) red_arr_mem_28861)[sext_i32_i64(local_tid_28855 +\n                                                            offset_28877)];\n                }\n            }\n            offset_28877 = 1;\n            while (slt32(offset_28877, wave_sizze_28857)) {\n                if (slt32(local_tid_28855 + offset_28877,\n                          sext_i64_i32(segred_group_sizze_25911)) &&\n                    ((local_tid_28855 - squot32(local_tid_28855,\n                                                wave_sizze_28857) *\n                      wave_sizze_28857) & (2 * offset_28877 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28866 = ((volatile __local\n                                    float *) red_arr_mem_28861)[sext_i32_i64(local_tid_28855 +\n                                                                offset_28877)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28867 = x_28865 + x_28866;\n                        \n                        x_28865 = res_28867;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_28861)[sext_i32_i64(local_tid_28855)] =\n                            x_28865;\n                    }\n                }\n                offset_28877 *= 2;\n            }\n            while (slt32(skip_waves_28878,\n                         squot32(sext_i64_i32(s",
                   "egred_group_sizze_25911) +\n                                 wave_sizze_28857 - 1, wave_sizze_28857))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28877 = skip_waves_28878 * wave_sizze_28857;\n                if (slt32(local_tid_28855 + offset_28877,\n                          sext_i64_i32(segred_group_sizze_25911)) &&\n                    ((local_tid_28855 - squot32(local_tid_28855,\n                                                wave_sizze_28857) *\n                      wave_sizze_28857) == 0 && (squot32(local_tid_28855,\n                                                         wave_sizze_28857) &\n                                                 (2 * skip_waves_28878 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28866 = ((__local\n                                    float *) red_arr_mem_28861)[sext_i32_i64(local_tid_28855 +\n                                                                offset_28877)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28867 = x_28865 + x_28866;\n                        \n                        x_28865 = res_28867;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_28861)[sext_i32_i64(local_tid_28855)] =\n                            x_28865;\n                    }\n                }\n                skip_waves_28878 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28855 == 0) {\n                    ((__global float *) mem_27882)[0] = x_28865;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_25911\n}\n__kernel void mainzisegred_nonseg_27904(__global int *global_failure,\n                                        __local vo",
                   "latile\n                                        int64_t *red_arr_mem_28104_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28102_backing_aligned_1,\n                                        int64_t n_23312, __global\n                                        unsigned char *payments_mem_27669,\n                                        __global unsigned char *mem_27916,\n                                        __global\n                                        unsigned char *mainzicounter_mem_28092,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28094,\n                                        int64_t num_threads_28096)\n{\n    #define segred_num_groups_27898 (mainzisegred_num_groups_27897)\n    #define segred_group_sizze_27900 (mainzisegred_group_sizze_27899)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28104_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28104_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28102_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28102_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28097;\n    int32_t local_tid_28098;\n    int64_t group_sizze_28101;\n    int32_t wave_sizze_28100;\n    int32_t group_tid_28099;\n    \n    global_tid_28097 = get_global_id(0);\n    local_tid_28098 = get_local_id(0);\n    group_sizze_28101 = get_local_size(0);\n    wave_sizze_28100 = LOCKSTEP_WIDTH;\n    group_tid_28099 = get_group_id(0);\n    \n    int32_t phys_tid_27904;\n    \n    phys_tid_27904 = global_tid_28097;\n    \n    __local char *sync_arr_mem_28102;\n    \n    sync_arr_mem_28102 = (__local char *) sync_arr_mem_28102_backing_0;\n    \n    __lo",
                   "cal char *red_arr_mem_28104;\n    \n    red_arr_mem_28104 = (__local char *) red_arr_mem_28104_backing_1;\n    \n    int64_t dummy_27902;\n    \n    dummy_27902 = 0;\n    \n    int64_t gtid_27903;\n    \n    gtid_27903 = 0;\n    \n    int64_t x_acc_28106;\n    int64_t chunk_sizze_28107;\n    \n    chunk_sizze_28107 = smin64(sdiv_up64(n_23312,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_27900 *\n                                         segred_num_groups_27898))),\n                               sdiv_up64(n_23312 - sext_i32_i64(phys_tid_27904),\n                                         num_threads_28096));\n    \n    int64_t x_27905;\n    int64_t y_27906;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28106 = 0;\n    }\n    for (int64_t i_28111 = 0; i_28111 < chunk_sizze_28107; i_28111++) {\n        gtid_27903 = sext_i32_i64(phys_tid_27904) + num_threads_28096 * i_28111;\n        // apply map function\n        {\n            int64_t res_27909 = ((__global\n                                  int64_t *) payments_mem_27669)[gtid_27903];\n            int64_t bytes_27910 = 4 * res_27909;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_27905 = x_acc_28106;\n            }\n            // load new values\n            {\n                y_27906 = bytes_27910;\n            }\n            // apply reduction operator\n            {\n                int64_t zz_27907 = smax64(x_27905, y_27906);\n                \n                // store in accumulator\n                {\n                    x_acc_28106 = zz_27907;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_27905 = x_acc_28106;\n        ((__local int64_t *) red_arr_mem_28104)[sext_i32_i64(local_tid_28098)] =\n            x_27905;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28112;\n    int32_t skip_waves_28113;\n    \n    skip_waves_",
                   "28113 = 1;\n    \n    int64_t x_28108;\n    int64_t y_28109;\n    \n    offset_28112 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28098, sext_i64_i32(segred_group_sizze_27900))) {\n            x_28108 = ((__local\n                        int64_t *) red_arr_mem_28104)[sext_i32_i64(local_tid_28098 +\n                                                      offset_28112)];\n        }\n    }\n    offset_28112 = 1;\n    while (slt32(offset_28112, wave_sizze_28100)) {\n        if (slt32(local_tid_28098 + offset_28112,\n                  sext_i64_i32(segred_group_sizze_27900)) && ((local_tid_28098 -\n                                                               squot32(local_tid_28098,\n                                                                       wave_sizze_28100) *\n                                                               wave_sizze_28100) &\n                                                              (2 *\n                                                               offset_28112 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_28109 = ((volatile __local\n                            int64_t *) red_arr_mem_28104)[sext_i32_i64(local_tid_28098 +\n                                                          offset_28112)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_28110 = smax64(x_28108, y_28109);\n                \n                x_28108 = zz_28110;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_28104)[sext_i32_i64(local_tid_28098)] =\n                    x_28108;\n            }\n        }\n        offset_28112 *= 2;\n    }\n    while (slt32(skip_waves_28113,\n                 squot32(sext_i64_i32(segred_group_sizze_27900) +\n                         wave_sizze_28100 - 1, wave_sizze_28100))) {\n       ",
                   " barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28112 = skip_waves_28113 * wave_sizze_28100;\n        if (slt32(local_tid_28098 + offset_28112,\n                  sext_i64_i32(segred_group_sizze_27900)) && ((local_tid_28098 -\n                                                               squot32(local_tid_28098,\n                                                                       wave_sizze_28100) *\n                                                               wave_sizze_28100) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28098,\n                                                                       wave_sizze_28100) &\n                                                               (2 *\n                                                                skip_waves_28113 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                y_28109 = ((__local\n                            int64_t *) red_arr_mem_28104)[sext_i32_i64(local_tid_28098 +\n                                                          offset_28112)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_28110 = smax64(x_28108, y_28109);\n                \n                x_28108 = zz_28110;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_28104)[sext_i32_i64(local_tid_28098)] =\n                    x_28108;\n            }\n        }\n        skip_waves_28113 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28098) == 0) {\n            x_acc_28106 = x_28108;\n        }\n    }\n    \n    int32_t old_counter_28114;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28098 == 0) {\n    ",
                   "        ((__global\n              int64_t *) group_res_arr_mem_28094)[sext_i32_i64(group_tid_28099) *\n                                                  segred_group_sizze_27900] =\n                x_acc_28106;\n            mem_fence_global();\n            old_counter_28114 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28092)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28102)[0] = old_counter_28114 ==\n                segred_num_groups_27898 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28115;\n    \n    is_last_group_28115 = ((__local bool *) sync_arr_mem_28102)[0];\n    if (is_last_group_28115) {\n        if (local_tid_28098 == 0) {\n            old_counter_28114 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28092)[0],\n                                                      (int) (0 -\n                                                             segred_num_groups_27898));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28116 = sdiv_up64(segred_num_groups_27898,\n                                                      segred_group_sizze_27900);\n            \n            x_27905 = 0;\n            for (int64_t i_28117 = 0; i_28117 < read_per_thread_28116;\n                 i_28117++) {\n                int64_t group_res_id_28118 = sext_i32_i64(local_tid_28098) *\n                        read_per_thread_28116 + i_28117;\n                int64_t index_of_group_res_28119 = group_res_id_28118;\n                \n                if (slt64(group_res_id_28118, segred_num_groups_27898)) {\n                    y_27906 = ((__global\n                                int64_t *) group_res_arr_mem_28094)[index_of_group_res_28119 *\n                                              ",
                   "                      segred_group_sizze_27900];\n                    \n                    int64_t zz_27907;\n                    \n                    zz_27907 = smax64(x_27905, y_27906);\n                    x_27905 = zz_27907;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_28104)[sext_i32_i64(local_tid_28098)] =\n            x_27905;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28120;\n            int32_t skip_waves_28121;\n            \n            skip_waves_28121 = 1;\n            \n            int64_t x_28108;\n            int64_t y_28109;\n            \n            offset_28120 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28098,\n                          sext_i64_i32(segred_group_sizze_27900))) {\n                    x_28108 = ((__local\n                                int64_t *) red_arr_mem_28104)[sext_i32_i64(local_tid_28098 +\n                                                              offset_28120)];\n                }\n            }\n            offset_28120 = 1;\n            while (slt32(offset_28120, wave_sizze_28100)) {\n                if (slt32(local_tid_28098 + offset_28120,\n                          sext_i64_i32(segred_group_sizze_27900)) &&\n                    ((local_tid_28098 - squot32(local_tid_28098,\n                                                wave_sizze_28100) *\n                      wave_sizze_28100) & (2 * offset_28120 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_28109 = ((volatile __local\n                                    int64_t *) red_arr_mem_28104)[sext_i32_i64(local_tid_28098 +\n                                                                  offset_28120)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_28110 = smax64(x_28108, y_2810",
                   "9);\n                        \n                        x_28108 = zz_28110;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28104)[sext_i32_i64(local_tid_28098)] =\n                            x_28108;\n                    }\n                }\n                offset_28120 *= 2;\n            }\n            while (slt32(skip_waves_28121,\n                         squot32(sext_i64_i32(segred_group_sizze_27900) +\n                                 wave_sizze_28100 - 1, wave_sizze_28100))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28120 = skip_waves_28121 * wave_sizze_28100;\n                if (slt32(local_tid_28098 + offset_28120,\n                          sext_i64_i32(segred_group_sizze_27900)) &&\n                    ((local_tid_28098 - squot32(local_tid_28098,\n                                                wave_sizze_28100) *\n                      wave_sizze_28100) == 0 && (squot32(local_tid_28098,\n                                                         wave_sizze_28100) &\n                                                 (2 * skip_waves_28121 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        y_28109 = ((__local\n                                    int64_t *) red_arr_mem_28104)[sext_i32_i64(local_tid_28098 +\n                                                                  offset_28120)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_28110 = smax64(x_28108, y_28109);\n                        \n                        x_28108 = zz_28110;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_28104)[sext_i32_i64(local_tid_28098)] =\n                ",
                   "            x_28108;\n                    }\n                }\n                skip_waves_28121 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28098 == 0) {\n                    ((__global int64_t *) mem_27916)[0] = x_28108;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_27898\n    #undef segred_group_sizze_27900\n}\n__kernel void mainzisegred_nonseg_27936(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28141_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28139_backing_aligned_1,\n                                        int64_t n_23312, __global\n                                        unsigned char *payments_mem_27669,\n                                        __global unsigned char *mem_27948,\n                                        __global\n                                        unsigned char *mainzicounter_mem_28129,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28131,\n                                        int64_t num_threads_28133)\n{\n    #define segred_num_groups_27930 (mainzisegred_num_groups_27929)\n    #define segred_group_sizze_27932 (mainzisegred_group_sizze_27931)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28141_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28141_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28139_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28139_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n ",
                   "   int32_t global_tid_28134;\n    int32_t local_tid_28135;\n    int64_t group_sizze_28138;\n    int32_t wave_sizze_28137;\n    int32_t group_tid_28136;\n    \n    global_tid_28134 = get_global_id(0);\n    local_tid_28135 = get_local_id(0);\n    group_sizze_28138 = get_local_size(0);\n    wave_sizze_28137 = LOCKSTEP_WIDTH;\n    group_tid_28136 = get_group_id(0);\n    \n    int32_t phys_tid_27936;\n    \n    phys_tid_27936 = global_tid_28134;\n    \n    __local char *sync_arr_mem_28139;\n    \n    sync_arr_mem_28139 = (__local char *) sync_arr_mem_28139_backing_0;\n    \n    __local char *red_arr_mem_28141;\n    \n    red_arr_mem_28141 = (__local char *) red_arr_mem_28141_backing_1;\n    \n    int64_t dummy_27934;\n    \n    dummy_27934 = 0;\n    \n    int64_t gtid_27935;\n    \n    gtid_27935 = 0;\n    \n    int64_t x_acc_28143;\n    int64_t chunk_sizze_28144;\n    \n    chunk_sizze_28144 = smin64(sdiv_up64(n_23312,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_27932 *\n                                         segred_num_groups_27930))),\n                               sdiv_up64(n_23312 - sext_i32_i64(phys_tid_27936),\n                                         num_threads_28133));\n    \n    int64_t x_27937;\n    int64_t y_27938;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28143 = 0;\n    }\n    for (int64_t i_28148 = 0; i_28148 < chunk_sizze_28144; i_28148++) {\n        gtid_27935 = sext_i32_i64(phys_tid_27936) + num_threads_28133 * i_28148;\n        // apply map function\n        {\n            int64_t res_27941 = ((__global\n                                  int64_t *) payments_mem_27669)[gtid_27935];\n            int64_t bytes_27942 = 4 * res_27941;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_27937 = x_acc_28143;\n            }\n            // load new values\n            {\n                y_27938 = bytes_27942;\n            }\n            // apply reduction operator\n   ",
                   "         {\n                int64_t zz_27939 = smax64(x_27937, y_27938);\n                \n                // store in accumulator\n                {\n                    x_acc_28143 = zz_27939;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_27937 = x_acc_28143;\n        ((__local int64_t *) red_arr_mem_28141)[sext_i32_i64(local_tid_28135)] =\n            x_27937;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28149;\n    int32_t skip_waves_28150;\n    \n    skip_waves_28150 = 1;\n    \n    int64_t x_28145;\n    int64_t y_28146;\n    \n    offset_28149 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28135, sext_i64_i32(segred_group_sizze_27932))) {\n            x_28145 = ((__local\n                        int64_t *) red_arr_mem_28141)[sext_i32_i64(local_tid_28135 +\n                                                      offset_28149)];\n        }\n    }\n    offset_28149 = 1;\n    while (slt32(offset_28149, wave_sizze_28137)) {\n        if (slt32(local_tid_28135 + offset_28149,\n                  sext_i64_i32(segred_group_sizze_27932)) && ((local_tid_28135 -\n                                                               squot32(local_tid_28135,\n                                                                       wave_sizze_28137) *\n                                                               wave_sizze_28137) &\n                                                              (2 *\n                                                               offset_28149 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_28146 = ((volatile __local\n                            int64_t *) red_arr_mem_28141)[sext_i32_i64(local_tid_28135 +\n                                                          offset_28149)];\n            }\n            // apply reduction operation\n            ",
                   "{\n                int64_t zz_28147 = smax64(x_28145, y_28146);\n                \n                x_28145 = zz_28147;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_28141)[sext_i32_i64(local_tid_28135)] =\n                    x_28145;\n            }\n        }\n        offset_28149 *= 2;\n    }\n    while (slt32(skip_waves_28150,\n                 squot32(sext_i64_i32(segred_group_sizze_27932) +\n                         wave_sizze_28137 - 1, wave_sizze_28137))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28149 = skip_waves_28150 * wave_sizze_28137;\n        if (slt32(local_tid_28135 + offset_28149,\n                  sext_i64_i32(segred_group_sizze_27932)) && ((local_tid_28135 -\n                                                               squot32(local_tid_28135,\n                                                                       wave_sizze_28137) *\n                                                               wave_sizze_28137) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28135,\n                                                                       wave_sizze_28137) &\n                                                               (2 *\n                                                                skip_waves_28150 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                y_28146 = ((__local\n                            int64_t *) red_arr_mem_28141)[sext_i32_i64(local_tid_28135 +\n                                                          offset_28149)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_28147 = smax64(x_28145, y_28146);\n                \n                x_28145 = zz_28147;\n            }\n            // write result of op",
                   "eration\n            {\n                ((__local\n                  int64_t *) red_arr_mem_28141)[sext_i32_i64(local_tid_28135)] =\n                    x_28145;\n            }\n        }\n        skip_waves_28150 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28135) == 0) {\n            x_acc_28143 = x_28145;\n        }\n    }\n    \n    int32_t old_counter_28151;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28135 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_28131)[sext_i32_i64(group_tid_28136) *\n                                                  segred_group_sizze_27932] =\n                x_acc_28143;\n            mem_fence_global();\n            old_counter_28151 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28129)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28139)[0] = old_counter_28151 ==\n                segred_num_groups_27930 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28152;\n    \n    is_last_group_28152 = ((__local bool *) sync_arr_mem_28139)[0];\n    if (is_last_group_28152) {\n        if (local_tid_28135 == 0) {\n            old_counter_28151 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_28129)[0],\n                                                      (int) (0 -\n                                                             segred_num_groups_27930));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28153 = sdiv_up64(segred_num_groups_27930,\n                                                      segred_group_sizze_27932);\n            \n            x_27937 = 0;\n            for",
                   " (int64_t i_28154 = 0; i_28154 < read_per_thread_28153;\n                 i_28154++) {\n                int64_t group_res_id_28155 = sext_i32_i64(local_tid_28135) *\n                        read_per_thread_28153 + i_28154;\n                int64_t index_of_group_res_28156 = group_res_id_28155;\n                \n                if (slt64(group_res_id_28155, segred_num_groups_27930)) {\n                    y_27938 = ((__global\n                                int64_t *) group_res_arr_mem_28131)[index_of_group_res_28156 *\n                                                                    segred_group_sizze_27932];\n                    \n                    int64_t zz_27939;\n                    \n                    zz_27939 = smax64(x_27937, y_27938);\n                    x_27937 = zz_27939;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_28141)[sext_i32_i64(local_tid_28135)] =\n            x_27937;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28157;\n            int32_t skip_waves_28158;\n            \n            skip_waves_28158 = 1;\n            \n            int64_t x_28145;\n            int64_t y_28146;\n            \n            offset_28157 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28135,\n                          sext_i64_i32(segred_group_sizze_27932))) {\n                    x_28145 = ((__local\n                                int64_t *) red_arr_mem_28141)[sext_i32_i64(local_tid_28135 +\n                                                              offset_28157)];\n                }\n            }\n            offset_28157 = 1;\n            while (slt32(offset_28157, wave_sizze_28137)) {\n                if (slt32(local_tid_28135 + offset_28157,\n                          sext_i64_i32(segred_group_sizze_27932)) &&\n                    ((local_tid_28135 - squot32(local_tid_28135,\n                                ",
                   "                wave_sizze_28137) *\n                      wave_sizze_28137) & (2 * offset_28157 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_28146 = ((volatile __local\n                                    int64_t *) red_arr_mem_28141)[sext_i32_i64(local_tid_28135 +\n                                                                  offset_28157)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_28147 = smax64(x_28145, y_28146);\n                        \n                        x_28145 = zz_28147;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28141)[sext_i32_i64(local_tid_28135)] =\n                            x_28145;\n                    }\n                }\n                offset_28157 *= 2;\n            }\n            while (slt32(skip_waves_28158,\n                         squot32(sext_i64_i32(segred_group_sizze_27932) +\n                                 wave_sizze_28137 - 1, wave_sizze_28137))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28157 = skip_waves_28158 * wave_sizze_28137;\n                if (slt32(local_tid_28135 + offset_28157,\n                          sext_i64_i32(segred_group_sizze_27932)) &&\n                    ((local_tid_28135 - squot32(local_tid_28135,\n                                                wave_sizze_28137) *\n                      wave_sizze_28137) == 0 && (squot32(local_tid_28135,\n                                                         wave_sizze_28137) &\n                                                 (2 * skip_waves_28158 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        y_28146 = ((__local\n                                    int64_t *) red_arr_mem_28141)[sext_i32_i64",
                   "(local_tid_28135 +\n                                                                  offset_28157)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_28147 = smax64(x_28145, y_28146);\n                        \n                        x_28145 = zz_28147;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_28141)[sext_i32_i64(local_tid_28135)] =\n                            x_28145;\n                    }\n                }\n                skip_waves_28158 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28135 == 0) {\n                    ((__global int64_t *) mem_27948)[0] = x_28145;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_27930\n    #undef segred_group_sizze_27932\n}\n__kernel void mainzisegred_small_25712(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *red_arr_mem_28787_backing_aligned_0,\n                                       int64_t n_23312, int64_t paths_23315,\n                                       int64_t steps_23316,\n                                       int64_t num_groups_25868, __global\n                                       unsigned char *mem_27867, __global\n                                       unsigned char *mem_27870,\n                                       int64_t segment_sizze_nonzzero_28780)\n{\n    #define segred_group_sizze_25867 (mainzisegred_group_sizze_25706)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28787_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28787_backing_aligned_0;\n    \n ",
                   "   if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28782;\n    int32_t local_tid_28783;\n    int64_t group_sizze_28786;\n    int32_t wave_sizze_28785;\n    int32_t group_tid_28784;\n    \n    global_tid_28782 = get_global_id(0);\n    local_tid_28783 = get_local_id(0);\n    group_sizze_28786 = get_local_size(0);\n    wave_sizze_28785 = LOCKSTEP_WIDTH;\n    group_tid_28784 = get_group_id(0);\n    \n    int32_t phys_tid_25712;\n    \n    phys_tid_25712 = global_tid_28782;\n    \n    __local char *red_arr_mem_28787;\n    \n    red_arr_mem_28787 = (__local char *) red_arr_mem_28787_backing_0;\n    \n    int32_t phys_group_id_28789;\n    \n    phys_group_id_28789 = get_group_id(0);\n    for (int32_t i_28790 = 0; i_28790 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(steps_23316,\n                                          squot64(segred_group_sizze_25867,\n                                                  segment_sizze_nonzzero_28780))) -\n                   phys_group_id_28789, sext_i64_i32(num_groups_25868));\n         i_28790++) {\n        int32_t virt_group_id_28791 = phys_group_id_28789 + i_28790 *\n                sext_i64_i32(num_groups_25868);\n        int64_t gtid_25703 = squot64(sext_i32_i64(local_tid_28783),\n                                     segment_sizze_nonzzero_28780) +\n                sext_i32_i64(virt_group_id_28791) *\n                squot64(segred_group_sizze_25867, segment_sizze_nonzzero_28780);\n        int64_t gtid_25711 = srem64(sext_i32_i64(local_tid_28783), paths_23315);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, paths_23315) && (slt64(gtid_25703, steps_23316) &&\n                                          slt64(sext_i32_i64(local_tid_28783),\n                                                paths_23315 *\n                                                squot64(segred_group_sizze_25867,\n                                                        segment_sizze_nonzzero_28780)))) {\n                float res_25876;\n           ",
                   "     float redout_27655 = 0.0F;\n                \n                for (int64_t i_27656 = 0; i_27656 < n_23312; i_27656++) {\n                    float x_25880 = ((__global float *) mem_27867)[i_27656 *\n                                                                   (steps_23316 *\n                                                                    paths_23315) +\n                                                                   gtid_25711 *\n                                                                   steps_23316 +\n                                                                   gtid_25703];\n                    float res_25879 = x_25880 + redout_27655;\n                    float redout_tmp_28792 = res_25879;\n                    \n                    redout_27655 = redout_tmp_28792;\n                }\n                res_25876 = redout_27655;\n                \n                float res_25881 = fmax32(0.0F, res_25876);\n                \n                // save map-out results\n                { }\n                // save results to be reduced\n                {\n                    ((__local\n                      float *) red_arr_mem_28787)[sext_i32_i64(local_tid_28783)] =\n                        res_25881;\n                }\n            } else {\n                ((__local\n                  float *) red_arr_mem_28787)[sext_i32_i64(local_tid_28783)] =\n                    0.0F;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, paths_23315)) {\n            // perform segmented scan to imitate reduction\n            {\n                float x_25871;\n                float x_25872;\n                float x_28793;\n                float x_28794;\n                bool ltid_in_bounds_28796;\n                \n                ltid_in_bounds_28796 = slt64(sext_i32_i64(local_tid_28783),\n                                             paths_23315 *\n                                             squot64(segred_group_sizze_25867,\n                                     ",
                   "                segment_sizze_nonzzero_28780));\n                \n                int32_t skip_threads_28797;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_28796) {\n                        x_25872 = ((volatile __local\n                                    float *) red_arr_mem_28787)[sext_i32_i64(local_tid_28783)];\n                        if ((local_tid_28783 - squot32(local_tid_28783, 32) *\n                             32) == 0) {\n                            x_25871 = x_25872;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28797 = 1;\n                    while (slt32(skip_threads_28797, 32)) {\n                        if (sle32(skip_threads_28797, local_tid_28783 -\n                                  squot32(local_tid_28783, 32) * 32) &&\n                            ltid_in_bounds_28796) {\n                            // read operands\n                            {\n                                x_25871 = ((volatile __local\n                                            float *) red_arr_mem_28787)[sext_i32_i64(local_tid_28783) -\n                                                                        sext_i32_i64(skip_threads_28797)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_28798 =\n                                     slt64(srem64(sext_i32_i64(local_tid_28783),\n                                                  paths_23315),\n                                           sext_i32_i64(local_tid_28783) -\n                                           sext_i32_i64(local_tid_28783 -\n                                           skip_threads_28797));\n                                \n                                if (inactive_28798) {\n                                    x_258",
                   "71 = x_25872;\n                                }\n                                if (!inactive_28798) {\n                                    float res_25873 = x_25871 + x_25872;\n                                    \n                                    x_25871 = res_25873;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_28785, skip_threads_28797)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28797, local_tid_28783 -\n                                  squot32(local_tid_28783, 32) * 32) &&\n                            ltid_in_bounds_28796) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_28787)[sext_i32_i64(local_tid_28783)] =\n                                    x_25871;\n                                x_25872 = x_25871;\n                            }\n                        }\n                        if (sle32(wave_sizze_28785, skip_threads_28797)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28797 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_28783 - squot32(local_tid_28783, 32) * 32) ==\n                        31 && ltid_in_bounds_28796) {\n                        ((volatile __local\n                          float *) red_arr_mem_28787)[sext_i32_i64(squot32(local_tid_28783,\n                                                                           32))] =\n                            x_25871;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after wh",
                   "ich offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_28799;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_28783, 32) == 0 &&\n                            ltid_in_bounds_28796) {\n                            x_28794 = ((volatile __local\n                                        float *) red_arr_mem_28787)[sext_i32_i64(local_tid_28783)];\n                            if ((local_tid_28783 - squot32(local_tid_28783,\n                                                           32) * 32) == 0) {\n                                x_28793 = x_28794;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_28799 = 1;\n                        while (slt32(skip_threads_28799, 32)) {\n                            if (sle32(skip_threads_28799, local_tid_28783 -\n                                      squot32(local_tid_28783, 32) * 32) &&\n                                (squot32(local_tid_28783, 32) == 0 &&\n                                 ltid_in_bounds_28796)) {\n                                // read operands\n                                {\n                                    x_28793 = ((volatile __local\n                                                float *) red_arr_mem_28787)[sext_i32_i64(local_tid_28783) -\n                                                                            sext_i32_i64(skip_threads_28799)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_28800 =\n                                         slt64(srem64(sext_i32_i64(local_tid_28783 *\n                                                      32 + 32 - 1),\n                                                     ",
                   " paths_23315),\n                                               sext_i32_i64(local_tid_28783 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_28783 -\n                                                             skip_threads_28799) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_28800) {\n                                        x_28793 = x_28794;\n                                    }\n                                    if (!inactive_28800) {\n                                        float res_28795 = x_28793 + x_28794;\n                                        \n                                        x_28793 = res_28795;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_28785, skip_threads_28799)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_28799, local_tid_28783 -\n                                      squot32(local_tid_28783, 32) * 32) &&\n                                (squot32(local_tid_28783, 32) == 0 &&\n                                 ltid_in_bounds_28796)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      float *) red_arr_mem_28787)[sext_i32_i64(local_tid_28783)] =\n                                        x_28793;\n                                    x_28794 = x_28793;\n                                }\n                            }\n                            if (sle32(wave_sizze_28785, skip_threads_28799)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_28799 *= 2;\n          ",
                   "              }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_28783, 32) == 0 ||\n                          !ltid_in_bounds_28796)) {\n                        // read operands\n                        {\n                            x_25872 = x_25871;\n                            x_25871 = ((__local\n                                        float *) red_arr_mem_28787)[sext_i32_i64(squot32(local_tid_28783,\n                                                                                         32)) -\n                                                                    1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_28801 =\n                                 slt64(srem64(sext_i32_i64(local_tid_28783),\n                                              paths_23315),\n                                       sext_i32_i64(local_tid_28783) -\n                                       sext_i32_i64(squot32(local_tid_28783,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_28801) {\n                                x_25871 = x_25872;\n                            }\n                            if (!inactive_28801) {\n                                float res_25873 = x_25871 + x_25872;\n                                \n                                x_25871 = res_25873;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              float *) red_arr_mem_28787)[sext_i32_i64(local_tid_28783)] =\n                                x_25871;\n                        }\n                    }\n                }\n                barrier(CLK_LO",
                   "CAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_28783, 32) == 0) {\n                        ((__local\n                          float *) red_arr_mem_28787)[sext_i32_i64(local_tid_28783)] =\n                            x_25872;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_28791) *\n                      squot64(segred_group_sizze_25867,\n                              segment_sizze_nonzzero_28780) +\n                      sext_i32_i64(local_tid_28783), steps_23316) &&\n                slt64(sext_i32_i64(local_tid_28783),\n                      squot64(segred_group_sizze_25867,\n                              segment_sizze_nonzzero_28780))) {\n                ((__global\n                  float *) mem_27870)[sext_i32_i64(virt_group_id_28791) *\n                                      squot64(segred_group_sizze_25867,\n                                              segment_sizze_nonzzero_28780) +\n                                      sext_i32_i64(local_tid_28783)] = ((__local\n                                                                         float *) red_arr_mem_28787)[(sext_i32_i64(local_tid_28783) +\n                                                                                                      1) *\n                                                                                                     segment_sizze_nonzzero_28780 -\n                                                                                                     1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_25867\n}\n__kernel void mainzisegred_small_28390(__global int *global_failure",
                   ",\n                                       __local volatile\n                                       int64_t *red_arr_mem_28398_backing_aligned_0,\n                                       int64_t res_23531,\n                                       int64_t num_groups_25402, __global\n                                       unsigned char *mem_27807,\n                                       int32_t num_subhistos_28304, __global\n                                       unsigned char *res_subhistos_mem_28305,\n                                       int64_t segment_sizze_nonzzero_28391)\n{\n    #define seghist_group_sizze_25400 (mainziseghist_group_sizze_25399)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28398_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28398_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28393;\n    int32_t local_tid_28394;\n    int64_t group_sizze_28397;\n    int32_t wave_sizze_28396;\n    int32_t group_tid_28395;\n    \n    global_tid_28393 = get_global_id(0);\n    local_tid_28394 = get_local_id(0);\n    group_sizze_28397 = get_local_size(0);\n    wave_sizze_28396 = LOCKSTEP_WIDTH;\n    group_tid_28395 = get_group_id(0);\n    \n    int32_t flat_gtid_28390;\n    \n    flat_gtid_28390 = global_tid_28393;\n    \n    __local char *red_arr_mem_28398;\n    \n    red_arr_mem_28398 = (__local char *) red_arr_mem_28398_backing_0;\n    \n    int32_t phys_group_id_28400;\n    \n    phys_group_id_28400 = get_group_id(0);\n    for (int32_t i_28401 = 0; i_28401 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(res_23531,\n                                          squot64(seghist_group_sizze_25400,\n                                                  segment_sizze_nonzzero_28391))) -\n                   phys_group_id_28400, sext_i64_i32(num_groups_25402));\n         i_28401++) {\n        int32_t virt_group_id_2840",
                   "2 = phys_group_id_28400 + i_28401 *\n                sext_i64_i32(num_groups_25402);\n        int64_t bucket_id_28388 = squot64(sext_i32_i64(local_tid_28394),\n                                          segment_sizze_nonzzero_28391) +\n                sext_i32_i64(virt_group_id_28402) *\n                squot64(seghist_group_sizze_25400,\n                        segment_sizze_nonzzero_28391);\n        int64_t subhistogram_id_28389 = srem64(sext_i32_i64(local_tid_28394),\n                                               num_subhistos_28304);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, num_subhistos_28304) && (slt64(bucket_id_28388,\n                                                        res_23531) &&\n                                                  slt64(sext_i32_i64(local_tid_28394),\n                                                        num_subhistos_28304 *\n                                                        squot64(seghist_group_sizze_25400,\n                                                                segment_sizze_nonzzero_28391)))) {\n                // save results to be reduced\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_28398)[sext_i32_i64(local_tid_28394)] =\n                        ((__global\n                          int64_t *) res_subhistos_mem_28305)[subhistogram_id_28389 *\n                                                              res_23531 +\n                                                              bucket_id_28388];\n                }\n            } else {\n                ((__local\n                  int64_t *) red_arr_mem_28398)[sext_i32_i64(local_tid_28394)] =\n                    0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, num_subhistos_28304)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t x_25406;\n                int64_t x_25407;\n                int64_t x_28403;\n  ",
                   "              int64_t x_28404;\n                bool ltid_in_bounds_28406;\n                \n                ltid_in_bounds_28406 = slt64(sext_i32_i64(local_tid_28394),\n                                             num_subhistos_28304 *\n                                             squot64(seghist_group_sizze_25400,\n                                                     segment_sizze_nonzzero_28391));\n                \n                int32_t skip_threads_28407;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_28406) {\n                        x_25407 = ((volatile __local\n                                    int64_t *) red_arr_mem_28398)[sext_i32_i64(local_tid_28394)];\n                        if ((local_tid_28394 - squot32(local_tid_28394, 32) *\n                             32) == 0) {\n                            x_25406 = x_25407;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28407 = 1;\n                    while (slt32(skip_threads_28407, 32)) {\n                        if (sle32(skip_threads_28407, local_tid_28394 -\n                                  squot32(local_tid_28394, 32) * 32) &&\n                            ltid_in_bounds_28406) {\n                            // read operands\n                            {\n                                x_25406 = ((volatile __local\n                                            int64_t *) red_arr_mem_28398)[sext_i32_i64(local_tid_28394) -\n                                                                          sext_i32_i64(skip_threads_28407)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_28408 =\n                                     slt64(srem64(sext_i32_i64(local_tid_28394),\n                                                 ",
                   " num_subhistos_28304),\n                                           sext_i32_i64(local_tid_28394) -\n                                           sext_i32_i64(local_tid_28394 -\n                                           skip_threads_28407));\n                                \n                                if (inactive_28408) {\n                                    x_25406 = x_25407;\n                                }\n                                if (!inactive_28408) {\n                                    int64_t res_25408 = smax64(x_25406,\n                                                               x_25407);\n                                    \n                                    x_25406 = res_25408;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_28396, skip_threads_28407)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28407, local_tid_28394 -\n                                  squot32(local_tid_28394, 32) * 32) &&\n                            ltid_in_bounds_28406) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_28398)[sext_i32_i64(local_tid_28394)] =\n                                    x_25406;\n                                x_25407 = x_25406;\n                            }\n                        }\n                        if (sle32(wave_sizze_28396, skip_threads_28407)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28407 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_28394 - squot32(local_tid_28394, 32) * 32) ==\n     ",
                   "                   31 && ltid_in_bounds_28406) {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28398)[sext_i32_i64(squot32(local_tid_28394,\n                                                                             32))] =\n                            x_25406;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_28409;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_28394, 32) == 0 &&\n                            ltid_in_bounds_28406) {\n                            x_28404 = ((volatile __local\n                                        int64_t *) red_arr_mem_28398)[sext_i32_i64(local_tid_28394)];\n                            if ((local_tid_28394 - squot32(local_tid_28394,\n                                                           32) * 32) == 0) {\n                                x_28403 = x_28404;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_28409 = 1;\n                        while (slt32(skip_threads_28409, 32)) {\n                            if (sle32(skip_threads_28409, local_tid_28394 -\n                                      squot32(local_tid_28394, 32) * 32) &&\n                                (squot32(local_tid_28394, 32) == 0 &&\n                                 ltid_in_bounds_28406)) {\n                                // read operands\n                                {\n                                    x_28403 = ((volatile __local\n                                                int64_t *) red_arr_mem_28398)[sext_i32_i64(local_tid_28394) -\n                                                 ",
                   "                             sext_i32_i64(skip_threads_28409)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_28410 =\n                                         slt64(srem64(sext_i32_i64(local_tid_28394 *\n                                                      32 + 32 - 1),\n                                                      num_subhistos_28304),\n                                               sext_i32_i64(local_tid_28394 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_28394 -\n                                                             skip_threads_28409) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_28410) {\n                                        x_28403 = x_28404;\n                                    }\n                                    if (!inactive_28410) {\n                                        int64_t res_28405 = smax64(x_28403,\n                                                                   x_28404);\n                                        \n                                        x_28403 = res_28405;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_28396, skip_threads_28409)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_28409, local_tid_28394 -\n                                      squot32(local_tid_28394, 32) * 32) &&\n                                (squot32(local_tid_28394, 32) == 0 &&\n                                 ltid_in_bounds_28406)) {\n                                // write result\n                                {\n                       ",
                   "             ((volatile __local\n                                      int64_t *) red_arr_mem_28398)[sext_i32_i64(local_tid_28394)] =\n                                        x_28403;\n                                    x_28404 = x_28403;\n                                }\n                            }\n                            if (sle32(wave_sizze_28396, skip_threads_28409)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_28409 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_28394, 32) == 0 ||\n                          !ltid_in_bounds_28406)) {\n                        // read operands\n                        {\n                            x_25407 = x_25406;\n                            x_25406 = ((__local\n                                        int64_t *) red_arr_mem_28398)[sext_i32_i64(squot32(local_tid_28394,\n                                                                                           32)) -\n                                                                      1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_28411 =\n                                 slt64(srem64(sext_i32_i64(local_tid_28394),\n                                              num_subhistos_28304),\n                                       sext_i32_i64(local_tid_28394) -\n                                       sext_i32_i64(squot32(local_tid_28394,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_28411) {\n                                x_25406 = x_25407;\n                            }\n                            if (!inactive_28411) {\n",
                   "                                int64_t res_25408 = smax64(x_25406, x_25407);\n                                \n                                x_25406 = res_25408;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              int64_t *) red_arr_mem_28398)[sext_i32_i64(local_tid_28394)] =\n                                x_25406;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_28394, 32) == 0) {\n                        ((__local\n                          int64_t *) red_arr_mem_28398)[sext_i32_i64(local_tid_28394)] =\n                            x_25407;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_28402) *\n                      squot64(seghist_group_sizze_25400,\n                              segment_sizze_nonzzero_28391) +\n                      sext_i32_i64(local_tid_28394), res_23531) &&\n                slt64(sext_i32_i64(local_tid_28394),\n                      squot64(seghist_group_sizze_25400,\n                              segment_sizze_nonzzero_28391))) {\n                ((__global\n                  int64_t *) mem_27807)[sext_i32_i64(virt_group_id_28402) *\n                                        squot64(seghist_group_sizze_25400,\n                                                segment_sizze_nonzzero_28391) +\n                                        sext_i32_i64(local_tid_28394)] =\n                    ((__local\n                      int64_t *) red_arr_mem_28398)[(sext_i32_i64(local_tid_28394) +\n                                                     1) *\n      ",
                   "                                              segment_sizze_nonzzero_28391 -\n                                                    1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_25400\n}\n__kernel void testzicopy_28721(int64_t paths_23807, int64_t steps_23808,\n                               __global unsigned char *mem_27833, __global\n                               unsigned char *mem_27838)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_28721;\n    int32_t copy_ltid_28722;\n    int32_t copy_gid_28723;\n    \n    copy_gtid_28721 = get_global_id(0);\n    copy_ltid_28722 = get_local_id(0);\n    copy_gid_28723 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_28721), steps_23808 * paths_23807 * 9)) {\n        ((__global float *) mem_27838)[squot64(sext_i32_i64(copy_gtid_28721),\n                                               paths_23807 * 9) * (9 *\n                                                                   paths_23807) +\n                                       squot64(sext_i32_i64(copy_gtid_28721) -\n                                               squot64(sext_i32_i64(copy_gtid_28721),\n                                                       paths_23807 * 9) *\n                                               (paths_23807 * 9), 9) * 9 +\n                                       (sext_i32_i64(copy_gtid_28721) -\n                                        squot64(sext_i32_i64(copy_gtid_28721),\n                                                paths_23807 * 9) *\n                                        (paths_23807 * 9) -\n                                        squot64(sext_i32_i64(copy_gtid_28721) -\n                                                squot64(sext_i32_i64(copy_gtid_28721),\n                                                        paths_23807 * 9) *\n                      ",
                   "                          (paths_23807 * 9), 9) * 9)] =\n            ((__global\n              float *) mem_27833)[squot64(sext_i32_i64(copy_gtid_28721) -\n                                          squot64(sext_i32_i64(copy_gtid_28721),\n                                                  paths_23807 * 9) *\n                                          (paths_23807 * 9), 9) * (9 *\n                                                                   steps_23808) +\n                                  squot64(sext_i32_i64(copy_gtid_28721),\n                                          paths_23807 * 9) * 9 +\n                                  (sext_i32_i64(copy_gtid_28721) -\n                                   squot64(sext_i32_i64(copy_gtid_28721),\n                                           paths_23807 * 9) * (paths_23807 *\n                                                               9) -\n                                   squot64(sext_i32_i64(copy_gtid_28721) -\n                                           squot64(sext_i32_i64(copy_gtid_28721),\n                                                   paths_23807 * 9) *\n                                           (paths_23807 * 9), 9) * 9)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void testzicopy_28758(int64_t paths_23807, int64_t steps_23808,\n                               __global unsigned char *mem_27833, __global\n                               unsigned char *mem_27849)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t copy_gtid_28758;\n    int32_t copy_ltid_28759;\n    int32_t copy_gid_28760;\n    \n    copy_gtid_28758 = get_global_id(0);\n    copy_ltid_28759 = get_local_id(0);\n    copy_gid_28760 = get_group_id(0);\n    if (slt64(sext_i32_i64(copy_gtid_28758), steps_23808 * paths_23807 * 9)) {\n        ((__global float *) mem_27849)[squot64(sext_i32_i64(copy_gtid_28758),\n                                               paths_23807 * 9) * (9 *\n                                                    ",
                   "               paths_23807) +\n                                       squot64(sext_i32_i64(copy_gtid_28758) -\n                                               squot64(sext_i32_i64(copy_gtid_28758),\n                                                       paths_23807 * 9) *\n                                               (paths_23807 * 9), 9) * 9 +\n                                       (sext_i32_i64(copy_gtid_28758) -\n                                        squot64(sext_i32_i64(copy_gtid_28758),\n                                                paths_23807 * 9) *\n                                        (paths_23807 * 9) -\n                                        squot64(sext_i32_i64(copy_gtid_28758) -\n                                                squot64(sext_i32_i64(copy_gtid_28758),\n                                                        paths_23807 * 9) *\n                                                (paths_23807 * 9), 9) * 9)] =\n            ((__global\n              float *) mem_27833)[squot64(sext_i32_i64(copy_gtid_28758) -\n                                          squot64(sext_i32_i64(copy_gtid_28758),\n                                                  paths_23807 * 9) *\n                                          (paths_23807 * 9), 9) * (9 *\n                                                                   steps_23808) +\n                                  squot64(sext_i32_i64(copy_gtid_28758),\n                                          paths_23807 * 9) * 9 +\n                                  (sext_i32_i64(copy_gtid_28758) -\n                                   squot64(sext_i32_i64(copy_gtid_28758),\n                                           paths_23807 * 9) * (paths_23807 *\n                                                               9) -\n                                   squot64(sext_i32_i64(copy_gtid_28758) -\n                                           squot64(sext_i32_i64(copy_gtid_28758),\n                                                   paths_23807 * 9) *\n       ",
                   "                                    (paths_23807 * 9), 9) * 9)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void testziscan_stage1_27050(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28222_backing_aligned_0,\n                                      int64_t steps_23808,\n                                      int64_t one_intra_par_min_26359, __global\n                                      unsigned char *res_mem_27725, __global\n                                      unsigned char *res_mem_27726,\n                                      int64_t binop_x_27755, __global\n                                      unsigned char *res_mem_27800, __global\n                                      unsigned char *mem_27803, __global\n                                      unsigned char *mem_27805,\n                                      int32_t num_threads_28216)\n{\n    #define segscan_group_sizze_27045 (testzisegscan_group_sizze_27044)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28222_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28222_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28217;\n    int32_t local_tid_28218;\n    int64_t group_sizze_28221;\n    int32_t wave_sizze_28220;\n    int32_t group_tid_28219;\n    \n    global_tid_28217 = get_global_id(0);\n    local_tid_28218 = get_local_id(0);\n    group_sizze_28221 = get_local_size(0);\n    wave_sizze_28220 = LOCKSTEP_WIDTH;\n    group_tid_28219 = get_group_id(0);\n    \n    int32_t phys_tid_27050;\n    \n    phys_tid_27050 = global_tid_28217;\n    \n    __local char *scan_arr_mem_28222;\n    \n    scan_arr_mem_28222 = (__local char *) scan_arr_mem_28222_backing_0;\n    \n    int64_t x_23992;\n    int64_t x_23993;\n    \n    x_23992 = 0;\n    for (int64_t j_28224 = 0",
                   "; j_28224 < sdiv_up64(binop_x_27755,\n                                                  sext_i32_i64(num_threads_28216));\n         j_28224++) {\n        int64_t chunk_offset_28225 = segscan_group_sizze_27045 * j_28224 +\n                sext_i32_i64(group_tid_28219) * (segscan_group_sizze_27045 *\n                                                 sdiv_up64(binop_x_27755,\n                                                           sext_i32_i64(num_threads_28216)));\n        int64_t flat_idx_28226 = chunk_offset_28225 +\n                sext_i32_i64(local_tid_28218);\n        int64_t gtid_27049 = flat_idx_28226;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27049, binop_x_27755)) {\n                int64_t binop_x_27516 = squot64(gtid_27049,\n                                                one_intra_par_min_26359);\n                int64_t binop_y_27518 = one_intra_par_min_26359 * binop_x_27516;\n                int64_t binop_x_27519 = gtid_27049 - binop_y_27518;\n                int64_t binop_x_27525 = squot64(binop_x_27519, 9);\n                int64_t binop_y_27526 = 9 * binop_x_27525;\n                int64_t new_index_27527 = binop_x_27519 - binop_y_27526;\n                int64_t x_23995 = ((__global\n                                    int64_t *) res_mem_27725)[new_index_27527];\n                float x_23996 = ((__global\n                                  float *) res_mem_27726)[new_index_27527];\n                float x_23997 = ((__global\n                                  float *) res_mem_27800)[binop_x_27516 * (9 *\n                                                                           steps_23808) +\n                                                          binop_x_27525 * 9 +\n                                                          new_index_27527];\n                float x_23998 = x_23997 / x_23996;\n                float ceil_arg_23999 = x_23998 - 1.0F;\n                float res_24000;\n                \n                res_24000 = futr",
                   "ts_ceil32(ceil_arg_23999);\n                \n                int64_t res_24001 = fptosi_f32_i64(res_24000);\n                int64_t max_arg_24002 = sub64(x_23995, res_24001);\n                int64_t res_24003 = smax64(0, max_arg_24002);\n                bool cond_24004 = res_24003 == 0;\n                int64_t res_24005;\n                \n                if (cond_24004) {\n                    res_24005 = 1;\n                } else {\n                    res_24005 = res_24003;\n                }\n                // write to-scan values to parameters\n                {\n                    x_23993 = res_24005;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global int64_t *) mem_27805)[gtid_27049] = res_24005;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27049, binop_x_27755)) {\n                    x_23993 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_23994 = add64(x_23992, x_23993);\n                \n                ((__local\n                  int64_t *) scan_arr_mem_28222)[sext_i32_i64(local_tid_28218)] =\n                    res_23994;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_28227;\n            int64_t x_28228;\n            int64_t x_28230;\n            int64_t x_28231;\n            bool ltid_in_bounds_28233;\n            \n            ltid_in_bounds_28233 = slt64(sext_i32_i64(local_tid_28218),\n                                         segscan_group_sizze_27045);\n            \n            int32_t skip_threads_28234;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28233) {\n                    x_28228 = ((volatile __local\n                 ",
                   "               int64_t *) scan_arr_mem_28222)[sext_i32_i64(local_tid_28218)];\n                    if ((local_tid_28218 - squot32(local_tid_28218, 32) * 32) ==\n                        0) {\n                        x_28227 = x_28228;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28234 = 1;\n                while (slt32(skip_threads_28234, 32)) {\n                    if (sle32(skip_threads_28234, local_tid_28218 -\n                              squot32(local_tid_28218, 32) * 32) &&\n                        ltid_in_bounds_28233) {\n                        // read operands\n                        {\n                            x_28227 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28222)[sext_i32_i64(local_tid_28218) -\n                                                                       sext_i32_i64(skip_threads_28234)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_28229 = add64(x_28227, x_28228);\n                            \n                            x_28227 = res_28229;\n                        }\n                    }\n                    if (sle32(wave_sizze_28220, skip_threads_28234)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28234, local_tid_28218 -\n                              squot32(local_tid_28218, 32) * 32) &&\n                        ltid_in_bounds_28233) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28222)[sext_i32_i64(local_tid_28218)] =\n                                x_28227;\n                            x_28228 = x_28227;\n                        }\n                    }\n                    if (sle32(wave_sizze_28220, skip_threa",
                   "ds_28234)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28234 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28218 - squot32(local_tid_28218, 32) * 32) ==\n                    31 && ltid_in_bounds_28233) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28222)[sext_i32_i64(squot32(local_tid_28218,\n                                                                          32))] =\n                        x_28227;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28235;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28218, 32) == 0 &&\n                        ltid_in_bounds_28233) {\n                        x_28231 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28222)[sext_i32_i64(local_tid_28218)];\n                        if ((local_tid_28218 - squot32(local_tid_28218, 32) *\n                             32) == 0) {\n                            x_28230 = x_28231;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28235 = 1;\n                    while (slt32(skip_threads_28235, 32)) {\n                        if (sle32(skip_threads_28235, local_tid_28218 -\n                                  squot32(local_tid_28218, 32) * 32) &&\n                            (squot32(local_tid_28218, 32) == 0 &&\n                             ltid_in_bounds_28233)) {\n                            // read operands\n                            {\n       ",
                   "                         x_28230 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28222)[sext_i32_i64(local_tid_28218) -\n                                                                           sext_i32_i64(skip_threads_28235)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_28232 = add64(x_28230, x_28231);\n                                \n                                x_28230 = res_28232;\n                            }\n                        }\n                        if (sle32(wave_sizze_28220, skip_threads_28235)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28235, local_tid_28218 -\n                                  squot32(local_tid_28218, 32) * 32) &&\n                            (squot32(local_tid_28218, 32) == 0 &&\n                             ltid_in_bounds_28233)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28222)[sext_i32_i64(local_tid_28218)] =\n                                    x_28230;\n                                x_28231 = x_28230;\n                            }\n                        }\n                        if (sle32(wave_sizze_28220, skip_threads_28235)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28235 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28218, 32) == 0 ||\n                      !ltid_in_bounds_28233)) {\n                    // read operands\n                    {\n                        x_28228 = x_28227;\n                   ",
                   "     x_28227 = ((__local\n                                    int64_t *) scan_arr_mem_28222)[sext_i32_i64(squot32(local_tid_28218,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28229 = add64(x_28227, x_28228);\n                        \n                        x_28227 = res_28229;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_28222)[sext_i32_i64(local_tid_28218)] =\n                            x_28227;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28218, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_28222)[sext_i32_i64(local_tid_28218)] =\n                        x_28228;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_27049, binop_x_27755)) {\n                    ((__global int64_t *) mem_27803)[gtid_27049] = ((__local\n                                                                     int64_t *) scan_arr_mem_28222)[sext_i32_i64(local_tid_28218)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28236 = 0;\n                bool should_load_carry_28237 = local_tid_28218 == 0 &&\n                     !crosses_segment_28236;\n                \n                if (should_load_carry_28237) {\n                    x_23992 = ((__local\n                 ",
                   "               int64_t *) scan_arr_mem_28222)[segscan_group_sizze_27045 -\n                                                               1];\n                }\n                if (!should_load_carry_28237) {\n                    x_23992 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27045\n}\n__kernel void testziscan_stage1_27083(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28463_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28461_backing_aligned_1,\n                                      int64_t res_24008, __global\n                                      unsigned char *mem_27810, __global\n                                      unsigned char *mem_27814, __global\n                                      unsigned char *mem_27816,\n                                      int32_t num_threads_28455)\n{\n    #define segscan_group_sizze_27078 (testzisegscan_group_sizze_27077)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28463_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28463_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28461_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28461_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28456;\n    int32_t local_tid_28457;\n    int64_t group_sizze_28460;\n    int32_t wave_sizze_28459;\n    int32_t group_tid_28458;\n    \n    global_tid_28456 = get_global_id(0);\n    local_tid_28457 = get_local_id(0);\n    group_sizze_28460 = get_local_size(0);\n    wave_sizze_28459 = LOCKSTEP_WIDTH;\n    g",
                   "roup_tid_28458 = get_group_id(0);\n    \n    int32_t phys_tid_27083;\n    \n    phys_tid_27083 = global_tid_28456;\n    \n    __local char *scan_arr_mem_28461;\n    __local char *scan_arr_mem_28463;\n    \n    scan_arr_mem_28461 = (__local char *) scan_arr_mem_28461_backing_0;\n    scan_arr_mem_28463 = (__local char *) scan_arr_mem_28463_backing_1;\n    \n    bool x_24027;\n    int64_t x_24028;\n    bool x_24029;\n    int64_t x_24030;\n    \n    x_24027 = 0;\n    x_24028 = 0;\n    for (int64_t j_28465 = 0; j_28465 < sdiv_up64(res_24008,\n                                                  sext_i32_i64(num_threads_28455));\n         j_28465++) {\n        int64_t chunk_offset_28466 = segscan_group_sizze_27078 * j_28465 +\n                sext_i32_i64(group_tid_28458) * (segscan_group_sizze_27078 *\n                                                 sdiv_up64(res_24008,\n                                                           sext_i32_i64(num_threads_28455)));\n        int64_t flat_idx_28467 = chunk_offset_28466 +\n                sext_i32_i64(local_tid_28457);\n        int64_t gtid_27082 = flat_idx_28467;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27082, res_24008)) {\n                int64_t x_24034 = ((__global int64_t *) mem_27810)[gtid_27082];\n                bool res_24035 = slt64(0, x_24034);\n                \n                // write to-scan values to parameters\n                {\n                    x_24029 = res_24035;\n                    x_24030 = x_24034;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27082, res_24008)) {\n                    x_24029 = 0;\n                    x_24030 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n",
                   "                bool res_24031 = x_24027 || x_24029;\n                int64_t res_24032;\n                \n                if (x_24029) {\n                    res_24032 = x_24030;\n                } else {\n                    int64_t res_24033 = add64(x_24028, x_24030);\n                    \n                    res_24032 = res_24033;\n                }\n                ((__local\n                  bool *) scan_arr_mem_28461)[sext_i32_i64(local_tid_28457)] =\n                    res_24031;\n                ((__local\n                  int64_t *) scan_arr_mem_28463)[sext_i32_i64(local_tid_28457)] =\n                    res_24032;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28468;\n            int64_t x_28469;\n            bool x_28470;\n            int64_t x_28471;\n            bool x_28475;\n            int64_t x_28476;\n            bool x_28477;\n            int64_t x_28478;\n            bool ltid_in_bounds_28482;\n            \n            ltid_in_bounds_28482 = slt64(sext_i32_i64(local_tid_28457),\n                                         segscan_group_sizze_27078);\n            \n            int32_t skip_threads_28483;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28482) {\n                    x_28470 = ((volatile __local\n                                bool *) scan_arr_mem_28461)[sext_i32_i64(local_tid_28457)];\n                    x_28471 = ((volatile __local\n                                int64_t *) scan_arr_mem_28463)[sext_i32_i64(local_tid_28457)];\n                    if ((local_tid_28457 - squot32(local_tid_28457, 32) * 32) ==\n                        0) {\n                        x_28468 = x_28470;\n                        x_28469 = x_28471;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28483 = 1;\n                while (slt32(skip_threads_28483, 32)) {\n                    i",
                   "f (sle32(skip_threads_28483, local_tid_28457 -\n                              squot32(local_tid_28457, 32) * 32) &&\n                        ltid_in_bounds_28482) {\n                        // read operands\n                        {\n                            x_28468 = ((volatile __local\n                                        bool *) scan_arr_mem_28461)[sext_i32_i64(local_tid_28457) -\n                                                                    sext_i32_i64(skip_threads_28483)];\n                            x_28469 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28463)[sext_i32_i64(local_tid_28457) -\n                                                                       sext_i32_i64(skip_threads_28483)];\n                        }\n                        // perform operation\n                        {\n                            bool res_28472 = x_28468 || x_28470;\n                            int64_t res_28473;\n                            \n                            if (x_28470) {\n                                res_28473 = x_28471;\n                            } else {\n                                int64_t res_28474 = add64(x_28469, x_28471);\n                                \n                                res_28473 = res_28474;\n                            }\n                            x_28468 = res_28472;\n                            x_28469 = res_28473;\n                        }\n                    }\n                    if (sle32(wave_sizze_28459, skip_threads_28483)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28483, local_tid_28457 -\n                              squot32(local_tid_28457, 32) * 32) &&\n                        ltid_in_bounds_28482) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_28461)[sext_i32_i64(local_tid_28457)]",
                   " =\n                                x_28468;\n                            x_28470 = x_28468;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28463)[sext_i32_i64(local_tid_28457)] =\n                                x_28469;\n                            x_28471 = x_28469;\n                        }\n                    }\n                    if (sle32(wave_sizze_28459, skip_threads_28483)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28483 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28457 - squot32(local_tid_28457, 32) * 32) ==\n                    31 && ltid_in_bounds_28482) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28461)[sext_i32_i64(squot32(local_tid_28457,\n                                                                       32))] =\n                        x_28468;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28463)[sext_i32_i64(squot32(local_tid_28457,\n                                                                          32))] =\n                        x_28469;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28484;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28457, 32) == 0 &&\n                        ltid_in_bounds_28482) {\n                        x_28477 = ((volatile __local\n                                    bool *) scan_arr_mem_28461)[sext_i32_i64(local_tid_28457)];\n                        x_28478 = ((volatile __local\n                                    int64_t *) sc",
                   "an_arr_mem_28463)[sext_i32_i64(local_tid_28457)];\n                        if ((local_tid_28457 - squot32(local_tid_28457, 32) *\n                             32) == 0) {\n                            x_28475 = x_28477;\n                            x_28476 = x_28478;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28484 = 1;\n                    while (slt32(skip_threads_28484, 32)) {\n                        if (sle32(skip_threads_28484, local_tid_28457 -\n                                  squot32(local_tid_28457, 32) * 32) &&\n                            (squot32(local_tid_28457, 32) == 0 &&\n                             ltid_in_bounds_28482)) {\n                            // read operands\n                            {\n                                x_28475 = ((volatile __local\n                                            bool *) scan_arr_mem_28461)[sext_i32_i64(local_tid_28457) -\n                                                                        sext_i32_i64(skip_threads_28484)];\n                                x_28476 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28463)[sext_i32_i64(local_tid_28457) -\n                                                                           sext_i32_i64(skip_threads_28484)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28479 = x_28475 || x_28477;\n                                int64_t res_28480;\n                                \n                                if (x_28477) {\n                                    res_28480 = x_28478;\n                                } else {\n                                    int64_t res_28481 = add64(x_28476, x_28478);\n                                    \n                                    res_28480 = res_28481;\n            ",
                   "                    }\n                                x_28475 = res_28479;\n                                x_28476 = res_28480;\n                            }\n                        }\n                        if (sle32(wave_sizze_28459, skip_threads_28484)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28484, local_tid_28457 -\n                                  squot32(local_tid_28457, 32) * 32) &&\n                            (squot32(local_tid_28457, 32) == 0 &&\n                             ltid_in_bounds_28482)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_28461)[sext_i32_i64(local_tid_28457)] =\n                                    x_28475;\n                                x_28477 = x_28475;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28463)[sext_i32_i64(local_tid_28457)] =\n                                    x_28476;\n                                x_28478 = x_28476;\n                            }\n                        }\n                        if (sle32(wave_sizze_28459, skip_threads_28484)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28484 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28457, 32) == 0 ||\n                      !ltid_in_bounds_28482)) {\n                    // read operands\n                    {\n                        x_28470 = x_28468;\n                        x_28471 = x_28469;\n                        x_28468 = ((__local\n                                    bool *) scan_arr_mem_28461)[sext_i32_i64(squot32(local_tid_28457,\n   ",
                   "                                                                                  32)) -\n                                                                1];\n                        x_28469 = ((__local\n                                    int64_t *) scan_arr_mem_28463)[sext_i32_i64(squot32(local_tid_28457,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        bool res_28472 = x_28468 || x_28470;\n                        int64_t res_28473;\n                        \n                        if (x_28470) {\n                            res_28473 = x_28471;\n                        } else {\n                            int64_t res_28474 = add64(x_28469, x_28471);\n                            \n                            res_28473 = res_28474;\n                        }\n                        x_28468 = res_28472;\n                        x_28469 = res_28473;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28461)[sext_i32_i64(local_tid_28457)] =\n                            x_28468;\n                        ((__local\n                          int64_t *) scan_arr_mem_28463)[sext_i32_i64(local_tid_28457)] =\n                            x_28469;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28457, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_28461)[sext_i32_i64(local_tid_28457)] =\n                        x_28470;\n                    ((__local\n                      int64_t *) scan_arr_mem_28463)[sext_i32_i64(local_tid_28457)] =\n                        x_28471;\n   ",
                   "             }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_27082, res_24008)) {\n                    ((__global bool *) mem_27814)[gtid_27082] = ((__local\n                                                                  bool *) scan_arr_mem_28461)[sext_i32_i64(local_tid_28457)];\n                    ((__global int64_t *) mem_27816)[gtid_27082] = ((__local\n                                                                     int64_t *) scan_arr_mem_28463)[sext_i32_i64(local_tid_28457)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28485 = 0;\n                bool should_load_carry_28486 = local_tid_28457 == 0 &&\n                     !crosses_segment_28485;\n                \n                if (should_load_carry_28486) {\n                    x_24027 = ((__local\n                                bool *) scan_arr_mem_28461)[segscan_group_sizze_27078 -\n                                                            1];\n                    x_24028 = ((__local\n                                int64_t *) scan_arr_mem_28463)[segscan_group_sizze_27078 -\n                                                               1];\n                }\n                if (!should_load_carry_28486) {\n                    x_24027 = 0;\n                    x_24028 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27078\n}\n__kernel void testziscan_stage1_27091(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28530_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem",
                   "_28528_backing_aligned_1,\n                                      int64_t res_24008, __global\n                                      unsigned char *mem_27816, __global\n                                      unsigned char *mem_27819, __global\n                                      unsigned char *mem_27821, __global\n                                      unsigned char *mem_27823,\n                                      int32_t num_threads_28522)\n{\n    #define segscan_group_sizze_27086 (testzisegscan_group_sizze_27085)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28530_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28530_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28528_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28528_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28523;\n    int32_t local_tid_28524;\n    int64_t group_sizze_28527;\n    int32_t wave_sizze_28526;\n    int32_t group_tid_28525;\n    \n    global_tid_28523 = get_global_id(0);\n    local_tid_28524 = get_local_id(0);\n    group_sizze_28527 = get_local_size(0);\n    wave_sizze_28526 = LOCKSTEP_WIDTH;\n    group_tid_28525 = get_group_id(0);\n    \n    int32_t phys_tid_27091;\n    \n    phys_tid_27091 = global_tid_28523;\n    \n    __local char *scan_arr_mem_28528;\n    __local char *scan_arr_mem_28530;\n    \n    scan_arr_mem_28528 = (__local char *) scan_arr_mem_28528_backing_0;\n    scan_arr_mem_28530 = (__local char *) scan_arr_mem_28530_backing_1;\n    \n    bool x_24067;\n    int64_t x_24068;\n    bool x_24069;\n    int64_t x_24070;\n    \n    x_24067 = 0;\n    x_24068 = 0;\n    for (int64_t j_28532 = 0; j_28532 < sdiv_up64(res_24008,\n                                                  sext_i32_i64(num_threads_28522));\n         j_28532++) {\n        int64_t ",
                   "chunk_offset_28533 = segscan_group_sizze_27086 * j_28532 +\n                sext_i32_i64(group_tid_28525) * (segscan_group_sizze_27086 *\n                                                 sdiv_up64(res_24008,\n                                                           sext_i32_i64(num_threads_28522)));\n        int64_t flat_idx_28534 = chunk_offset_28533 +\n                sext_i32_i64(local_tid_28524);\n        int64_t gtid_27090 = flat_idx_28534;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27090, res_24008)) {\n                int64_t x_24074 = ((__global int64_t *) mem_27816)[gtid_27090];\n                int64_t i_p_o_27576 = add64(-1, gtid_27090);\n                int64_t rot_i_27577 = smod64(i_p_o_27576, res_24008);\n                int64_t x_24075 = ((__global int64_t *) mem_27816)[rot_i_27577];\n                bool res_24077 = x_24074 == x_24075;\n                bool res_24078 = !res_24077;\n                \n                // write to-scan values to parameters\n                {\n                    x_24069 = res_24078;\n                    x_24070 = 1;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global bool *) mem_27823)[gtid_27090] = res_24078;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27090, res_24008)) {\n                    x_24069 = 0;\n                    x_24070 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_24071 = x_24067 || x_24069;\n                int64_t res_24072;\n                \n                if (x_24069) {\n                    res_24072 = x_24070;\n                } else {\n                    int64_t res_24073 = add64(x_24068, x_24070);\n                    \n               ",
                   "     res_24072 = res_24073;\n                }\n                ((__local\n                  bool *) scan_arr_mem_28528)[sext_i32_i64(local_tid_28524)] =\n                    res_24071;\n                ((__local\n                  int64_t *) scan_arr_mem_28530)[sext_i32_i64(local_tid_28524)] =\n                    res_24072;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28535;\n            int64_t x_28536;\n            bool x_28537;\n            int64_t x_28538;\n            bool x_28542;\n            int64_t x_28543;\n            bool x_28544;\n            int64_t x_28545;\n            bool ltid_in_bounds_28549;\n            \n            ltid_in_bounds_28549 = slt64(sext_i32_i64(local_tid_28524),\n                                         segscan_group_sizze_27086);\n            \n            int32_t skip_threads_28550;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28549) {\n                    x_28537 = ((volatile __local\n                                bool *) scan_arr_mem_28528)[sext_i32_i64(local_tid_28524)];\n                    x_28538 = ((volatile __local\n                                int64_t *) scan_arr_mem_28530)[sext_i32_i64(local_tid_28524)];\n                    if ((local_tid_28524 - squot32(local_tid_28524, 32) * 32) ==\n                        0) {\n                        x_28535 = x_28537;\n                        x_28536 = x_28538;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28550 = 1;\n                while (slt32(skip_threads_28550, 32)) {\n                    if (sle32(skip_threads_28550, local_tid_28524 -\n                              squot32(local_tid_28524, 32) * 32) &&\n                        ltid_in_bounds_28549) {\n                        // read operands\n                        {\n                            x_28535 = ((volatile __local\n                ",
                   "                        bool *) scan_arr_mem_28528)[sext_i32_i64(local_tid_28524) -\n                                                                    sext_i32_i64(skip_threads_28550)];\n                            x_28536 = ((volatile __local\n                                        int64_t *) scan_arr_mem_28530)[sext_i32_i64(local_tid_28524) -\n                                                                       sext_i32_i64(skip_threads_28550)];\n                        }\n                        // perform operation\n                        {\n                            bool res_28539 = x_28535 || x_28537;\n                            int64_t res_28540;\n                            \n                            if (x_28537) {\n                                res_28540 = x_28538;\n                            } else {\n                                int64_t res_28541 = add64(x_28536, x_28538);\n                                \n                                res_28540 = res_28541;\n                            }\n                            x_28535 = res_28539;\n                            x_28536 = res_28540;\n                        }\n                    }\n                    if (sle32(wave_sizze_28526, skip_threads_28550)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28550, local_tid_28524 -\n                              squot32(local_tid_28524, 32) * 32) &&\n                        ltid_in_bounds_28549) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_28528)[sext_i32_i64(local_tid_28524)] =\n                                x_28535;\n                            x_28537 = x_28535;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28530)[sext_i32_i64(local_tid_28524)] =\n                                x_28536;\n                            x_",
                   "28538 = x_28536;\n                        }\n                    }\n                    if (sle32(wave_sizze_28526, skip_threads_28550)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28550 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28524 - squot32(local_tid_28524, 32) * 32) ==\n                    31 && ltid_in_bounds_28549) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28528)[sext_i32_i64(squot32(local_tid_28524,\n                                                                       32))] =\n                        x_28535;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28530)[sext_i32_i64(squot32(local_tid_28524,\n                                                                          32))] =\n                        x_28536;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28551;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28524, 32) == 0 &&\n                        ltid_in_bounds_28549) {\n                        x_28544 = ((volatile __local\n                                    bool *) scan_arr_mem_28528)[sext_i32_i64(local_tid_28524)];\n                        x_28545 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28530)[sext_i32_i64(local_tid_28524)];\n                        if ((local_tid_28524 - squot32(local_tid_28524, 32) *\n                             32) == 0) {\n                            x_28542 = x_28544;\n                            x_28543 = x_28545;\n                        }\n              ",
                   "      }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28551 = 1;\n                    while (slt32(skip_threads_28551, 32)) {\n                        if (sle32(skip_threads_28551, local_tid_28524 -\n                                  squot32(local_tid_28524, 32) * 32) &&\n                            (squot32(local_tid_28524, 32) == 0 &&\n                             ltid_in_bounds_28549)) {\n                            // read operands\n                            {\n                                x_28542 = ((volatile __local\n                                            bool *) scan_arr_mem_28528)[sext_i32_i64(local_tid_28524) -\n                                                                        sext_i32_i64(skip_threads_28551)];\n                                x_28543 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28530)[sext_i32_i64(local_tid_28524) -\n                                                                           sext_i32_i64(skip_threads_28551)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28546 = x_28542 || x_28544;\n                                int64_t res_28547;\n                                \n                                if (x_28544) {\n                                    res_28547 = x_28545;\n                                } else {\n                                    int64_t res_28548 = add64(x_28543, x_28545);\n                                    \n                                    res_28547 = res_28548;\n                                }\n                                x_28542 = res_28546;\n                                x_28543 = res_28547;\n                            }\n                        }\n                        if (sle32(wave_sizze_28526, skip_threads_28551)) {\n                            barrier(CLK_LOCA",
                   "L_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28551, local_tid_28524 -\n                                  squot32(local_tid_28524, 32) * 32) &&\n                            (squot32(local_tid_28524, 32) == 0 &&\n                             ltid_in_bounds_28549)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_28528)[sext_i32_i64(local_tid_28524)] =\n                                    x_28542;\n                                x_28544 = x_28542;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28530)[sext_i32_i64(local_tid_28524)] =\n                                    x_28543;\n                                x_28545 = x_28543;\n                            }\n                        }\n                        if (sle32(wave_sizze_28526, skip_threads_28551)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28551 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28524, 32) == 0 ||\n                      !ltid_in_bounds_28549)) {\n                    // read operands\n                    {\n                        x_28537 = x_28535;\n                        x_28538 = x_28536;\n                        x_28535 = ((__local\n                                    bool *) scan_arr_mem_28528)[sext_i32_i64(squot32(local_tid_28524,\n                                                                                     32)) -\n                                                                1];\n                        x_28536 = ((__local\n                                    int64_t *) scan_arr_mem_28530)[sext_i32_i64(squot32(local_tid_2852",
                   "4,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        bool res_28539 = x_28535 || x_28537;\n                        int64_t res_28540;\n                        \n                        if (x_28537) {\n                            res_28540 = x_28538;\n                        } else {\n                            int64_t res_28541 = add64(x_28536, x_28538);\n                            \n                            res_28540 = res_28541;\n                        }\n                        x_28535 = res_28539;\n                        x_28536 = res_28540;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28528)[sext_i32_i64(local_tid_28524)] =\n                            x_28535;\n                        ((__local\n                          int64_t *) scan_arr_mem_28530)[sext_i32_i64(local_tid_28524)] =\n                            x_28536;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28524, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_28528)[sext_i32_i64(local_tid_28524)] =\n                        x_28537;\n                    ((__local\n                      int64_t *) scan_arr_mem_28530)[sext_i32_i64(local_tid_28524)] =\n                        x_28538;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_27090, res_24008)) {\n                    ((__global bool *) mem_27819)[gtid_27090] = ((__local\n                                 ",
                   "                                 bool *) scan_arr_mem_28528)[sext_i32_i64(local_tid_28524)];\n                    ((__global int64_t *) mem_27821)[gtid_27090] = ((__local\n                                                                     int64_t *) scan_arr_mem_28530)[sext_i32_i64(local_tid_28524)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28552 = 0;\n                bool should_load_carry_28553 = local_tid_28524 == 0 &&\n                     !crosses_segment_28552;\n                \n                if (should_load_carry_28553) {\n                    x_24067 = ((__local\n                                bool *) scan_arr_mem_28528)[segscan_group_sizze_27086 -\n                                                            1];\n                    x_24068 = ((__local\n                                int64_t *) scan_arr_mem_28530)[segscan_group_sizze_27086 -\n                                                               1];\n                }\n                if (!should_load_carry_28553) {\n                    x_24067 = 0;\n                    x_24068 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27086\n}\n__kernel void testziscan_stage1_27099(__global int *global_failure,\n                                      int failure_is_an_option, __global\n                                      int64_t *global_failure_args,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28597_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28595_backing_aligned_1,\n                                      int64_t steps_23808, int64_t res_24008,\n                                      int64_t one_intra_pa",
                   "r_min_26359, __global\n                                      unsigned char *res_mem_27723, __global\n                                      unsigned char *res_mem_27724, __global\n                                      unsigned char *res_mem_27725, __global\n                                      unsigned char *res_mem_27726,\n                                      int64_t binop_x_27755, __global\n                                      unsigned char *res_mem_27799, __global\n                                      unsigned char *res_mem_27800, __global\n                                      unsigned char *mem_27816, __global\n                                      unsigned char *mem_27821, __global\n                                      unsigned char *mem_27823, __global\n                                      unsigned char *mem_27826, __global\n                                      unsigned char *mem_27828,\n                                      int32_t num_threads_28589)\n{\n    #define segscan_group_sizze_27094 (testzisegscan_group_sizze_27093)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28597_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28597_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28595_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28595_backing_aligned_1;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_28590;\n    int32_t local_tid_28591;\n    int64_t group_sizze_28594;\n    int32_t wave_sizze_28593;\n    int32_t group_tid_28592;\n    \n    global_tid_28590 = get_global_id(0);\n    local_tid_28591 = get_local_id(0);\n    group_sizze_28594",
                   " = get_local_size(0);\n    wave_sizze_28593 = LOCKSTEP_WIDTH;\n    group_tid_28592 = get_group_id(0);\n    \n    int32_t phys_tid_27099;\n    \n    phys_tid_27099 = global_tid_28590;\n    \n    __local char *scan_arr_mem_28595;\n    __local char *scan_arr_mem_28597;\n    \n    scan_arr_mem_28595 = (__local char *) scan_arr_mem_28595_backing_0;\n    scan_arr_mem_28597 = (__local char *) scan_arr_mem_28597_backing_1;\n    \n    bool x_24093;\n    float x_24094;\n    bool x_24095;\n    float x_24096;\n    \n    x_24093 = 0;\n    x_24094 = 0.0F;\n    for (int64_t j_28599 = 0; j_28599 < sdiv_up64(res_24008,\n                                                  sext_i32_i64(num_threads_28589));\n         j_28599++) {\n        int64_t chunk_offset_28600 = segscan_group_sizze_27094 * j_28599 +\n                sext_i32_i64(group_tid_28592) * (segscan_group_sizze_27094 *\n                                                 sdiv_up64(res_24008,\n                                                           sext_i32_i64(num_threads_28589)));\n        int64_t flat_idx_28601 = chunk_offset_28600 +\n                sext_i32_i64(local_tid_28591);\n        int64_t gtid_27098 = flat_idx_28601;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27098, res_24008)) {\n                int64_t x_24101 = ((__global int64_t *) mem_27821)[gtid_27098];\n                int64_t x_24102 = ((__global int64_t *) mem_27816)[gtid_27098];\n                bool x_24103 = ((__global bool *) mem_27823)[gtid_27098];\n                int64_t res_24106 = sub64(x_24101, 1);\n                bool x_24107 = sle64(0, x_24102);\n                bool y_24108 = slt64(x_24102, binop_x_27755);\n                bool bounds_check_24109 = x_24107 && y_24108;\n                bool index_certs_24110;\n                \n                if (!bounds_check_24109) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 21) ==\n                            -1) {\n                            global_f",
                   "ailure_args[0] = x_24102;\n                            global_failure_args[1] = binop_x_27755;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t new_index_24111 = squot64(x_24102,\n                                                  one_intra_par_min_26359);\n                int64_t binop_y_24112 = new_index_24111 *\n                        one_intra_par_min_26359;\n                int64_t binop_x_24113 = x_24102 - binop_y_24112;\n                int64_t new_index_24114 = squot64(binop_x_24113, 9);\n                int64_t binop_y_24115 = 9 * new_index_24114;\n                int64_t new_index_24116 = binop_x_24113 - binop_y_24115;\n                int64_t lifted_0_get_arg_24120 = ((__global\n                                                   int64_t *) res_mem_27725)[new_index_24116];\n                float lifted_0_get_arg_24121 = ((__global\n                                                 float *) res_mem_27726)[new_index_24116];\n                float lifted_0_get_arg_24122 = ((__global\n                                                 float *) res_mem_27800)[new_index_24111 *\n                                                                         (9 *\n                                                                          steps_23808) +\n                                                                         new_index_24114 *\n                                                                         9 +\n                                                                         new_index_24116];\n                float x_24123 = lifted_0_get_arg_24122 / lifted_0_get_arg_24121;\n                float ceil_arg_24124 = x_24123 - 1.0F;\n                float res_24125;\n                \n                res_24125 = futrts_ceil32(ceil_arg_24124);\n                \n                int64_t res_24126 = fptosi_f32_i64(res_241",
                   "25);\n                int64_t max_arg_24127 = sub64(lifted_0_get_arg_24120,\n                                              res_24126);\n                int64_t res_24128 = smax64(0, max_arg_24127);\n                bool cond_24129 = res_24128 == 0;\n                float res_24130;\n                \n                if (cond_24129) {\n                    res_24130 = 0.0F;\n                } else {\n                    float lifted_0_get_arg_24117 = ((__global\n                                                     float *) res_mem_27799)[new_index_24111 *\n                                                                             (9 *\n                                                                              steps_23808) +\n                                                                             new_index_24114 *\n                                                                             9 +\n                                                                             new_index_24116];\n                    float lifted_0_get_arg_24118 = ((__global\n                                                     float *) res_mem_27723)[new_index_24116];\n                    float lifted_0_get_arg_24119 = ((__global\n                                                     float *) res_mem_27724)[new_index_24116];\n                    float res_24131;\n                    \n                    res_24131 = futrts_ceil32(x_24123);\n                    \n                    float start_24132 = lifted_0_get_arg_24121 * res_24131;\n                    float res_24133;\n                    \n                    res_24133 = futrts_ceil32(ceil_arg_24124);\n                    \n                    int64_t res_24134 = fptosi_f32_i64(res_24133);\n                    int64_t max_arg_24135 = sub64(lifted_0_get_arg_24120,\n                                                  res_24134);\n                    int64_t res_24136 = smax64(0, max_arg_24135);\n                    int64_t sizze_24137 = sub64(res_24136, 1);\n      ",
                   "              bool cond_24138 = res_24106 == 0;\n                    float res_24139;\n                    \n                    if (cond_24138) {\n                        res_24139 = 1.0F;\n                    } else {\n                        res_24139 = 0.0F;\n                    }\n                    \n                    bool cond_24140 = slt64(0, res_24106);\n                    float res_24141;\n                    \n                    if (cond_24140) {\n                        float y_24142 = lifted_0_get_arg_24118 *\n                              lifted_0_get_arg_24121;\n                        float res_24143 = res_24139 - y_24142;\n                        \n                        res_24141 = res_24143;\n                    } else {\n                        res_24141 = res_24139;\n                    }\n                    \n                    bool cond_24144 = res_24106 == sizze_24137;\n                    float res_24145;\n                    \n                    if (cond_24144) {\n                        float res_24146 = res_24141 - 1.0F;\n                        \n                        res_24145 = res_24146;\n                    } else {\n                        res_24145 = res_24141;\n                    }\n                    \n                    float res_24147 = lifted_0_get_arg_24119 * res_24145;\n                    float res_24148 = sitofp_i64_f32(res_24106);\n                    float y_24149 = lifted_0_get_arg_24121 * res_24148;\n                    float bondprice_arg_24150 = start_24132 + y_24149;\n                    float y_24151 = bondprice_arg_24150 -\n                          lifted_0_get_arg_24122;\n                    float negate_arg_24152 = 1.0e-2F * y_24151;\n                    float exp_arg_24153 = 0.0F - negate_arg_24152;\n                    float res_24154 = fpow32(2.7182817F, exp_arg_24153);\n                    float x_24155 = 1.0F - res_24154;\n                    float B_24156 = x_24155 / 1.0e-2F;\n                    float x_24157 = B_24156 - bondprice_ar",
                   "g_24150;\n                    float x_24158 = lifted_0_get_arg_24122 + x_24157;\n                    float x_24159 = 4.4999997e-6F * x_24158;\n                    float A1_24160 = x_24159 / 1.0e-4F;\n                    float y_24161 = fpow32(B_24156, 2.0F);\n                    float x_24162 = 1.0000001e-6F * y_24161;\n                    float A2_24163 = x_24162 / 4.0e-2F;\n                    float exp_arg_24164 = A1_24160 - A2_24163;\n                    float res_24165 = fpow32(2.7182817F, exp_arg_24164);\n                    float negate_arg_24166 = lifted_0_get_arg_24117 * B_24156;\n                    float exp_arg_24167 = 0.0F - negate_arg_24166;\n                    float res_24168 = fpow32(2.7182817F, exp_arg_24167);\n                    float res_24169 = res_24165 * res_24168;\n                    float res_24170 = res_24147 * res_24169;\n                    \n                    res_24130 = res_24170;\n                }\n                // write to-scan values to parameters\n                {\n                    x_24095 = x_24103;\n                    x_24096 = res_24130;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27098, res_24008)) {\n                    x_24095 = 0;\n                    x_24096 = 0.0F;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_24097 = x_24093 || x_24095;\n                float res_24098;\n                \n                if (x_24095) {\n                    res_24098 = x_24096;\n                } else {\n                    float res_24099 = x_24094 + x_24096;\n                    \n                    res_24098 = res_24099;\n                }\n                ((__local\n                  bool *) scan_arr_mem_28595)[sex",
                   "t_i32_i64(local_tid_28591)] =\n                    res_24097;\n                ((__local\n                  float *) scan_arr_mem_28597)[sext_i32_i64(local_tid_28591)] =\n                    res_24098;\n            }\n            \n          error_0:\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_failure)\n                return;\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_28602;\n            float x_28603;\n            bool x_28604;\n            float x_28605;\n            bool x_28609;\n            float x_28610;\n            bool x_28611;\n            float x_28612;\n            bool ltid_in_bounds_28616;\n            \n            ltid_in_bounds_28616 = slt64(sext_i32_i64(local_tid_28591),\n                                         segscan_group_sizze_27094);\n            \n            int32_t skip_threads_28617;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28616) {\n                    x_28604 = ((volatile __local\n                                bool *) scan_arr_mem_28595)[sext_i32_i64(local_tid_28591)];\n                    x_28605 = ((volatile __local\n                                float *) scan_arr_mem_28597)[sext_i32_i64(local_tid_28591)];\n                    if ((local_tid_28591 - squot32(local_tid_28591, 32) * 32) ==\n                        0) {\n                        x_28602 = x_28604;\n                        x_28603 = x_28605;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28617 = 1;\n                while (slt32(skip_threads_28617, 32)) {\n                    if (sle32(skip_threads_28617, local_tid_28591 -\n                              squot32(local_tid_28591, 32) * 32) &&\n                        ltid_in_bounds_28616) {\n                        // read operands\n                        {\n                            x_28602 = ((volatile __local\n                    ",
                   "                    bool *) scan_arr_mem_28595)[sext_i32_i64(local_tid_28591) -\n                                                                    sext_i32_i64(skip_threads_28617)];\n                            x_28603 = ((volatile __local\n                                        float *) scan_arr_mem_28597)[sext_i32_i64(local_tid_28591) -\n                                                                     sext_i32_i64(skip_threads_28617)];\n                        }\n                        // perform operation\n                        {\n                            bool res_28606 = x_28602 || x_28604;\n                            float res_28607;\n                            \n                            if (x_28604) {\n                                res_28607 = x_28605;\n                            } else {\n                                float res_28608 = x_28603 + x_28605;\n                                \n                                res_28607 = res_28608;\n                            }\n                            x_28602 = res_28606;\n                            x_28603 = res_28607;\n                        }\n                    }\n                    if (sle32(wave_sizze_28593, skip_threads_28617)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28617, local_tid_28591 -\n                              squot32(local_tid_28591, 32) * 32) &&\n                        ltid_in_bounds_28616) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_28595)[sext_i32_i64(local_tid_28591)] =\n                                x_28602;\n                            x_28604 = x_28602;\n                            ((volatile __local\n                              float *) scan_arr_mem_28597)[sext_i32_i64(local_tid_28591)] =\n                                x_28603;\n                            x_28605 = x_28603;\n   ",
                   "                     }\n                    }\n                    if (sle32(wave_sizze_28593, skip_threads_28617)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28617 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28591 - squot32(local_tid_28591, 32) * 32) ==\n                    31 && ltid_in_bounds_28616) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28595)[sext_i32_i64(squot32(local_tid_28591,\n                                                                       32))] =\n                        x_28602;\n                    ((volatile __local\n                      float *) scan_arr_mem_28597)[sext_i32_i64(squot32(local_tid_28591,\n                                                                        32))] =\n                        x_28603;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28618;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28591, 32) == 0 &&\n                        ltid_in_bounds_28616) {\n                        x_28611 = ((volatile __local\n                                    bool *) scan_arr_mem_28595)[sext_i32_i64(local_tid_28591)];\n                        x_28612 = ((volatile __local\n                                    float *) scan_arr_mem_28597)[sext_i32_i64(local_tid_28591)];\n                        if ((local_tid_28591 - squot32(local_tid_28591, 32) *\n                             32) == 0) {\n                            x_28609 = x_28611;\n                            x_28610 = x_28612;\n                        }\n                    }\n                }\n",
                   "                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28618 = 1;\n                    while (slt32(skip_threads_28618, 32)) {\n                        if (sle32(skip_threads_28618, local_tid_28591 -\n                                  squot32(local_tid_28591, 32) * 32) &&\n                            (squot32(local_tid_28591, 32) == 0 &&\n                             ltid_in_bounds_28616)) {\n                            // read operands\n                            {\n                                x_28609 = ((volatile __local\n                                            bool *) scan_arr_mem_28595)[sext_i32_i64(local_tid_28591) -\n                                                                        sext_i32_i64(skip_threads_28618)];\n                                x_28610 = ((volatile __local\n                                            float *) scan_arr_mem_28597)[sext_i32_i64(local_tid_28591) -\n                                                                         sext_i32_i64(skip_threads_28618)];\n                            }\n                            // perform operation\n                            {\n                                bool res_28613 = x_28609 || x_28611;\n                                float res_28614;\n                                \n                                if (x_28611) {\n                                    res_28614 = x_28612;\n                                } else {\n                                    float res_28615 = x_28610 + x_28612;\n                                    \n                                    res_28614 = res_28615;\n                                }\n                                x_28609 = res_28613;\n                                x_28610 = res_28614;\n                            }\n                        }\n                        if (sle32(wave_sizze_28593, skip_threads_28618)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n",
                   "                        if (sle32(skip_threads_28618, local_tid_28591 -\n                                  squot32(local_tid_28591, 32) * 32) &&\n                            (squot32(local_tid_28591, 32) == 0 &&\n                             ltid_in_bounds_28616)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_28595)[sext_i32_i64(local_tid_28591)] =\n                                    x_28609;\n                                x_28611 = x_28609;\n                                ((volatile __local\n                                  float *) scan_arr_mem_28597)[sext_i32_i64(local_tid_28591)] =\n                                    x_28610;\n                                x_28612 = x_28610;\n                            }\n                        }\n                        if (sle32(wave_sizze_28593, skip_threads_28618)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28618 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28591, 32) == 0 ||\n                      !ltid_in_bounds_28616)) {\n                    // read operands\n                    {\n                        x_28604 = x_28602;\n                        x_28605 = x_28603;\n                        x_28602 = ((__local\n                                    bool *) scan_arr_mem_28595)[sext_i32_i64(squot32(local_tid_28591,\n                                                                                     32)) -\n                                                                1];\n                        x_28603 = ((__local\n                                    float *) scan_arr_mem_28597)[sext_i32_i64(squot32(local_tid_28591,\n                                         ",
                   "                                             32)) -\n                                                                 1];\n                    }\n                    // perform operation\n                    {\n                        bool res_28606 = x_28602 || x_28604;\n                        float res_28607;\n                        \n                        if (x_28604) {\n                            res_28607 = x_28605;\n                        } else {\n                            float res_28608 = x_28603 + x_28605;\n                            \n                            res_28607 = res_28608;\n                        }\n                        x_28602 = res_28606;\n                        x_28603 = res_28607;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_28595)[sext_i32_i64(local_tid_28591)] =\n                            x_28602;\n                        ((__local\n                          float *) scan_arr_mem_28597)[sext_i32_i64(local_tid_28591)] =\n                            x_28603;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28591, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_28595)[sext_i32_i64(local_tid_28591)] =\n                        x_28604;\n                    ((__local\n                      float *) scan_arr_mem_28597)[sext_i32_i64(local_tid_28591)] =\n                        x_28605;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_27098, res_24008)) {\n                    ((__global bool *) mem_27826)[gtid_27098] = ((__local\n                                                                  bool *) scan_arr_mem_28595)[s",
                   "ext_i32_i64(local_tid_28591)];\n                    ((__global float *) mem_27828)[gtid_27098] = ((__local\n                                                                   float *) scan_arr_mem_28597)[sext_i32_i64(local_tid_28591)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28619 = 0;\n                bool should_load_carry_28620 = local_tid_28591 == 0 &&\n                     !crosses_segment_28619;\n                \n                if (should_load_carry_28620) {\n                    x_24093 = ((__local\n                                bool *) scan_arr_mem_28595)[segscan_group_sizze_27094 -\n                                                            1];\n                    x_24094 = ((__local\n                                float *) scan_arr_mem_28597)[segscan_group_sizze_27094 -\n                                                             1];\n                }\n                if (!should_load_carry_28620) {\n                    x_24093 = 0;\n                    x_24094 = 0.0F;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27094\n}\n__kernel void testziscan_stage1_27151(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28662_backing_aligned_0,\n                                      int64_t res_24008, __global\n                                      unsigned char *mem_27823, __global\n                                      unsigned char *mem_27831,\n                                      int32_t num_threads_28656)\n{\n    #define segscan_group_sizze_27146 (testzisegscan_group_sizze_27145)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_",
                   "28662_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28662_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28657;\n    int32_t local_tid_28658;\n    int64_t group_sizze_28661;\n    int32_t wave_sizze_28660;\n    int32_t group_tid_28659;\n    \n    global_tid_28657 = get_global_id(0);\n    local_tid_28658 = get_local_id(0);\n    group_sizze_28661 = get_local_size(0);\n    wave_sizze_28660 = LOCKSTEP_WIDTH;\n    group_tid_28659 = get_group_id(0);\n    \n    int32_t phys_tid_27151;\n    \n    phys_tid_27151 = global_tid_28657;\n    \n    __local char *scan_arr_mem_28662;\n    \n    scan_arr_mem_28662 = (__local char *) scan_arr_mem_28662_backing_0;\n    \n    int64_t x_24194;\n    int64_t x_24195;\n    \n    x_24194 = 0;\n    for (int64_t j_28664 = 0; j_28664 < sdiv_up64(res_24008,\n                                                  sext_i32_i64(num_threads_28656));\n         j_28664++) {\n        int64_t chunk_offset_28665 = segscan_group_sizze_27146 * j_28664 +\n                sext_i32_i64(group_tid_28659) * (segscan_group_sizze_27146 *\n                                                 sdiv_up64(res_24008,\n                                                           sext_i32_i64(num_threads_28656)));\n        int64_t flat_idx_28666 = chunk_offset_28665 +\n                sext_i32_i64(local_tid_28658);\n        int64_t gtid_27150 = flat_idx_28666;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27150, res_24008)) {\n                int64_t i_p_o_27578 = add64(1, gtid_27150);\n                int64_t rot_i_27579 = smod64(i_p_o_27578, res_24008);\n                bool x_24197 = ((__global bool *) mem_27823)[rot_i_27579];\n                int64_t res_24198 = btoi_bool_i64(x_24197);\n                \n                // write to-scan values to parameters\n                {\n                    x_24195 = res_24198;\n                }\n                // write mapped values ",
                   "results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27150, res_24008)) {\n                    x_24195 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_24196 = add64(x_24194, x_24195);\n                \n                ((__local\n                  int64_t *) scan_arr_mem_28662)[sext_i32_i64(local_tid_28658)] =\n                    res_24196;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_28667;\n            int64_t x_28668;\n            int64_t x_28670;\n            int64_t x_28671;\n            bool ltid_in_bounds_28673;\n            \n            ltid_in_bounds_28673 = slt64(sext_i32_i64(local_tid_28658),\n                                         segscan_group_sizze_27146);\n            \n            int32_t skip_threads_28674;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_28673) {\n                    x_28668 = ((volatile __local\n                                int64_t *) scan_arr_mem_28662)[sext_i32_i64(local_tid_28658)];\n                    if ((local_tid_28658 - squot32(local_tid_28658, 32) * 32) ==\n                        0) {\n                        x_28667 = x_28668;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_28674 = 1;\n                while (slt32(skip_threads_28674, 32)) {\n                    if (sle32(skip_threads_28674, local_tid_28658 -\n                              squot32(local_tid_28658, 32) * 32) &&\n                        ltid_in_bounds_28673) {\n                        // read operands\n                        {\n                            x_28667 = ((volatile __loca",
                   "l\n                                        int64_t *) scan_arr_mem_28662)[sext_i32_i64(local_tid_28658) -\n                                                                       sext_i32_i64(skip_threads_28674)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_28669 = add64(x_28667, x_28668);\n                            \n                            x_28667 = res_28669;\n                        }\n                    }\n                    if (sle32(wave_sizze_28660, skip_threads_28674)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_28674, local_tid_28658 -\n                              squot32(local_tid_28658, 32) * 32) &&\n                        ltid_in_bounds_28673) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_28662)[sext_i32_i64(local_tid_28658)] =\n                                x_28667;\n                            x_28668 = x_28667;\n                        }\n                    }\n                    if (sle32(wave_sizze_28660, skip_threads_28674)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_28674 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_28658 - squot32(local_tid_28658, 32) * 32) ==\n                    31 && ltid_in_bounds_28673) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28662)[sext_i32_i64(squot32(local_tid_28658,\n                                                                          32))] =\n                        x_28667;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan t",
                   "he first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_28675;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_28658, 32) == 0 &&\n                        ltid_in_bounds_28673) {\n                        x_28671 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28662)[sext_i32_i64(local_tid_28658)];\n                        if ((local_tid_28658 - squot32(local_tid_28658, 32) *\n                             32) == 0) {\n                            x_28670 = x_28671;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28675 = 1;\n                    while (slt32(skip_threads_28675, 32)) {\n                        if (sle32(skip_threads_28675, local_tid_28658 -\n                                  squot32(local_tid_28658, 32) * 32) &&\n                            (squot32(local_tid_28658, 32) == 0 &&\n                             ltid_in_bounds_28673)) {\n                            // read operands\n                            {\n                                x_28670 = ((volatile __local\n                                            int64_t *) scan_arr_mem_28662)[sext_i32_i64(local_tid_28658) -\n                                                                           sext_i32_i64(skip_threads_28675)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_28672 = add64(x_28670, x_28671);\n                                \n                                x_28670 = res_28672;\n                            }\n                        }\n                        if (sle32(wave_sizze_28660, skip_threads_28675)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n   ",
                   "                     if (sle32(skip_threads_28675, local_tid_28658 -\n                                  squot32(local_tid_28658, 32) * 32) &&\n                            (squot32(local_tid_28658, 32) == 0 &&\n                             ltid_in_bounds_28673)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_28662)[sext_i32_i64(local_tid_28658)] =\n                                    x_28670;\n                                x_28671 = x_28670;\n                            }\n                        }\n                        if (sle32(wave_sizze_28660, skip_threads_28675)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28675 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_28658, 32) == 0 ||\n                      !ltid_in_bounds_28673)) {\n                    // read operands\n                    {\n                        x_28668 = x_28667;\n                        x_28667 = ((__local\n                                    int64_t *) scan_arr_mem_28662)[sext_i32_i64(squot32(local_tid_28658,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28669 = add64(x_28667, x_28668);\n                        \n                        x_28667 = res_28669;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_28662)[sext_i32_i64(local_tid_28658)] =\n                            x_2",
                   "8667;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_28658, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_28662)[sext_i32_i64(local_tid_28658)] =\n                        x_28668;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_27150, res_24008)) {\n                    ((__global int64_t *) mem_27831)[gtid_27150] = ((__local\n                                                                     int64_t *) scan_arr_mem_28662)[sext_i32_i64(local_tid_28658)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_28676 = 0;\n                bool should_load_carry_28677 = local_tid_28658 == 0 &&\n                     !crosses_segment_28676;\n                \n                if (should_load_carry_28677) {\n                    x_24194 = ((__local\n                                int64_t *) scan_arr_mem_28662)[segscan_group_sizze_27146 -\n                                                               1];\n                }\n                if (!should_load_carry_28677) {\n                    x_24194 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27146\n}\n__kernel void testziscan_stage2_27050(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28243_backing_aligned_0,\n                                      int64_t binop_x_27755, __global\n                                      unsigned char *mem_27803,\n                          ",
                   "            int64_t stage1_num_groups_28215,\n                                      int32_t num_threads_28216)\n{\n    #define segscan_group_sizze_27045 (testzisegscan_group_sizze_27044)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28243_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28243_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28238;\n    int32_t local_tid_28239;\n    int64_t group_sizze_28242;\n    int32_t wave_sizze_28241;\n    int32_t group_tid_28240;\n    \n    global_tid_28238 = get_global_id(0);\n    local_tid_28239 = get_local_id(0);\n    group_sizze_28242 = get_local_size(0);\n    wave_sizze_28241 = LOCKSTEP_WIDTH;\n    group_tid_28240 = get_group_id(0);\n    \n    int32_t phys_tid_27050;\n    \n    phys_tid_27050 = global_tid_28238;\n    \n    __local char *scan_arr_mem_28243;\n    \n    scan_arr_mem_28243 = (__local char *) scan_arr_mem_28243_backing_0;\n    \n    int64_t flat_idx_28245;\n    \n    flat_idx_28245 = (sext_i32_i64(local_tid_28239) + 1) *\n        (segscan_group_sizze_27045 * sdiv_up64(binop_x_27755,\n                                               sext_i32_i64(num_threads_28216))) -\n        1;\n    \n    int64_t gtid_27049;\n    \n    gtid_27049 = flat_idx_28245;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27049, binop_x_27755)) {\n            ((__local\n              int64_t *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)] =\n                ((__global int64_t *) mem_27803)[gtid_27049];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_23992;\n    int64_t x_23993;\n    int64_t x_28246;\n    int64_t x_28247;\n    bool ltid_in_bounds_28249;\n    \n    ltid_in_bounds_28249 = slt64(",
                   "sext_i32_i64(local_tid_28239),\n                                 stage1_num_groups_28215);\n    \n    int32_t skip_threads_28250;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28249) {\n            x_23993 = ((volatile __local\n                        int64_t *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)];\n            if ((local_tid_28239 - squot32(local_tid_28239, 32) * 32) == 0) {\n                x_23992 = x_23993;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28250 = 1;\n        while (slt32(skip_threads_28250, 32)) {\n            if (sle32(skip_threads_28250, local_tid_28239 -\n                      squot32(local_tid_28239, 32) * 32) &&\n                ltid_in_bounds_28249) {\n                // read operands\n                {\n                    x_23992 = ((volatile __local\n                                int64_t *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239) -\n                                                               sext_i32_i64(skip_threads_28250)];\n                }\n                // perform operation\n                {\n                    int64_t res_23994 = add64(x_23992, x_23993);\n                    \n                    x_23992 = res_23994;\n                }\n            }\n            if (sle32(wave_sizze_28241, skip_threads_28250)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28250, local_tid_28239 -\n                      squot32(local_tid_28239, 32) * 32) &&\n                ltid_in_bounds_28249) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)] =\n                        x_23992;\n                    x_23993 = x_23992;\n                }\n            }\n            if (sle32(wave_sizze_28241, skip_threads_28250)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n           ",
                   " skip_threads_28250 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28239 - squot32(local_tid_28239, 32) * 32) == 31 &&\n            ltid_in_bounds_28249) {\n            ((volatile __local\n              int64_t *) scan_arr_mem_28243)[sext_i32_i64(squot32(local_tid_28239,\n                                                                  32))] =\n                x_23992;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28251;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28239, 32) == 0 && ltid_in_bounds_28249) {\n                x_28247 = ((volatile __local\n                            int64_t *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)];\n                if ((local_tid_28239 - squot32(local_tid_28239, 32) * 32) ==\n                    0) {\n                    x_28246 = x_28247;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28251 = 1;\n            while (slt32(skip_threads_28251, 32)) {\n                if (sle32(skip_threads_28251, local_tid_28239 -\n                          squot32(local_tid_28239, 32) * 32) &&\n                    (squot32(local_tid_28239, 32) == 0 &&\n                     ltid_in_bounds_28249)) {\n                    // read operands\n                    {\n                        x_28246 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239) -\n                                                                   sext_i32_i64(skip_threads_28251)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28248 = add64(x_28246, x_28247);\n                        \n                   ",
                   "     x_28246 = res_28248;\n                    }\n                }\n                if (sle32(wave_sizze_28241, skip_threads_28251)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28251, local_tid_28239 -\n                          squot32(local_tid_28239, 32) * 32) &&\n                    (squot32(local_tid_28239, 32) == 0 &&\n                     ltid_in_bounds_28249)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)] =\n                            x_28246;\n                        x_28247 = x_28246;\n                    }\n                }\n                if (sle32(wave_sizze_28241, skip_threads_28251)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28251 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28239, 32) == 0 || !ltid_in_bounds_28249)) {\n            // read operands\n            {\n                x_23993 = x_23992;\n                x_23992 = ((__local\n                            int64_t *) scan_arr_mem_28243)[sext_i32_i64(squot32(local_tid_28239,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_23994 = add64(x_23992, x_23993);\n                \n                x_23992 = res_23994;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)] =\n                    x_23992;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28",
                   "239, 32) == 0) {\n            ((__local\n              int64_t *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)] =\n                x_23993;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_27049, binop_x_27755)) {\n            ((__global int64_t *) mem_27803)[gtid_27049] = ((__local\n                                                             int64_t *) scan_arr_mem_28243)[sext_i32_i64(local_tid_28239)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27045\n}\n__kernel void testziscan_stage2_27083(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28494_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28492_backing_aligned_1,\n                                      int64_t res_24008, __global\n                                      unsigned char *mem_27814, __global\n                                      unsigned char *mem_27816,\n                                      int64_t stage1_num_groups_28454,\n                                      int32_t num_threads_28455)\n{\n    #define segscan_group_sizze_27078 (testzisegscan_group_sizze_27077)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28494_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28494_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28492_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28492_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28487;\n    int32_t local_tid_28488;\n    int64_t group_sizze_28491;\n    int32_t wave_sizze_28490;\n    int32_t group_tid_28489;\n  ",
                   "  \n    global_tid_28487 = get_global_id(0);\n    local_tid_28488 = get_local_id(0);\n    group_sizze_28491 = get_local_size(0);\n    wave_sizze_28490 = LOCKSTEP_WIDTH;\n    group_tid_28489 = get_group_id(0);\n    \n    int32_t phys_tid_27083;\n    \n    phys_tid_27083 = global_tid_28487;\n    \n    __local char *scan_arr_mem_28492;\n    __local char *scan_arr_mem_28494;\n    \n    scan_arr_mem_28492 = (__local char *) scan_arr_mem_28492_backing_0;\n    scan_arr_mem_28494 = (__local char *) scan_arr_mem_28494_backing_1;\n    \n    int64_t flat_idx_28496;\n    \n    flat_idx_28496 = (sext_i32_i64(local_tid_28488) + 1) *\n        (segscan_group_sizze_27078 * sdiv_up64(res_24008,\n                                               sext_i32_i64(num_threads_28455))) -\n        1;\n    \n    int64_t gtid_27082;\n    \n    gtid_27082 = flat_idx_28496;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27082, res_24008)) {\n            ((__local\n              bool *) scan_arr_mem_28492)[sext_i32_i64(local_tid_28488)] =\n                ((__global bool *) mem_27814)[gtid_27082];\n            ((__local\n              int64_t *) scan_arr_mem_28494)[sext_i32_i64(local_tid_28488)] =\n                ((__global int64_t *) mem_27816)[gtid_27082];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28492)[sext_i32_i64(local_tid_28488)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_28494)[sext_i32_i64(local_tid_28488)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_24027;\n    int64_t x_24028;\n    bool x_24029;\n    int64_t x_24030;\n    bool x_28497;\n    int64_t x_28498;\n    bool x_28499;\n    int64_t x_28500;\n    bool ltid_in_bounds_28504;\n    \n    ltid_in_bounds_28504 = slt64(sext_i32_i64(local_tid_28488),\n                                 stage1_num_groups_28454);\n    \n    int32_t skip_threads_28505;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28504) {\n            x_24029 = ((volati",
                   "le __local\n                        bool *) scan_arr_mem_28492)[sext_i32_i64(local_tid_28488)];\n            x_24030 = ((volatile __local\n                        int64_t *) scan_arr_mem_28494)[sext_i32_i64(local_tid_28488)];\n            if ((local_tid_28488 - squot32(local_tid_28488, 32) * 32) == 0) {\n                x_24027 = x_24029;\n                x_24028 = x_24030;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28505 = 1;\n        while (slt32(skip_threads_28505, 32)) {\n            if (sle32(skip_threads_28505, local_tid_28488 -\n                      squot32(local_tid_28488, 32) * 32) &&\n                ltid_in_bounds_28504) {\n                // read operands\n                {\n                    x_24027 = ((volatile __local\n                                bool *) scan_arr_mem_28492)[sext_i32_i64(local_tid_28488) -\n                                                            sext_i32_i64(skip_threads_28505)];\n                    x_24028 = ((volatile __local\n                                int64_t *) scan_arr_mem_28494)[sext_i32_i64(local_tid_28488) -\n                                                               sext_i32_i64(skip_threads_28505)];\n                }\n                // perform operation\n                {\n                    bool res_24031 = x_24027 || x_24029;\n                    int64_t res_24032;\n                    \n                    if (x_24029) {\n                        res_24032 = x_24030;\n                    } else {\n                        int64_t res_24033 = add64(x_24028, x_24030);\n                        \n                        res_24032 = res_24033;\n                    }\n                    x_24027 = res_24031;\n                    x_24028 = res_24032;\n                }\n            }\n            if (sle32(wave_sizze_28490, skip_threads_28505)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28505, local_tid_28488 -\n             ",
                   "         squot32(local_tid_28488, 32) * 32) &&\n                ltid_in_bounds_28504) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28492)[sext_i32_i64(local_tid_28488)] =\n                        x_24027;\n                    x_24029 = x_24027;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28494)[sext_i32_i64(local_tid_28488)] =\n                        x_24028;\n                    x_24030 = x_24028;\n                }\n            }\n            if (sle32(wave_sizze_28490, skip_threads_28505)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28505 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28488 - squot32(local_tid_28488, 32) * 32) == 31 &&\n            ltid_in_bounds_28504) {\n            ((volatile __local\n              bool *) scan_arr_mem_28492)[sext_i32_i64(squot32(local_tid_28488,\n                                                               32))] = x_24027;\n            ((volatile __local\n              int64_t *) scan_arr_mem_28494)[sext_i32_i64(squot32(local_tid_28488,\n                                                                  32))] =\n                x_24028;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28506;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28488, 32) == 0 && ltid_in_bounds_28504) {\n                x_28499 = ((volatile __local\n                            bool *) scan_arr_mem_28492)[sext_i32_i64(local_tid_28488)];\n                x_28500 = ((volatile __local\n                            int64_t *) scan_arr_mem_28494)[sext_i32_i64(local_tid_28488)];\n                if ((local_tid_28488 - squot32(local_tid_28488",
                   ", 32) * 32) ==\n                    0) {\n                    x_28497 = x_28499;\n                    x_28498 = x_28500;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28506 = 1;\n            while (slt32(skip_threads_28506, 32)) {\n                if (sle32(skip_threads_28506, local_tid_28488 -\n                          squot32(local_tid_28488, 32) * 32) &&\n                    (squot32(local_tid_28488, 32) == 0 &&\n                     ltid_in_bounds_28504)) {\n                    // read operands\n                    {\n                        x_28497 = ((volatile __local\n                                    bool *) scan_arr_mem_28492)[sext_i32_i64(local_tid_28488) -\n                                                                sext_i32_i64(skip_threads_28506)];\n                        x_28498 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28494)[sext_i32_i64(local_tid_28488) -\n                                                                   sext_i32_i64(skip_threads_28506)];\n                    }\n                    // perform operation\n                    {\n                        bool res_28501 = x_28497 || x_28499;\n                        int64_t res_28502;\n                        \n                        if (x_28499) {\n                            res_28502 = x_28500;\n                        } else {\n                            int64_t res_28503 = add64(x_28498, x_28500);\n                            \n                            res_28502 = res_28503;\n                        }\n                        x_28497 = res_28501;\n                        x_28498 = res_28502;\n                    }\n                }\n                if (sle32(wave_sizze_28490, skip_threads_28506)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28506, local_tid_28488 -\n                          squot32(local_tid_28488,",
                   " 32) * 32) &&\n                    (squot32(local_tid_28488, 32) == 0 &&\n                     ltid_in_bounds_28504)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28492)[sext_i32_i64(local_tid_28488)] =\n                            x_28497;\n                        x_28499 = x_28497;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28494)[sext_i32_i64(local_tid_28488)] =\n                            x_28498;\n                        x_28500 = x_28498;\n                    }\n                }\n                if (sle32(wave_sizze_28490, skip_threads_28506)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28506 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28488, 32) == 0 || !ltid_in_bounds_28504)) {\n            // read operands\n            {\n                x_24029 = x_24027;\n                x_24030 = x_24028;\n                x_24027 = ((__local\n                            bool *) scan_arr_mem_28492)[sext_i32_i64(squot32(local_tid_28488,\n                                                                             32)) -\n                                                        1];\n                x_24028 = ((__local\n                            int64_t *) scan_arr_mem_28494)[sext_i32_i64(squot32(local_tid_28488,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_24031 = x_24027 || x_24029;\n                int64_t res_24032;\n                \n                if (x_24029) {\n                    res_24032 = x_24030;\n                } else {\n                    int64_t res_24033 = add64(x_24028, x",
                   "_24030);\n                    \n                    res_24032 = res_24033;\n                }\n                x_24027 = res_24031;\n                x_24028 = res_24032;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28492)[sext_i32_i64(local_tid_28488)] =\n                    x_24027;\n                ((__local\n                  int64_t *) scan_arr_mem_28494)[sext_i32_i64(local_tid_28488)] =\n                    x_24028;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28488, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28492)[sext_i32_i64(local_tid_28488)] =\n                x_24029;\n            ((__local\n              int64_t *) scan_arr_mem_28494)[sext_i32_i64(local_tid_28488)] =\n                x_24030;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_27082, res_24008)) {\n            ((__global bool *) mem_27814)[gtid_27082] = ((__local\n                                                          bool *) scan_arr_mem_28492)[sext_i32_i64(local_tid_28488)];\n            ((__global int64_t *) mem_27816)[gtid_27082] = ((__local\n                                                             int64_t *) scan_arr_mem_28494)[sext_i32_i64(local_tid_28488)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27078\n}\n__kernel void testziscan_stage2_27091(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28561_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28559_backing_aligned_1,\n                                      int64_t res_24008, __global\n                                      unsigned char *mem_27819, __glo",
                   "bal\n                                      unsigned char *mem_27821,\n                                      int64_t stage1_num_groups_28521,\n                                      int32_t num_threads_28522)\n{\n    #define segscan_group_sizze_27086 (testzisegscan_group_sizze_27085)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28561_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28561_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28559_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28559_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28554;\n    int32_t local_tid_28555;\n    int64_t group_sizze_28558;\n    int32_t wave_sizze_28557;\n    int32_t group_tid_28556;\n    \n    global_tid_28554 = get_global_id(0);\n    local_tid_28555 = get_local_id(0);\n    group_sizze_28558 = get_local_size(0);\n    wave_sizze_28557 = LOCKSTEP_WIDTH;\n    group_tid_28556 = get_group_id(0);\n    \n    int32_t phys_tid_27091;\n    \n    phys_tid_27091 = global_tid_28554;\n    \n    __local char *scan_arr_mem_28559;\n    __local char *scan_arr_mem_28561;\n    \n    scan_arr_mem_28559 = (__local char *) scan_arr_mem_28559_backing_0;\n    scan_arr_mem_28561 = (__local char *) scan_arr_mem_28561_backing_1;\n    \n    int64_t flat_idx_28563;\n    \n    flat_idx_28563 = (sext_i32_i64(local_tid_28555) + 1) *\n        (segscan_group_sizze_27086 * sdiv_up64(res_24008,\n                                               sext_i32_i64(num_threads_28522))) -\n        1;\n    \n    int64_t gtid_27090;\n    \n    gtid_27090 = flat_idx_28563;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27090, res_24008)) {\n            ((__local\n              bool *) scan_arr_mem_28559)[sext_i32_i64(local_tid_28555)] =\n             ",
                   "   ((__global bool *) mem_27819)[gtid_27090];\n            ((__local\n              int64_t *) scan_arr_mem_28561)[sext_i32_i64(local_tid_28555)] =\n                ((__global int64_t *) mem_27821)[gtid_27090];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28559)[sext_i32_i64(local_tid_28555)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_28561)[sext_i32_i64(local_tid_28555)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_24067;\n    int64_t x_24068;\n    bool x_24069;\n    int64_t x_24070;\n    bool x_28564;\n    int64_t x_28565;\n    bool x_28566;\n    int64_t x_28567;\n    bool ltid_in_bounds_28571;\n    \n    ltid_in_bounds_28571 = slt64(sext_i32_i64(local_tid_28555),\n                                 stage1_num_groups_28521);\n    \n    int32_t skip_threads_28572;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28571) {\n            x_24069 = ((volatile __local\n                        bool *) scan_arr_mem_28559)[sext_i32_i64(local_tid_28555)];\n            x_24070 = ((volatile __local\n                        int64_t *) scan_arr_mem_28561)[sext_i32_i64(local_tid_28555)];\n            if ((local_tid_28555 - squot32(local_tid_28555, 32) * 32) == 0) {\n                x_24067 = x_24069;\n                x_24068 = x_24070;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28572 = 1;\n        while (slt32(skip_threads_28572, 32)) {\n            if (sle32(skip_threads_28572, local_tid_28555 -\n                      squot32(local_tid_28555, 32) * 32) &&\n                ltid_in_bounds_28571) {\n                // read operands\n                {\n                    x_24067 = ((volatile __local\n                                bool *) scan_arr_mem_28559)[sext_i32_i64(local_tid_28555) -\n                                                            sext_i32_i64(skip_threads_28572)];\n                    x_24068 = ((volatile __local\n                 ",
                   "               int64_t *) scan_arr_mem_28561)[sext_i32_i64(local_tid_28555) -\n                                                               sext_i32_i64(skip_threads_28572)];\n                }\n                // perform operation\n                {\n                    bool res_24071 = x_24067 || x_24069;\n                    int64_t res_24072;\n                    \n                    if (x_24069) {\n                        res_24072 = x_24070;\n                    } else {\n                        int64_t res_24073 = add64(x_24068, x_24070);\n                        \n                        res_24072 = res_24073;\n                    }\n                    x_24067 = res_24071;\n                    x_24068 = res_24072;\n                }\n            }\n            if (sle32(wave_sizze_28557, skip_threads_28572)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28572, local_tid_28555 -\n                      squot32(local_tid_28555, 32) * 32) &&\n                ltid_in_bounds_28571) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28559)[sext_i32_i64(local_tid_28555)] =\n                        x_24067;\n                    x_24069 = x_24067;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28561)[sext_i32_i64(local_tid_28555)] =\n                        x_24068;\n                    x_24070 = x_24068;\n                }\n            }\n            if (sle32(wave_sizze_28557, skip_threads_28572)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28572 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28555 - squot32(local_tid_28555, 32) * 32) == 31 &&\n            ltid_in_bounds_28571) {\n            ((volatile __local\n              bool *) scan_arr_mem_28559)[sext_i32_i64(squot32(local_t",
                   "id_28555,\n                                                               32))] = x_24067;\n            ((volatile __local\n              int64_t *) scan_arr_mem_28561)[sext_i32_i64(squot32(local_tid_28555,\n                                                                  32))] =\n                x_24068;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28573;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28555, 32) == 0 && ltid_in_bounds_28571) {\n                x_28566 = ((volatile __local\n                            bool *) scan_arr_mem_28559)[sext_i32_i64(local_tid_28555)];\n                x_28567 = ((volatile __local\n                            int64_t *) scan_arr_mem_28561)[sext_i32_i64(local_tid_28555)];\n                if ((local_tid_28555 - squot32(local_tid_28555, 32) * 32) ==\n                    0) {\n                    x_28564 = x_28566;\n                    x_28565 = x_28567;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28573 = 1;\n            while (slt32(skip_threads_28573, 32)) {\n                if (sle32(skip_threads_28573, local_tid_28555 -\n                          squot32(local_tid_28555, 32) * 32) &&\n                    (squot32(local_tid_28555, 32) == 0 &&\n                     ltid_in_bounds_28571)) {\n                    // read operands\n                    {\n                        x_28564 = ((volatile __local\n                                    bool *) scan_arr_mem_28559)[sext_i32_i64(local_tid_28555) -\n                                                                sext_i32_i64(skip_threads_28573)];\n                        x_28565 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28561)[sext_i32_i64(local_tid_28555) -\n                                               ",
                   "                    sext_i32_i64(skip_threads_28573)];\n                    }\n                    // perform operation\n                    {\n                        bool res_28568 = x_28564 || x_28566;\n                        int64_t res_28569;\n                        \n                        if (x_28566) {\n                            res_28569 = x_28567;\n                        } else {\n                            int64_t res_28570 = add64(x_28565, x_28567);\n                            \n                            res_28569 = res_28570;\n                        }\n                        x_28564 = res_28568;\n                        x_28565 = res_28569;\n                    }\n                }\n                if (sle32(wave_sizze_28557, skip_threads_28573)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28573, local_tid_28555 -\n                          squot32(local_tid_28555, 32) * 32) &&\n                    (squot32(local_tid_28555, 32) == 0 &&\n                     ltid_in_bounds_28571)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28559)[sext_i32_i64(local_tid_28555)] =\n                            x_28564;\n                        x_28566 = x_28564;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28561)[sext_i32_i64(local_tid_28555)] =\n                            x_28565;\n                        x_28567 = x_28565;\n                    }\n                }\n                if (sle32(wave_sizze_28557, skip_threads_28573)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28573 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28555, 32) == 0 || !ltid_in_bounds_28571)) {\n            // read operands\n            ",
                   "{\n                x_24069 = x_24067;\n                x_24070 = x_24068;\n                x_24067 = ((__local\n                            bool *) scan_arr_mem_28559)[sext_i32_i64(squot32(local_tid_28555,\n                                                                             32)) -\n                                                        1];\n                x_24068 = ((__local\n                            int64_t *) scan_arr_mem_28561)[sext_i32_i64(squot32(local_tid_28555,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_24071 = x_24067 || x_24069;\n                int64_t res_24072;\n                \n                if (x_24069) {\n                    res_24072 = x_24070;\n                } else {\n                    int64_t res_24073 = add64(x_24068, x_24070);\n                    \n                    res_24072 = res_24073;\n                }\n                x_24067 = res_24071;\n                x_24068 = res_24072;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28559)[sext_i32_i64(local_tid_28555)] =\n                    x_24067;\n                ((__local\n                  int64_t *) scan_arr_mem_28561)[sext_i32_i64(local_tid_28555)] =\n                    x_24068;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28555, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28559)[sext_i32_i64(local_tid_28555)] =\n                x_24069;\n            ((__local\n              int64_t *) scan_arr_mem_28561)[sext_i32_i64(local_tid_28555)] =\n                x_24070;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_27090, res_24008",
                   ")) {\n            ((__global bool *) mem_27819)[gtid_27090] = ((__local\n                                                          bool *) scan_arr_mem_28559)[sext_i32_i64(local_tid_28555)];\n            ((__global int64_t *) mem_27821)[gtid_27090] = ((__local\n                                                             int64_t *) scan_arr_mem_28561)[sext_i32_i64(local_tid_28555)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27086\n}\n__kernel void testziscan_stage2_27099(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28628_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28626_backing_aligned_1,\n                                      int64_t res_24008, __global\n                                      unsigned char *mem_27826, __global\n                                      unsigned char *mem_27828,\n                                      int64_t stage1_num_groups_28588,\n                                      int32_t num_threads_28589)\n{\n    #define segscan_group_sizze_27094 (testzisegscan_group_sizze_27093)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_28628_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_28628_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_28626_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28626_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28621;\n    int32_t local_tid_28622;\n    int64_t group_sizze_28625;\n    int32_t wave_sizze_28624;\n    int32_t group_tid_28623;\n    \n    global_tid_28621 = get_global_id(0);\n    local_tid_28622 = get_local_id(0);\n    group_sizze_28625",
                   " = get_local_size(0);\n    wave_sizze_28624 = LOCKSTEP_WIDTH;\n    group_tid_28623 = get_group_id(0);\n    \n    int32_t phys_tid_27099;\n    \n    phys_tid_27099 = global_tid_28621;\n    \n    __local char *scan_arr_mem_28626;\n    __local char *scan_arr_mem_28628;\n    \n    scan_arr_mem_28626 = (__local char *) scan_arr_mem_28626_backing_0;\n    scan_arr_mem_28628 = (__local char *) scan_arr_mem_28628_backing_1;\n    \n    int64_t flat_idx_28630;\n    \n    flat_idx_28630 = (sext_i32_i64(local_tid_28622) + 1) *\n        (segscan_group_sizze_27094 * sdiv_up64(res_24008,\n                                               sext_i32_i64(num_threads_28589))) -\n        1;\n    \n    int64_t gtid_27098;\n    \n    gtid_27098 = flat_idx_28630;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27098, res_24008)) {\n            ((__local\n              bool *) scan_arr_mem_28626)[sext_i32_i64(local_tid_28622)] =\n                ((__global bool *) mem_27826)[gtid_27098];\n            ((__local\n              float *) scan_arr_mem_28628)[sext_i32_i64(local_tid_28622)] =\n                ((__global float *) mem_27828)[gtid_27098];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_28626)[sext_i32_i64(local_tid_28622)] = 0;\n            ((__local\n              float *) scan_arr_mem_28628)[sext_i32_i64(local_tid_28622)] =\n                0.0F;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_24093;\n    float x_24094;\n    bool x_24095;\n    float x_24096;\n    bool x_28631;\n    float x_28632;\n    bool x_28633;\n    float x_28634;\n    bool ltid_in_bounds_28638;\n    \n    ltid_in_bounds_28638 = slt64(sext_i32_i64(local_tid_28622),\n                                 stage1_num_groups_28588);\n    \n    int32_t skip_threads_28639;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28638) {\n            x_24095 = ((volatile __local\n                        bool *) scan_arr_mem_28626)[sext_i32_i64(local_tid_28622)];\n    ",
                   "        x_24096 = ((volatile __local\n                        float *) scan_arr_mem_28628)[sext_i32_i64(local_tid_28622)];\n            if ((local_tid_28622 - squot32(local_tid_28622, 32) * 32) == 0) {\n                x_24093 = x_24095;\n                x_24094 = x_24096;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28639 = 1;\n        while (slt32(skip_threads_28639, 32)) {\n            if (sle32(skip_threads_28639, local_tid_28622 -\n                      squot32(local_tid_28622, 32) * 32) &&\n                ltid_in_bounds_28638) {\n                // read operands\n                {\n                    x_24093 = ((volatile __local\n                                bool *) scan_arr_mem_28626)[sext_i32_i64(local_tid_28622) -\n                                                            sext_i32_i64(skip_threads_28639)];\n                    x_24094 = ((volatile __local\n                                float *) scan_arr_mem_28628)[sext_i32_i64(local_tid_28622) -\n                                                             sext_i32_i64(skip_threads_28639)];\n                }\n                // perform operation\n                {\n                    bool res_24097 = x_24093 || x_24095;\n                    float res_24098;\n                    \n                    if (x_24095) {\n                        res_24098 = x_24096;\n                    } else {\n                        float res_24099 = x_24094 + x_24096;\n                        \n                        res_24098 = res_24099;\n                    }\n                    x_24093 = res_24097;\n                    x_24094 = res_24098;\n                }\n            }\n            if (sle32(wave_sizze_28624, skip_threads_28639)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28639, local_tid_28622 -\n                      squot32(local_tid_28622, 32) * 32) &&\n                ltid_in_bounds_28638) {\n                // write res",
                   "ult\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_28626)[sext_i32_i64(local_tid_28622)] =\n                        x_24093;\n                    x_24095 = x_24093;\n                    ((volatile __local\n                      float *) scan_arr_mem_28628)[sext_i32_i64(local_tid_28622)] =\n                        x_24094;\n                    x_24096 = x_24094;\n                }\n            }\n            if (sle32(wave_sizze_28624, skip_threads_28639)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28639 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28622 - squot32(local_tid_28622, 32) * 32) == 31 &&\n            ltid_in_bounds_28638) {\n            ((volatile __local\n              bool *) scan_arr_mem_28626)[sext_i32_i64(squot32(local_tid_28622,\n                                                               32))] = x_24093;\n            ((volatile __local\n              float *) scan_arr_mem_28628)[sext_i32_i64(squot32(local_tid_28622,\n                                                                32))] = x_24094;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28640;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28622, 32) == 0 && ltid_in_bounds_28638) {\n                x_28633 = ((volatile __local\n                            bool *) scan_arr_mem_28626)[sext_i32_i64(local_tid_28622)];\n                x_28634 = ((volatile __local\n                            float *) scan_arr_mem_28628)[sext_i32_i64(local_tid_28622)];\n                if ((local_tid_28622 - squot32(local_tid_28622, 32) * 32) ==\n                    0) {\n                    x_28631 = x_28633;\n                    x_28632 = x_28634;\n                }\n   ",
                   "         }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28640 = 1;\n            while (slt32(skip_threads_28640, 32)) {\n                if (sle32(skip_threads_28640, local_tid_28622 -\n                          squot32(local_tid_28622, 32) * 32) &&\n                    (squot32(local_tid_28622, 32) == 0 &&\n                     ltid_in_bounds_28638)) {\n                    // read operands\n                    {\n                        x_28631 = ((volatile __local\n                                    bool *) scan_arr_mem_28626)[sext_i32_i64(local_tid_28622) -\n                                                                sext_i32_i64(skip_threads_28640)];\n                        x_28632 = ((volatile __local\n                                    float *) scan_arr_mem_28628)[sext_i32_i64(local_tid_28622) -\n                                                                 sext_i32_i64(skip_threads_28640)];\n                    }\n                    // perform operation\n                    {\n                        bool res_28635 = x_28631 || x_28633;\n                        float res_28636;\n                        \n                        if (x_28633) {\n                            res_28636 = x_28634;\n                        } else {\n                            float res_28637 = x_28632 + x_28634;\n                            \n                            res_28636 = res_28637;\n                        }\n                        x_28631 = res_28635;\n                        x_28632 = res_28636;\n                    }\n                }\n                if (sle32(wave_sizze_28624, skip_threads_28640)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28640, local_tid_28622 -\n                          squot32(local_tid_28622, 32) * 32) &&\n                    (squot32(local_tid_28622, 32) == 0 &&\n                     ltid_in_bounds_28638)) {\n                    // write result",
                   "\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_28626)[sext_i32_i64(local_tid_28622)] =\n                            x_28631;\n                        x_28633 = x_28631;\n                        ((volatile __local\n                          float *) scan_arr_mem_28628)[sext_i32_i64(local_tid_28622)] =\n                            x_28632;\n                        x_28634 = x_28632;\n                    }\n                }\n                if (sle32(wave_sizze_28624, skip_threads_28640)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28640 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28622, 32) == 0 || !ltid_in_bounds_28638)) {\n            // read operands\n            {\n                x_24095 = x_24093;\n                x_24096 = x_24094;\n                x_24093 = ((__local\n                            bool *) scan_arr_mem_28626)[sext_i32_i64(squot32(local_tid_28622,\n                                                                             32)) -\n                                                        1];\n                x_24094 = ((__local\n                            float *) scan_arr_mem_28628)[sext_i32_i64(squot32(local_tid_28622,\n                                                                              32)) -\n                                                         1];\n            }\n            // perform operation\n            {\n                bool res_24097 = x_24093 || x_24095;\n                float res_24098;\n                \n                if (x_24095) {\n                    res_24098 = x_24096;\n                } else {\n                    float res_24099 = x_24094 + x_24096;\n                    \n                    res_24098 = res_24099;\n                }\n                x_24093 = res_24097;\n                x_24094 = res_24098;\n      ",
                   "      }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_28626)[sext_i32_i64(local_tid_28622)] =\n                    x_24093;\n                ((__local\n                  float *) scan_arr_mem_28628)[sext_i32_i64(local_tid_28622)] =\n                    x_24094;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28622, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_28626)[sext_i32_i64(local_tid_28622)] =\n                x_24095;\n            ((__local\n              float *) scan_arr_mem_28628)[sext_i32_i64(local_tid_28622)] =\n                x_24096;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_27098, res_24008)) {\n            ((__global bool *) mem_27826)[gtid_27098] = ((__local\n                                                          bool *) scan_arr_mem_28626)[sext_i32_i64(local_tid_28622)];\n            ((__global float *) mem_27828)[gtid_27098] = ((__local\n                                                           float *) scan_arr_mem_28628)[sext_i32_i64(local_tid_28622)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27094\n}\n__kernel void testziscan_stage2_27151(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_28683_backing_aligned_0,\n                                      int64_t res_24008, __global\n                                      unsigned char *mem_27831,\n                                      int64_t stage1_num_groups_28655,\n                                      int32_t num_threads_28656)\n{\n    #define segscan_group_sizze_27146 (testzisegscan_group_sizze_27145)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile ",
                   "char *restrict scan_arr_mem_28683_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_28683_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28678;\n    int32_t local_tid_28679;\n    int64_t group_sizze_28682;\n    int32_t wave_sizze_28681;\n    int32_t group_tid_28680;\n    \n    global_tid_28678 = get_global_id(0);\n    local_tid_28679 = get_local_id(0);\n    group_sizze_28682 = get_local_size(0);\n    wave_sizze_28681 = LOCKSTEP_WIDTH;\n    group_tid_28680 = get_group_id(0);\n    \n    int32_t phys_tid_27151;\n    \n    phys_tid_27151 = global_tid_28678;\n    \n    __local char *scan_arr_mem_28683;\n    \n    scan_arr_mem_28683 = (__local char *) scan_arr_mem_28683_backing_0;\n    \n    int64_t flat_idx_28685;\n    \n    flat_idx_28685 = (sext_i32_i64(local_tid_28679) + 1) *\n        (segscan_group_sizze_27146 * sdiv_up64(res_24008,\n                                               sext_i32_i64(num_threads_28656))) -\n        1;\n    \n    int64_t gtid_27150;\n    \n    gtid_27150 = flat_idx_28685;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27150, res_24008)) {\n            ((__local\n              int64_t *) scan_arr_mem_28683)[sext_i32_i64(local_tid_28679)] =\n                ((__global int64_t *) mem_27831)[gtid_27150];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_28683)[sext_i32_i64(local_tid_28679)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_24194;\n    int64_t x_24195;\n    int64_t x_28686;\n    int64_t x_28687;\n    bool ltid_in_bounds_28689;\n    \n    ltid_in_bounds_28689 = slt64(sext_i32_i64(local_tid_28679),\n                                 stage1_num_groups_28655);\n    \n    int32_t skip_threads_28690;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_28689) {\n            x_24195 = ((volatile __local\n                        int64_t *) scan_arr_mem_28683)[se",
                   "xt_i32_i64(local_tid_28679)];\n            if ((local_tid_28679 - squot32(local_tid_28679, 32) * 32) == 0) {\n                x_24194 = x_24195;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_28690 = 1;\n        while (slt32(skip_threads_28690, 32)) {\n            if (sle32(skip_threads_28690, local_tid_28679 -\n                      squot32(local_tid_28679, 32) * 32) &&\n                ltid_in_bounds_28689) {\n                // read operands\n                {\n                    x_24194 = ((volatile __local\n                                int64_t *) scan_arr_mem_28683)[sext_i32_i64(local_tid_28679) -\n                                                               sext_i32_i64(skip_threads_28690)];\n                }\n                // perform operation\n                {\n                    int64_t res_24196 = add64(x_24194, x_24195);\n                    \n                    x_24194 = res_24196;\n                }\n            }\n            if (sle32(wave_sizze_28681, skip_threads_28690)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_28690, local_tid_28679 -\n                      squot32(local_tid_28679, 32) * 32) &&\n                ltid_in_bounds_28689) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_28683)[sext_i32_i64(local_tid_28679)] =\n                        x_24194;\n                    x_24195 = x_24194;\n                }\n            }\n            if (sle32(wave_sizze_28681, skip_threads_28690)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_28690 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_28679 - squot32(local_tid_28679, 32) * 32) == 31 &&\n            ltid_in_bounds_28689) {\n            ((volatile __local\n              int64_",
                   "t *) scan_arr_mem_28683)[sext_i32_i64(squot32(local_tid_28679,\n                                                                  32))] =\n                x_24194;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_28691;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_28679, 32) == 0 && ltid_in_bounds_28689) {\n                x_28687 = ((volatile __local\n                            int64_t *) scan_arr_mem_28683)[sext_i32_i64(local_tid_28679)];\n                if ((local_tid_28679 - squot32(local_tid_28679, 32) * 32) ==\n                    0) {\n                    x_28686 = x_28687;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_28691 = 1;\n            while (slt32(skip_threads_28691, 32)) {\n                if (sle32(skip_threads_28691, local_tid_28679 -\n                          squot32(local_tid_28679, 32) * 32) &&\n                    (squot32(local_tid_28679, 32) == 0 &&\n                     ltid_in_bounds_28689)) {\n                    // read operands\n                    {\n                        x_28686 = ((volatile __local\n                                    int64_t *) scan_arr_mem_28683)[sext_i32_i64(local_tid_28679) -\n                                                                   sext_i32_i64(skip_threads_28691)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_28688 = add64(x_28686, x_28687);\n                        \n                        x_28686 = res_28688;\n                    }\n                }\n                if (sle32(wave_sizze_28681, skip_threads_28691)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_28691, local_tid_28679 -\n                          squot32(local_tid",
                   "_28679, 32) * 32) &&\n                    (squot32(local_tid_28679, 32) == 0 &&\n                     ltid_in_bounds_28689)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_28683)[sext_i32_i64(local_tid_28679)] =\n                            x_28686;\n                        x_28687 = x_28686;\n                    }\n                }\n                if (sle32(wave_sizze_28681, skip_threads_28691)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_28691 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_28679, 32) == 0 || !ltid_in_bounds_28689)) {\n            // read operands\n            {\n                x_24195 = x_24194;\n                x_24194 = ((__local\n                            int64_t *) scan_arr_mem_28683)[sext_i32_i64(squot32(local_tid_28679,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_24196 = add64(x_24194, x_24195);\n                \n                x_24194 = res_24196;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_28683)[sext_i32_i64(local_tid_28679)] =\n                    x_24194;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_28679, 32) == 0) {\n            ((__local\n              int64_t *) scan_arr_mem_28683)[sext_i32_i64(local_tid_28679)] =\n                x_24195;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_27150, res_24008)) {\n            ((__glo",
                   "bal int64_t *) mem_27831)[gtid_27150] = ((__local\n                                                             int64_t *) scan_arr_mem_28683)[sext_i32_i64(local_tid_28679)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27146\n}\n__kernel void testziscan_stage3_27050(__global int *global_failure,\n                                      int64_t num_groups_27047,\n                                      int64_t binop_x_27755, __global\n                                      unsigned char *mem_27803,\n                                      int32_t num_threads_28216,\n                                      int32_t required_groups_28252)\n{\n    #define segscan_group_sizze_27045 (testzisegscan_group_sizze_27044)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28253;\n    int32_t local_tid_28254;\n    int64_t group_sizze_28257;\n    int32_t wave_sizze_28256;\n    int32_t group_tid_28255;\n    \n    global_tid_28253 = get_global_id(0);\n    local_tid_28254 = get_local_id(0);\n    group_sizze_28257 = get_local_size(0);\n    wave_sizze_28256 = LOCKSTEP_WIDTH;\n    group_tid_28255 = get_group_id(0);\n    \n    int32_t phys_tid_27050;\n    \n    phys_tid_27050 = global_tid_28253;\n    \n    int32_t phys_group_id_28258;\n    \n    phys_group_id_28258 = get_group_id(0);\n    for (int32_t i_28259 = 0; i_28259 < sdiv_up32(required_groups_28252 -\n                                                  phys_group_id_28258,\n                                                  sext_i64_i32(num_groups_27047));\n         i_28259++) {\n        int32_t virt_group_id_28260 = phys_group_id_28258 + i_28259 *\n                sext_i64_i32(num_groups_27047);\n        int64_t flat_idx_28261 = sext_i32_i64(virt_group_id_28260) *\n                segscan_group_sizze_27045 + sext_i32_i64(local_tid_28254);\n        int64_t gtid_27049 = flat_idx_28261;\n        int64_t orig_group_28262 = squot64(",
                   "flat_idx_28261,\n                                           segscan_group_sizze_27045 *\n                                           sdiv_up64(binop_x_27755,\n                                                     sext_i32_i64(num_threads_28216)));\n        int64_t carry_in_flat_idx_28263 = orig_group_28262 *\n                (segscan_group_sizze_27045 * sdiv_up64(binop_x_27755,\n                                                       sext_i32_i64(num_threads_28216))) -\n                1;\n        \n        if (slt64(gtid_27049, binop_x_27755)) {\n            if (!(orig_group_28262 == 0 || flat_idx_28261 == (orig_group_28262 +\n                                                              1) *\n                  (segscan_group_sizze_27045 * sdiv_up64(binop_x_27755,\n                                                         sext_i32_i64(num_threads_28216))) -\n                  1)) {\n                int64_t x_23992;\n                int64_t x_23993;\n                \n                x_23992 = ((__global\n                            int64_t *) mem_27803)[carry_in_flat_idx_28263];\n                x_23993 = ((__global int64_t *) mem_27803)[gtid_27049];\n                \n                int64_t res_23994;\n                \n                res_23994 = add64(x_23992, x_23993);\n                x_23992 = res_23994;\n                ((__global int64_t *) mem_27803)[gtid_27049] = x_23992;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27045\n}\n__kernel void testziscan_stage3_27083(__global int *global_failure,\n                                      int64_t res_24008,\n                                      int64_t num_groups_27080, __global\n                                      unsigned char *mem_27814, __global\n                                      unsigned char *mem_27816,\n                                      int32_t num_threads_28455,\n                                      int32_t required_groups_285",
                   "07)\n{\n    #define segscan_group_sizze_27078 (testzisegscan_group_sizze_27077)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28508;\n    int32_t local_tid_28509;\n    int64_t group_sizze_28512;\n    int32_t wave_sizze_28511;\n    int32_t group_tid_28510;\n    \n    global_tid_28508 = get_global_id(0);\n    local_tid_28509 = get_local_id(0);\n    group_sizze_28512 = get_local_size(0);\n    wave_sizze_28511 = LOCKSTEP_WIDTH;\n    group_tid_28510 = get_group_id(0);\n    \n    int32_t phys_tid_27083;\n    \n    phys_tid_27083 = global_tid_28508;\n    \n    int32_t phys_group_id_28513;\n    \n    phys_group_id_28513 = get_group_id(0);\n    for (int32_t i_28514 = 0; i_28514 < sdiv_up32(required_groups_28507 -\n                                                  phys_group_id_28513,\n                                                  sext_i64_i32(num_groups_27080));\n         i_28514++) {\n        int32_t virt_group_id_28515 = phys_group_id_28513 + i_28514 *\n                sext_i64_i32(num_groups_27080);\n        int64_t flat_idx_28516 = sext_i32_i64(virt_group_id_28515) *\n                segscan_group_sizze_27078 + sext_i32_i64(local_tid_28509);\n        int64_t gtid_27082 = flat_idx_28516;\n        int64_t orig_group_28517 = squot64(flat_idx_28516,\n                                           segscan_group_sizze_27078 *\n                                           sdiv_up64(res_24008,\n                                                     sext_i32_i64(num_threads_28455)));\n        int64_t carry_in_flat_idx_28518 = orig_group_28517 *\n                (segscan_group_sizze_27078 * sdiv_up64(res_24008,\n                                                       sext_i32_i64(num_threads_28455))) -\n                1;\n        \n        if (slt64(gtid_27082, res_24008)) {\n            if (!(orig_group_28517 == 0 || flat_idx_28516 == (orig_group_28517 +\n                                           ",
                   "                   1) *\n                  (segscan_group_sizze_27078 * sdiv_up64(res_24008,\n                                                         sext_i32_i64(num_threads_28455))) -\n                  1)) {\n                bool x_24027;\n                int64_t x_24028;\n                bool x_24029;\n                int64_t x_24030;\n                \n                x_24027 = ((__global\n                            bool *) mem_27814)[carry_in_flat_idx_28518];\n                x_24028 = ((__global\n                            int64_t *) mem_27816)[carry_in_flat_idx_28518];\n                x_24029 = ((__global bool *) mem_27814)[gtid_27082];\n                x_24030 = ((__global int64_t *) mem_27816)[gtid_27082];\n                \n                bool res_24031;\n                \n                res_24031 = x_24027 || x_24029;\n                \n                int64_t res_24032;\n                \n                if (x_24029) {\n                    res_24032 = x_24030;\n                } else {\n                    int64_t res_24033 = add64(x_24028, x_24030);\n                    \n                    res_24032 = res_24033;\n                }\n                x_24027 = res_24031;\n                x_24028 = res_24032;\n                ((__global bool *) mem_27814)[gtid_27082] = x_24027;\n                ((__global int64_t *) mem_27816)[gtid_27082] = x_24028;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27078\n}\n__kernel void testziscan_stage3_27091(__global int *global_failure,\n                                      int64_t res_24008,\n                                      int64_t num_groups_27088, __global\n                                      unsigned char *mem_27819, __global\n                                      unsigned char *mem_27821,\n                                      int32_t num_threads_28522,\n                                      int32_t required_groups_28574)\n{\n    #define s",
                   "egscan_group_sizze_27086 (testzisegscan_group_sizze_27085)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28575;\n    int32_t local_tid_28576;\n    int64_t group_sizze_28579;\n    int32_t wave_sizze_28578;\n    int32_t group_tid_28577;\n    \n    global_tid_28575 = get_global_id(0);\n    local_tid_28576 = get_local_id(0);\n    group_sizze_28579 = get_local_size(0);\n    wave_sizze_28578 = LOCKSTEP_WIDTH;\n    group_tid_28577 = get_group_id(0);\n    \n    int32_t phys_tid_27091;\n    \n    phys_tid_27091 = global_tid_28575;\n    \n    int32_t phys_group_id_28580;\n    \n    phys_group_id_28580 = get_group_id(0);\n    for (int32_t i_28581 = 0; i_28581 < sdiv_up32(required_groups_28574 -\n                                                  phys_group_id_28580,\n                                                  sext_i64_i32(num_groups_27088));\n         i_28581++) {\n        int32_t virt_group_id_28582 = phys_group_id_28580 + i_28581 *\n                sext_i64_i32(num_groups_27088);\n        int64_t flat_idx_28583 = sext_i32_i64(virt_group_id_28582) *\n                segscan_group_sizze_27086 + sext_i32_i64(local_tid_28576);\n        int64_t gtid_27090 = flat_idx_28583;\n        int64_t orig_group_28584 = squot64(flat_idx_28583,\n                                           segscan_group_sizze_27086 *\n                                           sdiv_up64(res_24008,\n                                                     sext_i32_i64(num_threads_28522)));\n        int64_t carry_in_flat_idx_28585 = orig_group_28584 *\n                (segscan_group_sizze_27086 * sdiv_up64(res_24008,\n                                                       sext_i32_i64(num_threads_28522))) -\n                1;\n        \n        if (slt64(gtid_27090, res_24008)) {\n            if (!(orig_group_28584 == 0 || flat_idx_28583 == (orig_group_28584 +\n                                                              ",
                   "1) *\n                  (segscan_group_sizze_27086 * sdiv_up64(res_24008,\n                                                         sext_i32_i64(num_threads_28522))) -\n                  1)) {\n                bool x_24067;\n                int64_t x_24068;\n                bool x_24069;\n                int64_t x_24070;\n                \n                x_24067 = ((__global\n                            bool *) mem_27819)[carry_in_flat_idx_28585];\n                x_24068 = ((__global\n                            int64_t *) mem_27821)[carry_in_flat_idx_28585];\n                x_24069 = ((__global bool *) mem_27819)[gtid_27090];\n                x_24070 = ((__global int64_t *) mem_27821)[gtid_27090];\n                \n                bool res_24071;\n                \n                res_24071 = x_24067 || x_24069;\n                \n                int64_t res_24072;\n                \n                if (x_24069) {\n                    res_24072 = x_24070;\n                } else {\n                    int64_t res_24073 = add64(x_24068, x_24070);\n                    \n                    res_24072 = res_24073;\n                }\n                x_24067 = res_24071;\n                x_24068 = res_24072;\n                ((__global bool *) mem_27819)[gtid_27090] = x_24067;\n                ((__global int64_t *) mem_27821)[gtid_27090] = x_24068;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27086\n}\n__kernel void testziscan_stage3_27099(__global int *global_failure,\n                                      int64_t res_24008,\n                                      int64_t num_groups_27096, __global\n                                      unsigned char *mem_27826, __global\n                                      unsigned char *mem_27828,\n                                      int32_t num_threads_28589,\n                                      int32_t required_groups_28641)\n{\n    #define segscan_group_sizze_",
                   "27094 (testzisegscan_group_sizze_27093)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28642;\n    int32_t local_tid_28643;\n    int64_t group_sizze_28646;\n    int32_t wave_sizze_28645;\n    int32_t group_tid_28644;\n    \n    global_tid_28642 = get_global_id(0);\n    local_tid_28643 = get_local_id(0);\n    group_sizze_28646 = get_local_size(0);\n    wave_sizze_28645 = LOCKSTEP_WIDTH;\n    group_tid_28644 = get_group_id(0);\n    \n    int32_t phys_tid_27099;\n    \n    phys_tid_27099 = global_tid_28642;\n    \n    int32_t phys_group_id_28647;\n    \n    phys_group_id_28647 = get_group_id(0);\n    for (int32_t i_28648 = 0; i_28648 < sdiv_up32(required_groups_28641 -\n                                                  phys_group_id_28647,\n                                                  sext_i64_i32(num_groups_27096));\n         i_28648++) {\n        int32_t virt_group_id_28649 = phys_group_id_28647 + i_28648 *\n                sext_i64_i32(num_groups_27096);\n        int64_t flat_idx_28650 = sext_i32_i64(virt_group_id_28649) *\n                segscan_group_sizze_27094 + sext_i32_i64(local_tid_28643);\n        int64_t gtid_27098 = flat_idx_28650;\n        int64_t orig_group_28651 = squot64(flat_idx_28650,\n                                           segscan_group_sizze_27094 *\n                                           sdiv_up64(res_24008,\n                                                     sext_i32_i64(num_threads_28589)));\n        int64_t carry_in_flat_idx_28652 = orig_group_28651 *\n                (segscan_group_sizze_27094 * sdiv_up64(res_24008,\n                                                       sext_i32_i64(num_threads_28589))) -\n                1;\n        \n        if (slt64(gtid_27098, res_24008)) {\n            if (!(orig_group_28651 == 0 || flat_idx_28650 == (orig_group_28651 +\n                                                              1) *\n              ",
                   "    (segscan_group_sizze_27094 * sdiv_up64(res_24008,\n                                                         sext_i32_i64(num_threads_28589))) -\n                  1)) {\n                bool x_24093;\n                float x_24094;\n                bool x_24095;\n                float x_24096;\n                \n                x_24093 = ((__global\n                            bool *) mem_27826)[carry_in_flat_idx_28652];\n                x_24094 = ((__global\n                            float *) mem_27828)[carry_in_flat_idx_28652];\n                x_24095 = ((__global bool *) mem_27826)[gtid_27098];\n                x_24096 = ((__global float *) mem_27828)[gtid_27098];\n                \n                bool res_24097;\n                \n                res_24097 = x_24093 || x_24095;\n                \n                float res_24098;\n                \n                if (x_24095) {\n                    res_24098 = x_24096;\n                } else {\n                    float res_24099 = x_24094 + x_24096;\n                    \n                    res_24098 = res_24099;\n                }\n                x_24093 = res_24097;\n                x_24094 = res_24098;\n                ((__global bool *) mem_27826)[gtid_27098] = x_24093;\n                ((__global float *) mem_27828)[gtid_27098] = x_24094;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27094\n}\n__kernel void testziscan_stage3_27151(__global int *global_failure,\n                                      int64_t res_24008,\n                                      int64_t num_groups_27148, __global\n                                      unsigned char *mem_27831,\n                                      int32_t num_threads_28656,\n                                      int32_t required_groups_28692)\n{\n    #define segscan_group_sizze_27146 (testzisegscan_group_sizze_27145)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    con",
                   "st int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28693;\n    int32_t local_tid_28694;\n    int64_t group_sizze_28697;\n    int32_t wave_sizze_28696;\n    int32_t group_tid_28695;\n    \n    global_tid_28693 = get_global_id(0);\n    local_tid_28694 = get_local_id(0);\n    group_sizze_28697 = get_local_size(0);\n    wave_sizze_28696 = LOCKSTEP_WIDTH;\n    group_tid_28695 = get_group_id(0);\n    \n    int32_t phys_tid_27151;\n    \n    phys_tid_27151 = global_tid_28693;\n    \n    int32_t phys_group_id_28698;\n    \n    phys_group_id_28698 = get_group_id(0);\n    for (int32_t i_28699 = 0; i_28699 < sdiv_up32(required_groups_28692 -\n                                                  phys_group_id_28698,\n                                                  sext_i64_i32(num_groups_27148));\n         i_28699++) {\n        int32_t virt_group_id_28700 = phys_group_id_28698 + i_28699 *\n                sext_i64_i32(num_groups_27148);\n        int64_t flat_idx_28701 = sext_i32_i64(virt_group_id_28700) *\n                segscan_group_sizze_27146 + sext_i32_i64(local_tid_28694);\n        int64_t gtid_27150 = flat_idx_28701;\n        int64_t orig_group_28702 = squot64(flat_idx_28701,\n                                           segscan_group_sizze_27146 *\n                                           sdiv_up64(res_24008,\n                                                     sext_i32_i64(num_threads_28656)));\n        int64_t carry_in_flat_idx_28703 = orig_group_28702 *\n                (segscan_group_sizze_27146 * sdiv_up64(res_24008,\n                                                       sext_i32_i64(num_threads_28656))) -\n                1;\n        \n        if (slt64(gtid_27150, res_24008)) {\n            if (!(orig_group_28702 == 0 || flat_idx_28701 == (orig_group_28702 +\n                                                              1) *\n                  (segscan_group_sizze_27146 * sdiv_up64(res_24008,\n                                                         s",
                   "ext_i32_i64(num_threads_28656))) -\n                  1)) {\n                int64_t x_24194;\n                int64_t x_24195;\n                \n                x_24194 = ((__global\n                            int64_t *) mem_27831)[carry_in_flat_idx_28703];\n                x_24195 = ((__global int64_t *) mem_27831)[gtid_27150];\n                \n                int64_t res_24196;\n                \n                res_24196 = add64(x_24194, x_24195);\n                x_24194 = res_24196;\n                ((__global int64_t *) mem_27831)[gtid_27150] = x_24194;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27146\n}\n__kernel void testziseghist_global_27068(__global int *global_failure,\n                                         int64_t res_24008,\n                                         int64_t num_groups_27065,\n                                         int64_t binop_x_27755, __global\n                                         unsigned char *mem_27803,\n                                         int32_t num_subhistos_28305, __global\n                                         unsigned char *res_subhistos_mem_28306,\n                                         __global\n                                         unsigned char *testzihist_locks_mem_28376,\n                                         int32_t chk_i_28378,\n                                         int64_t hist_H_chk_28379)\n{\n    #define seghist_group_sizze_27063 (testziseghist_group_sizze_27062)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28380;\n    int32_t local_tid_28381;\n    int64_t group_sizze_28384;\n    int32_t wave_sizze_28383;\n    int32_t group_tid_28382;\n    \n    global_tid_28380 = get_global_id(0);\n    local_tid_28381 = get_local_id(0);\n    group_sizze_28384 = get_local_size(0);\n    wave_sizze_28383 ",
                   "= LOCKSTEP_WIDTH;\n    group_tid_28382 = get_group_id(0);\n    \n    int32_t phys_tid_27068;\n    \n    phys_tid_27068 = global_tid_28380;\n    \n    int32_t subhisto_ind_28385;\n    \n    subhisto_ind_28385 = squot32(global_tid_28380,\n                                 sdiv_up32(sext_i64_i32(seghist_group_sizze_27063 *\n                                           num_groups_27065),\n                                           num_subhistos_28305));\n    for (int64_t i_28386 = 0; i_28386 < sdiv_up64(binop_x_27755 -\n                                                  sext_i32_i64(global_tid_28380),\n                                                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_27063 *\n                                                  num_groups_27065)));\n         i_28386++) {\n        int32_t gtid_27067 = sext_i64_i32(i_28386 *\n                sext_i32_i64(sext_i64_i32(seghist_group_sizze_27063 *\n                num_groups_27065)) + sext_i32_i64(global_tid_28380));\n        \n        if (slt64(i_28386 *\n                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_27063 *\n                  num_groups_27065)) + sext_i32_i64(global_tid_28380),\n                  binop_x_27755)) {\n            int64_t i_p_o_27572 = add64(-1, gtid_27067);\n            int64_t rot_i_27573 = smod64(i_p_o_27572, binop_x_27755);\n            bool cond_27074 = gtid_27067 == 0;\n            int64_t res_27075;\n            \n            if (cond_27074) {\n                res_27075 = 0;\n            } else {\n                int64_t x_27073 = ((__global int64_t *) mem_27803)[rot_i_27573];\n                \n                res_27075 = x_27073;\n            }\n            // save map-out results\n            { }\n            // perform atomic updates\n            {\n                if (sle64(sext_i32_i64(chk_i_28378) * hist_H_chk_28379,\n                          res_27075) && (slt64(res_27075,\n                                               sext_i32_i64(chk_i_28378) *\n                                               his",
                   "t_H_chk_28379 +\n                                               hist_H_chk_28379) &&\n                                         slt64(res_27075, res_24008))) {\n                    int64_t x_27069;\n                    int64_t x_27070;\n                    \n                    x_27070 = gtid_27067;\n                    \n                    int32_t old_28387;\n                    volatile bool continue_28388;\n                    \n                    continue_28388 = 1;\n                    while (continue_28388) {\n                        old_28387 =\n                            atomic_cmpxchg_i32_global(&((volatile __global\n                                                         int *) testzihist_locks_mem_28376)[srem64(sext_i32_i64(subhisto_ind_28385) *\n                                                                                                   res_24008 +\n                                                                                                   res_27075,\n                                                                                                   100151)],\n                                                      0, 1);\n                        if (old_28387 == 0) {\n                            int64_t x_27069;\n                            \n                            // bind lhs\n                            {\n                                x_27069 = ((volatile __global\n                                            int64_t *) res_subhistos_mem_28306)[sext_i32_i64(subhisto_ind_28385) *\n                                                                                res_24008 +\n                                                                                res_27075];\n                            }\n                            // execute operation\n                            {\n                                int64_t res_27071 = smax64(x_27069, x_27070);\n                                \n                                x_27069 = res_27071;\n                            }\n",
                   "                            // update global result\n                            {\n                                ((volatile __global\n                                  int64_t *) res_subhistos_mem_28306)[sext_i32_i64(subhisto_ind_28385) *\n                                                                      res_24008 +\n                                                                      res_27075] =\n                                    x_27069;\n                            }\n                            mem_fence_global();\n                            old_28387 =\n                                atomic_cmpxchg_i32_global(&((volatile __global\n                                                             int *) testzihist_locks_mem_28376)[srem64(sext_i32_i64(subhisto_ind_28385) *\n                                                                                                       res_24008 +\n                                                                                                       res_27075,\n                                                                                                       100151)],\n                                                          1, 0);\n                            continue_28388 = 0;\n                        }\n                        mem_fence_global();\n                    }\n                }\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef seghist_group_sizze_27063\n}\n__kernel void testziseghist_local_27068(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *locks_mem_28346_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *subhistogram_local_mem_28344_backing_aligned_1,\n                                        int64_t res_24008,\n                                        int64_t binop_x_27755, __global\n                                        unsigned char *mem",
                   "_27803, __global\n                                        unsigned char *res_subhistos_mem_28306,\n                                        int32_t max_group_sizze_28315,\n                                        int64_t num_groups_28316,\n                                        int32_t hist_M_28322,\n                                        int32_t chk_i_28327,\n                                        int64_t num_segments_28328,\n                                        int64_t hist_H_chk_28329,\n                                        int64_t histo_sizze_28330,\n                                        int32_t init_per_thread_28331)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict locks_mem_28346_backing_1 =\n                          (__local volatile\n                           char *) locks_mem_28346_backing_aligned_0;\n    __local volatile char *restrict subhistogram_local_mem_28344_backing_0 =\n                          (__local volatile\n                           char *) subhistogram_local_mem_28344_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28332;\n    int32_t local_tid_28333;\n    int64_t group_sizze_28336;\n    int32_t wave_sizze_28335;\n    int32_t group_tid_28334;\n    \n    global_tid_28332 = get_global_id(0);\n    local_tid_28333 = get_local_id(0);\n    group_sizze_28336 = get_local_size(0);\n    wave_sizze_28335 = LOCKSTEP_WIDTH;\n    group_tid_28334 = get_group_id(0);\n    \n    int32_t phys_tid_27068;\n    \n    phys_tid_27068 = global_tid_28332;\n    \n    int32_t phys_group_id_28337;\n    \n    phys_group_id_28337 = get_group_id(0);\n    for (int32_t i_28338 = 0; i_28338 <\n         sdiv_up32(sext_i64_i32(num_groups_28316 * num_segments_28328) -\n                   phys_group_id_28337, sext_i64_i32(num_groups_28316));\n         i_28338++) {\n        int32_t virt_group_id_28339 = phys_group_id_28337 + i_28338 *\n                sext_i64_i32(num_groups_28316",
                   ");\n        int32_t flat_segment_id_28340 = squot32(virt_group_id_28339,\n                                                sext_i64_i32(num_groups_28316));\n        int32_t gid_in_segment_28341 = srem32(virt_group_id_28339,\n                                              sext_i64_i32(num_groups_28316));\n        int32_t pgtid_in_segment_28342 = gid_in_segment_28341 *\n                sext_i64_i32(max_group_sizze_28315) + local_tid_28333;\n        int32_t threads_per_segment_28343 = sext_i64_i32(num_groups_28316 *\n                max_group_sizze_28315);\n        __local char *subhistogram_local_mem_28344;\n        \n        subhistogram_local_mem_28344 = (__local\n                                        char *) subhistogram_local_mem_28344_backing_0;\n        \n        __local char *locks_mem_28346;\n        \n        locks_mem_28346 = (__local char *) locks_mem_28346_backing_1;\n        // All locks start out unlocked\n        {\n            for (int64_t i_28348 = 0; i_28348 < sdiv_up64(hist_M_28322 *\n                                                          hist_H_chk_28329 -\n                                                          sext_i32_i64(local_tid_28333),\n                                                          max_group_sizze_28315);\n                 i_28348++) {\n                ((__local int32_t *) locks_mem_28346)[squot64(i_28348 *\n                                                              max_group_sizze_28315 +\n                                                              sext_i32_i64(local_tid_28333),\n                                                              hist_H_chk_28329) *\n                                                      hist_H_chk_28329 +\n                                                      (i_28348 *\n                                                       max_group_sizze_28315 +\n                                                       sext_i32_i64(local_tid_28333) -\n                                                       squot64(i_28348 *\n               ",
                   "                                                max_group_sizze_28315 +\n                                                               sext_i32_i64(local_tid_28333),\n                                                               hist_H_chk_28329) *\n                                                       hist_H_chk_28329)] = 0;\n            }\n        }\n        \n        int32_t thread_local_subhisto_i_28349;\n        \n        thread_local_subhisto_i_28349 = srem32(local_tid_28333, hist_M_28322);\n        // initialize histograms in local memory\n        {\n            for (int32_t local_i_28350 = 0; local_i_28350 <\n                 init_per_thread_28331; local_i_28350++) {\n                int32_t j_28351 = local_i_28350 *\n                        sext_i64_i32(max_group_sizze_28315) + local_tid_28333;\n                int32_t j_offset_28352 = hist_M_28322 *\n                        sext_i64_i32(histo_sizze_28330) * gid_in_segment_28341 +\n                        j_28351;\n                int32_t local_subhisto_i_28353 = squot32(j_28351,\n                                                         sext_i64_i32(histo_sizze_28330));\n                int32_t global_subhisto_i_28354 = squot32(j_offset_28352,\n                                                          sext_i64_i32(histo_sizze_28330));\n                \n                if (slt32(j_28351, hist_M_28322 *\n                          sext_i64_i32(histo_sizze_28330))) {\n                    // First subhistogram is initialised from global memory; others with neutral element.\n                    {\n                        if (global_subhisto_i_28354 == 0) {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_28344)[sext_i32_i64(local_subhisto_i_28353) *\n                                                                       hist_H_chk_28329 +\n                                                                       sext_i32_i64(srem32(j_28351,\n                                                 ",
                   "                                          sext_i64_i32(histo_sizze_28330)))] =\n                                ((__global\n                                  int64_t *) res_subhistos_mem_28306)[sext_i32_i64(srem32(j_28351,\n                                                                                          sext_i64_i32(histo_sizze_28330))) +\n                                                                      sext_i32_i64(chk_i_28327) *\n                                                                      hist_H_chk_28329];\n                        } else {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_28344)[sext_i32_i64(local_subhisto_i_28353) *\n                                                                       hist_H_chk_28329 +\n                                                                       sext_i32_i64(srem32(j_28351,\n                                                                                           sext_i64_i32(histo_sizze_28330)))] =\n                                0;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_28355 = 0; i_28355 <\n             sdiv_up32(sext_i64_i32(binop_x_27755) - pgtid_in_segment_28342,\n                       threads_per_segment_28343); i_28355++) {\n            int32_t gtid_27067 = i_28355 * threads_per_segment_28343 +\n                    pgtid_in_segment_28342;\n            int64_t i_p_o_27572 = add64(-1, gtid_27067);\n            int64_t rot_i_27573 = smod64(i_p_o_27572, binop_x_27755);\n            bool cond_27074 = gtid_27067 == 0;\n            int64_t res_27075;\n            \n            if (cond_27074) {\n                res_27075 = 0;\n            } else {\n                int64_t x_27073 = ((__global int64_t *) mem_27803)[rot_i_27573];\n                \n                res_27075 = x_27073;\n            }\n            if (chk_i_28327 == 0) {\n                // ",
                   "save map-out results\n                { }\n            }\n            // perform atomic updates\n            {\n                if (slt64(res_27075, res_24008) &&\n                    (sle64(sext_i32_i64(chk_i_28327) * hist_H_chk_28329,\n                           res_27075) && slt64(res_27075,\n                                               sext_i32_i64(chk_i_28327) *\n                                               hist_H_chk_28329 +\n                                               hist_H_chk_28329))) {\n                    int64_t x_27069;\n                    int64_t x_27070;\n                    \n                    x_27070 = gtid_27067;\n                    \n                    int32_t old_28356;\n                    volatile bool continue_28357;\n                    \n                    continue_28357 = 1;\n                    while (continue_28357) {\n                        old_28356 = atomic_cmpxchg_i32_local(&((volatile __local\n                                                                int *) locks_mem_28346)[sext_i32_i64(thread_local_subhisto_i_28349) *\n                                                                                        hist_H_chk_28329 +\n                                                                                        (res_27075 -\n                                                                                         sext_i32_i64(chk_i_28327) *\n                                                                                         hist_H_chk_28329)],\n                                                             0, 1);\n                        if (old_28356 == 0) {\n                            int64_t x_27069;\n                            \n                            // bind lhs\n                            {\n                                x_27069 = ((volatile __local\n                                            int64_t *) subhistogram_local_mem_28344)[sext_i32_i64(thread_local_subhisto_i_28349) *\n                                                 ",
                   "                                    hist_H_chk_28329 +\n                                                                                     (res_27075 -\n                                                                                      sext_i32_i64(chk_i_28327) *\n                                                                                      hist_H_chk_28329)];\n                            }\n                            // execute operation\n                            {\n                                int64_t res_27071 = smax64(x_27069, x_27070);\n                                \n                                x_27069 = res_27071;\n                            }\n                            // update global result\n                            {\n                                ((volatile __local\n                                  int64_t *) subhistogram_local_mem_28344)[sext_i32_i64(thread_local_subhisto_i_28349) *\n                                                                           hist_H_chk_28329 +\n                                                                           (res_27075 -\n                                                                            sext_i32_i64(chk_i_28327) *\n                                                                            hist_H_chk_28329)] =\n                                    x_27069;\n                            }\n                            mem_fence_local();\n                            old_28356 =\n                                atomic_cmpxchg_i32_local(&((volatile __local\n                                                            int *) locks_mem_28346)[sext_i32_i64(thread_local_subhisto_i_28349) *\n                                                                                    hist_H_chk_28329 +\n                                                                                    (res_27075 -\n                                                                                     sext_i32_i64(chk_i_28327) *\n     ",
                   "                                                                                hist_H_chk_28329)],\n                                                         1, 0);\n                            continue_28357 = 0;\n                        }\n                        mem_fence_local();\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Compact the multiple local memory subhistograms to result in global memory\n        {\n            int64_t trunc_H_28358 = smin64(hist_H_chk_28329, res_24008 -\n                                           sext_i32_i64(chk_i_28327) *\n                                           hist_H_chk_28329);\n            int32_t histo_sizze_28359 = sext_i64_i32(trunc_H_28358);\n            \n            for (int32_t local_i_28360 = 0; local_i_28360 <\n                 init_per_thread_28331; local_i_28360++) {\n                int32_t j_28361 = local_i_28360 *\n                        sext_i64_i32(max_group_sizze_28315) + local_tid_28333;\n                \n                if (slt32(j_28361, histo_sizze_28359)) {\n                    int64_t x_27069;\n                    int64_t x_27070;\n                    \n                    // Read values from subhistogram 0.\n                    {\n                        x_27069 = ((__local\n                                    int64_t *) subhistogram_local_mem_28344)[sext_i32_i64(j_28361)];\n                    }\n                    // Accumulate based on values in other subhistograms.\n                    {\n                        for (int32_t subhisto_id_28362 = 0; subhisto_id_28362 <\n                             hist_M_28322 - 1; subhisto_id_28362++) {\n                            x_27070 = ((__local\n                                        int64_t *) subhistogram_local_mem_28344)[(sext_i32_i64(subhisto_id_28362) +\n                                                                                  1) *\n                                                                          ",
                   "       hist_H_chk_28329 +\n                                                                                 sext_i32_i64(j_28361)];\n                            \n                            int64_t res_27071;\n                            \n                            res_27071 = smax64(x_27069, x_27070);\n                            x_27069 = res_27071;\n                        }\n                    }\n                    // Put final bucket value in global memory.\n                    {\n                        ((__global\n                          int64_t *) res_subhistos_mem_28306)[srem64(sext_i32_i64(virt_group_id_28339),\n                                                                     num_groups_28316) *\n                                                              res_24008 +\n                                                              (sext_i32_i64(j_28361) +\n                                                               sext_i32_i64(chk_i_28327) *\n                                                               hist_H_chk_28329)] =\n                            x_27069;\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\n__kernel void testzisegmap_25945(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, __global\n                                 unsigned char *mem_27671, __global\n                                 unsigned char *mem_27673, __global\n                                 unsigned char *mem_27685, __global\n                                 unsigned char *mem_27699)\n{\n    #define segmap_group_sizze_26023 (testzisegmap_group_sizze_25947)\n    #define num_threads_27974 (testzisegmap_group_sizze_25947 * sdiv_up64(9, testzisegmap_group_sizze_25947))\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    i",
                   "f (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28123;\n    int32_t local_tid_28124;\n    int64_t group_sizze_28127;\n    int32_t wave_sizze_28126;\n    int32_t group_tid_28125;\n    \n    global_tid_28123 = get_global_id(0);\n    local_tid_28124 = get_local_id(0);\n    group_sizze_28127 = get_local_size(0);\n    wave_sizze_28126 = LOCKSTEP_WIDTH;\n    group_tid_28125 = get_group_id(0);\n    \n    int32_t phys_tid_25945;\n    \n    phys_tid_25945 = global_tid_28123;\n    \n    int64_t gtid_25944;\n    \n    gtid_25944 = sext_i32_i64(group_tid_28125) * segmap_group_sizze_26023 +\n        sext_i32_i64(local_tid_28124);\n    if (slt64(gtid_25944, 9)) {\n        float res_26034 = ((__global float *) mem_27673)[gtid_25944];\n        int64_t res_26035 = ((__global int64_t *) mem_27671)[gtid_25944];\n        int64_t range_end_26037 = sub64(res_26035, 1);\n        bool bounds_invalid_upwards_26038 = slt64(range_end_26037, 0);\n        bool valid_26039 = !bounds_invalid_upwards_26038;\n        bool range_valid_c_26040;\n        \n        if (!valid_26039) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 11) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = 1;\n                    global_failure_args[2] = range_end_26037;\n                    ;\n                }\n                return;\n            }\n        }\n        for (int64_t i_27635 = 0; i_27635 < res_26035; i_27635++) {\n            float res_26044 = sitofp_i64_f32(i_27635);\n            float res_26045 = res_26034 * res_26044;\n            \n            ((__global float *) mem_27685)[phys_tid_25945 + i_27635 *\n                                           num_threads_27974] = res_26045;\n        }\n        \n        bool y_26046 = slt64(0, res_26035);\n        bool index_certs_26047;\n        \n        if (!y_26046) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 12) == -1) {\n                    global_failure_args[0] = 0;\n",
                   "                    global_failure_args[1] = res_26035;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_26048 = sitofp_i64_f32(range_end_26037);\n        float index_primexp_26049 = res_26034 * binop_y_26048;\n        float negate_arg_26050 = 1.0e-2F * index_primexp_26049;\n        float exp_arg_26051 = 0.0F - negate_arg_26050;\n        float res_26052 = fpow32(2.7182817F, exp_arg_26051);\n        float x_26053 = 1.0F - res_26052;\n        float B_26054 = x_26053 / 1.0e-2F;\n        float x_26055 = B_26054 - index_primexp_26049;\n        float x_26056 = 4.4999997e-6F * x_26055;\n        float A1_26057 = x_26056 / 1.0e-4F;\n        float y_26058 = fpow32(B_26054, 2.0F);\n        float x_26059 = 1.0000001e-6F * y_26058;\n        float A2_26060 = x_26059 / 4.0e-2F;\n        float exp_arg_26061 = A1_26057 - A2_26060;\n        float res_26062 = fpow32(2.7182817F, exp_arg_26061);\n        float negate_arg_26063 = 5.0e-2F * B_26054;\n        float exp_arg_26064 = 0.0F - negate_arg_26063;\n        float res_26065 = fpow32(2.7182817F, exp_arg_26064);\n        float res_26066 = res_26062 * res_26065;\n        bool empty_slice_26067 = range_end_26037 == 0;\n        bool zzero_leq_i_p_m_t_s_26068 = sle64(0, range_end_26037);\n        bool i_p_m_t_s_leq_w_26069 = slt64(range_end_26037, res_26035);\n        bool i_lte_j_26070 = sle64(1, res_26035);\n        bool y_26071 = zzero_leq_i_p_m_t_s_26068 && i_p_m_t_s_leq_w_26069;\n        bool y_26072 = i_lte_j_26070 && y_26071;\n        bool ok_or_empty_26073 = empty_slice_26067 || y_26072;\n        bool index_certs_26074;\n        \n        if (!ok_or_empty_26073) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 13) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = res_26035;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float res_26076;\n        float",
                   " redout_27637 = 0.0F;\n        \n        for (int64_t i_27638 = 0; i_27638 < range_end_26037; i_27638++) {\n            int64_t slice_27659 = 1 + i_27638;\n            float x_26080 = ((__global float *) mem_27685)[phys_tid_25945 +\n                                                           slice_27659 *\n                                                           num_threads_27974];\n            float negate_arg_26081 = 1.0e-2F * x_26080;\n            float exp_arg_26082 = 0.0F - negate_arg_26081;\n            float res_26083 = fpow32(2.7182817F, exp_arg_26082);\n            float x_26084 = 1.0F - res_26083;\n            float B_26085 = x_26084 / 1.0e-2F;\n            float x_26086 = B_26085 - x_26080;\n            float x_26087 = 4.4999997e-6F * x_26086;\n            float A1_26088 = x_26087 / 1.0e-4F;\n            float y_26089 = fpow32(B_26085, 2.0F);\n            float x_26090 = 1.0000001e-6F * y_26089;\n            float A2_26091 = x_26090 / 4.0e-2F;\n            float exp_arg_26092 = A1_26088 - A2_26091;\n            float res_26093 = fpow32(2.7182817F, exp_arg_26092);\n            float negate_arg_26094 = 5.0e-2F * B_26085;\n            float exp_arg_26095 = 0.0F - negate_arg_26094;\n            float res_26096 = fpow32(2.7182817F, exp_arg_26095);\n            float res_26097 = res_26093 * res_26096;\n            float res_26079 = res_26097 + redout_27637;\n            float redout_tmp_28129 = res_26079;\n            \n            redout_27637 = redout_tmp_28129;\n        }\n        res_26076 = redout_27637;\n        \n        float x_26098 = 1.0F - res_26066;\n        float y_26099 = res_26034 * res_26076;\n        float res_26100 = x_26098 / y_26099;\n        \n        ((__global float *) mem_27699)[gtid_25944] = res_26100;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26023\n    #undef num_threads_27974\n}\n__kernel void testzisegmap_26121(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t",
                   " *global_failure_args, __global\n                                 unsigned char *mem_27671, __global\n                                 unsigned char *mem_27673, __global\n                                 unsigned char *mem_27708, __global\n                                 unsigned char *mem_27722)\n{\n    #define segmap_group_sizze_26199 (testzisegmap_group_sizze_26123)\n    #define num_threads_28006 (testzisegmap_group_sizze_26123 * sdiv_up64(9, testzisegmap_group_sizze_26123))\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28160;\n    int32_t local_tid_28161;\n    int64_t group_sizze_28164;\n    int32_t wave_sizze_28163;\n    int32_t group_tid_28162;\n    \n    global_tid_28160 = get_global_id(0);\n    local_tid_28161 = get_local_id(0);\n    group_sizze_28164 = get_local_size(0);\n    wave_sizze_28163 = LOCKSTEP_WIDTH;\n    group_tid_28162 = get_group_id(0);\n    \n    int32_t phys_tid_26121;\n    \n    phys_tid_26121 = global_tid_28160;\n    \n    int64_t gtid_26120;\n    \n    gtid_26120 = sext_i32_i64(group_tid_28162) * segmap_group_sizze_26199 +\n        sext_i32_i64(local_tid_28161);\n    if (slt64(gtid_26120, 9)) {\n        float res_26210 = ((__global float *) mem_27673)[gtid_26120];\n        int64_t res_26211 = ((__global int64_t *) mem_27671)[gtid_26120];\n        int64_t range_end_26213 = sub64(res_26211, 1);\n        bool bounds_invalid_upwards_26214 = slt64(range_end_26213, 0);\n        bool valid_26215 = !bounds_invalid_upwards_26214;\n        bool range_valid_c_26216;\n        \n        if (!valid_26215) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 14) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = 1;\n                    global_failure_args[2] = range_end_26213;\n                    ;\n                }\n                return;\n            }\n        }\n        for (int64_t ",
                   "i_27641 = 0; i_27641 < res_26211; i_27641++) {\n            float res_26220 = sitofp_i64_f32(i_27641);\n            float res_26221 = res_26210 * res_26220;\n            \n            ((__global float *) mem_27708)[phys_tid_26121 + i_27641 *\n                                           num_threads_28006] = res_26221;\n        }\n        \n        bool y_26222 = slt64(0, res_26211);\n        bool index_certs_26223;\n        \n        if (!y_26222) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 15) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_26211;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_26224 = sitofp_i64_f32(range_end_26213);\n        float index_primexp_26225 = res_26210 * binop_y_26224;\n        float negate_arg_26226 = 1.0e-2F * index_primexp_26225;\n        float exp_arg_26227 = 0.0F - negate_arg_26226;\n        float res_26228 = fpow32(2.7182817F, exp_arg_26227);\n        float x_26229 = 1.0F - res_26228;\n        float B_26230 = x_26229 / 1.0e-2F;\n        float x_26231 = B_26230 - index_primexp_26225;\n        float x_26232 = 4.4999997e-6F * x_26231;\n        float A1_26233 = x_26232 / 1.0e-4F;\n        float y_26234 = fpow32(B_26230, 2.0F);\n        float x_26235 = 1.0000001e-6F * y_26234;\n        float A2_26236 = x_26235 / 4.0e-2F;\n        float exp_arg_26237 = A1_26233 - A2_26236;\n        float res_26238 = fpow32(2.7182817F, exp_arg_26237);\n        float negate_arg_26239 = 5.0e-2F * B_26230;\n        float exp_arg_26240 = 0.0F - negate_arg_26239;\n        float res_26241 = fpow32(2.7182817F, exp_arg_26240);\n        float res_26242 = res_26238 * res_26241;\n        bool empty_slice_26243 = range_end_26213 == 0;\n        bool zzero_leq_i_p_m_t_s_26244 = sle64(0, range_end_26213);\n        bool i_p_m_t_s_leq_w_26245 = slt64(range_end_26213, res_26211);\n        bool i_lte_j_26246 = sle64(1, res_26211);\n        bool",
                   " y_26247 = zzero_leq_i_p_m_t_s_26244 && i_p_m_t_s_leq_w_26245;\n        bool y_26248 = i_lte_j_26246 && y_26247;\n        bool ok_or_empty_26249 = empty_slice_26243 || y_26248;\n        bool index_certs_26250;\n        \n        if (!ok_or_empty_26249) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 16) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = res_26211;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float res_26252;\n        float redout_27643 = 0.0F;\n        \n        for (int64_t i_27644 = 0; i_27644 < range_end_26213; i_27644++) {\n            int64_t slice_27662 = 1 + i_27644;\n            float x_26256 = ((__global float *) mem_27708)[phys_tid_26121 +\n                                                           slice_27662 *\n                                                           num_threads_28006];\n            float negate_arg_26257 = 1.0e-2F * x_26256;\n            float exp_arg_26258 = 0.0F - negate_arg_26257;\n            float res_26259 = fpow32(2.7182817F, exp_arg_26258);\n            float x_26260 = 1.0F - res_26259;\n            float B_26261 = x_26260 / 1.0e-2F;\n            float x_26262 = B_26261 - x_26256;\n            float x_26263 = 4.4999997e-6F * x_26262;\n            float A1_26264 = x_26263 / 1.0e-4F;\n            float y_26265 = fpow32(B_26261, 2.0F);\n            float x_26266 = 1.0000001e-6F * y_26265;\n            float A2_26267 = x_26266 / 4.0e-2F;\n            float exp_arg_26268 = A1_26264 - A2_26267;\n            float res_26269 = fpow32(2.7182817F, exp_arg_26268);\n            float negate_arg_26270 = 5.0e-2F * B_26261;\n            float exp_arg_26271 = 0.0F - negate_arg_26270;\n            float res_26272 = fpow32(2.7182817F, exp_arg_26271);\n            float res_26273 = res_26269 * res_26272;\n            float res_26255 = res_26273 + redout_27643;\n            float redout_tmp_28166 = res_26255;\n        ",
                   "    \n            redout_27643 = redout_tmp_28166;\n        }\n        res_26252 = redout_27643;\n        \n        float x_26274 = 1.0F - res_26242;\n        float y_26275 = res_26210 * res_26252;\n        float res_26276 = x_26274 / y_26275;\n        \n        ((__global float *) mem_27722)[gtid_26120] = res_26276;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26199\n    #undef num_threads_28006\n}\n__kernel void testzisegmap_26623(__global int *global_failure,\n                                 int64_t paths_23807, int64_t steps_23808,\n                                 float sims_per_year_23899, __global\n                                 unsigned char *mem_27798)\n{\n    #define segmap_group_sizze_27033 (testzisegmap_group_sizze_26627)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28207;\n    int32_t local_tid_28208;\n    int64_t group_sizze_28211;\n    int32_t wave_sizze_28210;\n    int32_t group_tid_28209;\n    \n    global_tid_28207 = get_global_id(0);\n    local_tid_28208 = get_local_id(0);\n    group_sizze_28211 = get_local_size(0);\n    wave_sizze_28210 = LOCKSTEP_WIDTH;\n    group_tid_28209 = get_group_id(0);\n    \n    int32_t phys_tid_26623;\n    \n    phys_tid_26623 = global_tid_28207;\n    \n    int64_t gtid_26620;\n    \n    gtid_26620 = squot64(sext_i32_i64(group_tid_28209) *\n                         segmap_group_sizze_27033 +\n                         sext_i32_i64(local_tid_28208), steps_23808 * 9);\n    \n    int64_t gtid_26621;\n    \n    gtid_26621 = squot64(sext_i32_i64(group_tid_28209) *\n                         segmap_group_sizze_27033 +\n                         sext_i32_i64(local_tid_28208) -\n                         squot64(sext_i32_i64(group_tid_28209) *\n                                 segmap_group_sizze_27033 +\n                                 sext_i32_i64(local_tid_28208), steps_23808 *\n                                 9) * (steps_238",
                   "08 * 9), 9);\n    \n    int64_t gtid_26622;\n    \n    gtid_26622 = sext_i32_i64(group_tid_28209) * segmap_group_sizze_27033 +\n        sext_i32_i64(local_tid_28208) - squot64(sext_i32_i64(group_tid_28209) *\n                                                segmap_group_sizze_27033 +\n                                                sext_i32_i64(local_tid_28208),\n                                                steps_23808 * 9) *\n        (steps_23808 * 9) - squot64(sext_i32_i64(group_tid_28209) *\n                                    segmap_group_sizze_27033 +\n                                    sext_i32_i64(local_tid_28208) -\n                                    squot64(sext_i32_i64(group_tid_28209) *\n                                            segmap_group_sizze_27033 +\n                                            sext_i32_i64(local_tid_28208),\n                                            steps_23808 * 9) * (steps_23808 *\n                                                                9), 9) * 9;\n    if ((slt64(gtid_26620, paths_23807) && slt64(gtid_26621, steps_23808)) &&\n        slt64(gtid_26622, 9)) {\n        int64_t convop_x_27504 = add64(1, gtid_26621);\n        float binop_x_27505 = sitofp_i64_f32(convop_x_27504);\n        float index_primexp_27506 = binop_x_27505 / sims_per_year_23899;\n        \n        ((__global float *) mem_27798)[gtid_26620 * (9 * steps_23808) +\n                                       gtid_26621 * 9 + gtid_26622] =\n            index_primexp_27506;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27033\n}\n__kernel void testzisegmap_26661(__global int *global_failure,\n                                 int64_t paths_23807, int64_t steps_23808,\n                                 __global unsigned char *mem_27788, __global\n                                 unsigned char *mem_27793)\n{\n    #define segmap_group_sizze_27015 (testzisegmap_group_sizze_26665)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    ",
                   "\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28202;\n    int32_t local_tid_28203;\n    int64_t group_sizze_28206;\n    int32_t wave_sizze_28205;\n    int32_t group_tid_28204;\n    \n    global_tid_28202 = get_global_id(0);\n    local_tid_28203 = get_local_id(0);\n    group_sizze_28206 = get_local_size(0);\n    wave_sizze_28205 = LOCKSTEP_WIDTH;\n    group_tid_28204 = get_group_id(0);\n    \n    int32_t phys_tid_26661;\n    \n    phys_tid_26661 = global_tid_28202;\n    \n    int64_t gtid_26658;\n    \n    gtid_26658 = squot64(sext_i32_i64(group_tid_28204) *\n                         segmap_group_sizze_27015 +\n                         sext_i32_i64(local_tid_28203), steps_23808 * 9);\n    \n    int64_t gtid_26659;\n    \n    gtid_26659 = squot64(sext_i32_i64(group_tid_28204) *\n                         segmap_group_sizze_27015 +\n                         sext_i32_i64(local_tid_28203) -\n                         squot64(sext_i32_i64(group_tid_28204) *\n                                 segmap_group_sizze_27015 +\n                                 sext_i32_i64(local_tid_28203), steps_23808 *\n                                 9) * (steps_23808 * 9), 9);\n    \n    int64_t gtid_26660;\n    \n    gtid_26660 = sext_i32_i64(group_tid_28204) * segmap_group_sizze_27015 +\n        sext_i32_i64(local_tid_28203) - squot64(sext_i32_i64(group_tid_28204) *\n                                                segmap_group_sizze_27015 +\n                                                sext_i32_i64(local_tid_28203),\n                                                steps_23808 * 9) *\n        (steps_23808 * 9) - squot64(sext_i32_i64(group_tid_28204) *\n                                    segmap_group_sizze_27015 +\n                                    sext_i32_i64(local_tid_28203) -\n                                    squot64(sext_i32_i64(group_tid_28204) *\n                                            segmap_group_sizze_27015 +\n                                            sext_i32_i64(local_tid_28203),\n   ",
                   "                                         steps_23808 * 9) * (steps_23808 *\n                                                                9), 9) * 9;\n    if ((slt64(gtid_26658, paths_23807) && slt64(gtid_26659, steps_23808)) &&\n        slt64(gtid_26660, 9)) {\n        float x_27018 = ((__global float *) mem_27788)[gtid_26659 *\n                                                       paths_23807 +\n                                                       gtid_26658];\n        \n        ((__global float *) mem_27793)[gtid_26658 * (9 * steps_23808) +\n                                       gtid_26659 * 9 + gtid_26660] = x_27018;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27015\n}\n__kernel void testzisegmap_26718(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args,\n                                 int64_t paths_23807, int64_t steps_23808,\n                                 float dt_23821, int64_t upper_bound_23913,\n                                 float res_23914, int64_t num_groups_26970,\n                                 __global unsigned char *mem_27770, __global\n                                 unsigned char *mem_27773, __global\n                                 unsigned char *mem_27788)\n{\n    #define segmap_group_sizze_26969 (testzisegmap_group_sizze_26720)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_28191;\n    int32_t local_tid_28192;\n    int64_t group_sizze_28195;\n    int32_t wave_sizze_28194;\n    int32_t group_tid_28193;\n    \n    global_tid_28191 = get_global_id(0);\n    local_tid_28192 = get_local_id(0);\n    group_sizze_28195 = get_local_",
                   "size(0);\n    wave_sizze_28194 = LOCKSTEP_WIDTH;\n    group_tid_28193 = get_group_id(0);\n    \n    int32_t phys_tid_26718;\n    \n    phys_tid_26718 = global_tid_28191;\n    \n    int32_t phys_group_id_28196;\n    \n    phys_group_id_28196 = get_group_id(0);\n    for (int32_t i_28197 = 0; i_28197 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(paths_23807,\n                                          segmap_group_sizze_26969)) -\n                   phys_group_id_28196, sext_i64_i32(num_groups_26970));\n         i_28197++) {\n        int32_t virt_group_id_28198 = phys_group_id_28196 + i_28197 *\n                sext_i64_i32(num_groups_26970);\n        int64_t gtid_26717 = sext_i32_i64(virt_group_id_28198) *\n                segmap_group_sizze_26969 + sext_i32_i64(local_tid_28192);\n        \n        if (slt64(gtid_26717, paths_23807)) {\n            for (int64_t i_28199 = 0; i_28199 < steps_23808; i_28199++) {\n                ((__global float *) mem_27773)[phys_tid_26718 + i_28199 *\n                                               (num_groups_26970 *\n                                                segmap_group_sizze_26969)] =\n                    5.0e-2F;\n            }\n            for (int64_t i_26976 = 0; i_26976 < upper_bound_23913; i_26976++) {\n                bool y_26978 = slt64(i_26976, steps_23808);\n                bool index_certs_26979;\n                \n                if (!y_26978) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 19) ==\n                            -1) {\n                            global_failure_args[0] = i_26976;\n                            global_failure_args[1] = steps_23808;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float shortstep_arg_26980 = ((__global\n                                              float *) mem_27770)[i_26976 *\n                    ",
                   "                                              paths_23807 +\n                                                                  gtid_26717];\n                float shortstep_arg_26981 = ((__global\n                                              float *) mem_27773)[phys_tid_26718 +\n                                                                  i_26976 *\n                                                                  (num_groups_26970 *\n                                                                   segmap_group_sizze_26969)];\n                float y_26982 = 5.0e-2F - shortstep_arg_26981;\n                float x_26983 = 1.0e-2F * y_26982;\n                float x_26984 = dt_23821 * x_26983;\n                float x_26985 = res_23914 * shortstep_arg_26980;\n                float y_26986 = 1.0e-3F * x_26985;\n                float delta_r_26987 = x_26984 + y_26986;\n                float res_26988 = shortstep_arg_26981 + delta_r_26987;\n                int64_t i_26989 = add64(1, i_26976);\n                bool x_26990 = sle64(0, i_26989);\n                bool y_26991 = slt64(i_26989, steps_23808);\n                bool bounds_check_26992 = x_26990 && y_26991;\n                bool index_certs_26993;\n                \n                if (!bounds_check_26992) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 20) ==\n                            -1) {\n                            global_failure_args[0] = i_26989;\n                            global_failure_args[1] = steps_23808;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                ((__global float *) mem_27773)[phys_tid_26718 + i_26989 *\n                                               (num_groups_26970 *\n                                                segmap_group_sizze_26969)] =\n                    res_26988;\n            }\n            for (int64_",
                   "t i_28201 = 0; i_28201 < steps_23808; i_28201++) {\n                ((__global float *) mem_27788)[i_28201 * paths_23807 +\n                                               gtid_26717] = ((__global\n                                                               float *) mem_27773)[phys_tid_26718 +\n                                                                                   i_28201 *\n                                                                                   (num_groups_26970 *\n                                                                                    segmap_group_sizze_26969)];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26969\n}\n__kernel void testzisegmap_26816(__global int *global_failure,\n                                 int64_t paths_23807, int64_t steps_23808,\n                                 __global unsigned char *mem_27763, __global\n                                 unsigned char *mem_27767)\n{\n    #define segmap_group_sizze_26924 (testzisegmap_group_sizze_26819)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28186;\n    int32_t local_tid_28187;\n    int64_t group_sizze_28190;\n    int32_t wave_sizze_28189;\n    int32_t group_tid_28188;\n    \n    global_tid_28186 = get_global_id(0);\n    local_tid_28187 = get_local_id(0);\n    group_sizze_28190 = get_local_size(0);\n    wave_sizze_28189 = LOCKSTEP_WIDTH;\n    group_tid_28188 = get_group_id(0);\n    \n    int32_t phys_tid_26816;\n    \n    phys_tid_26816 = global_tid_28186;\n    \n    int64_t gtid_26814;\n    \n    gtid_26814 = squot64(sext_i32_i64(group_tid_28188) *\n                         segmap_group_sizze_26924 +\n                         sext_i32_i64(local_tid_28187), steps_23808);\n    \n    int64_t gtid_26815;\n    \n    gtid_26815 = sext_i32_i64(group_tid_28188) * segmap_group_siz",
                   "ze_26924 +\n        sext_i32_i64(local_tid_28187) - squot64(sext_i32_i64(group_tid_28188) *\n                                                segmap_group_sizze_26924 +\n                                                sext_i32_i64(local_tid_28187),\n                                                steps_23808) * steps_23808;\n    if (slt64(gtid_26814, paths_23807) && slt64(gtid_26815, steps_23808)) {\n        int32_t unsign_arg_26927 = ((__global int32_t *) mem_27763)[gtid_26814];\n        int32_t res_26929 = sext_i64_i32(gtid_26815);\n        int32_t x_26930 = lshr32(res_26929, 16);\n        int32_t x_26931 = res_26929 ^ x_26930;\n        int32_t x_26932 = mul32(73244475, x_26931);\n        int32_t x_26933 = lshr32(x_26932, 16);\n        int32_t x_26934 = x_26932 ^ x_26933;\n        int32_t x_26935 = mul32(73244475, x_26934);\n        int32_t x_26936 = lshr32(x_26935, 16);\n        int32_t x_26937 = x_26935 ^ x_26936;\n        int32_t unsign_arg_26938 = unsign_arg_26927 ^ x_26937;\n        int32_t unsign_arg_26939 = mul32(48271, unsign_arg_26938);\n        int32_t unsign_arg_26940 = umod32(unsign_arg_26939, 2147483647);\n        int32_t unsign_arg_26941 = mul32(48271, unsign_arg_26940);\n        int32_t unsign_arg_26942 = umod32(unsign_arg_26941, 2147483647);\n        float res_26943 = uitofp_i32_f32(unsign_arg_26940);\n        float res_26944 = res_26943 / 2.1474836e9F;\n        float res_26945 = uitofp_i32_f32(unsign_arg_26942);\n        float res_26946 = res_26945 / 2.1474836e9F;\n        float res_26947;\n        \n        res_26947 = futrts_log32(res_26944);\n        \n        float res_26948 = -2.0F * res_26947;\n        float res_26949;\n        \n        res_26949 = futrts_sqrt32(res_26948);\n        \n        float res_26950 = 6.2831855F * res_26946;\n        float res_26951;\n        \n        res_26951 = futrts_cos32(res_26950);\n        \n        float res_26952 = res_26949 * res_26951;\n        \n        ((__global float *) mem_27767)[gtid_26814 * steps_23808 + gtid_26815] =\n            res_269",
                   "52;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26924\n}\n__kernel void testzisegmap_26880(__global int *global_failure,\n                                 int64_t paths_23807, __global\n                                 unsigned char *mem_27763)\n{\n    #define segmap_group_sizze_26899 (testzisegmap_group_sizze_26882)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28181;\n    int32_t local_tid_28182;\n    int64_t group_sizze_28185;\n    int32_t wave_sizze_28184;\n    int32_t group_tid_28183;\n    \n    global_tid_28181 = get_global_id(0);\n    local_tid_28182 = get_local_id(0);\n    group_sizze_28185 = get_local_size(0);\n    wave_sizze_28184 = LOCKSTEP_WIDTH;\n    group_tid_28183 = get_group_id(0);\n    \n    int32_t phys_tid_26880;\n    \n    phys_tid_26880 = global_tid_28181;\n    \n    int64_t gtid_26879;\n    \n    gtid_26879 = sext_i32_i64(group_tid_28183) * segmap_group_sizze_26899 +\n        sext_i32_i64(local_tid_28182);\n    if (slt64(gtid_26879, paths_23807)) {\n        int32_t res_26903 = sext_i64_i32(gtid_26879);\n        int32_t x_26904 = lshr32(res_26903, 16);\n        int32_t x_26905 = res_26903 ^ x_26904;\n        int32_t x_26906 = mul32(73244475, x_26905);\n        int32_t x_26907 = lshr32(x_26906, 16);\n        int32_t x_26908 = x_26906 ^ x_26907;\n        int32_t x_26909 = mul32(73244475, x_26908);\n        int32_t x_26910 = lshr32(x_26909, 16);\n        int32_t x_26911 = x_26909 ^ x_26910;\n        int32_t unsign_arg_26912 = 777822902 ^ x_26911;\n        int32_t unsign_arg_26913 = mul32(48271, unsign_arg_26912);\n        int32_t unsign_arg_26914 = umod32(unsign_arg_26913, 2147483647);\n        \n        ((__global int32_t *) mem_27763)[gtid_26879] = unsign_arg_26914;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26899\n}\n__kernel void testzisegmap_27153(__global int *global_failure,\n                                 int64_t r",
                   "es_24008, int64_t num_segments_24200,\n                                 __global unsigned char *mem_27823, __global\n                                 unsigned char *mem_27828, __global\n                                 unsigned char *mem_27831, __global\n                                 unsigned char *mem_27833)\n{\n    #define segmap_group_sizze_27156 (testzisegmap_group_sizze_27155)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28713;\n    int32_t local_tid_28714;\n    int64_t group_sizze_28717;\n    int32_t wave_sizze_28716;\n    int32_t group_tid_28715;\n    \n    global_tid_28713 = get_global_id(0);\n    local_tid_28714 = get_local_id(0);\n    group_sizze_28717 = get_local_size(0);\n    wave_sizze_28716 = LOCKSTEP_WIDTH;\n    group_tid_28715 = get_group_id(0);\n    \n    int32_t phys_tid_27153;\n    \n    phys_tid_27153 = global_tid_28713;\n    \n    int64_t write_i_27152;\n    \n    write_i_27152 = sext_i32_i64(group_tid_28715) * segmap_group_sizze_27156 +\n        sext_i32_i64(local_tid_28714);\n    if (slt64(write_i_27152, res_24008)) {\n        int64_t i_p_o_27580 = add64(1, write_i_27152);\n        int64_t rot_i_27581 = smod64(i_p_o_27580, res_24008);\n        bool x_24213 = ((__global bool *) mem_27823)[rot_i_27581];\n        float write_value_24214 = ((__global float *) mem_27828)[write_i_27152];\n        int64_t res_24215;\n        \n        if (x_24213) {\n            int64_t x_24212 = ((__global int64_t *) mem_27831)[write_i_27152];\n            int64_t res_24216 = sub64(x_24212, 1);\n            \n            res_24215 = res_24216;\n        } else {\n            res_24215 = -1;\n        }\n        if (sle64(0, res_24215) && slt64(res_24215, num_segments_24200)) {\n            ((__global float *) mem_27833)[res_24215] = write_value_24214;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27156\n}\n__kernel void testzisegmap_27216(__global int *g",
                   "lobal_failure,\n                                 int64_t paths_23807, int64_t steps_23808,\n                                 float sims_per_year_23899, float res_24219,\n                                 __global unsigned char *mem_27853, __global\n                                 unsigned char *mem_27856)\n{\n    #define segmap_group_sizze_27395 (testzisegmap_group_sizze_27218)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28763;\n    int32_t local_tid_28764;\n    int64_t group_sizze_28767;\n    int32_t wave_sizze_28766;\n    int32_t group_tid_28765;\n    \n    global_tid_28763 = get_global_id(0);\n    local_tid_28764 = get_local_id(0);\n    group_sizze_28767 = get_local_size(0);\n    wave_sizze_28766 = LOCKSTEP_WIDTH;\n    group_tid_28765 = get_group_id(0);\n    \n    int32_t phys_tid_27216;\n    \n    phys_tid_27216 = global_tid_28763;\n    \n    int64_t gtid_27215;\n    \n    gtid_27215 = sext_i32_i64(group_tid_28765) * segmap_group_sizze_27395 +\n        sext_i32_i64(local_tid_28764);\n    if (slt64(gtid_27215, steps_23808)) {\n        int64_t convop_x_27587 = add64(1, gtid_27215);\n        float binop_x_27588 = sitofp_i64_f32(convop_x_27587);\n        float index_primexp_27589 = binop_x_27588 / sims_per_year_23899;\n        float res_27400;\n        float redout_27649 = 0.0F;\n        \n        for (int64_t i_27650 = 0; i_27650 < paths_23807; i_27650++) {\n            float res_27405;\n            float redout_27651 = 0.0F;\n            \n            for (int32_t i_27664 = 0; i_27664 < 9; i_27664++) {\n                int64_t i_27652 = sext_i32_i64(i_27664);\n                float x_27409 = ((__global float *) mem_27853)[i_27650 *\n                                                               (steps_23808 *\n                                                                9) + i_27652 *\n                                                               steps_23808 +\n             ",
                   "                                                  gtid_27215];\n                float res_27408 = x_27409 + redout_27651;\n                float redout_tmp_28769 = res_27408;\n                \n                redout_27651 = redout_tmp_28769;\n            }\n            res_27405 = redout_27651;\n            \n            float res_27410 = fmax32(0.0F, res_27405);\n            float res_27403 = res_27410 + redout_27649;\n            float redout_tmp_28768 = res_27403;\n            \n            redout_27649 = redout_tmp_28768;\n        }\n        res_27400 = redout_27649;\n        \n        float res_27411 = res_27400 / res_24219;\n        float negate_arg_27412 = 1.0e-2F * index_primexp_27589;\n        float exp_arg_27413 = 0.0F - negate_arg_27412;\n        float res_27414 = fpow32(2.7182817F, exp_arg_27413);\n        float x_27415 = 1.0F - res_27414;\n        float B_27416 = x_27415 / 1.0e-2F;\n        float x_27417 = B_27416 - index_primexp_27589;\n        float x_27418 = 4.4999997e-6F * x_27417;\n        float A1_27419 = x_27418 / 1.0e-4F;\n        float y_27420 = fpow32(B_27416, 2.0F);\n        float x_27421 = 1.0000001e-6F * y_27420;\n        float A2_27422 = x_27421 / 4.0e-2F;\n        float exp_arg_27423 = A1_27419 - A2_27422;\n        float res_27424 = fpow32(2.7182817F, exp_arg_27423);\n        float negate_arg_27425 = 5.0e-2F * B_27416;\n        float exp_arg_27426 = 0.0F - negate_arg_27425;\n        float res_27427 = fpow32(2.7182817F, exp_arg_27426);\n        float res_27428 = res_27424 * res_27427;\n        float res_27429 = res_27411 * res_27428;\n        \n        ((__global float *) mem_27856)[gtid_27215] = res_27429;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27395\n}\n__kernel void testzisegmap_27291(__global int *global_failure,\n                                 int64_t steps_23808, float sims_per_year_23899,\n                                 float res_24219, __global\n                                 unsigned char *mem_27863, __global\n                              ",
                   "   unsigned char *mem_27866)\n{\n    #define segmap_group_sizze_27448 (testzisegmap_group_sizze_27293)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28832;\n    int32_t local_tid_28833;\n    int64_t group_sizze_28836;\n    int32_t wave_sizze_28835;\n    int32_t group_tid_28834;\n    \n    global_tid_28832 = get_global_id(0);\n    local_tid_28833 = get_local_id(0);\n    group_sizze_28836 = get_local_size(0);\n    wave_sizze_28835 = LOCKSTEP_WIDTH;\n    group_tid_28834 = get_group_id(0);\n    \n    int32_t phys_tid_27291;\n    \n    phys_tid_27291 = global_tid_28832;\n    \n    int64_t gtid_27290;\n    \n    gtid_27290 = sext_i32_i64(group_tid_28834) * segmap_group_sizze_27448 +\n        sext_i32_i64(local_tid_28833);\n    if (slt64(gtid_27290, steps_23808)) {\n        int64_t convop_x_27591 = add64(1, gtid_27290);\n        float binop_x_27592 = sitofp_i64_f32(convop_x_27591);\n        float index_primexp_27593 = binop_x_27592 / sims_per_year_23899;\n        float res_27452 = ((__global float *) mem_27863)[gtid_27290];\n        float res_27453 = res_27452 / res_24219;\n        float negate_arg_27454 = 1.0e-2F * index_primexp_27593;\n        float exp_arg_27455 = 0.0F - negate_arg_27454;\n        float res_27456 = fpow32(2.7182817F, exp_arg_27455);\n        float x_27457 = 1.0F - res_27456;\n        float B_27458 = x_27457 / 1.0e-2F;\n        float x_27459 = B_27458 - index_primexp_27593;\n        float x_27460 = 4.4999997e-6F * x_27459;\n        float A1_27461 = x_27460 / 1.0e-4F;\n        float y_27462 = fpow32(B_27458, 2.0F);\n        float x_27463 = 1.0000001e-6F * y_27462;\n        float A2_27464 = x_27463 / 4.0e-2F;\n        float exp_arg_27465 = A1_27461 - A2_27464;\n        float res_27466 = fpow32(2.7182817F, exp_arg_27465);\n        float negate_arg_27467 = 5.0e-2F * B_27458;\n        float exp_arg_27468 = 0.0F - negate_arg_27467;\n        float res_27469 = fpow32(2.7182817F,",
                   " exp_arg_27468);\n        float res_27470 = res_27466 * res_27469;\n        float res_27471 = res_27453 * res_27470;\n        \n        ((__global float *) mem_27866)[gtid_27290] = res_27471;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27448\n}\n__kernel void testzisegmap_intragroup_26362(__global int *global_failure,\n                                            int failure_is_an_option, __global\n                                            int64_t *global_failure_args,\n                                            __local volatile\n                                            int64_t *mem_27752_backing_aligned_0,\n                                            __local volatile\n                                            int64_t *mem_27748_backing_aligned_1,\n                                            __local volatile\n                                            int64_t *mem_27732_backing_aligned_2,\n                                            __local volatile\n                                            int64_t *mem_27730_backing_aligned_3,\n                                            int64_t steps_23808, float dt_23821,\n                                            float sims_per_year_23899,\n                                            int64_t upper_bound_23913,\n                                            float res_23914,\n                                            int64_t computed_group_sizze_26319,\n                                            __global unsigned char *mem_27756,\n                                            __global unsigned char *mem_27760)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict mem_27752_backing_3 = (__local volatile\n                                                           char *) mem_27752_backing_aligned_0;\n    __local volatile char *restrict mem_27748_backing_2 = (__local volatile\n                                                           char *) mem_27748_ba",
                   "cking_aligned_1;\n    __local volatile char *restrict mem_27732_backing_1 = (__local volatile\n                                                           char *) mem_27732_backing_aligned_2;\n    __local volatile char *restrict mem_27730_backing_0 = (__local volatile\n                                                           char *) mem_27730_backing_aligned_3;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_28169;\n    int32_t local_tid_28170;\n    int64_t group_sizze_28173;\n    int32_t wave_sizze_28172;\n    int32_t group_tid_28171;\n    \n    global_tid_28169 = get_global_id(0);\n    local_tid_28170 = get_local_id(0);\n    group_sizze_28173 = get_local_size(0);\n    wave_sizze_28172 = LOCKSTEP_WIDTH;\n    group_tid_28171 = get_group_id(0);\n    \n    int32_t phys_tid_26362;\n    \n    phys_tid_26362 = group_tid_28171;\n    \n    int32_t ltid_pre_28174;\n    \n    ltid_pre_28174 = local_tid_28170;\n    \n    int32_t ltid_pre_28175;\n    \n    ltid_pre_28175 = squot32(local_tid_28170, 9);\n    \n    int32_t ltid_pre_28176;\n    \n    ltid_pre_28176 = local_tid_28170 - squot32(local_tid_28170, 9) * 9;\n    \n    int64_t gtid_26317;\n    \n    gtid_26317 = sext_i32_i64(group_tid_28171);\n    \n    int32_t res_26517;\n    \n    res_26517 = sext_i64_i32(gtid_26317);\n    \n    int32_t x_26518 = lshr32(res_26517, 16);\n    int32_t x_26519 = res_26517 ^ x_26518;\n    int32_t x_26520 = mul32(73244475, x_26519);\n    int32_t x_26521 = lshr32(x_26520, 16);\n    int32_t x_26522 = x_26520 ^ x_26521;\n    int32_t x_26523 = mul32(73244475, x_26522);\n    int32_t x_26524 = lshr32(x_26523, 16);\n    int32_t x_26525 = x_26523 ^ x_26524;\n    int32_t unsign_arg_26526 = 777822902 ^ x_26525;\n    int32_t unsign_arg_26527 = mul32(48271, unsign_arg_26526);\n    int32_t unsign_arg_26528 = umod32(unsign_arg_26527, 2147483",
                   "647);\n    __local char *mem_27730;\n    \n    mem_27730 = (__local char *) mem_27730_backing_0;\n    \n    int64_t gtid_26320 = sext_i32_i64(ltid_pre_28174);\n    int32_t phys_tid_26321 = local_tid_28170;\n    \n    if (slt64(gtid_26320, steps_23808)) {\n        int32_t res_26531 = sext_i64_i32(gtid_26320);\n        int32_t x_26532 = lshr32(res_26531, 16);\n        int32_t x_26533 = res_26531 ^ x_26532;\n        int32_t x_26534 = mul32(73244475, x_26533);\n        int32_t x_26535 = lshr32(x_26534, 16);\n        int32_t x_26536 = x_26534 ^ x_26535;\n        int32_t x_26537 = mul32(73244475, x_26536);\n        int32_t x_26538 = lshr32(x_26537, 16);\n        int32_t x_26539 = x_26537 ^ x_26538;\n        int32_t unsign_arg_26540 = unsign_arg_26528 ^ x_26539;\n        int32_t unsign_arg_26541 = mul32(48271, unsign_arg_26540);\n        int32_t unsign_arg_26542 = umod32(unsign_arg_26541, 2147483647);\n        int32_t unsign_arg_26543 = mul32(48271, unsign_arg_26542);\n        int32_t unsign_arg_26544 = umod32(unsign_arg_26543, 2147483647);\n        float res_26545 = uitofp_i32_f32(unsign_arg_26542);\n        float res_26546 = res_26545 / 2.1474836e9F;\n        float res_26547 = uitofp_i32_f32(unsign_arg_26544);\n        float res_26548 = res_26547 / 2.1474836e9F;\n        float res_26549;\n        \n        res_26549 = futrts_log32(res_26546);\n        \n        float res_26550 = -2.0F * res_26549;\n        float res_26551;\n        \n        res_26551 = futrts_sqrt32(res_26550);\n        \n        float res_26552 = 6.2831855F * res_26548;\n        float res_26553;\n        \n        res_26553 = futrts_cos32(res_26552);\n        \n        float res_26554 = res_26551 * res_26553;\n        \n        ((__local float *) mem_27730)[gtid_26320] = res_26554;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    __local char *mem_27732;\n    \n    mem_27732 = (__local char *) mem_27732_backing_1;\n    for (int64_t i_28177 = 0; i_28177 < sdiv_up64(steps_23808 -\n                                                  sext_i32_i64(local_t",
                   "id_28170),\n                                                  computed_group_sizze_26319);\n         i_28177++) {\n        ((__local float *) mem_27732)[i_28177 * computed_group_sizze_26319 +\n                                      sext_i32_i64(local_tid_28170)] = 5.0e-2F;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int64_t i_26557 = 0; i_26557 < upper_bound_23913; i_26557++) {\n        bool y_26559 = slt64(i_26557, steps_23808);\n        bool index_certs_26560;\n        \n        if (!y_26559) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 17) == -1) {\n                    global_failure_args[0] = i_26557;\n                    global_failure_args[1] = steps_23808;\n                    ;\n                }\n                local_failure = true;\n                goto error_1;\n            }\n        }\n        \n        float shortstep_arg_26561 = ((__local float *) mem_27730)[i_26557];\n        float shortstep_arg_26562 = ((__local float *) mem_27732)[i_26557];\n        float y_26563 = 5.0e-2F - shortstep_arg_26562;\n        float x_26564 = 1.0e-2F * y_26563;\n        float x_26565 = dt_23821 * x_26564;\n        float x_26566 = res_23914 * shortstep_arg_26561;\n        float y_26567 = 1.0e-3F * x_26566;\n        float delta_r_26568 = x_26565 + y_26567;\n        float res_26569 = shortstep_arg_26562 + delta_r_26568;\n        int64_t i_26570 = add64(1, i_26557);\n        bool x_26571 = sle64(0, i_26570);\n        bool y_26572 = slt64(i_26570, steps_23808);\n        bool bounds_check_26573 = x_26571 && y_26572;\n        bool index_certs_26574;\n        \n        if (!bounds_check_26573) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 18) == -1) {\n                    global_failure_args[0] = i_26570;\n                    global_failure_args[1] = steps_23808;\n                    ;\n                }\n                local_failure = true;\n                goto error_1;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n      ",
                   "  if (local_tid_28170 == 0) {\n            ((__local float *) mem_27732)[i_26570] = res_26569;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    __local char *mem_27748;\n    \n    mem_27748 = (__local char *) mem_27748_backing_2;\n    \n    int64_t gtid_26354 = sext_i32_i64(ltid_pre_28175);\n    int64_t gtid_26355 = sext_i32_i64(ltid_pre_28176);\n    int32_t phys_tid_26356 = local_tid_28170;\n    \n    if (slt64(gtid_26354, steps_23808) && slt64(gtid_26355, 9)) {\n        float x_26577 = ((__local float *) mem_27732)[gtid_26354];\n        \n        ((__local float *) mem_27748)[gtid_26354 * 9 + gtid_26355] = x_26577;\n    }\n    \n  error_1:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    __local char *mem_27752;\n    \n    mem_27752 = (__local char *) mem_27752_backing_3;\n    \n    int64_t gtid_26348 = sext_i32_i64(ltid_pre_28175);\n    int64_t gtid_26349 = sext_i32_i64(ltid_pre_28176);\n    int32_t phys_tid_26350 = local_tid_28170;\n    \n    if (slt64(gtid_26348, steps_23808) && slt64(gtid_26349, 9)) {\n        int64_t convop_x_27493 = add64(1, gtid_26348);\n        float binop_x_27494 = sitofp_i64_f32(convop_x_27493);\n        float index_primexp_27495 = binop_x_27494 / sims_per_year_23899;\n        \n        ((__local float *) mem_27752)[gtid_26348 * 9 + gtid_26349] =\n            index_primexp_27495;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int64_t i_28179 = 0; i_28179 < sdiv_up64(steps_23808 * 9 -\n                                                  sext_i32_i64(local_tid_28170),\n                                                  computed_group_sizze_26319);\n         i_28179++) {\n        ((__global float *) mem_27756)[gtid_26317 * (9 * steps_23808) +\n                                       squot64(i_28179 *\n                                               computed_group_sizze_26319 +\n                                               sext_i32_i64(local_tid_28170),\n                                             ",
                   "  9) * 9 + (i_28179 *\n                                                         computed_group_sizze_26319 +\n                                                         sext_i32_i64(local_tid_28170) -\n                                                         squot64(i_28179 *\n                                                                 computed_group_sizze_26319 +\n                                                                 sext_i32_i64(local_tid_28170),\n                                                                 9) * 9)] =\n            ((__local float *) mem_27748)[squot64(i_28179 *\n                                                  computed_group_sizze_26319 +\n                                                  sext_i32_i64(local_tid_28170),\n                                                  9) * 9 + (i_28179 *\n                                                            computed_group_sizze_26319 +\n                                                            sext_i32_i64(local_tid_28170) -\n                                                            squot64(i_28179 *\n                                                                    computed_group_sizze_26319 +\n                                                                    sext_i32_i64(local_tid_28170),\n                                                                    9) * 9)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int64_t i_28180 = 0; i_28180 < sdiv_up64(steps_23808 * 9 -\n                                                  sext_i32_i64(local_tid_28170),\n                                                  computed_group_sizze_26319);\n         i_28180++) {\n        ((__global float *) mem_27760)[gtid_26317 * (9 * steps_23808) +\n                                       squot64(i_28180 *\n                                               computed_group_sizze_26319 +\n                                               sext_i32_i64(local_tid_28170),\n                                               9) * 9 + (i_28180 *",
                   "\n                                                         computed_group_sizze_26319 +\n                                                         sext_i32_i64(local_tid_28170) -\n                                                         squot64(i_28180 *\n                                                                 computed_group_sizze_26319 +\n                                                                 sext_i32_i64(local_tid_28170),\n                                                                 9) * 9)] =\n            ((__local float *) mem_27752)[squot64(i_28180 *\n                                                  computed_group_sizze_26319 +\n                                                  sext_i32_i64(local_tid_28170),\n                                                  9) * 9 + (i_28180 *\n                                                            computed_group_sizze_26319 +\n                                                            sext_i32_i64(local_tid_28170) -\n                                                            squot64(i_28180 *\n                                                                    computed_group_sizze_26319 +\n                                                                    sext_i32_i64(local_tid_28170),\n                                                                    9) * 9)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n  error_3:\n    return;\n}\n__kernel void testzisegred_large_27326(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_28808_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_28806_backing_aligned_1,\n                                       int64_t paths_23807, int64_t steps_23808,\n                                       int64_t num_groups_27433, __global\n                                       unsigned char *mem_27860, __global\n         ",
                   "                              unsigned char *mem_27863,\n                                       int64_t groups_per_segment_28792,\n                                       int64_t elements_per_thread_28793,\n                                       int64_t virt_num_groups_28794,\n                                       int64_t threads_per_segment_28796,\n                                       __global\n                                       unsigned char *group_res_arr_mem_28797,\n                                       __global\n                                       unsigned char *testzicounter_mem_28799)\n{\n    #define segred_group_sizze_27432 (testzisegred_group_sizze_27320)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_28808_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_28808_backing_aligned_0;\n    __local volatile char *restrict red_arr_mem_28806_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28806_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28801;\n    int32_t local_tid_28802;\n    int64_t group_sizze_28805;\n    int32_t wave_sizze_28804;\n    int32_t group_tid_28803;\n    \n    global_tid_28801 = get_global_id(0);\n    local_tid_28802 = get_local_id(0);\n    group_sizze_28805 = get_local_size(0);\n    wave_sizze_28804 = LOCKSTEP_WIDTH;\n    group_tid_28803 = get_group_id(0);\n    \n    int32_t phys_tid_27326;\n    \n    phys_tid_27326 = global_tid_28801;\n    \n    __local char *red_arr_mem_28806;\n    \n    red_arr_mem_28806 = (__local char *) red_arr_mem_28806_backing_0;\n    \n    __local char *sync_arr_mem_28808;\n    \n    sync_arr_mem_28808 = (__local char *) sync_arr_mem_28808_backing_1;\n    \n    int32_t phys_group_id_28810;\n    \n    phys_group_id_28810 = get_group_id(0);\n    for (int32_t i_28811 = 0; i_28811 <\n         sdiv_u",
                   "p32(sext_i64_i32(virt_num_groups_28794) - phys_group_id_28810,\n                   sext_i64_i32(num_groups_27433)); i_28811++) {\n        int32_t virt_group_id_28812 = phys_group_id_28810 + i_28811 *\n                sext_i64_i32(num_groups_27433);\n        int32_t flat_segment_id_28813 = squot32(virt_group_id_28812,\n                                                sext_i64_i32(groups_per_segment_28792));\n        int64_t global_tid_28814 = srem64(sext_i32_i64(virt_group_id_28812) *\n                                          segred_group_sizze_27432 +\n                                          sext_i32_i64(local_tid_28802),\n                                          segred_group_sizze_27432 *\n                                          groups_per_segment_28792);\n        int64_t gtid_27317 = sext_i32_i64(flat_segment_id_28813);\n        int64_t gtid_27325;\n        float x_acc_28815;\n        int64_t chunk_sizze_28816;\n        \n        chunk_sizze_28816 = smin64(elements_per_thread_28793,\n                                   sdiv_up64(paths_23807 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_28814)),\n                                             threads_per_segment_28796));\n        \n        float x_27436;\n        float x_27437;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_28815 = 0.0F;\n        }\n        for (int64_t i_28820 = 0; i_28820 < chunk_sizze_28816; i_28820++) {\n            gtid_27325 = sext_i32_i64(sext_i64_i32(global_tid_28814)) +\n                threads_per_segment_28796 * i_28820;\n            // apply map function\n            {\n                float res_27441;\n                float redout_27653 = 0.0F;\n                \n                for (int32_t i_27665 = 0; i_27665 < 9; i_27665++) {\n                    int64_t i_27654 = sext_i32_i64(i_27665);\n                    float x_27445 = ((__global float *) mem_27860)[i_27654 *\n                                                                   (steps_23",
                   "808 *\n                                                                    paths_23807) +\n                                                                   gtid_27325 *\n                                                                   steps_23808 +\n                                                                   gtid_27317];\n                    float res_27444 = x_27445 + redout_27653;\n                    float redout_tmp_28821 = res_27444;\n                    \n                    redout_27653 = redout_tmp_28821;\n                }\n                res_27441 = redout_27653;\n                \n                float res_27446 = fmax32(0.0F, res_27441);\n                \n                // save map-out results\n                { }\n                // load accumulator\n                {\n                    x_27436 = x_acc_28815;\n                }\n                // load new values\n                {\n                    x_27437 = res_27446;\n                }\n                // apply reduction operator\n                {\n                    float res_27438 = x_27436 + x_27437;\n                    \n                    // store in accumulator\n                    {\n                        x_acc_28815 = res_27438;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_27436 = x_acc_28815;\n            ((__local\n              float *) red_arr_mem_28806)[sext_i32_i64(local_tid_28802)] =\n                x_27436;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_28822;\n        int32_t skip_waves_28823;\n        \n        skip_waves_28823 = 1;\n        \n        float x_28817;\n        float x_28818;\n        \n        offset_28822 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_28802,\n                      sext_i64_i32(segred_group_sizze_27432))) {\n                x_28817 = ((__local\n                         ",
                   "   float *) red_arr_mem_28806)[sext_i32_i64(local_tid_28802 +\n                                                        offset_28822)];\n            }\n        }\n        offset_28822 = 1;\n        while (slt32(offset_28822, wave_sizze_28804)) {\n            if (slt32(local_tid_28802 + offset_28822,\n                      sext_i64_i32(segred_group_sizze_27432)) &&\n                ((local_tid_28802 - squot32(local_tid_28802, wave_sizze_28804) *\n                  wave_sizze_28804) & (2 * offset_28822 - 1)) == 0) {\n                // read array element\n                {\n                    x_28818 = ((volatile __local\n                                float *) red_arr_mem_28806)[sext_i32_i64(local_tid_28802 +\n                                                            offset_28822)];\n                }\n                // apply reduction operation\n                {\n                    float res_28819 = x_28817 + x_28818;\n                    \n                    x_28817 = res_28819;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      float *) red_arr_mem_28806)[sext_i32_i64(local_tid_28802)] =\n                        x_28817;\n                }\n            }\n            offset_28822 *= 2;\n        }\n        while (slt32(skip_waves_28823,\n                     squot32(sext_i64_i32(segred_group_sizze_27432) +\n                             wave_sizze_28804 - 1, wave_sizze_28804))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_28822 = skip_waves_28823 * wave_sizze_28804;\n            if (slt32(local_tid_28802 + offset_28822,\n                      sext_i64_i32(segred_group_sizze_27432)) &&\n                ((local_tid_28802 - squot32(local_tid_28802, wave_sizze_28804) *\n                  wave_sizze_28804) == 0 && (squot32(local_tid_28802,\n                                                     wave_sizze_28804) & (2 *\n                                                                         ",
                   " skip_waves_28823 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_28818 = ((__local\n                                float *) red_arr_mem_28806)[sext_i32_i64(local_tid_28802 +\n                                                            offset_28822)];\n                }\n                // apply reduction operation\n                {\n                    float res_28819 = x_28817 + x_28818;\n                    \n                    x_28817 = res_28819;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      float *) red_arr_mem_28806)[sext_i32_i64(local_tid_28802)] =\n                        x_28817;\n                }\n            }\n            skip_waves_28823 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_28802) == 0) {\n                x_acc_28815 = x_28817;\n            }\n        }\n        if (groups_per_segment_28792 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_28802 == 0) {\n                    ((__global float *) mem_27863)[gtid_27317] = x_acc_28815;\n                }\n            }\n        } else {\n            int32_t old_counter_28824;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_28802 == 0) {\n                    ((__global\n                      float *) group_res_arr_mem_28797)[sext_i32_i64(virt_group_id_28812) *\n                                                        segred_group_sizze_27432] =\n                        x_acc_28815;\n                    mem_fence_global();\n                    old_counter_28824 =\n                        atomic_add_i32_global(&((volatile __global\n                  ",
                   "                               int *) testzicounter_mem_28799)[sext_i32_i64(srem32(flat_segment_id_28813,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_28808)[0] =\n                        old_counter_28824 == groups_per_segment_28792 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_28825;\n            \n            is_last_group_28825 = ((__local bool *) sync_arr_mem_28808)[0];\n            if (is_last_group_28825) {\n                if (local_tid_28802 == 0) {\n                    old_counter_28824 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_28799)[sext_i32_i64(srem32(flat_segment_id_28813,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_28792));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_28826 =\n                            sdiv_up64(groups_per_segment_28792,\n                                      segred_group_sizze_27432);\n                    \n                    x_27436 = 0.0F;\n                    for (int64_t i_28827 = 0; i_28827 < read_per_thread_28826;\n                         i_28827++) {\n                        int64_t group_res_id_28828 =\n                                sext_i32_i64(local_tid_28802) *\n                                read_per_thread_28826 + i_28827;\n                        int64_t index_of_group_res_28829 =\n                                sext_i32_i64(flat_segment_id_28813) *\n                                groups",
                   "_per_segment_28792 + group_res_id_28828;\n                        \n                        if (slt64(group_res_id_28828,\n                                  groups_per_segment_28792)) {\n                            x_27437 = ((__global\n                                        float *) group_res_arr_mem_28797)[index_of_group_res_28829 *\n                                                                          segred_group_sizze_27432];\n                            \n                            float res_27438;\n                            \n                            res_27438 = x_27436 + x_27437;\n                            x_27436 = res_27438;\n                        }\n                    }\n                }\n                ((__local\n                  float *) red_arr_mem_28806)[sext_i32_i64(local_tid_28802)] =\n                    x_27436;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_28830;\n                    int32_t skip_waves_28831;\n                    \n                    skip_waves_28831 = 1;\n                    \n                    float x_28817;\n                    float x_28818;\n                    \n                    offset_28830 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_28802,\n                                  sext_i64_i32(segred_group_sizze_27432))) {\n                            x_28817 = ((__local\n                                        float *) red_arr_mem_28806)[sext_i32_i64(local_tid_28802 +\n                                                                    offset_28830)];\n                        }\n                    }\n                    offset_28830 = 1;\n                    while (slt32(offset_28830, wave_sizze_28804)) {\n                        if (slt32(local_tid_28802 + offset_28830,\n                                  sext_i64_i32(segred_group_sizze_27432",
                   ")) &&\n                            ((local_tid_28802 - squot32(local_tid_28802,\n                                                        wave_sizze_28804) *\n                              wave_sizze_28804) & (2 * offset_28830 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_28818 = ((volatile __local\n                                            float *) red_arr_mem_28806)[sext_i32_i64(local_tid_28802 +\n                                                                        offset_28830)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_28819 = x_28817 + x_28818;\n                                \n                                x_28817 = res_28819;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_28806)[sext_i32_i64(local_tid_28802)] =\n                                    x_28817;\n                            }\n                        }\n                        offset_28830 *= 2;\n                    }\n                    while (slt32(skip_waves_28831,\n                                 squot32(sext_i64_i32(segred_group_sizze_27432) +\n                                         wave_sizze_28804 - 1,\n                                         wave_sizze_28804))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_28830 = skip_waves_28831 * wave_sizze_28804;\n                        if (slt32(local_tid_28802 + offset_28830,\n                                  sext_i64_i32(segred_group_sizze_27432)) &&\n                            ((local_tid_28802 - squot32(local_tid_28802,\n                                                        wave_sizze_28804) *\n                     ",
                   "         wave_sizze_28804) == 0 &&\n                             (squot32(local_tid_28802, wave_sizze_28804) & (2 *\n                                                                            skip_waves_28831 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_28818 = ((__local\n                                            float *) red_arr_mem_28806)[sext_i32_i64(local_tid_28802 +\n                                                                        offset_28830)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_28819 = x_28817 + x_28818;\n                                \n                                x_28817 = res_28819;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  float *) red_arr_mem_28806)[sext_i32_i64(local_tid_28802)] =\n                                    x_28817;\n                            }\n                        }\n                        skip_waves_28831 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_28802 == 0) {\n                            ((__global float *) mem_27863)[gtid_27317] =\n                                x_28817;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27432\n}\n__kernel void testzisegred_large_28391(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_",
                   "arr_mem_28429_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_28427_backing_aligned_1,\n                                       int64_t res_24008,\n                                       int64_t num_groups_27065, __global\n                                       unsigned char *mem_27810,\n                                       int32_t num_subhistos_28305, __global\n                                       unsigned char *res_subhistos_mem_28306,\n                                       int64_t groups_per_segment_28413,\n                                       int64_t elements_per_thread_28414,\n                                       int64_t virt_num_groups_28415,\n                                       int64_t threads_per_segment_28417,\n                                       __global\n                                       unsigned char *group_res_arr_mem_28418,\n                                       __global\n                                       unsigned char *testzicounter_mem_28420)\n{\n    #define seghist_group_sizze_27063 (testziseghist_group_sizze_27062)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_28429_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_28429_backing_aligned_0;\n    __local volatile char *restrict red_arr_mem_28427_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28427_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28422;\n    int32_t local_tid_28423;\n    int64_t group_sizze_28426;\n    int32_t wave_sizze_28425;\n    int32_t group_tid_28424;\n    \n    global_tid_28422 = get_global_id(0);\n    local_tid_28423 = get_local_id(0);\n    group_sizze_28426 = get_local_size(0);\n    wave_sizze_28425 = LOCKSTEP_WIDTH;\n    group_tid_28424 =",
                   " get_group_id(0);\n    \n    int32_t flat_gtid_28391;\n    \n    flat_gtid_28391 = global_tid_28422;\n    \n    __local char *red_arr_mem_28427;\n    \n    red_arr_mem_28427 = (__local char *) red_arr_mem_28427_backing_0;\n    \n    __local char *sync_arr_mem_28429;\n    \n    sync_arr_mem_28429 = (__local char *) sync_arr_mem_28429_backing_1;\n    \n    int32_t phys_group_id_28431;\n    \n    phys_group_id_28431 = get_group_id(0);\n    for (int32_t i_28432 = 0; i_28432 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_28415) - phys_group_id_28431,\n                   sext_i64_i32(num_groups_27065)); i_28432++) {\n        int32_t virt_group_id_28433 = phys_group_id_28431 + i_28432 *\n                sext_i64_i32(num_groups_27065);\n        int32_t flat_segment_id_28434 = squot32(virt_group_id_28433,\n                                                sext_i64_i32(groups_per_segment_28413));\n        int64_t global_tid_28435 = srem64(sext_i32_i64(virt_group_id_28433) *\n                                          seghist_group_sizze_27063 +\n                                          sext_i32_i64(local_tid_28423),\n                                          seghist_group_sizze_27063 *\n                                          groups_per_segment_28413);\n        int64_t bucket_id_28389 = sext_i32_i64(flat_segment_id_28434);\n        int64_t subhistogram_id_28390;\n        int64_t x_acc_28436;\n        int64_t chunk_sizze_28437;\n        \n        chunk_sizze_28437 = smin64(elements_per_thread_28414,\n                                   sdiv_up64(num_subhistos_28305 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_28435)),\n                                             threads_per_segment_28417));\n        \n        int64_t x_27069;\n        int64_t x_27070;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_28436 = 0;\n        }\n        for (int64_t i_28441 = 0; i_28441 < chunk_sizze_28437; i_28441++) {\n            subhistogram_id_28390 =\n        ",
                   "        sext_i32_i64(sext_i64_i32(global_tid_28435)) +\n                threads_per_segment_28417 * i_28441;\n            // apply map function\n            {\n                // load accumulator\n                {\n                    x_27069 = x_acc_28436;\n                }\n                // load new values\n                {\n                    x_27070 = ((__global\n                                int64_t *) res_subhistos_mem_28306)[subhistogram_id_28390 *\n                                                                    res_24008 +\n                                                                    bucket_id_28389];\n                }\n                // apply reduction operator\n                {\n                    int64_t res_27071 = smax64(x_27069, x_27070);\n                    \n                    // store in accumulator\n                    {\n                        x_acc_28436 = res_27071;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_27069 = x_acc_28436;\n            ((__local\n              int64_t *) red_arr_mem_28427)[sext_i32_i64(local_tid_28423)] =\n                x_27069;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_28442;\n        int32_t skip_waves_28443;\n        \n        skip_waves_28443 = 1;\n        \n        int64_t x_28438;\n        int64_t x_28439;\n        \n        offset_28442 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_28423,\n                      sext_i64_i32(seghist_group_sizze_27063))) {\n                x_28438 = ((__local\n                            int64_t *) red_arr_mem_28427)[sext_i32_i64(local_tid_28423 +\n                                                          offset_28442)];\n            }\n        }\n        offset_28442 = 1;\n        while (slt32(offset_28442, wave_sizze_28425)) {\n            if (slt32(local_tid_28423 + offset_28442,\n       ",
                   "               sext_i64_i32(seghist_group_sizze_27063)) &&\n                ((local_tid_28423 - squot32(local_tid_28423, wave_sizze_28425) *\n                  wave_sizze_28425) & (2 * offset_28442 - 1)) == 0) {\n                // read array element\n                {\n                    x_28439 = ((volatile __local\n                                int64_t *) red_arr_mem_28427)[sext_i32_i64(local_tid_28423 +\n                                                              offset_28442)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_28440 = smax64(x_28438, x_28439);\n                    \n                    x_28438 = res_28440;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      int64_t *) red_arr_mem_28427)[sext_i32_i64(local_tid_28423)] =\n                        x_28438;\n                }\n            }\n            offset_28442 *= 2;\n        }\n        while (slt32(skip_waves_28443,\n                     squot32(sext_i64_i32(seghist_group_sizze_27063) +\n                             wave_sizze_28425 - 1, wave_sizze_28425))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_28442 = skip_waves_28443 * wave_sizze_28425;\n            if (slt32(local_tid_28423 + offset_28442,\n                      sext_i64_i32(seghist_group_sizze_27063)) &&\n                ((local_tid_28423 - squot32(local_tid_28423, wave_sizze_28425) *\n                  wave_sizze_28425) == 0 && (squot32(local_tid_28423,\n                                                     wave_sizze_28425) & (2 *\n                                                                          skip_waves_28443 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_28439 = ((__local\n                                int64_t *) red_arr_mem_28427)[s",
                   "ext_i32_i64(local_tid_28423 +\n                                                              offset_28442)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_28440 = smax64(x_28438, x_28439);\n                    \n                    x_28438 = res_28440;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_28427)[sext_i32_i64(local_tid_28423)] =\n                        x_28438;\n                }\n            }\n            skip_waves_28443 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_28423) == 0) {\n                x_acc_28436 = x_28438;\n            }\n        }\n        if (groups_per_segment_28413 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_28423 == 0) {\n                    ((__global int64_t *) mem_27810)[bucket_id_28389] =\n                        x_acc_28436;\n                }\n            }\n        } else {\n            int32_t old_counter_28444;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_28423 == 0) {\n                    ((__global\n                      int64_t *) group_res_arr_mem_28418)[sext_i32_i64(virt_group_id_28433) *\n                                                          seghist_group_sizze_27063] =\n                        x_acc_28436;\n                    mem_fence_global();\n                    old_counter_28444 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_28420)[sext_i32_i64(srem32(flat_segment_id_28434,\n                                                                                                     10240))],\n               ",
                   "                               (int) 1);\n                    ((__local bool *) sync_arr_mem_28429)[0] =\n                        old_counter_28444 == groups_per_segment_28413 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_28445;\n            \n            is_last_group_28445 = ((__local bool *) sync_arr_mem_28429)[0];\n            if (is_last_group_28445) {\n                if (local_tid_28423 == 0) {\n                    old_counter_28444 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_28420)[sext_i32_i64(srem32(flat_segment_id_28434,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_28413));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_28446 =\n                            sdiv_up64(groups_per_segment_28413,\n                                      seghist_group_sizze_27063);\n                    \n                    x_27069 = 0;\n                    for (int64_t i_28447 = 0; i_28447 < read_per_thread_28446;\n                         i_28447++) {\n                        int64_t group_res_id_28448 =\n                                sext_i32_i64(local_tid_28423) *\n                                read_per_thread_28446 + i_28447;\n                        int64_t index_of_group_res_28449 =\n                                sext_i32_i64(flat_segment_id_28434) *\n                                groups_per_segment_28413 + group_res_id_28448;\n                        \n                        if (slt64(group_res_id_28448,\n                                  groups_per_segment_28413)) {\n                            x_27070 = ((__global\n  ",
                   "                                      int64_t *) group_res_arr_mem_28418)[index_of_group_res_28449 *\n                                                                            seghist_group_sizze_27063];\n                            \n                            int64_t res_27071;\n                            \n                            res_27071 = smax64(x_27069, x_27070);\n                            x_27069 = res_27071;\n                        }\n                    }\n                }\n                ((__local\n                  int64_t *) red_arr_mem_28427)[sext_i32_i64(local_tid_28423)] =\n                    x_27069;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_28450;\n                    int32_t skip_waves_28451;\n                    \n                    skip_waves_28451 = 1;\n                    \n                    int64_t x_28438;\n                    int64_t x_28439;\n                    \n                    offset_28450 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_28423,\n                                  sext_i64_i32(seghist_group_sizze_27063))) {\n                            x_28438 = ((__local\n                                        int64_t *) red_arr_mem_28427)[sext_i32_i64(local_tid_28423 +\n                                                                      offset_28450)];\n                        }\n                    }\n                    offset_28450 = 1;\n                    while (slt32(offset_28450, wave_sizze_28425)) {\n                        if (slt32(local_tid_28423 + offset_28450,\n                                  sext_i64_i32(seghist_group_sizze_27063)) &&\n                            ((local_tid_28423 - squot32(local_tid_28423,\n                                                        wave_sizze_28425) *\n                              wave_sizze_28425) & (2 ",
                   "* offset_28450 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_28439 = ((volatile __local\n                                            int64_t *) red_arr_mem_28427)[sext_i32_i64(local_tid_28423 +\n                                                                          offset_28450)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_28440 = smax64(x_28438, x_28439);\n                                \n                                x_28438 = res_28440;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_28427)[sext_i32_i64(local_tid_28423)] =\n                                    x_28438;\n                            }\n                        }\n                        offset_28450 *= 2;\n                    }\n                    while (slt32(skip_waves_28451,\n                                 squot32(sext_i64_i32(seghist_group_sizze_27063) +\n                                         wave_sizze_28425 - 1,\n                                         wave_sizze_28425))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_28450 = skip_waves_28451 * wave_sizze_28425;\n                        if (slt32(local_tid_28423 + offset_28450,\n                                  sext_i64_i32(seghist_group_sizze_27063)) &&\n                            ((local_tid_28423 - squot32(local_tid_28423,\n                                                        wave_sizze_28425) *\n                              wave_sizze_28425) == 0 &&\n                             (squot32(local_tid_28423, wave_sizze_28425) & (2 *\n                                                                            ",
                   "skip_waves_28451 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_28439 = ((__local\n                                            int64_t *) red_arr_mem_28427)[sext_i32_i64(local_tid_28423 +\n                                                                          offset_28450)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_28440 = smax64(x_28438, x_28439);\n                                \n                                x_28438 = res_28440;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  int64_t *) red_arr_mem_28427)[sext_i32_i64(local_tid_28423)] =\n                                    x_28438;\n                            }\n                        }\n                        skip_waves_28451 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_28423 == 0) {\n                            ((__global int64_t *) mem_27810)[bucket_id_28389] =\n                                x_28438;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_27063\n}\n__kernel void testzisegred_nonseg_25931(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28075_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28073_backing_",
                   "aligned_1,\n                                        int64_t num_groups_25926, __global\n                                        unsigned char *mem_27671, __global\n                                        unsigned char *mem_27673, __global\n                                        unsigned char *mem_27676, __global\n                                        unsigned char *testzicounter_mem_28063,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28065,\n                                        int64_t num_threads_28067)\n{\n    #define segred_group_sizze_25924 (testzisegred_group_sizze_25923)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28075_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28075_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28073_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28073_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28068;\n    int32_t local_tid_28069;\n    int64_t group_sizze_28072;\n    int32_t wave_sizze_28071;\n    int32_t group_tid_28070;\n    \n    global_tid_28068 = get_global_id(0);\n    local_tid_28069 = get_local_id(0);\n    group_sizze_28072 = get_local_size(0);\n    wave_sizze_28071 = LOCKSTEP_WIDTH;\n    group_tid_28070 = get_group_id(0);\n    \n    int32_t phys_tid_25931;\n    \n    phys_tid_25931 = global_tid_28068;\n    \n    __local char *sync_arr_mem_28073;\n    \n    sync_arr_mem_28073 = (__local char *) sync_arr_mem_28073_backing_0;\n    \n    __local char *red_arr_mem_28075;\n    \n    red_arr_mem_28075 = (__local char *) red_arr_mem_28075_backing_1;\n    \n    int64_t dummy_25929;\n    \n    dummy_25929 = 0;\n    \n    int64_t gtid_25930;\n    \n    gtid_25930 = 0;\n    \n    float x_acc_28077;\n    int64_t chunk",
                   "_sizze_28078;\n    \n    chunk_sizze_28078 = smin64(sdiv_up64(9,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_25924 *\n                                         num_groups_25926))), sdiv_up64(9 -\n                                                                        sext_i32_i64(phys_tid_25931),\n                                                                        num_threads_28067));\n    \n    float x_23813;\n    float x_23814;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28077 = -INFINITY;\n    }\n    for (int64_t i_28082 = 0; i_28082 < chunk_sizze_28078; i_28082++) {\n        gtid_25930 = sext_i32_i64(phys_tid_25931) + num_threads_28067 * i_28082;\n        // apply map function\n        {\n            float x_23816 = ((__global float *) mem_27673)[gtid_25930];\n            int64_t x_23817 = ((__global int64_t *) mem_27671)[gtid_25930];\n            float res_23818 = sitofp_i64_f32(x_23817);\n            float res_23819 = x_23816 * res_23818;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_23813 = x_acc_28077;\n            }\n            // load new values\n            {\n                x_23814 = res_23819;\n            }\n            // apply reduction operator\n            {\n                float res_23815 = fmax32(x_23813, x_23814);\n                \n                // store in accumulator\n                {\n                    x_acc_28077 = res_23815;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_23813 = x_acc_28077;\n        ((__local float *) red_arr_mem_28075)[sext_i32_i64(local_tid_28069)] =\n            x_23813;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28083;\n    int32_t skip_waves_28084;\n    \n    skip_waves_28084 = 1;\n    \n    float x_28079;\n    float x_28080;\n    \n    offset_28083 = 0;\n    // participating threads read initial a",
                   "ccumulator\n    {\n        if (slt32(local_tid_28069, sext_i64_i32(segred_group_sizze_25924))) {\n            x_28079 = ((__local\n                        float *) red_arr_mem_28075)[sext_i32_i64(local_tid_28069 +\n                                                    offset_28083)];\n        }\n    }\n    offset_28083 = 1;\n    while (slt32(offset_28083, wave_sizze_28071)) {\n        if (slt32(local_tid_28069 + offset_28083,\n                  sext_i64_i32(segred_group_sizze_25924)) && ((local_tid_28069 -\n                                                               squot32(local_tid_28069,\n                                                                       wave_sizze_28071) *\n                                                               wave_sizze_28071) &\n                                                              (2 *\n                                                               offset_28083 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28080 = ((volatile __local\n                            float *) red_arr_mem_28075)[sext_i32_i64(local_tid_28069 +\n                                                        offset_28083)];\n            }\n            // apply reduction operation\n            {\n                float res_28081 = fmax32(x_28079, x_28080);\n                \n                x_28079 = res_28081;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_28075)[sext_i32_i64(local_tid_28069)] =\n                    x_28079;\n            }\n        }\n        offset_28083 *= 2;\n    }\n    while (slt32(skip_waves_28084,\n                 squot32(sext_i64_i32(segred_group_sizze_25924) +\n                         wave_sizze_28071 - 1, wave_sizze_28071))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28083 = skip_waves_28084 * wave_sizze_28071;\n        if (slt32(local_tid_28069 + offset_2808",
                   "3,\n                  sext_i64_i32(segred_group_sizze_25924)) && ((local_tid_28069 -\n                                                               squot32(local_tid_28069,\n                                                                       wave_sizze_28071) *\n                                                               wave_sizze_28071) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28069,\n                                                                       wave_sizze_28071) &\n                                                               (2 *\n                                                                skip_waves_28084 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28080 = ((__local\n                            float *) red_arr_mem_28075)[sext_i32_i64(local_tid_28069 +\n                                                        offset_28083)];\n            }\n            // apply reduction operation\n            {\n                float res_28081 = fmax32(x_28079, x_28080);\n                \n                x_28079 = res_28081;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_28075)[sext_i32_i64(local_tid_28069)] =\n                    x_28079;\n            }\n        }\n        skip_waves_28084 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28069) == 0) {\n            x_acc_28077 = x_28079;\n        }\n    }\n    \n    int32_t old_counter_28085;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28069 == 0) {\n            ((__global\n              float *) group_res_arr_mem_28065)[sext_i32_i64(group_tid_28070) *\n                                             ",
                   "   segred_group_sizze_25924] =\n                x_acc_28077;\n            mem_fence_global();\n            old_counter_28085 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28063)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28073)[0] = old_counter_28085 ==\n                num_groups_25926 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28086;\n    \n    is_last_group_28086 = ((__local bool *) sync_arr_mem_28073)[0];\n    if (is_last_group_28086) {\n        if (local_tid_28069 == 0) {\n            old_counter_28085 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28063)[0],\n                                                      (int) (0 -\n                                                             num_groups_25926));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28087 = sdiv_up64(num_groups_25926,\n                                                      segred_group_sizze_25924);\n            \n            x_23813 = -INFINITY;\n            for (int64_t i_28088 = 0; i_28088 < read_per_thread_28087;\n                 i_28088++) {\n                int64_t group_res_id_28089 = sext_i32_i64(local_tid_28069) *\n                        read_per_thread_28087 + i_28088;\n                int64_t index_of_group_res_28090 = group_res_id_28089;\n                \n                if (slt64(group_res_id_28089, num_groups_25926)) {\n                    x_23814 = ((__global\n                                float *) group_res_arr_mem_28065)[index_of_group_res_28090 *\n                                                                  segred_group_sizze_25924];\n                    \n                    float res_23815;\n                    \n                    res_23815 = fmax32(x_238",
                   "13, x_23814);\n                    x_23813 = res_23815;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_28075)[sext_i32_i64(local_tid_28069)] =\n            x_23813;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28091;\n            int32_t skip_waves_28092;\n            \n            skip_waves_28092 = 1;\n            \n            float x_28079;\n            float x_28080;\n            \n            offset_28091 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28069,\n                          sext_i64_i32(segred_group_sizze_25924))) {\n                    x_28079 = ((__local\n                                float *) red_arr_mem_28075)[sext_i32_i64(local_tid_28069 +\n                                                            offset_28091)];\n                }\n            }\n            offset_28091 = 1;\n            while (slt32(offset_28091, wave_sizze_28071)) {\n                if (slt32(local_tid_28069 + offset_28091,\n                          sext_i64_i32(segred_group_sizze_25924)) &&\n                    ((local_tid_28069 - squot32(local_tid_28069,\n                                                wave_sizze_28071) *\n                      wave_sizze_28071) & (2 * offset_28091 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28080 = ((volatile __local\n                                    float *) red_arr_mem_28075)[sext_i32_i64(local_tid_28069 +\n                                                                offset_28091)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28081 = fmax32(x_28079, x_28080);\n                        \n                        x_28079 = res_28081;\n                    }\n                    // write result of operation\n                    {\n                   ",
                   "     ((volatile __local\n                          float *) red_arr_mem_28075)[sext_i32_i64(local_tid_28069)] =\n                            x_28079;\n                    }\n                }\n                offset_28091 *= 2;\n            }\n            while (slt32(skip_waves_28092,\n                         squot32(sext_i64_i32(segred_group_sizze_25924) +\n                                 wave_sizze_28071 - 1, wave_sizze_28071))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28091 = skip_waves_28092 * wave_sizze_28071;\n                if (slt32(local_tid_28069 + offset_28091,\n                          sext_i64_i32(segred_group_sizze_25924)) &&\n                    ((local_tid_28069 - squot32(local_tid_28069,\n                                                wave_sizze_28071) *\n                      wave_sizze_28071) == 0 && (squot32(local_tid_28069,\n                                                         wave_sizze_28071) &\n                                                 (2 * skip_waves_28092 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28080 = ((__local\n                                    float *) red_arr_mem_28075)[sext_i32_i64(local_tid_28069 +\n                                                                offset_28091)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28081 = fmax32(x_28079, x_28080);\n                        \n                        x_28079 = res_28081;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_28075)[sext_i32_i64(local_tid_28069)] =\n                            x_28079;\n                    }\n                }\n                skip_waves_28092 *= 2;\n            }\n            // and back to memory with the final result\n            {\n         ",
                   "       if (local_tid_28069 == 0) {\n                    ((__global float *) mem_27676)[0] = x_28079;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_25924\n}\n__kernel void testzisegred_nonseg_27060(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28277_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28275_backing_aligned_1,\n                                        int64_t num_groups_27055,\n                                        int64_t binop_x_27755, __global\n                                        unsigned char *mem_27805, __global\n                                        unsigned char *mem_27808, __global\n                                        unsigned char *testzicounter_mem_28265,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28267,\n                                        int64_t num_threads_28269)\n{\n    #define segred_group_sizze_27053 (testzisegred_group_sizze_27052)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28277_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28277_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28275_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28275_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28270;\n    int32_t local_tid_28271;\n    int64_t group_sizze_28274;\n    int32_t wave_sizze_28273;\n    int32_t group_tid_28272;\n    \n    global_tid_28270 = get_global_id(0);\n    local_tid_28271 = get_local_id(0);\n    group_sizze_28274 = get_local_size(0);",
                   "\n    wave_sizze_28273 = LOCKSTEP_WIDTH;\n    group_tid_28272 = get_group_id(0);\n    \n    int32_t phys_tid_27060;\n    \n    phys_tid_27060 = global_tid_28270;\n    \n    __local char *sync_arr_mem_28275;\n    \n    sync_arr_mem_28275 = (__local char *) sync_arr_mem_28275_backing_0;\n    \n    __local char *red_arr_mem_28277;\n    \n    red_arr_mem_28277 = (__local char *) red_arr_mem_28277_backing_1;\n    \n    int64_t dummy_27058;\n    \n    dummy_27058 = 0;\n    \n    int64_t gtid_27059;\n    \n    gtid_27059 = 0;\n    \n    int64_t x_acc_28279;\n    int64_t chunk_sizze_28280;\n    \n    chunk_sizze_28280 = smin64(sdiv_up64(binop_x_27755,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_27053 *\n                                         num_groups_27055))),\n                               sdiv_up64(binop_x_27755 -\n                                         sext_i32_i64(phys_tid_27060),\n                                         num_threads_28269));\n    \n    int64_t x_24009;\n    int64_t x_24010;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28279 = 0;\n    }\n    for (int64_t i_28284 = 0; i_28284 < chunk_sizze_28280; i_28284++) {\n        gtid_27059 = sext_i32_i64(phys_tid_27060) + num_threads_28269 * i_28284;\n        // apply map function\n        {\n            int64_t x_24012 = ((__global int64_t *) mem_27805)[gtid_27059];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_24009 = x_acc_28279;\n            }\n            // load new values\n            {\n                x_24010 = x_24012;\n            }\n            // apply reduction operator\n            {\n                int64_t res_24011 = add64(x_24009, x_24010);\n                \n                // store in accumulator\n                {\n                    x_acc_28279 = res_24011;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_24009 ",
                   "= x_acc_28279;\n        ((__local int64_t *) red_arr_mem_28277)[sext_i32_i64(local_tid_28271)] =\n            x_24009;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28285;\n    int32_t skip_waves_28286;\n    \n    skip_waves_28286 = 1;\n    \n    int64_t x_28281;\n    int64_t x_28282;\n    \n    offset_28285 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28271, sext_i64_i32(segred_group_sizze_27053))) {\n            x_28281 = ((__local\n                        int64_t *) red_arr_mem_28277)[sext_i32_i64(local_tid_28271 +\n                                                      offset_28285)];\n        }\n    }\n    offset_28285 = 1;\n    while (slt32(offset_28285, wave_sizze_28273)) {\n        if (slt32(local_tid_28271 + offset_28285,\n                  sext_i64_i32(segred_group_sizze_27053)) && ((local_tid_28271 -\n                                                               squot32(local_tid_28271,\n                                                                       wave_sizze_28273) *\n                                                               wave_sizze_28273) &\n                                                              (2 *\n                                                               offset_28285 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28282 = ((volatile __local\n                            int64_t *) red_arr_mem_28277)[sext_i32_i64(local_tid_28271 +\n                                                          offset_28285)];\n            }\n            // apply reduction operation\n            {\n                int64_t res_28283 = add64(x_28281, x_28282);\n                \n                x_28281 = res_28283;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_28277)[sext_i32_i64(local_tid_28271)] =\n                    x_28",
                   "281;\n            }\n        }\n        offset_28285 *= 2;\n    }\n    while (slt32(skip_waves_28286,\n                 squot32(sext_i64_i32(segred_group_sizze_27053) +\n                         wave_sizze_28273 - 1, wave_sizze_28273))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28285 = skip_waves_28286 * wave_sizze_28273;\n        if (slt32(local_tid_28271 + offset_28285,\n                  sext_i64_i32(segred_group_sizze_27053)) && ((local_tid_28271 -\n                                                               squot32(local_tid_28271,\n                                                                       wave_sizze_28273) *\n                                                               wave_sizze_28273) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28271,\n                                                                       wave_sizze_28273) &\n                                                               (2 *\n                                                                skip_waves_28286 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28282 = ((__local\n                            int64_t *) red_arr_mem_28277)[sext_i32_i64(local_tid_28271 +\n                                                          offset_28285)];\n            }\n            // apply reduction operation\n            {\n                int64_t res_28283 = add64(x_28281, x_28282);\n                \n                x_28281 = res_28283;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_28277)[sext_i32_i64(local_tid_28271)] =\n                    x_28281;\n            }\n        }\n        skip_waves_28286 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (s",
                   "ext_i32_i64(local_tid_28271) == 0) {\n            x_acc_28279 = x_28281;\n        }\n    }\n    \n    int32_t old_counter_28287;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28271 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_28267)[sext_i32_i64(group_tid_28272) *\n                                                  segred_group_sizze_27053] =\n                x_acc_28279;\n            mem_fence_global();\n            old_counter_28287 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28265)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28275)[0] = old_counter_28287 ==\n                num_groups_27055 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28288;\n    \n    is_last_group_28288 = ((__local bool *) sync_arr_mem_28275)[0];\n    if (is_last_group_28288) {\n        if (local_tid_28271 == 0) {\n            old_counter_28287 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28265)[0],\n                                                      (int) (0 -\n                                                             num_groups_27055));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28289 = sdiv_up64(num_groups_27055,\n                                                      segred_group_sizze_27053);\n            \n            x_24009 = 0;\n            for (int64_t i_28290 = 0; i_28290 < read_per_thread_28289;\n                 i_28290++) {\n                int64_t group_res_id_28291 = sext_i32_i64(local_tid_28271) *\n                        read_per_thread_28289 + i_28290;\n                int64_t index_of_group_res_28292 = group_res_id_28291;\n                \n                if (slt64(group_res_i",
                   "d_28291, num_groups_27055)) {\n                    x_24010 = ((__global\n                                int64_t *) group_res_arr_mem_28267)[index_of_group_res_28292 *\n                                                                    segred_group_sizze_27053];\n                    \n                    int64_t res_24011;\n                    \n                    res_24011 = add64(x_24009, x_24010);\n                    x_24009 = res_24011;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_28277)[sext_i32_i64(local_tid_28271)] =\n            x_24009;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28293;\n            int32_t skip_waves_28294;\n            \n            skip_waves_28294 = 1;\n            \n            int64_t x_28281;\n            int64_t x_28282;\n            \n            offset_28293 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28271,\n                          sext_i64_i32(segred_group_sizze_27053))) {\n                    x_28281 = ((__local\n                                int64_t *) red_arr_mem_28277)[sext_i32_i64(local_tid_28271 +\n                                                              offset_28293)];\n                }\n            }\n            offset_28293 = 1;\n            while (slt32(offset_28293, wave_sizze_28273)) {\n                if (slt32(local_tid_28271 + offset_28293,\n                          sext_i64_i32(segred_group_sizze_27053)) &&\n                    ((local_tid_28271 - squot32(local_tid_28271,\n                                                wave_sizze_28273) *\n                      wave_sizze_28273) & (2 * offset_28293 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28282 = ((volatile __local\n                                    int64_t *) red_arr_mem_28277)[sext_i32_i64(local_tid_28271 +\n                          ",
                   "                                        offset_28293)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_28283 = add64(x_28281, x_28282);\n                        \n                        x_28281 = res_28283;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28277)[sext_i32_i64(local_tid_28271)] =\n                            x_28281;\n                    }\n                }\n                offset_28293 *= 2;\n            }\n            while (slt32(skip_waves_28294,\n                         squot32(sext_i64_i32(segred_group_sizze_27053) +\n                                 wave_sizze_28273 - 1, wave_sizze_28273))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28293 = skip_waves_28294 * wave_sizze_28273;\n                if (slt32(local_tid_28271 + offset_28293,\n                          sext_i64_i32(segred_group_sizze_27053)) &&\n                    ((local_tid_28271 - squot32(local_tid_28271,\n                                                wave_sizze_28273) *\n                      wave_sizze_28273) == 0 && (squot32(local_tid_28271,\n                                                         wave_sizze_28273) &\n                                                 (2 * skip_waves_28294 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28282 = ((__local\n                                    int64_t *) red_arr_mem_28277)[sext_i32_i64(local_tid_28271 +\n                                                                  offset_28293)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_28283 = add64(x_28281, x_28282);\n                        \n                        x_28281 = res_28283;\n                ",
                   "    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_28277)[sext_i32_i64(local_tid_28271)] =\n                            x_28281;\n                    }\n                }\n                skip_waves_28294 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28271 == 0) {\n                    ((__global int64_t *) mem_27808)[0] = x_28281;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27053\n}\n__kernel void testzisegred_nonseg_27169(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28738_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28736_backing_aligned_1,\n                                        int64_t paths_23807,\n                                        int64_t steps_23808,\n                                        float sims_per_year_23899,\n                                        float res_24219,\n                                        int64_t num_groups_27172, __global\n                                        unsigned char *mem_27842, __global\n                                        unsigned char *mem_27845, __global\n                                        unsigned char *testzicounter_mem_28726,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28728,\n                                        int64_t num_threads_28730)\n{\n    #define segred_group_sizze_27171 (testzisegred_group_sizze_27161)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28738_backing_1 =\n                          (__local vol",
                   "atile\n                           char *) red_arr_mem_28738_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28736_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28736_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28731;\n    int32_t local_tid_28732;\n    int64_t group_sizze_28735;\n    int32_t wave_sizze_28734;\n    int32_t group_tid_28733;\n    \n    global_tid_28731 = get_global_id(0);\n    local_tid_28732 = get_local_id(0);\n    group_sizze_28735 = get_local_size(0);\n    wave_sizze_28734 = LOCKSTEP_WIDTH;\n    group_tid_28733 = get_group_id(0);\n    \n    int32_t phys_tid_27169;\n    \n    phys_tid_27169 = global_tid_28731;\n    \n    __local char *sync_arr_mem_28736;\n    \n    sync_arr_mem_28736 = (__local char *) sync_arr_mem_28736_backing_0;\n    \n    __local char *red_arr_mem_28738;\n    \n    red_arr_mem_28738 = (__local char *) red_arr_mem_28738_backing_1;\n    \n    int64_t dummy_27167;\n    \n    dummy_27167 = 0;\n    \n    int64_t gtid_27168;\n    \n    gtid_27168 = 0;\n    \n    float x_acc_28740;\n    int64_t chunk_sizze_28741;\n    \n    chunk_sizze_28741 = smin64(sdiv_up64(steps_23808,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_27171 *\n                                         num_groups_27172))),\n                               sdiv_up64(steps_23808 -\n                                         sext_i32_i64(phys_tid_27169),\n                                         num_threads_28730));\n    \n    float x_27175;\n    float x_27176;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28740 = 0.0F;\n    }\n    for (int64_t i_28745 = 0; i_28745 < chunk_sizze_28741; i_28745++) {\n        gtid_27168 = sext_i32_i64(phys_tid_27169) + num_threads_28730 * i_28745;\n        // apply map function\n        {\n            int64_t convop_x_27583 = add64(1, gtid_27168);\n            float binop_x_27584 = sitofp_i64_f32(convop_x_",
                   "27583);\n            float index_primexp_27585 = binop_x_27584 / sims_per_year_23899;\n            float res_27180;\n            float redout_27645 = 0.0F;\n            \n            for (int64_t i_27646 = 0; i_27646 < paths_23807; i_27646++) {\n                float res_27185;\n                float redout_27647 = 0.0F;\n                \n                for (int32_t i_27663 = 0; i_27663 < 9; i_27663++) {\n                    int64_t i_27648 = sext_i32_i64(i_27663);\n                    float x_27189 = ((__global float *) mem_27842)[i_27646 *\n                                                                   (steps_23808 *\n                                                                    9) +\n                                                                   i_27648 *\n                                                                   steps_23808 +\n                                                                   gtid_27168];\n                    float res_27188 = x_27189 + redout_27647;\n                    float redout_tmp_28747 = res_27188;\n                    \n                    redout_27647 = redout_tmp_28747;\n                }\n                res_27185 = redout_27647;\n                \n                float res_27190 = fmax32(0.0F, res_27185);\n                float res_27183 = res_27190 + redout_27645;\n                float redout_tmp_28746 = res_27183;\n                \n                redout_27645 = redout_tmp_28746;\n            }\n            res_27180 = redout_27645;\n            \n            float res_27191 = res_27180 / res_24219;\n            float negate_arg_27192 = 1.0e-2F * index_primexp_27585;\n            float exp_arg_27193 = 0.0F - negate_arg_27192;\n            float res_27194 = fpow32(2.7182817F, exp_arg_27193);\n            float x_27195 = 1.0F - res_27194;\n            float B_27196 = x_27195 / 1.0e-2F;\n            float x_27197 = B_27196 - index_primexp_27585;\n            float x_27198 = 4.4999997e-6F * x_27197;\n            float A1_27199 = x_27198 / 1.0e-4F;",
                   "\n            float y_27200 = fpow32(B_27196, 2.0F);\n            float x_27201 = 1.0000001e-6F * y_27200;\n            float A2_27202 = x_27201 / 4.0e-2F;\n            float exp_arg_27203 = A1_27199 - A2_27202;\n            float res_27204 = fpow32(2.7182817F, exp_arg_27203);\n            float negate_arg_27205 = 5.0e-2F * B_27196;\n            float exp_arg_27206 = 0.0F - negate_arg_27205;\n            float res_27207 = fpow32(2.7182817F, exp_arg_27206);\n            float res_27208 = res_27204 * res_27207;\n            float res_27209 = res_27191 * res_27208;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_27175 = x_acc_28740;\n            }\n            // load new values\n            {\n                x_27176 = res_27209;\n            }\n            // apply reduction operator\n            {\n                float res_27177 = x_27175 + x_27176;\n                \n                // store in accumulator\n                {\n                    x_acc_28740 = res_27177;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_27175 = x_acc_28740;\n        ((__local float *) red_arr_mem_28738)[sext_i32_i64(local_tid_28732)] =\n            x_27175;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28748;\n    int32_t skip_waves_28749;\n    \n    skip_waves_28749 = 1;\n    \n    float x_28742;\n    float x_28743;\n    \n    offset_28748 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28732, sext_i64_i32(segred_group_sizze_27171))) {\n            x_28742 = ((__local\n                        float *) red_arr_mem_28738)[sext_i32_i64(local_tid_28732 +\n                                                    offset_28748)];\n        }\n    }\n    offset_28748 = 1;\n    while (slt32(offset_28748, wave_sizze_28734)) {\n        if (slt32(local_tid_28732 + offset_28748,\n                  sext_i64_i32(segred_gro",
                   "up_sizze_27171)) && ((local_tid_28732 -\n                                                               squot32(local_tid_28732,\n                                                                       wave_sizze_28734) *\n                                                               wave_sizze_28734) &\n                                                              (2 *\n                                                               offset_28748 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28743 = ((volatile __local\n                            float *) red_arr_mem_28738)[sext_i32_i64(local_tid_28732 +\n                                                        offset_28748)];\n            }\n            // apply reduction operation\n            {\n                float res_28744 = x_28742 + x_28743;\n                \n                x_28742 = res_28744;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_28738)[sext_i32_i64(local_tid_28732)] =\n                    x_28742;\n            }\n        }\n        offset_28748 *= 2;\n    }\n    while (slt32(skip_waves_28749,\n                 squot32(sext_i64_i32(segred_group_sizze_27171) +\n                         wave_sizze_28734 - 1, wave_sizze_28734))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28748 = skip_waves_28749 * wave_sizze_28734;\n        if (slt32(local_tid_28732 + offset_28748,\n                  sext_i64_i32(segred_group_sizze_27171)) && ((local_tid_28732 -\n                                                               squot32(local_tid_28732,\n                                                                       wave_sizze_28734) *\n                                                               wave_sizze_28734) ==\n                                                              0 &&\n                                                    ",
                   "          (squot32(local_tid_28732,\n                                                                       wave_sizze_28734) &\n                                                               (2 *\n                                                                skip_waves_28749 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28743 = ((__local\n                            float *) red_arr_mem_28738)[sext_i32_i64(local_tid_28732 +\n                                                        offset_28748)];\n            }\n            // apply reduction operation\n            {\n                float res_28744 = x_28742 + x_28743;\n                \n                x_28742 = res_28744;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_28738)[sext_i32_i64(local_tid_28732)] =\n                    x_28742;\n            }\n        }\n        skip_waves_28749 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28732) == 0) {\n            x_acc_28740 = x_28742;\n        }\n    }\n    \n    int32_t old_counter_28750;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28732 == 0) {\n            ((__global\n              float *) group_res_arr_mem_28728)[sext_i32_i64(group_tid_28733) *\n                                                segred_group_sizze_27171] =\n                x_acc_28740;\n            mem_fence_global();\n            old_counter_28750 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28726)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28736)[0] = old_counter_28750 ==\n                num_groups_27172 - 1;\n        }\n    }\n    barrier(CLK_GLO",
                   "BAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28751;\n    \n    is_last_group_28751 = ((__local bool *) sync_arr_mem_28736)[0];\n    if (is_last_group_28751) {\n        if (local_tid_28732 == 0) {\n            old_counter_28750 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28726)[0],\n                                                      (int) (0 -\n                                                             num_groups_27172));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28752 = sdiv_up64(num_groups_27172,\n                                                      segred_group_sizze_27171);\n            \n            x_27175 = 0.0F;\n            for (int64_t i_28753 = 0; i_28753 < read_per_thread_28752;\n                 i_28753++) {\n                int64_t group_res_id_28754 = sext_i32_i64(local_tid_28732) *\n                        read_per_thread_28752 + i_28753;\n                int64_t index_of_group_res_28755 = group_res_id_28754;\n                \n                if (slt64(group_res_id_28754, num_groups_27172)) {\n                    x_27176 = ((__global\n                                float *) group_res_arr_mem_28728)[index_of_group_res_28755 *\n                                                                  segred_group_sizze_27171];\n                    \n                    float res_27177;\n                    \n                    res_27177 = x_27175 + x_27176;\n                    x_27175 = res_27177;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_28738)[sext_i32_i64(local_tid_28732)] =\n            x_27175;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28756;\n            int32_t skip_waves_28757;\n            \n            skip_waves_28757 = 1;\n            \n            float x_28742;\n            float x_28743;\n            \n ",
                   "           offset_28756 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28732,\n                          sext_i64_i32(segred_group_sizze_27171))) {\n                    x_28742 = ((__local\n                                float *) red_arr_mem_28738)[sext_i32_i64(local_tid_28732 +\n                                                            offset_28756)];\n                }\n            }\n            offset_28756 = 1;\n            while (slt32(offset_28756, wave_sizze_28734)) {\n                if (slt32(local_tid_28732 + offset_28756,\n                          sext_i64_i32(segred_group_sizze_27171)) &&\n                    ((local_tid_28732 - squot32(local_tid_28732,\n                                                wave_sizze_28734) *\n                      wave_sizze_28734) & (2 * offset_28756 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28743 = ((volatile __local\n                                    float *) red_arr_mem_28738)[sext_i32_i64(local_tid_28732 +\n                                                                offset_28756)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28744 = x_28742 + x_28743;\n                        \n                        x_28742 = res_28744;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_28738)[sext_i32_i64(local_tid_28732)] =\n                            x_28742;\n                    }\n                }\n                offset_28756 *= 2;\n            }\n            while (slt32(skip_waves_28757,\n                         squot32(sext_i64_i32(segred_group_sizze_27171) +\n                                 wave_sizze_28734 - 1, wave_sizze_28734))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n               ",
                   " offset_28756 = skip_waves_28757 * wave_sizze_28734;\n                if (slt32(local_tid_28732 + offset_28756,\n                          sext_i64_i32(segred_group_sizze_27171)) &&\n                    ((local_tid_28732 - squot32(local_tid_28732,\n                                                wave_sizze_28734) *\n                      wave_sizze_28734) == 0 && (squot32(local_tid_28732,\n                                                         wave_sizze_28734) &\n                                                 (2 * skip_waves_28757 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28743 = ((__local\n                                    float *) red_arr_mem_28738)[sext_i32_i64(local_tid_28732 +\n                                                                offset_28756)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28744 = x_28742 + x_28743;\n                        \n                        x_28742 = res_28744;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_28738)[sext_i32_i64(local_tid_28732)] =\n                            x_28742;\n                    }\n                }\n                skip_waves_28757 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28732 == 0) {\n                    ((__global float *) mem_27845)[0] = x_28742;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27171\n}\n__kernel void testzisegred_nonseg_27390(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28850_backing_aligned_0,\n                                        __local volatile\n               ",
                   "                         int64_t *sync_arr_mem_28848_backing_aligned_1,\n                                        int64_t steps_23808,\n                                        int64_t num_groups_27475, __global\n                                        unsigned char *res_map_acc_mem_27867,\n                                        __global unsigned char *mem_27870,\n                                        __global\n                                        unsigned char *testzicounter_mem_28838,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28840,\n                                        int64_t num_threads_28842)\n{\n    #define segred_group_sizze_27474 (testzisegred_group_sizze_27382)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28850_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28850_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28848_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28848_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28843;\n    int32_t local_tid_28844;\n    int64_t group_sizze_28847;\n    int32_t wave_sizze_28846;\n    int32_t group_tid_28845;\n    \n    global_tid_28843 = get_global_id(0);\n    local_tid_28844 = get_local_id(0);\n    group_sizze_28847 = get_local_size(0);\n    wave_sizze_28846 = LOCKSTEP_WIDTH;\n    group_tid_28845 = get_group_id(0);\n    \n    int32_t phys_tid_27390;\n    \n    phys_tid_27390 = global_tid_28843;\n    \n    __local char *sync_arr_mem_28848;\n    \n    sync_arr_mem_28848 = (__local char *) sync_arr_mem_28848_backing_0;\n    \n    __local char *red_arr_mem_28850;\n    \n    red_arr_mem_28850 = (__local char *) red_arr_mem_28850_backing_1;\n    \n    int64_t dummy_27388;\n    \n    dummy_27388 = 0;\n",
                   "    \n    int64_t gtid_27389;\n    \n    gtid_27389 = 0;\n    \n    float x_acc_28852;\n    int64_t chunk_sizze_28853;\n    \n    chunk_sizze_28853 = smin64(sdiv_up64(steps_23808,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_27474 *\n                                         num_groups_27475))),\n                               sdiv_up64(steps_23808 -\n                                         sext_i32_i64(phys_tid_27390),\n                                         num_threads_28842));\n    \n    float x_27478;\n    float x_27479;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28852 = 0.0F;\n    }\n    for (int64_t i_28857 = 0; i_28857 < chunk_sizze_28853; i_28857++) {\n        gtid_27389 = sext_i32_i64(phys_tid_27390) + num_threads_28842 * i_28857;\n        // apply map function\n        {\n            float x_27481 = ((__global\n                              float *) res_map_acc_mem_27867)[gtid_27389];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_27478 = x_acc_28852;\n            }\n            // load new values\n            {\n                x_27479 = x_27481;\n            }\n            // apply reduction operator\n            {\n                float res_27480 = x_27478 + x_27479;\n                \n                // store in accumulator\n                {\n                    x_acc_28852 = res_27480;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_27478 = x_acc_28852;\n        ((__local float *) red_arr_mem_28850)[sext_i32_i64(local_tid_28844)] =\n            x_27478;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28858;\n    int32_t skip_waves_28859;\n    \n    skip_waves_28859 = 1;\n    \n    float x_28854;\n    float x_28855;\n    \n    offset_28858 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28844, sext_i64_i32(s",
                   "egred_group_sizze_27474))) {\n            x_28854 = ((__local\n                        float *) red_arr_mem_28850)[sext_i32_i64(local_tid_28844 +\n                                                    offset_28858)];\n        }\n    }\n    offset_28858 = 1;\n    while (slt32(offset_28858, wave_sizze_28846)) {\n        if (slt32(local_tid_28844 + offset_28858,\n                  sext_i64_i32(segred_group_sizze_27474)) && ((local_tid_28844 -\n                                                               squot32(local_tid_28844,\n                                                                       wave_sizze_28846) *\n                                                               wave_sizze_28846) &\n                                                              (2 *\n                                                               offset_28858 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_28855 = ((volatile __local\n                            float *) red_arr_mem_28850)[sext_i32_i64(local_tid_28844 +\n                                                        offset_28858)];\n            }\n            // apply reduction operation\n            {\n                float res_28856 = x_28854 + x_28855;\n                \n                x_28854 = res_28856;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_28850)[sext_i32_i64(local_tid_28844)] =\n                    x_28854;\n            }\n        }\n        offset_28858 *= 2;\n    }\n    while (slt32(skip_waves_28859,\n                 squot32(sext_i64_i32(segred_group_sizze_27474) +\n                         wave_sizze_28846 - 1, wave_sizze_28846))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28858 = skip_waves_28859 * wave_sizze_28846;\n        if (slt32(local_tid_28844 + offset_28858,\n                  sext_i64_i32(segred_group_sizze_27474)) && ((local_t",
                   "id_28844 -\n                                                               squot32(local_tid_28844,\n                                                                       wave_sizze_28846) *\n                                                               wave_sizze_28846) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28844,\n                                                                       wave_sizze_28846) &\n                                                               (2 *\n                                                                skip_waves_28859 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_28855 = ((__local\n                            float *) red_arr_mem_28850)[sext_i32_i64(local_tid_28844 +\n                                                        offset_28858)];\n            }\n            // apply reduction operation\n            {\n                float res_28856 = x_28854 + x_28855;\n                \n                x_28854 = res_28856;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_28850)[sext_i32_i64(local_tid_28844)] =\n                    x_28854;\n            }\n        }\n        skip_waves_28859 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28844) == 0) {\n            x_acc_28852 = x_28854;\n        }\n    }\n    \n    int32_t old_counter_28860;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28844 == 0) {\n            ((__global\n              float *) group_res_arr_mem_28840)[sext_i32_i64(group_tid_28845) *\n                                                segred_group_sizze_27474] =\n                x_acc_28852;\n            mem_fenc",
                   "e_global();\n            old_counter_28860 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28838)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28848)[0] = old_counter_28860 ==\n                num_groups_27475 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28861;\n    \n    is_last_group_28861 = ((__local bool *) sync_arr_mem_28848)[0];\n    if (is_last_group_28861) {\n        if (local_tid_28844 == 0) {\n            old_counter_28860 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28838)[0],\n                                                      (int) (0 -\n                                                             num_groups_27475));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28862 = sdiv_up64(num_groups_27475,\n                                                      segred_group_sizze_27474);\n            \n            x_27478 = 0.0F;\n            for (int64_t i_28863 = 0; i_28863 < read_per_thread_28862;\n                 i_28863++) {\n                int64_t group_res_id_28864 = sext_i32_i64(local_tid_28844) *\n                        read_per_thread_28862 + i_28863;\n                int64_t index_of_group_res_28865 = group_res_id_28864;\n                \n                if (slt64(group_res_id_28864, num_groups_27475)) {\n                    x_27479 = ((__global\n                                float *) group_res_arr_mem_28840)[index_of_group_res_28865 *\n                                                                  segred_group_sizze_27474];\n                    \n                    float res_27480;\n                    \n                    res_27480 = x_27478 + x_27479;\n                    x_27478 = res_27480;\n                }\n            }\n     ",
                   "   }\n        ((__local float *) red_arr_mem_28850)[sext_i32_i64(local_tid_28844)] =\n            x_27478;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28866;\n            int32_t skip_waves_28867;\n            \n            skip_waves_28867 = 1;\n            \n            float x_28854;\n            float x_28855;\n            \n            offset_28866 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28844,\n                          sext_i64_i32(segred_group_sizze_27474))) {\n                    x_28854 = ((__local\n                                float *) red_arr_mem_28850)[sext_i32_i64(local_tid_28844 +\n                                                            offset_28866)];\n                }\n            }\n            offset_28866 = 1;\n            while (slt32(offset_28866, wave_sizze_28846)) {\n                if (slt32(local_tid_28844 + offset_28866,\n                          sext_i64_i32(segred_group_sizze_27474)) &&\n                    ((local_tid_28844 - squot32(local_tid_28844,\n                                                wave_sizze_28846) *\n                      wave_sizze_28846) & (2 * offset_28866 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_28855 = ((volatile __local\n                                    float *) red_arr_mem_28850)[sext_i32_i64(local_tid_28844 +\n                                                                offset_28866)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28856 = x_28854 + x_28855;\n                        \n                        x_28854 = res_28856;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_28850)[sext_i32_i64(local_ti",
                   "d_28844)] =\n                            x_28854;\n                    }\n                }\n                offset_28866 *= 2;\n            }\n            while (slt32(skip_waves_28867,\n                         squot32(sext_i64_i32(segred_group_sizze_27474) +\n                                 wave_sizze_28846 - 1, wave_sizze_28846))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28866 = skip_waves_28867 * wave_sizze_28846;\n                if (slt32(local_tid_28844 + offset_28866,\n                          sext_i64_i32(segred_group_sizze_27474)) &&\n                    ((local_tid_28844 - squot32(local_tid_28844,\n                                                wave_sizze_28846) *\n                      wave_sizze_28846) == 0 && (squot32(local_tid_28844,\n                                                         wave_sizze_28846) &\n                                                 (2 * skip_waves_28867 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_28855 = ((__local\n                                    float *) red_arr_mem_28850)[sext_i32_i64(local_tid_28844 +\n                                                                offset_28866)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_28856 = x_28854 + x_28855;\n                        \n                        x_28854 = res_28856;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_28850)[sext_i32_i64(local_tid_28844)] =\n                            x_28854;\n                    }\n                }\n                skip_waves_28867 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28844 == 0) {\n                    ((__global float *) mem_27870)[0] = x_28854;\n      ",
                   "          }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27474\n}\n__kernel void testzisegred_nonseg_27990(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28105_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28103_backing_aligned_1,\n                                        __global unsigned char *mem_27671,\n                                        __global unsigned char *mem_28002,\n                                        __global\n                                        unsigned char *testzicounter_mem_28093,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28095,\n                                        int64_t num_threads_28097)\n{\n    #define segred_num_groups_27984 (testzisegred_num_groups_27983)\n    #define segred_group_sizze_27986 (testzisegred_group_sizze_27985)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28105_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28105_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28103_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28103_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28098;\n    int32_t local_tid_28099;\n    int64_t group_sizze_28102;\n    int32_t wave_sizze_28101;\n    int32_t group_tid_28100;\n    \n    global_tid_28098 = get_global_id(0);\n    local_tid_28099 = get_local_id(0);\n    group_sizze_28102 = get_local_size(0);\n    wave_sizze_28101 = LOCKSTEP_WIDTH;\n    group_tid_28100 = get_group_id(0);\n    \n    int32_t phys_tid_27990;\n    \n    phys_t",
                   "id_27990 = global_tid_28098;\n    \n    __local char *sync_arr_mem_28103;\n    \n    sync_arr_mem_28103 = (__local char *) sync_arr_mem_28103_backing_0;\n    \n    __local char *red_arr_mem_28105;\n    \n    red_arr_mem_28105 = (__local char *) red_arr_mem_28105_backing_1;\n    \n    int64_t dummy_27988;\n    \n    dummy_27988 = 0;\n    \n    int64_t gtid_27989;\n    \n    gtid_27989 = 0;\n    \n    int64_t x_acc_28107;\n    int64_t chunk_sizze_28108;\n    \n    chunk_sizze_28108 = smin64(sdiv_up64(9,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_27986 *\n                                         segred_num_groups_27984))),\n                               sdiv_up64(9 - sext_i32_i64(phys_tid_27990),\n                                         num_threads_28097));\n    \n    int64_t x_27991;\n    int64_t y_27992;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28107 = 0;\n    }\n    for (int64_t i_28112 = 0; i_28112 < chunk_sizze_28108; i_28112++) {\n        gtid_27989 = sext_i32_i64(phys_tid_27990) + num_threads_28097 * i_28112;\n        // apply map function\n        {\n            int64_t res_27995 = ((__global int64_t *) mem_27671)[gtid_27989];\n            int64_t bytes_27996 = 4 * res_27995;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_27991 = x_acc_28107;\n            }\n            // load new values\n            {\n                y_27992 = bytes_27996;\n            }\n            // apply reduction operator\n            {\n                int64_t zz_27993 = smax64(x_27991, y_27992);\n                \n                // store in accumulator\n                {\n                    x_acc_28107 = zz_27993;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_27991 = x_acc_28107;\n        ((__local int64_t *) red_arr_mem_28105)[sext_i32_i64(local_tid_28099)] =\n            x_27991;\n    }\n    barr",
                   "ier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28113;\n    int32_t skip_waves_28114;\n    \n    skip_waves_28114 = 1;\n    \n    int64_t x_28109;\n    int64_t y_28110;\n    \n    offset_28113 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28099, sext_i64_i32(segred_group_sizze_27986))) {\n            x_28109 = ((__local\n                        int64_t *) red_arr_mem_28105)[sext_i32_i64(local_tid_28099 +\n                                                      offset_28113)];\n        }\n    }\n    offset_28113 = 1;\n    while (slt32(offset_28113, wave_sizze_28101)) {\n        if (slt32(local_tid_28099 + offset_28113,\n                  sext_i64_i32(segred_group_sizze_27986)) && ((local_tid_28099 -\n                                                               squot32(local_tid_28099,\n                                                                       wave_sizze_28101) *\n                                                               wave_sizze_28101) &\n                                                              (2 *\n                                                               offset_28113 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_28110 = ((volatile __local\n                            int64_t *) red_arr_mem_28105)[sext_i32_i64(local_tid_28099 +\n                                                          offset_28113)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_28111 = smax64(x_28109, y_28110);\n                \n                x_28109 = zz_28111;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_28105)[sext_i32_i64(local_tid_28099)] =\n                    x_28109;\n            }\n        }\n        offset_28113 *= 2;\n    }\n    while (slt32(skip_waves_28114,\n                 squot32(sext_i64_i",
                   "32(segred_group_sizze_27986) +\n                         wave_sizze_28101 - 1, wave_sizze_28101))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28113 = skip_waves_28114 * wave_sizze_28101;\n        if (slt32(local_tid_28099 + offset_28113,\n                  sext_i64_i32(segred_group_sizze_27986)) && ((local_tid_28099 -\n                                                               squot32(local_tid_28099,\n                                                                       wave_sizze_28101) *\n                                                               wave_sizze_28101) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28099,\n                                                                       wave_sizze_28101) &\n                                                               (2 *\n                                                                skip_waves_28114 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                y_28110 = ((__local\n                            int64_t *) red_arr_mem_28105)[sext_i32_i64(local_tid_28099 +\n                                                          offset_28113)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_28111 = smax64(x_28109, y_28110);\n                \n                x_28109 = zz_28111;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_28105)[sext_i32_i64(local_tid_28099)] =\n                    x_28109;\n            }\n        }\n        skip_waves_28114 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28099) == 0) {\n            x_acc_28107 = x_28109;\n        }\n    }\n    \n    int32_t old_counter_28115;\n    \n    ",
                   "// first thread in group saves group result to global memory\n    {\n        if (local_tid_28099 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_28095)[sext_i32_i64(group_tid_28100) *\n                                                  segred_group_sizze_27986] =\n                x_acc_28107;\n            mem_fence_global();\n            old_counter_28115 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28093)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28103)[0] = old_counter_28115 ==\n                segred_num_groups_27984 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28116;\n    \n    is_last_group_28116 = ((__local bool *) sync_arr_mem_28103)[0];\n    if (is_last_group_28116) {\n        if (local_tid_28099 == 0) {\n            old_counter_28115 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28093)[0],\n                                                      (int) (0 -\n                                                             segred_num_groups_27984));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28117 = sdiv_up64(segred_num_groups_27984,\n                                                      segred_group_sizze_27986);\n            \n            x_27991 = 0;\n            for (int64_t i_28118 = 0; i_28118 < read_per_thread_28117;\n                 i_28118++) {\n                int64_t group_res_id_28119 = sext_i32_i64(local_tid_28099) *\n                        read_per_thread_28117 + i_28118;\n                int64_t index_of_group_res_28120 = group_res_id_28119;\n                \n                if (slt64(group_res_id_28119, segred_num_groups_27984)) {\n                    y_27992 = ((__global\n                                in",
                   "t64_t *) group_res_arr_mem_28095)[index_of_group_res_28120 *\n                                                                    segred_group_sizze_27986];\n                    \n                    int64_t zz_27993;\n                    \n                    zz_27993 = smax64(x_27991, y_27992);\n                    x_27991 = zz_27993;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_28105)[sext_i32_i64(local_tid_28099)] =\n            x_27991;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28121;\n            int32_t skip_waves_28122;\n            \n            skip_waves_28122 = 1;\n            \n            int64_t x_28109;\n            int64_t y_28110;\n            \n            offset_28121 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28099,\n                          sext_i64_i32(segred_group_sizze_27986))) {\n                    x_28109 = ((__local\n                                int64_t *) red_arr_mem_28105)[sext_i32_i64(local_tid_28099 +\n                                                              offset_28121)];\n                }\n            }\n            offset_28121 = 1;\n            while (slt32(offset_28121, wave_sizze_28101)) {\n                if (slt32(local_tid_28099 + offset_28121,\n                          sext_i64_i32(segred_group_sizze_27986)) &&\n                    ((local_tid_28099 - squot32(local_tid_28099,\n                                                wave_sizze_28101) *\n                      wave_sizze_28101) & (2 * offset_28121 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_28110 = ((volatile __local\n                                    int64_t *) red_arr_mem_28105)[sext_i32_i64(local_tid_28099 +\n                                                                  offset_28121)];\n                    }\n                    // apply ",
                   "reduction operation\n                    {\n                        int64_t zz_28111 = smax64(x_28109, y_28110);\n                        \n                        x_28109 = zz_28111;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28105)[sext_i32_i64(local_tid_28099)] =\n                            x_28109;\n                    }\n                }\n                offset_28121 *= 2;\n            }\n            while (slt32(skip_waves_28122,\n                         squot32(sext_i64_i32(segred_group_sizze_27986) +\n                                 wave_sizze_28101 - 1, wave_sizze_28101))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28121 = skip_waves_28122 * wave_sizze_28101;\n                if (slt32(local_tid_28099 + offset_28121,\n                          sext_i64_i32(segred_group_sizze_27986)) &&\n                    ((local_tid_28099 - squot32(local_tid_28099,\n                                                wave_sizze_28101) *\n                      wave_sizze_28101) == 0 && (squot32(local_tid_28099,\n                                                         wave_sizze_28101) &\n                                                 (2 * skip_waves_28122 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        y_28110 = ((__local\n                                    int64_t *) red_arr_mem_28105)[sext_i32_i64(local_tid_28099 +\n                                                                  offset_28121)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_28111 = smax64(x_28109, y_28110);\n                        \n                        x_28109 = zz_28111;\n                    }\n                    // write result of operation\n                    {\n                        ((__loca",
                   "l\n                          int64_t *) red_arr_mem_28105)[sext_i32_i64(local_tid_28099)] =\n                            x_28109;\n                    }\n                }\n                skip_waves_28122 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28099 == 0) {\n                    ((__global int64_t *) mem_28002)[0] = x_28109;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_27984\n    #undef segred_group_sizze_27986\n}\n__kernel void testzisegred_nonseg_28022(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_28142_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_28140_backing_aligned_1,\n                                        __global unsigned char *mem_27671,\n                                        __global unsigned char *mem_28034,\n                                        __global\n                                        unsigned char *testzicounter_mem_28130,\n                                        __global\n                                        unsigned char *group_res_arr_mem_28132,\n                                        int64_t num_threads_28134)\n{\n    #define segred_num_groups_28016 (testzisegred_num_groups_28015)\n    #define segred_group_sizze_28018 (testzisegred_group_sizze_28017)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28142_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_28142_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_28140_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_28140_backing_aligned_1;\n    \n    if (*gl",
                   "obal_failure >= 0)\n        return;\n    \n    int32_t global_tid_28135;\n    int32_t local_tid_28136;\n    int64_t group_sizze_28139;\n    int32_t wave_sizze_28138;\n    int32_t group_tid_28137;\n    \n    global_tid_28135 = get_global_id(0);\n    local_tid_28136 = get_local_id(0);\n    group_sizze_28139 = get_local_size(0);\n    wave_sizze_28138 = LOCKSTEP_WIDTH;\n    group_tid_28137 = get_group_id(0);\n    \n    int32_t phys_tid_28022;\n    \n    phys_tid_28022 = global_tid_28135;\n    \n    __local char *sync_arr_mem_28140;\n    \n    sync_arr_mem_28140 = (__local char *) sync_arr_mem_28140_backing_0;\n    \n    __local char *red_arr_mem_28142;\n    \n    red_arr_mem_28142 = (__local char *) red_arr_mem_28142_backing_1;\n    \n    int64_t dummy_28020;\n    \n    dummy_28020 = 0;\n    \n    int64_t gtid_28021;\n    \n    gtid_28021 = 0;\n    \n    int64_t x_acc_28144;\n    int64_t chunk_sizze_28145;\n    \n    chunk_sizze_28145 = smin64(sdiv_up64(9,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_28018 *\n                                         segred_num_groups_28016))),\n                               sdiv_up64(9 - sext_i32_i64(phys_tid_28022),\n                                         num_threads_28134));\n    \n    int64_t x_28023;\n    int64_t y_28024;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_28144 = 0;\n    }\n    for (int64_t i_28149 = 0; i_28149 < chunk_sizze_28145; i_28149++) {\n        gtid_28021 = sext_i32_i64(phys_tid_28022) + num_threads_28134 * i_28149;\n        // apply map function\n        {\n            int64_t res_28027 = ((__global int64_t *) mem_27671)[gtid_28021];\n            int64_t bytes_28028 = 4 * res_28027;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_28023 = x_acc_28144;\n            }\n            // load new values\n            {\n                y_28024 = bytes_28028;\n            }\n            // apply reduction operator\n            {\n   ",
                   "             int64_t zz_28025 = smax64(x_28023, y_28024);\n                \n                // store in accumulator\n                {\n                    x_acc_28144 = zz_28025;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_28023 = x_acc_28144;\n        ((__local int64_t *) red_arr_mem_28142)[sext_i32_i64(local_tid_28136)] =\n            x_28023;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_28150;\n    int32_t skip_waves_28151;\n    \n    skip_waves_28151 = 1;\n    \n    int64_t x_28146;\n    int64_t y_28147;\n    \n    offset_28150 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_28136, sext_i64_i32(segred_group_sizze_28018))) {\n            x_28146 = ((__local\n                        int64_t *) red_arr_mem_28142)[sext_i32_i64(local_tid_28136 +\n                                                      offset_28150)];\n        }\n    }\n    offset_28150 = 1;\n    while (slt32(offset_28150, wave_sizze_28138)) {\n        if (slt32(local_tid_28136 + offset_28150,\n                  sext_i64_i32(segred_group_sizze_28018)) && ((local_tid_28136 -\n                                                               squot32(local_tid_28136,\n                                                                       wave_sizze_28138) *\n                                                               wave_sizze_28138) &\n                                                              (2 *\n                                                               offset_28150 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_28147 = ((volatile __local\n                            int64_t *) red_arr_mem_28142)[sext_i32_i64(local_tid_28136 +\n                                                          offset_28150)];\n            }\n            // apply reduction operation\n            {\n            ",
                   "    int64_t zz_28148 = smax64(x_28146, y_28147);\n                \n                x_28146 = zz_28148;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_28142)[sext_i32_i64(local_tid_28136)] =\n                    x_28146;\n            }\n        }\n        offset_28150 *= 2;\n    }\n    while (slt32(skip_waves_28151,\n                 squot32(sext_i64_i32(segred_group_sizze_28018) +\n                         wave_sizze_28138 - 1, wave_sizze_28138))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_28150 = skip_waves_28151 * wave_sizze_28138;\n        if (slt32(local_tid_28136 + offset_28150,\n                  sext_i64_i32(segred_group_sizze_28018)) && ((local_tid_28136 -\n                                                               squot32(local_tid_28136,\n                                                                       wave_sizze_28138) *\n                                                               wave_sizze_28138) ==\n                                                              0 &&\n                                                              (squot32(local_tid_28136,\n                                                                       wave_sizze_28138) &\n                                                               (2 *\n                                                                skip_waves_28151 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                y_28147 = ((__local\n                            int64_t *) red_arr_mem_28142)[sext_i32_i64(local_tid_28136 +\n                                                          offset_28150)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_28148 = smax64(x_28146, y_28147);\n                \n                x_28146 = zz_28148;\n            }\n            // write result of operation\n      ",
                   "      {\n                ((__local\n                  int64_t *) red_arr_mem_28142)[sext_i32_i64(local_tid_28136)] =\n                    x_28146;\n            }\n        }\n        skip_waves_28151 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_28136) == 0) {\n            x_acc_28144 = x_28146;\n        }\n    }\n    \n    int32_t old_counter_28152;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_28136 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_28132)[sext_i32_i64(group_tid_28137) *\n                                                  segred_group_sizze_28018] =\n                x_acc_28144;\n            mem_fence_global();\n            old_counter_28152 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28130)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_28140)[0] = old_counter_28152 ==\n                segred_num_groups_28016 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_28153;\n    \n    is_last_group_28153 = ((__local bool *) sync_arr_mem_28140)[0];\n    if (is_last_group_28153) {\n        if (local_tid_28136 == 0) {\n            old_counter_28152 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_28130)[0],\n                                                      (int) (0 -\n                                                             segred_num_groups_28016));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_28154 = sdiv_up64(segred_num_groups_28016,\n                                                      segred_group_sizze_28018);\n            \n            x_28023 = 0;\n            for (int64_t i_28",
                   "155 = 0; i_28155 < read_per_thread_28154;\n                 i_28155++) {\n                int64_t group_res_id_28156 = sext_i32_i64(local_tid_28136) *\n                        read_per_thread_28154 + i_28155;\n                int64_t index_of_group_res_28157 = group_res_id_28156;\n                \n                if (slt64(group_res_id_28156, segred_num_groups_28016)) {\n                    y_28024 = ((__global\n                                int64_t *) group_res_arr_mem_28132)[index_of_group_res_28157 *\n                                                                    segred_group_sizze_28018];\n                    \n                    int64_t zz_28025;\n                    \n                    zz_28025 = smax64(x_28023, y_28024);\n                    x_28023 = zz_28025;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_28142)[sext_i32_i64(local_tid_28136)] =\n            x_28023;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_28158;\n            int32_t skip_waves_28159;\n            \n            skip_waves_28159 = 1;\n            \n            int64_t x_28146;\n            int64_t y_28147;\n            \n            offset_28158 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_28136,\n                          sext_i64_i32(segred_group_sizze_28018))) {\n                    x_28146 = ((__local\n                                int64_t *) red_arr_mem_28142)[sext_i32_i64(local_tid_28136 +\n                                                              offset_28158)];\n                }\n            }\n            offset_28158 = 1;\n            while (slt32(offset_28158, wave_sizze_28138)) {\n                if (slt32(local_tid_28136 + offset_28158,\n                          sext_i64_i32(segred_group_sizze_28018)) &&\n                    ((local_tid_28136 - squot32(local_tid_28136,\n                                              ",
                   "  wave_sizze_28138) *\n                      wave_sizze_28138) & (2 * offset_28158 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_28147 = ((volatile __local\n                                    int64_t *) red_arr_mem_28142)[sext_i32_i64(local_tid_28136 +\n                                                                  offset_28158)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_28148 = smax64(x_28146, y_28147);\n                        \n                        x_28146 = zz_28148;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28142)[sext_i32_i64(local_tid_28136)] =\n                            x_28146;\n                    }\n                }\n                offset_28158 *= 2;\n            }\n            while (slt32(skip_waves_28159,\n                         squot32(sext_i64_i32(segred_group_sizze_28018) +\n                                 wave_sizze_28138 - 1, wave_sizze_28138))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_28158 = skip_waves_28159 * wave_sizze_28138;\n                if (slt32(local_tid_28136 + offset_28158,\n                          sext_i64_i32(segred_group_sizze_28018)) &&\n                    ((local_tid_28136 - squot32(local_tid_28136,\n                                                wave_sizze_28138) *\n                      wave_sizze_28138) == 0 && (squot32(local_tid_28136,\n                                                         wave_sizze_28138) &\n                                                 (2 * skip_waves_28159 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        y_28147 = ((__local\n                                    int64_t *) red_arr_mem_28142)[sext_i32_i64(local_tid_281",
                   "36 +\n                                                                  offset_28158)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_28148 = smax64(x_28146, y_28147);\n                        \n                        x_28146 = zz_28148;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_28142)[sext_i32_i64(local_tid_28136)] =\n                            x_28146;\n                    }\n                }\n                skip_waves_28159 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_28136 == 0) {\n                    ((__global int64_t *) mem_28034)[0] = x_28146;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_28016\n    #undef segred_group_sizze_28018\n}\n__kernel void testzisegred_small_27326(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *red_arr_mem_28777_backing_aligned_0,\n                                       int64_t paths_23807, int64_t steps_23808,\n                                       int64_t num_groups_27433, __global\n                                       unsigned char *mem_27860, __global\n                                       unsigned char *mem_27863,\n                                       int64_t segment_sizze_nonzzero_28770)\n{\n    #define segred_group_sizze_27432 (testzisegred_group_sizze_27320)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28777_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28777_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_t",
                   "id_28772;\n    int32_t local_tid_28773;\n    int64_t group_sizze_28776;\n    int32_t wave_sizze_28775;\n    int32_t group_tid_28774;\n    \n    global_tid_28772 = get_global_id(0);\n    local_tid_28773 = get_local_id(0);\n    group_sizze_28776 = get_local_size(0);\n    wave_sizze_28775 = LOCKSTEP_WIDTH;\n    group_tid_28774 = get_group_id(0);\n    \n    int32_t phys_tid_27326;\n    \n    phys_tid_27326 = global_tid_28772;\n    \n    __local char *red_arr_mem_28777;\n    \n    red_arr_mem_28777 = (__local char *) red_arr_mem_28777_backing_0;\n    \n    int32_t phys_group_id_28779;\n    \n    phys_group_id_28779 = get_group_id(0);\n    for (int32_t i_28780 = 0; i_28780 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(steps_23808,\n                                          squot64(segred_group_sizze_27432,\n                                                  segment_sizze_nonzzero_28770))) -\n                   phys_group_id_28779, sext_i64_i32(num_groups_27433));\n         i_28780++) {\n        int32_t virt_group_id_28781 = phys_group_id_28779 + i_28780 *\n                sext_i64_i32(num_groups_27433);\n        int64_t gtid_27317 = squot64(sext_i32_i64(local_tid_28773),\n                                     segment_sizze_nonzzero_28770) +\n                sext_i32_i64(virt_group_id_28781) *\n                squot64(segred_group_sizze_27432, segment_sizze_nonzzero_28770);\n        int64_t gtid_27325 = srem64(sext_i32_i64(local_tid_28773), paths_23807);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, paths_23807) && (slt64(gtid_27317, steps_23808) &&\n                                          slt64(sext_i32_i64(local_tid_28773),\n                                                paths_23807 *\n                                                squot64(segred_group_sizze_27432,\n                                                        segment_sizze_nonzzero_28770)))) {\n                float res_27441;\n                float redout_27653 = 0.0F;\n                \n                for (",
                   "int32_t i_27665 = 0; i_27665 < 9; i_27665++) {\n                    int64_t i_27654 = sext_i32_i64(i_27665);\n                    float x_27445 = ((__global float *) mem_27860)[i_27654 *\n                                                                   (steps_23808 *\n                                                                    paths_23807) +\n                                                                   gtid_27325 *\n                                                                   steps_23808 +\n                                                                   gtid_27317];\n                    float res_27444 = x_27445 + redout_27653;\n                    float redout_tmp_28782 = res_27444;\n                    \n                    redout_27653 = redout_tmp_28782;\n                }\n                res_27441 = redout_27653;\n                \n                float res_27446 = fmax32(0.0F, res_27441);\n                \n                // save map-out results\n                { }\n                // save results to be reduced\n                {\n                    ((__local\n                      float *) red_arr_mem_28777)[sext_i32_i64(local_tid_28773)] =\n                        res_27446;\n                }\n            } else {\n                ((__local\n                  float *) red_arr_mem_28777)[sext_i32_i64(local_tid_28773)] =\n                    0.0F;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, paths_23807)) {\n            // perform segmented scan to imitate reduction\n            {\n                float x_27436;\n                float x_27437;\n                float x_28783;\n                float x_28784;\n                bool ltid_in_bounds_28786;\n                \n                ltid_in_bounds_28786 = slt64(sext_i32_i64(local_tid_28773),\n                                             paths_23807 *\n                                             squot64(segred_group_sizze_27432,\n                                                    ",
                   " segment_sizze_nonzzero_28770));\n                \n                int32_t skip_threads_28787;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_28786) {\n                        x_27437 = ((volatile __local\n                                    float *) red_arr_mem_28777)[sext_i32_i64(local_tid_28773)];\n                        if ((local_tid_28773 - squot32(local_tid_28773, 32) *\n                             32) == 0) {\n                            x_27436 = x_27437;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28787 = 1;\n                    while (slt32(skip_threads_28787, 32)) {\n                        if (sle32(skip_threads_28787, local_tid_28773 -\n                                  squot32(local_tid_28773, 32) * 32) &&\n                            ltid_in_bounds_28786) {\n                            // read operands\n                            {\n                                x_27436 = ((volatile __local\n                                            float *) red_arr_mem_28777)[sext_i32_i64(local_tid_28773) -\n                                                                        sext_i32_i64(skip_threads_28787)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_28788 =\n                                     slt64(srem64(sext_i32_i64(local_tid_28773),\n                                                  paths_23807),\n                                           sext_i32_i64(local_tid_28773) -\n                                           sext_i32_i64(local_tid_28773 -\n                                           skip_threads_28787));\n                                \n                                if (inactive_28788) {\n                                    x_27436 = x_27437;\n ",
                   "                               }\n                                if (!inactive_28788) {\n                                    float res_27438 = x_27436 + x_27437;\n                                    \n                                    x_27436 = res_27438;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_28775, skip_threads_28787)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28787, local_tid_28773 -\n                                  squot32(local_tid_28773, 32) * 32) &&\n                            ltid_in_bounds_28786) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_28777)[sext_i32_i64(local_tid_28773)] =\n                                    x_27436;\n                                x_27437 = x_27436;\n                            }\n                        }\n                        if (sle32(wave_sizze_28775, skip_threads_28787)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28787 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_28773 - squot32(local_tid_28773, 32) * 32) ==\n                        31 && ltid_in_bounds_28786) {\n                        ((volatile __local\n                          float *) red_arr_mem_28777)[sext_i32_i64(squot32(local_tid_28773,\n                                                                           32))] =\n                            x_27436;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' ",
                   "contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_28789;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_28773, 32) == 0 &&\n                            ltid_in_bounds_28786) {\n                            x_28784 = ((volatile __local\n                                        float *) red_arr_mem_28777)[sext_i32_i64(local_tid_28773)];\n                            if ((local_tid_28773 - squot32(local_tid_28773,\n                                                           32) * 32) == 0) {\n                                x_28783 = x_28784;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_28789 = 1;\n                        while (slt32(skip_threads_28789, 32)) {\n                            if (sle32(skip_threads_28789, local_tid_28773 -\n                                      squot32(local_tid_28773, 32) * 32) &&\n                                (squot32(local_tid_28773, 32) == 0 &&\n                                 ltid_in_bounds_28786)) {\n                                // read operands\n                                {\n                                    x_28783 = ((volatile __local\n                                                float *) red_arr_mem_28777)[sext_i32_i64(local_tid_28773) -\n                                                                            sext_i32_i64(skip_threads_28789)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_28790 =\n                                         slt64(srem64(sext_i32_i64(local_tid_28773 *\n                                                      32 + 32 - 1),\n                                                      paths_23807),\n",
                   "                                               sext_i32_i64(local_tid_28773 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_28773 -\n                                                             skip_threads_28789) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_28790) {\n                                        x_28783 = x_28784;\n                                    }\n                                    if (!inactive_28790) {\n                                        float res_28785 = x_28783 + x_28784;\n                                        \n                                        x_28783 = res_28785;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_28775, skip_threads_28789)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_28789, local_tid_28773 -\n                                      squot32(local_tid_28773, 32) * 32) &&\n                                (squot32(local_tid_28773, 32) == 0 &&\n                                 ltid_in_bounds_28786)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      float *) red_arr_mem_28777)[sext_i32_i64(local_tid_28773)] =\n                                        x_28783;\n                                    x_28784 = x_28783;\n                                }\n                            }\n                            if (sle32(wave_sizze_28775, skip_threads_28789)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_28789 *= 2;\n                        }",
                   "\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_28773, 32) == 0 ||\n                          !ltid_in_bounds_28786)) {\n                        // read operands\n                        {\n                            x_27437 = x_27436;\n                            x_27436 = ((__local\n                                        float *) red_arr_mem_28777)[sext_i32_i64(squot32(local_tid_28773,\n                                                                                         32)) -\n                                                                    1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_28791 =\n                                 slt64(srem64(sext_i32_i64(local_tid_28773),\n                                              paths_23807),\n                                       sext_i32_i64(local_tid_28773) -\n                                       sext_i32_i64(squot32(local_tid_28773,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_28791) {\n                                x_27436 = x_27437;\n                            }\n                            if (!inactive_28791) {\n                                float res_27438 = x_27436 + x_27437;\n                                \n                                x_27436 = res_27438;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              float *) red_arr_mem_28777)[sext_i32_i64(local_tid_28773)] =\n                                x_27436;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);",
                   "\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_28773, 32) == 0) {\n                        ((__local\n                          float *) red_arr_mem_28777)[sext_i32_i64(local_tid_28773)] =\n                            x_27437;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_28781) *\n                      squot64(segred_group_sizze_27432,\n                              segment_sizze_nonzzero_28770) +\n                      sext_i32_i64(local_tid_28773), steps_23808) &&\n                slt64(sext_i32_i64(local_tid_28773),\n                      squot64(segred_group_sizze_27432,\n                              segment_sizze_nonzzero_28770))) {\n                ((__global\n                  float *) mem_27863)[sext_i32_i64(virt_group_id_28781) *\n                                      squot64(segred_group_sizze_27432,\n                                              segment_sizze_nonzzero_28770) +\n                                      sext_i32_i64(local_tid_28773)] = ((__local\n                                                                         float *) red_arr_mem_28777)[(sext_i32_i64(local_tid_28773) +\n                                                                                                      1) *\n                                                                                                     segment_sizze_nonzzero_28770 -\n                                                                                                     1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27432\n}\n__kernel void testzisegred_small_28391(__global int *global_failure,\n             ",
                   "                          __local volatile\n                                       int64_t *red_arr_mem_28399_backing_aligned_0,\n                                       int64_t res_24008,\n                                       int64_t num_groups_27065, __global\n                                       unsigned char *mem_27810,\n                                       int32_t num_subhistos_28305, __global\n                                       unsigned char *res_subhistos_mem_28306,\n                                       int64_t segment_sizze_nonzzero_28392)\n{\n    #define seghist_group_sizze_27063 (testziseghist_group_sizze_27062)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_28399_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_28399_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_28394;\n    int32_t local_tid_28395;\n    int64_t group_sizze_28398;\n    int32_t wave_sizze_28397;\n    int32_t group_tid_28396;\n    \n    global_tid_28394 = get_global_id(0);\n    local_tid_28395 = get_local_id(0);\n    group_sizze_28398 = get_local_size(0);\n    wave_sizze_28397 = LOCKSTEP_WIDTH;\n    group_tid_28396 = get_group_id(0);\n    \n    int32_t flat_gtid_28391;\n    \n    flat_gtid_28391 = global_tid_28394;\n    \n    __local char *red_arr_mem_28399;\n    \n    red_arr_mem_28399 = (__local char *) red_arr_mem_28399_backing_0;\n    \n    int32_t phys_group_id_28401;\n    \n    phys_group_id_28401 = get_group_id(0);\n    for (int32_t i_28402 = 0; i_28402 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(res_24008,\n                                          squot64(seghist_group_sizze_27063,\n                                                  segment_sizze_nonzzero_28392))) -\n                   phys_group_id_28401, sext_i64_i32(num_groups_27065));\n         i_28402++) {\n        int32_t virt_group_id_28403 = phys_group_",
                   "id_28401 + i_28402 *\n                sext_i64_i32(num_groups_27065);\n        int64_t bucket_id_28389 = squot64(sext_i32_i64(local_tid_28395),\n                                          segment_sizze_nonzzero_28392) +\n                sext_i32_i64(virt_group_id_28403) *\n                squot64(seghist_group_sizze_27063,\n                        segment_sizze_nonzzero_28392);\n        int64_t subhistogram_id_28390 = srem64(sext_i32_i64(local_tid_28395),\n                                               num_subhistos_28305);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, num_subhistos_28305) && (slt64(bucket_id_28389,\n                                                        res_24008) &&\n                                                  slt64(sext_i32_i64(local_tid_28395),\n                                                        num_subhistos_28305 *\n                                                        squot64(seghist_group_sizze_27063,\n                                                                segment_sizze_nonzzero_28392)))) {\n                // save results to be reduced\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_28399)[sext_i32_i64(local_tid_28395)] =\n                        ((__global\n                          int64_t *) res_subhistos_mem_28306)[subhistogram_id_28390 *\n                                                              res_24008 +\n                                                              bucket_id_28389];\n                }\n            } else {\n                ((__local\n                  int64_t *) red_arr_mem_28399)[sext_i32_i64(local_tid_28395)] =\n                    0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, num_subhistos_28305)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t x_27069;\n                int64_t x_27070;\n                int64_t x_28404;\n                i",
                   "nt64_t x_28405;\n                bool ltid_in_bounds_28407;\n                \n                ltid_in_bounds_28407 = slt64(sext_i32_i64(local_tid_28395),\n                                             num_subhistos_28305 *\n                                             squot64(seghist_group_sizze_27063,\n                                                     segment_sizze_nonzzero_28392));\n                \n                int32_t skip_threads_28408;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_28407) {\n                        x_27070 = ((volatile __local\n                                    int64_t *) red_arr_mem_28399)[sext_i32_i64(local_tid_28395)];\n                        if ((local_tid_28395 - squot32(local_tid_28395, 32) *\n                             32) == 0) {\n                            x_27069 = x_27070;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_28408 = 1;\n                    while (slt32(skip_threads_28408, 32)) {\n                        if (sle32(skip_threads_28408, local_tid_28395 -\n                                  squot32(local_tid_28395, 32) * 32) &&\n                            ltid_in_bounds_28407) {\n                            // read operands\n                            {\n                                x_27069 = ((volatile __local\n                                            int64_t *) red_arr_mem_28399)[sext_i32_i64(local_tid_28395) -\n                                                                          sext_i32_i64(skip_threads_28408)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_28409 =\n                                     slt64(srem64(sext_i32_i64(local_tid_28395),\n                                                  num_subhistos_",
                   "28305),\n                                           sext_i32_i64(local_tid_28395) -\n                                           sext_i32_i64(local_tid_28395 -\n                                           skip_threads_28408));\n                                \n                                if (inactive_28409) {\n                                    x_27069 = x_27070;\n                                }\n                                if (!inactive_28409) {\n                                    int64_t res_27071 = smax64(x_27069,\n                                                               x_27070);\n                                    \n                                    x_27069 = res_27071;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_28397, skip_threads_28408)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_28408, local_tid_28395 -\n                                  squot32(local_tid_28395, 32) * 32) &&\n                            ltid_in_bounds_28407) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_28399)[sext_i32_i64(local_tid_28395)] =\n                                    x_27069;\n                                x_27070 = x_27069;\n                            }\n                        }\n                        if (sle32(wave_sizze_28397, skip_threads_28408)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_28408 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_28395 - squot32(local_tid_28395, 32) * 32) ==\n                    ",
                   "    31 && ltid_in_bounds_28407) {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_28399)[sext_i32_i64(squot32(local_tid_28395,\n                                                                             32))] =\n                            x_27069;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_28410;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_28395, 32) == 0 &&\n                            ltid_in_bounds_28407) {\n                            x_28405 = ((volatile __local\n                                        int64_t *) red_arr_mem_28399)[sext_i32_i64(local_tid_28395)];\n                            if ((local_tid_28395 - squot32(local_tid_28395,\n                                                           32) * 32) == 0) {\n                                x_28404 = x_28405;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_28410 = 1;\n                        while (slt32(skip_threads_28410, 32)) {\n                            if (sle32(skip_threads_28410, local_tid_28395 -\n                                      squot32(local_tid_28395, 32) * 32) &&\n                                (squot32(local_tid_28395, 32) == 0 &&\n                                 ltid_in_bounds_28407)) {\n                                // read operands\n                                {\n                                    x_28404 = ((volatile __local\n                                                int64_t *) red_arr_mem_28399)[sext_i32_i64(local_tid_28395) -\n                                                                ",
                   "              sext_i32_i64(skip_threads_28410)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_28411 =\n                                         slt64(srem64(sext_i32_i64(local_tid_28395 *\n                                                      32 + 32 - 1),\n                                                      num_subhistos_28305),\n                                               sext_i32_i64(local_tid_28395 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_28395 -\n                                                             skip_threads_28410) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_28411) {\n                                        x_28404 = x_28405;\n                                    }\n                                    if (!inactive_28411) {\n                                        int64_t res_28406 = smax64(x_28404,\n                                                                   x_28405);\n                                        \n                                        x_28404 = res_28406;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_28397, skip_threads_28410)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_28410, local_tid_28395 -\n                                      squot32(local_tid_28395, 32) * 32) &&\n                                (squot32(local_tid_28395, 32) == 0 &&\n                                 ltid_in_bounds_28407)) {\n                                // write result\n                                {\n                                    ((",
                   "volatile __local\n                                      int64_t *) red_arr_mem_28399)[sext_i32_i64(local_tid_28395)] =\n                                        x_28404;\n                                    x_28405 = x_28404;\n                                }\n                            }\n                            if (sle32(wave_sizze_28397, skip_threads_28410)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_28410 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_28395, 32) == 0 ||\n                          !ltid_in_bounds_28407)) {\n                        // read operands\n                        {\n                            x_27070 = x_27069;\n                            x_27069 = ((__local\n                                        int64_t *) red_arr_mem_28399)[sext_i32_i64(squot32(local_tid_28395,\n                                                                                           32)) -\n                                                                      1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_28412 =\n                                 slt64(srem64(sext_i32_i64(local_tid_28395),\n                                              num_subhistos_28305),\n                                       sext_i32_i64(local_tid_28395) -\n                                       sext_i32_i64(squot32(local_tid_28395,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_28412) {\n                                x_27069 = x_27070;\n                            }\n                            if (!inactive_28412) {\n               ",
                   "                 int64_t res_27071 = smax64(x_27069, x_27070);\n                                \n                                x_27069 = res_27071;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              int64_t *) red_arr_mem_28399)[sext_i32_i64(local_tid_28395)] =\n                                x_27069;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_28395, 32) == 0) {\n                        ((__local\n                          int64_t *) red_arr_mem_28399)[sext_i32_i64(local_tid_28395)] =\n                            x_27070;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_28403) *\n                      squot64(seghist_group_sizze_27063,\n                              segment_sizze_nonzzero_28392) +\n                      sext_i32_i64(local_tid_28395), res_24008) &&\n                slt64(sext_i32_i64(local_tid_28395),\n                      squot64(seghist_group_sizze_27063,\n                              segment_sizze_nonzzero_28392))) {\n                ((__global\n                  int64_t *) mem_27810)[sext_i32_i64(virt_group_id_28403) *\n                                        squot64(seghist_group_sizze_27063,\n                                                segment_sizze_nonzzero_28392) +\n                                        sext_i32_i64(local_tid_28395)] =\n                    ((__local\n                      int64_t *) red_arr_mem_28399)[(sext_i32_i64(local_tid_28395) +\n                                                     1) *\n                     ",
                   "                               segment_sizze_nonzzero_28392 -\n                                                    1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_27063\n}\n",
                   NULL};
static const char *size_names[] = {"builtin#replicate_f32.group_size_28711",
                                   "builtin#replicate_i64.group_size_28302",
                                   "main.L2_size_28367",
                                   "main.group_size_28723",
                                   "main.group_size_28760",
                                   "main.seghist_group_size_25399",
                                   "main.seghist_num_groups_25401",
                                   "main.segmap_group_size_24284",
                                   "main.segmap_group_size_24460",
                                   "main.segmap_group_size_24964",
                                   "main.segmap_group_size_25002",
                                   "main.segmap_group_size_25057",
                                   "main.segmap_group_size_25156",
                                   "main.segmap_group_size_25219",
                                   "main.segmap_group_size_25492",
                                   "main.segmap_group_size_25564",
                                   "main.segmap_group_size_25679",
                                   "main.segmap_num_groups_25059",
                                   "main.segred_group_size_24260",
                                   "main.segred_group_size_25389",
                                   "main.segred_group_size_25498",
                                   "main.segred_group_size_25706",
                                   "main.segred_group_size_25772",
                                   "main.segred_group_size_27899",
                                   "main.segred_group_size_27931",
                                   "main.segred_num_groups_24262",
                                   "main.segred_num_groups_25391",
                                   "main.segred_num_groups_25500",
                                   "main.segred_num_groups_25708",
                                   "main.segred_num_groups_25774",
                                   "main.segred_num_groups_27897",
                                   "main.segred_num_groups_27929",
                                   "main.segscan_group_size_25381",
                                   "main.segscan_group_size_25414",
                                   "main.segscan_group_size_25422",
                                   "main.segscan_group_size_25430",
                                   "main.segscan_group_size_25482",
                                   "main.segscan_num_groups_25383",
                                   "main.segscan_num_groups_25416",
                                   "main.segscan_num_groups_25424",
                                   "main.segscan_num_groups_25432",
                                   "main.segscan_num_groups_25484",
                                   "main.suff_intra_par_12",
                                   "main.suff_intra_par_3",
                                   "main.suff_outer_par_0",
                                   "main.suff_outer_par_11",
                                   "main.suff_outer_redomap_10",
                                   "test.L2_size_28368",
                                   "test.group_size_28724",
                                   "test.group_size_28761",
                                   "test.seghist_group_size_27062",
                                   "test.seghist_num_groups_27064",
                                   "test.segmap_group_size_25947",
                                   "test.segmap_group_size_26123",
                                   "test.segmap_group_size_26627",
                                   "test.segmap_group_size_26665",
                                   "test.segmap_group_size_26720",
                                   "test.segmap_group_size_26819",
                                   "test.segmap_group_size_26882",
                                   "test.segmap_group_size_27155",
                                   "test.segmap_group_size_27218",
                                   "test.segmap_group_size_27293",
                                   "test.segmap_num_groups_26722",
                                   "test.segred_group_size_25923",
                                   "test.segred_group_size_27052",
                                   "test.segred_group_size_27161",
                                   "test.segred_group_size_27320",
                                   "test.segred_group_size_27382",
                                   "test.segred_group_size_27985",
                                   "test.segred_group_size_28017",
                                   "test.segred_num_groups_25925",
                                   "test.segred_num_groups_27054",
                                   "test.segred_num_groups_27163",
                                   "test.segred_num_groups_27322",
                                   "test.segred_num_groups_27384",
                                   "test.segred_num_groups_27983",
                                   "test.segred_num_groups_28015",
                                   "test.segscan_group_size_27044",
                                   "test.segscan_group_size_27077",
                                   "test.segscan_group_size_27085",
                                   "test.segscan_group_size_27093",
                                   "test.segscan_group_size_27145",
                                   "test.segscan_num_groups_27046",
                                   "test.segscan_num_groups_27079",
                                   "test.segscan_num_groups_27087",
                                   "test.segscan_num_groups_27095",
                                   "test.segscan_num_groups_27147",
                                   "test.suff_intra_par_3",
                                   "test.suff_outer_par_0",
                                   "test.suff_outer_par_11",
                                   "test.suff_outer_redomap_10"};
static const char *size_vars[] = {"builtinzhreplicate_f32zigroup_sizze_28711",
                                  "builtinzhreplicate_i64zigroup_sizze_28302",
                                  "mainziL2_sizze_28367",
                                  "mainzigroup_sizze_28723",
                                  "mainzigroup_sizze_28760",
                                  "mainziseghist_group_sizze_25399",
                                  "mainziseghist_num_groups_25401",
                                  "mainzisegmap_group_sizze_24284",
                                  "mainzisegmap_group_sizze_24460",
                                  "mainzisegmap_group_sizze_24964",
                                  "mainzisegmap_group_sizze_25002",
                                  "mainzisegmap_group_sizze_25057",
                                  "mainzisegmap_group_sizze_25156",
                                  "mainzisegmap_group_sizze_25219",
                                  "mainzisegmap_group_sizze_25492",
                                  "mainzisegmap_group_sizze_25564",
                                  "mainzisegmap_group_sizze_25679",
                                  "mainzisegmap_num_groups_25059",
                                  "mainzisegred_group_sizze_24260",
                                  "mainzisegred_group_sizze_25389",
                                  "mainzisegred_group_sizze_25498",
                                  "mainzisegred_group_sizze_25706",
                                  "mainzisegred_group_sizze_25772",
                                  "mainzisegred_group_sizze_27899",
                                  "mainzisegred_group_sizze_27931",
                                  "mainzisegred_num_groups_24262",
                                  "mainzisegred_num_groups_25391",
                                  "mainzisegred_num_groups_25500",
                                  "mainzisegred_num_groups_25708",
                                  "mainzisegred_num_groups_25774",
                                  "mainzisegred_num_groups_27897",
                                  "mainzisegred_num_groups_27929",
                                  "mainzisegscan_group_sizze_25381",
                                  "mainzisegscan_group_sizze_25414",
                                  "mainzisegscan_group_sizze_25422",
                                  "mainzisegscan_group_sizze_25430",
                                  "mainzisegscan_group_sizze_25482",
                                  "mainzisegscan_num_groups_25383",
                                  "mainzisegscan_num_groups_25416",
                                  "mainzisegscan_num_groups_25424",
                                  "mainzisegscan_num_groups_25432",
                                  "mainzisegscan_num_groups_25484",
                                  "mainzisuff_intra_par_12",
                                  "mainzisuff_intra_par_3",
                                  "mainzisuff_outer_par_0",
                                  "mainzisuff_outer_par_11",
                                  "mainzisuff_outer_redomap_10",
                                  "testziL2_sizze_28368",
                                  "testzigroup_sizze_28724",
                                  "testzigroup_sizze_28761",
                                  "testziseghist_group_sizze_27062",
                                  "testziseghist_num_groups_27064",
                                  "testzisegmap_group_sizze_25947",
                                  "testzisegmap_group_sizze_26123",
                                  "testzisegmap_group_sizze_26627",
                                  "testzisegmap_group_sizze_26665",
                                  "testzisegmap_group_sizze_26720",
                                  "testzisegmap_group_sizze_26819",
                                  "testzisegmap_group_sizze_26882",
                                  "testzisegmap_group_sizze_27155",
                                  "testzisegmap_group_sizze_27218",
                                  "testzisegmap_group_sizze_27293",
                                  "testzisegmap_num_groups_26722",
                                  "testzisegred_group_sizze_25923",
                                  "testzisegred_group_sizze_27052",
                                  "testzisegred_group_sizze_27161",
                                  "testzisegred_group_sizze_27320",
                                  "testzisegred_group_sizze_27382",
                                  "testzisegred_group_sizze_27985",
                                  "testzisegred_group_sizze_28017",
                                  "testzisegred_num_groups_25925",
                                  "testzisegred_num_groups_27054",
                                  "testzisegred_num_groups_27163",
                                  "testzisegred_num_groups_27322",
                                  "testzisegred_num_groups_27384",
                                  "testzisegred_num_groups_27983",
                                  "testzisegred_num_groups_28015",
                                  "testzisegscan_group_sizze_27044",
                                  "testzisegscan_group_sizze_27077",
                                  "testzisegscan_group_sizze_27085",
                                  "testzisegscan_group_sizze_27093",
                                  "testzisegscan_group_sizze_27145",
                                  "testzisegscan_num_groups_27046",
                                  "testzisegscan_num_groups_27079",
                                  "testzisegscan_num_groups_27087",
                                  "testzisegscan_num_groups_27095",
                                  "testzisegscan_num_groups_27147",
                                  "testzisuff_intra_par_3",
                                  "testzisuff_outer_par_0",
                                  "testzisuff_outer_par_11",
                                  "testzisuff_outer_redomap_10"};
static const char *size_classes[] = {"group_size", "group_size",
                                     "L2_for_histogram", "group_size",
                                     "group_size", "group_size", "num_groups",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "num_groups", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups",
                                     "threshold (!main.suff_outer_par_11 !main.suff_outer_redomap_10)",
                                     "threshold ()", "threshold ()",
                                     "threshold (!main.suff_outer_redomap_10)",
                                     "threshold ()", "L2_for_histogram",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "num_groups",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "threshold ()", "threshold ()",
                                     "threshold (!test.suff_outer_redomap_10)",
                                     "threshold ()"};
int futhark_get_num_sizes(void)
{
    return 91;
}
const char *futhark_get_size_name(int i)
{
    return size_names[i];
}
const char *futhark_get_size_class(int i)
{
    return size_classes[i];
}
struct sizes {
    size_t builtinzhreplicate_f32zigroup_sizze_28711;
    size_t builtinzhreplicate_i64zigroup_sizze_28302;
    size_t mainziL2_sizze_28367;
    size_t mainzigroup_sizze_28723;
    size_t mainzigroup_sizze_28760;
    size_t mainziseghist_group_sizze_25399;
    size_t mainziseghist_num_groups_25401;
    size_t mainzisegmap_group_sizze_24284;
    size_t mainzisegmap_group_sizze_24460;
    size_t mainzisegmap_group_sizze_24964;
    size_t mainzisegmap_group_sizze_25002;
    size_t mainzisegmap_group_sizze_25057;
    size_t mainzisegmap_group_sizze_25156;
    size_t mainzisegmap_group_sizze_25219;
    size_t mainzisegmap_group_sizze_25492;
    size_t mainzisegmap_group_sizze_25564;
    size_t mainzisegmap_group_sizze_25679;
    size_t mainzisegmap_num_groups_25059;
    size_t mainzisegred_group_sizze_24260;
    size_t mainzisegred_group_sizze_25389;
    size_t mainzisegred_group_sizze_25498;
    size_t mainzisegred_group_sizze_25706;
    size_t mainzisegred_group_sizze_25772;
    size_t mainzisegred_group_sizze_27899;
    size_t mainzisegred_group_sizze_27931;
    size_t mainzisegred_num_groups_24262;
    size_t mainzisegred_num_groups_25391;
    size_t mainzisegred_num_groups_25500;
    size_t mainzisegred_num_groups_25708;
    size_t mainzisegred_num_groups_25774;
    size_t mainzisegred_num_groups_27897;
    size_t mainzisegred_num_groups_27929;
    size_t mainzisegscan_group_sizze_25381;
    size_t mainzisegscan_group_sizze_25414;
    size_t mainzisegscan_group_sizze_25422;
    size_t mainzisegscan_group_sizze_25430;
    size_t mainzisegscan_group_sizze_25482;
    size_t mainzisegscan_num_groups_25383;
    size_t mainzisegscan_num_groups_25416;
    size_t mainzisegscan_num_groups_25424;
    size_t mainzisegscan_num_groups_25432;
    size_t mainzisegscan_num_groups_25484;
    size_t mainzisuff_intra_par_12;
    size_t mainzisuff_intra_par_3;
    size_t mainzisuff_outer_par_0;
    size_t mainzisuff_outer_par_11;
    size_t mainzisuff_outer_redomap_10;
    size_t testziL2_sizze_28368;
    size_t testzigroup_sizze_28724;
    size_t testzigroup_sizze_28761;
    size_t testziseghist_group_sizze_27062;
    size_t testziseghist_num_groups_27064;
    size_t testzisegmap_group_sizze_25947;
    size_t testzisegmap_group_sizze_26123;
    size_t testzisegmap_group_sizze_26627;
    size_t testzisegmap_group_sizze_26665;
    size_t testzisegmap_group_sizze_26720;
    size_t testzisegmap_group_sizze_26819;
    size_t testzisegmap_group_sizze_26882;
    size_t testzisegmap_group_sizze_27155;
    size_t testzisegmap_group_sizze_27218;
    size_t testzisegmap_group_sizze_27293;
    size_t testzisegmap_num_groups_26722;
    size_t testzisegred_group_sizze_25923;
    size_t testzisegred_group_sizze_27052;
    size_t testzisegred_group_sizze_27161;
    size_t testzisegred_group_sizze_27320;
    size_t testzisegred_group_sizze_27382;
    size_t testzisegred_group_sizze_27985;
    size_t testzisegred_group_sizze_28017;
    size_t testzisegred_num_groups_25925;
    size_t testzisegred_num_groups_27054;
    size_t testzisegred_num_groups_27163;
    size_t testzisegred_num_groups_27322;
    size_t testzisegred_num_groups_27384;
    size_t testzisegred_num_groups_27983;
    size_t testzisegred_num_groups_28015;
    size_t testzisegscan_group_sizze_27044;
    size_t testzisegscan_group_sizze_27077;
    size_t testzisegscan_group_sizze_27085;
    size_t testzisegscan_group_sizze_27093;
    size_t testzisegscan_group_sizze_27145;
    size_t testzisegscan_num_groups_27046;
    size_t testzisegscan_num_groups_27079;
    size_t testzisegscan_num_groups_27087;
    size_t testzisegscan_num_groups_27095;
    size_t testzisegscan_num_groups_27147;
    size_t testzisuff_intra_par_3;
    size_t testzisuff_outer_par_0;
    size_t testzisuff_outer_par_11;
    size_t testzisuff_outer_redomap_10;
} ;
struct futhark_context_config {
    struct opencl_config opencl;
    size_t sizes[91];
    int num_build_opts;
    const char **build_opts;
} ;
struct futhark_context_config *futhark_context_config_new(void)
{
    struct futhark_context_config *cfg =
                                  (struct futhark_context_config *) malloc(sizeof(struct futhark_context_config));
    
    if (cfg == NULL)
        return NULL;
    cfg->num_build_opts = 0;
    cfg->build_opts = (const char **) malloc(sizeof(const char *));
    cfg->build_opts[0] = NULL;
    cfg->sizes[0] = 0;
    cfg->sizes[1] = 0;
    cfg->sizes[2] = 4194304;
    cfg->sizes[3] = 0;
    cfg->sizes[4] = 0;
    cfg->sizes[5] = 0;
    cfg->sizes[6] = 0;
    cfg->sizes[7] = 0;
    cfg->sizes[8] = 0;
    cfg->sizes[9] = 0;
    cfg->sizes[10] = 0;
    cfg->sizes[11] = 0;
    cfg->sizes[12] = 0;
    cfg->sizes[13] = 0;
    cfg->sizes[14] = 0;
    cfg->sizes[15] = 0;
    cfg->sizes[16] = 0;
    cfg->sizes[17] = 0;
    cfg->sizes[18] = 0;
    cfg->sizes[19] = 0;
    cfg->sizes[20] = 0;
    cfg->sizes[21] = 0;
    cfg->sizes[22] = 0;
    cfg->sizes[23] = 0;
    cfg->sizes[24] = 0;
    cfg->sizes[25] = 0;
    cfg->sizes[26] = 0;
    cfg->sizes[27] = 0;
    cfg->sizes[28] = 0;
    cfg->sizes[29] = 0;
    cfg->sizes[30] = 0;
    cfg->sizes[31] = 0;
    cfg->sizes[32] = 0;
    cfg->sizes[33] = 0;
    cfg->sizes[34] = 0;
    cfg->sizes[35] = 0;
    cfg->sizes[36] = 0;
    cfg->sizes[37] = 0;
    cfg->sizes[38] = 0;
    cfg->sizes[39] = 0;
    cfg->sizes[40] = 0;
    cfg->sizes[41] = 0;
    cfg->sizes[42] = 32;
    cfg->sizes[43] = 32;
    cfg->sizes[44] = 0;
    cfg->sizes[45] = 0;
    cfg->sizes[46] = 0;
    cfg->sizes[47] = 4194304;
    cfg->sizes[48] = 0;
    cfg->sizes[49] = 0;
    cfg->sizes[50] = 0;
    cfg->sizes[51] = 0;
    cfg->sizes[52] = 0;
    cfg->sizes[53] = 0;
    cfg->sizes[54] = 0;
    cfg->sizes[55] = 0;
    cfg->sizes[56] = 0;
    cfg->sizes[57] = 0;
    cfg->sizes[58] = 0;
    cfg->sizes[59] = 0;
    cfg->sizes[60] = 0;
    cfg->sizes[61] = 0;
    cfg->sizes[62] = 0;
    cfg->sizes[63] = 0;
    cfg->sizes[64] = 0;
    cfg->sizes[65] = 0;
    cfg->sizes[66] = 0;
    cfg->sizes[67] = 0;
    cfg->sizes[68] = 0;
    cfg->sizes[69] = 0;
    cfg->sizes[70] = 0;
    cfg->sizes[71] = 0;
    cfg->sizes[72] = 0;
    cfg->sizes[73] = 0;
    cfg->sizes[74] = 0;
    cfg->sizes[75] = 0;
    cfg->sizes[76] = 0;
    cfg->sizes[77] = 0;
    cfg->sizes[78] = 0;
    cfg->sizes[79] = 0;
    cfg->sizes[80] = 0;
    cfg->sizes[81] = 0;
    cfg->sizes[82] = 0;
    cfg->sizes[83] = 0;
    cfg->sizes[84] = 0;
    cfg->sizes[85] = 0;
    cfg->sizes[86] = 0;
    cfg->sizes[87] = 32;
    cfg->sizes[88] = 0;
    cfg->sizes[89] = 0;
    cfg->sizes[90] = 0;
    opencl_config_init(&cfg->opencl, 91, size_names, size_vars, cfg->sizes,
                       size_classes);
    return cfg;
}
void futhark_context_config_free(struct futhark_context_config *cfg)
{
    free(cfg->build_opts);
    free(cfg);
}
void futhark_context_config_add_build_option(struct futhark_context_config *cfg,
                                             const char *opt)
{
    cfg->build_opts[cfg->num_build_opts] = opt;
    cfg->num_build_opts++;
    cfg->build_opts = (const char **) realloc(cfg->build_opts,
                                              (cfg->num_build_opts + 1) *
                                              sizeof(const char *));
    cfg->build_opts[cfg->num_build_opts] = NULL;
}
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int flag)
{
    cfg->opencl.profiling = cfg->opencl.logging = cfg->opencl.debugging = flag;
}
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag)
{
    cfg->opencl.profiling = flag;
}
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int flag)
{
    cfg->opencl.logging = flag;
}
void futhark_context_config_set_device(struct futhark_context_config *cfg, const
                                       char *s)
{
    set_preferred_device(&cfg->opencl, s);
}
void futhark_context_config_set_platform(struct futhark_context_config *cfg,
                                         const char *s)
{
    set_preferred_platform(&cfg->opencl, s);
}
void futhark_context_config_select_device_interactively(struct futhark_context_config *cfg)
{
    select_device_interactively(&cfg->opencl);
}
void futhark_context_config_list_devices(struct futhark_context_config *cfg)
{
    list_devices(&cfg->opencl);
}
void futhark_context_config_dump_program_to(struct futhark_context_config *cfg,
                                            const char *path)
{
    cfg->opencl.dump_program_to = path;
}
void futhark_context_config_load_program_from(struct futhark_context_config *cfg,
                                              const char *path)
{
    cfg->opencl.load_program_from = path;
}
void futhark_context_config_dump_binary_to(struct futhark_context_config *cfg,
                                           const char *path)
{
    cfg->opencl.dump_binary_to = path;
}
void futhark_context_config_load_binary_from(struct futhark_context_config *cfg,
                                             const char *path)
{
    cfg->opencl.load_binary_from = path;
}
void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg,
                                                   int size)
{
    cfg->opencl.default_group_size = size;
    cfg->opencl.default_group_size_changed = 1;
}
void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg,
                                                   int num)
{
    cfg->opencl.default_num_groups = num;
}
void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg,
                                                  int size)
{
    cfg->opencl.default_tile_size = size;
    cfg->opencl.default_tile_size_changed = 1;
}
void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg,
                                                  int size)
{
    cfg->opencl.default_threshold = size;
}
int futhark_context_config_set_size(struct futhark_context_config *cfg, const
                                    char *size_name, size_t size_value)
{
    for (int i = 0; i < 91; i++) {
        if (strcmp(size_name, size_names[i]) == 0) {
            cfg->sizes[i] = size_value;
            return 0;
        }
    }
    if (strcmp(size_name, "default_group_size") == 0) {
        cfg->opencl.default_group_size = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_num_groups") == 0) {
        cfg->opencl.default_num_groups = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_threshold") == 0) {
        cfg->opencl.default_threshold = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_tile_size") == 0) {
        cfg->opencl.default_tile_size = size_value;
        return 0;
    }
    return 1;
}
struct futhark_context {
    int detail_memory;
    int debugging;
    int profiling;
    int profiling_paused;
    int logging;
    lock_t lock;
    char *error;
    int64_t peak_mem_usage_device;
    int64_t cur_mem_usage_device;
    int64_t peak_mem_usage_default;
    int64_t cur_mem_usage_default;
    struct {
        int dummy;
    } constants;
    struct memblock_device mainzicounter_mem_28062;
    struct memblock_device mainzicounter_mem_28092;
    struct memblock_device mainzicounter_mem_28129;
    struct memblock_device mainzicounter_mem_28264;
    struct memblock_device mainzihist_locks_mem_28375;
    struct memblock_device mainzicounter_mem_28419;
    struct memblock_device mainzicounter_mem_28725;
    struct memblock_device mainzicounter_mem_28809;
    struct memblock_device mainzicounter_mem_28849;
    struct memblock_device testzistatic_array_28059;
    struct memblock_device testzistatic_array_28060;
    struct memblock_device testzistatic_array_28061;
    struct memblock_device testzicounter_mem_28063;
    struct memblock_device testzicounter_mem_28093;
    struct memblock_device testzicounter_mem_28130;
    struct memblock_device testzicounter_mem_28265;
    struct memblock_device testzihist_locks_mem_28376;
    struct memblock_device testzicounter_mem_28420;
    struct memblock_device testzicounter_mem_28726;
    struct memblock_device testzicounter_mem_28799;
    struct memblock_device testzicounter_mem_28838;
    int total_runs;
    long total_runtime;
    cl_kernel builtinzhreplicate_f32zireplicate_28708;
    cl_kernel builtinzhreplicate_i64zireplicate_28299;
    cl_kernel gpu_map_transpose_f32;
    cl_kernel gpu_map_transpose_f32_low_height;
    cl_kernel gpu_map_transpose_f32_low_width;
    cl_kernel gpu_map_transpose_f32_small;
    cl_kernel mainzicopy_28720;
    cl_kernel mainzicopy_28757;
    cl_kernel mainziscan_stage1_25387;
    cl_kernel mainziscan_stage1_25420;
    cl_kernel mainziscan_stage1_25428;
    cl_kernel mainziscan_stage1_25436;
    cl_kernel mainziscan_stage1_25488;
    cl_kernel mainziscan_stage2_25387;
    cl_kernel mainziscan_stage2_25420;
    cl_kernel mainziscan_stage2_25428;
    cl_kernel mainziscan_stage2_25436;
    cl_kernel mainziscan_stage2_25488;
    cl_kernel mainziscan_stage3_25387;
    cl_kernel mainziscan_stage3_25420;
    cl_kernel mainziscan_stage3_25428;
    cl_kernel mainziscan_stage3_25436;
    cl_kernel mainziscan_stage3_25488;
    cl_kernel mainziseghist_global_25405;
    cl_kernel mainziseghist_local_25405;
    cl_kernel mainzisegmap_24282;
    cl_kernel mainzisegmap_24458;
    cl_kernel mainzisegmap_24960;
    cl_kernel mainzisegmap_24998;
    cl_kernel mainzisegmap_25055;
    cl_kernel mainzisegmap_25153;
    cl_kernel mainzisegmap_25217;
    cl_kernel mainzisegmap_25490;
    cl_kernel mainzisegmap_25562;
    cl_kernel mainzisegmap_25677;
    cl_kernel mainzisegmap_intragroup_24699;
    cl_kernel mainzisegmap_intragroup_25560;
    cl_kernel mainzisegred_large_25712;
    cl_kernel mainzisegred_large_28390;
    cl_kernel mainzisegred_nonseg_24268;
    cl_kernel mainzisegred_nonseg_25397;
    cl_kernel mainzisegred_nonseg_25507;
    cl_kernel mainzisegred_nonseg_25780;
    cl_kernel mainzisegred_nonseg_27904;
    cl_kernel mainzisegred_nonseg_27936;
    cl_kernel mainzisegred_small_25712;
    cl_kernel mainzisegred_small_28390;
    cl_kernel testzicopy_28721;
    cl_kernel testzicopy_28758;
    cl_kernel testziscan_stage1_27050;
    cl_kernel testziscan_stage1_27083;
    cl_kernel testziscan_stage1_27091;
    cl_kernel testziscan_stage1_27099;
    cl_kernel testziscan_stage1_27151;
    cl_kernel testziscan_stage2_27050;
    cl_kernel testziscan_stage2_27083;
    cl_kernel testziscan_stage2_27091;
    cl_kernel testziscan_stage2_27099;
    cl_kernel testziscan_stage2_27151;
    cl_kernel testziscan_stage3_27050;
    cl_kernel testziscan_stage3_27083;
    cl_kernel testziscan_stage3_27091;
    cl_kernel testziscan_stage3_27099;
    cl_kernel testziscan_stage3_27151;
    cl_kernel testziseghist_global_27068;
    cl_kernel testziseghist_local_27068;
    cl_kernel testzisegmap_25945;
    cl_kernel testzisegmap_26121;
    cl_kernel testzisegmap_26623;
    cl_kernel testzisegmap_26661;
    cl_kernel testzisegmap_26718;
    cl_kernel testzisegmap_26816;
    cl_kernel testzisegmap_26880;
    cl_kernel testzisegmap_27153;
    cl_kernel testzisegmap_27216;
    cl_kernel testzisegmap_27291;
    cl_kernel testzisegmap_intragroup_26362;
    cl_kernel testzisegred_large_27326;
    cl_kernel testzisegred_large_28391;
    cl_kernel testzisegred_nonseg_25931;
    cl_kernel testzisegred_nonseg_27060;
    cl_kernel testzisegred_nonseg_27169;
    cl_kernel testzisegred_nonseg_27390;
    cl_kernel testzisegred_nonseg_27990;
    cl_kernel testzisegred_nonseg_28022;
    cl_kernel testzisegred_small_27326;
    cl_kernel testzisegred_small_28391;
    int64_t copy_dev_to_dev_total_runtime;
    int copy_dev_to_dev_runs;
    int64_t copy_dev_to_host_total_runtime;
    int copy_dev_to_host_runs;
    int64_t copy_host_to_dev_total_runtime;
    int copy_host_to_dev_runs;
    int64_t copy_scalar_to_dev_total_runtime;
    int copy_scalar_to_dev_runs;
    int64_t copy_scalar_from_dev_total_runtime;
    int copy_scalar_from_dev_runs;
    int64_t builtinzhreplicate_f32zireplicate_28708_total_runtime;
    int builtinzhreplicate_f32zireplicate_28708_runs;
    int64_t builtinzhreplicate_i64zireplicate_28299_total_runtime;
    int builtinzhreplicate_i64zireplicate_28299_runs;
    int64_t gpu_map_transpose_f32_total_runtime;
    int gpu_map_transpose_f32_runs;
    int64_t gpu_map_transpose_f32_low_height_total_runtime;
    int gpu_map_transpose_f32_low_height_runs;
    int64_t gpu_map_transpose_f32_low_width_total_runtime;
    int gpu_map_transpose_f32_low_width_runs;
    int64_t gpu_map_transpose_f32_small_total_runtime;
    int gpu_map_transpose_f32_small_runs;
    int64_t mainzicopy_28720_total_runtime;
    int mainzicopy_28720_runs;
    int64_t mainzicopy_28757_total_runtime;
    int mainzicopy_28757_runs;
    int64_t mainziscan_stage1_25387_total_runtime;
    int mainziscan_stage1_25387_runs;
    int64_t mainziscan_stage1_25420_total_runtime;
    int mainziscan_stage1_25420_runs;
    int64_t mainziscan_stage1_25428_total_runtime;
    int mainziscan_stage1_25428_runs;
    int64_t mainziscan_stage1_25436_total_runtime;
    int mainziscan_stage1_25436_runs;
    int64_t mainziscan_stage1_25488_total_runtime;
    int mainziscan_stage1_25488_runs;
    int64_t mainziscan_stage2_25387_total_runtime;
    int mainziscan_stage2_25387_runs;
    int64_t mainziscan_stage2_25420_total_runtime;
    int mainziscan_stage2_25420_runs;
    int64_t mainziscan_stage2_25428_total_runtime;
    int mainziscan_stage2_25428_runs;
    int64_t mainziscan_stage2_25436_total_runtime;
    int mainziscan_stage2_25436_runs;
    int64_t mainziscan_stage2_25488_total_runtime;
    int mainziscan_stage2_25488_runs;
    int64_t mainziscan_stage3_25387_total_runtime;
    int mainziscan_stage3_25387_runs;
    int64_t mainziscan_stage3_25420_total_runtime;
    int mainziscan_stage3_25420_runs;
    int64_t mainziscan_stage3_25428_total_runtime;
    int mainziscan_stage3_25428_runs;
    int64_t mainziscan_stage3_25436_total_runtime;
    int mainziscan_stage3_25436_runs;
    int64_t mainziscan_stage3_25488_total_runtime;
    int mainziscan_stage3_25488_runs;
    int64_t mainziseghist_global_25405_total_runtime;
    int mainziseghist_global_25405_runs;
    int64_t mainziseghist_local_25405_total_runtime;
    int mainziseghist_local_25405_runs;
    int64_t mainzisegmap_24282_total_runtime;
    int mainzisegmap_24282_runs;
    int64_t mainzisegmap_24458_total_runtime;
    int mainzisegmap_24458_runs;
    int64_t mainzisegmap_24960_total_runtime;
    int mainzisegmap_24960_runs;
    int64_t mainzisegmap_24998_total_runtime;
    int mainzisegmap_24998_runs;
    int64_t mainzisegmap_25055_total_runtime;
    int mainzisegmap_25055_runs;
    int64_t mainzisegmap_25153_total_runtime;
    int mainzisegmap_25153_runs;
    int64_t mainzisegmap_25217_total_runtime;
    int mainzisegmap_25217_runs;
    int64_t mainzisegmap_25490_total_runtime;
    int mainzisegmap_25490_runs;
    int64_t mainzisegmap_25562_total_runtime;
    int mainzisegmap_25562_runs;
    int64_t mainzisegmap_25677_total_runtime;
    int mainzisegmap_25677_runs;
    int64_t mainzisegmap_intragroup_24699_total_runtime;
    int mainzisegmap_intragroup_24699_runs;
    int64_t mainzisegmap_intragroup_25560_total_runtime;
    int mainzisegmap_intragroup_25560_runs;
    int64_t mainzisegred_large_25712_total_runtime;
    int mainzisegred_large_25712_runs;
    int64_t mainzisegred_large_28390_total_runtime;
    int mainzisegred_large_28390_runs;
    int64_t mainzisegred_nonseg_24268_total_runtime;
    int mainzisegred_nonseg_24268_runs;
    int64_t mainzisegred_nonseg_25397_total_runtime;
    int mainzisegred_nonseg_25397_runs;
    int64_t mainzisegred_nonseg_25507_total_runtime;
    int mainzisegred_nonseg_25507_runs;
    int64_t mainzisegred_nonseg_25780_total_runtime;
    int mainzisegred_nonseg_25780_runs;
    int64_t mainzisegred_nonseg_27904_total_runtime;
    int mainzisegred_nonseg_27904_runs;
    int64_t mainzisegred_nonseg_27936_total_runtime;
    int mainzisegred_nonseg_27936_runs;
    int64_t mainzisegred_small_25712_total_runtime;
    int mainzisegred_small_25712_runs;
    int64_t mainzisegred_small_28390_total_runtime;
    int mainzisegred_small_28390_runs;
    int64_t testzicopy_28721_total_runtime;
    int testzicopy_28721_runs;
    int64_t testzicopy_28758_total_runtime;
    int testzicopy_28758_runs;
    int64_t testziscan_stage1_27050_total_runtime;
    int testziscan_stage1_27050_runs;
    int64_t testziscan_stage1_27083_total_runtime;
    int testziscan_stage1_27083_runs;
    int64_t testziscan_stage1_27091_total_runtime;
    int testziscan_stage1_27091_runs;
    int64_t testziscan_stage1_27099_total_runtime;
    int testziscan_stage1_27099_runs;
    int64_t testziscan_stage1_27151_total_runtime;
    int testziscan_stage1_27151_runs;
    int64_t testziscan_stage2_27050_total_runtime;
    int testziscan_stage2_27050_runs;
    int64_t testziscan_stage2_27083_total_runtime;
    int testziscan_stage2_27083_runs;
    int64_t testziscan_stage2_27091_total_runtime;
    int testziscan_stage2_27091_runs;
    int64_t testziscan_stage2_27099_total_runtime;
    int testziscan_stage2_27099_runs;
    int64_t testziscan_stage2_27151_total_runtime;
    int testziscan_stage2_27151_runs;
    int64_t testziscan_stage3_27050_total_runtime;
    int testziscan_stage3_27050_runs;
    int64_t testziscan_stage3_27083_total_runtime;
    int testziscan_stage3_27083_runs;
    int64_t testziscan_stage3_27091_total_runtime;
    int testziscan_stage3_27091_runs;
    int64_t testziscan_stage3_27099_total_runtime;
    int testziscan_stage3_27099_runs;
    int64_t testziscan_stage3_27151_total_runtime;
    int testziscan_stage3_27151_runs;
    int64_t testziseghist_global_27068_total_runtime;
    int testziseghist_global_27068_runs;
    int64_t testziseghist_local_27068_total_runtime;
    int testziseghist_local_27068_runs;
    int64_t testzisegmap_25945_total_runtime;
    int testzisegmap_25945_runs;
    int64_t testzisegmap_26121_total_runtime;
    int testzisegmap_26121_runs;
    int64_t testzisegmap_26623_total_runtime;
    int testzisegmap_26623_runs;
    int64_t testzisegmap_26661_total_runtime;
    int testzisegmap_26661_runs;
    int64_t testzisegmap_26718_total_runtime;
    int testzisegmap_26718_runs;
    int64_t testzisegmap_26816_total_runtime;
    int testzisegmap_26816_runs;
    int64_t testzisegmap_26880_total_runtime;
    int testzisegmap_26880_runs;
    int64_t testzisegmap_27153_total_runtime;
    int testzisegmap_27153_runs;
    int64_t testzisegmap_27216_total_runtime;
    int testzisegmap_27216_runs;
    int64_t testzisegmap_27291_total_runtime;
    int testzisegmap_27291_runs;
    int64_t testzisegmap_intragroup_26362_total_runtime;
    int testzisegmap_intragroup_26362_runs;
    int64_t testzisegred_large_27326_total_runtime;
    int testzisegred_large_27326_runs;
    int64_t testzisegred_large_28391_total_runtime;
    int testzisegred_large_28391_runs;
    int64_t testzisegred_nonseg_25931_total_runtime;
    int testzisegred_nonseg_25931_runs;
    int64_t testzisegred_nonseg_27060_total_runtime;
    int testzisegred_nonseg_27060_runs;
    int64_t testzisegred_nonseg_27169_total_runtime;
    int testzisegred_nonseg_27169_runs;
    int64_t testzisegred_nonseg_27390_total_runtime;
    int testzisegred_nonseg_27390_runs;
    int64_t testzisegred_nonseg_27990_total_runtime;
    int testzisegred_nonseg_27990_runs;
    int64_t testzisegred_nonseg_28022_total_runtime;
    int testzisegred_nonseg_28022_runs;
    int64_t testzisegred_small_27326_total_runtime;
    int testzisegred_small_27326_runs;
    int64_t testzisegred_small_28391_total_runtime;
    int testzisegred_small_28391_runs;
    cl_mem global_failure;
    cl_mem global_failure_args;
    struct opencl_context opencl;
    struct sizes sizes;
    cl_int failure_is_an_option;
} ;
void post_opencl_setup(struct opencl_context *ctx,
                       struct opencl_device_option *option)
{
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name,
                                            "NVIDIA CUDA") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_GPU) == CL_DEVICE_TYPE_GPU) {
        ctx->lockstep_width = 32;
    }
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name,
                                            "AMD Accelerated Parallel Processing") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->lockstep_width = 32;
    }
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->lockstep_width = 1;
    }
    if ((ctx->cfg.default_num_groups == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_GPU) == CL_DEVICE_TYPE_GPU) {
        size_t MAX_COMPUTE_UNITS_val = 0;
        
        clGetDeviceInfo(ctx->device, CL_DEVICE_MAX_COMPUTE_UNITS,
                        sizeof(MAX_COMPUTE_UNITS_val), &MAX_COMPUTE_UNITS_val,
                        NULL);
        ctx->cfg.default_num_groups = 4 * MAX_COMPUTE_UNITS_val;
    }
    if ((ctx->cfg.default_group_size == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_GPU) == CL_DEVICE_TYPE_GPU) {
        ctx->cfg.default_group_size = 256;
    }
    if ((ctx->cfg.default_tile_size == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->cfg.default_tile_size = 32;
    }
    if ((ctx->cfg.default_threshold == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->cfg.default_threshold = 32768;
    }
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_CPU) ==
        CL_DEVICE_TYPE_CPU) {
        ctx->lockstep_width = 1;
    }
    if ((ctx->cfg.default_num_groups == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_CPU) == CL_DEVICE_TYPE_CPU) {
        size_t MAX_COMPUTE_UNITS_val = 0;
        
        clGetDeviceInfo(ctx->device, CL_DEVICE_MAX_COMPUTE_UNITS,
                        sizeof(MAX_COMPUTE_UNITS_val), &MAX_COMPUTE_UNITS_val,
                        NULL);
        ctx->cfg.default_num_groups = MAX_COMPUTE_UNITS_val;
    }
    if ((ctx->cfg.default_group_size == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_CPU) == CL_DEVICE_TYPE_CPU) {
        ctx->cfg.default_group_size = 32;
    }
    if ((ctx->cfg.default_tile_size == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_CPU) ==
        CL_DEVICE_TYPE_CPU) {
        ctx->cfg.default_tile_size = 4;
    }
    if ((ctx->cfg.default_threshold == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_CPU) ==
        CL_DEVICE_TYPE_CPU) {
        size_t MAX_COMPUTE_UNITS_val = 0;
        
        clGetDeviceInfo(ctx->device, CL_DEVICE_MAX_COMPUTE_UNITS,
                        sizeof(MAX_COMPUTE_UNITS_val), &MAX_COMPUTE_UNITS_val,
                        NULL);
        ctx->cfg.default_threshold = MAX_COMPUTE_UNITS_val;
    }
}
static void init_context_early(struct futhark_context_config *cfg,
                               struct futhark_context *ctx)
{
    ctx->opencl.cfg = cfg->opencl;
    ctx->detail_memory = cfg->opencl.debugging;
    ctx->debugging = cfg->opencl.debugging;
    ctx->profiling = cfg->opencl.profiling;
    ctx->profiling_paused = 0;
    ctx->logging = cfg->opencl.logging;
    ctx->error = NULL;
    ctx->opencl.profiling_records_capacity = 200;
    ctx->opencl.profiling_records_used = 0;
    ctx->opencl.profiling_records =
        malloc(ctx->opencl.profiling_records_capacity *
        sizeof(struct profiling_record));
    create_lock(&ctx->lock);
    ctx->failure_is_an_option = 0;
    ctx->peak_mem_usage_device = 0;
    ctx->cur_mem_usage_device = 0;
    ctx->peak_mem_usage_default = 0;
    ctx->cur_mem_usage_default = 0;
    ctx->total_runs = 0;
    ctx->total_runtime = 0;
    ctx->copy_dev_to_dev_total_runtime = 0;
    ctx->copy_dev_to_dev_runs = 0;
    ctx->copy_dev_to_host_total_runtime = 0;
    ctx->copy_dev_to_host_runs = 0;
    ctx->copy_host_to_dev_total_runtime = 0;
    ctx->copy_host_to_dev_runs = 0;
    ctx->copy_scalar_to_dev_total_runtime = 0;
    ctx->copy_scalar_to_dev_runs = 0;
    ctx->copy_scalar_from_dev_total_runtime = 0;
    ctx->copy_scalar_from_dev_runs = 0;
    ctx->builtinzhreplicate_f32zireplicate_28708_total_runtime = 0;
    ctx->builtinzhreplicate_f32zireplicate_28708_runs = 0;
    ctx->builtinzhreplicate_i64zireplicate_28299_total_runtime = 0;
    ctx->builtinzhreplicate_i64zireplicate_28299_runs = 0;
    ctx->gpu_map_transpose_f32_total_runtime = 0;
    ctx->gpu_map_transpose_f32_runs = 0;
    ctx->gpu_map_transpose_f32_low_height_total_runtime = 0;
    ctx->gpu_map_transpose_f32_low_height_runs = 0;
    ctx->gpu_map_transpose_f32_low_width_total_runtime = 0;
    ctx->gpu_map_transpose_f32_low_width_runs = 0;
    ctx->gpu_map_transpose_f32_small_total_runtime = 0;
    ctx->gpu_map_transpose_f32_small_runs = 0;
    ctx->mainzicopy_28720_total_runtime = 0;
    ctx->mainzicopy_28720_runs = 0;
    ctx->mainzicopy_28757_total_runtime = 0;
    ctx->mainzicopy_28757_runs = 0;
    ctx->mainziscan_stage1_25387_total_runtime = 0;
    ctx->mainziscan_stage1_25387_runs = 0;
    ctx->mainziscan_stage1_25420_total_runtime = 0;
    ctx->mainziscan_stage1_25420_runs = 0;
    ctx->mainziscan_stage1_25428_total_runtime = 0;
    ctx->mainziscan_stage1_25428_runs = 0;
    ctx->mainziscan_stage1_25436_total_runtime = 0;
    ctx->mainziscan_stage1_25436_runs = 0;
    ctx->mainziscan_stage1_25488_total_runtime = 0;
    ctx->mainziscan_stage1_25488_runs = 0;
    ctx->mainziscan_stage2_25387_total_runtime = 0;
    ctx->mainziscan_stage2_25387_runs = 0;
    ctx->mainziscan_stage2_25420_total_runtime = 0;
    ctx->mainziscan_stage2_25420_runs = 0;
    ctx->mainziscan_stage2_25428_total_runtime = 0;
    ctx->mainziscan_stage2_25428_runs = 0;
    ctx->mainziscan_stage2_25436_total_runtime = 0;
    ctx->mainziscan_stage2_25436_runs = 0;
    ctx->mainziscan_stage2_25488_total_runtime = 0;
    ctx->mainziscan_stage2_25488_runs = 0;
    ctx->mainziscan_stage3_25387_total_runtime = 0;
    ctx->mainziscan_stage3_25387_runs = 0;
    ctx->mainziscan_stage3_25420_total_runtime = 0;
    ctx->mainziscan_stage3_25420_runs = 0;
    ctx->mainziscan_stage3_25428_total_runtime = 0;
    ctx->mainziscan_stage3_25428_runs = 0;
    ctx->mainziscan_stage3_25436_total_runtime = 0;
    ctx->mainziscan_stage3_25436_runs = 0;
    ctx->mainziscan_stage3_25488_total_runtime = 0;
    ctx->mainziscan_stage3_25488_runs = 0;
    ctx->mainziseghist_global_25405_total_runtime = 0;
    ctx->mainziseghist_global_25405_runs = 0;
    ctx->mainziseghist_local_25405_total_runtime = 0;
    ctx->mainziseghist_local_25405_runs = 0;
    ctx->mainzisegmap_24282_total_runtime = 0;
    ctx->mainzisegmap_24282_runs = 0;
    ctx->mainzisegmap_24458_total_runtime = 0;
    ctx->mainzisegmap_24458_runs = 0;
    ctx->mainzisegmap_24960_total_runtime = 0;
    ctx->mainzisegmap_24960_runs = 0;
    ctx->mainzisegmap_24998_total_runtime = 0;
    ctx->mainzisegmap_24998_runs = 0;
    ctx->mainzisegmap_25055_total_runtime = 0;
    ctx->mainzisegmap_25055_runs = 0;
    ctx->mainzisegmap_25153_total_runtime = 0;
    ctx->mainzisegmap_25153_runs = 0;
    ctx->mainzisegmap_25217_total_runtime = 0;
    ctx->mainzisegmap_25217_runs = 0;
    ctx->mainzisegmap_25490_total_runtime = 0;
    ctx->mainzisegmap_25490_runs = 0;
    ctx->mainzisegmap_25562_total_runtime = 0;
    ctx->mainzisegmap_25562_runs = 0;
    ctx->mainzisegmap_25677_total_runtime = 0;
    ctx->mainzisegmap_25677_runs = 0;
    ctx->mainzisegmap_intragroup_24699_total_runtime = 0;
    ctx->mainzisegmap_intragroup_24699_runs = 0;
    ctx->mainzisegmap_intragroup_25560_total_runtime = 0;
    ctx->mainzisegmap_intragroup_25560_runs = 0;
    ctx->mainzisegred_large_25712_total_runtime = 0;
    ctx->mainzisegred_large_25712_runs = 0;
    ctx->mainzisegred_large_28390_total_runtime = 0;
    ctx->mainzisegred_large_28390_runs = 0;
    ctx->mainzisegred_nonseg_24268_total_runtime = 0;
    ctx->mainzisegred_nonseg_24268_runs = 0;
    ctx->mainzisegred_nonseg_25397_total_runtime = 0;
    ctx->mainzisegred_nonseg_25397_runs = 0;
    ctx->mainzisegred_nonseg_25507_total_runtime = 0;
    ctx->mainzisegred_nonseg_25507_runs = 0;
    ctx->mainzisegred_nonseg_25780_total_runtime = 0;
    ctx->mainzisegred_nonseg_25780_runs = 0;
    ctx->mainzisegred_nonseg_27904_total_runtime = 0;
    ctx->mainzisegred_nonseg_27904_runs = 0;
    ctx->mainzisegred_nonseg_27936_total_runtime = 0;
    ctx->mainzisegred_nonseg_27936_runs = 0;
    ctx->mainzisegred_small_25712_total_runtime = 0;
    ctx->mainzisegred_small_25712_runs = 0;
    ctx->mainzisegred_small_28390_total_runtime = 0;
    ctx->mainzisegred_small_28390_runs = 0;
    ctx->testzicopy_28721_total_runtime = 0;
    ctx->testzicopy_28721_runs = 0;
    ctx->testzicopy_28758_total_runtime = 0;
    ctx->testzicopy_28758_runs = 0;
    ctx->testziscan_stage1_27050_total_runtime = 0;
    ctx->testziscan_stage1_27050_runs = 0;
    ctx->testziscan_stage1_27083_total_runtime = 0;
    ctx->testziscan_stage1_27083_runs = 0;
    ctx->testziscan_stage1_27091_total_runtime = 0;
    ctx->testziscan_stage1_27091_runs = 0;
    ctx->testziscan_stage1_27099_total_runtime = 0;
    ctx->testziscan_stage1_27099_runs = 0;
    ctx->testziscan_stage1_27151_total_runtime = 0;
    ctx->testziscan_stage1_27151_runs = 0;
    ctx->testziscan_stage2_27050_total_runtime = 0;
    ctx->testziscan_stage2_27050_runs = 0;
    ctx->testziscan_stage2_27083_total_runtime = 0;
    ctx->testziscan_stage2_27083_runs = 0;
    ctx->testziscan_stage2_27091_total_runtime = 0;
    ctx->testziscan_stage2_27091_runs = 0;
    ctx->testziscan_stage2_27099_total_runtime = 0;
    ctx->testziscan_stage2_27099_runs = 0;
    ctx->testziscan_stage2_27151_total_runtime = 0;
    ctx->testziscan_stage2_27151_runs = 0;
    ctx->testziscan_stage3_27050_total_runtime = 0;
    ctx->testziscan_stage3_27050_runs = 0;
    ctx->testziscan_stage3_27083_total_runtime = 0;
    ctx->testziscan_stage3_27083_runs = 0;
    ctx->testziscan_stage3_27091_total_runtime = 0;
    ctx->testziscan_stage3_27091_runs = 0;
    ctx->testziscan_stage3_27099_total_runtime = 0;
    ctx->testziscan_stage3_27099_runs = 0;
    ctx->testziscan_stage3_27151_total_runtime = 0;
    ctx->testziscan_stage3_27151_runs = 0;
    ctx->testziseghist_global_27068_total_runtime = 0;
    ctx->testziseghist_global_27068_runs = 0;
    ctx->testziseghist_local_27068_total_runtime = 0;
    ctx->testziseghist_local_27068_runs = 0;
    ctx->testzisegmap_25945_total_runtime = 0;
    ctx->testzisegmap_25945_runs = 0;
    ctx->testzisegmap_26121_total_runtime = 0;
    ctx->testzisegmap_26121_runs = 0;
    ctx->testzisegmap_26623_total_runtime = 0;
    ctx->testzisegmap_26623_runs = 0;
    ctx->testzisegmap_26661_total_runtime = 0;
    ctx->testzisegmap_26661_runs = 0;
    ctx->testzisegmap_26718_total_runtime = 0;
    ctx->testzisegmap_26718_runs = 0;
    ctx->testzisegmap_26816_total_runtime = 0;
    ctx->testzisegmap_26816_runs = 0;
    ctx->testzisegmap_26880_total_runtime = 0;
    ctx->testzisegmap_26880_runs = 0;
    ctx->testzisegmap_27153_total_runtime = 0;
    ctx->testzisegmap_27153_runs = 0;
    ctx->testzisegmap_27216_total_runtime = 0;
    ctx->testzisegmap_27216_runs = 0;
    ctx->testzisegmap_27291_total_runtime = 0;
    ctx->testzisegmap_27291_runs = 0;
    ctx->testzisegmap_intragroup_26362_total_runtime = 0;
    ctx->testzisegmap_intragroup_26362_runs = 0;
    ctx->testzisegred_large_27326_total_runtime = 0;
    ctx->testzisegred_large_27326_runs = 0;
    ctx->testzisegred_large_28391_total_runtime = 0;
    ctx->testzisegred_large_28391_runs = 0;
    ctx->testzisegred_nonseg_25931_total_runtime = 0;
    ctx->testzisegred_nonseg_25931_runs = 0;
    ctx->testzisegred_nonseg_27060_total_runtime = 0;
    ctx->testzisegred_nonseg_27060_runs = 0;
    ctx->testzisegred_nonseg_27169_total_runtime = 0;
    ctx->testzisegred_nonseg_27169_runs = 0;
    ctx->testzisegred_nonseg_27390_total_runtime = 0;
    ctx->testzisegred_nonseg_27390_runs = 0;
    ctx->testzisegred_nonseg_27990_total_runtime = 0;
    ctx->testzisegred_nonseg_27990_runs = 0;
    ctx->testzisegred_nonseg_28022_total_runtime = 0;
    ctx->testzisegred_nonseg_28022_runs = 0;
    ctx->testzisegred_small_27326_total_runtime = 0;
    ctx->testzisegred_small_27326_runs = 0;
    ctx->testzisegred_small_28391_total_runtime = 0;
    ctx->testzisegred_small_28391_runs = 0;
}
static int init_context_late(struct futhark_context_config *cfg,
                             struct futhark_context *ctx, cl_program prog)
{
    cl_int error;
    cl_int no_error = -1;
    
    ctx->global_failure = clCreateBuffer(ctx->opencl.ctx, CL_MEM_READ_WRITE |
                                         CL_MEM_COPY_HOST_PTR, sizeof(cl_int),
                                         &no_error, &error);
    OPENCL_SUCCEED_OR_RETURN(error);
    // The +1 is to avoid zero-byte allocations.
    ctx->global_failure_args = clCreateBuffer(ctx->opencl.ctx,
                                              CL_MEM_READ_WRITE,
                                              sizeof(int64_t) * (3 + 1), NULL,
                                              &error);
    OPENCL_SUCCEED_OR_RETURN(error);
    {
        ctx->builtinzhreplicate_f32zireplicate_28708 = clCreateKernel(prog,
                                                                      "builtinzhreplicate_f32zireplicate_28708",
                                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "builtin#replicate_f32.replicate_28708");
    }
    {
        ctx->builtinzhreplicate_i64zireplicate_28299 = clCreateKernel(prog,
                                                                      "builtinzhreplicate_i64zireplicate_28299",
                                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "builtin#replicate_i64.replicate_28299");
    }
    {
        ctx->gpu_map_transpose_f32 = clCreateKernel(prog,
                                                    "gpu_map_transpose_f32",
                                                    &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "gpu_map_transpose_f32");
    }
    {
        ctx->gpu_map_transpose_f32_low_height = clCreateKernel(prog,
                                                               "gpu_map_transpose_f32_low_height",
                                                               &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "gpu_map_transpose_f32_low_height");
    }
    {
        ctx->gpu_map_transpose_f32_low_width = clCreateKernel(prog,
                                                              "gpu_map_transpose_f32_low_width",
                                                              &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "gpu_map_transpose_f32_low_width");
    }
    {
        ctx->gpu_map_transpose_f32_small = clCreateKernel(prog,
                                                          "gpu_map_transpose_f32_small",
                                                          &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "gpu_map_transpose_f32_small");
    }
    {
        ctx->mainzicopy_28720 = clCreateKernel(prog, "mainzicopy_28720",
                                               &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.copy_28720");
    }
    {
        ctx->mainzicopy_28757 = clCreateKernel(prog, "mainzicopy_28757",
                                               &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.copy_28757");
    }
    {
        ctx->mainziscan_stage1_25387 = clCreateKernel(prog,
                                                      "mainziscan_stage1_25387",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_25387, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_25387");
    }
    {
        ctx->mainziscan_stage1_25420 = clCreateKernel(prog,
                                                      "mainziscan_stage1_25420",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_25420, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_25420");
    }
    {
        ctx->mainziscan_stage1_25428 = clCreateKernel(prog,
                                                      "mainziscan_stage1_25428",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_25428, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_25428");
    }
    {
        ctx->mainziscan_stage1_25436 = clCreateKernel(prog,
                                                      "mainziscan_stage1_25436",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_25436, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_25436, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_25436");
    }
    {
        ctx->mainziscan_stage1_25488 = clCreateKernel(prog,
                                                      "mainziscan_stage1_25488",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_25488, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_25488");
    }
    {
        ctx->mainziscan_stage2_25387 = clCreateKernel(prog,
                                                      "mainziscan_stage2_25387",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_25387, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_25387");
    }
    {
        ctx->mainziscan_stage2_25420 = clCreateKernel(prog,
                                                      "mainziscan_stage2_25420",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_25420, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_25420");
    }
    {
        ctx->mainziscan_stage2_25428 = clCreateKernel(prog,
                                                      "mainziscan_stage2_25428",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_25428, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_25428");
    }
    {
        ctx->mainziscan_stage2_25436 = clCreateKernel(prog,
                                                      "mainziscan_stage2_25436",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_25436, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_25436");
    }
    {
        ctx->mainziscan_stage2_25488 = clCreateKernel(prog,
                                                      "mainziscan_stage2_25488",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_25488, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_25488");
    }
    {
        ctx->mainziscan_stage3_25387 = clCreateKernel(prog,
                                                      "mainziscan_stage3_25387",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_25387, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_25387");
    }
    {
        ctx->mainziscan_stage3_25420 = clCreateKernel(prog,
                                                      "mainziscan_stage3_25420",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_25420, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_25420");
    }
    {
        ctx->mainziscan_stage3_25428 = clCreateKernel(prog,
                                                      "mainziscan_stage3_25428",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_25428, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_25428");
    }
    {
        ctx->mainziscan_stage3_25436 = clCreateKernel(prog,
                                                      "mainziscan_stage3_25436",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_25436, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_25436");
    }
    {
        ctx->mainziscan_stage3_25488 = clCreateKernel(prog,
                                                      "mainziscan_stage3_25488",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_25488, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_25488");
    }
    {
        ctx->mainziseghist_global_25405 = clCreateKernel(prog,
                                                         "mainziseghist_global_25405",
                                                         &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziseghist_global_25405, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "main.seghist_global_25405");
    }
    {
        ctx->mainziseghist_local_25405 = clCreateKernel(prog,
                                                        "mainziseghist_local_25405",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziseghist_local_25405, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.seghist_local_25405");
    }
    {
        ctx->mainzisegmap_24282 = clCreateKernel(prog, "mainzisegmap_24282",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_24282, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_24282, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_24282");
    }
    {
        ctx->mainzisegmap_24458 = clCreateKernel(prog, "mainzisegmap_24458",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_24458, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_24458, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_24458");
    }
    {
        ctx->mainzisegmap_24960 = clCreateKernel(prog, "mainzisegmap_24960",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_24960, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_24960");
    }
    {
        ctx->mainzisegmap_24998 = clCreateKernel(prog, "mainzisegmap_24998",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_24998, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_24998");
    }
    {
        ctx->mainzisegmap_25055 = clCreateKernel(prog, "mainzisegmap_25055",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25055, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25055, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_25055");
    }
    {
        ctx->mainzisegmap_25153 = clCreateKernel(prog, "mainzisegmap_25153",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25153, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_25153");
    }
    {
        ctx->mainzisegmap_25217 = clCreateKernel(prog, "mainzisegmap_25217",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25217, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_25217");
    }
    {
        ctx->mainzisegmap_25490 = clCreateKernel(prog, "mainzisegmap_25490",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25490, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_25490");
    }
    {
        ctx->mainzisegmap_25562 = clCreateKernel(prog, "mainzisegmap_25562",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25562, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_25562");
    }
    {
        ctx->mainzisegmap_25677 = clCreateKernel(prog, "mainzisegmap_25677",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_25677, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_25677");
    }
    {
        ctx->mainzisegmap_intragroup_24699 = clCreateKernel(prog,
                                                            "mainzisegmap_intragroup_24699",
                                                            &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                            0, sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                            2, sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "main.segmap_intragroup_24699");
    }
    {
        ctx->mainzisegmap_intragroup_25560 = clCreateKernel(prog,
                                                            "mainzisegmap_intragroup_25560",
                                                            &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_intragroup_25560,
                                            0, sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "main.segmap_intragroup_25560");
    }
    {
        ctx->mainzisegred_large_25712 = clCreateKernel(prog,
                                                       "mainzisegred_large_25712",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_large_25712, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_large_25712");
    }
    {
        ctx->mainzisegred_large_28390 = clCreateKernel(prog,
                                                       "mainzisegred_large_28390",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_large_28390, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_large_28390");
    }
    {
        ctx->mainzisegred_nonseg_24268 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_24268",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_24268, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_24268");
    }
    {
        ctx->mainzisegred_nonseg_25397 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_25397",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_25397, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_25397");
    }
    {
        ctx->mainzisegred_nonseg_25507 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_25507",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_25507, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_25507");
    }
    {
        ctx->mainzisegred_nonseg_25780 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_25780",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_25780, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_25780");
    }
    {
        ctx->mainzisegred_nonseg_27904 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_27904",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_27904, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_27904");
    }
    {
        ctx->mainzisegred_nonseg_27936 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_27936",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_27936, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_27936");
    }
    {
        ctx->mainzisegred_small_25712 = clCreateKernel(prog,
                                                       "mainzisegred_small_25712",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_small_25712, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_small_25712");
    }
    {
        ctx->mainzisegred_small_28390 = clCreateKernel(prog,
                                                       "mainzisegred_small_28390",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_small_28390, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_small_28390");
    }
    {
        ctx->testzicopy_28721 = clCreateKernel(prog, "testzicopy_28721",
                                               &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.copy_28721");
    }
    {
        ctx->testzicopy_28758 = clCreateKernel(prog, "testzicopy_28758",
                                               &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.copy_28758");
    }
    {
        ctx->testziscan_stage1_27050 = clCreateKernel(prog,
                                                      "testziscan_stage1_27050",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_27050, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_27050");
    }
    {
        ctx->testziscan_stage1_27083 = clCreateKernel(prog,
                                                      "testziscan_stage1_27083",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_27083, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_27083");
    }
    {
        ctx->testziscan_stage1_27091 = clCreateKernel(prog,
                                                      "testziscan_stage1_27091",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_27091, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_27091");
    }
    {
        ctx->testziscan_stage1_27099 = clCreateKernel(prog,
                                                      "testziscan_stage1_27099",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_27099, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_27099, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_27099");
    }
    {
        ctx->testziscan_stage1_27151 = clCreateKernel(prog,
                                                      "testziscan_stage1_27151",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_27151, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_27151");
    }
    {
        ctx->testziscan_stage2_27050 = clCreateKernel(prog,
                                                      "testziscan_stage2_27050",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_27050, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_27050");
    }
    {
        ctx->testziscan_stage2_27083 = clCreateKernel(prog,
                                                      "testziscan_stage2_27083",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_27083, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_27083");
    }
    {
        ctx->testziscan_stage2_27091 = clCreateKernel(prog,
                                                      "testziscan_stage2_27091",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_27091, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_27091");
    }
    {
        ctx->testziscan_stage2_27099 = clCreateKernel(prog,
                                                      "testziscan_stage2_27099",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_27099, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_27099");
    }
    {
        ctx->testziscan_stage2_27151 = clCreateKernel(prog,
                                                      "testziscan_stage2_27151",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_27151, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_27151");
    }
    {
        ctx->testziscan_stage3_27050 = clCreateKernel(prog,
                                                      "testziscan_stage3_27050",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_27050, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_27050");
    }
    {
        ctx->testziscan_stage3_27083 = clCreateKernel(prog,
                                                      "testziscan_stage3_27083",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_27083, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_27083");
    }
    {
        ctx->testziscan_stage3_27091 = clCreateKernel(prog,
                                                      "testziscan_stage3_27091",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_27091, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_27091");
    }
    {
        ctx->testziscan_stage3_27099 = clCreateKernel(prog,
                                                      "testziscan_stage3_27099",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_27099, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_27099");
    }
    {
        ctx->testziscan_stage3_27151 = clCreateKernel(prog,
                                                      "testziscan_stage3_27151",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_27151, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_27151");
    }
    {
        ctx->testziseghist_global_27068 = clCreateKernel(prog,
                                                         "testziseghist_global_27068",
                                                         &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziseghist_global_27068, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "test.seghist_global_27068");
    }
    {
        ctx->testziseghist_local_27068 = clCreateKernel(prog,
                                                        "testziseghist_local_27068",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziseghist_local_27068, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.seghist_local_27068");
    }
    {
        ctx->testzisegmap_25945 = clCreateKernel(prog, "testzisegmap_25945",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_25945, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_25945, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_25945");
    }
    {
        ctx->testzisegmap_26121 = clCreateKernel(prog, "testzisegmap_26121",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26121, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26121, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_26121");
    }
    {
        ctx->testzisegmap_26623 = clCreateKernel(prog, "testzisegmap_26623",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26623, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_26623");
    }
    {
        ctx->testzisegmap_26661 = clCreateKernel(prog, "testzisegmap_26661",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26661, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_26661");
    }
    {
        ctx->testzisegmap_26718 = clCreateKernel(prog, "testzisegmap_26718",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26718, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26718, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_26718");
    }
    {
        ctx->testzisegmap_26816 = clCreateKernel(prog, "testzisegmap_26816",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26816, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_26816");
    }
    {
        ctx->testzisegmap_26880 = clCreateKernel(prog, "testzisegmap_26880",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_26880, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_26880");
    }
    {
        ctx->testzisegmap_27153 = clCreateKernel(prog, "testzisegmap_27153",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27153, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_27153");
    }
    {
        ctx->testzisegmap_27216 = clCreateKernel(prog, "testzisegmap_27216",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27216, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_27216");
    }
    {
        ctx->testzisegmap_27291 = clCreateKernel(prog, "testzisegmap_27291",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27291, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_27291");
    }
    {
        ctx->testzisegmap_intragroup_26362 = clCreateKernel(prog,
                                                            "testzisegmap_intragroup_26362",
                                                            &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_intragroup_26362,
                                            0, sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_intragroup_26362,
                                            2, sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "test.segmap_intragroup_26362");
    }
    {
        ctx->testzisegred_large_27326 = clCreateKernel(prog,
                                                       "testzisegred_large_27326",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_large_27326, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_large_27326");
    }
    {
        ctx->testzisegred_large_28391 = clCreateKernel(prog,
                                                       "testzisegred_large_28391",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_large_28391, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_large_28391");
    }
    {
        ctx->testzisegred_nonseg_25931 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_25931",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_25931, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_25931");
    }
    {
        ctx->testzisegred_nonseg_27060 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_27060",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_27060, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_27060");
    }
    {
        ctx->testzisegred_nonseg_27169 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_27169",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_27169, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_27169");
    }
    {
        ctx->testzisegred_nonseg_27390 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_27390",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_27390, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_27390");
    }
    {
        ctx->testzisegred_nonseg_27990 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_27990",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_27990, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_27990");
    }
    {
        ctx->testzisegred_nonseg_28022 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_28022",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_28022, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_28022");
    }
    {
        ctx->testzisegred_small_27326 = clCreateKernel(prog,
                                                       "testzisegred_small_27326",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_small_27326, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_small_27326");
    }
    {
        ctx->testzisegred_small_28391 = clCreateKernel(prog,
                                                       "testzisegred_small_28391",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_small_28391, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_small_28391");
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28062.references = NULL;
        ctx->mainzicounter_mem_28062.size = 0;
        ctx->mainzicounter_mem_28062.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28062.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_28913,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28092.references = NULL;
        ctx->mainzicounter_mem_28092.size = 0;
        ctx->mainzicounter_mem_28092.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28092.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_28920,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28129.references = NULL;
        ctx->mainzicounter_mem_28129.size = 0;
        ctx->mainzicounter_mem_28129.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28129.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_28932,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28264.references = NULL;
        ctx->mainzicounter_mem_28264.size = 0;
        ctx->mainzicounter_mem_28264.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28264.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_28989,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzihist_locks_mem_28375.references = NULL;
        ctx->mainzihist_locks_mem_28375.size = 0;
        ctx->mainzihist_locks_mem_28375.mem = clCreateBuffer(ctx->opencl.ctx,
                                                             CL_MEM_READ_WRITE,
                                                             (100151 >
                                                              0 ? 100151 : 1) *
                                                             sizeof(int32_t),
                                                             NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (100151 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzihist_locks_mem_28375.mem,
                                                          CL_TRUE, 0, 100151 *
                                                          sizeof(int32_t),
                                                          mainzihist_locks_mem_realtype_29001,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28419.references = NULL;
        ctx->mainzicounter_mem_28419.size = 0;
        ctx->mainzicounter_mem_28419.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28419.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_29012,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28725.references = NULL;
        ctx->mainzicounter_mem_28725.size = 0;
        ctx->mainzicounter_mem_28725.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28725.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_29089,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28809.references = NULL;
        ctx->mainzicounter_mem_28809.size = 0;
        ctx->mainzicounter_mem_28809.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28809.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_29116,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_28849.references = NULL;
        ctx->mainzicounter_mem_28849.size = 0;
        ctx->mainzicounter_mem_28849.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_28849.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_29127,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzistatic_array_28059.references = NULL;
        ctx->testzistatic_array_28059.size = 0;
        ctx->testzistatic_array_28059.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (9 > 0 ? 9 : 1) *
                                                           sizeof(float), NULL,
                                                           &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (9 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzistatic_array_28059.mem,
                                                          CL_TRUE, 0, 9 *
                                                          sizeof(float),
                                                          testzistatic_array_realtype_29135,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzistatic_array_28060.references = NULL;
        ctx->testzistatic_array_28060.size = 0;
        ctx->testzistatic_array_28060.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (9 > 0 ? 9 : 1) *
                                                           sizeof(int64_t),
                                                           NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (9 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzistatic_array_28060.mem,
                                                          CL_TRUE, 0, 9 *
                                                          sizeof(int64_t),
                                                          testzistatic_array_realtype_29136,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzistatic_array_28061.references = NULL;
        ctx->testzistatic_array_28061.size = 0;
        ctx->testzistatic_array_28061.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (9 > 0 ? 9 : 1) *
                                                           sizeof(float), NULL,
                                                           &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (9 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzistatic_array_28061.mem,
                                                          CL_TRUE, 0, 9 *
                                                          sizeof(float),
                                                          testzistatic_array_realtype_29137,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28063.references = NULL;
        ctx->testzicounter_mem_28063.size = 0;
        ctx->testzicounter_mem_28063.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28063.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29138,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28093.references = NULL;
        ctx->testzicounter_mem_28093.size = 0;
        ctx->testzicounter_mem_28093.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28093.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29145,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28130.references = NULL;
        ctx->testzicounter_mem_28130.size = 0;
        ctx->testzicounter_mem_28130.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28130.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29157,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28265.references = NULL;
        ctx->testzicounter_mem_28265.size = 0;
        ctx->testzicounter_mem_28265.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28265.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29214,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzihist_locks_mem_28376.references = NULL;
        ctx->testzihist_locks_mem_28376.size = 0;
        ctx->testzihist_locks_mem_28376.mem = clCreateBuffer(ctx->opencl.ctx,
                                                             CL_MEM_READ_WRITE,
                                                             (100151 >
                                                              0 ? 100151 : 1) *
                                                             sizeof(int32_t),
                                                             NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (100151 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzihist_locks_mem_28376.mem,
                                                          CL_TRUE, 0, 100151 *
                                                          sizeof(int32_t),
                                                          testzihist_locks_mem_realtype_29226,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28420.references = NULL;
        ctx->testzicounter_mem_28420.size = 0;
        ctx->testzicounter_mem_28420.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28420.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29237,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28726.references = NULL;
        ctx->testzicounter_mem_28726.size = 0;
        ctx->testzicounter_mem_28726.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28726.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29314,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28799.references = NULL;
        ctx->testzicounter_mem_28799.size = 0;
        ctx->testzicounter_mem_28799.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28799.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29336,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_28838.references = NULL;
        ctx->testzicounter_mem_28838.size = 0;
        ctx->testzicounter_mem_28838.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_28838.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_29347,
                                                          0, NULL, NULL));
    }
    ctx->sizes.builtinzhreplicate_f32zigroup_sizze_28711 = cfg->sizes[0];
    ctx->sizes.builtinzhreplicate_i64zigroup_sizze_28302 = cfg->sizes[1];
    ctx->sizes.mainziL2_sizze_28367 = cfg->sizes[2];
    ctx->sizes.mainzigroup_sizze_28723 = cfg->sizes[3];
    ctx->sizes.mainzigroup_sizze_28760 = cfg->sizes[4];
    ctx->sizes.mainziseghist_group_sizze_25399 = cfg->sizes[5];
    ctx->sizes.mainziseghist_num_groups_25401 = cfg->sizes[6];
    ctx->sizes.mainzisegmap_group_sizze_24284 = cfg->sizes[7];
    ctx->sizes.mainzisegmap_group_sizze_24460 = cfg->sizes[8];
    ctx->sizes.mainzisegmap_group_sizze_24964 = cfg->sizes[9];
    ctx->sizes.mainzisegmap_group_sizze_25002 = cfg->sizes[10];
    ctx->sizes.mainzisegmap_group_sizze_25057 = cfg->sizes[11];
    ctx->sizes.mainzisegmap_group_sizze_25156 = cfg->sizes[12];
    ctx->sizes.mainzisegmap_group_sizze_25219 = cfg->sizes[13];
    ctx->sizes.mainzisegmap_group_sizze_25492 = cfg->sizes[14];
    ctx->sizes.mainzisegmap_group_sizze_25564 = cfg->sizes[15];
    ctx->sizes.mainzisegmap_group_sizze_25679 = cfg->sizes[16];
    ctx->sizes.mainzisegmap_num_groups_25059 = cfg->sizes[17];
    ctx->sizes.mainzisegred_group_sizze_24260 = cfg->sizes[18];
    ctx->sizes.mainzisegred_group_sizze_25389 = cfg->sizes[19];
    ctx->sizes.mainzisegred_group_sizze_25498 = cfg->sizes[20];
    ctx->sizes.mainzisegred_group_sizze_25706 = cfg->sizes[21];
    ctx->sizes.mainzisegred_group_sizze_25772 = cfg->sizes[22];
    ctx->sizes.mainzisegred_group_sizze_27899 = cfg->sizes[23];
    ctx->sizes.mainzisegred_group_sizze_27931 = cfg->sizes[24];
    ctx->sizes.mainzisegred_num_groups_24262 = cfg->sizes[25];
    ctx->sizes.mainzisegred_num_groups_25391 = cfg->sizes[26];
    ctx->sizes.mainzisegred_num_groups_25500 = cfg->sizes[27];
    ctx->sizes.mainzisegred_num_groups_25708 = cfg->sizes[28];
    ctx->sizes.mainzisegred_num_groups_25774 = cfg->sizes[29];
    ctx->sizes.mainzisegred_num_groups_27897 = cfg->sizes[30];
    ctx->sizes.mainzisegred_num_groups_27929 = cfg->sizes[31];
    ctx->sizes.mainzisegscan_group_sizze_25381 = cfg->sizes[32];
    ctx->sizes.mainzisegscan_group_sizze_25414 = cfg->sizes[33];
    ctx->sizes.mainzisegscan_group_sizze_25422 = cfg->sizes[34];
    ctx->sizes.mainzisegscan_group_sizze_25430 = cfg->sizes[35];
    ctx->sizes.mainzisegscan_group_sizze_25482 = cfg->sizes[36];
    ctx->sizes.mainzisegscan_num_groups_25383 = cfg->sizes[37];
    ctx->sizes.mainzisegscan_num_groups_25416 = cfg->sizes[38];
    ctx->sizes.mainzisegscan_num_groups_25424 = cfg->sizes[39];
    ctx->sizes.mainzisegscan_num_groups_25432 = cfg->sizes[40];
    ctx->sizes.mainzisegscan_num_groups_25484 = cfg->sizes[41];
    ctx->sizes.mainzisuff_intra_par_12 = cfg->sizes[42];
    ctx->sizes.mainzisuff_intra_par_3 = cfg->sizes[43];
    ctx->sizes.mainzisuff_outer_par_0 = cfg->sizes[44];
    ctx->sizes.mainzisuff_outer_par_11 = cfg->sizes[45];
    ctx->sizes.mainzisuff_outer_redomap_10 = cfg->sizes[46];
    ctx->sizes.testziL2_sizze_28368 = cfg->sizes[47];
    ctx->sizes.testzigroup_sizze_28724 = cfg->sizes[48];
    ctx->sizes.testzigroup_sizze_28761 = cfg->sizes[49];
    ctx->sizes.testziseghist_group_sizze_27062 = cfg->sizes[50];
    ctx->sizes.testziseghist_num_groups_27064 = cfg->sizes[51];
    ctx->sizes.testzisegmap_group_sizze_25947 = cfg->sizes[52];
    ctx->sizes.testzisegmap_group_sizze_26123 = cfg->sizes[53];
    ctx->sizes.testzisegmap_group_sizze_26627 = cfg->sizes[54];
    ctx->sizes.testzisegmap_group_sizze_26665 = cfg->sizes[55];
    ctx->sizes.testzisegmap_group_sizze_26720 = cfg->sizes[56];
    ctx->sizes.testzisegmap_group_sizze_26819 = cfg->sizes[57];
    ctx->sizes.testzisegmap_group_sizze_26882 = cfg->sizes[58];
    ctx->sizes.testzisegmap_group_sizze_27155 = cfg->sizes[59];
    ctx->sizes.testzisegmap_group_sizze_27218 = cfg->sizes[60];
    ctx->sizes.testzisegmap_group_sizze_27293 = cfg->sizes[61];
    ctx->sizes.testzisegmap_num_groups_26722 = cfg->sizes[62];
    ctx->sizes.testzisegred_group_sizze_25923 = cfg->sizes[63];
    ctx->sizes.testzisegred_group_sizze_27052 = cfg->sizes[64];
    ctx->sizes.testzisegred_group_sizze_27161 = cfg->sizes[65];
    ctx->sizes.testzisegred_group_sizze_27320 = cfg->sizes[66];
    ctx->sizes.testzisegred_group_sizze_27382 = cfg->sizes[67];
    ctx->sizes.testzisegred_group_sizze_27985 = cfg->sizes[68];
    ctx->sizes.testzisegred_group_sizze_28017 = cfg->sizes[69];
    ctx->sizes.testzisegred_num_groups_25925 = cfg->sizes[70];
    ctx->sizes.testzisegred_num_groups_27054 = cfg->sizes[71];
    ctx->sizes.testzisegred_num_groups_27163 = cfg->sizes[72];
    ctx->sizes.testzisegred_num_groups_27322 = cfg->sizes[73];
    ctx->sizes.testzisegred_num_groups_27384 = cfg->sizes[74];
    ctx->sizes.testzisegred_num_groups_27983 = cfg->sizes[75];
    ctx->sizes.testzisegred_num_groups_28015 = cfg->sizes[76];
    ctx->sizes.testzisegscan_group_sizze_27044 = cfg->sizes[77];
    ctx->sizes.testzisegscan_group_sizze_27077 = cfg->sizes[78];
    ctx->sizes.testzisegscan_group_sizze_27085 = cfg->sizes[79];
    ctx->sizes.testzisegscan_group_sizze_27093 = cfg->sizes[80];
    ctx->sizes.testzisegscan_group_sizze_27145 = cfg->sizes[81];
    ctx->sizes.testzisegscan_num_groups_27046 = cfg->sizes[82];
    ctx->sizes.testzisegscan_num_groups_27079 = cfg->sizes[83];
    ctx->sizes.testzisegscan_num_groups_27087 = cfg->sizes[84];
    ctx->sizes.testzisegscan_num_groups_27095 = cfg->sizes[85];
    ctx->sizes.testzisegscan_num_groups_27147 = cfg->sizes[86];
    ctx->sizes.testzisuff_intra_par_3 = cfg->sizes[87];
    ctx->sizes.testzisuff_outer_par_0 = cfg->sizes[88];
    ctx->sizes.testzisuff_outer_par_11 = cfg->sizes[89];
    ctx->sizes.testzisuff_outer_redomap_10 = cfg->sizes[90];
    init_constants(ctx);
    // Clear the free list of any deallocations that occurred while initialising constants.
    OPENCL_SUCCEED_OR_RETURN(opencl_free_all(&ctx->opencl));
    // The program will be properly freed after all the kernels have also been freed.
    OPENCL_SUCCEED_OR_RETURN(clReleaseProgram(prog));
    return futhark_context_sync(ctx);
}
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg)
{
    struct futhark_context *ctx =
                           (struct futhark_context *) malloc(sizeof(struct futhark_context));
    
    if (ctx == NULL)
        return NULL;
    
    int required_types = 0;
    
    init_context_early(cfg, ctx);
    
    cl_program prog = setup_opencl(&ctx->opencl, opencl_program, required_types,
                                   cfg->build_opts);
    
    init_context_late(cfg, ctx, prog);
    return ctx;
}
struct futhark_context *futhark_context_new_with_command_queue(struct futhark_context_config *cfg,
                                                               cl_command_queue queue)
{
    struct futhark_context *ctx =
                           (struct futhark_context *) malloc(sizeof(struct futhark_context));
    
    if (ctx == NULL)
        return NULL;
    
    int required_types = 0;
    
    init_context_early(cfg, ctx);
    
    cl_program prog = setup_opencl_with_command_queue(&ctx->opencl, queue,
                                                      opencl_program,
                                                      required_types,
                                                      cfg->build_opts);
    
    init_context_late(cfg, ctx, prog);
    return ctx;
}
void futhark_context_free(struct futhark_context *ctx)
{
    free_constants(ctx);
    free_lock(&ctx->lock);
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->builtinzhreplicate_f32zireplicate_28708));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->builtinzhreplicate_i64zireplicate_28299));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32_low_height));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32_low_width));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32_small));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzicopy_28720));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzicopy_28757));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_25387));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_25420));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_25428));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_25436));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_25488));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_25387));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_25420));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_25428));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_25436));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_25488));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_25387));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_25420));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_25428));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_25436));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_25488));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziseghist_global_25405));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziseghist_local_25405));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_24282));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_24458));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_24960));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_24998));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_25055));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_25153));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_25217));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_25490));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_25562));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_25677));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_intragroup_24699));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_intragroup_25560));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_large_25712));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_large_28390));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_24268));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_25397));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_25507));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_25780));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_27904));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_27936));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_small_25712));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_small_28390));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzicopy_28721));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzicopy_28758));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_27050));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_27083));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_27091));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_27099));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_27151));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_27050));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_27083));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_27091));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_27099));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_27151));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_27050));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_27083));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_27091));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_27099));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_27151));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziseghist_global_27068));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziseghist_local_27068));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_25945));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_26121));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_26623));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_26661));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_26718));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_26816));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_26880));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_27153));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_27216));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_27291));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_intragroup_26362));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_large_27326));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_large_28391));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_25931));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_27060));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_27169));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_27390));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_27990));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_28022));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_small_27326));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_small_28391));
    teardown_opencl(&ctx->opencl);
    free(ctx);
}
int futhark_context_sync(struct futhark_context *ctx)
{
    cl_int failure_idx = -1;
    
    if (ctx->failure_is_an_option) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     ctx->global_failure,
                                                     CL_FALSE, 0,
                                                     sizeof(cl_int),
                                                     &failure_idx, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        ctx->failure_is_an_option = 0;
    }
    OPENCL_SUCCEED_OR_RETURN(clFinish(ctx->opencl.queue));
    if (failure_idx >= 0) {
        cl_int no_failure = -1;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                      ctx->global_failure,
                                                      CL_TRUE, 0,
                                                      sizeof(cl_int),
                                                      &no_failure, 0, NULL,
                                                      NULL));
        
        int64_t args[3 + 1];
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     ctx->global_failure_args,
                                                     CL_TRUE, 0, sizeof(args),
                                                     &args, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_host_runs,
                                                                                               &ctx->copy_dev_to_host_total_runtime)));
        switch (failure_idx) {
            
          case 0:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva2.fut:54:29-52\n   #1  cva2.fut:95:25-65\n   #2  cva2.fut:109:16-62\n   #3  cva2.fut:105:17-109:85\n   #4  cva2.fut:100:1-154:20\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 1:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:96:47-70\n   #1  cva2.fut:109:16-62\n   #2  cva2.fut:105:17-109:85\n   #3  cva2.fut:100:1-154:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 2:
            {
                ctx->error =
                    msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:97:74-90\n   #1  cva2.fut:109:16-62\n   #2  cva2.fut:105:17-109:85\n   #3  cva2.fut:100:1-154:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 3:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva2.fut:54:29-52\n   #1  cva2.fut:95:25-65\n   #2  cva2.fut:109:16-62\n   #3  cva2.fut:105:17-109:85\n   #4  cva2.fut:100:1-154:20\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 4:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:96:47-70\n   #1  cva2.fut:109:16-62\n   #2  cva2.fut:105:17-109:85\n   #3  cva2.fut:100:1-154:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 5:
            {
                ctx->error =
                    msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:97:74-90\n   #1  cva2.fut:109:16-62\n   #2  cva2.fut:105:17-109:85\n   #3  cva2.fut:100:1-154:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 6:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:71:97-104\n   #1  cva2.fut:123:32-62\n   #2  cva2.fut:123:22-69\n   #3  cva2.fut:100:1-154:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 7:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:71:58-105\n   #1  cva2.fut:123:32-62\n   #2  cva2.fut:123:22-69\n   #3  cva2.fut:100:1-154:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 8:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:71:97-104\n   #1  cva2.fut:123:32-62\n   #2  cva2.fut:123:22-69\n   #3  cva2.fut:100:1-154:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 9:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:71:58-105\n   #1  cva2.fut:123:32-62\n   #2  cva2.fut:123:22-69\n   #3  cva2.fut:100:1-154:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 10:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/segmented/segmented.fut:90:30-35\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:90:12-49\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva2.fut:134:18-77\n   #6  cva2.fut:100:1-154:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 11:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva2.fut:54:29-52\n   #1  cva2.fut:95:25-65\n   #2  cva2.fut:109:16-62\n   #3  cva2.fut:105:17-109:85\n   #4  cva2.fut:162:3-120\n   #5  cva2.fut:161:1-162:128\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 12:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:96:47-70\n   #1  cva2.fut:109:16-62\n   #2  cva2.fut:105:17-109:85\n   #3  cva2.fut:162:3-120\n   #4  cva2.fut:161:1-162:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 13:
            {
                ctx->error =
                    msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:97:74-90\n   #1  cva2.fut:109:16-62\n   #2  cva2.fut:105:17-109:85\n   #3  cva2.fut:162:3-120\n   #4  cva2.fut:161:1-162:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 14:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva2.fut:54:29-52\n   #1  cva2.fut:95:25-65\n   #2  cva2.fut:109:16-62\n   #3  cva2.fut:105:17-109:85\n   #4  cva2.fut:162:3-120\n   #5  cva2.fut:161:1-162:128\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 15:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:96:47-70\n   #1  cva2.fut:109:16-62\n   #2  cva2.fut:105:17-109:85\n   #3  cva2.fut:162:3-120\n   #4  cva2.fut:161:1-162:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 16:
            {
                ctx->error =
                    msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:97:74-90\n   #1  cva2.fut:109:16-62\n   #2  cva2.fut:105:17-109:85\n   #3  cva2.fut:162:3-120\n   #4  cva2.fut:161:1-162:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 17:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:71:97-104\n   #1  cva2.fut:123:32-62\n   #2  cva2.fut:123:22-69\n   #3  cva2.fut:162:3-120\n   #4  cva2.fut:161:1-162:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 18:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:71:58-105\n   #1  cva2.fut:123:32-62\n   #2  cva2.fut:123:22-69\n   #3  cva2.fut:162:3-120\n   #4  cva2.fut:161:1-162:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 19:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:71:97-104\n   #1  cva2.fut:123:32-62\n   #2  cva2.fut:123:22-69\n   #3  cva2.fut:162:3-120\n   #4  cva2.fut:161:1-162:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 20:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva2.fut:71:58-105\n   #1  cva2.fut:123:32-62\n   #2  cva2.fut:123:22-69\n   #3  cva2.fut:162:3-120\n   #4  cva2.fut:161:1-162:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 21:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/segmented/segmented.fut:90:30-35\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:90:12-49\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva2.fut:134:18-77\n   #6  cva2.fut:162:3-120\n   #7  cva2.fut:161:1-162:128\n",
                              args[0], args[1]);
                break;
            }
        }
        return 1;
    }
    return 0;
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    ctx->error = OPENCL_SUCCEED_NONFATAL(opencl_free_all(&ctx->opencl));
    return ctx->error != NULL;
}
cl_command_queue futhark_context_get_command_queue(struct futhark_context *ctx)
{
    return ctx->opencl.queue;
}
static int memblock_unref_device(struct futhark_context *ctx,
                                 struct memblock_device *block, const
                                 char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(stderr,
                    "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n",
                    desc, block->desc, "space 'device'", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_device -= block->size;
            OPENCL_SUCCEED_OR_RETURN(opencl_free(&ctx->opencl, block->mem,
                                                 desc));
            free(block->references);
            if (ctx->detail_memory)
                fprintf(stderr,
                        "%lld bytes freed (now allocated: %lld bytes)\n",
                        (long long) block->size,
                        (long long) ctx->cur_mem_usage_device);
        }
        block->references = NULL;
    }
    return 0;
}
static int memblock_alloc_device(struct futhark_context *ctx,
                                 struct memblock_device *block, int64_t size,
                                 const char *desc)
{
    if (size < 0)
        futhark_panic(1,
                      "Negative allocation of %lld bytes attempted for %s in %s.\n",
                      (long long) size, desc, "space 'device'",
                      ctx->cur_mem_usage_device);
    
    int ret = memblock_unref_device(ctx, block, desc);
    
    ctx->cur_mem_usage_device += size;
    if (ctx->detail_memory)
        fprintf(stderr,
                "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)",
                (long long) size, desc, "space 'device'",
                (long long) ctx->cur_mem_usage_device);
    if (ctx->cur_mem_usage_device > ctx->peak_mem_usage_device) {
        ctx->peak_mem_usage_device = ctx->cur_mem_usage_device;
        if (ctx->detail_memory)
            fprintf(stderr, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(stderr, ".\n");
    OPENCL_SUCCEED_OR_RETURN(opencl_alloc(&ctx->opencl, size, desc,
                                          &block->mem));
    block->references = (int *) malloc(sizeof(int));
    *block->references = 1;
    block->size = size;
    block->desc = desc;
    return ret;
}
static int memblock_set_device(struct futhark_context *ctx,
                               struct memblock_device *lhs,
                               struct memblock_device *rhs, const
                               char *lhs_desc)
{
    int ret = memblock_unref_device(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
static int memblock_unref(struct futhark_context *ctx, struct memblock *block,
                          const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(stderr,
                    "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n",
                    desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            free(block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(stderr,
                        "%lld bytes freed (now allocated: %lld bytes)\n",
                        (long long) block->size,
                        (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
static int memblock_alloc(struct futhark_context *ctx, struct memblock *block,
                          int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1,
                      "Negative allocation of %lld bytes attempted for %s in %s.\n",
                      (long long) size, desc, "default space",
                      ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    ctx->cur_mem_usage_default += size;
    if (ctx->detail_memory)
        fprintf(stderr,
                "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)",
                (long long) size, desc, "default space",
                (long long) ctx->cur_mem_usage_default);
    if (ctx->cur_mem_usage_default > ctx->peak_mem_usage_default) {
        ctx->peak_mem_usage_default = ctx->cur_mem_usage_default;
        if (ctx->detail_memory)
            fprintf(stderr, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(stderr, ".\n");
    block->mem = (char *) malloc(size);
    block->references = (int *) malloc(sizeof(int));
    *block->references = 1;
    block->size = size;
    block->desc = desc;
    return ret;
}
static int memblock_set(struct futhark_context *ctx, struct memblock *lhs,
                        struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    struct str_builder builder;
    
    str_builder_init(&builder);
    if (ctx->detail_memory || ctx->profiling) {
        str_builder(&builder,
                    "Peak memory usage for space 'device': %lld bytes.\n",
                    (long long) ctx->peak_mem_usage_device);
        { }
    }
    if (ctx->profiling) {
        OPENCL_SUCCEED_FATAL(opencl_tally_profiling_records(&ctx->opencl));
        str_builder(&builder,
                    "copy_dev_to_dev                       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_dev_to_dev_runs,
                    (long) ctx->copy_dev_to_dev_total_runtime /
                    (ctx->copy_dev_to_dev_runs !=
                     0 ? ctx->copy_dev_to_dev_runs : 1),
                    (long) ctx->copy_dev_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_dev_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_dev_to_dev_runs;
        str_builder(&builder,
                    "copy_dev_to_host                      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_dev_to_host_runs,
                    (long) ctx->copy_dev_to_host_total_runtime /
                    (ctx->copy_dev_to_host_runs !=
                     0 ? ctx->copy_dev_to_host_runs : 1),
                    (long) ctx->copy_dev_to_host_total_runtime);
        ctx->total_runtime += ctx->copy_dev_to_host_total_runtime;
        ctx->total_runs += ctx->copy_dev_to_host_runs;
        str_builder(&builder,
                    "copy_host_to_dev                      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_host_to_dev_runs,
                    (long) ctx->copy_host_to_dev_total_runtime /
                    (ctx->copy_host_to_dev_runs !=
                     0 ? ctx->copy_host_to_dev_runs : 1),
                    (long) ctx->copy_host_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_host_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_host_to_dev_runs;
        str_builder(&builder,
                    "copy_scalar_to_dev                    ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_scalar_to_dev_runs,
                    (long) ctx->copy_scalar_to_dev_total_runtime /
                    (ctx->copy_scalar_to_dev_runs !=
                     0 ? ctx->copy_scalar_to_dev_runs : 1),
                    (long) ctx->copy_scalar_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_scalar_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_scalar_to_dev_runs;
        str_builder(&builder,
                    "copy_scalar_from_dev                  ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_scalar_from_dev_runs,
                    (long) ctx->copy_scalar_from_dev_total_runtime /
                    (ctx->copy_scalar_from_dev_runs !=
                     0 ? ctx->copy_scalar_from_dev_runs : 1),
                    (long) ctx->copy_scalar_from_dev_total_runtime);
        ctx->total_runtime += ctx->copy_scalar_from_dev_total_runtime;
        ctx->total_runs += ctx->copy_scalar_from_dev_runs;
        str_builder(&builder,
                    "builtin#replicate_f32.replicate_28708 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhreplicate_f32zireplicate_28708_runs,
                    (long) ctx->builtinzhreplicate_f32zireplicate_28708_total_runtime /
                    (ctx->builtinzhreplicate_f32zireplicate_28708_runs !=
                     0 ? ctx->builtinzhreplicate_f32zireplicate_28708_runs : 1),
                    (long) ctx->builtinzhreplicate_f32zireplicate_28708_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhreplicate_f32zireplicate_28708_total_runtime;
        ctx->total_runs += ctx->builtinzhreplicate_f32zireplicate_28708_runs;
        str_builder(&builder,
                    "builtin#replicate_i64.replicate_28299 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhreplicate_i64zireplicate_28299_runs,
                    (long) ctx->builtinzhreplicate_i64zireplicate_28299_total_runtime /
                    (ctx->builtinzhreplicate_i64zireplicate_28299_runs !=
                     0 ? ctx->builtinzhreplicate_i64zireplicate_28299_runs : 1),
                    (long) ctx->builtinzhreplicate_i64zireplicate_28299_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhreplicate_i64zireplicate_28299_total_runtime;
        ctx->total_runs += ctx->builtinzhreplicate_i64zireplicate_28299_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32                 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_runs,
                    (long) ctx->gpu_map_transpose_f32_total_runtime /
                    (ctx->gpu_map_transpose_f32_runs !=
                     0 ? ctx->gpu_map_transpose_f32_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_total_runtime);
        ctx->total_runtime += ctx->gpu_map_transpose_f32_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32_low_height      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_low_height_runs,
                    (long) ctx->gpu_map_transpose_f32_low_height_total_runtime /
                    (ctx->gpu_map_transpose_f32_low_height_runs !=
                     0 ? ctx->gpu_map_transpose_f32_low_height_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_low_height_total_runtime);
        ctx->total_runtime +=
            ctx->gpu_map_transpose_f32_low_height_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_low_height_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32_low_width       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_low_width_runs,
                    (long) ctx->gpu_map_transpose_f32_low_width_total_runtime /
                    (ctx->gpu_map_transpose_f32_low_width_runs !=
                     0 ? ctx->gpu_map_transpose_f32_low_width_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_low_width_total_runtime);
        ctx->total_runtime +=
            ctx->gpu_map_transpose_f32_low_width_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_low_width_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32_small           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_small_runs,
                    (long) ctx->gpu_map_transpose_f32_small_total_runtime /
                    (ctx->gpu_map_transpose_f32_small_runs !=
                     0 ? ctx->gpu_map_transpose_f32_small_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_small_total_runtime);
        ctx->total_runtime += ctx->gpu_map_transpose_f32_small_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_small_runs;
        str_builder(&builder,
                    "main.copy_28720                       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzicopy_28720_runs,
                    (long) ctx->mainzicopy_28720_total_runtime /
                    (ctx->mainzicopy_28720_runs !=
                     0 ? ctx->mainzicopy_28720_runs : 1),
                    (long) ctx->mainzicopy_28720_total_runtime);
        ctx->total_runtime += ctx->mainzicopy_28720_total_runtime;
        ctx->total_runs += ctx->mainzicopy_28720_runs;
        str_builder(&builder,
                    "main.copy_28757                       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzicopy_28757_runs,
                    (long) ctx->mainzicopy_28757_total_runtime /
                    (ctx->mainzicopy_28757_runs !=
                     0 ? ctx->mainzicopy_28757_runs : 1),
                    (long) ctx->mainzicopy_28757_total_runtime);
        ctx->total_runtime += ctx->mainzicopy_28757_total_runtime;
        ctx->total_runs += ctx->mainzicopy_28757_runs;
        str_builder(&builder,
                    "main.scan_stage1_25387                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_25387_runs,
                    (long) ctx->mainziscan_stage1_25387_total_runtime /
                    (ctx->mainziscan_stage1_25387_runs !=
                     0 ? ctx->mainziscan_stage1_25387_runs : 1),
                    (long) ctx->mainziscan_stage1_25387_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_25387_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_25387_runs;
        str_builder(&builder,
                    "main.scan_stage1_25420                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_25420_runs,
                    (long) ctx->mainziscan_stage1_25420_total_runtime /
                    (ctx->mainziscan_stage1_25420_runs !=
                     0 ? ctx->mainziscan_stage1_25420_runs : 1),
                    (long) ctx->mainziscan_stage1_25420_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_25420_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_25420_runs;
        str_builder(&builder,
                    "main.scan_stage1_25428                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_25428_runs,
                    (long) ctx->mainziscan_stage1_25428_total_runtime /
                    (ctx->mainziscan_stage1_25428_runs !=
                     0 ? ctx->mainziscan_stage1_25428_runs : 1),
                    (long) ctx->mainziscan_stage1_25428_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_25428_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_25428_runs;
        str_builder(&builder,
                    "main.scan_stage1_25436                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_25436_runs,
                    (long) ctx->mainziscan_stage1_25436_total_runtime /
                    (ctx->mainziscan_stage1_25436_runs !=
                     0 ? ctx->mainziscan_stage1_25436_runs : 1),
                    (long) ctx->mainziscan_stage1_25436_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_25436_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_25436_runs;
        str_builder(&builder,
                    "main.scan_stage1_25488                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_25488_runs,
                    (long) ctx->mainziscan_stage1_25488_total_runtime /
                    (ctx->mainziscan_stage1_25488_runs !=
                     0 ? ctx->mainziscan_stage1_25488_runs : 1),
                    (long) ctx->mainziscan_stage1_25488_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_25488_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_25488_runs;
        str_builder(&builder,
                    "main.scan_stage2_25387                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_25387_runs,
                    (long) ctx->mainziscan_stage2_25387_total_runtime /
                    (ctx->mainziscan_stage2_25387_runs !=
                     0 ? ctx->mainziscan_stage2_25387_runs : 1),
                    (long) ctx->mainziscan_stage2_25387_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_25387_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_25387_runs;
        str_builder(&builder,
                    "main.scan_stage2_25420                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_25420_runs,
                    (long) ctx->mainziscan_stage2_25420_total_runtime /
                    (ctx->mainziscan_stage2_25420_runs !=
                     0 ? ctx->mainziscan_stage2_25420_runs : 1),
                    (long) ctx->mainziscan_stage2_25420_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_25420_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_25420_runs;
        str_builder(&builder,
                    "main.scan_stage2_25428                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_25428_runs,
                    (long) ctx->mainziscan_stage2_25428_total_runtime /
                    (ctx->mainziscan_stage2_25428_runs !=
                     0 ? ctx->mainziscan_stage2_25428_runs : 1),
                    (long) ctx->mainziscan_stage2_25428_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_25428_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_25428_runs;
        str_builder(&builder,
                    "main.scan_stage2_25436                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_25436_runs,
                    (long) ctx->mainziscan_stage2_25436_total_runtime /
                    (ctx->mainziscan_stage2_25436_runs !=
                     0 ? ctx->mainziscan_stage2_25436_runs : 1),
                    (long) ctx->mainziscan_stage2_25436_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_25436_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_25436_runs;
        str_builder(&builder,
                    "main.scan_stage2_25488                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_25488_runs,
                    (long) ctx->mainziscan_stage2_25488_total_runtime /
                    (ctx->mainziscan_stage2_25488_runs !=
                     0 ? ctx->mainziscan_stage2_25488_runs : 1),
                    (long) ctx->mainziscan_stage2_25488_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_25488_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_25488_runs;
        str_builder(&builder,
                    "main.scan_stage3_25387                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_25387_runs,
                    (long) ctx->mainziscan_stage3_25387_total_runtime /
                    (ctx->mainziscan_stage3_25387_runs !=
                     0 ? ctx->mainziscan_stage3_25387_runs : 1),
                    (long) ctx->mainziscan_stage3_25387_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_25387_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_25387_runs;
        str_builder(&builder,
                    "main.scan_stage3_25420                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_25420_runs,
                    (long) ctx->mainziscan_stage3_25420_total_runtime /
                    (ctx->mainziscan_stage3_25420_runs !=
                     0 ? ctx->mainziscan_stage3_25420_runs : 1),
                    (long) ctx->mainziscan_stage3_25420_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_25420_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_25420_runs;
        str_builder(&builder,
                    "main.scan_stage3_25428                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_25428_runs,
                    (long) ctx->mainziscan_stage3_25428_total_runtime /
                    (ctx->mainziscan_stage3_25428_runs !=
                     0 ? ctx->mainziscan_stage3_25428_runs : 1),
                    (long) ctx->mainziscan_stage3_25428_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_25428_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_25428_runs;
        str_builder(&builder,
                    "main.scan_stage3_25436                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_25436_runs,
                    (long) ctx->mainziscan_stage3_25436_total_runtime /
                    (ctx->mainziscan_stage3_25436_runs !=
                     0 ? ctx->mainziscan_stage3_25436_runs : 1),
                    (long) ctx->mainziscan_stage3_25436_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_25436_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_25436_runs;
        str_builder(&builder,
                    "main.scan_stage3_25488                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_25488_runs,
                    (long) ctx->mainziscan_stage3_25488_total_runtime /
                    (ctx->mainziscan_stage3_25488_runs !=
                     0 ? ctx->mainziscan_stage3_25488_runs : 1),
                    (long) ctx->mainziscan_stage3_25488_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_25488_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_25488_runs;
        str_builder(&builder,
                    "main.seghist_global_25405             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziseghist_global_25405_runs,
                    (long) ctx->mainziseghist_global_25405_total_runtime /
                    (ctx->mainziseghist_global_25405_runs !=
                     0 ? ctx->mainziseghist_global_25405_runs : 1),
                    (long) ctx->mainziseghist_global_25405_total_runtime);
        ctx->total_runtime += ctx->mainziseghist_global_25405_total_runtime;
        ctx->total_runs += ctx->mainziseghist_global_25405_runs;
        str_builder(&builder,
                    "main.seghist_local_25405              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziseghist_local_25405_runs,
                    (long) ctx->mainziseghist_local_25405_total_runtime /
                    (ctx->mainziseghist_local_25405_runs !=
                     0 ? ctx->mainziseghist_local_25405_runs : 1),
                    (long) ctx->mainziseghist_local_25405_total_runtime);
        ctx->total_runtime += ctx->mainziseghist_local_25405_total_runtime;
        ctx->total_runs += ctx->mainziseghist_local_25405_runs;
        str_builder(&builder,
                    "main.segmap_24282                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_24282_runs,
                    (long) ctx->mainzisegmap_24282_total_runtime /
                    (ctx->mainzisegmap_24282_runs !=
                     0 ? ctx->mainzisegmap_24282_runs : 1),
                    (long) ctx->mainzisegmap_24282_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_24282_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_24282_runs;
        str_builder(&builder,
                    "main.segmap_24458                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_24458_runs,
                    (long) ctx->mainzisegmap_24458_total_runtime /
                    (ctx->mainzisegmap_24458_runs !=
                     0 ? ctx->mainzisegmap_24458_runs : 1),
                    (long) ctx->mainzisegmap_24458_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_24458_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_24458_runs;
        str_builder(&builder,
                    "main.segmap_24960                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_24960_runs,
                    (long) ctx->mainzisegmap_24960_total_runtime /
                    (ctx->mainzisegmap_24960_runs !=
                     0 ? ctx->mainzisegmap_24960_runs : 1),
                    (long) ctx->mainzisegmap_24960_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_24960_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_24960_runs;
        str_builder(&builder,
                    "main.segmap_24998                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_24998_runs,
                    (long) ctx->mainzisegmap_24998_total_runtime /
                    (ctx->mainzisegmap_24998_runs !=
                     0 ? ctx->mainzisegmap_24998_runs : 1),
                    (long) ctx->mainzisegmap_24998_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_24998_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_24998_runs;
        str_builder(&builder,
                    "main.segmap_25055                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_25055_runs,
                    (long) ctx->mainzisegmap_25055_total_runtime /
                    (ctx->mainzisegmap_25055_runs !=
                     0 ? ctx->mainzisegmap_25055_runs : 1),
                    (long) ctx->mainzisegmap_25055_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_25055_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_25055_runs;
        str_builder(&builder,
                    "main.segmap_25153                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_25153_runs,
                    (long) ctx->mainzisegmap_25153_total_runtime /
                    (ctx->mainzisegmap_25153_runs !=
                     0 ? ctx->mainzisegmap_25153_runs : 1),
                    (long) ctx->mainzisegmap_25153_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_25153_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_25153_runs;
        str_builder(&builder,
                    "main.segmap_25217                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_25217_runs,
                    (long) ctx->mainzisegmap_25217_total_runtime /
                    (ctx->mainzisegmap_25217_runs !=
                     0 ? ctx->mainzisegmap_25217_runs : 1),
                    (long) ctx->mainzisegmap_25217_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_25217_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_25217_runs;
        str_builder(&builder,
                    "main.segmap_25490                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_25490_runs,
                    (long) ctx->mainzisegmap_25490_total_runtime /
                    (ctx->mainzisegmap_25490_runs !=
                     0 ? ctx->mainzisegmap_25490_runs : 1),
                    (long) ctx->mainzisegmap_25490_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_25490_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_25490_runs;
        str_builder(&builder,
                    "main.segmap_25562                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_25562_runs,
                    (long) ctx->mainzisegmap_25562_total_runtime /
                    (ctx->mainzisegmap_25562_runs !=
                     0 ? ctx->mainzisegmap_25562_runs : 1),
                    (long) ctx->mainzisegmap_25562_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_25562_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_25562_runs;
        str_builder(&builder,
                    "main.segmap_25677                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_25677_runs,
                    (long) ctx->mainzisegmap_25677_total_runtime /
                    (ctx->mainzisegmap_25677_runs !=
                     0 ? ctx->mainzisegmap_25677_runs : 1),
                    (long) ctx->mainzisegmap_25677_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_25677_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_25677_runs;
        str_builder(&builder,
                    "main.segmap_intragroup_24699          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_intragroup_24699_runs,
                    (long) ctx->mainzisegmap_intragroup_24699_total_runtime /
                    (ctx->mainzisegmap_intragroup_24699_runs !=
                     0 ? ctx->mainzisegmap_intragroup_24699_runs : 1),
                    (long) ctx->mainzisegmap_intragroup_24699_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_intragroup_24699_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_intragroup_24699_runs;
        str_builder(&builder,
                    "main.segmap_intragroup_25560          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_intragroup_25560_runs,
                    (long) ctx->mainzisegmap_intragroup_25560_total_runtime /
                    (ctx->mainzisegmap_intragroup_25560_runs !=
                     0 ? ctx->mainzisegmap_intragroup_25560_runs : 1),
                    (long) ctx->mainzisegmap_intragroup_25560_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_intragroup_25560_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_intragroup_25560_runs;
        str_builder(&builder,
                    "main.segred_large_25712               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_large_25712_runs,
                    (long) ctx->mainzisegred_large_25712_total_runtime /
                    (ctx->mainzisegred_large_25712_runs !=
                     0 ? ctx->mainzisegred_large_25712_runs : 1),
                    (long) ctx->mainzisegred_large_25712_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_large_25712_total_runtime;
        ctx->total_runs += ctx->mainzisegred_large_25712_runs;
        str_builder(&builder,
                    "main.segred_large_28390               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_large_28390_runs,
                    (long) ctx->mainzisegred_large_28390_total_runtime /
                    (ctx->mainzisegred_large_28390_runs !=
                     0 ? ctx->mainzisegred_large_28390_runs : 1),
                    (long) ctx->mainzisegred_large_28390_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_large_28390_total_runtime;
        ctx->total_runs += ctx->mainzisegred_large_28390_runs;
        str_builder(&builder,
                    "main.segred_nonseg_24268              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_24268_runs,
                    (long) ctx->mainzisegred_nonseg_24268_total_runtime /
                    (ctx->mainzisegred_nonseg_24268_runs !=
                     0 ? ctx->mainzisegred_nonseg_24268_runs : 1),
                    (long) ctx->mainzisegred_nonseg_24268_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_24268_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_24268_runs;
        str_builder(&builder,
                    "main.segred_nonseg_25397              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_25397_runs,
                    (long) ctx->mainzisegred_nonseg_25397_total_runtime /
                    (ctx->mainzisegred_nonseg_25397_runs !=
                     0 ? ctx->mainzisegred_nonseg_25397_runs : 1),
                    (long) ctx->mainzisegred_nonseg_25397_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_25397_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_25397_runs;
        str_builder(&builder,
                    "main.segred_nonseg_25507              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_25507_runs,
                    (long) ctx->mainzisegred_nonseg_25507_total_runtime /
                    (ctx->mainzisegred_nonseg_25507_runs !=
                     0 ? ctx->mainzisegred_nonseg_25507_runs : 1),
                    (long) ctx->mainzisegred_nonseg_25507_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_25507_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_25507_runs;
        str_builder(&builder,
                    "main.segred_nonseg_25780              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_25780_runs,
                    (long) ctx->mainzisegred_nonseg_25780_total_runtime /
                    (ctx->mainzisegred_nonseg_25780_runs !=
                     0 ? ctx->mainzisegred_nonseg_25780_runs : 1),
                    (long) ctx->mainzisegred_nonseg_25780_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_25780_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_25780_runs;
        str_builder(&builder,
                    "main.segred_nonseg_27904              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_27904_runs,
                    (long) ctx->mainzisegred_nonseg_27904_total_runtime /
                    (ctx->mainzisegred_nonseg_27904_runs !=
                     0 ? ctx->mainzisegred_nonseg_27904_runs : 1),
                    (long) ctx->mainzisegred_nonseg_27904_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_27904_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_27904_runs;
        str_builder(&builder,
                    "main.segred_nonseg_27936              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_27936_runs,
                    (long) ctx->mainzisegred_nonseg_27936_total_runtime /
                    (ctx->mainzisegred_nonseg_27936_runs !=
                     0 ? ctx->mainzisegred_nonseg_27936_runs : 1),
                    (long) ctx->mainzisegred_nonseg_27936_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_27936_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_27936_runs;
        str_builder(&builder,
                    "main.segred_small_25712               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_small_25712_runs,
                    (long) ctx->mainzisegred_small_25712_total_runtime /
                    (ctx->mainzisegred_small_25712_runs !=
                     0 ? ctx->mainzisegred_small_25712_runs : 1),
                    (long) ctx->mainzisegred_small_25712_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_small_25712_total_runtime;
        ctx->total_runs += ctx->mainzisegred_small_25712_runs;
        str_builder(&builder,
                    "main.segred_small_28390               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_small_28390_runs,
                    (long) ctx->mainzisegred_small_28390_total_runtime /
                    (ctx->mainzisegred_small_28390_runs !=
                     0 ? ctx->mainzisegred_small_28390_runs : 1),
                    (long) ctx->mainzisegred_small_28390_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_small_28390_total_runtime;
        ctx->total_runs += ctx->mainzisegred_small_28390_runs;
        str_builder(&builder,
                    "test.copy_28721                       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzicopy_28721_runs,
                    (long) ctx->testzicopy_28721_total_runtime /
                    (ctx->testzicopy_28721_runs !=
                     0 ? ctx->testzicopy_28721_runs : 1),
                    (long) ctx->testzicopy_28721_total_runtime);
        ctx->total_runtime += ctx->testzicopy_28721_total_runtime;
        ctx->total_runs += ctx->testzicopy_28721_runs;
        str_builder(&builder,
                    "test.copy_28758                       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzicopy_28758_runs,
                    (long) ctx->testzicopy_28758_total_runtime /
                    (ctx->testzicopy_28758_runs !=
                     0 ? ctx->testzicopy_28758_runs : 1),
                    (long) ctx->testzicopy_28758_total_runtime);
        ctx->total_runtime += ctx->testzicopy_28758_total_runtime;
        ctx->total_runs += ctx->testzicopy_28758_runs;
        str_builder(&builder,
                    "test.scan_stage1_27050                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_27050_runs,
                    (long) ctx->testziscan_stage1_27050_total_runtime /
                    (ctx->testziscan_stage1_27050_runs !=
                     0 ? ctx->testziscan_stage1_27050_runs : 1),
                    (long) ctx->testziscan_stage1_27050_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_27050_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_27050_runs;
        str_builder(&builder,
                    "test.scan_stage1_27083                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_27083_runs,
                    (long) ctx->testziscan_stage1_27083_total_runtime /
                    (ctx->testziscan_stage1_27083_runs !=
                     0 ? ctx->testziscan_stage1_27083_runs : 1),
                    (long) ctx->testziscan_stage1_27083_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_27083_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_27083_runs;
        str_builder(&builder,
                    "test.scan_stage1_27091                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_27091_runs,
                    (long) ctx->testziscan_stage1_27091_total_runtime /
                    (ctx->testziscan_stage1_27091_runs !=
                     0 ? ctx->testziscan_stage1_27091_runs : 1),
                    (long) ctx->testziscan_stage1_27091_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_27091_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_27091_runs;
        str_builder(&builder,
                    "test.scan_stage1_27099                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_27099_runs,
                    (long) ctx->testziscan_stage1_27099_total_runtime /
                    (ctx->testziscan_stage1_27099_runs !=
                     0 ? ctx->testziscan_stage1_27099_runs : 1),
                    (long) ctx->testziscan_stage1_27099_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_27099_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_27099_runs;
        str_builder(&builder,
                    "test.scan_stage1_27151                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_27151_runs,
                    (long) ctx->testziscan_stage1_27151_total_runtime /
                    (ctx->testziscan_stage1_27151_runs !=
                     0 ? ctx->testziscan_stage1_27151_runs : 1),
                    (long) ctx->testziscan_stage1_27151_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_27151_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_27151_runs;
        str_builder(&builder,
                    "test.scan_stage2_27050                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_27050_runs,
                    (long) ctx->testziscan_stage2_27050_total_runtime /
                    (ctx->testziscan_stage2_27050_runs !=
                     0 ? ctx->testziscan_stage2_27050_runs : 1),
                    (long) ctx->testziscan_stage2_27050_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_27050_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_27050_runs;
        str_builder(&builder,
                    "test.scan_stage2_27083                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_27083_runs,
                    (long) ctx->testziscan_stage2_27083_total_runtime /
                    (ctx->testziscan_stage2_27083_runs !=
                     0 ? ctx->testziscan_stage2_27083_runs : 1),
                    (long) ctx->testziscan_stage2_27083_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_27083_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_27083_runs;
        str_builder(&builder,
                    "test.scan_stage2_27091                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_27091_runs,
                    (long) ctx->testziscan_stage2_27091_total_runtime /
                    (ctx->testziscan_stage2_27091_runs !=
                     0 ? ctx->testziscan_stage2_27091_runs : 1),
                    (long) ctx->testziscan_stage2_27091_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_27091_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_27091_runs;
        str_builder(&builder,
                    "test.scan_stage2_27099                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_27099_runs,
                    (long) ctx->testziscan_stage2_27099_total_runtime /
                    (ctx->testziscan_stage2_27099_runs !=
                     0 ? ctx->testziscan_stage2_27099_runs : 1),
                    (long) ctx->testziscan_stage2_27099_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_27099_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_27099_runs;
        str_builder(&builder,
                    "test.scan_stage2_27151                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_27151_runs,
                    (long) ctx->testziscan_stage2_27151_total_runtime /
                    (ctx->testziscan_stage2_27151_runs !=
                     0 ? ctx->testziscan_stage2_27151_runs : 1),
                    (long) ctx->testziscan_stage2_27151_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_27151_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_27151_runs;
        str_builder(&builder,
                    "test.scan_stage3_27050                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_27050_runs,
                    (long) ctx->testziscan_stage3_27050_total_runtime /
                    (ctx->testziscan_stage3_27050_runs !=
                     0 ? ctx->testziscan_stage3_27050_runs : 1),
                    (long) ctx->testziscan_stage3_27050_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_27050_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_27050_runs;
        str_builder(&builder,
                    "test.scan_stage3_27083                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_27083_runs,
                    (long) ctx->testziscan_stage3_27083_total_runtime /
                    (ctx->testziscan_stage3_27083_runs !=
                     0 ? ctx->testziscan_stage3_27083_runs : 1),
                    (long) ctx->testziscan_stage3_27083_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_27083_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_27083_runs;
        str_builder(&builder,
                    "test.scan_stage3_27091                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_27091_runs,
                    (long) ctx->testziscan_stage3_27091_total_runtime /
                    (ctx->testziscan_stage3_27091_runs !=
                     0 ? ctx->testziscan_stage3_27091_runs : 1),
                    (long) ctx->testziscan_stage3_27091_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_27091_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_27091_runs;
        str_builder(&builder,
                    "test.scan_stage3_27099                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_27099_runs,
                    (long) ctx->testziscan_stage3_27099_total_runtime /
                    (ctx->testziscan_stage3_27099_runs !=
                     0 ? ctx->testziscan_stage3_27099_runs : 1),
                    (long) ctx->testziscan_stage3_27099_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_27099_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_27099_runs;
        str_builder(&builder,
                    "test.scan_stage3_27151                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_27151_runs,
                    (long) ctx->testziscan_stage3_27151_total_runtime /
                    (ctx->testziscan_stage3_27151_runs !=
                     0 ? ctx->testziscan_stage3_27151_runs : 1),
                    (long) ctx->testziscan_stage3_27151_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_27151_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_27151_runs;
        str_builder(&builder,
                    "test.seghist_global_27068             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziseghist_global_27068_runs,
                    (long) ctx->testziseghist_global_27068_total_runtime /
                    (ctx->testziseghist_global_27068_runs !=
                     0 ? ctx->testziseghist_global_27068_runs : 1),
                    (long) ctx->testziseghist_global_27068_total_runtime);
        ctx->total_runtime += ctx->testziseghist_global_27068_total_runtime;
        ctx->total_runs += ctx->testziseghist_global_27068_runs;
        str_builder(&builder,
                    "test.seghist_local_27068              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziseghist_local_27068_runs,
                    (long) ctx->testziseghist_local_27068_total_runtime /
                    (ctx->testziseghist_local_27068_runs !=
                     0 ? ctx->testziseghist_local_27068_runs : 1),
                    (long) ctx->testziseghist_local_27068_total_runtime);
        ctx->total_runtime += ctx->testziseghist_local_27068_total_runtime;
        ctx->total_runs += ctx->testziseghist_local_27068_runs;
        str_builder(&builder,
                    "test.segmap_25945                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_25945_runs,
                    (long) ctx->testzisegmap_25945_total_runtime /
                    (ctx->testzisegmap_25945_runs !=
                     0 ? ctx->testzisegmap_25945_runs : 1),
                    (long) ctx->testzisegmap_25945_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_25945_total_runtime;
        ctx->total_runs += ctx->testzisegmap_25945_runs;
        str_builder(&builder,
                    "test.segmap_26121                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_26121_runs,
                    (long) ctx->testzisegmap_26121_total_runtime /
                    (ctx->testzisegmap_26121_runs !=
                     0 ? ctx->testzisegmap_26121_runs : 1),
                    (long) ctx->testzisegmap_26121_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_26121_total_runtime;
        ctx->total_runs += ctx->testzisegmap_26121_runs;
        str_builder(&builder,
                    "test.segmap_26623                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_26623_runs,
                    (long) ctx->testzisegmap_26623_total_runtime /
                    (ctx->testzisegmap_26623_runs !=
                     0 ? ctx->testzisegmap_26623_runs : 1),
                    (long) ctx->testzisegmap_26623_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_26623_total_runtime;
        ctx->total_runs += ctx->testzisegmap_26623_runs;
        str_builder(&builder,
                    "test.segmap_26661                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_26661_runs,
                    (long) ctx->testzisegmap_26661_total_runtime /
                    (ctx->testzisegmap_26661_runs !=
                     0 ? ctx->testzisegmap_26661_runs : 1),
                    (long) ctx->testzisegmap_26661_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_26661_total_runtime;
        ctx->total_runs += ctx->testzisegmap_26661_runs;
        str_builder(&builder,
                    "test.segmap_26718                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_26718_runs,
                    (long) ctx->testzisegmap_26718_total_runtime /
                    (ctx->testzisegmap_26718_runs !=
                     0 ? ctx->testzisegmap_26718_runs : 1),
                    (long) ctx->testzisegmap_26718_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_26718_total_runtime;
        ctx->total_runs += ctx->testzisegmap_26718_runs;
        str_builder(&builder,
                    "test.segmap_26816                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_26816_runs,
                    (long) ctx->testzisegmap_26816_total_runtime /
                    (ctx->testzisegmap_26816_runs !=
                     0 ? ctx->testzisegmap_26816_runs : 1),
                    (long) ctx->testzisegmap_26816_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_26816_total_runtime;
        ctx->total_runs += ctx->testzisegmap_26816_runs;
        str_builder(&builder,
                    "test.segmap_26880                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_26880_runs,
                    (long) ctx->testzisegmap_26880_total_runtime /
                    (ctx->testzisegmap_26880_runs !=
                     0 ? ctx->testzisegmap_26880_runs : 1),
                    (long) ctx->testzisegmap_26880_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_26880_total_runtime;
        ctx->total_runs += ctx->testzisegmap_26880_runs;
        str_builder(&builder,
                    "test.segmap_27153                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_27153_runs,
                    (long) ctx->testzisegmap_27153_total_runtime /
                    (ctx->testzisegmap_27153_runs !=
                     0 ? ctx->testzisegmap_27153_runs : 1),
                    (long) ctx->testzisegmap_27153_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_27153_total_runtime;
        ctx->total_runs += ctx->testzisegmap_27153_runs;
        str_builder(&builder,
                    "test.segmap_27216                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_27216_runs,
                    (long) ctx->testzisegmap_27216_total_runtime /
                    (ctx->testzisegmap_27216_runs !=
                     0 ? ctx->testzisegmap_27216_runs : 1),
                    (long) ctx->testzisegmap_27216_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_27216_total_runtime;
        ctx->total_runs += ctx->testzisegmap_27216_runs;
        str_builder(&builder,
                    "test.segmap_27291                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_27291_runs,
                    (long) ctx->testzisegmap_27291_total_runtime /
                    (ctx->testzisegmap_27291_runs !=
                     0 ? ctx->testzisegmap_27291_runs : 1),
                    (long) ctx->testzisegmap_27291_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_27291_total_runtime;
        ctx->total_runs += ctx->testzisegmap_27291_runs;
        str_builder(&builder,
                    "test.segmap_intragroup_26362          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_intragroup_26362_runs,
                    (long) ctx->testzisegmap_intragroup_26362_total_runtime /
                    (ctx->testzisegmap_intragroup_26362_runs !=
                     0 ? ctx->testzisegmap_intragroup_26362_runs : 1),
                    (long) ctx->testzisegmap_intragroup_26362_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_intragroup_26362_total_runtime;
        ctx->total_runs += ctx->testzisegmap_intragroup_26362_runs;
        str_builder(&builder,
                    "test.segred_large_27326               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_large_27326_runs,
                    (long) ctx->testzisegred_large_27326_total_runtime /
                    (ctx->testzisegred_large_27326_runs !=
                     0 ? ctx->testzisegred_large_27326_runs : 1),
                    (long) ctx->testzisegred_large_27326_total_runtime);
        ctx->total_runtime += ctx->testzisegred_large_27326_total_runtime;
        ctx->total_runs += ctx->testzisegred_large_27326_runs;
        str_builder(&builder,
                    "test.segred_large_28391               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_large_28391_runs,
                    (long) ctx->testzisegred_large_28391_total_runtime /
                    (ctx->testzisegred_large_28391_runs !=
                     0 ? ctx->testzisegred_large_28391_runs : 1),
                    (long) ctx->testzisegred_large_28391_total_runtime);
        ctx->total_runtime += ctx->testzisegred_large_28391_total_runtime;
        ctx->total_runs += ctx->testzisegred_large_28391_runs;
        str_builder(&builder,
                    "test.segred_nonseg_25931              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_25931_runs,
                    (long) ctx->testzisegred_nonseg_25931_total_runtime /
                    (ctx->testzisegred_nonseg_25931_runs !=
                     0 ? ctx->testzisegred_nonseg_25931_runs : 1),
                    (long) ctx->testzisegred_nonseg_25931_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_25931_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_25931_runs;
        str_builder(&builder,
                    "test.segred_nonseg_27060              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_27060_runs,
                    (long) ctx->testzisegred_nonseg_27060_total_runtime /
                    (ctx->testzisegred_nonseg_27060_runs !=
                     0 ? ctx->testzisegred_nonseg_27060_runs : 1),
                    (long) ctx->testzisegred_nonseg_27060_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_27060_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_27060_runs;
        str_builder(&builder,
                    "test.segred_nonseg_27169              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_27169_runs,
                    (long) ctx->testzisegred_nonseg_27169_total_runtime /
                    (ctx->testzisegred_nonseg_27169_runs !=
                     0 ? ctx->testzisegred_nonseg_27169_runs : 1),
                    (long) ctx->testzisegred_nonseg_27169_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_27169_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_27169_runs;
        str_builder(&builder,
                    "test.segred_nonseg_27390              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_27390_runs,
                    (long) ctx->testzisegred_nonseg_27390_total_runtime /
                    (ctx->testzisegred_nonseg_27390_runs !=
                     0 ? ctx->testzisegred_nonseg_27390_runs : 1),
                    (long) ctx->testzisegred_nonseg_27390_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_27390_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_27390_runs;
        str_builder(&builder,
                    "test.segred_nonseg_27990              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_27990_runs,
                    (long) ctx->testzisegred_nonseg_27990_total_runtime /
                    (ctx->testzisegred_nonseg_27990_runs !=
                     0 ? ctx->testzisegred_nonseg_27990_runs : 1),
                    (long) ctx->testzisegred_nonseg_27990_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_27990_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_27990_runs;
        str_builder(&builder,
                    "test.segred_nonseg_28022              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_28022_runs,
                    (long) ctx->testzisegred_nonseg_28022_total_runtime /
                    (ctx->testzisegred_nonseg_28022_runs !=
                     0 ? ctx->testzisegred_nonseg_28022_runs : 1),
                    (long) ctx->testzisegred_nonseg_28022_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_28022_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_28022_runs;
        str_builder(&builder,
                    "test.segred_small_27326               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_small_27326_runs,
                    (long) ctx->testzisegred_small_27326_total_runtime /
                    (ctx->testzisegred_small_27326_runs !=
                     0 ? ctx->testzisegred_small_27326_runs : 1),
                    (long) ctx->testzisegred_small_27326_total_runtime);
        ctx->total_runtime += ctx->testzisegred_small_27326_total_runtime;
        ctx->total_runs += ctx->testzisegred_small_27326_runs;
        str_builder(&builder,
                    "test.segred_small_28391               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_small_28391_runs,
                    (long) ctx->testzisegred_small_28391_total_runtime /
                    (ctx->testzisegred_small_28391_runs !=
                     0 ? ctx->testzisegred_small_28391_runs : 1),
                    (long) ctx->testzisegred_small_28391_total_runtime);
        ctx->total_runtime += ctx->testzisegred_small_28391_total_runtime;
        ctx->total_runs += ctx->testzisegred_small_28391_runs;
        str_builder(&builder, "%d operations with cumulative runtime: %6ldus\n",
                    ctx->total_runs, ctx->total_runtime);
    }
    return builder.str;
}
char *futhark_context_get_error(struct futhark_context *ctx)
{
    char *error = ctx->error;
    
    ctx->error = NULL;
    return error;
}
void futhark_context_pause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 1;
}
void futhark_context_unpause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 0;
}
static int futrts_builtinzhgpu_map_transpose_f32(struct futhark_context *ctx,
                                                 struct memblock_device destmem_0,
                                                 int32_t destoffset_1,
                                                 struct memblock_device srcmem_2,
                                                 int32_t srcoffset_3,
                                                 int32_t num_arrays_4,
                                                 int32_t x_elems_5,
                                                 int32_t y_elems_6);
static int futrts_builtinzhreplicate_f32(struct futhark_context *ctx,
                                         struct memblock_device mem_28704,
                                         int32_t num_elems_28705,
                                         float val_28706);
static int futrts_builtinzhreplicate_i64(struct futhark_context *ctx,
                                         struct memblock_device mem_28295,
                                         int32_t num_elems_28296,
                                         int64_t val_28297);
static int futrts_main(struct futhark_context *ctx, float *out_scalar_out_28910,
                       struct memblock_device *out_mem_p_28911,
                       int64_t *out_out_arrsizze_28912,
                       struct memblock_device swap_term_mem_27668,
                       struct memblock_device payments_mem_27669,
                       struct memblock_device notional_mem_27670,
                       int64_t n_23312, int64_t n_23313, int64_t n_23314,
                       int64_t paths_23315, int64_t steps_23316, float a_23320,
                       float b_23321, float sigma_23322, float r0_23323);
static int futrts_test(struct futhark_context *ctx, float *out_scalar_out_29134,
                       int64_t paths_23807, int64_t steps_23808);
int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    
  cleanup:
    return err;
}
int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    return 0;
}
static int futrts_builtinzhgpu_map_transpose_f32(struct futhark_context *ctx,
                                                 struct memblock_device destmem_0,
                                                 int32_t destoffset_1,
                                                 struct memblock_device srcmem_2,
                                                 int32_t srcoffset_3,
                                                 int32_t num_arrays_4,
                                                 int32_t x_elems_5,
                                                 int32_t y_elems_6)
{
    (void) ctx;
    
    int err = 0;
    
    if (!(num_arrays_4 == 0 || (x_elems_5 == 0 || y_elems_6 == 0))) {
        int32_t muly_8 = squot32(16, x_elems_5);
        int32_t mulx_7 = squot32(16, y_elems_6);
        
        if (num_arrays_4 == 1 && (x_elems_5 == 1 || y_elems_6 == 1)) {
            if (sext_i32_i64(x_elems_5 * y_elems_6 * (int32_t) sizeof(float)) >
                0) {
                OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                             srcmem_2.mem,
                                                             destmem_0.mem,
                                                             sext_i32_i64(srcoffset_3),
                                                             sext_i32_i64(destoffset_1),
                                                             sext_i32_i64(x_elems_5 *
                                                             y_elems_6 *
                                                             (int32_t) sizeof(float)),
                                                             0, NULL,
                                                             ctx->profiling_paused ||
                                                             !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                       &ctx->copy_dev_to_dev_runs,
                                                                                                       &ctx->copy_dev_to_dev_total_runtime)));
                if (ctx->debugging)
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            }
        } else {
            if (sle32(x_elems_5, 8) && slt32(16, y_elems_6)) {
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        0, 1088, NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        1, sizeof(destoffset_1),
                                                        &destoffset_1));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        2, sizeof(srcoffset_3),
                                                        &srcoffset_3));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        3, sizeof(num_arrays_4),
                                                        &num_arrays_4));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        4, sizeof(x_elems_5),
                                                        &x_elems_5));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        5, sizeof(y_elems_6),
                                                        &y_elems_6));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        6, sizeof(mulx_7),
                                                        &mulx_7));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        7, sizeof(muly_8),
                                                        &muly_8));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        8,
                                                        sizeof(destmem_0.mem),
                                                        &destmem_0.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        9, sizeof(srcmem_2.mem),
                                                        &srcmem_2.mem));
                if (1 * ((size_t) sdiv_up32(x_elems_5, 16) * (size_t) 16) *
                    ((size_t) sdiv_up32(sdiv_up32(y_elems_6, muly_8), 16) *
                     (size_t) 16) * ((size_t) num_arrays_4 * (size_t) 1) != 0) {
                    const size_t global_work_sizze_28880[3] =
                                 {(size_t) sdiv_up32(x_elems_5, 16) *
                                  (size_t) 16,
                                  (size_t) sdiv_up32(sdiv_up32(y_elems_6,
                                                               muly_8), 16) *
                                  (size_t) 16, (size_t) num_arrays_4 *
                                  (size_t) 1};
                    const size_t local_work_sizze_28884[3] = {16, 16, 1};
                    int64_t time_start_28881 = 0, time_end_28882 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "gpu_map_transpose_f32_low_width");
                        fprintf(stderr, "%zu", global_work_sizze_28880[0]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", global_work_sizze_28880[1]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", global_work_sizze_28880[2]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_28884[0]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", local_work_sizze_28884[1]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", local_work_sizze_28884[2]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + 1088));
                        time_start_28881 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->gpu_map_transpose_f32_low_width,
                                                                    3, NULL,
                                                                    global_work_sizze_28880,
                                                                    local_work_sizze_28884,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->gpu_map_transpose_f32_low_width_runs,
                                                                                                              &ctx->gpu_map_transpose_f32_low_width_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_28882 = get_wall_time();
                        
                        long time_diff_28883 = time_end_28882 -
                             time_start_28881;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "gpu_map_transpose_f32_low_width",
                                time_diff_28883);
                    }
                }
            } else {
                if (sle32(y_elems_6, 8) && slt32(16, x_elems_5)) {
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            0, 1088, NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            1,
                                                            sizeof(destoffset_1),
                                                            &destoffset_1));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            2,
                                                            sizeof(srcoffset_3),
                                                            &srcoffset_3));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            3,
                                                            sizeof(num_arrays_4),
                                                            &num_arrays_4));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            4,
                                                            sizeof(x_elems_5),
                                                            &x_elems_5));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            5,
                                                            sizeof(y_elems_6),
                                                            &y_elems_6));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            6, sizeof(mulx_7),
                                                            &mulx_7));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            7, sizeof(muly_8),
                                                            &muly_8));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            8,
                                                            sizeof(destmem_0.mem),
                                                            &destmem_0.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            9,
                                                            sizeof(srcmem_2.mem),
                                                            &srcmem_2.mem));
                    if (1 * ((size_t) sdiv_up32(sdiv_up32(x_elems_5, mulx_7),
                                                16) * (size_t) 16) *
                        ((size_t) sdiv_up32(y_elems_6, 16) * (size_t) 16) *
                        ((size_t) num_arrays_4 * (size_t) 1) != 0) {
                        const size_t global_work_sizze_28885[3] =
                                     {(size_t) sdiv_up32(sdiv_up32(x_elems_5,
                                                                   mulx_7),
                                                         16) * (size_t) 16,
                                      (size_t) sdiv_up32(y_elems_6, 16) *
                                      (size_t) 16, (size_t) num_arrays_4 *
                                      (size_t) 1};
                        const size_t local_work_sizze_28889[3] = {16, 16, 1};
                        int64_t time_start_28886 = 0, time_end_28887 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "gpu_map_transpose_f32_low_height");
                            fprintf(stderr, "%zu", global_work_sizze_28885[0]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", global_work_sizze_28885[1]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", global_work_sizze_28885[2]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_28889[0]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", local_work_sizze_28889[1]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", local_work_sizze_28889[2]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + 1088));
                            time_start_28886 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->gpu_map_transpose_f32_low_height,
                                                                        3, NULL,
                                                                        global_work_sizze_28885,
                                                                        local_work_sizze_28889,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->gpu_map_transpose_f32_low_height_runs,
                                                                                                                  &ctx->gpu_map_transpose_f32_low_height_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_28887 = get_wall_time();
                            
                            long time_diff_28888 = time_end_28887 -
                                 time_start_28886;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "gpu_map_transpose_f32_low_height",
                                    time_diff_28888);
                        }
                    }
                } else {
                    if (sle32(x_elems_5, 8) && sle32(y_elems_6, 8)) {
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                0, 1, NULL));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                1,
                                                                sizeof(destoffset_1),
                                                                &destoffset_1));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                2,
                                                                sizeof(srcoffset_3),
                                                                &srcoffset_3));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                3,
                                                                sizeof(num_arrays_4),
                                                                &num_arrays_4));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                4,
                                                                sizeof(x_elems_5),
                                                                &x_elems_5));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                5,
                                                                sizeof(y_elems_6),
                                                                &y_elems_6));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                6,
                                                                sizeof(mulx_7),
                                                                &mulx_7));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                7,
                                                                sizeof(muly_8),
                                                                &muly_8));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                8,
                                                                sizeof(destmem_0.mem),
                                                                &destmem_0.mem));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                9,
                                                                sizeof(srcmem_2.mem),
                                                                &srcmem_2.mem));
                        if (1 * ((size_t) sdiv_up32(num_arrays_4 * x_elems_5 *
                                                    y_elems_6, 256) *
                                 (size_t) 256) != 0) {
                            const size_t global_work_sizze_28890[1] =
                                         {(size_t) sdiv_up32(num_arrays_4 *
                                                             x_elems_5 *
                                                             y_elems_6, 256) *
                                         (size_t) 256};
                            const size_t local_work_sizze_28894[1] = {256};
                            int64_t time_start_28891 = 0, time_end_28892 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(stderr,
                                        "Launching %s with global work size [",
                                        "gpu_map_transpose_f32_small");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_28890[0]);
                                fprintf(stderr, "] and local work size [");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_28894[0]);
                                fprintf(stderr,
                                        "]; local memory parameters sum to %d bytes.\n",
                                        (int) (0 + 1));
                                time_start_28891 = get_wall_time();
                            }
                            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                            ctx->gpu_map_transpose_f32_small,
                                                                            1,
                                                                            NULL,
                                                                            global_work_sizze_28890,
                                                                            local_work_sizze_28894,
                                                                            0,
                                                                            NULL,
                                                                            ctx->profiling_paused ||
                                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                      &ctx->gpu_map_transpose_f32_small_runs,
                                                                                                                      &ctx->gpu_map_transpose_f32_small_total_runtime)));
                            if (ctx->debugging) {
                                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                                time_end_28892 = get_wall_time();
                                
                                long time_diff_28893 = time_end_28892 -
                                     time_start_28891;
                                
                                fprintf(stderr, "kernel %s runtime: %ldus\n",
                                        "gpu_map_transpose_f32_small",
                                        time_diff_28893);
                            }
                        }
                    } else {
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                0, 4224, NULL));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                1,
                                                                sizeof(destoffset_1),
                                                                &destoffset_1));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                2,
                                                                sizeof(srcoffset_3),
                                                                &srcoffset_3));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                3,
                                                                sizeof(num_arrays_4),
                                                                &num_arrays_4));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                4,
                                                                sizeof(x_elems_5),
                                                                &x_elems_5));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                5,
                                                                sizeof(y_elems_6),
                                                                &y_elems_6));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                6,
                                                                sizeof(mulx_7),
                                                                &mulx_7));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                7,
                                                                sizeof(muly_8),
                                                                &muly_8));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                8,
                                                                sizeof(destmem_0.mem),
                                                                &destmem_0.mem));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                9,
                                                                sizeof(srcmem_2.mem),
                                                                &srcmem_2.mem));
                        if (1 * ((size_t) sdiv_up32(x_elems_5, 32) *
                                 (size_t) 32) * ((size_t) sdiv_up32(y_elems_6,
                                                                    32) *
                                                 (size_t) 8) *
                            ((size_t) num_arrays_4 * (size_t) 1) != 0) {
                            const size_t global_work_sizze_28895[3] =
                                         {(size_t) sdiv_up32(x_elems_5, 32) *
                                          (size_t) 32,
                                          (size_t) sdiv_up32(y_elems_6, 32) *
                                          (size_t) 8, (size_t) num_arrays_4 *
                                          (size_t) 1};
                            const size_t local_work_sizze_28899[3] = {32, 8, 1};
                            int64_t time_start_28896 = 0, time_end_28897 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(stderr,
                                        "Launching %s with global work size [",
                                        "gpu_map_transpose_f32");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_28895[0]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_28895[1]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_28895[2]);
                                fprintf(stderr, "] and local work size [");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_28899[0]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_28899[1]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_28899[2]);
                                fprintf(stderr,
                                        "]; local memory parameters sum to %d bytes.\n",
                                        (int) (0 + 4224));
                                time_start_28896 = get_wall_time();
                            }
                            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                            ctx->gpu_map_transpose_f32,
                                                                            3,
                                                                            NULL,
                                                                            global_work_sizze_28895,
                                                                            local_work_sizze_28899,
                                                                            0,
                                                                            NULL,
                                                                            ctx->profiling_paused ||
                                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                      &ctx->gpu_map_transpose_f32_runs,
                                                                                                                      &ctx->gpu_map_transpose_f32_total_runtime)));
                            if (ctx->debugging) {
                                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                                time_end_28897 = get_wall_time();
                                
                                long time_diff_28898 = time_end_28897 -
                                     time_start_28896;
                                
                                fprintf(stderr, "kernel %s runtime: %ldus\n",
                                        "gpu_map_transpose_f32",
                                        time_diff_28898);
                            }
                        }
                    }
                }
            }
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_builtinzhreplicate_f32(struct futhark_context *ctx,
                                         struct memblock_device mem_28704,
                                         int32_t num_elems_28705,
                                         float val_28706)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_28711;
    
    group_sizze_28711 = ctx->sizes.builtinzhreplicate_f32zigroup_sizze_28711;
    
    int64_t num_groups_28712;
    
    num_groups_28712 = sdiv_up64(num_elems_28705, group_sizze_28711);
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_f32zireplicate_28708,
                                            0, sizeof(mem_28704.mem),
                                            &mem_28704.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_f32zireplicate_28708,
                                            1, sizeof(num_elems_28705),
                                            &num_elems_28705));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_f32zireplicate_28708,
                                            2, sizeof(val_28706), &val_28706));
    if (1 * ((size_t) num_groups_28712 * (size_t) group_sizze_28711) != 0) {
        const size_t global_work_sizze_28900[1] = {(size_t) num_groups_28712 *
                     (size_t) group_sizze_28711};
        const size_t local_work_sizze_28904[1] = {group_sizze_28711};
        int64_t time_start_28901 = 0, time_end_28902 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "builtin#replicate_f32.replicate_28708");
            fprintf(stderr, "%zu", global_work_sizze_28900[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_28904[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_28901 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->builtinzhreplicate_f32zireplicate_28708,
                                                        1, NULL,
                                                        global_work_sizze_28900,
                                                        local_work_sizze_28904,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->builtinzhreplicate_f32zireplicate_28708_runs,
                                                                                                  &ctx->builtinzhreplicate_f32zireplicate_28708_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_28902 = get_wall_time();
            
            long time_diff_28903 = time_end_28902 - time_start_28901;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "builtin#replicate_f32.replicate_28708", time_diff_28903);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_builtinzhreplicate_i64(struct futhark_context *ctx,
                                         struct memblock_device mem_28295,
                                         int32_t num_elems_28296,
                                         int64_t val_28297)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_28302;
    
    group_sizze_28302 = ctx->sizes.builtinzhreplicate_i64zigroup_sizze_28302;
    
    int64_t num_groups_28303;
    
    num_groups_28303 = sdiv_up64(num_elems_28296, group_sizze_28302);
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_i64zireplicate_28299,
                                            0, sizeof(mem_28295.mem),
                                            &mem_28295.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_i64zireplicate_28299,
                                            1, sizeof(num_elems_28296),
                                            &num_elems_28296));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_i64zireplicate_28299,
                                            2, sizeof(val_28297), &val_28297));
    if (1 * ((size_t) num_groups_28303 * (size_t) group_sizze_28302) != 0) {
        const size_t global_work_sizze_28905[1] = {(size_t) num_groups_28303 *
                     (size_t) group_sizze_28302};
        const size_t local_work_sizze_28909[1] = {group_sizze_28302};
        int64_t time_start_28906 = 0, time_end_28907 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "builtin#replicate_i64.replicate_28299");
            fprintf(stderr, "%zu", global_work_sizze_28905[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_28909[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_28906 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->builtinzhreplicate_i64zireplicate_28299,
                                                        1, NULL,
                                                        global_work_sizze_28905,
                                                        local_work_sizze_28909,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->builtinzhreplicate_i64zireplicate_28299_runs,
                                                                                                  &ctx->builtinzhreplicate_i64zireplicate_28299_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_28907 = get_wall_time();
            
            long time_diff_28908 = time_end_28907 - time_start_28906;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "builtin#replicate_i64.replicate_28299", time_diff_28908);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_main(struct futhark_context *ctx, float *out_scalar_out_28910,
                       struct memblock_device *out_mem_p_28911,
                       int64_t *out_out_arrsizze_28912,
                       struct memblock_device swap_term_mem_27668,
                       struct memblock_device payments_mem_27669,
                       struct memblock_device notional_mem_27670,
                       int64_t n_23312, int64_t n_23313, int64_t n_23314,
                       int64_t paths_23315, int64_t steps_23316, float a_23320,
                       float b_23321, float sigma_23322, float r0_23323)
{
    (void) ctx;
    
    int err = 0;
    float scalar_out_28058;
    struct memblock_device out_mem_28059;
    
    out_mem_28059.references = NULL;
    
    int64_t out_arrsizze_28060;
    bool dim_match_23324 = n_23312 == n_23313;
    bool empty_or_match_cert_23325;
    
    if (!dim_match_23324) {
        ctx->error = msgprintf("Error: %s\n\nBacktrace:\n%s",
                               "function arguments of wrong shape",
                               "-> #0  cva2.fut:100:1-154:20\n");
        if (memblock_unref_device(ctx, &out_mem_28059, "out_mem_28059") != 0)
            return 1;
        return 1;
    }
    
    int64_t segred_group_sizze_24261;
    
    segred_group_sizze_24261 = ctx->sizes.mainzisegred_group_sizze_24260;
    
    int64_t num_groups_24263;
    int32_t max_num_groups_28061;
    
    max_num_groups_28061 = ctx->sizes.mainzisegred_num_groups_24262;
    num_groups_24263 = sext_i64_i32(smax64(1, smin64(sdiv_up64(n_23312,
                                                               sext_i32_i64(segred_group_sizze_24261)),
                                                     sext_i32_i64(max_num_groups_28061))));
    
    struct memblock_device mem_27673;
    
    mem_27673.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27673, 4, "mem_27673")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mainzicounter_mem_28062 =
                           ctx->mainzicounter_mem_28062;
    struct memblock_device group_res_arr_mem_28064;
    
    group_res_arr_mem_28064.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_28064,
                              (int32_t) sizeof(float) *
                              (segred_group_sizze_24261 * num_groups_24263),
                              "group_res_arr_mem_28064")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_28066;
    
    num_threads_28066 = num_groups_24263 * segred_group_sizze_24261;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24268, 1,
                                            (int32_t) sizeof(float) *
                                            segred_group_sizze_24261, NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24268, 2,
                                            (int32_t) sizeof(bool), NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24268, 3,
                                            sizeof(n_23312), &n_23312));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24268, 4,
                                            sizeof(num_groups_24263),
                                            &num_groups_24263));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24268, 5,
                                            sizeof(swap_term_mem_27668.mem),
                                            &swap_term_mem_27668.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24268, 6,
                                            sizeof(payments_mem_27669.mem),
                                            &payments_mem_27669.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24268, 7,
                                            sizeof(mem_27673.mem),
                                            &mem_27673.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24268, 8,
                                            sizeof(mainzicounter_mem_28062.mem),
                                            &mainzicounter_mem_28062.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24268, 9,
                                            sizeof(group_res_arr_mem_28064.mem),
                                            &group_res_arr_mem_28064.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_24268, 10,
                                            sizeof(num_threads_28066),
                                            &num_threads_28066));
    if (1 * ((size_t) num_groups_24263 * (size_t) segred_group_sizze_24261) !=
        0) {
        const size_t global_work_sizze_28914[1] = {(size_t) num_groups_24263 *
                     (size_t) segred_group_sizze_24261};
        const size_t local_work_sizze_28918[1] = {segred_group_sizze_24261};
        int64_t time_start_28915 = 0, time_end_28916 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segred_nonseg_24268");
            fprintf(stderr, "%zu", global_work_sizze_28914[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_28918[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) (0 + (int32_t) sizeof(float) *
                           segred_group_sizze_24261 + (int32_t) sizeof(bool)));
            time_start_28915 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegred_nonseg_24268,
                                                        1, NULL,
                                                        global_work_sizze_28914,
                                                        local_work_sizze_28918,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegred_nonseg_24268_runs,
                                                                                                  &ctx->mainzisegred_nonseg_24268_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_28916 = get_wall_time();
            
            long time_diff_28917 = time_end_28916 - time_start_28915;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "main.segred_nonseg_24268", time_diff_28917);
        }
    }
    
    float read_res_28919;
    
    OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                 mem_27673.mem,
                                                 ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                 0 * sizeof(float),
                                                 sizeof(float), &read_res_28919,
                                                 0, NULL,
                                                 ctx->profiling_paused ||
                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                           &ctx->copy_scalar_from_dev_runs,
                                                                                           &ctx->copy_scalar_from_dev_total_runtime)));
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
        return 1;
    
    float res_23329 = read_res_28919;
    
    if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
        return 1;
    
    float res_23337 = sitofp_i64_f32(steps_23316);
    float dt_23338 = res_23329 / res_23337;
    float x_23340 = fpow32(a_23320, 2.0F);
    float x_23341 = b_23321 * x_23340;
    float x_23342 = fpow32(sigma_23322, 2.0F);
    float y_23343 = x_23342 / 2.0F;
    float y_23344 = x_23341 - y_23343;
    float y_23345 = 4.0F * a_23320;
    bool suff_outer_par_24270;
    
    suff_outer_par_24270 = ctx->sizes.mainzisuff_outer_par_0 <= n_23312;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_outer_par_0",
                n_23312);
    
    int64_t segmap_group_sizze_24360;
    
    segmap_group_sizze_24360 = ctx->sizes.mainzisegmap_group_sizze_24284;
    
    int64_t segmap_group_sizze_24536;
    
    segmap_group_sizze_24536 = ctx->sizes.mainzisegmap_group_sizze_24460;
    
    int64_t bytes_27674 = 4 * n_23312;
    int64_t bytes_27676 = 8 * n_23312;
    int64_t segred_num_groups_27898;
    
    segred_num_groups_27898 = ctx->sizes.mainzisegred_num_groups_27897;
    
    int64_t segred_group_sizze_27900;
    
    segred_group_sizze_27900 = ctx->sizes.mainzisegred_group_sizze_27899;
    
    int64_t segred_num_groups_27930;
    
    segred_num_groups_27930 = ctx->sizes.mainzisegred_num_groups_27929;
    
    int64_t segred_group_sizze_27932;
    
    segred_group_sizze_27932 = ctx->sizes.mainzisegred_group_sizze_27931;
    
    struct memblock_device res_mem_27720;
    
    res_mem_27720.references = NULL;
    
    struct memblock_device res_mem_27721;
    
    res_mem_27721.references = NULL;
    
    struct memblock_device res_mem_27722;
    
    res_mem_27722.references = NULL;
    
    struct memblock_device res_mem_27723;
    
    res_mem_27723.references = NULL;
    
    int32_t local_memory_capacity_28166;
    
    local_memory_capacity_28166 = ctx->opencl.max_local_memory;
    if ((sle64((int32_t) sizeof(bool) + (int32_t) sizeof(int64_t) *
               segred_group_sizze_27900,
               sext_i32_i64(local_memory_capacity_28166)) && sle64(0,
                                                                   sext_i32_i64(local_memory_capacity_28166))) &&
        suff_outer_par_24270) {
        int64_t segmap_usable_groups_24361 = sdiv_up64(n_23312,
                                                       segmap_group_sizze_24360);
        struct memblock_device mem_27675;
        
        mem_27675.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27675, bytes_27674, "mem_27675")) {
            err = 1;
            goto cleanup;
        }
        if (n_23312 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         swap_term_mem_27668.mem,
                                                         mem_27675.mem, 0, 0,
                                                         n_23312 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27677;
        
        mem_27677.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27677, bytes_27676, "mem_27677")) {
            err = 1;
            goto cleanup;
        }
        if (n_23312 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         payments_mem_27669.mem,
                                                         mem_27677.mem, 0, 0,
                                                         n_23312 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27679;
        
        mem_27679.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27679, bytes_27674, "mem_27679")) {
            err = 1;
            goto cleanup;
        }
        if (n_23312 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         notional_mem_27670.mem,
                                                         mem_27679.mem, 0, 0,
                                                         n_23312 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27696;
        
        mem_27696.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27696, bytes_27674, "mem_27696")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_27888 = segmap_group_sizze_24360 *
                segmap_usable_groups_24361;
        struct memblock_device mem_27916;
        
        mem_27916.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27916, 8, "mem_27916")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mainzicounter_mem_28092 =
                               ctx->mainzicounter_mem_28092;
        struct memblock_device group_res_arr_mem_28094;
        
        group_res_arr_mem_28094.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28094,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_27900 *
                                   segred_num_groups_27898),
                                  "group_res_arr_mem_28094")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28096;
        
        num_threads_28096 = segred_num_groups_27898 * segred_group_sizze_27900;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27904,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_27900,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27904,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27904,
                                                3, sizeof(n_23312), &n_23312));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27904,
                                                4,
                                                sizeof(payments_mem_27669.mem),
                                                &payments_mem_27669.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27904,
                                                5, sizeof(mem_27916.mem),
                                                &mem_27916.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27904,
                                                6,
                                                sizeof(mainzicounter_mem_28092.mem),
                                                &mainzicounter_mem_28092.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27904,
                                                7,
                                                sizeof(group_res_arr_mem_28094.mem),
                                                &group_res_arr_mem_28094.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27904,
                                                8, sizeof(num_threads_28096),
                                                &num_threads_28096));
        if (1 * ((size_t) segred_num_groups_27898 *
                 (size_t) segred_group_sizze_27900) != 0) {
            const size_t global_work_sizze_28921[1] =
                         {(size_t) segred_num_groups_27898 *
                         (size_t) segred_group_sizze_27900};
            const size_t local_work_sizze_28925[1] = {segred_group_sizze_27900};
            int64_t time_start_28922 = 0, time_end_28923 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segred_nonseg_27904");
                fprintf(stderr, "%zu", global_work_sizze_28921[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28925[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_27900 +
                               (int32_t) sizeof(bool)));
                time_start_28922 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegred_nonseg_27904,
                                                            1, NULL,
                                                            global_work_sizze_28921,
                                                            local_work_sizze_28925,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegred_nonseg_27904_runs,
                                                                                                      &ctx->mainzisegred_nonseg_27904_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28923 = get_wall_time();
                
                long time_diff_28924 = time_end_28923 - time_start_28922;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segred_nonseg_27904", time_diff_28924);
            }
        }
        
        int64_t read_res_28926;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27916.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_28926, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t max_per_thread_27894 = read_res_28926;
        
        if (memblock_unref_device(ctx, &mem_27916, "mem_27916") != 0)
            return 1;
        
        int64_t sizze_sum_27911 = num_threads_27888 * max_per_thread_27894;
        struct memblock_device mem_27682;
        
        mem_27682.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27682, sizze_sum_27911,
                                  "mem_27682")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24282, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24282, 3,
                                                sizeof(n_23312), &n_23312));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24282, 4,
                                                sizeof(a_23320), &a_23320));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24282, 5,
                                                sizeof(r0_23323), &r0_23323));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24282, 6,
                                                sizeof(x_23340), &x_23340));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24282, 7,
                                                sizeof(x_23342), &x_23342));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24282, 8,
                                                sizeof(y_23344), &y_23344));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24282, 9,
                                                sizeof(y_23345), &y_23345));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24282, 10,
                                                sizeof(swap_term_mem_27668.mem),
                                                &swap_term_mem_27668.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24282, 11,
                                                sizeof(payments_mem_27669.mem),
                                                &payments_mem_27669.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24282, 12,
                                                sizeof(mem_27682.mem),
                                                &mem_27682.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24282, 13,
                                                sizeof(mem_27696.mem),
                                                &mem_27696.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24282, 14,
                                                sizeof(num_threads_27888),
                                                &num_threads_27888));
        if (1 * ((size_t) segmap_usable_groups_24361 *
                 (size_t) segmap_group_sizze_24360) != 0) {
            const size_t global_work_sizze_28927[1] =
                         {(size_t) segmap_usable_groups_24361 *
                         (size_t) segmap_group_sizze_24360};
            const size_t local_work_sizze_28931[1] = {segmap_group_sizze_24360};
            int64_t time_start_28928 = 0, time_end_28929 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_24282");
                fprintf(stderr, "%zu", global_work_sizze_28927[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28931[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28928 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_24282,
                                                            1, NULL,
                                                            global_work_sizze_28927,
                                                            local_work_sizze_28931,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_24282_runs,
                                                                                                      &ctx->mainzisegmap_24282_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28929 = get_wall_time();
                
                long time_diff_28930 = time_end_28929 - time_start_28928;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_24282", time_diff_28930);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_27682, "mem_27682") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27720, &mem_27696, "mem_27696") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27721, &mem_27679, "mem_27679") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27722, &mem_27677, "mem_27677") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27723, &mem_27675, "mem_27675") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27682, "mem_27682") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28094,
                                  "group_res_arr_mem_28094") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27916, "mem_27916") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27696, "mem_27696") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27679, "mem_27679") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27677, "mem_27677") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27675, "mem_27675") != 0)
            return 1;
    } else {
        int64_t segmap_usable_groups_24537 = sdiv_up64(n_23312,
                                                       segmap_group_sizze_24536);
        struct memblock_device mem_27698;
        
        mem_27698.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27698, bytes_27674, "mem_27698")) {
            err = 1;
            goto cleanup;
        }
        if (n_23312 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         swap_term_mem_27668.mem,
                                                         mem_27698.mem, 0, 0,
                                                         n_23312 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27700;
        
        mem_27700.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27700, bytes_27676, "mem_27700")) {
            err = 1;
            goto cleanup;
        }
        if (n_23312 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         payments_mem_27669.mem,
                                                         mem_27700.mem, 0, 0,
                                                         n_23312 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27702;
        
        mem_27702.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27702, bytes_27674, "mem_27702")) {
            err = 1;
            goto cleanup;
        }
        if (n_23312 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         notional_mem_27670.mem,
                                                         mem_27702.mem, 0, 0,
                                                         n_23312 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27719;
        
        mem_27719.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27719, bytes_27674, "mem_27719")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_27920 = segmap_group_sizze_24536 *
                segmap_usable_groups_24537;
        struct memblock_device mem_27948;
        
        mem_27948.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27948, 8, "mem_27948")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mainzicounter_mem_28129 =
                               ctx->mainzicounter_mem_28129;
        struct memblock_device group_res_arr_mem_28131;
        
        group_res_arr_mem_28131.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28131,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_27932 *
                                   segred_num_groups_27930),
                                  "group_res_arr_mem_28131")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28133;
        
        num_threads_28133 = segred_num_groups_27930 * segred_group_sizze_27932;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27936,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_27932,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27936,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27936,
                                                3, sizeof(n_23312), &n_23312));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27936,
                                                4,
                                                sizeof(payments_mem_27669.mem),
                                                &payments_mem_27669.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27936,
                                                5, sizeof(mem_27948.mem),
                                                &mem_27948.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27936,
                                                6,
                                                sizeof(mainzicounter_mem_28129.mem),
                                                &mainzicounter_mem_28129.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27936,
                                                7,
                                                sizeof(group_res_arr_mem_28131.mem),
                                                &group_res_arr_mem_28131.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27936,
                                                8, sizeof(num_threads_28133),
                                                &num_threads_28133));
        if (1 * ((size_t) segred_num_groups_27930 *
                 (size_t) segred_group_sizze_27932) != 0) {
            const size_t global_work_sizze_28933[1] =
                         {(size_t) segred_num_groups_27930 *
                         (size_t) segred_group_sizze_27932};
            const size_t local_work_sizze_28937[1] = {segred_group_sizze_27932};
            int64_t time_start_28934 = 0, time_end_28935 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segred_nonseg_27936");
                fprintf(stderr, "%zu", global_work_sizze_28933[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28937[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_27932 +
                               (int32_t) sizeof(bool)));
                time_start_28934 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegred_nonseg_27936,
                                                            1, NULL,
                                                            global_work_sizze_28933,
                                                            local_work_sizze_28937,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegred_nonseg_27936_runs,
                                                                                                      &ctx->mainzisegred_nonseg_27936_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28935 = get_wall_time();
                
                long time_diff_28936 = time_end_28935 - time_start_28934;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segred_nonseg_27936", time_diff_28936);
            }
        }
        
        int64_t read_res_28938;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27948.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_28938, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t max_per_thread_27926 = read_res_28938;
        
        if (memblock_unref_device(ctx, &mem_27948, "mem_27948") != 0)
            return 1;
        
        int64_t sizze_sum_27943 = num_threads_27920 * max_per_thread_27926;
        struct memblock_device mem_27705;
        
        mem_27705.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27705, sizze_sum_27943,
                                  "mem_27705")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24458, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24458, 3,
                                                sizeof(n_23312), &n_23312));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24458, 4,
                                                sizeof(a_23320), &a_23320));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24458, 5,
                                                sizeof(r0_23323), &r0_23323));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24458, 6,
                                                sizeof(x_23340), &x_23340));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24458, 7,
                                                sizeof(x_23342), &x_23342));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24458, 8,
                                                sizeof(y_23344), &y_23344));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24458, 9,
                                                sizeof(y_23345), &y_23345));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24458, 10,
                                                sizeof(swap_term_mem_27668.mem),
                                                &swap_term_mem_27668.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24458, 11,
                                                sizeof(payments_mem_27669.mem),
                                                &payments_mem_27669.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24458, 12,
                                                sizeof(mem_27705.mem),
                                                &mem_27705.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24458, 13,
                                                sizeof(mem_27719.mem),
                                                &mem_27719.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24458, 14,
                                                sizeof(num_threads_27920),
                                                &num_threads_27920));
        if (1 * ((size_t) segmap_usable_groups_24537 *
                 (size_t) segmap_group_sizze_24536) != 0) {
            const size_t global_work_sizze_28939[1] =
                         {(size_t) segmap_usable_groups_24537 *
                         (size_t) segmap_group_sizze_24536};
            const size_t local_work_sizze_28943[1] = {segmap_group_sizze_24536};
            int64_t time_start_28940 = 0, time_end_28941 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_24458");
                fprintf(stderr, "%zu", global_work_sizze_28939[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28943[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28940 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_24458,
                                                            1, NULL,
                                                            global_work_sizze_28939,
                                                            local_work_sizze_28943,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_24458_runs,
                                                                                                      &ctx->mainzisegmap_24458_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28941 = get_wall_time();
                
                long time_diff_28942 = time_end_28941 - time_start_28940;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_24458", time_diff_28942);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_27705, "mem_27705") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27720, &mem_27719, "mem_27719") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27721, &mem_27702, "mem_27702") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27722, &mem_27700, "mem_27700") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27723, &mem_27698, "mem_27698") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27705, "mem_27705") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28131,
                                  "group_res_arr_mem_28131") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27948, "mem_27948") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27719, "mem_27719") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27702, "mem_27702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27700, "mem_27700") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27698, "mem_27698") != 0)
            return 1;
    }
    
    float sims_per_year_23422 = res_23337 / res_23329;
    bool bounds_invalid_upwards_23423 = slt64(steps_23316, 1);
    bool valid_23424 = !bounds_invalid_upwards_23423;
    bool range_valid_c_23425;
    
    if (!valid_23424) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 1, "..", 2, "...", steps_23316,
                               " is invalid.",
                               "-> #0  cva2.fut:60:56-67\n   #1  cva2.fut:111:17-44\n   #2  cva2.fut:100:1-154:20\n");
        if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27722, "res_mem_27722") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27721, "res_mem_27721") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27720, "res_mem_27720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28064,
                                  "group_res_arr_mem_28064") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_28059, "out_mem_28059") != 0)
            return 1;
        return 1;
    }
    
    bool bounds_invalid_upwards_23431 = slt64(paths_23315, 0);
    bool valid_23432 = !bounds_invalid_upwards_23431;
    bool range_valid_c_23433;
    
    if (!valid_23432) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", paths_23315,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:126:11-16\n   #2  lib/github.com/diku-dk/cpprandom/random.fut:174:8-56\n   #3  cva2.fut:115:19-49\n   #4  cva2.fut:100:1-154:20\n");
        if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27722, "res_mem_27722") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27721, "res_mem_27721") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27720, "res_mem_27720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28064,
                                  "group_res_arr_mem_28064") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_28059, "out_mem_28059") != 0)
            return 1;
        return 1;
    }
    
    int64_t upper_bound_23436 = sub64(steps_23316, 1);
    float res_23437;
    
    res_23437 = futrts_sqrt32(dt_23338);
    
    int64_t one_intra_par_min_24696 = n_23312 * steps_23316;
    int64_t intra_avail_par_24698 = smin64(steps_23316,
                                           one_intra_par_min_24696);
    int64_t computed_group_sizze_24656 = smax64(steps_23316,
                                                one_intra_par_min_24696);
    int64_t max_group_sizze_24848;
    
    max_group_sizze_24848 = ctx->opencl.max_group_size;
    
    bool fits_24849 = sle64(computed_group_sizze_24656, max_group_sizze_24848);
    bool suff_intra_par_24847;
    
    suff_intra_par_24847 = ctx->sizes.mainzisuff_intra_par_3 <=
        intra_avail_par_24698;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_intra_par_3",
                intra_avail_par_24698);
    
    bool intra_suff_and_fits_24850 = suff_intra_par_24847 && fits_24849;
    int64_t segmap_group_sizze_25236;
    
    segmap_group_sizze_25236 = ctx->sizes.mainzisegmap_group_sizze_25219;
    
    int64_t nest_sizze_25260 = paths_23315 * steps_23316;
    int64_t segmap_group_sizze_25261;
    
    segmap_group_sizze_25261 = ctx->sizes.mainzisegmap_group_sizze_25156;
    
    int64_t segmap_group_sizze_25306;
    
    segmap_group_sizze_25306 = ctx->sizes.mainzisegmap_group_sizze_25057;
    
    int64_t num_groups_25307;
    int32_t max_num_groups_28167;
    
    max_num_groups_28167 = ctx->sizes.mainzisegmap_num_groups_25059;
    num_groups_25307 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_23315,
                                                               sext_i32_i64(segmap_group_sizze_25306)),
                                                     sext_i32_i64(max_num_groups_28167))));
    
    int64_t nest_sizze_25351 = paths_23315 * one_intra_par_min_24696;
    int64_t segmap_group_sizze_25352;
    
    segmap_group_sizze_25352 = ctx->sizes.mainzisegmap_group_sizze_25002;
    
    int64_t segmap_group_sizze_25370;
    
    segmap_group_sizze_25370 = ctx->sizes.mainzisegmap_group_sizze_24964;
    
    int64_t binop_x_27752 = n_23312 * nest_sizze_25260;
    int64_t bytes_27750 = 4 * binop_x_27752;
    int64_t bytes_27726 = 4 * steps_23316;
    int64_t bytes_27743 = 4 * one_intra_par_min_24696;
    int64_t bytes_27759 = 4 * paths_23315;
    int64_t bytes_27762 = 4 * nest_sizze_25260;
    int64_t num_threads_27955 = segmap_group_sizze_25306 * num_groups_25307;
    int64_t total_sizze_27956 = bytes_27726 * num_threads_27955;
    struct memblock_device res_mem_27796;
    
    res_mem_27796.references = NULL;
    
    struct memblock_device res_mem_27797;
    
    res_mem_27797.references = NULL;
    
    int32_t local_memory_capacity_28211;
    
    local_memory_capacity_28211 = ctx->opencl.max_local_memory;
    if (sle64(bytes_27726 + bytes_27726 + bytes_27743 + bytes_27743,
              sext_i32_i64(local_memory_capacity_28211)) &&
        intra_suff_and_fits_24850) {
        struct memblock_device mem_27753;
        
        mem_27753.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27753, bytes_27750, "mem_27753")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27757;
        
        mem_27757.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27757, bytes_27750, "mem_27757")) {
            err = 1;
            goto cleanup;
        }
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                3, bytes_27743, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                4, bytes_27743, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                5, bytes_27726, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                6, bytes_27726, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                7, sizeof(n_23312), &n_23312));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                8, sizeof(steps_23316),
                                                &steps_23316));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                9, sizeof(a_23320), &a_23320));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                10, sizeof(b_23321), &b_23321));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                11, sizeof(sigma_23322),
                                                &sigma_23322));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                12, sizeof(r0_23323),
                                                &r0_23323));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                13, sizeof(dt_23338),
                                                &dt_23338));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                14, sizeof(sims_per_year_23422),
                                                &sims_per_year_23422));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                15, sizeof(upper_bound_23436),
                                                &upper_bound_23436));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                16, sizeof(res_23437),
                                                &res_23437));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                17,
                                                sizeof(computed_group_sizze_24656),
                                                &computed_group_sizze_24656));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                18, sizeof(mem_27753.mem),
                                                &mem_27753.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_24699,
                                                19, sizeof(mem_27757.mem),
                                                &mem_27757.mem));
        if (1 * ((size_t) paths_23315 * (size_t) computed_group_sizze_24656) !=
            0) {
            const size_t global_work_sizze_28944[1] = {(size_t) paths_23315 *
                         (size_t) computed_group_sizze_24656};
            const size_t local_work_sizze_28948[1] =
                         {computed_group_sizze_24656};
            int64_t time_start_28945 = 0, time_end_28946 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_intragroup_24699");
                fprintf(stderr, "%zu", global_work_sizze_28944[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28948[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + bytes_27743 + bytes_27743 + bytes_27726 +
                               bytes_27726));
                time_start_28945 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_intragroup_24699,
                                                            1, NULL,
                                                            global_work_sizze_28944,
                                                            local_work_sizze_28948,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_intragroup_24699_runs,
                                                                                                      &ctx->mainzisegmap_intragroup_24699_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28946 = get_wall_time();
                
                long time_diff_28947 = time_end_28946 - time_start_28945;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_intragroup_24699", time_diff_28947);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_set_device(ctx, &res_mem_27796, &mem_27753, "mem_27753") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27797, &mem_27757, "mem_27757") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27757, "mem_27757") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27753, "mem_27753") != 0)
            return 1;
    } else {
        int64_t segmap_usable_groups_25237 = sdiv_up64(paths_23315,
                                                       segmap_group_sizze_25236);
        struct memblock_device mem_27760;
        
        mem_27760.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27760, bytes_27759, "mem_27760")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25217, 1,
                                                sizeof(paths_23315),
                                                &paths_23315));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25217, 2,
                                                sizeof(mem_27760.mem),
                                                &mem_27760.mem));
        if (1 * ((size_t) segmap_usable_groups_25237 *
                 (size_t) segmap_group_sizze_25236) != 0) {
            const size_t global_work_sizze_28949[1] =
                         {(size_t) segmap_usable_groups_25237 *
                         (size_t) segmap_group_sizze_25236};
            const size_t local_work_sizze_28953[1] = {segmap_group_sizze_25236};
            int64_t time_start_28950 = 0, time_end_28951 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_25217");
                fprintf(stderr, "%zu", global_work_sizze_28949[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28953[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28950 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_25217,
                                                            1, NULL,
                                                            global_work_sizze_28949,
                                                            local_work_sizze_28953,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_25217_runs,
                                                                                                      &ctx->mainzisegmap_25217_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28951 = get_wall_time();
                
                long time_diff_28952 = time_end_28951 - time_start_28950;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_25217", time_diff_28952);
            }
        }
        
        int64_t segmap_usable_groups_25262 = sdiv_up64(nest_sizze_25260,
                                                       segmap_group_sizze_25261);
        struct memblock_device mem_27764;
        
        mem_27764.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27764, bytes_27762, "mem_27764")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25153, 1,
                                                sizeof(paths_23315),
                                                &paths_23315));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25153, 2,
                                                sizeof(steps_23316),
                                                &steps_23316));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25153, 3,
                                                sizeof(mem_27760.mem),
                                                &mem_27760.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25153, 4,
                                                sizeof(mem_27764.mem),
                                                &mem_27764.mem));
        if (1 * ((size_t) segmap_usable_groups_25262 *
                 (size_t) segmap_group_sizze_25261) != 0) {
            const size_t global_work_sizze_28954[1] =
                         {(size_t) segmap_usable_groups_25262 *
                         (size_t) segmap_group_sizze_25261};
            const size_t local_work_sizze_28958[1] = {segmap_group_sizze_25261};
            int64_t time_start_28955 = 0, time_end_28956 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_25153");
                fprintf(stderr, "%zu", global_work_sizze_28954[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28958[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28955 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_25153,
                                                            1, NULL,
                                                            global_work_sizze_28954,
                                                            local_work_sizze_28958,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_25153_runs,
                                                                                                      &ctx->mainzisegmap_25153_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28956 = get_wall_time();
                
                long time_diff_28957 = time_end_28956 - time_start_28955;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_25153", time_diff_28957);
            }
        }
        if (memblock_unref_device(ctx, &mem_27760, "mem_27760") != 0)
            return 1;
        
        struct memblock_device mem_27767;
        
        mem_27767.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27767, bytes_27762, "mem_27767")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27767, 0, mem_27764,
                                                  0, 1, steps_23316,
                                                  paths_23315) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_unref_device(ctx, &mem_27764, "mem_27764") != 0)
            return 1;
        
        struct memblock_device mem_27785;
        
        mem_27785.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27785, bytes_27762, "mem_27785")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27770;
        
        mem_27770.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27770, total_sizze_27956,
                                  "mem_27770")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25055, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25055, 3,
                                                sizeof(paths_23315),
                                                &paths_23315));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25055, 4,
                                                sizeof(steps_23316),
                                                &steps_23316));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25055, 5,
                                                sizeof(a_23320), &a_23320));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25055, 6,
                                                sizeof(b_23321), &b_23321));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25055, 7,
                                                sizeof(sigma_23322),
                                                &sigma_23322));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25055, 8,
                                                sizeof(r0_23323), &r0_23323));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25055, 9,
                                                sizeof(dt_23338), &dt_23338));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25055, 10,
                                                sizeof(upper_bound_23436),
                                                &upper_bound_23436));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25055, 11,
                                                sizeof(res_23437), &res_23437));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25055, 12,
                                                sizeof(num_groups_25307),
                                                &num_groups_25307));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25055, 13,
                                                sizeof(mem_27767.mem),
                                                &mem_27767.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25055, 14,
                                                sizeof(mem_27770.mem),
                                                &mem_27770.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25055, 15,
                                                sizeof(mem_27785.mem),
                                                &mem_27785.mem));
        if (1 * ((size_t) num_groups_25307 *
                 (size_t) segmap_group_sizze_25306) != 0) {
            const size_t global_work_sizze_28959[1] =
                         {(size_t) num_groups_25307 *
                         (size_t) segmap_group_sizze_25306};
            const size_t local_work_sizze_28963[1] = {segmap_group_sizze_25306};
            int64_t time_start_28960 = 0, time_end_28961 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_25055");
                fprintf(stderr, "%zu", global_work_sizze_28959[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28963[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28960 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_25055,
                                                            1, NULL,
                                                            global_work_sizze_28959,
                                                            local_work_sizze_28963,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_25055_runs,
                                                                                                      &ctx->mainzisegmap_25055_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28961 = get_wall_time();
                
                long time_diff_28962 = time_end_28961 - time_start_28960;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_25055", time_diff_28962);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_27767, "mem_27767") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27770, "mem_27770") != 0)
            return 1;
        
        int64_t segmap_usable_groups_25353 = sdiv_up64(nest_sizze_25351,
                                                       segmap_group_sizze_25352);
        struct memblock_device mem_27790;
        
        mem_27790.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27790, bytes_27750, "mem_27790")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24998, 1,
                                                sizeof(n_23312), &n_23312));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24998, 2,
                                                sizeof(paths_23315),
                                                &paths_23315));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24998, 3,
                                                sizeof(steps_23316),
                                                &steps_23316));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24998, 4,
                                                sizeof(mem_27785.mem),
                                                &mem_27785.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24998, 5,
                                                sizeof(mem_27790.mem),
                                                &mem_27790.mem));
        if (1 * ((size_t) segmap_usable_groups_25353 *
                 (size_t) segmap_group_sizze_25352) != 0) {
            const size_t global_work_sizze_28964[1] =
                         {(size_t) segmap_usable_groups_25353 *
                         (size_t) segmap_group_sizze_25352};
            const size_t local_work_sizze_28968[1] = {segmap_group_sizze_25352};
            int64_t time_start_28965 = 0, time_end_28966 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_24998");
                fprintf(stderr, "%zu", global_work_sizze_28964[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28968[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28965 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_24998,
                                                            1, NULL,
                                                            global_work_sizze_28964,
                                                            local_work_sizze_28968,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_24998_runs,
                                                                                                      &ctx->mainzisegmap_24998_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28966 = get_wall_time();
                
                long time_diff_28967 = time_end_28966 - time_start_28965;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_24998", time_diff_28967);
            }
        }
        if (memblock_unref_device(ctx, &mem_27785, "mem_27785") != 0)
            return 1;
        
        int64_t segmap_usable_groups_25371 = sdiv_up64(nest_sizze_25351,
                                                       segmap_group_sizze_25370);
        struct memblock_device mem_27795;
        
        mem_27795.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27795, bytes_27750, "mem_27795")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24960, 1,
                                                sizeof(n_23312), &n_23312));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24960, 2,
                                                sizeof(paths_23315),
                                                &paths_23315));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24960, 3,
                                                sizeof(steps_23316),
                                                &steps_23316));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24960, 4,
                                                sizeof(sims_per_year_23422),
                                                &sims_per_year_23422));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_24960, 5,
                                                sizeof(mem_27795.mem),
                                                &mem_27795.mem));
        if (1 * ((size_t) segmap_usable_groups_25371 *
                 (size_t) segmap_group_sizze_25370) != 0) {
            const size_t global_work_sizze_28969[1] =
                         {(size_t) segmap_usable_groups_25371 *
                         (size_t) segmap_group_sizze_25370};
            const size_t local_work_sizze_28973[1] = {segmap_group_sizze_25370};
            int64_t time_start_28970 = 0, time_end_28971 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_24960");
                fprintf(stderr, "%zu", global_work_sizze_28969[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28973[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28970 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_24960,
                                                            1, NULL,
                                                            global_work_sizze_28969,
                                                            local_work_sizze_28973,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_24960_runs,
                                                                                                      &ctx->mainzisegmap_24960_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28971 = get_wall_time();
                
                long time_diff_28972 = time_end_28971 - time_start_28970;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_24960", time_diff_28972);
            }
        }
        if (memblock_set_device(ctx, &res_mem_27796, &mem_27790, "mem_27790") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27797, &mem_27795, "mem_27795") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27795, "mem_27795") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27790, "mem_27790") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27770, "mem_27770") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27785, "mem_27785") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27767, "mem_27767") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27764, "mem_27764") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27760, "mem_27760") != 0)
            return 1;
    }
    
    int64_t segscan_group_sizze_25382;
    
    segscan_group_sizze_25382 = ctx->sizes.mainzisegscan_group_sizze_25381;
    
    int64_t num_groups_25384;
    int32_t max_num_groups_28212;
    
    max_num_groups_28212 = ctx->sizes.mainzisegscan_num_groups_25383;
    num_groups_25384 = sext_i64_i32(smax64(1, smin64(sdiv_up64(binop_x_27752,
                                                               sext_i32_i64(segscan_group_sizze_25382)),
                                                     sext_i32_i64(max_num_groups_28212))));
    
    int64_t bytes_27799 = 8 * binop_x_27752;
    struct memblock_device mem_27800;
    
    mem_27800.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27800, bytes_27799, "mem_27800")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27802;
    
    mem_27802.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27802, bytes_27799, "mem_27802")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, binop_x_27752)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28213;
        
        stage1_max_num_groups_28213 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28214;
        
        stage1_num_groups_28214 = smin64(stage1_max_num_groups_28213,
                                         num_groups_25384);
        
        int32_t num_threads_28215;
        
        num_threads_28215 = sext_i64_i32(stage1_num_groups_28214 *
            segscan_group_sizze_25382);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25387, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_25382),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25387, 2,
                                                sizeof(n_23312), &n_23312));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25387, 3,
                                                sizeof(steps_23316),
                                                &steps_23316));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25387, 4,
                                                sizeof(one_intra_par_min_24696),
                                                &one_intra_par_min_24696));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25387, 5,
                                                sizeof(res_mem_27722.mem),
                                                &res_mem_27722.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25387, 6,
                                                sizeof(res_mem_27723.mem),
                                                &res_mem_27723.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25387, 7,
                                                sizeof(binop_x_27752),
                                                &binop_x_27752));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25387, 8,
                                                sizeof(res_mem_27797.mem),
                                                &res_mem_27797.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25387, 9,
                                                sizeof(mem_27800.mem),
                                                &mem_27800.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25387,
                                                10, sizeof(mem_27802.mem),
                                                &mem_27802.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25387,
                                                11, sizeof(num_threads_28215),
                                                &num_threads_28215));
        if (1 * ((size_t) stage1_num_groups_28214 *
                 (size_t) segscan_group_sizze_25382) != 0) {
            const size_t global_work_sizze_28974[1] =
                         {(size_t) stage1_num_groups_28214 *
                         (size_t) segscan_group_sizze_25382};
            const size_t local_work_sizze_28978[1] =
                         {segscan_group_sizze_25382};
            int64_t time_start_28975 = 0, time_end_28976 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage1_25387");
                fprintf(stderr, "%zu", global_work_sizze_28974[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28978[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_25382)));
                time_start_28975 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage1_25387,
                                                            1, NULL,
                                                            global_work_sizze_28974,
                                                            local_work_sizze_28978,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage1_25387_runs,
                                                                                                      &ctx->mainziscan_stage1_25387_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28976 = get_wall_time();
                
                long time_diff_28977 = time_end_28976 - time_start_28975;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage1_25387", time_diff_28977);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_25382 *
                                 sdiv_up64(binop_x_27752,
                                           sext_i32_i64(num_threads_28215))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25387, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_28214),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25387, 2,
                                                sizeof(binop_x_27752),
                                                &binop_x_27752));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25387, 3,
                                                sizeof(mem_27800.mem),
                                                &mem_27800.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25387, 4,
                                                sizeof(stage1_num_groups_28214),
                                                &stage1_num_groups_28214));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25387, 5,
                                                sizeof(num_threads_28215),
                                                &num_threads_28215));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28214) != 0) {
            const size_t global_work_sizze_28979[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28214};
            const size_t local_work_sizze_28983[1] = {stage1_num_groups_28214};
            int64_t time_start_28980 = 0, time_end_28981 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage2_25387");
                fprintf(stderr, "%zu", global_work_sizze_28979[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28983[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_28214)));
                time_start_28980 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage2_25387,
                                                            1, NULL,
                                                            global_work_sizze_28979,
                                                            local_work_sizze_28983,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage2_25387_runs,
                                                                                                      &ctx->mainziscan_stage2_25387_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28981 = get_wall_time();
                
                long time_diff_28982 = time_end_28981 - time_start_28980;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage2_25387", time_diff_28982);
            }
        }
        
        int32_t required_groups_28251;
        
        required_groups_28251 = sext_i64_i32(sdiv_up64(binop_x_27752,
                                                       segscan_group_sizze_25382));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25387, 1,
                                                sizeof(num_groups_25384),
                                                &num_groups_25384));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25387, 2,
                                                sizeof(binop_x_27752),
                                                &binop_x_27752));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25387, 3,
                                                sizeof(mem_27800.mem),
                                                &mem_27800.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25387, 4,
                                                sizeof(num_threads_28215),
                                                &num_threads_28215));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25387, 5,
                                                sizeof(required_groups_28251),
                                                &required_groups_28251));
        if (1 * ((size_t) num_groups_25384 *
                 (size_t) segscan_group_sizze_25382) != 0) {
            const size_t global_work_sizze_28984[1] =
                         {(size_t) num_groups_25384 *
                         (size_t) segscan_group_sizze_25382};
            const size_t local_work_sizze_28988[1] =
                         {segscan_group_sizze_25382};
            int64_t time_start_28985 = 0, time_end_28986 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage3_25387");
                fprintf(stderr, "%zu", global_work_sizze_28984[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_28988[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_28985 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage3_25387,
                                                            1, NULL,
                                                            global_work_sizze_28984,
                                                            local_work_sizze_28988,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage3_25387_runs,
                                                                                                      &ctx->mainziscan_stage3_25387_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_28986 = get_wall_time();
                
                long time_diff_28987 = time_end_28986 - time_start_28985;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage3_25387", time_diff_28987);
            }
        }
    }
    
    int64_t segred_group_sizze_25390;
    
    segred_group_sizze_25390 = ctx->sizes.mainzisegred_group_sizze_25389;
    
    int64_t num_groups_25392;
    int32_t max_num_groups_28263;
    
    max_num_groups_28263 = ctx->sizes.mainzisegred_num_groups_25391;
    num_groups_25392 = sext_i64_i32(smax64(1, smin64(sdiv_up64(binop_x_27752,
                                                               sext_i32_i64(segred_group_sizze_25390)),
                                                     sext_i32_i64(max_num_groups_28263))));
    
    struct memblock_device mem_27805;
    
    mem_27805.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27805, 8, "mem_27805")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mainzicounter_mem_28264 =
                           ctx->mainzicounter_mem_28264;
    struct memblock_device group_res_arr_mem_28266;
    
    group_res_arr_mem_28266.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_28266,
                              (int32_t) sizeof(int64_t) *
                              (segred_group_sizze_25390 * num_groups_25392),
                              "group_res_arr_mem_28266")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_28268;
    
    num_threads_28268 = num_groups_25392 * segred_group_sizze_25390;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25397, 1,
                                            (int32_t) sizeof(int64_t) *
                                            segred_group_sizze_25390, NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25397, 2,
                                            (int32_t) sizeof(bool), NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25397, 3,
                                            sizeof(num_groups_25392),
                                            &num_groups_25392));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25397, 4,
                                            sizeof(binop_x_27752),
                                            &binop_x_27752));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25397, 5,
                                            sizeof(mem_27802.mem),
                                            &mem_27802.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25397, 6,
                                            sizeof(mem_27805.mem),
                                            &mem_27805.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25397, 7,
                                            sizeof(mainzicounter_mem_28264.mem),
                                            &mainzicounter_mem_28264.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25397, 8,
                                            sizeof(group_res_arr_mem_28266.mem),
                                            &group_res_arr_mem_28266.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25397, 9,
                                            sizeof(num_threads_28268),
                                            &num_threads_28268));
    if (1 * ((size_t) num_groups_25392 * (size_t) segred_group_sizze_25390) !=
        0) {
        const size_t global_work_sizze_28990[1] = {(size_t) num_groups_25392 *
                     (size_t) segred_group_sizze_25390};
        const size_t local_work_sizze_28994[1] = {segred_group_sizze_25390};
        int64_t time_start_28991 = 0, time_end_28992 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segred_nonseg_25397");
            fprintf(stderr, "%zu", global_work_sizze_28990[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_28994[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) (0 + (int32_t) sizeof(int64_t) *
                           segred_group_sizze_25390 + (int32_t) sizeof(bool)));
            time_start_28991 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegred_nonseg_25397,
                                                        1, NULL,
                                                        global_work_sizze_28990,
                                                        local_work_sizze_28994,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegred_nonseg_25397_runs,
                                                                                                  &ctx->mainzisegred_nonseg_25397_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_28992 = get_wall_time();
            
            long time_diff_28993 = time_end_28992 - time_start_28991;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "main.segred_nonseg_25397", time_diff_28993);
        }
    }
    if (memblock_unref_device(ctx, &mem_27802, "mem_27802") != 0)
        return 1;
    
    int64_t read_res_28995;
    
    OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                 mem_27805.mem,
                                                 ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                 0 * sizeof(int64_t),
                                                 sizeof(int64_t),
                                                 &read_res_28995, 0, NULL,
                                                 ctx->profiling_paused ||
                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                           &ctx->copy_scalar_from_dev_runs,
                                                                                           &ctx->copy_scalar_from_dev_total_runtime)));
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t res_23531 = read_res_28995;
    
    if (memblock_unref_device(ctx, &mem_27805, "mem_27805") != 0)
        return 1;
    
    bool bounds_invalid_upwards_23536 = slt64(res_23531, 0);
    bool valid_23537 = !bounds_invalid_upwards_23536;
    bool range_valid_c_23538;
    
    if (!valid_23537) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", res_23531,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:48:30-60\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:87:14-32\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva2.fut:134:18-77\n   #6  cva2.fut:100:1-154:20\n");
        if (memblock_unref_device(ctx, &group_res_arr_mem_28266,
                                  "group_res_arr_mem_28266") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27805, "mem_27805") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27802, "mem_27802") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27800, "mem_27800") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27797, "res_mem_27797") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27796, "res_mem_27796") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27722, "res_mem_27722") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27721, "res_mem_27721") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27720, "res_mem_27720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28064,
                                  "group_res_arr_mem_28064") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_28059, "out_mem_28059") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_27806 = 8 * res_23531;
    struct memblock_device mem_27807;
    
    mem_27807.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27807, bytes_27806, "mem_27807")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_27807, res_23531, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t seghist_group_sizze_25400;
    
    seghist_group_sizze_25400 = ctx->sizes.mainziseghist_group_sizze_25399;
    
    int64_t num_groups_25402;
    int32_t max_num_groups_28303;
    
    max_num_groups_28303 = ctx->sizes.mainziseghist_num_groups_25401;
    num_groups_25402 = sext_i64_i32(smax64(1, smin64(sdiv_up64(binop_x_27752,
                                                               sext_i32_i64(seghist_group_sizze_25400)),
                                                     sext_i32_i64(max_num_groups_28303))));
    
    int32_t num_subhistos_28304;
    struct memblock_device res_subhistos_mem_28305;
    
    res_subhistos_mem_28305.references = NULL;
    
    int64_t h_28307;
    
    h_28307 = (int32_t) sizeof(int64_t) * res_23531;
    
    int64_t seg_h_28308;
    
    seg_h_28308 = (int32_t) sizeof(int64_t) * res_23531;
    if (!(seg_h_28308 == 0)) {
        int64_t hist_H_28309 = res_23531;
        int64_t hist_el_sizze_28310 = sdiv_up64(h_28307, hist_H_28309) + 4;
        int64_t hist_N_28311 = binop_x_27752;
        int64_t hist_RF_28312 = 1;
        
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegHist");
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Number of threads (T)",
                    (long long) sext_i64_i32(num_groups_25402 *
                    seghist_group_sizze_25400), '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Desired group size (B)",
                    (long long) seghist_group_sizze_25400, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                    (long long) hist_H_28309, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Input elements per histogram (N)",
                    (long long) hist_N_28311, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Number of segments", (long long) 1,
                    '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Histogram element size (el_size)",
                    (long long) hist_el_sizze_28310, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Race factor (RF)",
                    (long long) hist_RF_28312, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c",
                    "Memory per set of subhistograms per segment",
                    (long long) h_28307, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c",
                    "Memory per set of subhistograms times segments",
                    (long long) seg_h_28308, '\n');
        
        int32_t hist_L_28313;
        
        hist_L_28313 = ctx->opencl.max_local_memory;
        
        int32_t max_group_sizze_28314;
        
        max_group_sizze_28314 = ctx->opencl.max_group_size;
        
        int64_t num_groups_28315;
        
        num_groups_28315 =
            sdiv_up64(sext_i32_i64(sext_i64_i32(num_groups_25402 *
                      seghist_group_sizze_25400)), max_group_sizze_28314);
        
        double hist_m_prime_28316;
        
        hist_m_prime_28316 =
            sitofp_i64_f64(smin64(sext_i32_i64(squot32(hist_L_28313,
                                                       hist_el_sizze_28310)),
                                  sdiv_up64(hist_N_28311, num_groups_28315))) /
            sitofp_i64_f64(hist_H_28309);
        
        int64_t hist_M0_28317;
        
        hist_M0_28317 = smax64(1, smin64(fptosi_f64_i64(hist_m_prime_28316),
                                         max_group_sizze_28314));
        
        int64_t hist_Nout_28318;
        
        hist_Nout_28318 = 1;
        
        int64_t hist_Nin_28319;
        
        hist_Nin_28319 = binop_x_27752;
        
        int64_t work_asymp_M_max_28320;
        
        work_asymp_M_max_28320 = squot64(hist_Nout_28318 * hist_N_28311, 2 *
                                         num_groups_28315 * hist_H_28309);
        
        int32_t hist_M_28321;
        
        hist_M_28321 = sext_i64_i32(smin64(hist_M0_28317,
                                           work_asymp_M_max_28320));
        
        int64_t hist_C_28322;
        
        hist_C_28322 = sdiv_up64(max_group_sizze_28314, sext_i32_i64(smax32(1,
                                                                            hist_M_28321)));
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local hist_M0",
                    (long long) hist_M0_28317, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local work asymp M max",
                    (long long) work_asymp_M_max_28320, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local C", (long long) hist_C_28322,
                    '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local B",
                    (long long) max_group_sizze_28314, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local M", (long long) hist_M_28321,
                    '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local memory needed",
                    (long long) (hist_H_28309 * hist_el_sizze_28310 *
                                 sext_i32_i64(hist_M_28321)), '\n');
        
        int64_t local_mem_needed_28323;
        
        local_mem_needed_28323 = hist_el_sizze_28310 *
            sext_i32_i64(hist_M_28321);
        
        int32_t hist_S_28324;
        
        hist_S_28324 = sext_i64_i32(sdiv_up64(hist_H_28309 *
                                              local_mem_needed_28323,
                                              hist_L_28313));
        if (sle64(hist_H_28309, hist_Nin_28319) &&
            (sle64(local_mem_needed_28323, hist_L_28313) && (sle32(hist_S_28324,
                                                                   6) &&
                                                             (sle64(hist_C_28322,
                                                                    max_group_sizze_28314) &&
                                                              slt32(0,
                                                                    hist_M_28321))))) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "## Using local memory");
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                        (long long) hist_H_28309, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                        (long long) hist_M_28321, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Cooperation level (C)",
                        (long long) hist_C_28322, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                        (long long) hist_S_28324, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Number of local subhistograms per group",
                        (long long) hist_M_28321, '\n');
            
            int64_t num_segments_28325;
            
            num_segments_28325 = 1;
            num_subhistos_28304 = num_groups_28315 * num_segments_28325;
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Number of subhistograms in global memory",
                        (long long) num_subhistos_28304, '\n');
            if (num_subhistos_28304 == 1) {
                if (memblock_set_device(ctx, &res_subhistos_mem_28305,
                                        &mem_27807, "mem_27807") != 0)
                    return 1;
            } else {
                if (memblock_alloc_device(ctx, &res_subhistos_mem_28305,
                                          sext_i32_i64(num_subhistos_28304) *
                                          res_23531 * (int32_t) sizeof(int64_t),
                                          "res_subhistos_mem_28305")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, res_subhistos_mem_28305,
                                                  num_subhistos_28304 *
                                                  res_23531, 0) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (res_23531 * (int32_t) sizeof(int64_t) > 0) {
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                 mem_27807.mem,
                                                                 res_subhistos_mem_28305.mem,
                                                                 0, 0,
                                                                 res_23531 *
                                                                 (int32_t) sizeof(int64_t),
                                                                 0, NULL,
                                                                 ctx->profiling_paused ||
                                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                           &ctx->copy_dev_to_dev_runs,
                                                                                                           &ctx->copy_dev_to_dev_total_runtime)));
                    if (ctx->debugging)
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                }
            }
            for (int32_t chk_i_28326 = 0; chk_i_28326 < hist_S_28324;
                 chk_i_28326++) {
                int64_t num_segments_28327 = 1;
                int64_t hist_H_chk_28328 = sdiv_up64(res_23531,
                                                     sext_i32_i64(hist_S_28324));
                int64_t histo_sizze_28329 = hist_H_chk_28328;
                int32_t init_per_thread_28330 =
                        sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_28321) *
                                               histo_sizze_28329,
                                               max_group_sizze_28314));
                
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25405,
                                                        1,
                                                        (int32_t) sizeof(int32_t) *
                                                        (hist_M_28321 *
                                                         hist_H_chk_28328),
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25405,
                                                        2,
                                                        (int32_t) sizeof(int64_t) *
                                                        (hist_M_28321 *
                                                         hist_H_chk_28328),
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25405,
                                                        3, sizeof(res_23531),
                                                        &res_23531));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25405,
                                                        4,
                                                        sizeof(binop_x_27752),
                                                        &binop_x_27752));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25405,
                                                        5,
                                                        sizeof(mem_27800.mem),
                                                        &mem_27800.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25405,
                                                        6,
                                                        sizeof(res_subhistos_mem_28305.mem),
                                                        &res_subhistos_mem_28305.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25405,
                                                        7,
                                                        sizeof(max_group_sizze_28314),
                                                        &max_group_sizze_28314));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25405,
                                                        8,
                                                        sizeof(num_groups_28315),
                                                        &num_groups_28315));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25405,
                                                        9, sizeof(hist_M_28321),
                                                        &hist_M_28321));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25405,
                                                        10, sizeof(chk_i_28326),
                                                        &chk_i_28326));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25405,
                                                        11,
                                                        sizeof(num_segments_28327),
                                                        &num_segments_28327));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25405,
                                                        12,
                                                        sizeof(hist_H_chk_28328),
                                                        &hist_H_chk_28328));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25405,
                                                        13,
                                                        sizeof(histo_sizze_28329),
                                                        &histo_sizze_28329));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_25405,
                                                        14,
                                                        sizeof(init_per_thread_28330),
                                                        &init_per_thread_28330));
                if (1 * ((size_t) num_groups_28315 *
                         (size_t) max_group_sizze_28314) != 0) {
                    const size_t global_work_sizze_28996[1] =
                                 {(size_t) num_groups_28315 *
                                 (size_t) max_group_sizze_28314};
                    const size_t local_work_sizze_29000[1] =
                                 {max_group_sizze_28314};
                    int64_t time_start_28997 = 0, time_end_28998 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.seghist_local_25405");
                        fprintf(stderr, "%zu", global_work_sizze_28996[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29000[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(int32_t) *
                                       (hist_M_28321 * hist_H_chk_28328) +
                                       (int32_t) sizeof(int64_t) *
                                       (hist_M_28321 * hist_H_chk_28328)));
                        time_start_28997 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainziseghist_local_25405,
                                                                    1, NULL,
                                                                    global_work_sizze_28996,
                                                                    local_work_sizze_29000,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainziseghist_local_25405_runs,
                                                                                                              &ctx->mainziseghist_local_25405_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_28998 = get_wall_time();
                        
                        long time_diff_28999 = time_end_28998 -
                             time_start_28997;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.seghist_local_25405", time_diff_28999);
                    }
                }
            }
        } else {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "## Using global memory");
            
            int64_t hist_H_28362;
            
            hist_H_28362 = res_23531;
            
            double hist_RF_28363;
            
            hist_RF_28363 = (0.0 + sitofp_i32_f64(1)) / 1.0;
            
            int32_t hist_el_sizze_28364;
            
            hist_el_sizze_28364 =
                squot32(sext_i64_i32((int32_t) sizeof(int32_t) +
                        (int32_t) sizeof(int64_t)), 2);
            
            double hist_C_max_28365;
            
            hist_C_max_28365 =
                fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_25402 *
                       seghist_group_sizze_25400)),
                       sitofp_i32_f64(hist_H_28362) / 2.0);
            
            int32_t hist_M_min_28366;
            
            hist_M_min_28366 = smax32(1,
                                      sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_25402 *
                                      seghist_group_sizze_25400)) /
                                      hist_C_max_28365)));
            
            int32_t L2_sizze_28367;
            
            L2_sizze_28367 = ctx->sizes.mainziL2_sizze_28367;
            
            double hist_RACE_exp_28368;
            
            hist_RACE_exp_28368 = fmax64(1.0, 0.75 * hist_RF_28363 / (64.0 /
                                                                      sitofp_i32_f64(hist_el_sizze_28364)));
            
            int32_t hist_S_28369;
            
            if (slt64(binop_x_27752, hist_H_28362)) {
                hist_S_28369 = 1;
            } else {
                hist_S_28369 =
                    sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_min_28366) *
                                           hist_H_28362 *
                                           sext_i32_i64(hist_el_sizze_28364),
                                           fptosi_f64_i64(0.4 *
                                           sitofp_i32_f64(L2_sizze_28367) *
                                           hist_RACE_exp_28368)));
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %f%c", "Race expansion factor (RACE^exp)",
                        (double) hist_RACE_exp_28368, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                        (long long) hist_S_28369, '\n');
            
            int64_t hist_H_chk_28370;
            
            hist_H_chk_28370 = sdiv_up64(res_23531, sext_i32_i64(hist_S_28369));
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Chunk size (H_chk)",
                        (long long) hist_H_chk_28370, '\n');
            
            double hist_k_max_28371;
            
            hist_k_max_28371 = fmin64(0.4 * (sitofp_i32_f64(L2_sizze_28367) /
                                             sitofp_i32_f64(sext_i64_i32((int32_t) sizeof(int32_t) +
                                             (int32_t) sizeof(int64_t)))) *
                                      hist_RACE_exp_28368,
                                      sitofp_i32_f64(binop_x_27752)) /
                sitofp_i32_f64(sext_i64_i32(num_groups_25402 *
                seghist_group_sizze_25400));
            
            int64_t hist_u_28372;
            
            hist_u_28372 = 1;
            
            double hist_C_28373;
            
            hist_C_28373 = fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_25402 *
                                  seghist_group_sizze_25400)),
                                  sitofp_i32_f64(hist_u_28372 *
                                  hist_H_chk_28370) / hist_k_max_28371);
            
            int32_t hist_M_28374;
            
            hist_M_28374 = smax32(hist_M_min_28366,
                                  sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_25402 *
                                  seghist_group_sizze_25400)) / hist_C_28373)));
            if (ctx->debugging)
                fprintf(stderr, "%s: %f%c",
                        "Elements/thread in L2 cache (k_max)",
                        (double) hist_k_max_28371, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                        (long long) hist_M_28374, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %f%c", "Cooperation level (C)",
                        (double) hist_C_28373, '\n');
            num_subhistos_28304 = sext_i32_i64(hist_M_28374);
            if (hist_M_28374 == 1) {
                if (memblock_set_device(ctx, &res_subhistos_mem_28305,
                                        &mem_27807, "mem_27807") != 0)
                    return 1;
            } else {
                if (num_subhistos_28304 == 1) {
                    if (memblock_set_device(ctx, &res_subhistos_mem_28305,
                                            &mem_27807, "mem_27807") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &res_subhistos_mem_28305,
                                              sext_i32_i64(num_subhistos_28304) *
                                              res_23531 *
                                              (int32_t) sizeof(int64_t),
                                              "res_subhistos_mem_28305")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx,
                                                      res_subhistos_mem_28305,
                                                      num_subhistos_28304 *
                                                      res_23531, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (res_23531 * (int32_t) sizeof(int64_t) > 0) {
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                     mem_27807.mem,
                                                                     res_subhistos_mem_28305.mem,
                                                                     0, 0,
                                                                     res_23531 *
                                                                     (int32_t) sizeof(int64_t),
                                                                     0, NULL,
                                                                     ctx->profiling_paused ||
                                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
                        if (ctx->debugging)
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    }
                }
            }
            
            struct memblock_device mainzihist_locks_mem_28375 =
                                   ctx->mainzihist_locks_mem_28375;
            
            for (int32_t chk_i_28377 = 0; chk_i_28377 < hist_S_28369;
                 chk_i_28377++) {
                int64_t hist_H_chk_28378 = sdiv_up64(res_23531,
                                                     sext_i32_i64(hist_S_28369));
                
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25405,
                                                        1, sizeof(res_23531),
                                                        &res_23531));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25405,
                                                        2,
                                                        sizeof(num_groups_25402),
                                                        &num_groups_25402));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25405,
                                                        3,
                                                        sizeof(binop_x_27752),
                                                        &binop_x_27752));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25405,
                                                        4,
                                                        sizeof(mem_27800.mem),
                                                        &mem_27800.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25405,
                                                        5,
                                                        sizeof(num_subhistos_28304),
                                                        &num_subhistos_28304));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25405,
                                                        6,
                                                        sizeof(res_subhistos_mem_28305.mem),
                                                        &res_subhistos_mem_28305.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25405,
                                                        7,
                                                        sizeof(mainzihist_locks_mem_28375.mem),
                                                        &mainzihist_locks_mem_28375.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25405,
                                                        8, sizeof(chk_i_28377),
                                                        &chk_i_28377));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_25405,
                                                        9,
                                                        sizeof(hist_H_chk_28378),
                                                        &hist_H_chk_28378));
                if (1 * ((size_t) num_groups_25402 *
                         (size_t) seghist_group_sizze_25400) != 0) {
                    const size_t global_work_sizze_29002[1] =
                                 {(size_t) num_groups_25402 *
                                 (size_t) seghist_group_sizze_25400};
                    const size_t local_work_sizze_29006[1] =
                                 {seghist_group_sizze_25400};
                    int64_t time_start_29003 = 0, time_end_29004 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.seghist_global_25405");
                        fprintf(stderr, "%zu", global_work_sizze_29002[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29006[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_29003 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainziseghist_global_25405,
                                                                    1, NULL,
                                                                    global_work_sizze_29002,
                                                                    local_work_sizze_29006,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainziseghist_global_25405_runs,
                                                                                                              &ctx->mainziseghist_global_25405_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29004 = get_wall_time();
                        
                        long time_diff_29005 = time_end_29004 -
                             time_start_29003;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.seghist_global_25405", time_diff_29005);
                    }
                }
            }
        }
        if (num_subhistos_28304 == 1) {
            if (memblock_set_device(ctx, &mem_27807, &res_subhistos_mem_28305,
                                    "res_subhistos_mem_28305") != 0)
                return 1;
        } else {
            if (slt64(num_subhistos_28304 * 2, seghist_group_sizze_25400)) {
                int64_t segment_sizze_nonzzero_28391 = smax64(1,
                                                              num_subhistos_28304);
                int64_t num_threads_28392 = num_groups_25402 *
                        seghist_group_sizze_25400;
                
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegRed-small");
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "num_segments",
                            (long long) res_23531, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "segment_size",
                            (long long) num_subhistos_28304, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "segments_per_group",
                            (long long) squot64(seghist_group_sizze_25400,
                                                segment_sizze_nonzzero_28391),
                            '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "required_groups",
                            (long long) sext_i64_i32(sdiv_up64(res_23531,
                                                               squot64(seghist_group_sizze_25400,
                                                                       segment_sizze_nonzzero_28391))),
                            '\n');
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28390,
                                                        1,
                                                        (int32_t) sizeof(int64_t) *
                                                        seghist_group_sizze_25400,
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28390,
                                                        2, sizeof(res_23531),
                                                        &res_23531));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28390,
                                                        3,
                                                        sizeof(num_groups_25402),
                                                        &num_groups_25402));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28390,
                                                        4,
                                                        sizeof(mem_27807.mem),
                                                        &mem_27807.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28390,
                                                        5,
                                                        sizeof(num_subhistos_28304),
                                                        &num_subhistos_28304));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28390,
                                                        6,
                                                        sizeof(res_subhistos_mem_28305.mem),
                                                        &res_subhistos_mem_28305.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_28390,
                                                        7,
                                                        sizeof(segment_sizze_nonzzero_28391),
                                                        &segment_sizze_nonzzero_28391));
                if (1 * ((size_t) num_groups_25402 *
                         (size_t) seghist_group_sizze_25400) != 0) {
                    const size_t global_work_sizze_29007[1] =
                                 {(size_t) num_groups_25402 *
                                 (size_t) seghist_group_sizze_25400};
                    const size_t local_work_sizze_29011[1] =
                                 {seghist_group_sizze_25400};
                    int64_t time_start_29008 = 0, time_end_29009 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.segred_small_28390");
                        fprintf(stderr, "%zu", global_work_sizze_29007[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29011[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(int64_t) *
                                       seghist_group_sizze_25400));
                        time_start_29008 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainzisegred_small_28390,
                                                                    1, NULL,
                                                                    global_work_sizze_29007,
                                                                    local_work_sizze_29011,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainzisegred_small_28390_runs,
                                                                                                              &ctx->mainzisegred_small_28390_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29009 = get_wall_time();
                        
                        long time_diff_29010 = time_end_29009 -
                             time_start_29008;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.segred_small_28390", time_diff_29010);
                    }
                }
            } else {
                int64_t groups_per_segment_28412 = sdiv_up64(num_groups_25402,
                                                             smax64(1,
                                                                    res_23531));
                int64_t elements_per_thread_28413 =
                        sdiv_up64(num_subhistos_28304,
                                  seghist_group_sizze_25400 *
                                  groups_per_segment_28412);
                int64_t virt_num_groups_28414 = groups_per_segment_28412 *
                        res_23531;
                int64_t num_threads_28415 = num_groups_25402 *
                        seghist_group_sizze_25400;
                int64_t threads_per_segment_28416 = groups_per_segment_28412 *
                        seghist_group_sizze_25400;
                
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegRed-large");
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "num_segments",
                            (long long) res_23531, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "segment_size",
                            (long long) num_subhistos_28304, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                            (long long) virt_num_groups_28414, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "num_groups",
                            (long long) num_groups_25402, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "group_size",
                            (long long) seghist_group_sizze_25400, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                            (long long) elements_per_thread_28413, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                            (long long) groups_per_segment_28412, '\n');
                
                struct memblock_device group_res_arr_mem_28417;
                
                group_res_arr_mem_28417.references = NULL;
                if (memblock_alloc_device(ctx, &group_res_arr_mem_28417,
                                          (int32_t) sizeof(int64_t) *
                                          (seghist_group_sizze_25400 *
                                           virt_num_groups_28414),
                                          "group_res_arr_mem_28417")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mainzicounter_mem_28419 =
                                       ctx->mainzicounter_mem_28419;
                
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28390,
                                                        1,
                                                        (int32_t) sizeof(bool),
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28390,
                                                        2,
                                                        (int32_t) sizeof(int64_t) *
                                                        seghist_group_sizze_25400,
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28390,
                                                        3, sizeof(res_23531),
                                                        &res_23531));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28390,
                                                        4,
                                                        sizeof(num_groups_25402),
                                                        &num_groups_25402));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28390,
                                                        5,
                                                        sizeof(mem_27807.mem),
                                                        &mem_27807.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28390,
                                                        6,
                                                        sizeof(num_subhistos_28304),
                                                        &num_subhistos_28304));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28390,
                                                        7,
                                                        sizeof(res_subhistos_mem_28305.mem),
                                                        &res_subhistos_mem_28305.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28390,
                                                        8,
                                                        sizeof(groups_per_segment_28412),
                                                        &groups_per_segment_28412));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28390,
                                                        9,
                                                        sizeof(elements_per_thread_28413),
                                                        &elements_per_thread_28413));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28390,
                                                        10,
                                                        sizeof(virt_num_groups_28414),
                                                        &virt_num_groups_28414));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28390,
                                                        11,
                                                        sizeof(threads_per_segment_28416),
                                                        &threads_per_segment_28416));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28390,
                                                        12,
                                                        sizeof(group_res_arr_mem_28417.mem),
                                                        &group_res_arr_mem_28417.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_28390,
                                                        13,
                                                        sizeof(mainzicounter_mem_28419.mem),
                                                        &mainzicounter_mem_28419.mem));
                if (1 * ((size_t) num_groups_25402 *
                         (size_t) seghist_group_sizze_25400) != 0) {
                    const size_t global_work_sizze_29013[1] =
                                 {(size_t) num_groups_25402 *
                                 (size_t) seghist_group_sizze_25400};
                    const size_t local_work_sizze_29017[1] =
                                 {seghist_group_sizze_25400};
                    int64_t time_start_29014 = 0, time_end_29015 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.segred_large_28390");
                        fprintf(stderr, "%zu", global_work_sizze_29013[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29017[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(bool) +
                                       (int32_t) sizeof(int64_t) *
                                       seghist_group_sizze_25400));
                        time_start_29014 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainzisegred_large_28390,
                                                                    1, NULL,
                                                                    global_work_sizze_29013,
                                                                    local_work_sizze_29017,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainzisegred_large_28390_runs,
                                                                                                              &ctx->mainzisegred_large_28390_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29015 = get_wall_time();
                        
                        long time_diff_29016 = time_end_29015 -
                             time_start_29014;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.segred_large_28390", time_diff_29016);
                    }
                }
                if (memblock_unref_device(ctx, &group_res_arr_mem_28417,
                                          "group_res_arr_mem_28417") != 0)
                    return 1;
            }
        }
    }
    if (memblock_unref_device(ctx, &mem_27800, "mem_27800") != 0)
        return 1;
    
    int64_t segscan_group_sizze_25415;
    
    segscan_group_sizze_25415 = ctx->sizes.mainzisegscan_group_sizze_25414;
    
    int64_t num_groups_25417;
    int32_t max_num_groups_28451;
    
    max_num_groups_28451 = ctx->sizes.mainzisegscan_num_groups_25416;
    num_groups_25417 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_23531,
                                                               sext_i32_i64(segscan_group_sizze_25415)),
                                                     sext_i32_i64(max_num_groups_28451))));
    
    struct memblock_device mem_27811;
    
    mem_27811.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27811, res_23531, "mem_27811")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27813;
    
    mem_27813.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27813, bytes_27806, "mem_27813")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_23531)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28452;
        
        stage1_max_num_groups_28452 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28453;
        
        stage1_num_groups_28453 = smin64(stage1_max_num_groups_28452,
                                         num_groups_25417);
        
        int32_t num_threads_28454;
        
        num_threads_28454 = sext_i64_i32(stage1_num_groups_28453 *
            segscan_group_sizze_25415);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25420, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_25415),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25420, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       segscan_group_sizze_25415),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25420, 3,
                                                sizeof(res_23531), &res_23531));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25420, 4,
                                                sizeof(mem_27807.mem),
                                                &mem_27807.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25420, 5,
                                                sizeof(mem_27811.mem),
                                                &mem_27811.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25420, 6,
                                                sizeof(mem_27813.mem),
                                                &mem_27813.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25420, 7,
                                                sizeof(num_threads_28454),
                                                &num_threads_28454));
        if (1 * ((size_t) stage1_num_groups_28453 *
                 (size_t) segscan_group_sizze_25415) != 0) {
            const size_t global_work_sizze_29018[1] =
                         {(size_t) stage1_num_groups_28453 *
                         (size_t) segscan_group_sizze_25415};
            const size_t local_work_sizze_29022[1] =
                         {segscan_group_sizze_25415};
            int64_t time_start_29019 = 0, time_end_29020 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage1_25420");
                fprintf(stderr, "%zu", global_work_sizze_29018[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29022[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_25415) + smax64(1,
                                                                              (int32_t) sizeof(bool) *
                                                                              segscan_group_sizze_25415)));
                time_start_29019 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage1_25420,
                                                            1, NULL,
                                                            global_work_sizze_29018,
                                                            local_work_sizze_29022,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage1_25420_runs,
                                                                                                      &ctx->mainziscan_stage1_25420_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29020 = get_wall_time();
                
                long time_diff_29021 = time_end_29020 - time_start_29019;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage1_25420", time_diff_29021);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_25415 *
                                 sdiv_up64(res_23531,
                                           sext_i32_i64(num_threads_28454))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25420, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_28453),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25420, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       stage1_num_groups_28453),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25420, 3,
                                                sizeof(res_23531), &res_23531));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25420, 4,
                                                sizeof(mem_27811.mem),
                                                &mem_27811.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25420, 5,
                                                sizeof(mem_27813.mem),
                                                &mem_27813.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25420, 6,
                                                sizeof(stage1_num_groups_28453),
                                                &stage1_num_groups_28453));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25420, 7,
                                                sizeof(num_threads_28454),
                                                &num_threads_28454));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28453) != 0) {
            const size_t global_work_sizze_29023[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28453};
            const size_t local_work_sizze_29027[1] = {stage1_num_groups_28453};
            int64_t time_start_29024 = 0, time_end_29025 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage2_25420");
                fprintf(stderr, "%zu", global_work_sizze_29023[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29027[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_28453) + smax64(1,
                                                                            (int32_t) sizeof(bool) *
                                                                            stage1_num_groups_28453)));
                time_start_29024 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage2_25420,
                                                            1, NULL,
                                                            global_work_sizze_29023,
                                                            local_work_sizze_29027,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage2_25420_runs,
                                                                                                      &ctx->mainziscan_stage2_25420_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29025 = get_wall_time();
                
                long time_diff_29026 = time_end_29025 - time_start_29024;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage2_25420", time_diff_29026);
            }
        }
        
        int32_t required_groups_28506;
        
        required_groups_28506 = sext_i64_i32(sdiv_up64(res_23531,
                                                       segscan_group_sizze_25415));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25420, 1,
                                                sizeof(res_23531), &res_23531));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25420, 2,
                                                sizeof(num_groups_25417),
                                                &num_groups_25417));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25420, 3,
                                                sizeof(mem_27811.mem),
                                                &mem_27811.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25420, 4,
                                                sizeof(mem_27813.mem),
                                                &mem_27813.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25420, 5,
                                                sizeof(num_threads_28454),
                                                &num_threads_28454));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25420, 6,
                                                sizeof(required_groups_28506),
                                                &required_groups_28506));
        if (1 * ((size_t) num_groups_25417 *
                 (size_t) segscan_group_sizze_25415) != 0) {
            const size_t global_work_sizze_29028[1] =
                         {(size_t) num_groups_25417 *
                         (size_t) segscan_group_sizze_25415};
            const size_t local_work_sizze_29032[1] =
                         {segscan_group_sizze_25415};
            int64_t time_start_29029 = 0, time_end_29030 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage3_25420");
                fprintf(stderr, "%zu", global_work_sizze_29028[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29032[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29029 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage3_25420,
                                                            1, NULL,
                                                            global_work_sizze_29028,
                                                            local_work_sizze_29032,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage3_25420_runs,
                                                                                                      &ctx->mainziscan_stage3_25420_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29030 = get_wall_time();
                
                long time_diff_29031 = time_end_29030 - time_start_29029;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage3_25420", time_diff_29031);
            }
        }
    }
    if (memblock_unref_device(ctx, &mem_27807, "mem_27807") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27811, "mem_27811") != 0)
        return 1;
    
    int64_t segscan_group_sizze_25423;
    
    segscan_group_sizze_25423 = ctx->sizes.mainzisegscan_group_sizze_25422;
    
    int64_t num_groups_25425;
    int32_t max_num_groups_28518;
    
    max_num_groups_28518 = ctx->sizes.mainzisegscan_num_groups_25424;
    num_groups_25425 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_23531,
                                                               sext_i32_i64(segscan_group_sizze_25423)),
                                                     sext_i32_i64(max_num_groups_28518))));
    
    struct memblock_device mem_27816;
    
    mem_27816.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27816, res_23531, "mem_27816")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27818;
    
    mem_27818.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27818, bytes_27806, "mem_27818")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27820;
    
    mem_27820.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27820, res_23531, "mem_27820")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_23531)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28519;
        
        stage1_max_num_groups_28519 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28520;
        
        stage1_num_groups_28520 = smin64(stage1_max_num_groups_28519,
                                         num_groups_25425);
        
        int32_t num_threads_28521;
        
        num_threads_28521 = sext_i64_i32(stage1_num_groups_28520 *
            segscan_group_sizze_25423);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25428, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_25423),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25428, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       segscan_group_sizze_25423),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25428, 3,
                                                sizeof(res_23531), &res_23531));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25428, 4,
                                                sizeof(mem_27813.mem),
                                                &mem_27813.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25428, 5,
                                                sizeof(mem_27816.mem),
                                                &mem_27816.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25428, 6,
                                                sizeof(mem_27818.mem),
                                                &mem_27818.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25428, 7,
                                                sizeof(mem_27820.mem),
                                                &mem_27820.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25428, 8,
                                                sizeof(num_threads_28521),
                                                &num_threads_28521));
        if (1 * ((size_t) stage1_num_groups_28520 *
                 (size_t) segscan_group_sizze_25423) != 0) {
            const size_t global_work_sizze_29033[1] =
                         {(size_t) stage1_num_groups_28520 *
                         (size_t) segscan_group_sizze_25423};
            const size_t local_work_sizze_29037[1] =
                         {segscan_group_sizze_25423};
            int64_t time_start_29034 = 0, time_end_29035 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage1_25428");
                fprintf(stderr, "%zu", global_work_sizze_29033[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29037[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_25423) + smax64(1,
                                                                              (int32_t) sizeof(bool) *
                                                                              segscan_group_sizze_25423)));
                time_start_29034 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage1_25428,
                                                            1, NULL,
                                                            global_work_sizze_29033,
                                                            local_work_sizze_29037,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage1_25428_runs,
                                                                                                      &ctx->mainziscan_stage1_25428_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29035 = get_wall_time();
                
                long time_diff_29036 = time_end_29035 - time_start_29034;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage1_25428", time_diff_29036);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_25423 *
                                 sdiv_up64(res_23531,
                                           sext_i32_i64(num_threads_28521))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25428, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_28520),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25428, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       stage1_num_groups_28520),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25428, 3,
                                                sizeof(res_23531), &res_23531));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25428, 4,
                                                sizeof(mem_27816.mem),
                                                &mem_27816.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25428, 5,
                                                sizeof(mem_27818.mem),
                                                &mem_27818.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25428, 6,
                                                sizeof(stage1_num_groups_28520),
                                                &stage1_num_groups_28520));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25428, 7,
                                                sizeof(num_threads_28521),
                                                &num_threads_28521));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28520) != 0) {
            const size_t global_work_sizze_29038[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28520};
            const size_t local_work_sizze_29042[1] = {stage1_num_groups_28520};
            int64_t time_start_29039 = 0, time_end_29040 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage2_25428");
                fprintf(stderr, "%zu", global_work_sizze_29038[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29042[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_28520) + smax64(1,
                                                                            (int32_t) sizeof(bool) *
                                                                            stage1_num_groups_28520)));
                time_start_29039 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage2_25428,
                                                            1, NULL,
                                                            global_work_sizze_29038,
                                                            local_work_sizze_29042,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage2_25428_runs,
                                                                                                      &ctx->mainziscan_stage2_25428_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29040 = get_wall_time();
                
                long time_diff_29041 = time_end_29040 - time_start_29039;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage2_25428", time_diff_29041);
            }
        }
        
        int32_t required_groups_28573;
        
        required_groups_28573 = sext_i64_i32(sdiv_up64(res_23531,
                                                       segscan_group_sizze_25423));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25428, 1,
                                                sizeof(res_23531), &res_23531));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25428, 2,
                                                sizeof(num_groups_25425),
                                                &num_groups_25425));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25428, 3,
                                                sizeof(mem_27816.mem),
                                                &mem_27816.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25428, 4,
                                                sizeof(mem_27818.mem),
                                                &mem_27818.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25428, 5,
                                                sizeof(num_threads_28521),
                                                &num_threads_28521));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25428, 6,
                                                sizeof(required_groups_28573),
                                                &required_groups_28573));
        if (1 * ((size_t) num_groups_25425 *
                 (size_t) segscan_group_sizze_25423) != 0) {
            const size_t global_work_sizze_29043[1] =
                         {(size_t) num_groups_25425 *
                         (size_t) segscan_group_sizze_25423};
            const size_t local_work_sizze_29047[1] =
                         {segscan_group_sizze_25423};
            int64_t time_start_29044 = 0, time_end_29045 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage3_25428");
                fprintf(stderr, "%zu", global_work_sizze_29043[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29047[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29044 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage3_25428,
                                                            1, NULL,
                                                            global_work_sizze_29043,
                                                            local_work_sizze_29047,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage3_25428_runs,
                                                                                                      &ctx->mainziscan_stage3_25428_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29045 = get_wall_time();
                
                long time_diff_29046 = time_end_29045 - time_start_29044;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage3_25428", time_diff_29046);
            }
        }
    }
    if (memblock_unref_device(ctx, &mem_27816, "mem_27816") != 0)
        return 1;
    
    int64_t segscan_group_sizze_25431;
    
    segscan_group_sizze_25431 = ctx->sizes.mainzisegscan_group_sizze_25430;
    
    int64_t num_groups_25433;
    int32_t max_num_groups_28585;
    
    max_num_groups_28585 = ctx->sizes.mainzisegscan_num_groups_25432;
    num_groups_25433 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_23531,
                                                               sext_i32_i64(segscan_group_sizze_25431)),
                                                     sext_i32_i64(max_num_groups_28585))));
    
    struct memblock_device mem_27823;
    
    mem_27823.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27823, res_23531, "mem_27823")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_27824 = 4 * res_23531;
    struct memblock_device mem_27825;
    
    mem_27825.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27825, bytes_27824, "mem_27825")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_23531)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28586;
        
        stage1_max_num_groups_28586 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28587;
        
        stage1_num_groups_28587 = smin64(stage1_max_num_groups_28586,
                                         num_groups_25433);
        
        int32_t num_threads_28588;
        
        num_threads_28588 = sext_i64_i32(stage1_num_groups_28587 *
            segscan_group_sizze_25431);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436, 3,
                                                smax64(1,
                                                       (int32_t) sizeof(float) *
                                                       segscan_group_sizze_25431),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436, 4,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       segscan_group_sizze_25431),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436, 5,
                                                sizeof(n_23312), &n_23312));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436, 6,
                                                sizeof(steps_23316),
                                                &steps_23316));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436, 7,
                                                sizeof(a_23320), &a_23320));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436, 8,
                                                sizeof(b_23321), &b_23321));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436, 9,
                                                sizeof(sigma_23322),
                                                &sigma_23322));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436,
                                                10, sizeof(res_23531),
                                                &res_23531));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436,
                                                11,
                                                sizeof(one_intra_par_min_24696),
                                                &one_intra_par_min_24696));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436,
                                                12, sizeof(res_mem_27720.mem),
                                                &res_mem_27720.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436,
                                                13, sizeof(res_mem_27721.mem),
                                                &res_mem_27721.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436,
                                                14, sizeof(res_mem_27722.mem),
                                                &res_mem_27722.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436,
                                                15, sizeof(res_mem_27723.mem),
                                                &res_mem_27723.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436,
                                                16, sizeof(binop_x_27752),
                                                &binop_x_27752));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436,
                                                17, sizeof(res_mem_27796.mem),
                                                &res_mem_27796.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436,
                                                18, sizeof(res_mem_27797.mem),
                                                &res_mem_27797.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436,
                                                19, sizeof(mem_27813.mem),
                                                &mem_27813.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436,
                                                20, sizeof(mem_27818.mem),
                                                &mem_27818.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436,
                                                21, sizeof(mem_27820.mem),
                                                &mem_27820.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436,
                                                22, sizeof(mem_27823.mem),
                                                &mem_27823.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436,
                                                23, sizeof(mem_27825.mem),
                                                &mem_27825.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25436,
                                                24, sizeof(num_threads_28588),
                                                &num_threads_28588));
        if (1 * ((size_t) stage1_num_groups_28587 *
                 (size_t) segscan_group_sizze_25431) != 0) {
            const size_t global_work_sizze_29048[1] =
                         {(size_t) stage1_num_groups_28587 *
                         (size_t) segscan_group_sizze_25431};
            const size_t local_work_sizze_29052[1] =
                         {segscan_group_sizze_25431};
            int64_t time_start_29049 = 0, time_end_29050 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage1_25436");
                fprintf(stderr, "%zu", global_work_sizze_29048[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29052[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                          segscan_group_sizze_25431) + smax64(1,
                                                                              (int32_t) sizeof(bool) *
                                                                              segscan_group_sizze_25431)));
                time_start_29049 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage1_25436,
                                                            1, NULL,
                                                            global_work_sizze_29048,
                                                            local_work_sizze_29052,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage1_25436_runs,
                                                                                                      &ctx->mainziscan_stage1_25436_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29050 = get_wall_time();
                
                long time_diff_29051 = time_end_29050 - time_start_29049;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage1_25436", time_diff_29051);
            }
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_25431 *
                                 sdiv_up64(res_23531,
                                           sext_i32_i64(num_threads_28588))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25436, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(float) *
                                                       stage1_num_groups_28587),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25436, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       stage1_num_groups_28587),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25436, 3,
                                                sizeof(res_23531), &res_23531));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25436, 4,
                                                sizeof(mem_27823.mem),
                                                &mem_27823.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25436, 5,
                                                sizeof(mem_27825.mem),
                                                &mem_27825.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25436, 6,
                                                sizeof(stage1_num_groups_28587),
                                                &stage1_num_groups_28587));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25436, 7,
                                                sizeof(num_threads_28588),
                                                &num_threads_28588));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28587) != 0) {
            const size_t global_work_sizze_29053[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28587};
            const size_t local_work_sizze_29057[1] = {stage1_num_groups_28587};
            int64_t time_start_29054 = 0, time_end_29055 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage2_25436");
                fprintf(stderr, "%zu", global_work_sizze_29053[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29057[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                          stage1_num_groups_28587) + smax64(1,
                                                                            (int32_t) sizeof(bool) *
                                                                            stage1_num_groups_28587)));
                time_start_29054 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage2_25436,
                                                            1, NULL,
                                                            global_work_sizze_29053,
                                                            local_work_sizze_29057,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage2_25436_runs,
                                                                                                      &ctx->mainziscan_stage2_25436_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29055 = get_wall_time();
                
                long time_diff_29056 = time_end_29055 - time_start_29054;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage2_25436", time_diff_29056);
            }
        }
        
        int32_t required_groups_28640;
        
        required_groups_28640 = sext_i64_i32(sdiv_up64(res_23531,
                                                       segscan_group_sizze_25431));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25436, 1,
                                                sizeof(res_23531), &res_23531));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25436, 2,
                                                sizeof(num_groups_25433),
                                                &num_groups_25433));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25436, 3,
                                                sizeof(mem_27823.mem),
                                                &mem_27823.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25436, 4,
                                                sizeof(mem_27825.mem),
                                                &mem_27825.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25436, 5,
                                                sizeof(num_threads_28588),
                                                &num_threads_28588));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25436, 6,
                                                sizeof(required_groups_28640),
                                                &required_groups_28640));
        if (1 * ((size_t) num_groups_25433 *
                 (size_t) segscan_group_sizze_25431) != 0) {
            const size_t global_work_sizze_29058[1] =
                         {(size_t) num_groups_25433 *
                         (size_t) segscan_group_sizze_25431};
            const size_t local_work_sizze_29062[1] =
                         {segscan_group_sizze_25431};
            int64_t time_start_29059 = 0, time_end_29060 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage3_25436");
                fprintf(stderr, "%zu", global_work_sizze_29058[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29062[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29059 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage3_25436,
                                                            1, NULL,
                                                            global_work_sizze_29058,
                                                            local_work_sizze_29062,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage3_25436_runs,
                                                                                                      &ctx->mainziscan_stage3_25436_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29060 = get_wall_time();
                
                long time_diff_29061 = time_end_29060 - time_start_29059;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage3_25436", time_diff_29061);
            }
        }
    }
    if (memblock_unref_device(ctx, &res_mem_27720, "res_mem_27720") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27721, "res_mem_27721") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27722, "res_mem_27722") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27796, "res_mem_27796") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27797, "res_mem_27797") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27813, "mem_27813") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27818, "mem_27818") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27823, "mem_27823") != 0)
        return 1;
    
    int64_t segscan_group_sizze_25483;
    
    segscan_group_sizze_25483 = ctx->sizes.mainzisegscan_group_sizze_25482;
    
    int64_t num_groups_25485;
    int32_t max_num_groups_28652;
    
    max_num_groups_28652 = ctx->sizes.mainzisegscan_num_groups_25484;
    num_groups_25485 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_23531,
                                                               sext_i32_i64(segscan_group_sizze_25483)),
                                                     sext_i32_i64(max_num_groups_28652))));
    
    struct memblock_device mem_27828;
    
    mem_27828.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27828, bytes_27806, "mem_27828")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_23531)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28653;
        
        stage1_max_num_groups_28653 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28654;
        
        stage1_num_groups_28654 = smin64(stage1_max_num_groups_28653,
                                         num_groups_25485);
        
        int32_t num_threads_28655;
        
        num_threads_28655 = sext_i64_i32(stage1_num_groups_28654 *
            segscan_group_sizze_25483);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25488, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_25483),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25488, 2,
                                                sizeof(res_23531), &res_23531));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25488, 3,
                                                sizeof(mem_27820.mem),
                                                &mem_27820.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25488, 4,
                                                sizeof(mem_27828.mem),
                                                &mem_27828.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_25488, 5,
                                                sizeof(num_threads_28655),
                                                &num_threads_28655));
        if (1 * ((size_t) stage1_num_groups_28654 *
                 (size_t) segscan_group_sizze_25483) != 0) {
            const size_t global_work_sizze_29063[1] =
                         {(size_t) stage1_num_groups_28654 *
                         (size_t) segscan_group_sizze_25483};
            const size_t local_work_sizze_29067[1] =
                         {segscan_group_sizze_25483};
            int64_t time_start_29064 = 0, time_end_29065 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage1_25488");
                fprintf(stderr, "%zu", global_work_sizze_29063[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29067[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_25483)));
                time_start_29064 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage1_25488,
                                                            1, NULL,
                                                            global_work_sizze_29063,
                                                            local_work_sizze_29067,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage1_25488_runs,
                                                                                                      &ctx->mainziscan_stage1_25488_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29065 = get_wall_time();
                
                long time_diff_29066 = time_end_29065 - time_start_29064;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage1_25488", time_diff_29066);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_25483 *
                                 sdiv_up64(res_23531,
                                           sext_i32_i64(num_threads_28655))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25488, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_28654),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25488, 2,
                                                sizeof(res_23531), &res_23531));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25488, 3,
                                                sizeof(mem_27828.mem),
                                                &mem_27828.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25488, 4,
                                                sizeof(stage1_num_groups_28654),
                                                &stage1_num_groups_28654));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_25488, 5,
                                                sizeof(num_threads_28655),
                                                &num_threads_28655));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28654) != 0) {
            const size_t global_work_sizze_29068[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28654};
            const size_t local_work_sizze_29072[1] = {stage1_num_groups_28654};
            int64_t time_start_29069 = 0, time_end_29070 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage2_25488");
                fprintf(stderr, "%zu", global_work_sizze_29068[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29072[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_28654)));
                time_start_29069 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage2_25488,
                                                            1, NULL,
                                                            global_work_sizze_29068,
                                                            local_work_sizze_29072,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage2_25488_runs,
                                                                                                      &ctx->mainziscan_stage2_25488_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29070 = get_wall_time();
                
                long time_diff_29071 = time_end_29070 - time_start_29069;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage2_25488", time_diff_29071);
            }
        }
        
        int32_t required_groups_28691;
        
        required_groups_28691 = sext_i64_i32(sdiv_up64(res_23531,
                                                       segscan_group_sizze_25483));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25488, 1,
                                                sizeof(res_23531), &res_23531));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25488, 2,
                                                sizeof(num_groups_25485),
                                                &num_groups_25485));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25488, 3,
                                                sizeof(mem_27828.mem),
                                                &mem_27828.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25488, 4,
                                                sizeof(num_threads_28655),
                                                &num_threads_28655));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_25488, 5,
                                                sizeof(required_groups_28691),
                                                &required_groups_28691));
        if (1 * ((size_t) num_groups_25485 *
                 (size_t) segscan_group_sizze_25483) != 0) {
            const size_t global_work_sizze_29073[1] =
                         {(size_t) num_groups_25485 *
                         (size_t) segscan_group_sizze_25483};
            const size_t local_work_sizze_29077[1] =
                         {segscan_group_sizze_25483};
            int64_t time_start_29074 = 0, time_end_29075 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.scan_stage3_25488");
                fprintf(stderr, "%zu", global_work_sizze_29073[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29077[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29074 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainziscan_stage3_25488,
                                                            1, NULL,
                                                            global_work_sizze_29073,
                                                            local_work_sizze_29077,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainziscan_stage3_25488_runs,
                                                                                                      &ctx->mainziscan_stage3_25488_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29075 = get_wall_time();
                
                long time_diff_29076 = time_end_29075 - time_start_29074;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.scan_stage3_25488", time_diff_29076);
            }
        }
    }
    
    bool cond_23728 = slt64(0, res_23531);
    int64_t num_segments_23729;
    
    if (cond_23728) {
        int64_t i_23730 = sub64(res_23531, 1);
        bool x_23731 = sle64(0, i_23730);
        bool y_23732 = slt64(i_23730, res_23531);
        bool bounds_check_23733 = x_23731 && y_23732;
        bool index_certs_23734;
        
        if (!bounds_check_23733) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_23730,
                                   "] out of bounds for array of shape [",
                                   res_23531, "].",
                                   "-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:29:36-59\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #4  cva2.fut:134:18-77\n   #5  cva2.fut:100:1-154:20\n");
            if (memblock_unref_device(ctx, &mem_27828, "mem_27828") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27825, "mem_27825") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27823, "mem_27823") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27820, "mem_27820") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27818, "mem_27818") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27816, "mem_27816") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27813, "mem_27813") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27811, "mem_27811") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_subhistos_mem_28305,
                                      "res_subhistos_mem_28305") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27807, "mem_27807") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28266,
                                      "group_res_arr_mem_28266") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27805, "mem_27805") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27802, "mem_27802") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27800, "mem_27800") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27797, "res_mem_27797") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27796, "res_mem_27796") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27722, "res_mem_27722") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27721, "res_mem_27721") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27720, "res_mem_27720") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28064,
                                      "group_res_arr_mem_28064") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_28059, "out_mem_28059") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_29078;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27828.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     i_23730 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_29078, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t res_23735 = read_res_29078;
        
        num_segments_23729 = res_23735;
    } else {
        num_segments_23729 = 0;
    }
    
    bool bounds_invalid_upwards_23736 = slt64(num_segments_23729, 0);
    bool valid_23737 = !bounds_invalid_upwards_23736;
    bool range_valid_c_23738;
    
    if (!valid_23737) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", num_segments_23729,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:33:17-41\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva2.fut:134:18-77\n   #6  cva2.fut:100:1-154:20\n");
        if (memblock_unref_device(ctx, &mem_27828, "mem_27828") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27825, "mem_27825") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27823, "mem_27823") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27820, "mem_27820") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27818, "mem_27818") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27816, "mem_27816") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27813, "mem_27813") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27811, "mem_27811") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_subhistos_mem_28305,
                                  "res_subhistos_mem_28305") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27807, "mem_27807") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28266,
                                  "group_res_arr_mem_28266") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27805, "mem_27805") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27802, "mem_27802") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27800, "mem_27800") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27797, "res_mem_27797") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27796, "res_mem_27796") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27722, "res_mem_27722") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27721, "res_mem_27721") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27720, "res_mem_27720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28064,
                                  "group_res_arr_mem_28064") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_28059, "out_mem_28059") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_27829 = 4 * num_segments_23729;
    struct memblock_device mem_27830;
    
    mem_27830.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27830, bytes_27829, "mem_27830")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f32(ctx, mem_27830, num_segments_23729,
                                      0.0F) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_25493;
    
    segmap_group_sizze_25493 = ctx->sizes.mainzisegmap_group_sizze_25492;
    
    int64_t segmap_usable_groups_25494 = sdiv_up64(res_23531,
                                                   segmap_group_sizze_25493);
    
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25490, 1,
                                            sizeof(res_23531), &res_23531));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25490, 2,
                                            sizeof(num_segments_23729),
                                            &num_segments_23729));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25490, 3,
                                            sizeof(mem_27820.mem),
                                            &mem_27820.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25490, 4,
                                            sizeof(mem_27825.mem),
                                            &mem_27825.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25490, 5,
                                            sizeof(mem_27828.mem),
                                            &mem_27828.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25490, 6,
                                            sizeof(mem_27830.mem),
                                            &mem_27830.mem));
    if (1 * ((size_t) segmap_usable_groups_25494 *
             (size_t) segmap_group_sizze_25493) != 0) {
        const size_t global_work_sizze_29079[1] =
                     {(size_t) segmap_usable_groups_25494 *
                     (size_t) segmap_group_sizze_25493};
        const size_t local_work_sizze_29083[1] = {segmap_group_sizze_25493};
        int64_t time_start_29080 = 0, time_end_29081 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segmap_25490");
            fprintf(stderr, "%zu", global_work_sizze_29079[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_29083[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_29080 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegmap_25490,
                                                        1, NULL,
                                                        global_work_sizze_29079,
                                                        local_work_sizze_29083,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegmap_25490_runs,
                                                                                                  &ctx->mainzisegmap_25490_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_29081 = get_wall_time();
            
            long time_diff_29082 = time_end_29081 - time_start_29080;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "main.segmap_25490",
                    time_diff_29082);
        }
    }
    if (memblock_unref_device(ctx, &mem_27820, "mem_27820") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27825, "mem_27825") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27828, "mem_27828") != 0)
        return 1;
    
    bool dim_match_23746 = binop_x_27752 == num_segments_23729;
    bool empty_or_match_cert_23747;
    
    if (!dim_match_23746) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Value of (core language) shape (",
                               num_segments_23729,
                               ") cannot match shape of type `[", binop_x_27752,
                               "]b`.",
                               "-> #0  lib/github.com/diku-dk/segmented/segmented.fut:103:6-45\n   #1  cva2.fut:134:18-77\n   #2  cva2.fut:100:1-154:20\n");
        if (memblock_unref_device(ctx, &mem_27830, "mem_27830") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27828, "mem_27828") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27825, "mem_27825") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27823, "mem_27823") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27820, "mem_27820") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27818, "mem_27818") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27816, "mem_27816") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27813, "mem_27813") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27811, "mem_27811") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_subhistos_mem_28305,
                                  "res_subhistos_mem_28305") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27807, "mem_27807") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28266,
                                  "group_res_arr_mem_28266") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27805, "mem_27805") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27802, "mem_27802") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27800, "mem_27800") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27797, "res_mem_27797") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27796, "res_mem_27796") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27722, "res_mem_27722") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27721, "res_mem_27721") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27720, "res_mem_27720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28064,
                                  "group_res_arr_mem_28064") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_28059, "out_mem_28059") != 0)
            return 1;
        return 1;
    }
    
    float res_23750 = sitofp_i64_f32(paths_23315);
    bool suff_outer_redomap_25496;
    
    suff_outer_redomap_25496 = ctx->sizes.mainzisuff_outer_redomap_10 <=
        steps_23316;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_outer_redomap_10",
                steps_23316);
    
    int64_t segred_group_sizze_25509;
    
    segred_group_sizze_25509 = ctx->sizes.mainzisegred_group_sizze_25498;
    
    int64_t num_groups_25510;
    int32_t max_num_groups_28717;
    
    max_num_groups_28717 = ctx->sizes.mainzisegred_num_groups_25500;
    num_groups_25510 = sext_i64_i32(smax64(1, smin64(sdiv_up64(steps_23316,
                                                               sext_i32_i64(segred_group_sizze_25509)),
                                                     sext_i32_i64(max_num_groups_28717))));
    
    bool suff_outer_par_25782;
    
    suff_outer_par_25782 = ctx->sizes.mainzisuff_outer_par_11 <= steps_23316;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_outer_par_11",
                steps_23316);
    
    bool fits_25786 = sle64(paths_23315, max_group_sizze_24848);
    bool suff_intra_par_25788;
    
    suff_intra_par_25788 = ctx->sizes.mainzisuff_intra_par_12 <= paths_23315;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_intra_par_12",
                paths_23315);
    
    bool intra_suff_and_fits_25789 = fits_25786 && suff_intra_par_25788;
    int64_t segmap_group_sizze_25793;
    
    segmap_group_sizze_25793 = ctx->sizes.mainzisegmap_group_sizze_25564;
    
    int64_t segred_group_sizze_25867;
    
    segred_group_sizze_25867 = ctx->sizes.mainzisegred_group_sizze_25706;
    
    int64_t num_groups_25868;
    int32_t max_num_groups_28718;
    
    max_num_groups_28718 = ctx->sizes.mainzisegred_num_groups_25708;
    num_groups_25868 = sext_i64_i32(smax64(1, smin64(sdiv_up64(nest_sizze_25260,
                                                               sext_i32_i64(segred_group_sizze_25867)),
                                                     sext_i32_i64(max_num_groups_28718))));
    
    int64_t segmap_group_sizze_25883;
    
    segmap_group_sizze_25883 = ctx->sizes.mainzisegmap_group_sizze_25679;
    
    int64_t segred_group_sizze_25911;
    
    segred_group_sizze_25911 = ctx->sizes.mainzisegred_group_sizze_25772;
    
    int64_t num_groups_25912;
    int32_t max_num_groups_28719;
    
    max_num_groups_28719 = ctx->sizes.mainzisegred_num_groups_25774;
    num_groups_25912 = sext_i64_i32(smax64(1, smin64(sdiv_up64(steps_23316,
                                                               sext_i32_i64(segred_group_sizze_25911)),
                                                     sext_i32_i64(max_num_groups_28719))));
    
    int64_t binop_x_27837 = n_23312 * paths_23315;
    int64_t binop_x_27838 = steps_23316 * binop_x_27837;
    int64_t bytes_27836 = 4 * binop_x_27838;
    struct memblock_device res_mem_27886;
    
    res_mem_27886.references = NULL;
    
    float res_23767;
    int32_t local_memory_capacity_28879;
    
    local_memory_capacity_28879 = ctx->opencl.max_local_memory;
    if ((sle64(0, sext_i32_i64(local_memory_capacity_28879)) &&
         sle64((int32_t) sizeof(bool) + (int32_t) sizeof(float) *
               segred_group_sizze_25509,
               sext_i32_i64(local_memory_capacity_28879))) &&
        suff_outer_redomap_25496) {
        struct memblock_device mem_27835;
        
        mem_27835.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27835, bytes_27750, "mem_27835")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t group_sizze_28723;
        
        group_sizze_28723 = ctx->sizes.mainzigroup_sizze_28723;
        
        int64_t num_groups_28724;
        
        num_groups_28724 = sdiv_up64(steps_23316 * paths_23315 * n_23312,
                                     group_sizze_28723);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28720, 0,
                                                sizeof(n_23312), &n_23312));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28720, 1,
                                                sizeof(paths_23315),
                                                &paths_23315));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28720, 2,
                                                sizeof(steps_23316),
                                                &steps_23316));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28720, 3,
                                                sizeof(mem_27830.mem),
                                                &mem_27830.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28720, 4,
                                                sizeof(mem_27835.mem),
                                                &mem_27835.mem));
        if (1 * ((size_t) num_groups_28724 * (size_t) group_sizze_28723) != 0) {
            const size_t global_work_sizze_29084[1] =
                         {(size_t) num_groups_28724 *
                         (size_t) group_sizze_28723};
            const size_t local_work_sizze_29088[1] = {group_sizze_28723};
            int64_t time_start_29085 = 0, time_end_29086 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.copy_28720");
                fprintf(stderr, "%zu", global_work_sizze_29084[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29088[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29085 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzicopy_28720,
                                                            1, NULL,
                                                            global_work_sizze_29084,
                                                            local_work_sizze_29088,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzicopy_28720_runs,
                                                                                                      &ctx->mainzicopy_28720_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29086 = get_wall_time();
                
                long time_diff_29087 = time_end_29086 - time_start_29085;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n", "main.copy_28720",
                        time_diff_29087);
            }
        }
        
        struct memblock_device mem_27839;
        
        mem_27839.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27839, bytes_27836, "mem_27839")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27839, 0, mem_27835,
                                                  0, 1, paths_23315 * n_23312,
                                                  steps_23316) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_unref_device(ctx, &mem_27835, "mem_27835") != 0)
            return 1;
        
        struct memblock_device mem_27842;
        
        mem_27842.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27842, 4, "mem_27842")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27844;
        
        mem_27844.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27844, bytes_27726, "mem_27844")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mainzicounter_mem_28725 =
                               ctx->mainzicounter_mem_28725;
        struct memblock_device group_res_arr_mem_28727;
        
        group_res_arr_mem_28727.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28727,
                                  (int32_t) sizeof(float) *
                                  (segred_group_sizze_25509 * num_groups_25510),
                                  "group_res_arr_mem_28727")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28729;
        
        num_threads_28729 = num_groups_25510 * segred_group_sizze_25509;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                1, (int32_t) sizeof(float) *
                                                segred_group_sizze_25509,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                3, sizeof(n_23312), &n_23312));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                4, sizeof(paths_23315),
                                                &paths_23315));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                5, sizeof(steps_23316),
                                                &steps_23316));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                6, sizeof(a_23320), &a_23320));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                7, sizeof(x_23340), &x_23340));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                8, sizeof(x_23342), &x_23342));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                9, sizeof(y_23344), &y_23344));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                10, sizeof(y_23345), &y_23345));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                11, sizeof(sims_per_year_23422),
                                                &sims_per_year_23422));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                12, sizeof(res_23750),
                                                &res_23750));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                13, sizeof(num_groups_25510),
                                                &num_groups_25510));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                14, sizeof(mem_27839.mem),
                                                &mem_27839.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                15, sizeof(mem_27842.mem),
                                                &mem_27842.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                16, sizeof(mem_27844.mem),
                                                &mem_27844.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                17,
                                                sizeof(mainzicounter_mem_28725.mem),
                                                &mainzicounter_mem_28725.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                18,
                                                sizeof(group_res_arr_mem_28727.mem),
                                                &group_res_arr_mem_28727.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25507,
                                                19, sizeof(num_threads_28729),
                                                &num_threads_28729));
        if (1 * ((size_t) num_groups_25510 *
                 (size_t) segred_group_sizze_25509) != 0) {
            const size_t global_work_sizze_29090[1] =
                         {(size_t) num_groups_25510 *
                         (size_t) segred_group_sizze_25509};
            const size_t local_work_sizze_29094[1] = {segred_group_sizze_25509};
            int64_t time_start_29091 = 0, time_end_29092 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segred_nonseg_25507");
                fprintf(stderr, "%zu", global_work_sizze_29090[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29094[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(float) *
                               segred_group_sizze_25509 +
                               (int32_t) sizeof(bool)));
                time_start_29091 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegred_nonseg_25507,
                                                            1, NULL,
                                                            global_work_sizze_29090,
                                                            local_work_sizze_29094,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegred_nonseg_25507_runs,
                                                                                                      &ctx->mainzisegred_nonseg_25507_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29092 = get_wall_time();
                
                long time_diff_29093 = time_end_29092 - time_start_29091;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segred_nonseg_25507", time_diff_29093);
            }
        }
        if (memblock_unref_device(ctx, &mem_27839, "mem_27839") != 0)
            return 1;
        
        float read_res_29095;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27842.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(float),
                                                     sizeof(float),
                                                     &read_res_29095, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        float res_25549 = read_res_29095;
        
        if (memblock_unref_device(ctx, &mem_27842, "mem_27842") != 0)
            return 1;
        
        struct memblock_device mem_27884;
        
        mem_27884.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27884, bytes_27726, "mem_27884")) {
            err = 1;
            goto cleanup;
        }
        if (steps_23316 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27844.mem,
                                                         mem_27884.mem, 0, 0,
                                                         steps_23316 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        if (memblock_unref_device(ctx, &mem_27844, "mem_27844") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27886, &mem_27884, "mem_27884") !=
            0)
            return 1;
        res_23767 = res_25549;
        if (memblock_unref_device(ctx, &mem_27884, "mem_27884") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28727,
                                  "group_res_arr_mem_28727") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27844, "mem_27844") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27842, "mem_27842") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27839, "mem_27839") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27835, "mem_27835") != 0)
            return 1;
    } else {
        struct memblock_device res_map_acc_mem_27878;
        
        res_map_acc_mem_27878.references = NULL;
        
        struct memblock_device res_mem_27879;
        
        res_mem_27879.references = NULL;
        
        int32_t local_memory_capacity_28848;
        
        local_memory_capacity_28848 = ctx->opencl.max_local_memory;
        if ((sle64(0, sext_i32_i64(local_memory_capacity_28848)) && sle64(0,
                                                                          sext_i32_i64(local_memory_capacity_28848))) &&
            suff_outer_par_25782) {
            int64_t segmap_usable_groups_25794 = sdiv_up64(steps_23316,
                                                           segmap_group_sizze_25793);
            struct memblock_device mem_27848;
            
            mem_27848.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27848, bytes_27750,
                                      "mem_27848")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t group_sizze_28760;
            
            group_sizze_28760 = ctx->sizes.mainzigroup_sizze_28760;
            
            int64_t num_groups_28761;
            
            num_groups_28761 = sdiv_up64(steps_23316 * paths_23315 * n_23312,
                                         group_sizze_28760);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28757, 0,
                                                    sizeof(n_23312), &n_23312));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28757, 1,
                                                    sizeof(paths_23315),
                                                    &paths_23315));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28757, 2,
                                                    sizeof(steps_23316),
                                                    &steps_23316));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28757, 3,
                                                    sizeof(mem_27830.mem),
                                                    &mem_27830.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzicopy_28757, 4,
                                                    sizeof(mem_27848.mem),
                                                    &mem_27848.mem));
            if (1 * ((size_t) num_groups_28761 * (size_t) group_sizze_28760) !=
                0) {
                const size_t global_work_sizze_29096[1] =
                             {(size_t) num_groups_28761 *
                             (size_t) group_sizze_28760};
                const size_t local_work_sizze_29100[1] = {group_sizze_28760};
                int64_t time_start_29097 = 0, time_end_29098 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.copy_28757");
                    fprintf(stderr, "%zu", global_work_sizze_29096[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29100[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29097 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainzicopy_28757,
                                                                1, NULL,
                                                                global_work_sizze_29096,
                                                                local_work_sizze_29100,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainzicopy_28757_runs,
                                                                                                          &ctx->mainzicopy_28757_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29098 = get_wall_time();
                    
                    long time_diff_29099 = time_end_29098 - time_start_29097;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.copy_28757", time_diff_29099);
                }
            }
            
            struct memblock_device mem_27852;
            
            mem_27852.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27852, bytes_27836,
                                      "mem_27852")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27852, 0,
                                                      mem_27848, 0, 1,
                                                      paths_23315 * n_23312,
                                                      steps_23316) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref_device(ctx, &mem_27848, "mem_27848") != 0)
                return 1;
            
            struct memblock_device mem_27855;
            
            mem_27855.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27855, bytes_27726,
                                      "mem_27855")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_27857;
            
            mem_27857.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27857, bytes_27726,
                                      "mem_27857")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegMap");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25562, 1,
                                                    sizeof(n_23312), &n_23312));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25562, 2,
                                                    sizeof(paths_23315),
                                                    &paths_23315));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25562, 3,
                                                    sizeof(steps_23316),
                                                    &steps_23316));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25562, 4,
                                                    sizeof(a_23320), &a_23320));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25562, 5,
                                                    sizeof(x_23340), &x_23340));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25562, 6,
                                                    sizeof(x_23342), &x_23342));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25562, 7,
                                                    sizeof(y_23344), &y_23344));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25562, 8,
                                                    sizeof(y_23345), &y_23345));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25562, 9,
                                                    sizeof(sims_per_year_23422),
                                                    &sims_per_year_23422));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25562, 10,
                                                    sizeof(res_23750),
                                                    &res_23750));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25562, 11,
                                                    sizeof(mem_27852.mem),
                                                    &mem_27852.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25562, 12,
                                                    sizeof(mem_27855.mem),
                                                    &mem_27855.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25562, 13,
                                                    sizeof(mem_27857.mem),
                                                    &mem_27857.mem));
            if (1 * ((size_t) segmap_usable_groups_25794 *
                     (size_t) segmap_group_sizze_25793) != 0) {
                const size_t global_work_sizze_29101[1] =
                             {(size_t) segmap_usable_groups_25794 *
                             (size_t) segmap_group_sizze_25793};
                const size_t local_work_sizze_29105[1] =
                             {segmap_group_sizze_25793};
                int64_t time_start_29102 = 0, time_end_29103 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.segmap_25562");
                    fprintf(stderr, "%zu", global_work_sizze_29101[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29105[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29102 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainzisegmap_25562,
                                                                1, NULL,
                                                                global_work_sizze_29101,
                                                                local_work_sizze_29105,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainzisegmap_25562_runs,
                                                                                                          &ctx->mainzisegmap_25562_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29103 = get_wall_time();
                    
                    long time_diff_29104 = time_end_29103 - time_start_29102;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.segmap_25562", time_diff_29104);
                }
            }
            if (memblock_unref_device(ctx, &mem_27852, "mem_27852") != 0)
                return 1;
            if (memblock_set_device(ctx, &res_map_acc_mem_27878, &mem_27855,
                                    "mem_27855") != 0)
                return 1;
            if (memblock_set_device(ctx, &res_mem_27879, &mem_27857,
                                    "mem_27857") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27857, "mem_27857") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27855, "mem_27855") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27852, "mem_27852") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27848, "mem_27848") != 0)
                return 1;
        } else {
            struct memblock_device res_map_acc_mem_27876;
            
            res_map_acc_mem_27876.references = NULL;
            
            struct memblock_device res_mem_27877;
            
            res_mem_27877.references = NULL;
            
            int32_t local_memory_capacity_28847;
            
            local_memory_capacity_28847 = ctx->opencl.max_local_memory;
            if (sle64((int32_t) sizeof(float) * paths_23315,
                      sext_i32_i64(local_memory_capacity_28847)) &&
                intra_suff_and_fits_25789) {
                struct memblock_device mem_27861;
                
                mem_27861.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27861, bytes_27726,
                                          "mem_27861")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_27863;
                
                mem_27863.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27863, bytes_27726,
                                          "mem_27863")) {
                    err = 1;
                    goto cleanup;
                }
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25560,
                                                        1,
                                                        (int32_t) sizeof(float) *
                                                        paths_23315, NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25560,
                                                        2, sizeof(n_23312),
                                                        &n_23312));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25560,
                                                        3, sizeof(paths_23315),
                                                        &paths_23315));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25560,
                                                        4, sizeof(a_23320),
                                                        &a_23320));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25560,
                                                        5, sizeof(x_23340),
                                                        &x_23340));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25560,
                                                        6, sizeof(x_23342),
                                                        &x_23342));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25560,
                                                        7, sizeof(y_23344),
                                                        &y_23344));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25560,
                                                        8, sizeof(y_23345),
                                                        &y_23345));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25560,
                                                        9,
                                                        sizeof(sims_per_year_23422),
                                                        &sims_per_year_23422));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25560,
                                                        10, sizeof(res_23750),
                                                        &res_23750));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25560,
                                                        11,
                                                        sizeof(one_intra_par_min_24696),
                                                        &one_intra_par_min_24696));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25560,
                                                        12,
                                                        sizeof(mem_27830.mem),
                                                        &mem_27830.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25560,
                                                        13,
                                                        sizeof(mem_27861.mem),
                                                        &mem_27861.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_intragroup_25560,
                                                        14,
                                                        sizeof(mem_27863.mem),
                                                        &mem_27863.mem));
                if (1 * ((size_t) steps_23316 * (size_t) paths_23315) != 0) {
                    const size_t global_work_sizze_29106[1] =
                                 {(size_t) steps_23316 * (size_t) paths_23315};
                    const size_t local_work_sizze_29110[1] = {paths_23315};
                    int64_t time_start_29107 = 0, time_end_29108 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.segmap_intragroup_25560");
                        fprintf(stderr, "%zu", global_work_sizze_29106[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29110[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(float) *
                                       paths_23315));
                        time_start_29107 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainzisegmap_intragroup_25560,
                                                                    1, NULL,
                                                                    global_work_sizze_29106,
                                                                    local_work_sizze_29110,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainzisegmap_intragroup_25560_runs,
                                                                                                              &ctx->mainzisegmap_intragroup_25560_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29108 = get_wall_time();
                        
                        long time_diff_29109 = time_end_29108 -
                             time_start_29107;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.segmap_intragroup_25560",
                                time_diff_29109);
                    }
                }
                if (memblock_set_device(ctx, &res_map_acc_mem_27876, &mem_27861,
                                        "mem_27861") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_mem_27877, &mem_27863,
                                        "mem_27863") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27863, "mem_27863") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27861, "mem_27861") != 0)
                    return 1;
            } else {
                struct memblock_device mem_27867;
                
                mem_27867.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27867, bytes_27836,
                                          "mem_27867")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27867, 0,
                                                          mem_27830, 0, 1,
                                                          n_23312, paths_23315 *
                                                          steps_23316) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_27870;
                
                mem_27870.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27870, bytes_27726,
                                          "mem_27870")) {
                    err = 1;
                    goto cleanup;
                }
                if (slt64(paths_23315 * 2, segred_group_sizze_25867)) {
                    int64_t segment_sizze_nonzzero_28780 = smax64(1,
                                                                  paths_23315);
                    int64_t num_threads_28781 = num_groups_25868 *
                            segred_group_sizze_25867;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-small");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) steps_23316, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) paths_23315, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segments_per_group",
                                (long long) squot64(segred_group_sizze_25867,
                                                    segment_sizze_nonzzero_28780),
                                '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "required_groups",
                                (long long) sext_i64_i32(sdiv_up64(steps_23316,
                                                                   squot64(segred_group_sizze_25867,
                                                                           segment_sizze_nonzzero_28780))),
                                '\n');
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25712,
                                                            1,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_25867,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25712,
                                                            2, sizeof(n_23312),
                                                            &n_23312));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25712,
                                                            3,
                                                            sizeof(paths_23315),
                                                            &paths_23315));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25712,
                                                            4,
                                                            sizeof(steps_23316),
                                                            &steps_23316));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25712,
                                                            5,
                                                            sizeof(num_groups_25868),
                                                            &num_groups_25868));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25712,
                                                            6,
                                                            sizeof(mem_27867.mem),
                                                            &mem_27867.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25712,
                                                            7,
                                                            sizeof(mem_27870.mem),
                                                            &mem_27870.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_25712,
                                                            8,
                                                            sizeof(segment_sizze_nonzzero_28780),
                                                            &segment_sizze_nonzzero_28780));
                    if (1 * ((size_t) num_groups_25868 *
                             (size_t) segred_group_sizze_25867) != 0) {
                        const size_t global_work_sizze_29111[1] =
                                     {(size_t) num_groups_25868 *
                                     (size_t) segred_group_sizze_25867};
                        const size_t local_work_sizze_29115[1] =
                                     {segred_group_sizze_25867};
                        int64_t time_start_29112 = 0, time_end_29113 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.segred_small_25712");
                            fprintf(stderr, "%zu", global_work_sizze_29111[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29115[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(float) *
                                           segred_group_sizze_25867));
                            time_start_29112 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainzisegred_small_25712,
                                                                        1, NULL,
                                                                        global_work_sizze_29111,
                                                                        local_work_sizze_29115,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainzisegred_small_25712_runs,
                                                                                                                  &ctx->mainzisegred_small_25712_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29113 = get_wall_time();
                            
                            long time_diff_29114 = time_end_29113 -
                                 time_start_29112;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.segred_small_25712", time_diff_29114);
                        }
                    }
                } else {
                    int64_t groups_per_segment_28802 =
                            sdiv_up64(num_groups_25868, smax64(1, steps_23316));
                    int64_t elements_per_thread_28803 = sdiv_up64(paths_23315,
                                                                  segred_group_sizze_25867 *
                                                                  groups_per_segment_28802);
                    int64_t virt_num_groups_28804 = groups_per_segment_28802 *
                            steps_23316;
                    int64_t num_threads_28805 = num_groups_25868 *
                            segred_group_sizze_25867;
                    int64_t threads_per_segment_28806 =
                            groups_per_segment_28802 * segred_group_sizze_25867;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-large");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) steps_23316, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) paths_23315, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                                (long long) virt_num_groups_28804, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_groups",
                                (long long) num_groups_25868, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "group_size",
                                (long long) segred_group_sizze_25867, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                                (long long) elements_per_thread_28803, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                                (long long) groups_per_segment_28802, '\n');
                    
                    struct memblock_device group_res_arr_mem_28807;
                    
                    group_res_arr_mem_28807.references = NULL;
                    if (memblock_alloc_device(ctx, &group_res_arr_mem_28807,
                                              (int32_t) sizeof(float) *
                                              (segred_group_sizze_25867 *
                                               virt_num_groups_28804),
                                              "group_res_arr_mem_28807")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device mainzicounter_mem_28809 =
                                           ctx->mainzicounter_mem_28809;
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25712,
                                                            1,
                                                            (int32_t) sizeof(bool),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25712,
                                                            2,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_25867,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25712,
                                                            3, sizeof(n_23312),
                                                            &n_23312));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25712,
                                                            4,
                                                            sizeof(paths_23315),
                                                            &paths_23315));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25712,
                                                            5,
                                                            sizeof(steps_23316),
                                                            &steps_23316));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25712,
                                                            6,
                                                            sizeof(num_groups_25868),
                                                            &num_groups_25868));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25712,
                                                            7,
                                                            sizeof(mem_27867.mem),
                                                            &mem_27867.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25712,
                                                            8,
                                                            sizeof(mem_27870.mem),
                                                            &mem_27870.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25712,
                                                            9,
                                                            sizeof(groups_per_segment_28802),
                                                            &groups_per_segment_28802));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25712,
                                                            10,
                                                            sizeof(elements_per_thread_28803),
                                                            &elements_per_thread_28803));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25712,
                                                            11,
                                                            sizeof(virt_num_groups_28804),
                                                            &virt_num_groups_28804));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25712,
                                                            12,
                                                            sizeof(threads_per_segment_28806),
                                                            &threads_per_segment_28806));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25712,
                                                            13,
                                                            sizeof(group_res_arr_mem_28807.mem),
                                                            &group_res_arr_mem_28807.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_25712,
                                                            14,
                                                            sizeof(mainzicounter_mem_28809.mem),
                                                            &mainzicounter_mem_28809.mem));
                    if (1 * ((size_t) num_groups_25868 *
                             (size_t) segred_group_sizze_25867) != 0) {
                        const size_t global_work_sizze_29117[1] =
                                     {(size_t) num_groups_25868 *
                                     (size_t) segred_group_sizze_25867};
                        const size_t local_work_sizze_29121[1] =
                                     {segred_group_sizze_25867};
                        int64_t time_start_29118 = 0, time_end_29119 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.segred_large_25712");
                            fprintf(stderr, "%zu", global_work_sizze_29117[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29121[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(bool) +
                                           (int32_t) sizeof(float) *
                                           segred_group_sizze_25867));
                            time_start_29118 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainzisegred_large_25712,
                                                                        1, NULL,
                                                                        global_work_sizze_29117,
                                                                        local_work_sizze_29121,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainzisegred_large_25712_runs,
                                                                                                                  &ctx->mainzisegred_large_25712_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29119 = get_wall_time();
                            
                            long time_diff_29120 = time_end_29119 -
                                 time_start_29118;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.segred_large_25712", time_diff_29120);
                        }
                    }
                    if (memblock_unref_device(ctx, &group_res_arr_mem_28807,
                                              "group_res_arr_mem_28807") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_27867, "mem_27867") != 0)
                    return 1;
                
                int64_t segmap_usable_groups_25884 = sdiv_up64(steps_23316,
                                                               segmap_group_sizze_25883);
                struct memblock_device mem_27873;
                
                mem_27873.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27873, bytes_27726,
                                          "mem_27873")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_27875;
                
                mem_27875.references = NULL;
                if (memblock_alloc_device(ctx, &mem_27875, bytes_27726,
                                          "mem_27875")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25677,
                                                        1, sizeof(steps_23316),
                                                        &steps_23316));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25677,
                                                        2, sizeof(a_23320),
                                                        &a_23320));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25677,
                                                        3, sizeof(x_23340),
                                                        &x_23340));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25677,
                                                        4, sizeof(x_23342),
                                                        &x_23342));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25677,
                                                        5, sizeof(y_23344),
                                                        &y_23344));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25677,
                                                        6, sizeof(y_23345),
                                                        &y_23345));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25677,
                                                        7,
                                                        sizeof(sims_per_year_23422),
                                                        &sims_per_year_23422));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25677,
                                                        8, sizeof(res_23750),
                                                        &res_23750));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25677,
                                                        9,
                                                        sizeof(mem_27870.mem),
                                                        &mem_27870.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25677,
                                                        10,
                                                        sizeof(mem_27873.mem),
                                                        &mem_27873.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_25677,
                                                        11,
                                                        sizeof(mem_27875.mem),
                                                        &mem_27875.mem));
                if (1 * ((size_t) segmap_usable_groups_25884 *
                         (size_t) segmap_group_sizze_25883) != 0) {
                    const size_t global_work_sizze_29122[1] =
                                 {(size_t) segmap_usable_groups_25884 *
                                 (size_t) segmap_group_sizze_25883};
                    const size_t local_work_sizze_29126[1] =
                                 {segmap_group_sizze_25883};
                    int64_t time_start_29123 = 0, time_end_29124 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.segmap_25677");
                        fprintf(stderr, "%zu", global_work_sizze_29122[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29126[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_29123 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainzisegmap_25677,
                                                                    1, NULL,
                                                                    global_work_sizze_29122,
                                                                    local_work_sizze_29126,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainzisegmap_25677_runs,
                                                                                                              &ctx->mainzisegmap_25677_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29124 = get_wall_time();
                        
                        long time_diff_29125 = time_end_29124 -
                             time_start_29123;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.segmap_25677", time_diff_29125);
                    }
                }
                if (memblock_unref_device(ctx, &mem_27870, "mem_27870") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_27876, &mem_27873,
                                        "mem_27873") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_mem_27877, &mem_27875,
                                        "mem_27875") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27875, "mem_27875") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27873, "mem_27873") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27870, "mem_27870") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_27867, "mem_27867") != 0)
                    return 1;
            }
            if (memblock_set_device(ctx, &res_map_acc_mem_27878,
                                    &res_map_acc_mem_27876,
                                    "res_map_acc_mem_27876") != 0)
                return 1;
            if (memblock_set_device(ctx, &res_mem_27879, &res_mem_27877,
                                    "res_mem_27877") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27877, "res_mem_27877") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_map_acc_mem_27876,
                                      "res_map_acc_mem_27876") != 0)
                return 1;
        }
        
        struct memblock_device mem_27882;
        
        mem_27882.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27882, 4, "mem_27882")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mainzicounter_mem_28849 =
                               ctx->mainzicounter_mem_28849;
        struct memblock_device group_res_arr_mem_28851;
        
        group_res_arr_mem_28851.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28851,
                                  (int32_t) sizeof(float) *
                                  (segred_group_sizze_25911 * num_groups_25912),
                                  "group_res_arr_mem_28851")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28853;
        
        num_threads_28853 = num_groups_25912 * segred_group_sizze_25911;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25780,
                                                1, (int32_t) sizeof(float) *
                                                segred_group_sizze_25911,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25780,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25780,
                                                3, sizeof(steps_23316),
                                                &steps_23316));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25780,
                                                4, sizeof(num_groups_25912),
                                                &num_groups_25912));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25780,
                                                5,
                                                sizeof(res_map_acc_mem_27878.mem),
                                                &res_map_acc_mem_27878.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25780,
                                                6, sizeof(mem_27882.mem),
                                                &mem_27882.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25780,
                                                7,
                                                sizeof(mainzicounter_mem_28849.mem),
                                                &mainzicounter_mem_28849.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25780,
                                                8,
                                                sizeof(group_res_arr_mem_28851.mem),
                                                &group_res_arr_mem_28851.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_25780,
                                                9, sizeof(num_threads_28853),
                                                &num_threads_28853));
        if (1 * ((size_t) num_groups_25912 *
                 (size_t) segred_group_sizze_25911) != 0) {
            const size_t global_work_sizze_29128[1] =
                         {(size_t) num_groups_25912 *
                         (size_t) segred_group_sizze_25911};
            const size_t local_work_sizze_29132[1] = {segred_group_sizze_25911};
            int64_t time_start_29129 = 0, time_end_29130 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segred_nonseg_25780");
                fprintf(stderr, "%zu", global_work_sizze_29128[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29132[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(float) *
                               segred_group_sizze_25911 +
                               (int32_t) sizeof(bool)));
                time_start_29129 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegred_nonseg_25780,
                                                            1, NULL,
                                                            global_work_sizze_29128,
                                                            local_work_sizze_29132,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegred_nonseg_25780_runs,
                                                                                                      &ctx->mainzisegred_nonseg_25780_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29130 = get_wall_time();
                
                long time_diff_29131 = time_end_29130 - time_start_29129;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segred_nonseg_25780", time_diff_29131);
            }
        }
        if (memblock_unref_device(ctx, &res_map_acc_mem_27878,
                                  "res_map_acc_mem_27878") != 0)
            return 1;
        
        float read_res_29133;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27882.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(float),
                                                     sizeof(float),
                                                     &read_res_29133, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        float res_25919 = read_res_29133;
        
        if (memblock_unref_device(ctx, &mem_27882, "mem_27882") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27886, &res_mem_27879,
                                "res_mem_27879") != 0)
            return 1;
        res_23767 = res_25919;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28851,
                                  "group_res_arr_mem_28851") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27882, "mem_27882") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27879, "res_mem_27879") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_map_acc_mem_27878,
                                  "res_map_acc_mem_27878") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_27830, "mem_27830") != 0)
        return 1;
    
    float CVA_23806 = 6.0e-3F * res_23767;
    
    out_arrsizze_28060 = steps_23316;
    if (memblock_set_device(ctx, &out_mem_28059, &res_mem_27886,
                            "res_mem_27886") != 0)
        return 1;
    scalar_out_28058 = CVA_23806;
    *out_scalar_out_28910 = scalar_out_28058;
    (*out_mem_p_28911).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_28911, &out_mem_28059,
                            "out_mem_28059") != 0)
        return 1;
    *out_out_arrsizze_28912 = out_arrsizze_28060;
    if (memblock_unref_device(ctx, &res_mem_27886, "res_mem_27886") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27830, "mem_27830") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27828, "mem_27828") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27825, "mem_27825") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27823, "mem_27823") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27820, "mem_27820") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27818, "mem_27818") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27816, "mem_27816") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27813, "mem_27813") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27811, "mem_27811") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_subhistos_mem_28305,
                              "res_subhistos_mem_28305") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27807, "mem_27807") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_28266,
                              "group_res_arr_mem_28266") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27805, "mem_27805") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27802, "mem_27802") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27800, "mem_27800") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27797, "res_mem_27797") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27796, "res_mem_27796") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27722, "res_mem_27722") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27721, "res_mem_27721") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27720, "res_mem_27720") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_28064,
                              "group_res_arr_mem_28064") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_28059, "out_mem_28059") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
static int futrts_test(struct futhark_context *ctx, float *out_scalar_out_29134,
                       int64_t paths_23807, int64_t steps_23808)
{
    (void) ctx;
    
    int err = 0;
    float scalar_out_28058;
    struct memblock_device mem_27669;
    
    mem_27669.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27669, 36, "mem_27669")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzistatic_array_28059 =
                           ctx->testzistatic_array_28059;
    
    if (9 * (int32_t) sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     testzistatic_array_28059.mem,
                                                     mem_27669.mem, 0, 0, 9 *
                                                     (int32_t) sizeof(float), 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    
    struct memblock_device mem_27671;
    
    mem_27671.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27671, 72, "mem_27671")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzistatic_array_28060 =
                           ctx->testzistatic_array_28060;
    
    if (9 * (int32_t) sizeof(int64_t) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     testzistatic_array_28060.mem,
                                                     mem_27671.mem, 0, 0, 9 *
                                                     (int32_t) sizeof(int64_t),
                                                     0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    
    struct memblock_device mem_27673;
    
    mem_27673.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27673, 36, "mem_27673")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzistatic_array_28061 =
                           ctx->testzistatic_array_28061;
    
    if (9 * (int32_t) sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     testzistatic_array_28061.mem,
                                                     mem_27673.mem, 0, 0, 9 *
                                                     (int32_t) sizeof(float), 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    
    int64_t segred_group_sizze_25924;
    
    segred_group_sizze_25924 = ctx->sizes.testzisegred_group_sizze_25923;
    
    int64_t num_groups_25926;
    int32_t max_num_groups_28062;
    
    max_num_groups_28062 = ctx->sizes.testzisegred_num_groups_25925;
    num_groups_25926 = sext_i64_i32(smax64(1, smin64(sdiv_up64(9,
                                                               sext_i32_i64(segred_group_sizze_25924)),
                                                     sext_i32_i64(max_num_groups_28062))));
    
    struct memblock_device mem_27676;
    
    mem_27676.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27676, 4, "mem_27676")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzicounter_mem_28063 =
                           ctx->testzicounter_mem_28063;
    struct memblock_device group_res_arr_mem_28065;
    
    group_res_arr_mem_28065.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_28065,
                              (int32_t) sizeof(float) *
                              (segred_group_sizze_25924 * num_groups_25926),
                              "group_res_arr_mem_28065")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_28067;
    
    num_threads_28067 = num_groups_25926 * segred_group_sizze_25924;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25931, 1,
                                            (int32_t) sizeof(float) *
                                            segred_group_sizze_25924, NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25931, 2,
                                            (int32_t) sizeof(bool), NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25931, 3,
                                            sizeof(num_groups_25926),
                                            &num_groups_25926));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25931, 4,
                                            sizeof(mem_27671.mem),
                                            &mem_27671.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25931, 5,
                                            sizeof(mem_27673.mem),
                                            &mem_27673.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25931, 6,
                                            sizeof(mem_27676.mem),
                                            &mem_27676.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25931, 7,
                                            sizeof(testzicounter_mem_28063.mem),
                                            &testzicounter_mem_28063.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25931, 8,
                                            sizeof(group_res_arr_mem_28065.mem),
                                            &group_res_arr_mem_28065.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_25931, 9,
                                            sizeof(num_threads_28067),
                                            &num_threads_28067));
    if (1 * ((size_t) num_groups_25926 * (size_t) segred_group_sizze_25924) !=
        0) {
        const size_t global_work_sizze_29139[1] = {(size_t) num_groups_25926 *
                     (size_t) segred_group_sizze_25924};
        const size_t local_work_sizze_29143[1] = {segred_group_sizze_25924};
        int64_t time_start_29140 = 0, time_end_29141 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segred_nonseg_25931");
            fprintf(stderr, "%zu", global_work_sizze_29139[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_29143[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) (0 + (int32_t) sizeof(float) *
                           segred_group_sizze_25924 + (int32_t) sizeof(bool)));
            time_start_29140 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegred_nonseg_25931,
                                                        1, NULL,
                                                        global_work_sizze_29139,
                                                        local_work_sizze_29143,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegred_nonseg_25931_runs,
                                                                                                  &ctx->testzisegred_nonseg_25931_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_29141 = get_wall_time();
            
            long time_diff_29142 = time_end_29141 - time_start_29140;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "test.segred_nonseg_25931", time_diff_29142);
        }
    }
    
    float read_res_29144;
    
    OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                 mem_27676.mem,
                                                 ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                 0 * sizeof(float),
                                                 sizeof(float), &read_res_29144,
                                                 0, NULL,
                                                 ctx->profiling_paused ||
                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                           &ctx->copy_scalar_from_dev_runs,
                                                                                           &ctx->copy_scalar_from_dev_total_runtime)));
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
        return 1;
    
    float res_23812 = read_res_29144;
    
    if (memblock_unref_device(ctx, &mem_27676, "mem_27676") != 0)
        return 1;
    
    float res_23820 = sitofp_i64_f32(steps_23808);
    float dt_23821 = res_23812 / res_23820;
    bool suff_outer_par_25933;
    
    suff_outer_par_25933 = ctx->sizes.testzisuff_outer_par_0 <= 9;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_outer_par_0", 9);
    
    int64_t segmap_group_sizze_26023;
    
    segmap_group_sizze_26023 = ctx->sizes.testzisegmap_group_sizze_25947;
    
    int64_t segmap_group_sizze_26199;
    
    segmap_group_sizze_26199 = ctx->sizes.testzisegmap_group_sizze_26123;
    
    int64_t segred_num_groups_27984;
    
    segred_num_groups_27984 = ctx->sizes.testzisegred_num_groups_27983;
    
    int64_t segred_group_sizze_27986;
    
    segred_group_sizze_27986 = ctx->sizes.testzisegred_group_sizze_27985;
    
    int64_t segred_num_groups_28016;
    
    segred_num_groups_28016 = ctx->sizes.testzisegred_num_groups_28015;
    
    int64_t segred_group_sizze_28018;
    
    segred_group_sizze_28018 = ctx->sizes.testzisegred_group_sizze_28017;
    
    struct memblock_device res_mem_27723;
    
    res_mem_27723.references = NULL;
    
    struct memblock_device res_mem_27724;
    
    res_mem_27724.references = NULL;
    
    struct memblock_device res_mem_27725;
    
    res_mem_27725.references = NULL;
    
    struct memblock_device res_mem_27726;
    
    res_mem_27726.references = NULL;
    
    int32_t local_memory_capacity_28167;
    
    local_memory_capacity_28167 = ctx->opencl.max_local_memory;
    if ((sle64((int32_t) sizeof(bool) + (int32_t) sizeof(int64_t) *
               segred_group_sizze_27986,
               sext_i32_i64(local_memory_capacity_28167)) && sle64(0,
                                                                   sext_i32_i64(local_memory_capacity_28167))) &&
        suff_outer_par_25933) {
        int64_t segmap_usable_groups_26024 = sdiv_up64(9,
                                                       segmap_group_sizze_26023);
        struct memblock_device mem_27678;
        
        mem_27678.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27678, 36, "mem_27678")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27673.mem,
                                                         mem_27678.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27680;
        
        mem_27680.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27680, 72, "mem_27680")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27671.mem,
                                                         mem_27680.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27682;
        
        mem_27682.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27682, 36, "mem_27682")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27669.mem,
                                                         mem_27682.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27699;
        
        mem_27699.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27699, 36, "mem_27699")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_27974 = segmap_group_sizze_26023 *
                segmap_usable_groups_26024;
        struct memblock_device mem_28002;
        
        mem_28002.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28002, 8, "mem_28002")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device testzicounter_mem_28093 =
                               ctx->testzicounter_mem_28093;
        struct memblock_device group_res_arr_mem_28095;
        
        group_res_arr_mem_28095.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28095,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_27986 *
                                   segred_num_groups_27984),
                                  "group_res_arr_mem_28095")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28097;
        
        num_threads_28097 = segred_num_groups_27984 * segred_group_sizze_27986;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27990,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_27986,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27990,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27990,
                                                3, sizeof(mem_27671.mem),
                                                &mem_27671.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27990,
                                                4, sizeof(mem_28002.mem),
                                                &mem_28002.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27990,
                                                5,
                                                sizeof(testzicounter_mem_28093.mem),
                                                &testzicounter_mem_28093.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27990,
                                                6,
                                                sizeof(group_res_arr_mem_28095.mem),
                                                &group_res_arr_mem_28095.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27990,
                                                7, sizeof(num_threads_28097),
                                                &num_threads_28097));
        if (1 * ((size_t) segred_num_groups_27984 *
                 (size_t) segred_group_sizze_27986) != 0) {
            const size_t global_work_sizze_29146[1] =
                         {(size_t) segred_num_groups_27984 *
                         (size_t) segred_group_sizze_27986};
            const size_t local_work_sizze_29150[1] = {segred_group_sizze_27986};
            int64_t time_start_29147 = 0, time_end_29148 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segred_nonseg_27990");
                fprintf(stderr, "%zu", global_work_sizze_29146[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29150[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_27986 +
                               (int32_t) sizeof(bool)));
                time_start_29147 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegred_nonseg_27990,
                                                            1, NULL,
                                                            global_work_sizze_29146,
                                                            local_work_sizze_29150,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegred_nonseg_27990_runs,
                                                                                                      &ctx->testzisegred_nonseg_27990_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29148 = get_wall_time();
                
                long time_diff_29149 = time_end_29148 - time_start_29147;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segred_nonseg_27990", time_diff_29149);
            }
        }
        
        int64_t read_res_29151;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_28002.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_29151, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t max_per_thread_27980 = read_res_29151;
        
        if (memblock_unref_device(ctx, &mem_28002, "mem_28002") != 0)
            return 1;
        
        int64_t sizze_sum_27997 = num_threads_27974 * max_per_thread_27980;
        struct memblock_device mem_27685;
        
        mem_27685.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27685, sizze_sum_27997,
                                  "mem_27685")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_25945, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_25945, 3,
                                                sizeof(mem_27671.mem),
                                                &mem_27671.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_25945, 4,
                                                sizeof(mem_27673.mem),
                                                &mem_27673.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_25945, 5,
                                                sizeof(mem_27685.mem),
                                                &mem_27685.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_25945, 6,
                                                sizeof(mem_27699.mem),
                                                &mem_27699.mem));
        if (1 * ((size_t) segmap_usable_groups_26024 *
                 (size_t) segmap_group_sizze_26023) != 0) {
            const size_t global_work_sizze_29152[1] =
                         {(size_t) segmap_usable_groups_26024 *
                         (size_t) segmap_group_sizze_26023};
            const size_t local_work_sizze_29156[1] = {segmap_group_sizze_26023};
            int64_t time_start_29153 = 0, time_end_29154 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_25945");
                fprintf(stderr, "%zu", global_work_sizze_29152[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29156[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29153 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_25945,
                                                            1, NULL,
                                                            global_work_sizze_29152,
                                                            local_work_sizze_29156,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_25945_runs,
                                                                                                      &ctx->testzisegmap_25945_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29154 = get_wall_time();
                
                long time_diff_29155 = time_end_29154 - time_start_29153;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_25945", time_diff_29155);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_27685, "mem_27685") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27723, &mem_27699, "mem_27699") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27724, &mem_27682, "mem_27682") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27725, &mem_27680, "mem_27680") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27726, &mem_27678, "mem_27678") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27685, "mem_27685") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28095,
                                  "group_res_arr_mem_28095") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28002, "mem_28002") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27699, "mem_27699") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27682, "mem_27682") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27680, "mem_27680") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27678, "mem_27678") != 0)
            return 1;
    } else {
        int64_t segmap_usable_groups_26200 = sdiv_up64(9,
                                                       segmap_group_sizze_26199);
        struct memblock_device mem_27701;
        
        mem_27701.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27701, 36, "mem_27701")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27673.mem,
                                                         mem_27701.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27703;
        
        mem_27703.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27703, 72, "mem_27703")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27671.mem,
                                                         mem_27703.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27705;
        
        mem_27705.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27705, 36, "mem_27705")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_27669.mem,
                                                         mem_27705.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_27722;
        
        mem_27722.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27722, 36, "mem_27722")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28006 = segmap_group_sizze_26199 *
                segmap_usable_groups_26200;
        struct memblock_device mem_28034;
        
        mem_28034.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28034, 8, "mem_28034")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device testzicounter_mem_28130 =
                               ctx->testzicounter_mem_28130;
        struct memblock_device group_res_arr_mem_28132;
        
        group_res_arr_mem_28132.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28132,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_28018 *
                                   segred_num_groups_28016),
                                  "group_res_arr_mem_28132")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28134;
        
        num_threads_28134 = segred_num_groups_28016 * segred_group_sizze_28018;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28022,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_28018,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28022,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28022,
                                                3, sizeof(mem_27671.mem),
                                                &mem_27671.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28022,
                                                4, sizeof(mem_28034.mem),
                                                &mem_28034.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28022,
                                                5,
                                                sizeof(testzicounter_mem_28130.mem),
                                                &testzicounter_mem_28130.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28022,
                                                6,
                                                sizeof(group_res_arr_mem_28132.mem),
                                                &group_res_arr_mem_28132.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28022,
                                                7, sizeof(num_threads_28134),
                                                &num_threads_28134));
        if (1 * ((size_t) segred_num_groups_28016 *
                 (size_t) segred_group_sizze_28018) != 0) {
            const size_t global_work_sizze_29158[1] =
                         {(size_t) segred_num_groups_28016 *
                         (size_t) segred_group_sizze_28018};
            const size_t local_work_sizze_29162[1] = {segred_group_sizze_28018};
            int64_t time_start_29159 = 0, time_end_29160 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segred_nonseg_28022");
                fprintf(stderr, "%zu", global_work_sizze_29158[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29162[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_28018 +
                               (int32_t) sizeof(bool)));
                time_start_29159 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegred_nonseg_28022,
                                                            1, NULL,
                                                            global_work_sizze_29158,
                                                            local_work_sizze_29162,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegred_nonseg_28022_runs,
                                                                                                      &ctx->testzisegred_nonseg_28022_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29160 = get_wall_time();
                
                long time_diff_29161 = time_end_29160 - time_start_29159;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segred_nonseg_28022", time_diff_29161);
            }
        }
        
        int64_t read_res_29163;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_28034.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_29163, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t max_per_thread_28012 = read_res_29163;
        
        if (memblock_unref_device(ctx, &mem_28034, "mem_28034") != 0)
            return 1;
        
        int64_t sizze_sum_28029 = num_threads_28006 * max_per_thread_28012;
        struct memblock_device mem_27708;
        
        mem_27708.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27708, sizze_sum_28029,
                                  "mem_27708")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26121, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26121, 3,
                                                sizeof(mem_27671.mem),
                                                &mem_27671.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26121, 4,
                                                sizeof(mem_27673.mem),
                                                &mem_27673.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26121, 5,
                                                sizeof(mem_27708.mem),
                                                &mem_27708.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26121, 6,
                                                sizeof(mem_27722.mem),
                                                &mem_27722.mem));
        if (1 * ((size_t) segmap_usable_groups_26200 *
                 (size_t) segmap_group_sizze_26199) != 0) {
            const size_t global_work_sizze_29164[1] =
                         {(size_t) segmap_usable_groups_26200 *
                         (size_t) segmap_group_sizze_26199};
            const size_t local_work_sizze_29168[1] = {segmap_group_sizze_26199};
            int64_t time_start_29165 = 0, time_end_29166 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_26121");
                fprintf(stderr, "%zu", global_work_sizze_29164[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29168[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29165 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_26121,
                                                            1, NULL,
                                                            global_work_sizze_29164,
                                                            local_work_sizze_29168,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_26121_runs,
                                                                                                      &ctx->testzisegmap_26121_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29166 = get_wall_time();
                
                long time_diff_29167 = time_end_29166 - time_start_29165;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_26121", time_diff_29167);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_27708, "mem_27708") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27723, &mem_27722, "mem_27722") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27724, &mem_27705, "mem_27705") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27725, &mem_27703, "mem_27703") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27726, &mem_27701, "mem_27701") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27708, "mem_27708") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28132,
                                  "group_res_arr_mem_28132") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28034, "mem_28034") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27722, "mem_27722") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27705, "mem_27705") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27703, "mem_27703") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27701, "mem_27701") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_27669, "mem_27669") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27671, "mem_27671") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
        return 1;
    
    float sims_per_year_23899 = res_23820 / res_23812;
    bool bounds_invalid_upwards_23900 = slt64(steps_23808, 1);
    bool valid_23901 = !bounds_invalid_upwards_23900;
    bool range_valid_c_23902;
    
    if (!valid_23901) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 1, "..", 2, "...", steps_23808,
                               " is invalid.",
                               "-> #0  cva2.fut:60:56-67\n   #1  cva2.fut:111:17-44\n   #2  cva2.fut:162:3-120\n   #3  cva2.fut:161:1-162:128\n");
        if (memblock_unref_device(ctx, &res_mem_27726, "res_mem_27726") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27725, "res_mem_27725") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27724, "res_mem_27724") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28065,
                                  "group_res_arr_mem_28065") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27676, "mem_27676") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27671, "mem_27671") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27669, "mem_27669") != 0)
            return 1;
        return 1;
    }
    
    bool bounds_invalid_upwards_23908 = slt64(paths_23807, 0);
    bool valid_23909 = !bounds_invalid_upwards_23908;
    bool range_valid_c_23910;
    
    if (!valid_23909) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", paths_23807,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:126:11-16\n   #2  lib/github.com/diku-dk/cpprandom/random.fut:174:8-56\n   #3  cva2.fut:115:19-49\n   #4  cva2.fut:162:3-120\n   #5  cva2.fut:161:1-162:128\n");
        if (memblock_unref_device(ctx, &res_mem_27726, "res_mem_27726") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27725, "res_mem_27725") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27724, "res_mem_27724") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28065,
                                  "group_res_arr_mem_28065") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27676, "mem_27676") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27671, "mem_27671") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27669, "mem_27669") != 0)
            return 1;
        return 1;
    }
    
    int64_t upper_bound_23913 = sub64(steps_23808, 1);
    float res_23914;
    
    res_23914 = futrts_sqrt32(dt_23821);
    
    int64_t one_intra_par_min_26359 = 9 * steps_23808;
    int64_t intra_avail_par_26361 = smin64(steps_23808,
                                           one_intra_par_min_26359);
    int64_t computed_group_sizze_26319 = smax64(steps_23808,
                                                one_intra_par_min_26359);
    int64_t max_group_sizze_26511;
    
    max_group_sizze_26511 = ctx->opencl.max_group_size;
    
    bool fits_26512 = sle64(computed_group_sizze_26319, max_group_sizze_26511);
    bool suff_intra_par_26510;
    
    suff_intra_par_26510 = ctx->sizes.testzisuff_intra_par_3 <=
        intra_avail_par_26361;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_intra_par_3",
                intra_avail_par_26361);
    
    bool intra_suff_and_fits_26513 = suff_intra_par_26510 && fits_26512;
    int64_t segmap_group_sizze_26899;
    
    segmap_group_sizze_26899 = ctx->sizes.testzisegmap_group_sizze_26882;
    
    int64_t nest_sizze_26923 = paths_23807 * steps_23808;
    int64_t segmap_group_sizze_26924;
    
    segmap_group_sizze_26924 = ctx->sizes.testzisegmap_group_sizze_26819;
    
    int64_t segmap_group_sizze_26969;
    
    segmap_group_sizze_26969 = ctx->sizes.testzisegmap_group_sizze_26720;
    
    int64_t num_groups_26970;
    int32_t max_num_groups_28168;
    
    max_num_groups_28168 = ctx->sizes.testzisegmap_num_groups_26722;
    num_groups_26970 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_23807,
                                                               sext_i32_i64(segmap_group_sizze_26969)),
                                                     sext_i32_i64(max_num_groups_28168))));
    
    int64_t nest_sizze_27014 = paths_23807 * one_intra_par_min_26359;
    int64_t segmap_group_sizze_27015;
    
    segmap_group_sizze_27015 = ctx->sizes.testzisegmap_group_sizze_26665;
    
    int64_t segmap_group_sizze_27033;
    
    segmap_group_sizze_27033 = ctx->sizes.testzisegmap_group_sizze_26627;
    
    int64_t binop_x_27755 = 9 * nest_sizze_26923;
    int64_t bytes_27753 = 4 * binop_x_27755;
    int64_t bytes_27729 = 4 * steps_23808;
    int64_t bytes_27746 = 4 * one_intra_par_min_26359;
    int64_t bytes_27762 = 4 * paths_23807;
    int64_t bytes_27765 = 4 * nest_sizze_26923;
    int64_t num_threads_28041 = segmap_group_sizze_26969 * num_groups_26970;
    int64_t total_sizze_28042 = bytes_27729 * num_threads_28041;
    struct memblock_device res_mem_27799;
    
    res_mem_27799.references = NULL;
    
    struct memblock_device res_mem_27800;
    
    res_mem_27800.references = NULL;
    
    int32_t local_memory_capacity_28212;
    
    local_memory_capacity_28212 = ctx->opencl.max_local_memory;
    if (sle64(bytes_27729 + bytes_27729 + bytes_27746 + bytes_27746,
              sext_i32_i64(local_memory_capacity_28212)) &&
        intra_suff_and_fits_26513) {
        struct memblock_device mem_27756;
        
        mem_27756.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27756, bytes_27753, "mem_27756")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27760;
        
        mem_27760.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27760, bytes_27753, "mem_27760")) {
            err = 1;
            goto cleanup;
        }
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26362,
                                                1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26362,
                                                3, bytes_27746, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26362,
                                                4, bytes_27746, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26362,
                                                5, bytes_27729, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26362,
                                                6, bytes_27729, NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26362,
                                                7, sizeof(steps_23808),
                                                &steps_23808));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26362,
                                                8, sizeof(dt_23821),
                                                &dt_23821));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26362,
                                                9, sizeof(sims_per_year_23899),
                                                &sims_per_year_23899));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26362,
                                                10, sizeof(upper_bound_23913),
                                                &upper_bound_23913));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26362,
                                                11, sizeof(res_23914),
                                                &res_23914));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26362,
                                                12,
                                                sizeof(computed_group_sizze_26319),
                                                &computed_group_sizze_26319));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26362,
                                                13, sizeof(mem_27756.mem),
                                                &mem_27756.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_intragroup_26362,
                                                14, sizeof(mem_27760.mem),
                                                &mem_27760.mem));
        if (1 * ((size_t) paths_23807 * (size_t) computed_group_sizze_26319) !=
            0) {
            const size_t global_work_sizze_29169[1] = {(size_t) paths_23807 *
                         (size_t) computed_group_sizze_26319};
            const size_t local_work_sizze_29173[1] =
                         {computed_group_sizze_26319};
            int64_t time_start_29170 = 0, time_end_29171 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_intragroup_26362");
                fprintf(stderr, "%zu", global_work_sizze_29169[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29173[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + bytes_27746 + bytes_27746 + bytes_27729 +
                               bytes_27729));
                time_start_29170 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_intragroup_26362,
                                                            1, NULL,
                                                            global_work_sizze_29169,
                                                            local_work_sizze_29173,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_intragroup_26362_runs,
                                                                                                      &ctx->testzisegmap_intragroup_26362_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29171 = get_wall_time();
                
                long time_diff_29172 = time_end_29171 - time_start_29170;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_intragroup_26362", time_diff_29172);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_set_device(ctx, &res_mem_27799, &mem_27756, "mem_27756") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27800, &mem_27760, "mem_27760") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27760, "mem_27760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27756, "mem_27756") != 0)
            return 1;
    } else {
        int64_t segmap_usable_groups_26900 = sdiv_up64(paths_23807,
                                                       segmap_group_sizze_26899);
        struct memblock_device mem_27763;
        
        mem_27763.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27763, bytes_27762, "mem_27763")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26880, 1,
                                                sizeof(paths_23807),
                                                &paths_23807));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26880, 2,
                                                sizeof(mem_27763.mem),
                                                &mem_27763.mem));
        if (1 * ((size_t) segmap_usable_groups_26900 *
                 (size_t) segmap_group_sizze_26899) != 0) {
            const size_t global_work_sizze_29174[1] =
                         {(size_t) segmap_usable_groups_26900 *
                         (size_t) segmap_group_sizze_26899};
            const size_t local_work_sizze_29178[1] = {segmap_group_sizze_26899};
            int64_t time_start_29175 = 0, time_end_29176 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_26880");
                fprintf(stderr, "%zu", global_work_sizze_29174[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29178[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29175 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_26880,
                                                            1, NULL,
                                                            global_work_sizze_29174,
                                                            local_work_sizze_29178,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_26880_runs,
                                                                                                      &ctx->testzisegmap_26880_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29176 = get_wall_time();
                
                long time_diff_29177 = time_end_29176 - time_start_29175;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_26880", time_diff_29177);
            }
        }
        
        int64_t segmap_usable_groups_26925 = sdiv_up64(nest_sizze_26923,
                                                       segmap_group_sizze_26924);
        struct memblock_device mem_27767;
        
        mem_27767.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27767, bytes_27765, "mem_27767")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26816, 1,
                                                sizeof(paths_23807),
                                                &paths_23807));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26816, 2,
                                                sizeof(steps_23808),
                                                &steps_23808));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26816, 3,
                                                sizeof(mem_27763.mem),
                                                &mem_27763.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26816, 4,
                                                sizeof(mem_27767.mem),
                                                &mem_27767.mem));
        if (1 * ((size_t) segmap_usable_groups_26925 *
                 (size_t) segmap_group_sizze_26924) != 0) {
            const size_t global_work_sizze_29179[1] =
                         {(size_t) segmap_usable_groups_26925 *
                         (size_t) segmap_group_sizze_26924};
            const size_t local_work_sizze_29183[1] = {segmap_group_sizze_26924};
            int64_t time_start_29180 = 0, time_end_29181 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_26816");
                fprintf(stderr, "%zu", global_work_sizze_29179[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29183[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29180 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_26816,
                                                            1, NULL,
                                                            global_work_sizze_29179,
                                                            local_work_sizze_29183,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_26816_runs,
                                                                                                      &ctx->testzisegmap_26816_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29181 = get_wall_time();
                
                long time_diff_29182 = time_end_29181 - time_start_29180;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_26816", time_diff_29182);
            }
        }
        if (memblock_unref_device(ctx, &mem_27763, "mem_27763") != 0)
            return 1;
        
        struct memblock_device mem_27770;
        
        mem_27770.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27770, bytes_27765, "mem_27770")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27770, 0, mem_27767,
                                                  0, 1, steps_23808,
                                                  paths_23807) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_unref_device(ctx, &mem_27767, "mem_27767") != 0)
            return 1;
        
        struct memblock_device mem_27788;
        
        mem_27788.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27788, bytes_27765, "mem_27788")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_27773;
        
        mem_27773.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27773, total_sizze_28042,
                                  "mem_27773")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26718, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26718, 3,
                                                sizeof(paths_23807),
                                                &paths_23807));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26718, 4,
                                                sizeof(steps_23808),
                                                &steps_23808));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26718, 5,
                                                sizeof(dt_23821), &dt_23821));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26718, 6,
                                                sizeof(upper_bound_23913),
                                                &upper_bound_23913));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26718, 7,
                                                sizeof(res_23914), &res_23914));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26718, 8,
                                                sizeof(num_groups_26970),
                                                &num_groups_26970));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26718, 9,
                                                sizeof(mem_27770.mem),
                                                &mem_27770.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26718, 10,
                                                sizeof(mem_27773.mem),
                                                &mem_27773.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26718, 11,
                                                sizeof(mem_27788.mem),
                                                &mem_27788.mem));
        if (1 * ((size_t) num_groups_26970 *
                 (size_t) segmap_group_sizze_26969) != 0) {
            const size_t global_work_sizze_29184[1] =
                         {(size_t) num_groups_26970 *
                         (size_t) segmap_group_sizze_26969};
            const size_t local_work_sizze_29188[1] = {segmap_group_sizze_26969};
            int64_t time_start_29185 = 0, time_end_29186 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_26718");
                fprintf(stderr, "%zu", global_work_sizze_29184[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29188[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29185 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_26718,
                                                            1, NULL,
                                                            global_work_sizze_29184,
                                                            local_work_sizze_29188,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_26718_runs,
                                                                                                      &ctx->testzisegmap_26718_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29186 = get_wall_time();
                
                long time_diff_29187 = time_end_29186 - time_start_29185;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_26718", time_diff_29187);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_27770, "mem_27770") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27773, "mem_27773") != 0)
            return 1;
        
        int64_t segmap_usable_groups_27016 = sdiv_up64(nest_sizze_27014,
                                                       segmap_group_sizze_27015);
        struct memblock_device mem_27793;
        
        mem_27793.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27793, bytes_27753, "mem_27793")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26661, 1,
                                                sizeof(paths_23807),
                                                &paths_23807));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26661, 2,
                                                sizeof(steps_23808),
                                                &steps_23808));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26661, 3,
                                                sizeof(mem_27788.mem),
                                                &mem_27788.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26661, 4,
                                                sizeof(mem_27793.mem),
                                                &mem_27793.mem));
        if (1 * ((size_t) segmap_usable_groups_27016 *
                 (size_t) segmap_group_sizze_27015) != 0) {
            const size_t global_work_sizze_29189[1] =
                         {(size_t) segmap_usable_groups_27016 *
                         (size_t) segmap_group_sizze_27015};
            const size_t local_work_sizze_29193[1] = {segmap_group_sizze_27015};
            int64_t time_start_29190 = 0, time_end_29191 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_26661");
                fprintf(stderr, "%zu", global_work_sizze_29189[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29193[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29190 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_26661,
                                                            1, NULL,
                                                            global_work_sizze_29189,
                                                            local_work_sizze_29193,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_26661_runs,
                                                                                                      &ctx->testzisegmap_26661_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29191 = get_wall_time();
                
                long time_diff_29192 = time_end_29191 - time_start_29190;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_26661", time_diff_29192);
            }
        }
        if (memblock_unref_device(ctx, &mem_27788, "mem_27788") != 0)
            return 1;
        
        int64_t segmap_usable_groups_27034 = sdiv_up64(nest_sizze_27014,
                                                       segmap_group_sizze_27033);
        struct memblock_device mem_27798;
        
        mem_27798.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27798, bytes_27753, "mem_27798")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26623, 1,
                                                sizeof(paths_23807),
                                                &paths_23807));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26623, 2,
                                                sizeof(steps_23808),
                                                &steps_23808));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26623, 3,
                                                sizeof(sims_per_year_23899),
                                                &sims_per_year_23899));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_26623, 4,
                                                sizeof(mem_27798.mem),
                                                &mem_27798.mem));
        if (1 * ((size_t) segmap_usable_groups_27034 *
                 (size_t) segmap_group_sizze_27033) != 0) {
            const size_t global_work_sizze_29194[1] =
                         {(size_t) segmap_usable_groups_27034 *
                         (size_t) segmap_group_sizze_27033};
            const size_t local_work_sizze_29198[1] = {segmap_group_sizze_27033};
            int64_t time_start_29195 = 0, time_end_29196 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_26623");
                fprintf(stderr, "%zu", global_work_sizze_29194[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29198[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29195 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_26623,
                                                            1, NULL,
                                                            global_work_sizze_29194,
                                                            local_work_sizze_29198,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_26623_runs,
                                                                                                      &ctx->testzisegmap_26623_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29196 = get_wall_time();
                
                long time_diff_29197 = time_end_29196 - time_start_29195;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_26623", time_diff_29197);
            }
        }
        if (memblock_set_device(ctx, &res_mem_27799, &mem_27793, "mem_27793") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_27800, &mem_27798, "mem_27798") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27798, "mem_27798") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27793, "mem_27793") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27773, "mem_27773") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27788, "mem_27788") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27770, "mem_27770") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27767, "mem_27767") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27763, "mem_27763") != 0)
            return 1;
    }
    
    int64_t segscan_group_sizze_27045;
    
    segscan_group_sizze_27045 = ctx->sizes.testzisegscan_group_sizze_27044;
    
    int64_t num_groups_27047;
    int32_t max_num_groups_28213;
    
    max_num_groups_28213 = ctx->sizes.testzisegscan_num_groups_27046;
    num_groups_27047 = sext_i64_i32(smax64(1, smin64(sdiv_up64(binop_x_27755,
                                                               sext_i32_i64(segscan_group_sizze_27045)),
                                                     sext_i32_i64(max_num_groups_28213))));
    
    int64_t bytes_27802 = 8 * binop_x_27755;
    struct memblock_device mem_27803;
    
    mem_27803.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27803, bytes_27802, "mem_27803")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27805;
    
    mem_27805.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27805, bytes_27802, "mem_27805")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, binop_x_27755)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28214;
        
        stage1_max_num_groups_28214 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28215;
        
        stage1_num_groups_28215 = smin64(stage1_max_num_groups_28214,
                                         num_groups_27047);
        
        int32_t num_threads_28216;
        
        num_threads_28216 = sext_i64_i32(stage1_num_groups_28215 *
            segscan_group_sizze_27045);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27050, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_27045),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27050, 2,
                                                sizeof(steps_23808),
                                                &steps_23808));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27050, 3,
                                                sizeof(one_intra_par_min_26359),
                                                &one_intra_par_min_26359));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27050, 4,
                                                sizeof(res_mem_27725.mem),
                                                &res_mem_27725.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27050, 5,
                                                sizeof(res_mem_27726.mem),
                                                &res_mem_27726.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27050, 6,
                                                sizeof(binop_x_27755),
                                                &binop_x_27755));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27050, 7,
                                                sizeof(res_mem_27800.mem),
                                                &res_mem_27800.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27050, 8,
                                                sizeof(mem_27803.mem),
                                                &mem_27803.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27050, 9,
                                                sizeof(mem_27805.mem),
                                                &mem_27805.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27050,
                                                10, sizeof(num_threads_28216),
                                                &num_threads_28216));
        if (1 * ((size_t) stage1_num_groups_28215 *
                 (size_t) segscan_group_sizze_27045) != 0) {
            const size_t global_work_sizze_29199[1] =
                         {(size_t) stage1_num_groups_28215 *
                         (size_t) segscan_group_sizze_27045};
            const size_t local_work_sizze_29203[1] =
                         {segscan_group_sizze_27045};
            int64_t time_start_29200 = 0, time_end_29201 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage1_27050");
                fprintf(stderr, "%zu", global_work_sizze_29199[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29203[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_27045)));
                time_start_29200 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage1_27050,
                                                            1, NULL,
                                                            global_work_sizze_29199,
                                                            local_work_sizze_29203,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage1_27050_runs,
                                                                                                      &ctx->testziscan_stage1_27050_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29201 = get_wall_time();
                
                long time_diff_29202 = time_end_29201 - time_start_29200;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage1_27050", time_diff_29202);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_27045 *
                                 sdiv_up64(binop_x_27755,
                                           sext_i32_i64(num_threads_28216))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27050, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_28215),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27050, 2,
                                                sizeof(binop_x_27755),
                                                &binop_x_27755));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27050, 3,
                                                sizeof(mem_27803.mem),
                                                &mem_27803.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27050, 4,
                                                sizeof(stage1_num_groups_28215),
                                                &stage1_num_groups_28215));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27050, 5,
                                                sizeof(num_threads_28216),
                                                &num_threads_28216));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28215) != 0) {
            const size_t global_work_sizze_29204[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28215};
            const size_t local_work_sizze_29208[1] = {stage1_num_groups_28215};
            int64_t time_start_29205 = 0, time_end_29206 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage2_27050");
                fprintf(stderr, "%zu", global_work_sizze_29204[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29208[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_28215)));
                time_start_29205 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage2_27050,
                                                            1, NULL,
                                                            global_work_sizze_29204,
                                                            local_work_sizze_29208,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage2_27050_runs,
                                                                                                      &ctx->testziscan_stage2_27050_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29206 = get_wall_time();
                
                long time_diff_29207 = time_end_29206 - time_start_29205;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage2_27050", time_diff_29207);
            }
        }
        
        int32_t required_groups_28252;
        
        required_groups_28252 = sext_i64_i32(sdiv_up64(binop_x_27755,
                                                       segscan_group_sizze_27045));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27050, 1,
                                                sizeof(num_groups_27047),
                                                &num_groups_27047));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27050, 2,
                                                sizeof(binop_x_27755),
                                                &binop_x_27755));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27050, 3,
                                                sizeof(mem_27803.mem),
                                                &mem_27803.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27050, 4,
                                                sizeof(num_threads_28216),
                                                &num_threads_28216));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27050, 5,
                                                sizeof(required_groups_28252),
                                                &required_groups_28252));
        if (1 * ((size_t) num_groups_27047 *
                 (size_t) segscan_group_sizze_27045) != 0) {
            const size_t global_work_sizze_29209[1] =
                         {(size_t) num_groups_27047 *
                         (size_t) segscan_group_sizze_27045};
            const size_t local_work_sizze_29213[1] =
                         {segscan_group_sizze_27045};
            int64_t time_start_29210 = 0, time_end_29211 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage3_27050");
                fprintf(stderr, "%zu", global_work_sizze_29209[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29213[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29210 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage3_27050,
                                                            1, NULL,
                                                            global_work_sizze_29209,
                                                            local_work_sizze_29213,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage3_27050_runs,
                                                                                                      &ctx->testziscan_stage3_27050_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29211 = get_wall_time();
                
                long time_diff_29212 = time_end_29211 - time_start_29210;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage3_27050", time_diff_29212);
            }
        }
    }
    
    int64_t segred_group_sizze_27053;
    
    segred_group_sizze_27053 = ctx->sizes.testzisegred_group_sizze_27052;
    
    int64_t num_groups_27055;
    int32_t max_num_groups_28264;
    
    max_num_groups_28264 = ctx->sizes.testzisegred_num_groups_27054;
    num_groups_27055 = sext_i64_i32(smax64(1, smin64(sdiv_up64(binop_x_27755,
                                                               sext_i32_i64(segred_group_sizze_27053)),
                                                     sext_i32_i64(max_num_groups_28264))));
    
    struct memblock_device mem_27808;
    
    mem_27808.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27808, 8, "mem_27808")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzicounter_mem_28265 =
                           ctx->testzicounter_mem_28265;
    struct memblock_device group_res_arr_mem_28267;
    
    group_res_arr_mem_28267.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_28267,
                              (int32_t) sizeof(int64_t) *
                              (segred_group_sizze_27053 * num_groups_27055),
                              "group_res_arr_mem_28267")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_28269;
    
    num_threads_28269 = num_groups_27055 * segred_group_sizze_27053;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27060, 1,
                                            (int32_t) sizeof(int64_t) *
                                            segred_group_sizze_27053, NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27060, 2,
                                            (int32_t) sizeof(bool), NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27060, 3,
                                            sizeof(num_groups_27055),
                                            &num_groups_27055));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27060, 4,
                                            sizeof(binop_x_27755),
                                            &binop_x_27755));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27060, 5,
                                            sizeof(mem_27805.mem),
                                            &mem_27805.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27060, 6,
                                            sizeof(mem_27808.mem),
                                            &mem_27808.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27060, 7,
                                            sizeof(testzicounter_mem_28265.mem),
                                            &testzicounter_mem_28265.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27060, 8,
                                            sizeof(group_res_arr_mem_28267.mem),
                                            &group_res_arr_mem_28267.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27060, 9,
                                            sizeof(num_threads_28269),
                                            &num_threads_28269));
    if (1 * ((size_t) num_groups_27055 * (size_t) segred_group_sizze_27053) !=
        0) {
        const size_t global_work_sizze_29215[1] = {(size_t) num_groups_27055 *
                     (size_t) segred_group_sizze_27053};
        const size_t local_work_sizze_29219[1] = {segred_group_sizze_27053};
        int64_t time_start_29216 = 0, time_end_29217 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segred_nonseg_27060");
            fprintf(stderr, "%zu", global_work_sizze_29215[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_29219[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) (0 + (int32_t) sizeof(int64_t) *
                           segred_group_sizze_27053 + (int32_t) sizeof(bool)));
            time_start_29216 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegred_nonseg_27060,
                                                        1, NULL,
                                                        global_work_sizze_29215,
                                                        local_work_sizze_29219,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegred_nonseg_27060_runs,
                                                                                                  &ctx->testzisegred_nonseg_27060_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_29217 = get_wall_time();
            
            long time_diff_29218 = time_end_29217 - time_start_29216;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "test.segred_nonseg_27060", time_diff_29218);
        }
    }
    if (memblock_unref_device(ctx, &mem_27805, "mem_27805") != 0)
        return 1;
    
    int64_t read_res_29220;
    
    OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                 mem_27808.mem,
                                                 ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                 0 * sizeof(int64_t),
                                                 sizeof(int64_t),
                                                 &read_res_29220, 0, NULL,
                                                 ctx->profiling_paused ||
                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                           &ctx->copy_scalar_from_dev_runs,
                                                                                           &ctx->copy_scalar_from_dev_total_runtime)));
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t res_24008 = read_res_29220;
    
    if (memblock_unref_device(ctx, &mem_27808, "mem_27808") != 0)
        return 1;
    
    bool bounds_invalid_upwards_24013 = slt64(res_24008, 0);
    bool valid_24014 = !bounds_invalid_upwards_24013;
    bool range_valid_c_24015;
    
    if (!valid_24014) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", res_24008,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:48:30-60\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:87:14-32\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva2.fut:134:18-77\n   #6  cva2.fut:162:3-120\n   #7  cva2.fut:161:1-162:128\n");
        if (memblock_unref_device(ctx, &group_res_arr_mem_28267,
                                  "group_res_arr_mem_28267") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27808, "mem_27808") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27805, "mem_27805") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27803, "mem_27803") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27800, "res_mem_27800") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27799, "res_mem_27799") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27726, "res_mem_27726") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27725, "res_mem_27725") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27724, "res_mem_27724") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28065,
                                  "group_res_arr_mem_28065") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27676, "mem_27676") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27671, "mem_27671") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27669, "mem_27669") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_27809 = 8 * res_24008;
    struct memblock_device mem_27810;
    
    mem_27810.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27810, bytes_27809, "mem_27810")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_27810, res_24008, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t seghist_group_sizze_27063;
    
    seghist_group_sizze_27063 = ctx->sizes.testziseghist_group_sizze_27062;
    
    int64_t num_groups_27065;
    int32_t max_num_groups_28304;
    
    max_num_groups_28304 = ctx->sizes.testziseghist_num_groups_27064;
    num_groups_27065 = sext_i64_i32(smax64(1, smin64(sdiv_up64(binop_x_27755,
                                                               sext_i32_i64(seghist_group_sizze_27063)),
                                                     sext_i32_i64(max_num_groups_28304))));
    
    int32_t num_subhistos_28305;
    struct memblock_device res_subhistos_mem_28306;
    
    res_subhistos_mem_28306.references = NULL;
    
    int64_t h_28308;
    
    h_28308 = (int32_t) sizeof(int64_t) * res_24008;
    
    int64_t seg_h_28309;
    
    seg_h_28309 = (int32_t) sizeof(int64_t) * res_24008;
    if (!(seg_h_28309 == 0)) {
        int64_t hist_H_28310 = res_24008;
        int64_t hist_el_sizze_28311 = sdiv_up64(h_28308, hist_H_28310) + 4;
        int64_t hist_N_28312 = binop_x_27755;
        int64_t hist_RF_28313 = 1;
        
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegHist");
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Number of threads (T)",
                    (long long) sext_i64_i32(num_groups_27065 *
                    seghist_group_sizze_27063), '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Desired group size (B)",
                    (long long) seghist_group_sizze_27063, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                    (long long) hist_H_28310, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Input elements per histogram (N)",
                    (long long) hist_N_28312, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Number of segments", (long long) 1,
                    '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Histogram element size (el_size)",
                    (long long) hist_el_sizze_28311, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "Race factor (RF)",
                    (long long) hist_RF_28313, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c",
                    "Memory per set of subhistograms per segment",
                    (long long) h_28308, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c",
                    "Memory per set of subhistograms times segments",
                    (long long) seg_h_28309, '\n');
        
        int32_t hist_L_28314;
        
        hist_L_28314 = ctx->opencl.max_local_memory;
        
        int32_t max_group_sizze_28315;
        
        max_group_sizze_28315 = ctx->opencl.max_group_size;
        
        int64_t num_groups_28316;
        
        num_groups_28316 =
            sdiv_up64(sext_i32_i64(sext_i64_i32(num_groups_27065 *
                      seghist_group_sizze_27063)), max_group_sizze_28315);
        
        double hist_m_prime_28317;
        
        hist_m_prime_28317 =
            sitofp_i64_f64(smin64(sext_i32_i64(squot32(hist_L_28314,
                                                       hist_el_sizze_28311)),
                                  sdiv_up64(hist_N_28312, num_groups_28316))) /
            sitofp_i64_f64(hist_H_28310);
        
        int64_t hist_M0_28318;
        
        hist_M0_28318 = smax64(1, smin64(fptosi_f64_i64(hist_m_prime_28317),
                                         max_group_sizze_28315));
        
        int64_t hist_Nout_28319;
        
        hist_Nout_28319 = 1;
        
        int64_t hist_Nin_28320;
        
        hist_Nin_28320 = binop_x_27755;
        
        int64_t work_asymp_M_max_28321;
        
        work_asymp_M_max_28321 = squot64(hist_Nout_28319 * hist_N_28312, 2 *
                                         num_groups_28316 * hist_H_28310);
        
        int32_t hist_M_28322;
        
        hist_M_28322 = sext_i64_i32(smin64(hist_M0_28318,
                                           work_asymp_M_max_28321));
        
        int64_t hist_C_28323;
        
        hist_C_28323 = sdiv_up64(max_group_sizze_28315, sext_i32_i64(smax32(1,
                                                                            hist_M_28322)));
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local hist_M0",
                    (long long) hist_M0_28318, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local work asymp M max",
                    (long long) work_asymp_M_max_28321, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local C", (long long) hist_C_28323,
                    '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local B",
                    (long long) max_group_sizze_28315, '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local M", (long long) hist_M_28322,
                    '\n');
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "local memory needed",
                    (long long) (hist_H_28310 * hist_el_sizze_28311 *
                                 sext_i32_i64(hist_M_28322)), '\n');
        
        int64_t local_mem_needed_28324;
        
        local_mem_needed_28324 = hist_el_sizze_28311 *
            sext_i32_i64(hist_M_28322);
        
        int32_t hist_S_28325;
        
        hist_S_28325 = sext_i64_i32(sdiv_up64(hist_H_28310 *
                                              local_mem_needed_28324,
                                              hist_L_28314));
        if (sle64(hist_H_28310, hist_Nin_28320) &&
            (sle64(local_mem_needed_28324, hist_L_28314) && (sle32(hist_S_28325,
                                                                   6) &&
                                                             (sle64(hist_C_28323,
                                                                    max_group_sizze_28315) &&
                                                              slt32(0,
                                                                    hist_M_28322))))) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "## Using local memory");
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                        (long long) hist_H_28310, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                        (long long) hist_M_28322, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Cooperation level (C)",
                        (long long) hist_C_28323, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                        (long long) hist_S_28325, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Number of local subhistograms per group",
                        (long long) hist_M_28322, '\n');
            
            int64_t num_segments_28326;
            
            num_segments_28326 = 1;
            num_subhistos_28305 = num_groups_28316 * num_segments_28326;
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Number of subhistograms in global memory",
                        (long long) num_subhistos_28305, '\n');
            if (num_subhistos_28305 == 1) {
                if (memblock_set_device(ctx, &res_subhistos_mem_28306,
                                        &mem_27810, "mem_27810") != 0)
                    return 1;
            } else {
                if (memblock_alloc_device(ctx, &res_subhistos_mem_28306,
                                          sext_i32_i64(num_subhistos_28305) *
                                          res_24008 * (int32_t) sizeof(int64_t),
                                          "res_subhistos_mem_28306")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, res_subhistos_mem_28306,
                                                  num_subhistos_28305 *
                                                  res_24008, 0) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (res_24008 * (int32_t) sizeof(int64_t) > 0) {
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                 mem_27810.mem,
                                                                 res_subhistos_mem_28306.mem,
                                                                 0, 0,
                                                                 res_24008 *
                                                                 (int32_t) sizeof(int64_t),
                                                                 0, NULL,
                                                                 ctx->profiling_paused ||
                                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                           &ctx->copy_dev_to_dev_runs,
                                                                                                           &ctx->copy_dev_to_dev_total_runtime)));
                    if (ctx->debugging)
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                }
            }
            for (int32_t chk_i_28327 = 0; chk_i_28327 < hist_S_28325;
                 chk_i_28327++) {
                int64_t num_segments_28328 = 1;
                int64_t hist_H_chk_28329 = sdiv_up64(res_24008,
                                                     sext_i32_i64(hist_S_28325));
                int64_t histo_sizze_28330 = hist_H_chk_28329;
                int32_t init_per_thread_28331 =
                        sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_28322) *
                                               histo_sizze_28330,
                                               max_group_sizze_28315));
                
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27068,
                                                        1,
                                                        (int32_t) sizeof(int32_t) *
                                                        (hist_M_28322 *
                                                         hist_H_chk_28329),
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27068,
                                                        2,
                                                        (int32_t) sizeof(int64_t) *
                                                        (hist_M_28322 *
                                                         hist_H_chk_28329),
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27068,
                                                        3, sizeof(res_24008),
                                                        &res_24008));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27068,
                                                        4,
                                                        sizeof(binop_x_27755),
                                                        &binop_x_27755));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27068,
                                                        5,
                                                        sizeof(mem_27803.mem),
                                                        &mem_27803.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27068,
                                                        6,
                                                        sizeof(res_subhistos_mem_28306.mem),
                                                        &res_subhistos_mem_28306.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27068,
                                                        7,
                                                        sizeof(max_group_sizze_28315),
                                                        &max_group_sizze_28315));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27068,
                                                        8,
                                                        sizeof(num_groups_28316),
                                                        &num_groups_28316));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27068,
                                                        9, sizeof(hist_M_28322),
                                                        &hist_M_28322));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27068,
                                                        10, sizeof(chk_i_28327),
                                                        &chk_i_28327));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27068,
                                                        11,
                                                        sizeof(num_segments_28328),
                                                        &num_segments_28328));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27068,
                                                        12,
                                                        sizeof(hist_H_chk_28329),
                                                        &hist_H_chk_28329));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27068,
                                                        13,
                                                        sizeof(histo_sizze_28330),
                                                        &histo_sizze_28330));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_27068,
                                                        14,
                                                        sizeof(init_per_thread_28331),
                                                        &init_per_thread_28331));
                if (1 * ((size_t) num_groups_28316 *
                         (size_t) max_group_sizze_28315) != 0) {
                    const size_t global_work_sizze_29221[1] =
                                 {(size_t) num_groups_28316 *
                                 (size_t) max_group_sizze_28315};
                    const size_t local_work_sizze_29225[1] =
                                 {max_group_sizze_28315};
                    int64_t time_start_29222 = 0, time_end_29223 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.seghist_local_27068");
                        fprintf(stderr, "%zu", global_work_sizze_29221[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29225[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(int32_t) *
                                       (hist_M_28322 * hist_H_chk_28329) +
                                       (int32_t) sizeof(int64_t) *
                                       (hist_M_28322 * hist_H_chk_28329)));
                        time_start_29222 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testziseghist_local_27068,
                                                                    1, NULL,
                                                                    global_work_sizze_29221,
                                                                    local_work_sizze_29225,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testziseghist_local_27068_runs,
                                                                                                              &ctx->testziseghist_local_27068_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29223 = get_wall_time();
                        
                        long time_diff_29224 = time_end_29223 -
                             time_start_29222;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.seghist_local_27068", time_diff_29224);
                    }
                }
            }
        } else {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "## Using global memory");
            
            int64_t hist_H_28363;
            
            hist_H_28363 = res_24008;
            
            double hist_RF_28364;
            
            hist_RF_28364 = (0.0 + sitofp_i32_f64(1)) / 1.0;
            
            int32_t hist_el_sizze_28365;
            
            hist_el_sizze_28365 =
                squot32(sext_i64_i32((int32_t) sizeof(int32_t) +
                        (int32_t) sizeof(int64_t)), 2);
            
            double hist_C_max_28366;
            
            hist_C_max_28366 =
                fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_27065 *
                       seghist_group_sizze_27063)),
                       sitofp_i32_f64(hist_H_28363) / 2.0);
            
            int32_t hist_M_min_28367;
            
            hist_M_min_28367 = smax32(1,
                                      sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_27065 *
                                      seghist_group_sizze_27063)) /
                                      hist_C_max_28366)));
            
            int32_t L2_sizze_28368;
            
            L2_sizze_28368 = ctx->sizes.testziL2_sizze_28368;
            
            double hist_RACE_exp_28369;
            
            hist_RACE_exp_28369 = fmax64(1.0, 0.75 * hist_RF_28364 / (64.0 /
                                                                      sitofp_i32_f64(hist_el_sizze_28365)));
            
            int32_t hist_S_28370;
            
            if (slt64(binop_x_27755, hist_H_28363)) {
                hist_S_28370 = 1;
            } else {
                hist_S_28370 =
                    sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_min_28367) *
                                           hist_H_28363 *
                                           sext_i32_i64(hist_el_sizze_28365),
                                           fptosi_f64_i64(0.4 *
                                           sitofp_i32_f64(L2_sizze_28368) *
                                           hist_RACE_exp_28369)));
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %f%c", "Race expansion factor (RACE^exp)",
                        (double) hist_RACE_exp_28369, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                        (long long) hist_S_28370, '\n');
            
            int64_t hist_H_chk_28371;
            
            hist_H_chk_28371 = sdiv_up64(res_24008, sext_i32_i64(hist_S_28370));
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Chunk size (H_chk)",
                        (long long) hist_H_chk_28371, '\n');
            
            double hist_k_max_28372;
            
            hist_k_max_28372 = fmin64(0.4 * (sitofp_i32_f64(L2_sizze_28368) /
                                             sitofp_i32_f64(sext_i64_i32((int32_t) sizeof(int32_t) +
                                             (int32_t) sizeof(int64_t)))) *
                                      hist_RACE_exp_28369,
                                      sitofp_i32_f64(binop_x_27755)) /
                sitofp_i32_f64(sext_i64_i32(num_groups_27065 *
                seghist_group_sizze_27063));
            
            int64_t hist_u_28373;
            
            hist_u_28373 = 1;
            
            double hist_C_28374;
            
            hist_C_28374 = fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_27065 *
                                  seghist_group_sizze_27063)),
                                  sitofp_i32_f64(hist_u_28373 *
                                  hist_H_chk_28371) / hist_k_max_28372);
            
            int32_t hist_M_28375;
            
            hist_M_28375 = smax32(hist_M_min_28367,
                                  sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_27065 *
                                  seghist_group_sizze_27063)) / hist_C_28374)));
            if (ctx->debugging)
                fprintf(stderr, "%s: %f%c",
                        "Elements/thread in L2 cache (k_max)",
                        (double) hist_k_max_28372, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                        (long long) hist_M_28375, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %f%c", "Cooperation level (C)",
                        (double) hist_C_28374, '\n');
            num_subhistos_28305 = sext_i32_i64(hist_M_28375);
            if (hist_M_28375 == 1) {
                if (memblock_set_device(ctx, &res_subhistos_mem_28306,
                                        &mem_27810, "mem_27810") != 0)
                    return 1;
            } else {
                if (num_subhistos_28305 == 1) {
                    if (memblock_set_device(ctx, &res_subhistos_mem_28306,
                                            &mem_27810, "mem_27810") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &res_subhistos_mem_28306,
                                              sext_i32_i64(num_subhistos_28305) *
                                              res_24008 *
                                              (int32_t) sizeof(int64_t),
                                              "res_subhistos_mem_28306")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx,
                                                      res_subhistos_mem_28306,
                                                      num_subhistos_28305 *
                                                      res_24008, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (res_24008 * (int32_t) sizeof(int64_t) > 0) {
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                     mem_27810.mem,
                                                                     res_subhistos_mem_28306.mem,
                                                                     0, 0,
                                                                     res_24008 *
                                                                     (int32_t) sizeof(int64_t),
                                                                     0, NULL,
                                                                     ctx->profiling_paused ||
                                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
                        if (ctx->debugging)
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    }
                }
            }
            
            struct memblock_device testzihist_locks_mem_28376 =
                                   ctx->testzihist_locks_mem_28376;
            
            for (int32_t chk_i_28378 = 0; chk_i_28378 < hist_S_28370;
                 chk_i_28378++) {
                int64_t hist_H_chk_28379 = sdiv_up64(res_24008,
                                                     sext_i32_i64(hist_S_28370));
                
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27068,
                                                        1, sizeof(res_24008),
                                                        &res_24008));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27068,
                                                        2,
                                                        sizeof(num_groups_27065),
                                                        &num_groups_27065));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27068,
                                                        3,
                                                        sizeof(binop_x_27755),
                                                        &binop_x_27755));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27068,
                                                        4,
                                                        sizeof(mem_27803.mem),
                                                        &mem_27803.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27068,
                                                        5,
                                                        sizeof(num_subhistos_28305),
                                                        &num_subhistos_28305));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27068,
                                                        6,
                                                        sizeof(res_subhistos_mem_28306.mem),
                                                        &res_subhistos_mem_28306.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27068,
                                                        7,
                                                        sizeof(testzihist_locks_mem_28376.mem),
                                                        &testzihist_locks_mem_28376.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27068,
                                                        8, sizeof(chk_i_28378),
                                                        &chk_i_28378));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_27068,
                                                        9,
                                                        sizeof(hist_H_chk_28379),
                                                        &hist_H_chk_28379));
                if (1 * ((size_t) num_groups_27065 *
                         (size_t) seghist_group_sizze_27063) != 0) {
                    const size_t global_work_sizze_29227[1] =
                                 {(size_t) num_groups_27065 *
                                 (size_t) seghist_group_sizze_27063};
                    const size_t local_work_sizze_29231[1] =
                                 {seghist_group_sizze_27063};
                    int64_t time_start_29228 = 0, time_end_29229 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.seghist_global_27068");
                        fprintf(stderr, "%zu", global_work_sizze_29227[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29231[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_29228 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testziseghist_global_27068,
                                                                    1, NULL,
                                                                    global_work_sizze_29227,
                                                                    local_work_sizze_29231,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testziseghist_global_27068_runs,
                                                                                                              &ctx->testziseghist_global_27068_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29229 = get_wall_time();
                        
                        long time_diff_29230 = time_end_29229 -
                             time_start_29228;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.seghist_global_27068", time_diff_29230);
                    }
                }
            }
        }
        if (num_subhistos_28305 == 1) {
            if (memblock_set_device(ctx, &mem_27810, &res_subhistos_mem_28306,
                                    "res_subhistos_mem_28306") != 0)
                return 1;
        } else {
            if (slt64(num_subhistos_28305 * 2, seghist_group_sizze_27063)) {
                int64_t segment_sizze_nonzzero_28392 = smax64(1,
                                                              num_subhistos_28305);
                int64_t num_threads_28393 = num_groups_27065 *
                        seghist_group_sizze_27063;
                
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegRed-small");
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "num_segments",
                            (long long) res_24008, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "segment_size",
                            (long long) num_subhistos_28305, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "segments_per_group",
                            (long long) squot64(seghist_group_sizze_27063,
                                                segment_sizze_nonzzero_28392),
                            '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "required_groups",
                            (long long) sext_i64_i32(sdiv_up64(res_24008,
                                                               squot64(seghist_group_sizze_27063,
                                                                       segment_sizze_nonzzero_28392))),
                            '\n');
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28391,
                                                        1,
                                                        (int32_t) sizeof(int64_t) *
                                                        seghist_group_sizze_27063,
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28391,
                                                        2, sizeof(res_24008),
                                                        &res_24008));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28391,
                                                        3,
                                                        sizeof(num_groups_27065),
                                                        &num_groups_27065));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28391,
                                                        4,
                                                        sizeof(mem_27810.mem),
                                                        &mem_27810.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28391,
                                                        5,
                                                        sizeof(num_subhistos_28305),
                                                        &num_subhistos_28305));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28391,
                                                        6,
                                                        sizeof(res_subhistos_mem_28306.mem),
                                                        &res_subhistos_mem_28306.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28391,
                                                        7,
                                                        sizeof(segment_sizze_nonzzero_28392),
                                                        &segment_sizze_nonzzero_28392));
                if (1 * ((size_t) num_groups_27065 *
                         (size_t) seghist_group_sizze_27063) != 0) {
                    const size_t global_work_sizze_29232[1] =
                                 {(size_t) num_groups_27065 *
                                 (size_t) seghist_group_sizze_27063};
                    const size_t local_work_sizze_29236[1] =
                                 {seghist_group_sizze_27063};
                    int64_t time_start_29233 = 0, time_end_29234 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.segred_small_28391");
                        fprintf(stderr, "%zu", global_work_sizze_29232[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29236[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(int64_t) *
                                       seghist_group_sizze_27063));
                        time_start_29233 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testzisegred_small_28391,
                                                                    1, NULL,
                                                                    global_work_sizze_29232,
                                                                    local_work_sizze_29236,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testzisegred_small_28391_runs,
                                                                                                              &ctx->testzisegred_small_28391_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29234 = get_wall_time();
                        
                        long time_diff_29235 = time_end_29234 -
                             time_start_29233;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.segred_small_28391", time_diff_29235);
                    }
                }
            } else {
                int64_t groups_per_segment_28413 = sdiv_up64(num_groups_27065,
                                                             smax64(1,
                                                                    res_24008));
                int64_t elements_per_thread_28414 =
                        sdiv_up64(num_subhistos_28305,
                                  seghist_group_sizze_27063 *
                                  groups_per_segment_28413);
                int64_t virt_num_groups_28415 = groups_per_segment_28413 *
                        res_24008;
                int64_t num_threads_28416 = num_groups_27065 *
                        seghist_group_sizze_27063;
                int64_t threads_per_segment_28417 = groups_per_segment_28413 *
                        seghist_group_sizze_27063;
                
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegRed-large");
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "num_segments",
                            (long long) res_24008, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "segment_size",
                            (long long) num_subhistos_28305, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                            (long long) virt_num_groups_28415, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "num_groups",
                            (long long) num_groups_27065, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "group_size",
                            (long long) seghist_group_sizze_27063, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                            (long long) elements_per_thread_28414, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                            (long long) groups_per_segment_28413, '\n');
                
                struct memblock_device group_res_arr_mem_28418;
                
                group_res_arr_mem_28418.references = NULL;
                if (memblock_alloc_device(ctx, &group_res_arr_mem_28418,
                                          (int32_t) sizeof(int64_t) *
                                          (seghist_group_sizze_27063 *
                                           virt_num_groups_28415),
                                          "group_res_arr_mem_28418")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device testzicounter_mem_28420 =
                                       ctx->testzicounter_mem_28420;
                
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28391,
                                                        1,
                                                        (int32_t) sizeof(bool),
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28391,
                                                        2,
                                                        (int32_t) sizeof(int64_t) *
                                                        seghist_group_sizze_27063,
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28391,
                                                        3, sizeof(res_24008),
                                                        &res_24008));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28391,
                                                        4,
                                                        sizeof(num_groups_27065),
                                                        &num_groups_27065));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28391,
                                                        5,
                                                        sizeof(mem_27810.mem),
                                                        &mem_27810.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28391,
                                                        6,
                                                        sizeof(num_subhistos_28305),
                                                        &num_subhistos_28305));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28391,
                                                        7,
                                                        sizeof(res_subhistos_mem_28306.mem),
                                                        &res_subhistos_mem_28306.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28391,
                                                        8,
                                                        sizeof(groups_per_segment_28413),
                                                        &groups_per_segment_28413));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28391,
                                                        9,
                                                        sizeof(elements_per_thread_28414),
                                                        &elements_per_thread_28414));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28391,
                                                        10,
                                                        sizeof(virt_num_groups_28415),
                                                        &virt_num_groups_28415));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28391,
                                                        11,
                                                        sizeof(threads_per_segment_28417),
                                                        &threads_per_segment_28417));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28391,
                                                        12,
                                                        sizeof(group_res_arr_mem_28418.mem),
                                                        &group_res_arr_mem_28418.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28391,
                                                        13,
                                                        sizeof(testzicounter_mem_28420.mem),
                                                        &testzicounter_mem_28420.mem));
                if (1 * ((size_t) num_groups_27065 *
                         (size_t) seghist_group_sizze_27063) != 0) {
                    const size_t global_work_sizze_29238[1] =
                                 {(size_t) num_groups_27065 *
                                 (size_t) seghist_group_sizze_27063};
                    const size_t local_work_sizze_29242[1] =
                                 {seghist_group_sizze_27063};
                    int64_t time_start_29239 = 0, time_end_29240 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.segred_large_28391");
                        fprintf(stderr, "%zu", global_work_sizze_29238[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29242[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(bool) +
                                       (int32_t) sizeof(int64_t) *
                                       seghist_group_sizze_27063));
                        time_start_29239 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testzisegred_large_28391,
                                                                    1, NULL,
                                                                    global_work_sizze_29238,
                                                                    local_work_sizze_29242,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testzisegred_large_28391_runs,
                                                                                                              &ctx->testzisegred_large_28391_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29240 = get_wall_time();
                        
                        long time_diff_29241 = time_end_29240 -
                             time_start_29239;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.segred_large_28391", time_diff_29241);
                    }
                }
                if (memblock_unref_device(ctx, &group_res_arr_mem_28418,
                                          "group_res_arr_mem_28418") != 0)
                    return 1;
            }
        }
    }
    if (memblock_unref_device(ctx, &mem_27803, "mem_27803") != 0)
        return 1;
    
    int64_t segscan_group_sizze_27078;
    
    segscan_group_sizze_27078 = ctx->sizes.testzisegscan_group_sizze_27077;
    
    int64_t num_groups_27080;
    int32_t max_num_groups_28452;
    
    max_num_groups_28452 = ctx->sizes.testzisegscan_num_groups_27079;
    num_groups_27080 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_24008,
                                                               sext_i32_i64(segscan_group_sizze_27078)),
                                                     sext_i32_i64(max_num_groups_28452))));
    
    struct memblock_device mem_27814;
    
    mem_27814.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27814, res_24008, "mem_27814")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27816;
    
    mem_27816.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27816, bytes_27809, "mem_27816")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_24008)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28453;
        
        stage1_max_num_groups_28453 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28454;
        
        stage1_num_groups_28454 = smin64(stage1_max_num_groups_28453,
                                         num_groups_27080);
        
        int32_t num_threads_28455;
        
        num_threads_28455 = sext_i64_i32(stage1_num_groups_28454 *
            segscan_group_sizze_27078);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27083, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_27078),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27083, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       segscan_group_sizze_27078),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27083, 3,
                                                sizeof(res_24008), &res_24008));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27083, 4,
                                                sizeof(mem_27810.mem),
                                                &mem_27810.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27083, 5,
                                                sizeof(mem_27814.mem),
                                                &mem_27814.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27083, 6,
                                                sizeof(mem_27816.mem),
                                                &mem_27816.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27083, 7,
                                                sizeof(num_threads_28455),
                                                &num_threads_28455));
        if (1 * ((size_t) stage1_num_groups_28454 *
                 (size_t) segscan_group_sizze_27078) != 0) {
            const size_t global_work_sizze_29243[1] =
                         {(size_t) stage1_num_groups_28454 *
                         (size_t) segscan_group_sizze_27078};
            const size_t local_work_sizze_29247[1] =
                         {segscan_group_sizze_27078};
            int64_t time_start_29244 = 0, time_end_29245 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage1_27083");
                fprintf(stderr, "%zu", global_work_sizze_29243[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29247[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_27078) + smax64(1,
                                                                              (int32_t) sizeof(bool) *
                                                                              segscan_group_sizze_27078)));
                time_start_29244 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage1_27083,
                                                            1, NULL,
                                                            global_work_sizze_29243,
                                                            local_work_sizze_29247,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage1_27083_runs,
                                                                                                      &ctx->testziscan_stage1_27083_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29245 = get_wall_time();
                
                long time_diff_29246 = time_end_29245 - time_start_29244;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage1_27083", time_diff_29246);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_27078 *
                                 sdiv_up64(res_24008,
                                           sext_i32_i64(num_threads_28455))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27083, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_28454),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27083, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       stage1_num_groups_28454),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27083, 3,
                                                sizeof(res_24008), &res_24008));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27083, 4,
                                                sizeof(mem_27814.mem),
                                                &mem_27814.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27083, 5,
                                                sizeof(mem_27816.mem),
                                                &mem_27816.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27083, 6,
                                                sizeof(stage1_num_groups_28454),
                                                &stage1_num_groups_28454));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27083, 7,
                                                sizeof(num_threads_28455),
                                                &num_threads_28455));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28454) != 0) {
            const size_t global_work_sizze_29248[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28454};
            const size_t local_work_sizze_29252[1] = {stage1_num_groups_28454};
            int64_t time_start_29249 = 0, time_end_29250 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage2_27083");
                fprintf(stderr, "%zu", global_work_sizze_29248[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29252[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_28454) + smax64(1,
                                                                            (int32_t) sizeof(bool) *
                                                                            stage1_num_groups_28454)));
                time_start_29249 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage2_27083,
                                                            1, NULL,
                                                            global_work_sizze_29248,
                                                            local_work_sizze_29252,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage2_27083_runs,
                                                                                                      &ctx->testziscan_stage2_27083_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29250 = get_wall_time();
                
                long time_diff_29251 = time_end_29250 - time_start_29249;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage2_27083", time_diff_29251);
            }
        }
        
        int32_t required_groups_28507;
        
        required_groups_28507 = sext_i64_i32(sdiv_up64(res_24008,
                                                       segscan_group_sizze_27078));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27083, 1,
                                                sizeof(res_24008), &res_24008));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27083, 2,
                                                sizeof(num_groups_27080),
                                                &num_groups_27080));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27083, 3,
                                                sizeof(mem_27814.mem),
                                                &mem_27814.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27083, 4,
                                                sizeof(mem_27816.mem),
                                                &mem_27816.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27083, 5,
                                                sizeof(num_threads_28455),
                                                &num_threads_28455));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27083, 6,
                                                sizeof(required_groups_28507),
                                                &required_groups_28507));
        if (1 * ((size_t) num_groups_27080 *
                 (size_t) segscan_group_sizze_27078) != 0) {
            const size_t global_work_sizze_29253[1] =
                         {(size_t) num_groups_27080 *
                         (size_t) segscan_group_sizze_27078};
            const size_t local_work_sizze_29257[1] =
                         {segscan_group_sizze_27078};
            int64_t time_start_29254 = 0, time_end_29255 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage3_27083");
                fprintf(stderr, "%zu", global_work_sizze_29253[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29257[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29254 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage3_27083,
                                                            1, NULL,
                                                            global_work_sizze_29253,
                                                            local_work_sizze_29257,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage3_27083_runs,
                                                                                                      &ctx->testziscan_stage3_27083_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29255 = get_wall_time();
                
                long time_diff_29256 = time_end_29255 - time_start_29254;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage3_27083", time_diff_29256);
            }
        }
    }
    if (memblock_unref_device(ctx, &mem_27810, "mem_27810") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27814, "mem_27814") != 0)
        return 1;
    
    int64_t segscan_group_sizze_27086;
    
    segscan_group_sizze_27086 = ctx->sizes.testzisegscan_group_sizze_27085;
    
    int64_t num_groups_27088;
    int32_t max_num_groups_28519;
    
    max_num_groups_28519 = ctx->sizes.testzisegscan_num_groups_27087;
    num_groups_27088 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_24008,
                                                               sext_i32_i64(segscan_group_sizze_27086)),
                                                     sext_i32_i64(max_num_groups_28519))));
    
    struct memblock_device mem_27819;
    
    mem_27819.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27819, res_24008, "mem_27819")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27821;
    
    mem_27821.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27821, bytes_27809, "mem_27821")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_27823;
    
    mem_27823.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27823, res_24008, "mem_27823")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_24008)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28520;
        
        stage1_max_num_groups_28520 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28521;
        
        stage1_num_groups_28521 = smin64(stage1_max_num_groups_28520,
                                         num_groups_27088);
        
        int32_t num_threads_28522;
        
        num_threads_28522 = sext_i64_i32(stage1_num_groups_28521 *
            segscan_group_sizze_27086);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27091, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_27086),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27091, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       segscan_group_sizze_27086),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27091, 3,
                                                sizeof(res_24008), &res_24008));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27091, 4,
                                                sizeof(mem_27816.mem),
                                                &mem_27816.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27091, 5,
                                                sizeof(mem_27819.mem),
                                                &mem_27819.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27091, 6,
                                                sizeof(mem_27821.mem),
                                                &mem_27821.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27091, 7,
                                                sizeof(mem_27823.mem),
                                                &mem_27823.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27091, 8,
                                                sizeof(num_threads_28522),
                                                &num_threads_28522));
        if (1 * ((size_t) stage1_num_groups_28521 *
                 (size_t) segscan_group_sizze_27086) != 0) {
            const size_t global_work_sizze_29258[1] =
                         {(size_t) stage1_num_groups_28521 *
                         (size_t) segscan_group_sizze_27086};
            const size_t local_work_sizze_29262[1] =
                         {segscan_group_sizze_27086};
            int64_t time_start_29259 = 0, time_end_29260 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage1_27091");
                fprintf(stderr, "%zu", global_work_sizze_29258[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29262[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_27086) + smax64(1,
                                                                              (int32_t) sizeof(bool) *
                                                                              segscan_group_sizze_27086)));
                time_start_29259 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage1_27091,
                                                            1, NULL,
                                                            global_work_sizze_29258,
                                                            local_work_sizze_29262,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage1_27091_runs,
                                                                                                      &ctx->testziscan_stage1_27091_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29260 = get_wall_time();
                
                long time_diff_29261 = time_end_29260 - time_start_29259;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage1_27091", time_diff_29261);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_27086 *
                                 sdiv_up64(res_24008,
                                           sext_i32_i64(num_threads_28522))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27091, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_28521),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27091, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       stage1_num_groups_28521),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27091, 3,
                                                sizeof(res_24008), &res_24008));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27091, 4,
                                                sizeof(mem_27819.mem),
                                                &mem_27819.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27091, 5,
                                                sizeof(mem_27821.mem),
                                                &mem_27821.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27091, 6,
                                                sizeof(stage1_num_groups_28521),
                                                &stage1_num_groups_28521));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27091, 7,
                                                sizeof(num_threads_28522),
                                                &num_threads_28522));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28521) != 0) {
            const size_t global_work_sizze_29263[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28521};
            const size_t local_work_sizze_29267[1] = {stage1_num_groups_28521};
            int64_t time_start_29264 = 0, time_end_29265 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage2_27091");
                fprintf(stderr, "%zu", global_work_sizze_29263[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29267[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_28521) + smax64(1,
                                                                            (int32_t) sizeof(bool) *
                                                                            stage1_num_groups_28521)));
                time_start_29264 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage2_27091,
                                                            1, NULL,
                                                            global_work_sizze_29263,
                                                            local_work_sizze_29267,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage2_27091_runs,
                                                                                                      &ctx->testziscan_stage2_27091_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29265 = get_wall_time();
                
                long time_diff_29266 = time_end_29265 - time_start_29264;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage2_27091", time_diff_29266);
            }
        }
        
        int32_t required_groups_28574;
        
        required_groups_28574 = sext_i64_i32(sdiv_up64(res_24008,
                                                       segscan_group_sizze_27086));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27091, 1,
                                                sizeof(res_24008), &res_24008));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27091, 2,
                                                sizeof(num_groups_27088),
                                                &num_groups_27088));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27091, 3,
                                                sizeof(mem_27819.mem),
                                                &mem_27819.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27091, 4,
                                                sizeof(mem_27821.mem),
                                                &mem_27821.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27091, 5,
                                                sizeof(num_threads_28522),
                                                &num_threads_28522));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27091, 6,
                                                sizeof(required_groups_28574),
                                                &required_groups_28574));
        if (1 * ((size_t) num_groups_27088 *
                 (size_t) segscan_group_sizze_27086) != 0) {
            const size_t global_work_sizze_29268[1] =
                         {(size_t) num_groups_27088 *
                         (size_t) segscan_group_sizze_27086};
            const size_t local_work_sizze_29272[1] =
                         {segscan_group_sizze_27086};
            int64_t time_start_29269 = 0, time_end_29270 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage3_27091");
                fprintf(stderr, "%zu", global_work_sizze_29268[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29272[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29269 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage3_27091,
                                                            1, NULL,
                                                            global_work_sizze_29268,
                                                            local_work_sizze_29272,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage3_27091_runs,
                                                                                                      &ctx->testziscan_stage3_27091_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29270 = get_wall_time();
                
                long time_diff_29271 = time_end_29270 - time_start_29269;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage3_27091", time_diff_29271);
            }
        }
    }
    if (memblock_unref_device(ctx, &mem_27819, "mem_27819") != 0)
        return 1;
    
    int64_t segscan_group_sizze_27094;
    
    segscan_group_sizze_27094 = ctx->sizes.testzisegscan_group_sizze_27093;
    
    int64_t num_groups_27096;
    int32_t max_num_groups_28586;
    
    max_num_groups_28586 = ctx->sizes.testzisegscan_num_groups_27095;
    num_groups_27096 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_24008,
                                                               sext_i32_i64(segscan_group_sizze_27094)),
                                                     sext_i32_i64(max_num_groups_28586))));
    
    struct memblock_device mem_27826;
    
    mem_27826.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27826, res_24008, "mem_27826")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_27827 = 4 * res_24008;
    struct memblock_device mem_27828;
    
    mem_27828.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27828, bytes_27827, "mem_27828")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_24008)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28587;
        
        stage1_max_num_groups_28587 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28588;
        
        stage1_num_groups_28588 = smin64(stage1_max_num_groups_28587,
                                         num_groups_27096);
        
        int32_t num_threads_28589;
        
        num_threads_28589 = sext_i64_i32(stage1_num_groups_28588 *
            segscan_group_sizze_27094);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099, 3,
                                                smax64(1,
                                                       (int32_t) sizeof(float) *
                                                       segscan_group_sizze_27094),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099, 4,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       segscan_group_sizze_27094),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099, 5,
                                                sizeof(steps_23808),
                                                &steps_23808));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099, 6,
                                                sizeof(res_24008), &res_24008));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099, 7,
                                                sizeof(one_intra_par_min_26359),
                                                &one_intra_par_min_26359));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099, 8,
                                                sizeof(res_mem_27723.mem),
                                                &res_mem_27723.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099, 9,
                                                sizeof(res_mem_27724.mem),
                                                &res_mem_27724.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099,
                                                10, sizeof(res_mem_27725.mem),
                                                &res_mem_27725.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099,
                                                11, sizeof(res_mem_27726.mem),
                                                &res_mem_27726.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099,
                                                12, sizeof(binop_x_27755),
                                                &binop_x_27755));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099,
                                                13, sizeof(res_mem_27799.mem),
                                                &res_mem_27799.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099,
                                                14, sizeof(res_mem_27800.mem),
                                                &res_mem_27800.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099,
                                                15, sizeof(mem_27816.mem),
                                                &mem_27816.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099,
                                                16, sizeof(mem_27821.mem),
                                                &mem_27821.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099,
                                                17, sizeof(mem_27823.mem),
                                                &mem_27823.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099,
                                                18, sizeof(mem_27826.mem),
                                                &mem_27826.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099,
                                                19, sizeof(mem_27828.mem),
                                                &mem_27828.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27099,
                                                20, sizeof(num_threads_28589),
                                                &num_threads_28589));
        if (1 * ((size_t) stage1_num_groups_28588 *
                 (size_t) segscan_group_sizze_27094) != 0) {
            const size_t global_work_sizze_29273[1] =
                         {(size_t) stage1_num_groups_28588 *
                         (size_t) segscan_group_sizze_27094};
            const size_t local_work_sizze_29277[1] =
                         {segscan_group_sizze_27094};
            int64_t time_start_29274 = 0, time_end_29275 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage1_27099");
                fprintf(stderr, "%zu", global_work_sizze_29273[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29277[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                          segscan_group_sizze_27094) + smax64(1,
                                                                              (int32_t) sizeof(bool) *
                                                                              segscan_group_sizze_27094)));
                time_start_29274 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage1_27099,
                                                            1, NULL,
                                                            global_work_sizze_29273,
                                                            local_work_sizze_29277,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage1_27099_runs,
                                                                                                      &ctx->testziscan_stage1_27099_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29275 = get_wall_time();
                
                long time_diff_29276 = time_end_29275 - time_start_29274;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage1_27099", time_diff_29276);
            }
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_27094 *
                                 sdiv_up64(res_24008,
                                           sext_i32_i64(num_threads_28589))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27099, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(float) *
                                                       stage1_num_groups_28588),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27099, 2,
                                                smax64(1,
                                                       (int32_t) sizeof(bool) *
                                                       stage1_num_groups_28588),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27099, 3,
                                                sizeof(res_24008), &res_24008));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27099, 4,
                                                sizeof(mem_27826.mem),
                                                &mem_27826.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27099, 5,
                                                sizeof(mem_27828.mem),
                                                &mem_27828.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27099, 6,
                                                sizeof(stage1_num_groups_28588),
                                                &stage1_num_groups_28588));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27099, 7,
                                                sizeof(num_threads_28589),
                                                &num_threads_28589));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28588) != 0) {
            const size_t global_work_sizze_29278[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28588};
            const size_t local_work_sizze_29282[1] = {stage1_num_groups_28588};
            int64_t time_start_29279 = 0, time_end_29280 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage2_27099");
                fprintf(stderr, "%zu", global_work_sizze_29278[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29282[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                          stage1_num_groups_28588) + smax64(1,
                                                                            (int32_t) sizeof(bool) *
                                                                            stage1_num_groups_28588)));
                time_start_29279 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage2_27099,
                                                            1, NULL,
                                                            global_work_sizze_29278,
                                                            local_work_sizze_29282,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage2_27099_runs,
                                                                                                      &ctx->testziscan_stage2_27099_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29280 = get_wall_time();
                
                long time_diff_29281 = time_end_29280 - time_start_29279;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage2_27099", time_diff_29281);
            }
        }
        
        int32_t required_groups_28641;
        
        required_groups_28641 = sext_i64_i32(sdiv_up64(res_24008,
                                                       segscan_group_sizze_27094));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27099, 1,
                                                sizeof(res_24008), &res_24008));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27099, 2,
                                                sizeof(num_groups_27096),
                                                &num_groups_27096));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27099, 3,
                                                sizeof(mem_27826.mem),
                                                &mem_27826.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27099, 4,
                                                sizeof(mem_27828.mem),
                                                &mem_27828.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27099, 5,
                                                sizeof(num_threads_28589),
                                                &num_threads_28589));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27099, 6,
                                                sizeof(required_groups_28641),
                                                &required_groups_28641));
        if (1 * ((size_t) num_groups_27096 *
                 (size_t) segscan_group_sizze_27094) != 0) {
            const size_t global_work_sizze_29283[1] =
                         {(size_t) num_groups_27096 *
                         (size_t) segscan_group_sizze_27094};
            const size_t local_work_sizze_29287[1] =
                         {segscan_group_sizze_27094};
            int64_t time_start_29284 = 0, time_end_29285 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage3_27099");
                fprintf(stderr, "%zu", global_work_sizze_29283[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29287[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29284 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage3_27099,
                                                            1, NULL,
                                                            global_work_sizze_29283,
                                                            local_work_sizze_29287,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage3_27099_runs,
                                                                                                      &ctx->testziscan_stage3_27099_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29285 = get_wall_time();
                
                long time_diff_29286 = time_end_29285 - time_start_29284;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage3_27099", time_diff_29286);
            }
        }
    }
    if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27724, "res_mem_27724") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27725, "res_mem_27725") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27726, "res_mem_27726") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27799, "res_mem_27799") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27800, "res_mem_27800") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27816, "mem_27816") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27821, "mem_27821") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27826, "mem_27826") != 0)
        return 1;
    
    int64_t segscan_group_sizze_27146;
    
    segscan_group_sizze_27146 = ctx->sizes.testzisegscan_group_sizze_27145;
    
    int64_t num_groups_27148;
    int32_t max_num_groups_28653;
    
    max_num_groups_28653 = ctx->sizes.testzisegscan_num_groups_27147;
    num_groups_27148 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_24008,
                                                               sext_i32_i64(segscan_group_sizze_27146)),
                                                     sext_i32_i64(max_num_groups_28653))));
    
    struct memblock_device mem_27831;
    
    mem_27831.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27831, bytes_27809, "mem_27831")) {
        err = 1;
        goto cleanup;
    }
    if (slt64(0, res_24008)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t stage1_max_num_groups_28654;
        
        stage1_max_num_groups_28654 = ctx->opencl.max_group_size;
        
        int64_t stage1_num_groups_28655;
        
        stage1_num_groups_28655 = smin64(stage1_max_num_groups_28654,
                                         num_groups_27148);
        
        int32_t num_threads_28656;
        
        num_threads_28656 = sext_i64_i32(stage1_num_groups_28655 *
            segscan_group_sizze_27146);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27151, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       segscan_group_sizze_27146),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27151, 2,
                                                sizeof(res_24008), &res_24008));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27151, 3,
                                                sizeof(mem_27823.mem),
                                                &mem_27823.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27151, 4,
                                                sizeof(mem_27831.mem),
                                                &mem_27831.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_27151, 5,
                                                sizeof(num_threads_28656),
                                                &num_threads_28656));
        if (1 * ((size_t) stage1_num_groups_28655 *
                 (size_t) segscan_group_sizze_27146) != 0) {
            const size_t global_work_sizze_29288[1] =
                         {(size_t) stage1_num_groups_28655 *
                         (size_t) segscan_group_sizze_27146};
            const size_t local_work_sizze_29292[1] =
                         {segscan_group_sizze_27146};
            int64_t time_start_29289 = 0, time_end_29290 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage1_27151");
                fprintf(stderr, "%zu", global_work_sizze_29288[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29292[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          segscan_group_sizze_27146)));
                time_start_29289 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage1_27151,
                                                            1, NULL,
                                                            global_work_sizze_29288,
                                                            local_work_sizze_29292,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage1_27151_runs,
                                                                                                      &ctx->testziscan_stage1_27151_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29290 = get_wall_time();
                
                long time_diff_29291 = time_end_29290 - time_start_29289;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage1_27151", time_diff_29291);
            }
        }
        if (ctx->debugging)
            fprintf(stderr, "%s: %llu%c", "elems_per_group",
                    (long long) (segscan_group_sizze_27146 *
                                 sdiv_up64(res_24008,
                                           sext_i32_i64(num_threads_28656))),
                    '\n');
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27151, 1,
                                                smax64(1,
                                                       (int32_t) sizeof(int64_t) *
                                                       stage1_num_groups_28655),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27151, 2,
                                                sizeof(res_24008), &res_24008));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27151, 3,
                                                sizeof(mem_27831.mem),
                                                &mem_27831.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27151, 4,
                                                sizeof(stage1_num_groups_28655),
                                                &stage1_num_groups_28655));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_27151, 5,
                                                sizeof(num_threads_28656),
                                                &num_threads_28656));
        if (1 * ((size_t) 1 * (size_t) stage1_num_groups_28655) != 0) {
            const size_t global_work_sizze_29293[1] = {(size_t) 1 *
                         (size_t) stage1_num_groups_28655};
            const size_t local_work_sizze_29297[1] = {stage1_num_groups_28655};
            int64_t time_start_29294 = 0, time_end_29295 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage2_27151");
                fprintf(stderr, "%zu", global_work_sizze_29293[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29297[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                          stage1_num_groups_28655)));
                time_start_29294 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage2_27151,
                                                            1, NULL,
                                                            global_work_sizze_29293,
                                                            local_work_sizze_29297,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage2_27151_runs,
                                                                                                      &ctx->testziscan_stage2_27151_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29295 = get_wall_time();
                
                long time_diff_29296 = time_end_29295 - time_start_29294;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage2_27151", time_diff_29296);
            }
        }
        
        int32_t required_groups_28692;
        
        required_groups_28692 = sext_i64_i32(sdiv_up64(res_24008,
                                                       segscan_group_sizze_27146));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27151, 1,
                                                sizeof(res_24008), &res_24008));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27151, 2,
                                                sizeof(num_groups_27148),
                                                &num_groups_27148));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27151, 3,
                                                sizeof(mem_27831.mem),
                                                &mem_27831.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27151, 4,
                                                sizeof(num_threads_28656),
                                                &num_threads_28656));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_27151, 5,
                                                sizeof(required_groups_28692),
                                                &required_groups_28692));
        if (1 * ((size_t) num_groups_27148 *
                 (size_t) segscan_group_sizze_27146) != 0) {
            const size_t global_work_sizze_29298[1] =
                         {(size_t) num_groups_27148 *
                         (size_t) segscan_group_sizze_27146};
            const size_t local_work_sizze_29302[1] =
                         {segscan_group_sizze_27146};
            int64_t time_start_29299 = 0, time_end_29300 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.scan_stage3_27151");
                fprintf(stderr, "%zu", global_work_sizze_29298[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29302[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29299 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testziscan_stage3_27151,
                                                            1, NULL,
                                                            global_work_sizze_29298,
                                                            local_work_sizze_29302,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testziscan_stage3_27151_runs,
                                                                                                      &ctx->testziscan_stage3_27151_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29300 = get_wall_time();
                
                long time_diff_29301 = time_end_29300 - time_start_29299;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.scan_stage3_27151", time_diff_29301);
            }
        }
    }
    
    bool cond_24199 = slt64(0, res_24008);
    int64_t num_segments_24200;
    
    if (cond_24199) {
        int64_t i_24201 = sub64(res_24008, 1);
        bool x_24202 = sle64(0, i_24201);
        bool y_24203 = slt64(i_24201, res_24008);
        bool bounds_check_24204 = x_24202 && y_24203;
        bool index_certs_24205;
        
        if (!bounds_check_24204) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_24201,
                                   "] out of bounds for array of shape [",
                                   res_24008, "].",
                                   "-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:29:36-59\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #4  cva2.fut:134:18-77\n   #5  cva2.fut:162:3-120\n   #6  cva2.fut:161:1-162:128\n");
            if (memblock_unref_device(ctx, &mem_27831, "mem_27831") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27828, "mem_27828") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27826, "mem_27826") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27823, "mem_27823") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27821, "mem_27821") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27819, "mem_27819") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27816, "mem_27816") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27814, "mem_27814") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_subhistos_mem_28306,
                                      "res_subhistos_mem_28306") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27810, "mem_27810") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28267,
                                      "group_res_arr_mem_28267") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27808, "mem_27808") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27805, "mem_27805") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27803, "mem_27803") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27800, "res_mem_27800") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27799, "res_mem_27799") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27726, "res_mem_27726") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27725, "res_mem_27725") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27724, "res_mem_27724") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_28065,
                                      "group_res_arr_mem_28065") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27676, "mem_27676") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27671, "mem_27671") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27669, "mem_27669") != 0)
                return 1;
            return 1;
        }
        
        int64_t read_res_29303;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27831.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     i_24201 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_29303, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t res_24206 = read_res_29303;
        
        num_segments_24200 = res_24206;
    } else {
        num_segments_24200 = 0;
    }
    
    bool bounds_invalid_upwards_24207 = slt64(num_segments_24200, 0);
    bool valid_24208 = !bounds_invalid_upwards_24207;
    bool range_valid_c_24209;
    
    if (!valid_24208) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", num_segments_24200,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:33:17-41\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva2.fut:134:18-77\n   #6  cva2.fut:162:3-120\n   #7  cva2.fut:161:1-162:128\n");
        if (memblock_unref_device(ctx, &mem_27831, "mem_27831") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27828, "mem_27828") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27826, "mem_27826") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27823, "mem_27823") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27821, "mem_27821") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27819, "mem_27819") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27816, "mem_27816") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27814, "mem_27814") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_subhistos_mem_28306,
                                  "res_subhistos_mem_28306") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27810, "mem_27810") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28267,
                                  "group_res_arr_mem_28267") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27808, "mem_27808") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27805, "mem_27805") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27803, "mem_27803") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27800, "res_mem_27800") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27799, "res_mem_27799") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27726, "res_mem_27726") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27725, "res_mem_27725") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27724, "res_mem_27724") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28065,
                                  "group_res_arr_mem_28065") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27676, "mem_27676") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27671, "mem_27671") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27669, "mem_27669") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_27832 = 4 * num_segments_24200;
    struct memblock_device mem_27833;
    
    mem_27833.references = NULL;
    if (memblock_alloc_device(ctx, &mem_27833, bytes_27832, "mem_27833")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f32(ctx, mem_27833, num_segments_24200,
                                      0.0F) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_27156;
    
    segmap_group_sizze_27156 = ctx->sizes.testzisegmap_group_sizze_27155;
    
    int64_t segmap_usable_groups_27157 = sdiv_up64(res_24008,
                                                   segmap_group_sizze_27156);
    
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27153, 1,
                                            sizeof(res_24008), &res_24008));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27153, 2,
                                            sizeof(num_segments_24200),
                                            &num_segments_24200));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27153, 3,
                                            sizeof(mem_27823.mem),
                                            &mem_27823.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27153, 4,
                                            sizeof(mem_27828.mem),
                                            &mem_27828.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27153, 5,
                                            sizeof(mem_27831.mem),
                                            &mem_27831.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27153, 6,
                                            sizeof(mem_27833.mem),
                                            &mem_27833.mem));
    if (1 * ((size_t) segmap_usable_groups_27157 *
             (size_t) segmap_group_sizze_27156) != 0) {
        const size_t global_work_sizze_29304[1] =
                     {(size_t) segmap_usable_groups_27157 *
                     (size_t) segmap_group_sizze_27156};
        const size_t local_work_sizze_29308[1] = {segmap_group_sizze_27156};
        int64_t time_start_29305 = 0, time_end_29306 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segmap_27153");
            fprintf(stderr, "%zu", global_work_sizze_29304[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_29308[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_29305 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegmap_27153,
                                                        1, NULL,
                                                        global_work_sizze_29304,
                                                        local_work_sizze_29308,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegmap_27153_runs,
                                                                                                  &ctx->testzisegmap_27153_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_29306 = get_wall_time();
            
            long time_diff_29307 = time_end_29306 - time_start_29305;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "test.segmap_27153",
                    time_diff_29307);
        }
    }
    if (memblock_unref_device(ctx, &mem_27823, "mem_27823") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27828, "mem_27828") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27831, "mem_27831") != 0)
        return 1;
    
    bool dim_match_24217 = binop_x_27755 == num_segments_24200;
    bool empty_or_match_cert_24218;
    
    if (!dim_match_24217) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Value of (core language) shape (",
                               num_segments_24200,
                               ") cannot match shape of type `[", binop_x_27755,
                               "]b`.",
                               "-> #0  lib/github.com/diku-dk/segmented/segmented.fut:103:6-45\n   #1  cva2.fut:134:18-77\n   #2  cva2.fut:162:3-120\n   #3  cva2.fut:161:1-162:128\n");
        if (memblock_unref_device(ctx, &mem_27833, "mem_27833") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27831, "mem_27831") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27828, "mem_27828") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27826, "mem_27826") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27823, "mem_27823") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27821, "mem_27821") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27819, "mem_27819") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27816, "mem_27816") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27814, "mem_27814") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_subhistos_mem_28306,
                                  "res_subhistos_mem_28306") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27810, "mem_27810") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28267,
                                  "group_res_arr_mem_28267") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27808, "mem_27808") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27805, "mem_27805") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27803, "mem_27803") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27800, "res_mem_27800") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27799, "res_mem_27799") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27726, "res_mem_27726") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27725, "res_mem_27725") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27724, "res_mem_27724") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28065,
                                  "group_res_arr_mem_28065") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27676, "mem_27676") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27671, "mem_27671") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27669, "mem_27669") != 0)
            return 1;
        return 1;
    }
    
    float res_24219 = sitofp_i64_f32(paths_23807);
    bool suff_outer_redomap_27159;
    
    suff_outer_redomap_27159 = ctx->sizes.testzisuff_outer_redomap_10 <=
        steps_23808;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_outer_redomap_10",
                steps_23808);
    
    int64_t segred_group_sizze_27171;
    
    segred_group_sizze_27171 = ctx->sizes.testzisegred_group_sizze_27161;
    
    int64_t num_groups_27172;
    int32_t max_num_groups_28718;
    
    max_num_groups_28718 = ctx->sizes.testzisegred_num_groups_27163;
    num_groups_27172 = sext_i64_i32(smax64(1, smin64(sdiv_up64(steps_23808,
                                                               sext_i32_i64(segred_group_sizze_27171)),
                                                     sext_i32_i64(max_num_groups_28718))));
    
    bool suff_outer_par_27392;
    
    suff_outer_par_27392 = ctx->sizes.testzisuff_outer_par_11 <= steps_23808;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_outer_par_11",
                steps_23808);
    
    int64_t segmap_group_sizze_27395;
    
    segmap_group_sizze_27395 = ctx->sizes.testzisegmap_group_sizze_27218;
    
    int64_t segred_group_sizze_27432;
    
    segred_group_sizze_27432 = ctx->sizes.testzisegred_group_sizze_27320;
    
    int64_t num_groups_27433;
    int32_t max_num_groups_28719;
    
    max_num_groups_28719 = ctx->sizes.testzisegred_num_groups_27322;
    num_groups_27433 = sext_i64_i32(smax64(1, smin64(sdiv_up64(nest_sizze_26923,
                                                               sext_i32_i64(segred_group_sizze_27432)),
                                                     sext_i32_i64(max_num_groups_28719))));
    
    int64_t segmap_group_sizze_27448;
    
    segmap_group_sizze_27448 = ctx->sizes.testzisegmap_group_sizze_27293;
    
    int64_t segred_group_sizze_27474;
    
    segred_group_sizze_27474 = ctx->sizes.testzisegred_group_sizze_27382;
    
    int64_t num_groups_27475;
    int32_t max_num_groups_28720;
    
    max_num_groups_28720 = ctx->sizes.testzisegred_num_groups_27384;
    num_groups_27475 = sext_i64_i32(smax64(1, smin64(sdiv_up64(steps_23808,
                                                               sext_i32_i64(segred_group_sizze_27474)),
                                                     sext_i32_i64(max_num_groups_28720))));
    
    int64_t binop_x_27840 = 9 * paths_23807;
    int64_t binop_x_27841 = steps_23808 * binop_x_27840;
    int64_t bytes_27839 = 4 * binop_x_27841;
    float res_24222;
    int32_t local_memory_capacity_28868;
    
    local_memory_capacity_28868 = ctx->opencl.max_local_memory;
    if ((sle64(0, sext_i32_i64(local_memory_capacity_28868)) &&
         sle64((int32_t) sizeof(bool) + (int32_t) sizeof(float) *
               segred_group_sizze_27171,
               sext_i32_i64(local_memory_capacity_28868))) &&
        suff_outer_redomap_27159) {
        struct memblock_device mem_27838;
        
        mem_27838.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27838, bytes_27753, "mem_27838")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t group_sizze_28724;
        
        group_sizze_28724 = ctx->sizes.testzigroup_sizze_28724;
        
        int64_t num_groups_28725;
        
        num_groups_28725 = sdiv_up64(steps_23808 * paths_23807 * 9,
                                     group_sizze_28724);
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28721, 0,
                                                sizeof(paths_23807),
                                                &paths_23807));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28721, 1,
                                                sizeof(steps_23808),
                                                &steps_23808));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28721, 2,
                                                sizeof(mem_27833.mem),
                                                &mem_27833.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28721, 3,
                                                sizeof(mem_27838.mem),
                                                &mem_27838.mem));
        if (1 * ((size_t) num_groups_28725 * (size_t) group_sizze_28724) != 0) {
            const size_t global_work_sizze_29309[1] =
                         {(size_t) num_groups_28725 *
                         (size_t) group_sizze_28724};
            const size_t local_work_sizze_29313[1] = {group_sizze_28724};
            int64_t time_start_29310 = 0, time_end_29311 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.copy_28721");
                fprintf(stderr, "%zu", global_work_sizze_29309[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29313[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_29310 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzicopy_28721,
                                                            1, NULL,
                                                            global_work_sizze_29309,
                                                            local_work_sizze_29313,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzicopy_28721_runs,
                                                                                                      &ctx->testzicopy_28721_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29311 = get_wall_time();
                
                long time_diff_29312 = time_end_29311 - time_start_29310;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n", "test.copy_28721",
                        time_diff_29312);
            }
        }
        
        struct memblock_device mem_27842;
        
        mem_27842.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27842, bytes_27839, "mem_27842")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27842, 0, mem_27838,
                                                  0, 1, paths_23807 * 9,
                                                  steps_23808) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_unref_device(ctx, &mem_27838, "mem_27838") != 0)
            return 1;
        
        struct memblock_device mem_27845;
        
        mem_27845.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27845, 4, "mem_27845")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device testzicounter_mem_28726 =
                               ctx->testzicounter_mem_28726;
        struct memblock_device group_res_arr_mem_28728;
        
        group_res_arr_mem_28728.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28728,
                                  (int32_t) sizeof(float) *
                                  (segred_group_sizze_27171 * num_groups_27172),
                                  "group_res_arr_mem_28728")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28730;
        
        num_threads_28730 = num_groups_27172 * segred_group_sizze_27171;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27169,
                                                1, (int32_t) sizeof(float) *
                                                segred_group_sizze_27171,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27169,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27169,
                                                3, sizeof(paths_23807),
                                                &paths_23807));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27169,
                                                4, sizeof(steps_23808),
                                                &steps_23808));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27169,
                                                5, sizeof(sims_per_year_23899),
                                                &sims_per_year_23899));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27169,
                                                6, sizeof(res_24219),
                                                &res_24219));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27169,
                                                7, sizeof(num_groups_27172),
                                                &num_groups_27172));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27169,
                                                8, sizeof(mem_27842.mem),
                                                &mem_27842.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27169,
                                                9, sizeof(mem_27845.mem),
                                                &mem_27845.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27169,
                                                10,
                                                sizeof(testzicounter_mem_28726.mem),
                                                &testzicounter_mem_28726.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27169,
                                                11,
                                                sizeof(group_res_arr_mem_28728.mem),
                                                &group_res_arr_mem_28728.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27169,
                                                12, sizeof(num_threads_28730),
                                                &num_threads_28730));
        if (1 * ((size_t) num_groups_27172 *
                 (size_t) segred_group_sizze_27171) != 0) {
            const size_t global_work_sizze_29315[1] =
                         {(size_t) num_groups_27172 *
                         (size_t) segred_group_sizze_27171};
            const size_t local_work_sizze_29319[1] = {segred_group_sizze_27171};
            int64_t time_start_29316 = 0, time_end_29317 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segred_nonseg_27169");
                fprintf(stderr, "%zu", global_work_sizze_29315[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29319[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(float) *
                               segred_group_sizze_27171 +
                               (int32_t) sizeof(bool)));
                time_start_29316 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegred_nonseg_27169,
                                                            1, NULL,
                                                            global_work_sizze_29315,
                                                            local_work_sizze_29319,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegred_nonseg_27169_runs,
                                                                                                      &ctx->testzisegred_nonseg_27169_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29317 = get_wall_time();
                
                long time_diff_29318 = time_end_29317 - time_start_29316;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segred_nonseg_27169", time_diff_29318);
            }
        }
        if (memblock_unref_device(ctx, &mem_27842, "mem_27842") != 0)
            return 1;
        
        float read_res_29320;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27845.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(float),
                                                     sizeof(float),
                                                     &read_res_29320, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        float res_27210 = read_res_29320;
        
        if (memblock_unref_device(ctx, &mem_27845, "mem_27845") != 0)
            return 1;
        res_24222 = res_27210;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28728,
                                  "group_res_arr_mem_28728") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27845, "mem_27845") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27842, "mem_27842") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27838, "mem_27838") != 0)
            return 1;
    } else {
        struct memblock_device res_map_acc_mem_27867;
        
        res_map_acc_mem_27867.references = NULL;
        
        int32_t local_memory_capacity_28837;
        
        local_memory_capacity_28837 = ctx->opencl.max_local_memory;
        if ((sle64(0, sext_i32_i64(local_memory_capacity_28837)) && sle64(0,
                                                                          sext_i32_i64(local_memory_capacity_28837))) &&
            suff_outer_par_27392) {
            int64_t segmap_usable_groups_27396 = sdiv_up64(steps_23808,
                                                           segmap_group_sizze_27395);
            struct memblock_device mem_27849;
            
            mem_27849.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27849, bytes_27753,
                                      "mem_27849")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t group_sizze_28761;
            
            group_sizze_28761 = ctx->sizes.testzigroup_sizze_28761;
            
            int64_t num_groups_28762;
            
            num_groups_28762 = sdiv_up64(steps_23808 * paths_23807 * 9,
                                         group_sizze_28761);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28758, 0,
                                                    sizeof(paths_23807),
                                                    &paths_23807));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28758, 1,
                                                    sizeof(steps_23808),
                                                    &steps_23808));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28758, 2,
                                                    sizeof(mem_27833.mem),
                                                    &mem_27833.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzicopy_28758, 3,
                                                    sizeof(mem_27849.mem),
                                                    &mem_27849.mem));
            if (1 * ((size_t) num_groups_28762 * (size_t) group_sizze_28761) !=
                0) {
                const size_t global_work_sizze_29321[1] =
                             {(size_t) num_groups_28762 *
                             (size_t) group_sizze_28761};
                const size_t local_work_sizze_29325[1] = {group_sizze_28761};
                int64_t time_start_29322 = 0, time_end_29323 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.copy_28758");
                    fprintf(stderr, "%zu", global_work_sizze_29321[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29325[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29322 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testzicopy_28758,
                                                                1, NULL,
                                                                global_work_sizze_29321,
                                                                local_work_sizze_29325,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testzicopy_28758_runs,
                                                                                                          &ctx->testzicopy_28758_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29323 = get_wall_time();
                    
                    long time_diff_29324 = time_end_29323 - time_start_29322;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.copy_28758", time_diff_29324);
                }
            }
            
            struct memblock_device mem_27853;
            
            mem_27853.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27853, bytes_27839,
                                      "mem_27853")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27853, 0,
                                                      mem_27849, 0, 1,
                                                      paths_23807 * 9,
                                                      steps_23808) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref_device(ctx, &mem_27849, "mem_27849") != 0)
                return 1;
            
            struct memblock_device mem_27856;
            
            mem_27856.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27856, bytes_27729,
                                      "mem_27856")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegMap");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27216, 1,
                                                    sizeof(paths_23807),
                                                    &paths_23807));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27216, 2,
                                                    sizeof(steps_23808),
                                                    &steps_23808));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27216, 3,
                                                    sizeof(sims_per_year_23899),
                                                    &sims_per_year_23899));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27216, 4,
                                                    sizeof(res_24219),
                                                    &res_24219));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27216, 5,
                                                    sizeof(mem_27853.mem),
                                                    &mem_27853.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27216, 6,
                                                    sizeof(mem_27856.mem),
                                                    &mem_27856.mem));
            if (1 * ((size_t) segmap_usable_groups_27396 *
                     (size_t) segmap_group_sizze_27395) != 0) {
                const size_t global_work_sizze_29326[1] =
                             {(size_t) segmap_usable_groups_27396 *
                             (size_t) segmap_group_sizze_27395};
                const size_t local_work_sizze_29330[1] =
                             {segmap_group_sizze_27395};
                int64_t time_start_29327 = 0, time_end_29328 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.segmap_27216");
                    fprintf(stderr, "%zu", global_work_sizze_29326[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29330[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29327 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testzisegmap_27216,
                                                                1, NULL,
                                                                global_work_sizze_29326,
                                                                local_work_sizze_29330,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testzisegmap_27216_runs,
                                                                                                          &ctx->testzisegmap_27216_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29328 = get_wall_time();
                    
                    long time_diff_29329 = time_end_29328 - time_start_29327;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.segmap_27216", time_diff_29329);
                }
            }
            if (memblock_unref_device(ctx, &mem_27853, "mem_27853") != 0)
                return 1;
            if (memblock_set_device(ctx, &res_map_acc_mem_27867, &mem_27856,
                                    "mem_27856") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27856, "mem_27856") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27853, "mem_27853") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27849, "mem_27849") != 0)
                return 1;
        } else {
            struct memblock_device mem_27860;
            
            mem_27860.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27860, bytes_27839,
                                      "mem_27860")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_27860, 0,
                                                      mem_27833, 0, 1, 9,
                                                      paths_23807 *
                                                      steps_23808) != 0) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_27863;
            
            mem_27863.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27863, bytes_27729,
                                      "mem_27863")) {
                err = 1;
                goto cleanup;
            }
            if (slt64(paths_23807 * 2, segred_group_sizze_27432)) {
                int64_t segment_sizze_nonzzero_28770 = smax64(1, paths_23807);
                int64_t num_threads_28771 = num_groups_27433 *
                        segred_group_sizze_27432;
                
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegRed-small");
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "num_segments",
                            (long long) steps_23808, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "segment_size",
                            (long long) paths_23807, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "segments_per_group",
                            (long long) squot64(segred_group_sizze_27432,
                                                segment_sizze_nonzzero_28770),
                            '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "required_groups",
                            (long long) sext_i64_i32(sdiv_up64(steps_23808,
                                                               squot64(segred_group_sizze_27432,
                                                                       segment_sizze_nonzzero_28770))),
                            '\n');
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_27326,
                                                        1,
                                                        (int32_t) sizeof(float) *
                                                        segred_group_sizze_27432,
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_27326,
                                                        2, sizeof(paths_23807),
                                                        &paths_23807));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_27326,
                                                        3, sizeof(steps_23808),
                                                        &steps_23808));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_27326,
                                                        4,
                                                        sizeof(num_groups_27433),
                                                        &num_groups_27433));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_27326,
                                                        5,
                                                        sizeof(mem_27860.mem),
                                                        &mem_27860.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_27326,
                                                        6,
                                                        sizeof(mem_27863.mem),
                                                        &mem_27863.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_27326,
                                                        7,
                                                        sizeof(segment_sizze_nonzzero_28770),
                                                        &segment_sizze_nonzzero_28770));
                if (1 * ((size_t) num_groups_27433 *
                         (size_t) segred_group_sizze_27432) != 0) {
                    const size_t global_work_sizze_29331[1] =
                                 {(size_t) num_groups_27433 *
                                 (size_t) segred_group_sizze_27432};
                    const size_t local_work_sizze_29335[1] =
                                 {segred_group_sizze_27432};
                    int64_t time_start_29332 = 0, time_end_29333 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.segred_small_27326");
                        fprintf(stderr, "%zu", global_work_sizze_29331[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29335[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(float) *
                                       segred_group_sizze_27432));
                        time_start_29332 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testzisegred_small_27326,
                                                                    1, NULL,
                                                                    global_work_sizze_29331,
                                                                    local_work_sizze_29335,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testzisegred_small_27326_runs,
                                                                                                              &ctx->testzisegred_small_27326_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29333 = get_wall_time();
                        
                        long time_diff_29334 = time_end_29333 -
                             time_start_29332;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.segred_small_27326", time_diff_29334);
                    }
                }
            } else {
                int64_t groups_per_segment_28792 = sdiv_up64(num_groups_27433,
                                                             smax64(1,
                                                                    steps_23808));
                int64_t elements_per_thread_28793 = sdiv_up64(paths_23807,
                                                              segred_group_sizze_27432 *
                                                              groups_per_segment_28792);
                int64_t virt_num_groups_28794 = groups_per_segment_28792 *
                        steps_23808;
                int64_t num_threads_28795 = num_groups_27433 *
                        segred_group_sizze_27432;
                int64_t threads_per_segment_28796 = groups_per_segment_28792 *
                        segred_group_sizze_27432;
                
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegRed-large");
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "num_segments",
                            (long long) steps_23808, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "segment_size",
                            (long long) paths_23807, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                            (long long) virt_num_groups_28794, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "num_groups",
                            (long long) num_groups_27433, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "group_size",
                            (long long) segred_group_sizze_27432, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                            (long long) elements_per_thread_28793, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                            (long long) groups_per_segment_28792, '\n');
                
                struct memblock_device group_res_arr_mem_28797;
                
                group_res_arr_mem_28797.references = NULL;
                if (memblock_alloc_device(ctx, &group_res_arr_mem_28797,
                                          (int32_t) sizeof(float) *
                                          (segred_group_sizze_27432 *
                                           virt_num_groups_28794),
                                          "group_res_arr_mem_28797")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device testzicounter_mem_28799 =
                                       ctx->testzicounter_mem_28799;
                
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27326,
                                                        1,
                                                        (int32_t) sizeof(bool),
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27326,
                                                        2,
                                                        (int32_t) sizeof(float) *
                                                        segred_group_sizze_27432,
                                                        NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27326,
                                                        3, sizeof(paths_23807),
                                                        &paths_23807));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27326,
                                                        4, sizeof(steps_23808),
                                                        &steps_23808));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27326,
                                                        5,
                                                        sizeof(num_groups_27433),
                                                        &num_groups_27433));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27326,
                                                        6,
                                                        sizeof(mem_27860.mem),
                                                        &mem_27860.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27326,
                                                        7,
                                                        sizeof(mem_27863.mem),
                                                        &mem_27863.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27326,
                                                        8,
                                                        sizeof(groups_per_segment_28792),
                                                        &groups_per_segment_28792));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27326,
                                                        9,
                                                        sizeof(elements_per_thread_28793),
                                                        &elements_per_thread_28793));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27326,
                                                        10,
                                                        sizeof(virt_num_groups_28794),
                                                        &virt_num_groups_28794));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27326,
                                                        11,
                                                        sizeof(threads_per_segment_28796),
                                                        &threads_per_segment_28796));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27326,
                                                        12,
                                                        sizeof(group_res_arr_mem_28797.mem),
                                                        &group_res_arr_mem_28797.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_27326,
                                                        13,
                                                        sizeof(testzicounter_mem_28799.mem),
                                                        &testzicounter_mem_28799.mem));
                if (1 * ((size_t) num_groups_27433 *
                         (size_t) segred_group_sizze_27432) != 0) {
                    const size_t global_work_sizze_29337[1] =
                                 {(size_t) num_groups_27433 *
                                 (size_t) segred_group_sizze_27432};
                    const size_t local_work_sizze_29341[1] =
                                 {segred_group_sizze_27432};
                    int64_t time_start_29338 = 0, time_end_29339 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.segred_large_27326");
                        fprintf(stderr, "%zu", global_work_sizze_29337[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29341[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + (int32_t) sizeof(bool) +
                                       (int32_t) sizeof(float) *
                                       segred_group_sizze_27432));
                        time_start_29338 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testzisegred_large_27326,
                                                                    1, NULL,
                                                                    global_work_sizze_29337,
                                                                    local_work_sizze_29341,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testzisegred_large_27326_runs,
                                                                                                              &ctx->testzisegred_large_27326_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29339 = get_wall_time();
                        
                        long time_diff_29340 = time_end_29339 -
                             time_start_29338;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.segred_large_27326", time_diff_29340);
                    }
                }
                if (memblock_unref_device(ctx, &group_res_arr_mem_28797,
                                          "group_res_arr_mem_28797") != 0)
                    return 1;
            }
            if (memblock_unref_device(ctx, &mem_27860, "mem_27860") != 0)
                return 1;
            
            int64_t segmap_usable_groups_27449 = sdiv_up64(steps_23808,
                                                           segmap_group_sizze_27448);
            struct memblock_device mem_27866;
            
            mem_27866.references = NULL;
            if (memblock_alloc_device(ctx, &mem_27866, bytes_27729,
                                      "mem_27866")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegMap");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27291, 1,
                                                    sizeof(steps_23808),
                                                    &steps_23808));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27291, 2,
                                                    sizeof(sims_per_year_23899),
                                                    &sims_per_year_23899));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27291, 3,
                                                    sizeof(res_24219),
                                                    &res_24219));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27291, 4,
                                                    sizeof(mem_27863.mem),
                                                    &mem_27863.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27291, 5,
                                                    sizeof(mem_27866.mem),
                                                    &mem_27866.mem));
            if (1 * ((size_t) segmap_usable_groups_27449 *
                     (size_t) segmap_group_sizze_27448) != 0) {
                const size_t global_work_sizze_29342[1] =
                             {(size_t) segmap_usable_groups_27449 *
                             (size_t) segmap_group_sizze_27448};
                const size_t local_work_sizze_29346[1] =
                             {segmap_group_sizze_27448};
                int64_t time_start_29343 = 0, time_end_29344 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.segmap_27291");
                    fprintf(stderr, "%zu", global_work_sizze_29342[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_29346[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_29343 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testzisegmap_27291,
                                                                1, NULL,
                                                                global_work_sizze_29342,
                                                                local_work_sizze_29346,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testzisegmap_27291_runs,
                                                                                                          &ctx->testzisegmap_27291_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_29344 = get_wall_time();
                    
                    long time_diff_29345 = time_end_29344 - time_start_29343;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.segmap_27291", time_diff_29345);
                }
            }
            if (memblock_unref_device(ctx, &mem_27863, "mem_27863") != 0)
                return 1;
            if (memblock_set_device(ctx, &res_map_acc_mem_27867, &mem_27866,
                                    "mem_27866") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27866, "mem_27866") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27863, "mem_27863") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_27860, "mem_27860") != 0)
                return 1;
        }
        
        struct memblock_device mem_27870;
        
        mem_27870.references = NULL;
        if (memblock_alloc_device(ctx, &mem_27870, 4, "mem_27870")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device testzicounter_mem_28838 =
                               ctx->testzicounter_mem_28838;
        struct memblock_device group_res_arr_mem_28840;
        
        group_res_arr_mem_28840.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_28840,
                                  (int32_t) sizeof(float) *
                                  (segred_group_sizze_27474 * num_groups_27475),
                                  "group_res_arr_mem_28840")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_28842;
        
        num_threads_28842 = num_groups_27475 * segred_group_sizze_27474;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27390,
                                                1, (int32_t) sizeof(float) *
                                                segred_group_sizze_27474,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27390,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27390,
                                                3, sizeof(steps_23808),
                                                &steps_23808));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27390,
                                                4, sizeof(num_groups_27475),
                                                &num_groups_27475));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27390,
                                                5,
                                                sizeof(res_map_acc_mem_27867.mem),
                                                &res_map_acc_mem_27867.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27390,
                                                6, sizeof(mem_27870.mem),
                                                &mem_27870.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27390,
                                                7,
                                                sizeof(testzicounter_mem_28838.mem),
                                                &testzicounter_mem_28838.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27390,
                                                8,
                                                sizeof(group_res_arr_mem_28840.mem),
                                                &group_res_arr_mem_28840.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27390,
                                                9, sizeof(num_threads_28842),
                                                &num_threads_28842));
        if (1 * ((size_t) num_groups_27475 *
                 (size_t) segred_group_sizze_27474) != 0) {
            const size_t global_work_sizze_29348[1] =
                         {(size_t) num_groups_27475 *
                         (size_t) segred_group_sizze_27474};
            const size_t local_work_sizze_29352[1] = {segred_group_sizze_27474};
            int64_t time_start_29349 = 0, time_end_29350 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segred_nonseg_27390");
                fprintf(stderr, "%zu", global_work_sizze_29348[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_29352[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(float) *
                               segred_group_sizze_27474 +
                               (int32_t) sizeof(bool)));
                time_start_29349 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegred_nonseg_27390,
                                                            1, NULL,
                                                            global_work_sizze_29348,
                                                            local_work_sizze_29352,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegred_nonseg_27390_runs,
                                                                                                      &ctx->testzisegred_nonseg_27390_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_29350 = get_wall_time();
                
                long time_diff_29351 = time_end_29350 - time_start_29349;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segred_nonseg_27390", time_diff_29351);
            }
        }
        if (memblock_unref_device(ctx, &res_map_acc_mem_27867,
                                  "res_map_acc_mem_27867") != 0)
            return 1;
        
        float read_res_29353;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_27870.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(float),
                                                     sizeof(float),
                                                     &read_res_29353, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        float res_27482 = read_res_29353;
        
        if (memblock_unref_device(ctx, &mem_27870, "mem_27870") != 0)
            return 1;
        res_24222 = res_27482;
        if (memblock_unref_device(ctx, &group_res_arr_mem_28840,
                                  "group_res_arr_mem_28840") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_27870, "mem_27870") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_map_acc_mem_27867,
                                  "res_map_acc_mem_27867") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_27833, "mem_27833") != 0)
        return 1;
    
    float CVA_24258 = 6.0e-3F * res_24222;
    
    scalar_out_28058 = CVA_24258;
    *out_scalar_out_29134 = scalar_out_28058;
    if (memblock_unref_device(ctx, &mem_27833, "mem_27833") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27831, "mem_27831") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27828, "mem_27828") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27826, "mem_27826") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27823, "mem_27823") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27821, "mem_27821") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27819, "mem_27819") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27816, "mem_27816") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27814, "mem_27814") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_subhistos_mem_28306,
                              "res_subhistos_mem_28306") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27810, "mem_27810") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_28267,
                              "group_res_arr_mem_28267") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27808, "mem_27808") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27805, "mem_27805") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27803, "mem_27803") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27800, "res_mem_27800") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27799, "res_mem_27799") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27726, "res_mem_27726") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27725, "res_mem_27725") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27724, "res_mem_27724") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_27723, "res_mem_27723") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_28065,
                              "group_res_arr_mem_28065") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27676, "mem_27676") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27673, "mem_27673") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27671, "mem_27671") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_27669, "mem_27669") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
struct futhark_i64_1d {
    struct memblock_device mem;
    int64_t shape[1];
} ;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const
                                          int64_t *data, int64_t dim0)
{
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr =
                          (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(int64_t),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(int64_t) > 0)
        OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                      arr->mem.mem, CL_TRUE, 0,
                                                      (size_t) dim0 *
                                                      sizeof(int64_t), data + 0,
                                                      0, NULL,
                                                      ctx->profiling_paused ||
                                                      !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                &ctx->copy_dev_to_host_runs,
                                                                                                &ctx->copy_dev_to_host_total_runtime)));
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0)
{
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr =
                          (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(int64_t),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(int64_t) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue, data,
                                                     arr->mem.mem, offset, 0,
                                                     (size_t) dim0 *
                                                     sizeof(int64_t), 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx,
                          struct futhark_i64_1d *arr, int64_t *data)
{
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * sizeof(int64_t) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     arr->mem.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0, (size_t) arr->shape[0] *
                                                     sizeof(int64_t), data + 0,
                                                     0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_host_to_dev_runs,
                                                                                               &ctx->copy_host_to_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
    }
    lock_unlock(&ctx->lock);
    return 0;
}
cl_mem futhark_values_raw_i64_1d(struct futhark_context *ctx,
                                 struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx,
                                    struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_1d {
    struct memblock_device mem;
    int64_t shape[1];
} ;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const
                                          float *data, int64_t dim0)
{
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr =
                          (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(float),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(float) > 0)
        OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                      arr->mem.mem, CL_TRUE, 0,
                                                      (size_t) dim0 *
                                                      sizeof(float), data + 0,
                                                      0, NULL,
                                                      ctx->profiling_paused ||
                                                      !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                &ctx->copy_dev_to_host_runs,
                                                                                                &ctx->copy_dev_to_host_total_runtime)));
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0)
{
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr =
                          (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(float),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue, data,
                                                     arr->mem.mem, offset, 0,
                                                     (size_t) dim0 *
                                                     sizeof(float), 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_1d(struct futhark_context *ctx,
                          struct futhark_f32_1d *arr, float *data)
{
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     arr->mem.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0, (size_t) arr->shape[0] *
                                                     sizeof(float), data + 0, 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_host_to_dev_runs,
                                                                                               &ctx->copy_host_to_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
    }
    lock_unlock(&ctx->lock);
    return 0;
}
cl_mem futhark_values_raw_f32_1d(struct futhark_context *ctx,
                                 struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx,
                                    struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
int futhark_entry_main(struct futhark_context *ctx, float *out0,
                       struct futhark_f32_1d **out1, const int64_t in0, const
                       int64_t in1, const struct futhark_f32_1d *in2, const
                       struct futhark_i64_1d *in3, const
                       struct futhark_f32_1d *in4, const float in5, const
                       float in6, const float in7, const float in8)
{
    struct memblock_device swap_term_mem_27668;
    
    swap_term_mem_27668.references = NULL;
    
    struct memblock_device payments_mem_27669;
    
    payments_mem_27669.references = NULL;
    
    struct memblock_device notional_mem_27670;
    
    notional_mem_27670.references = NULL;
    
    int64_t n_23312;
    int64_t n_23313;
    int64_t n_23314;
    int64_t paths_23315;
    int64_t steps_23316;
    float a_23320;
    float b_23321;
    float sigma_23322;
    float r0_23323;
    float scalar_out_28058;
    struct memblock_device out_mem_28059;
    
    out_mem_28059.references = NULL;
    
    int64_t out_arrsizze_28060;
    
    lock_lock(&ctx->lock);
    paths_23315 = in0;
    steps_23316 = in1;
    swap_term_mem_27668 = in2->mem;
    n_23312 = in2->shape[0];
    payments_mem_27669 = in3->mem;
    n_23313 = in3->shape[0];
    notional_mem_27670 = in4->mem;
    n_23314 = in4->shape[0];
    a_23320 = in5;
    b_23321 = in6;
    sigma_23322 = in7;
    r0_23323 = in8;
    
    int ret = futrts_main(ctx, &scalar_out_28058, &out_mem_28059,
                          &out_arrsizze_28060, swap_term_mem_27668,
                          payments_mem_27669, notional_mem_27670, n_23312,
                          n_23313, n_23314, paths_23315, steps_23316, a_23320,
                          b_23321, sigma_23322, r0_23323);
    
    if (ret == 0) {
        *out0 = scalar_out_28058;
        assert((*out1 =
                (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) !=
            NULL);
        (*out1)->mem = out_mem_28059;
        (*out1)->shape[0] = out_arrsizze_28060;
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_test(struct futhark_context *ctx, float *out0, const
                       int64_t in0, const int64_t in1)
{
    int64_t paths_23807;
    int64_t steps_23808;
    float scalar_out_28058;
    
    lock_lock(&ctx->lock);
    paths_23807 = in0;
    steps_23808 = in1;
    
    int ret = futrts_test(ctx, &scalar_out_28058, paths_23807, steps_23808);
    
    if (ret == 0) {
        *out0 = scalar_out_28058;
    }
    lock_unlock(&ctx->lock);
    return ret;
}
