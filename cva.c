#ifdef __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#endif
#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#endif
// Headers

#define _GNU_SOURCE
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#define CL_TARGET_OPENCL_VERSION 120
#define CL_USE_DEPRECATED_OPENCL_1_2_APIS
#ifdef __APPLE__
#define CL_SILENCE_DEPRECATION
#include <OpenCL/cl.h>
#else
#include <CL/cl.h>
#endif


// Initialisation

int futhark_get_num_sizes(void);
const char *futhark_get_size_name(int);
const char *futhark_get_size_class(int);
struct futhark_context_config ;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
void futhark_context_config_add_build_option(struct futhark_context_config *cfg,
                                             const char *opt);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int flag);
void futhark_context_config_set_device(struct futhark_context_config *cfg, const
                                       char *s);
void futhark_context_config_set_platform(struct futhark_context_config *cfg,
                                         const char *s);
void
futhark_context_config_select_device_interactively(struct futhark_context_config *cfg);
void futhark_context_config_list_devices(struct futhark_context_config *cfg);
void futhark_context_config_dump_program_to(struct futhark_context_config *cfg,
                                            const char *path);
void
futhark_context_config_load_program_from(struct futhark_context_config *cfg,
                                         const char *path);
void futhark_context_config_dump_binary_to(struct futhark_context_config *cfg,
                                           const char *path);
void futhark_context_config_load_binary_from(struct futhark_context_config *cfg,
                                             const char *path);
void
futhark_context_config_set_default_group_size(struct futhark_context_config *cfg,
                                              int size);
void
futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg,
                                              int num);
void
futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg,
                                             int num);
void
futhark_context_config_set_default_threshold(struct futhark_context_config *cfg,
                                             int num);
int futhark_context_config_set_size(struct futhark_context_config *cfg, const
                                    char *size_name, size_t size_value);
struct futhark_context ;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
struct futhark_context
*futhark_context_new_with_command_queue(struct futhark_context_config *cfg,
                                        cl_command_queue queue);
void futhark_context_free(struct futhark_context *ctx);
cl_command_queue futhark_context_get_command_queue(struct futhark_context *ctx);

// Arrays

struct futhark_f32_1d ;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const
                                          float *data, int64_t dim0);
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0);
int futhark_free_f32_1d(struct futhark_context *ctx,
                        struct futhark_f32_1d *arr);
int futhark_values_f32_1d(struct futhark_context *ctx,
                          struct futhark_f32_1d *arr, float *data);
cl_mem futhark_values_raw_f32_1d(struct futhark_context *ctx,
                                 struct futhark_f32_1d *arr);
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx,
                                    struct futhark_f32_1d *arr);
struct futhark_i64_1d ;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const
                                          int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx,
                        struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx,
                          struct futhark_i64_1d *arr, int64_t *data);
cl_mem futhark_values_raw_i64_1d(struct futhark_context *ctx,
                                 struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx,
                                    struct futhark_i64_1d *arr);

// Opaque values


// Entry points

int futhark_entry_main(struct futhark_context *ctx, float *out0,
                       struct futhark_f32_1d **out1, const int64_t in0, const
                       int64_t in1, const struct futhark_f32_1d *in2, const
                       struct futhark_i64_1d *in3, const
                       struct futhark_f32_1d *in4, const float in5, const
                       float in6, const float in7, const float in8);
int futhark_entry_test(struct futhark_context *ctx, float *out0, const
                       int64_t in0, const int64_t in1);

// Miscellaneous

int futhark_context_sync(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
#define FUTHARK_BACKEND_opencl
#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}


static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                            const char *msg, ...)
{
  if (errval) {
    char str[256];
    char errnum[10];
    sprintf(errnum, "%d", errval);
    sprintf(str, "ERROR: %s in %s() at line %d with error code %s\n", msg, fun, line,
            sets_errno ? strerror(errno) : errnum);
    fprintf(stderr, "%s", str);
    exit(errval);
  }
}

#define CHECK_ERR(err, msg...) check_err(err, 0, __func__, __LINE__, msg)
#define CHECK_ERRNO(err, msg...) check_err(err, 1, __func__, __LINE__, msg)

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  unsigned char *s;
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  fseek(f, 0, SEEK_END);
  size_t src_size = ftell(f);
  fseek(f, 0, SEEK_SET);
  s = (unsigned char*) malloc(src_size + 1);
  if (fread(s, 1, src_size, f) != src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }
  fclose(f);

  if (size) {
    *size = src_size;
  }

  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

// End of util.h.

// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}


static inline uint64_t rdtsc() {
  unsigned int hi, lo;
  __asm__ __volatile__("rdtsc" : "=a"(lo), "=d"(hi));
  return  ((uint64_t) lo) | (((uint64_t) hi) << 32);
}

static inline void rdtsc_wait(uint64_t n) {
  const uint64_t start = rdtsc();
  while (rdtsc() < (start + n)) {
    __asm__("PAUSE");
  }
}
static inline void spin_for(uint64_t nb_cycles) {
  rdtsc_wait(nb_cycles);
}


#endif

// End of timing.h.

#include <string.h>
#include <inttypes.h>
#include <errno.h>
#include <ctype.h>
#include <errno.h>
#include <getopt.h>
// Start of values.h.

//// Text I/O

typedef int (*writer)(FILE*, const void*);
typedef int (*bin_reader)(void*);
typedef int (*str_reader)(const char *, void*);

struct array_reader {
  char* elems;
  int64_t n_elems_space;
  int64_t elem_size;
  int64_t n_elems_used;
  int64_t *shape;
  str_reader elem_reader;
};

static void skipspaces() {
  int c;
  do {
    c = getchar();
  } while (isspace(c));

  if (c != EOF) {
    ungetc(c, stdin);
  }
}

static int constituent(char c) {
  return isalnum(c) || c == '.' || c == '-' || c == '+' || c == '_';
}

// Produces an empty token only on EOF.
static void next_token(char *buf, int bufsize) {
 start:
  skipspaces();

  int i = 0;
  while (i < bufsize) {
    int c = getchar();
    buf[i] = (char)c;

    if (c == EOF) {
      buf[i] = 0;
      return;
    } else if (c == '-' && i == 1 && buf[0] == '-') {
      // Line comment, so skip to end of line and start over.
      for (; c != '\n' && c != EOF; c = getchar());
      goto start;
    } else if (!constituent((char)c)) {
      if (i == 0) {
        // We permit single-character tokens that are not
        // constituents; this lets things like ']' and ',' be
        // tokens.
        buf[i+1] = 0;
        return;
      } else {
        ungetc(c, stdin);
        buf[i] = 0;
        return;
      }
    }

    i++;
  }

  buf[bufsize-1] = 0;
}

static int next_token_is(char *buf, int bufsize, const char* expected) {
  next_token(buf, bufsize);
  return strcmp(buf, expected) == 0;
}

static void remove_underscores(char *buf) {
  char *w = buf;

  for (char *r = buf; *r; r++) {
    if (*r != '_') {
      *w++ = *r;
    }
  }

  *w++ = 0;
}

static int read_str_elem(char *buf, struct array_reader *reader) {
  int ret;
  if (reader->n_elems_used == reader->n_elems_space) {
    reader->n_elems_space *= 2;
    reader->elems = (char*) realloc(reader->elems,
                                    (size_t)(reader->n_elems_space * reader->elem_size));
  }

  ret = reader->elem_reader(buf, reader->elems + reader->n_elems_used * reader->elem_size);

  if (ret == 0) {
    reader->n_elems_used++;
  }

  return ret;
}

static int read_str_array_elems(char *buf, int bufsize,
                                struct array_reader *reader, int64_t dims) {
  int ret;
  int first = 1;
  char *knows_dimsize = (char*) calloc((size_t)dims, sizeof(char));
  int cur_dim = dims-1;
  int64_t *elems_read_in_dim = (int64_t*) calloc((size_t)dims, sizeof(int64_t));

  while (1) {
    next_token(buf, bufsize);

    if (strcmp(buf, "]") == 0) {
      if (knows_dimsize[cur_dim]) {
        if (reader->shape[cur_dim] != elems_read_in_dim[cur_dim]) {
          ret = 1;
          break;
        }
      } else {
        knows_dimsize[cur_dim] = 1;
        reader->shape[cur_dim] = elems_read_in_dim[cur_dim];
      }
      if (cur_dim == 0) {
        ret = 0;
        break;
      } else {
        cur_dim--;
        elems_read_in_dim[cur_dim]++;
      }
    } else if (strcmp(buf, ",") == 0) {
      next_token(buf, bufsize);
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        first = 1;
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else if (cur_dim == dims - 1) {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
      } else {
        ret = 1;
        break;
      }
    } else if (strlen(buf) == 0) {
      // EOF
      ret = 1;
      break;
    } else if (first) {
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
        first = 0;
      }
    } else {
      ret = 1;
      break;
    }
  }

  free(knows_dimsize);
  free(elems_read_in_dim);
  return ret;
}

static int read_str_empty_array(char *buf, int bufsize,
                                const char *type_name, int64_t *shape, int64_t dims) {
  if (strlen(buf) == 0) {
    // EOF
    return 1;
  }

  if (strcmp(buf, "empty") != 0) {
    return 1;
  }

  if (!next_token_is(buf, bufsize, "(")) {
    return 1;
  }

  for (int i = 0; i < dims; i++) {
    if (!next_token_is(buf, bufsize, "[")) {
      return 1;
    }

    next_token(buf, bufsize);

    if (sscanf(buf, "%"SCNu64, (uint64_t*)&shape[i]) != 1) {
      return 1;
    }

    if (!next_token_is(buf, bufsize, "]")) {
      return 1;
    }
  }

  if (!next_token_is(buf, bufsize, type_name)) {
    return 1;
  }


  if (!next_token_is(buf, bufsize, ")")) {
    return 1;
  }

  // Check whether the array really is empty.
  for (int i = 0; i < dims; i++) {
    if (shape[i] == 0) {
      return 0;
    }
  }

  // Not an empty array!
  return 1;
}

static int read_str_array(int64_t elem_size, str_reader elem_reader,
                          const char *type_name,
                          void **data, int64_t *shape, int64_t dims) {
  int ret;
  struct array_reader reader;
  char buf[100];

  int dims_seen;
  for (dims_seen = 0; dims_seen < dims; dims_seen++) {
    if (!next_token_is(buf, sizeof(buf), "[")) {
      break;
    }
  }

  if (dims_seen == 0) {
    return read_str_empty_array(buf, sizeof(buf), type_name, shape, dims);
  }

  if (dims_seen != dims) {
    return 1;
  }

  reader.shape = shape;
  reader.n_elems_used = 0;
  reader.elem_size = elem_size;
  reader.n_elems_space = 16;
  reader.elems = (char*) realloc(*data, (size_t)(elem_size*reader.n_elems_space));
  reader.elem_reader = elem_reader;

  ret = read_str_array_elems(buf, sizeof(buf), &reader, dims);

  *data = reader.elems;

  return ret;
}

#define READ_STR(MACRO, PTR, SUFFIX)                                   \
  remove_underscores(buf);                                              \
  int j;                                                                \
  if (sscanf(buf, "%"MACRO"%n", (PTR*)dest, &j) == 1) {                 \
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, SUFFIX) == 0);     \
  } else {                                                              \
    return 1;                                                           \
  }

static int read_str_i8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNi8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(int8_t*)dest = (int8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "i8") == 0);
  } else {
    return 1;
  }
}

static int read_str_u8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNu8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(uint8_t*)dest = (uint8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "u8") == 0);
  } else {
    return 1;
  }
}

static int read_str_i16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "i16");
}

static int read_str_u16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "u16");
}

static int read_str_i32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "i32");
}

static int read_str_u32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "u32");
}

static int read_str_i64(char *buf, void* dest) {
  READ_STR(SCNi64, int64_t, "i64");
}

static int read_str_u64(char *buf, void* dest) {
  // FIXME: This is not correct, as SCNu64 only permits decimal
  // literals.  However, SCNi64 does not handle very large numbers
  // correctly (it's really for signed numbers, so that's fair).
  READ_STR(SCNu64, uint64_t, "u64");
}

static int read_str_f32(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f32.nan") == 0) {
    *(float*)dest = NAN;
    return 0;
  } else if (strcmp(buf, "f32.inf") == 0) {
    *(float*)dest = INFINITY;
    return 0;
  } else if (strcmp(buf, "-f32.inf") == 0) {
    *(float*)dest = -INFINITY;
    return 0;
  } else {
    READ_STR("f", float, "f32");
  }
}

static int read_str_f64(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f64.nan") == 0) {
    *(double*)dest = NAN;
    return 0;
  } else if (strcmp(buf, "f64.inf") == 0) {
    *(double*)dest = INFINITY;
    return 0;
  } else if (strcmp(buf, "-f64.inf") == 0) {
    *(double*)dest = -INFINITY;
    return 0;
  } else {
    READ_STR("lf", double, "f64");
  }
}

static int read_str_bool(char *buf, void* dest) {
  if (strcmp(buf, "true") == 0) {
    *(char*)dest = 1;
    return 0;
  } else if (strcmp(buf, "false") == 0) {
    *(char*)dest = 0;
    return 0;
  } else {
    return 1;
  }
}

static int write_str_i8(FILE *out, int8_t *src) {
  return fprintf(out, "%hhdi8", *src);
}

static int write_str_u8(FILE *out, uint8_t *src) {
  return fprintf(out, "%hhuu8", *src);
}

static int write_str_i16(FILE *out, int16_t *src) {
  return fprintf(out, "%hdi16", *src);
}

static int write_str_u16(FILE *out, uint16_t *src) {
  return fprintf(out, "%huu16", *src);
}

static int write_str_i32(FILE *out, int32_t *src) {
  return fprintf(out, "%di32", *src);
}

static int write_str_u32(FILE *out, uint32_t *src) {
  return fprintf(out, "%uu32", *src);
}

static int write_str_i64(FILE *out, int64_t *src) {
  return fprintf(out, "%"PRIi64"i64", *src);
}

static int write_str_u64(FILE *out, uint64_t *src) {
  return fprintf(out, "%"PRIu64"u64", *src);
}

static int write_str_f32(FILE *out, float *src) {
  float x = *src;
  if (isnan(x)) {
    return fprintf(out, "f32.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f32.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f32.inf");
  } else {
    return fprintf(out, "%.6ff32", x);
  }
}

static int write_str_f64(FILE *out, double *src) {
  double x = *src;
  if (isnan(x)) {
    return fprintf(out, "f64.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f64.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f64.inf");
  } else {
    return fprintf(out, "%.6ff64", *src);
  }
}

static int write_str_bool(FILE *out, void *src) {
  return fprintf(out, *(char*)src ? "true" : "false");
}

//// Binary I/O

#define BINARY_FORMAT_VERSION 2
#define IS_BIG_ENDIAN (!*(unsigned char *)&(uint16_t){1})

static void flip_bytes(int elem_size, unsigned char *elem) {
  for (int j=0; j<elem_size/2; j++) {
    unsigned char head = elem[j];
    int tail_index = elem_size-1-j;
    elem[j] = elem[tail_index];
    elem[tail_index] = head;
  }
}

// On Windows we need to explicitly set the file mode to not mangle
// newline characters.  On *nix there is no difference.
#ifdef _WIN32
#include <io.h>
#include <fcntl.h>
static void set_binary_mode(FILE *f) {
  setmode(fileno(f), O_BINARY);
}
#else
static void set_binary_mode(FILE *f) {
  (void)f;
}
#endif

static int read_byte(void* dest) {
  int num_elems_read = fread(dest, 1, 1, stdin);
  return num_elems_read == 1 ? 0 : 1;
}

//// Types

struct primtype_info_t {
  const char binname[4]; // Used for parsing binary data.
  const char* type_name; // Same name as in Futhark.
  const int64_t size; // in bytes
  const writer write_str; // Write in text format.
  const str_reader read_str; // Read in text format.
};

static const struct primtype_info_t i8_info =
  {.binname = "  i8", .type_name = "i8",   .size = 1,
   .write_str = (writer)write_str_i8, .read_str = (str_reader)read_str_i8};
static const struct primtype_info_t i16_info =
  {.binname = " i16", .type_name = "i16",  .size = 2,
   .write_str = (writer)write_str_i16, .read_str = (str_reader)read_str_i16};
static const struct primtype_info_t i32_info =
  {.binname = " i32", .type_name = "i32",  .size = 4,
   .write_str = (writer)write_str_i32, .read_str = (str_reader)read_str_i32};
static const struct primtype_info_t i64_info =
  {.binname = " i64", .type_name = "i64",  .size = 8,
   .write_str = (writer)write_str_i64, .read_str = (str_reader)read_str_i64};
static const struct primtype_info_t u8_info =
  {.binname = "  u8", .type_name = "u8",   .size = 1,
   .write_str = (writer)write_str_u8, .read_str = (str_reader)read_str_u8};
static const struct primtype_info_t u16_info =
  {.binname = " u16", .type_name = "u16",  .size = 2,
   .write_str = (writer)write_str_u16, .read_str = (str_reader)read_str_u16};
static const struct primtype_info_t u32_info =
  {.binname = " u32", .type_name = "u32",  .size = 4,
   .write_str = (writer)write_str_u32, .read_str = (str_reader)read_str_u32};
static const struct primtype_info_t u64_info =
  {.binname = " u64", .type_name = "u64",  .size = 8,
   .write_str = (writer)write_str_u64, .read_str = (str_reader)read_str_u64};
static const struct primtype_info_t f32_info =
  {.binname = " f32", .type_name = "f32",  .size = 4,
   .write_str = (writer)write_str_f32, .read_str = (str_reader)read_str_f32};
static const struct primtype_info_t f64_info =
  {.binname = " f64", .type_name = "f64",  .size = 8,
   .write_str = (writer)write_str_f64, .read_str = (str_reader)read_str_f64};
static const struct primtype_info_t bool_info =
  {.binname = "bool", .type_name = "bool", .size = 1,
   .write_str = (writer)write_str_bool, .read_str = (str_reader)read_str_bool};

static const struct primtype_info_t* primtypes[] = {
  &i8_info, &i16_info, &i32_info, &i64_info,
  &u8_info, &u16_info, &u32_info, &u64_info,
  &f32_info, &f64_info,
  &bool_info,
  NULL // NULL-terminated
};

// General value interface.  All endian business taken care of at
// lower layers.

static int read_is_binary() {
  skipspaces();
  int c = getchar();
  if (c == 'b') {
    int8_t bin_version;
    int ret = read_byte(&bin_version);

    if (ret != 0) { futhark_panic(1, "binary-input: could not read version.\n"); }

    if (bin_version != BINARY_FORMAT_VERSION) {
      futhark_panic(1, "binary-input: File uses version %i, but I only understand version %i.\n",
            bin_version, BINARY_FORMAT_VERSION);
    }

    return 1;
  }
  ungetc(c, stdin);
  return 0;
}

static const struct primtype_info_t* read_bin_read_type_enum() {
  char read_binname[4];

  int num_matched = scanf("%4c", read_binname);
  if (num_matched != 1) { futhark_panic(1, "binary-input: Couldn't read element type.\n"); }

  const struct primtype_info_t **type = primtypes;

  for (; *type != NULL; type++) {
    // I compare the 4 characters manually instead of using strncmp because
    // this allows any value to be used, also NULL bytes
    if (memcmp(read_binname, (*type)->binname, 4) == 0) {
      return *type;
    }
  }
  futhark_panic(1, "binary-input: Did not recognize the type '%s'.\n", read_binname);
  return NULL;
}

static void read_bin_ensure_scalar(const struct primtype_info_t *expected_type) {
  int8_t bin_dims;
  int ret = read_byte(&bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != 0) {
    futhark_panic(1, "binary-input: Expected scalar (0 dimensions), but got array with %i dimensions.\n",
          bin_dims);
  }

  const struct primtype_info_t *bin_type = read_bin_read_type_enum();
  if (bin_type != expected_type) {
    futhark_panic(1, "binary-input: Expected scalar of type %s but got scalar of type %s.\n",
          expected_type->type_name,
          bin_type->type_name);
  }
}

//// High-level interface

static int read_bin_array(const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  int ret;

  int8_t bin_dims;
  ret = read_byte(&bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != dims) {
    futhark_panic(1, "binary-input: Expected %i dimensions, but got array with %i dimensions.\n",
          dims, bin_dims);
  }

  const struct primtype_info_t *bin_primtype = read_bin_read_type_enum();
  if (expected_type != bin_primtype) {
    futhark_panic(1, "binary-input: Expected %iD-array with element type '%s' but got %iD-array with element type '%s'.\n",
          dims, expected_type->type_name, dims, bin_primtype->type_name);
  }

  int64_t elem_count = 1;
  for (int i=0; i<dims; i++) {
    int64_t bin_shape;
    ret = fread(&bin_shape, sizeof(bin_shape), 1, stdin);
    if (ret != 1) {
      futhark_panic(1, "binary-input: Couldn't read size for dimension %i of array.\n", i);
    }
    if (IS_BIG_ENDIAN) {
      flip_bytes(sizeof(bin_shape), (unsigned char*) &bin_shape);
    }
    elem_count *= bin_shape;
    shape[i] = bin_shape;
  }

  int64_t elem_size = expected_type->size;
  void* tmp = realloc(*data, (size_t)(elem_count * elem_size));
  if (tmp == NULL) {
    futhark_panic(1, "binary-input: Failed to allocate array of size %i.\n",
          elem_count * elem_size);
  }
  *data = tmp;

  int64_t num_elems_read = (int64_t)fread(*data, (size_t)elem_size, (size_t)elem_count, stdin);
  if (num_elems_read != elem_count) {
    futhark_panic(1, "binary-input: tried to read %i elements of an array, but only got %i elements.\n",
          elem_count, num_elems_read);
  }

  // If we're on big endian platform we must change all multibyte elements
  // from using little endian to big endian
  if (IS_BIG_ENDIAN && elem_size != 1) {
    flip_bytes(elem_size, (unsigned char*) *data);
  }

  return 0;
}

static int read_array(const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  if (!read_is_binary()) {
    return read_str_array(expected_type->size, (str_reader)expected_type->read_str, expected_type->type_name, data, shape, dims);
  } else {
    return read_bin_array(expected_type, data, shape, dims);
  }
}

static int end_of_input() {
  skipspaces();
  char token[2];
  next_token(token, sizeof(token));
  if (strcmp(token, "") == 0) {
    return 0;
  } else {
    return 1;
  }
}

static int write_str_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  if (rank==0) {
    elem_type->write_str(out, (void*)data);
  } else {
    int64_t len = (int64_t)shape[0];
    int64_t slice_size = 1;

    int64_t elem_size = elem_type->size;
    for (int8_t i = 1; i < rank; i++) {
      slice_size *= shape[i];
    }

    if (len*slice_size == 0) {
      printf("empty(");
      for (int64_t i = 0; i < rank; i++) {
        printf("[%"PRIi64"]", shape[i]);
      }
      printf("%s", elem_type->type_name);
      printf(")");
    } else if (rank==1) {
      putchar('[');
      for (int64_t i = 0; i < len; i++) {
        elem_type->write_str(out, (void*) (data + i * elem_size));
        if (i != len-1) {
          printf(", ");
        }
      }
      putchar(']');
    } else {
      putchar('[');
      for (int64_t i = 0; i < len; i++) {
        write_str_array(out, elem_type, data + i * slice_size * elem_size, shape+1, rank-1);
        if (i != len-1) {
          printf(", ");
        }
      }
      putchar(']');
    }
  }
  return 0;
}

static int write_bin_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  int64_t num_elems = 1;
  for (int64_t i = 0; i < rank; i++) {
    num_elems *= shape[i];
  }

  fputc('b', out);
  fputc((char)BINARY_FORMAT_VERSION, out);
  fwrite(&rank, sizeof(int8_t), 1, out);
  fputs(elem_type->binname, out);
  if (shape != NULL) {
    fwrite(shape, sizeof(int64_t), (size_t)rank, out);
  }

  if (IS_BIG_ENDIAN) {
    for (int64_t i = 0; i < num_elems; i++) {
      const unsigned char *elem = data+i*elem_type->size;
      for (int64_t j = 0; j < elem_type->size; j++) {
        fwrite(&elem[elem_type->size-j], 1, 1, out);
      }
    }
  } else {
    fwrite(data, (size_t)elem_type->size, (size_t)num_elems, out);
  }

  return 0;
}

static int write_array(FILE *out, int write_binary,
                       const struct primtype_info_t *elem_type,
                       const void *data,
                       const int64_t *shape,
                       const int8_t rank) {
  if (write_binary) {
    return write_bin_array(out, elem_type, data, shape, rank);
  } else {
    return write_str_array(out, elem_type, data, shape, rank);
  }
}

static int read_scalar(const struct primtype_info_t *expected_type, void *dest) {
  if (!read_is_binary()) {
    char buf[100];
    next_token(buf, sizeof(buf));
    return expected_type->read_str(buf, dest);
  } else {
    read_bin_ensure_scalar(expected_type);
    int64_t elem_size = expected_type->size;
    int num_elems_read = fread(dest, (size_t)elem_size, 1, stdin);
    if (IS_BIG_ENDIAN) {
      flip_bytes(elem_size, (unsigned char*) dest);
    }
    return num_elems_read == 1 ? 0 : 1;
  }
}

static int write_scalar(FILE *out, int write_binary, const struct primtype_info_t *type, void *src) {
  if (write_binary) {
    return write_bin_array(out, type, src, NULL, 0);
  } else {
    return type->write_str(out, src);
  }
}

// End of values.h.

#define __private
static int binary_output = 0;
static FILE *runtime_file;
static int perform_warmup = 0;
static int num_runs = 1;
static const char *entry_point = "main";
// Start of tuning.h.

static char* load_tuning_file(const char *fname,
                              void *cfg,
                              int (*set_size)(void*, const char*, size_t)) {
  const int max_line_len = 1024;
  char* line = (char*) malloc(max_line_len);

  FILE *f = fopen(fname, "r");

  if (f == NULL) {
    snprintf(line, max_line_len, "Cannot open file: %s", strerror(errno));
    return line;
  }

  int lineno = 0;
  while (fgets(line, max_line_len, f) != NULL) {
    lineno++;
    char *eql = strstr(line, "=");
    if (eql) {
      *eql = 0;
      int value = atoi(eql+1);
      if (set_size(cfg, line, value) != 0) {
        strncpy(eql+1, line, max_line_len-strlen(line)-1);
        snprintf(line, max_line_len, "Unknown name '%s' on line %d.", eql+1, lineno);
        return line;
      }
    } else {
      snprintf(line, max_line_len, "Invalid line %d (must be of form 'name=int').",
               lineno);
      return line;
    }
  }

  free(line);

  return NULL;
}

// End of tuning.h.

int parse_options(struct futhark_context_config *cfg, int argc,
                  char *const argv[])
{
    int ch;
    static struct option long_options[] = {{"write-runtime-to",
                                            required_argument, NULL, 1},
                                           {"runs", required_argument, NULL, 2},
                                           {"debugging", no_argument, NULL, 3},
                                           {"log", no_argument, NULL, 4},
                                           {"entry-point", required_argument,
                                            NULL, 5}, {"binary-output",
                                                       no_argument, NULL, 6},
                                           {"help", no_argument, NULL, 7},
                                           {"device", required_argument, NULL,
                                            8}, {"default-group-size",
                                                 required_argument, NULL, 9},
                                           {"default-num-groups",
                                            required_argument, NULL, 10},
                                           {"default-tile-size",
                                            required_argument, NULL, 11},
                                           {"default-threshold",
                                            required_argument, NULL, 12},
                                           {"print-sizes", no_argument, NULL,
                                            13}, {"size", required_argument,
                                                  NULL, 14}, {"tuning",
                                                              required_argument,
                                                              NULL, 15},
                                           {"platform", required_argument, NULL,
                                            16}, {"dump-opencl",
                                                  required_argument, NULL, 17},
                                           {"load-opencl", required_argument,
                                            NULL, 18}, {"dump-opencl-binary",
                                                        required_argument, NULL,
                                                        19},
                                           {"load-opencl-binary",
                                            required_argument, NULL, 20},
                                           {"build-option", required_argument,
                                            NULL, 21}, {"profile", no_argument,
                                                        NULL, 22},
                                           {"list-devices", no_argument, NULL,
                                            23}, {0, 0, 0, 0}};
    static char *option_descriptions =
                "  -t/--write-runtime-to FILE Print the time taken to execute the program to the indicated file, an integral number of microseconds.\n  -r/--runs INT              Perform NUM runs of the program.\n  -D/--debugging             Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                   Print various low-overhead logging information to stderr while running.\n  -e/--entry-point NAME      The entry point to run. Defaults to main.\n  -b/--binary-output         Print the program result in the binary output format.\n  -h/--help                  Print help information and exit.\n  -d/--device NAME           Use the first OpenCL device whose name contains the given string.\n  --default-group-size INT   The default size of OpenCL workgroups that are launched.\n  --default-num-groups INT   The default number of OpenCL workgroups that are launched.\n  --default-tile-size INT    The default tile size used when performing two-dimensional tiling.\n  --default-threshold INT    The default parallelism threshold.\n  --print-sizes              Print all sizes that can be set with -size or --tuning.\n  --size ASSIGNMENT          Set a configurable run-time parameter to the given value.\n  --tuning FILE              Read size=value assignments from the given file.\n  -p/--platform NAME         Use the first OpenCL platform whose name contains the given string.\n  --dump-opencl FILE         Dump the embedded OpenCL program to the indicated file.\n  --load-opencl FILE         Instead of using the embedded OpenCL program, load it from the indicated file.\n  --dump-opencl-binary FILE  Dump the compiled version of the embedded OpenCL program to the indicated file.\n  --load-opencl-binary FILE  Load an OpenCL binary from the indicated file.\n  --build-option OPT         Add an additional build option to the string passed to clBuildProgram().\n  -P/--profile               Gather profiling data while executing and print out a summary at the end.\n  --list-devices             List all OpenCL devices and platforms available on the system.\n";
    
    while ((ch = getopt_long(argc, argv, ":t:r:DLe:bhd:p:P", long_options,
                             NULL)) != -1) {
        if (ch == 1 || ch == 't') {
            runtime_file = fopen(optarg, "w");
            if (runtime_file == NULL)
                futhark_panic(1, "Cannot open %s: %s\n", optarg,
                              strerror(errno));
        }
        if (ch == 2 || ch == 'r') {
            num_runs = atoi(optarg);
            perform_warmup = 1;
            if (num_runs <= 0)
                futhark_panic(1, "Need a positive number of runs, not %s\n",
                              optarg);
        }
        if (ch == 3 || ch == 'D')
            futhark_context_config_set_debugging(cfg, 1);
        if (ch == 4 || ch == 'L')
            futhark_context_config_set_logging(cfg, 1);
        if (ch == 5 || ch == 'e') {
            if (entry_point != NULL)
                entry_point = optarg;
        }
        if (ch == 6 || ch == 'b')
            binary_output = 1;
        if (ch == 7 || ch == 'h') {
            printf("Usage: %s [OPTION]...\nOptions:\n\n%s\nFor more information, consult the Futhark User's Guide or the man pages.\n",
                   fut_progname, option_descriptions);
            exit(0);
        }
        if (ch == 8 || ch == 'd')
            futhark_context_config_set_device(cfg, optarg);
        if (ch == 9)
            futhark_context_config_set_default_group_size(cfg, atoi(optarg));
        if (ch == 10)
            futhark_context_config_set_default_num_groups(cfg, atoi(optarg));
        if (ch == 11)
            futhark_context_config_set_default_tile_size(cfg, atoi(optarg));
        if (ch == 12)
            futhark_context_config_set_default_threshold(cfg, atoi(optarg));
        if (ch == 13) {
            int n = futhark_get_num_sizes();
            
            for (int i = 0; i < n; i++)
                printf("%s (%s)\n", futhark_get_size_name(i),
                       futhark_get_size_class(i));
            exit(0);
        }
        if (ch == 14) {
            char *name = optarg;
            char *equals = strstr(optarg, "=");
            char *value_str = equals != NULL ? equals + 1 : optarg;
            int value = atoi(value_str);
            
            if (equals != NULL) {
                *equals = 0;
                if (futhark_context_config_set_size(cfg, name, value) != 0)
                    futhark_panic(1, "Unknown size: %s\n", name);
            } else
                futhark_panic(1, "Invalid argument for size option: %s\n",
                              optarg);
        }
        if (ch == 15) {
            char *ret = load_tuning_file(optarg, cfg, (int (*)(void *, const
                                                               char *,
                                                               size_t)) futhark_context_config_set_size);
            
            if (ret != NULL)
                futhark_panic(1, "When loading tuning from '%s': %s\n", optarg,
                              ret);
        }
        if (ch == 16 || ch == 'p')
            futhark_context_config_set_platform(cfg, optarg);
        if (ch == 17) {
            futhark_context_config_dump_program_to(cfg, optarg);
            entry_point = NULL;
        }
        if (ch == 18)
            futhark_context_config_load_program_from(cfg, optarg);
        if (ch == 19) {
            futhark_context_config_dump_binary_to(cfg, optarg);
            entry_point = NULL;
        }
        if (ch == 20)
            futhark_context_config_load_binary_from(cfg, optarg);
        if (ch == 21)
            futhark_context_config_add_build_option(cfg, optarg);
        if (ch == 22 || ch == 'P')
            futhark_context_config_set_profiling(cfg, 1);
        if (ch == 23) {
            futhark_context_config_list_devices(cfg);
            entry_point = NULL;
        }
        if (ch == ':')
            futhark_panic(-1, "Missing argument for option %s\n", argv[optind -
                                                                       1]);
        if (ch == '?') {
            fprintf(stderr, "Usage: %s: %s\n", fut_progname,
                    "  -t/--write-runtime-to FILE Print the time taken to execute the program to the indicated file, an integral number of microseconds.\n  -r/--runs INT              Perform NUM runs of the program.\n  -D/--debugging             Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                   Print various low-overhead logging information to stderr while running.\n  -e/--entry-point NAME      The entry point to run. Defaults to main.\n  -b/--binary-output         Print the program result in the binary output format.\n  -h/--help                  Print help information and exit.\n  -d/--device NAME           Use the first OpenCL device whose name contains the given string.\n  --default-group-size INT   The default size of OpenCL workgroups that are launched.\n  --default-num-groups INT   The default number of OpenCL workgroups that are launched.\n  --default-tile-size INT    The default tile size used when performing two-dimensional tiling.\n  --default-threshold INT    The default parallelism threshold.\n  --print-sizes              Print all sizes that can be set with -size or --tuning.\n  --size ASSIGNMENT          Set a configurable run-time parameter to the given value.\n  --tuning FILE              Read size=value assignments from the given file.\n  -p/--platform NAME         Use the first OpenCL platform whose name contains the given string.\n  --dump-opencl FILE         Dump the embedded OpenCL program to the indicated file.\n  --load-opencl FILE         Instead of using the embedded OpenCL program, load it from the indicated file.\n  --dump-opencl-binary FILE  Dump the compiled version of the embedded OpenCL program to the indicated file.\n  --load-opencl-binary FILE  Load an OpenCL binary from the indicated file.\n  --build-option OPT         Add an additional build option to the string passed to clBuildProgram().\n  -P/--profile               Gather profiling data while executing and print out a summary at the end.\n  --list-devices             List all OpenCL devices and platforms available on the system.\n");
            futhark_panic(1, "Unknown option: %s\n", argv[optind - 1]);
        }
    }
    return optind;
}
static void futrts_cli_entry_main(struct futhark_context *ctx)
{
    int64_t t_start, t_end;
    int time_runs = 0, profile_run = 0;
    
    // We do not want to profile all the initialisation.
    futhark_context_pause_profiling(ctx);
    // Declare and read input.
    set_binary_mode(stdin);
    
    int64_t read_value_30398;
    
    if (read_scalar(&i64_info, &read_value_30398) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      0, i64_info.type_name, strerror(errno));
    
    int64_t read_value_30399;
    
    if (read_scalar(&i64_info, &read_value_30399) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      1, i64_info.type_name, strerror(errno));
    
    struct futhark_f32_1d *read_value_30400;
    int64_t read_shape_30401[1];
    float *read_arr_30402 = NULL;
    
    errno = 0;
    if (read_array(&f32_info, (void **) &read_arr_30402, read_shape_30401, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s%s (errno: %s).\n", 2,
                      "[]", f32_info.type_name, strerror(errno));
    
    struct futhark_i64_1d *read_value_30403;
    int64_t read_shape_30404[1];
    int64_t *read_arr_30405 = NULL;
    
    errno = 0;
    if (read_array(&i64_info, (void **) &read_arr_30405, read_shape_30404, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s%s (errno: %s).\n", 3,
                      "[]", i64_info.type_name, strerror(errno));
    
    struct futhark_f32_1d *read_value_30406;
    int64_t read_shape_30407[1];
    float *read_arr_30408 = NULL;
    
    errno = 0;
    if (read_array(&f32_info, (void **) &read_arr_30408, read_shape_30407, 1) !=
        0)
        futhark_panic(1, "Cannot read input #%d of type %s%s (errno: %s).\n", 4,
                      "[]", f32_info.type_name, strerror(errno));
    
    float read_value_30409;
    
    if (read_scalar(&f32_info, &read_value_30409) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      5, f32_info.type_name, strerror(errno));
    
    float read_value_30410;
    
    if (read_scalar(&f32_info, &read_value_30410) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      6, f32_info.type_name, strerror(errno));
    
    float read_value_30411;
    
    if (read_scalar(&f32_info, &read_value_30411) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      7, f32_info.type_name, strerror(errno));
    
    float read_value_30412;
    
    if (read_scalar(&f32_info, &read_value_30412) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      8, f32_info.type_name, strerror(errno));
    if (end_of_input() != 0)
        futhark_panic(1, "Expected EOF on stdin after reading input for %s.\n",
                      "\"main\"");
    
    float result_30413;
    struct futhark_f32_1d *result_30414;
    
    if (perform_warmup) {
        int r;
        
        ;
        ;
        assert((read_value_30400 = futhark_new_f32_1d(ctx, read_arr_30402,
                                                      read_shape_30401[0])) !=
            0);
        assert((read_value_30403 = futhark_new_i64_1d(ctx, read_arr_30405,
                                                      read_shape_30404[0])) !=
            0);
        assert((read_value_30406 = futhark_new_f32_1d(ctx, read_arr_30408,
                                                      read_shape_30407[0])) !=
            0);
        ;
        ;
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_main(ctx, &result_30413, &result_30414,
                               read_value_30398, read_value_30399,
                               read_value_30400, read_value_30403,
                               read_value_30406, read_value_30409,
                               read_value_30410, read_value_30411,
                               read_value_30412);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        assert(futhark_free_f32_1d(ctx, read_value_30400) == 0);
        assert(futhark_free_i64_1d(ctx, read_value_30403) == 0);
        assert(futhark_free_f32_1d(ctx, read_value_30406) == 0);
        ;
        ;
        ;
        ;
        ;
        assert(futhark_free_f32_1d(ctx, result_30414) == 0);
    }
    time_runs = 1;
    // Proper run.
    for (int run = 0; run < num_runs; run++) {
        // Only profile last run.
        profile_run = run == num_runs - 1;
        
        int r;
        
        ;
        ;
        assert((read_value_30400 = futhark_new_f32_1d(ctx, read_arr_30402,
                                                      read_shape_30401[0])) !=
            0);
        assert((read_value_30403 = futhark_new_i64_1d(ctx, read_arr_30405,
                                                      read_shape_30404[0])) !=
            0);
        assert((read_value_30406 = futhark_new_f32_1d(ctx, read_arr_30408,
                                                      read_shape_30407[0])) !=
            0);
        ;
        ;
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_main(ctx, &result_30413, &result_30414,
                               read_value_30398, read_value_30399,
                               read_value_30400, read_value_30403,
                               read_value_30406, read_value_30409,
                               read_value_30410, read_value_30411,
                               read_value_30412);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        assert(futhark_free_f32_1d(ctx, read_value_30400) == 0);
        assert(futhark_free_i64_1d(ctx, read_value_30403) == 0);
        assert(futhark_free_f32_1d(ctx, read_value_30406) == 0);
        ;
        ;
        ;
        ;
        if (run < num_runs - 1) {
            ;
            assert(futhark_free_f32_1d(ctx, result_30414) == 0);
        }
    }
    ;
    ;
    free(read_arr_30402);
    free(read_arr_30405);
    free(read_arr_30408);
    ;
    ;
    ;
    ;
    if (binary_output)
        set_binary_mode(stdout);
    write_scalar(stdout, binary_output, &f32_info, &result_30413);
    printf("\n");
    {
        float *arr = calloc(sizeof(float), futhark_shape_f32_1d(ctx,
                                                                result_30414)[0]);
        
        assert(arr != NULL);
        assert(futhark_values_f32_1d(ctx, result_30414, arr) == 0);
        write_array(stdout, binary_output, &f32_info, arr,
                    futhark_shape_f32_1d(ctx, result_30414), 1);
        free(arr);
    }
    printf("\n");
    ;
    assert(futhark_free_f32_1d(ctx, result_30414) == 0);
}
static void futrts_cli_entry_test(struct futhark_context *ctx)
{
    int64_t t_start, t_end;
    int time_runs = 0, profile_run = 0;
    
    // We do not want to profile all the initialisation.
    futhark_context_pause_profiling(ctx);
    // Declare and read input.
    set_binary_mode(stdin);
    
    int64_t read_value_30415;
    
    if (read_scalar(&i64_info, &read_value_30415) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      0, i64_info.type_name, strerror(errno));
    
    int64_t read_value_30416;
    
    if (read_scalar(&i64_info, &read_value_30416) != 0)
        futhark_panic(1,
                      "Error when reading input #%d of type %s (errno: %s).\n",
                      1, i64_info.type_name, strerror(errno));
    if (end_of_input() != 0)
        futhark_panic(1, "Expected EOF on stdin after reading input for %s.\n",
                      "\"test\"");
    
    float result_30417;
    
    if (perform_warmup) {
        int r;
        
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_test(ctx, &result_30417, read_value_30415,
                               read_value_30416);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        ;
    }
    time_runs = 1;
    // Proper run.
    for (int run = 0; run < num_runs; run++) {
        // Only profile last run.
        profile_run = run == num_runs - 1;
        
        int r;
        
        ;
        ;
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_test(ctx, &result_30417, read_value_30415,
                               read_value_30416);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
        ;
        if (run < num_runs - 1) {
            ;
        }
    }
    ;
    ;
    if (binary_output)
        set_binary_mode(stdout);
    write_scalar(stdout, binary_output, &f32_info, &result_30417);
    printf("\n");
    ;
}
typedef void entry_point_fun(struct futhark_context *);
struct entry_point_entry {
    const char *name;
    entry_point_fun *fun;
} ;
int main(int argc, char **argv)
{
    fut_progname = argv[0];
    
    struct entry_point_entry entry_points[] = {{.name ="main", .fun =
                                                futrts_cli_entry_main}, {.name =
                                                                         "test",
                                                                         .fun =
                                                                         futrts_cli_entry_test}};
    struct futhark_context_config *cfg = futhark_context_config_new();
    
    assert(cfg != NULL);
    
    int parsed_options = parse_options(cfg, argc, argv);
    
    argc -= parsed_options;
    argv += parsed_options;
    if (argc != 0)
        futhark_panic(1, "Excess non-option: %s\n", argv[0]);
    
    struct futhark_context *ctx = futhark_context_new(cfg);
    
    assert(ctx != NULL);
    
    char *error = futhark_context_get_error(ctx);
    
    if (error != NULL)
        futhark_panic(1, "%s", error);
    if (entry_point != NULL) {
        int num_entry_points = sizeof(entry_points) / sizeof(entry_points[0]);
        entry_point_fun *entry_point_fun = NULL;
        
        for (int i = 0; i < num_entry_points; i++) {
            if (strcmp(entry_points[i].name, entry_point) == 0) {
                entry_point_fun = entry_points[i].fun;
                break;
            }
        }
        if (entry_point_fun == NULL) {
            fprintf(stderr,
                    "No entry point '%s'.  Select another with --entry-point.  Options are:\n",
                    entry_point);
            for (int i = 0; i < num_entry_points; i++)
                fprintf(stderr, "%s\n", entry_points[i].name);
            return 1;
        }
        entry_point_fun(ctx);
        if (runtime_file != NULL)
            fclose(runtime_file);
        
        char *report = futhark_context_report(ctx);
        
        fputs(report, stderr);
        free(report);
    }
    futhark_context_free(ctx);
    futhark_context_config_free(cfg);
    return 0;
}
#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <inttypes.h>
#include <ctype.h>
#include <errno.h>
#include <assert.h>
#define CL_TARGET_OPENCL_VERSION 120
#define CL_USE_DEPRECATED_OPENCL_1_2_APIS
#ifdef __APPLE__
#define CL_SILENCE_DEPRECATION
#include <OpenCL/cl.h>
#else
#include <CL/cl.h>
#endif

// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.

static inline uint8_t add8(uint8_t x, uint8_t y)
{
    return x + y;
}
static inline uint16_t add16(uint16_t x, uint16_t y)
{
    return x + y;
}
static inline uint32_t add32(uint32_t x, uint32_t y)
{
    return x + y;
}
static inline uint64_t add64(uint64_t x, uint64_t y)
{
    return x + y;
}
static inline uint8_t sub8(uint8_t x, uint8_t y)
{
    return x - y;
}
static inline uint16_t sub16(uint16_t x, uint16_t y)
{
    return x - y;
}
static inline uint32_t sub32(uint32_t x, uint32_t y)
{
    return x - y;
}
static inline uint64_t sub64(uint64_t x, uint64_t y)
{
    return x - y;
}
static inline uint8_t mul8(uint8_t x, uint8_t y)
{
    return x * y;
}
static inline uint16_t mul16(uint16_t x, uint16_t y)
{
    return x * y;
}
static inline uint32_t mul32(uint32_t x, uint32_t y)
{
    return x * y;
}
static inline uint64_t mul64(uint64_t x, uint64_t y)
{
    return x * y;
}
static inline uint8_t udiv8(uint8_t x, uint8_t y)
{
    return x / y;
}
static inline uint16_t udiv16(uint16_t x, uint16_t y)
{
    return x / y;
}
static inline uint32_t udiv32(uint32_t x, uint32_t y)
{
    return x / y;
}
static inline uint64_t udiv64(uint64_t x, uint64_t y)
{
    return x / y;
}
static inline uint8_t udiv_up8(uint8_t x, uint8_t y)
{
    return (x + y - 1) / y;
}
static inline uint16_t udiv_up16(uint16_t x, uint16_t y)
{
    return (x + y - 1) / y;
}
static inline uint32_t udiv_up32(uint32_t x, uint32_t y)
{
    return (x + y - 1) / y;
}
static inline uint64_t udiv_up64(uint64_t x, uint64_t y)
{
    return (x + y - 1) / y;
}
static inline uint8_t umod8(uint8_t x, uint8_t y)
{
    return x % y;
}
static inline uint16_t umod16(uint16_t x, uint16_t y)
{
    return x % y;
}
static inline uint32_t umod32(uint32_t x, uint32_t y)
{
    return x % y;
}
static inline uint64_t umod64(uint64_t x, uint64_t y)
{
    return x % y;
}
static inline uint8_t udiv_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint16_t udiv_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint32_t udiv_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint64_t udiv_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint8_t umod_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint16_t umod_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint32_t umod_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint64_t umod_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int8_t sdiv8(int8_t x, int8_t y)
{
    int8_t q = x / y;
    int8_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int16_t sdiv16(int16_t x, int16_t y)
{
    int16_t q = x / y;
    int16_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int32_t sdiv32(int32_t x, int32_t y)
{
    int32_t q = x / y;
    int32_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int64_t sdiv64(int64_t x, int64_t y)
{
    int64_t q = x / y;
    int64_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int8_t sdiv_up8(int8_t x, int8_t y)
{
    return sdiv8(x + y - 1, y);
}
static inline int16_t sdiv_up16(int16_t x, int16_t y)
{
    return sdiv16(x + y - 1, y);
}
static inline int32_t sdiv_up32(int32_t x, int32_t y)
{
    return sdiv32(x + y - 1, y);
}
static inline int64_t sdiv_up64(int64_t x, int64_t y)
{
    return sdiv64(x + y - 1, y);
}
static inline int8_t smod8(int8_t x, int8_t y)
{
    int8_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int16_t smod16(int16_t x, int16_t y)
{
    int16_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int32_t smod32(int32_t x, int32_t y)
{
    int32_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int64_t smod64(int64_t x, int64_t y)
{
    int64_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int8_t sdiv_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : sdiv8(x, y);
}
static inline int16_t sdiv_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : sdiv16(x, y);
}
static inline int32_t sdiv_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : sdiv32(x, y);
}
static inline int64_t sdiv_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : sdiv64(x, y);
}
static inline int8_t sdiv_up_safe8(int8_t x, int8_t y)
{
    return sdiv_safe8(x + y - 1, y);
}
static inline int16_t sdiv_up_safe16(int16_t x, int16_t y)
{
    return sdiv_safe16(x + y - 1, y);
}
static inline int32_t sdiv_up_safe32(int32_t x, int32_t y)
{
    return sdiv_safe32(x + y - 1, y);
}
static inline int64_t sdiv_up_safe64(int64_t x, int64_t y)
{
    return sdiv_safe64(x + y - 1, y);
}
static inline int8_t smod_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : smod8(x, y);
}
static inline int16_t smod_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : smod16(x, y);
}
static inline int32_t smod_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : smod32(x, y);
}
static inline int64_t smod_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : smod64(x, y);
}
static inline int8_t squot8(int8_t x, int8_t y)
{
    return x / y;
}
static inline int16_t squot16(int16_t x, int16_t y)
{
    return x / y;
}
static inline int32_t squot32(int32_t x, int32_t y)
{
    return x / y;
}
static inline int64_t squot64(int64_t x, int64_t y)
{
    return x / y;
}
static inline int8_t srem8(int8_t x, int8_t y)
{
    return x % y;
}
static inline int16_t srem16(int16_t x, int16_t y)
{
    return x % y;
}
static inline int32_t srem32(int32_t x, int32_t y)
{
    return x % y;
}
static inline int64_t srem64(int64_t x, int64_t y)
{
    return x % y;
}
static inline int8_t squot_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int16_t squot_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int32_t squot_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int64_t squot_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int8_t srem_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int16_t srem_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int32_t srem_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int64_t srem_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int8_t smin8(int8_t x, int8_t y)
{
    return x < y ? x : y;
}
static inline int16_t smin16(int16_t x, int16_t y)
{
    return x < y ? x : y;
}
static inline int32_t smin32(int32_t x, int32_t y)
{
    return x < y ? x : y;
}
static inline int64_t smin64(int64_t x, int64_t y)
{
    return x < y ? x : y;
}
static inline uint8_t umin8(uint8_t x, uint8_t y)
{
    return x < y ? x : y;
}
static inline uint16_t umin16(uint16_t x, uint16_t y)
{
    return x < y ? x : y;
}
static inline uint32_t umin32(uint32_t x, uint32_t y)
{
    return x < y ? x : y;
}
static inline uint64_t umin64(uint64_t x, uint64_t y)
{
    return x < y ? x : y;
}
static inline int8_t smax8(int8_t x, int8_t y)
{
    return x < y ? y : x;
}
static inline int16_t smax16(int16_t x, int16_t y)
{
    return x < y ? y : x;
}
static inline int32_t smax32(int32_t x, int32_t y)
{
    return x < y ? y : x;
}
static inline int64_t smax64(int64_t x, int64_t y)
{
    return x < y ? y : x;
}
static inline uint8_t umax8(uint8_t x, uint8_t y)
{
    return x < y ? y : x;
}
static inline uint16_t umax16(uint16_t x, uint16_t y)
{
    return x < y ? y : x;
}
static inline uint32_t umax32(uint32_t x, uint32_t y)
{
    return x < y ? y : x;
}
static inline uint64_t umax64(uint64_t x, uint64_t y)
{
    return x < y ? y : x;
}
static inline uint8_t shl8(uint8_t x, uint8_t y)
{
    return x << y;
}
static inline uint16_t shl16(uint16_t x, uint16_t y)
{
    return x << y;
}
static inline uint32_t shl32(uint32_t x, uint32_t y)
{
    return x << y;
}
static inline uint64_t shl64(uint64_t x, uint64_t y)
{
    return x << y;
}
static inline uint8_t lshr8(uint8_t x, uint8_t y)
{
    return x >> y;
}
static inline uint16_t lshr16(uint16_t x, uint16_t y)
{
    return x >> y;
}
static inline uint32_t lshr32(uint32_t x, uint32_t y)
{
    return x >> y;
}
static inline uint64_t lshr64(uint64_t x, uint64_t y)
{
    return x >> y;
}
static inline int8_t ashr8(int8_t x, int8_t y)
{
    return x >> y;
}
static inline int16_t ashr16(int16_t x, int16_t y)
{
    return x >> y;
}
static inline int32_t ashr32(int32_t x, int32_t y)
{
    return x >> y;
}
static inline int64_t ashr64(int64_t x, int64_t y)
{
    return x >> y;
}
static inline uint8_t and8(uint8_t x, uint8_t y)
{
    return x & y;
}
static inline uint16_t and16(uint16_t x, uint16_t y)
{
    return x & y;
}
static inline uint32_t and32(uint32_t x, uint32_t y)
{
    return x & y;
}
static inline uint64_t and64(uint64_t x, uint64_t y)
{
    return x & y;
}
static inline uint8_t or8(uint8_t x, uint8_t y)
{
    return x | y;
}
static inline uint16_t or16(uint16_t x, uint16_t y)
{
    return x | y;
}
static inline uint32_t or32(uint32_t x, uint32_t y)
{
    return x | y;
}
static inline uint64_t or64(uint64_t x, uint64_t y)
{
    return x | y;
}
static inline uint8_t xor8(uint8_t x, uint8_t y)
{
    return x ^ y;
}
static inline uint16_t xor16(uint16_t x, uint16_t y)
{
    return x ^ y;
}
static inline uint32_t xor32(uint32_t x, uint32_t y)
{
    return x ^ y;
}
static inline uint64_t xor64(uint64_t x, uint64_t y)
{
    return x ^ y;
}
static inline bool ult8(uint8_t x, uint8_t y)
{
    return x < y;
}
static inline bool ult16(uint16_t x, uint16_t y)
{
    return x < y;
}
static inline bool ult32(uint32_t x, uint32_t y)
{
    return x < y;
}
static inline bool ult64(uint64_t x, uint64_t y)
{
    return x < y;
}
static inline bool ule8(uint8_t x, uint8_t y)
{
    return x <= y;
}
static inline bool ule16(uint16_t x, uint16_t y)
{
    return x <= y;
}
static inline bool ule32(uint32_t x, uint32_t y)
{
    return x <= y;
}
static inline bool ule64(uint64_t x, uint64_t y)
{
    return x <= y;
}
static inline bool slt8(int8_t x, int8_t y)
{
    return x < y;
}
static inline bool slt16(int16_t x, int16_t y)
{
    return x < y;
}
static inline bool slt32(int32_t x, int32_t y)
{
    return x < y;
}
static inline bool slt64(int64_t x, int64_t y)
{
    return x < y;
}
static inline bool sle8(int8_t x, int8_t y)
{
    return x <= y;
}
static inline bool sle16(int16_t x, int16_t y)
{
    return x <= y;
}
static inline bool sle32(int32_t x, int32_t y)
{
    return x <= y;
}
static inline bool sle64(int64_t x, int64_t y)
{
    return x <= y;
}
static inline int8_t pow8(int8_t x, int8_t y)
{
    int8_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int16_t pow16(int16_t x, int16_t y)
{
    int16_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int32_t pow32(int32_t x, int32_t y)
{
    int32_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int64_t pow64(int64_t x, int64_t y)
{
    int64_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline bool itob_i8_bool(int8_t x)
{
    return x;
}
static inline bool itob_i16_bool(int16_t x)
{
    return x;
}
static inline bool itob_i32_bool(int32_t x)
{
    return x;
}
static inline bool itob_i64_bool(int64_t x)
{
    return x;
}
static inline int8_t btoi_bool_i8(bool x)
{
    return x;
}
static inline int16_t btoi_bool_i16(bool x)
{
    return x;
}
static inline int32_t btoi_bool_i32(bool x)
{
    return x;
}
static inline int64_t btoi_bool_i64(bool x)
{
    return x;
}
#define sext_i8_i8(x) ((int8_t) (int8_t) x)
#define sext_i8_i16(x) ((int16_t) (int8_t) x)
#define sext_i8_i32(x) ((int32_t) (int8_t) x)
#define sext_i8_i64(x) ((int64_t) (int8_t) x)
#define sext_i16_i8(x) ((int8_t) (int16_t) x)
#define sext_i16_i16(x) ((int16_t) (int16_t) x)
#define sext_i16_i32(x) ((int32_t) (int16_t) x)
#define sext_i16_i64(x) ((int64_t) (int16_t) x)
#define sext_i32_i8(x) ((int8_t) (int32_t) x)
#define sext_i32_i16(x) ((int16_t) (int32_t) x)
#define sext_i32_i32(x) ((int32_t) (int32_t) x)
#define sext_i32_i64(x) ((int64_t) (int32_t) x)
#define sext_i64_i8(x) ((int8_t) (int64_t) x)
#define sext_i64_i16(x) ((int16_t) (int64_t) x)
#define sext_i64_i32(x) ((int32_t) (int64_t) x)
#define sext_i64_i64(x) ((int64_t) (int64_t) x)
#define zext_i8_i8(x) ((int8_t) (uint8_t) x)
#define zext_i8_i16(x) ((int16_t) (uint8_t) x)
#define zext_i8_i32(x) ((int32_t) (uint8_t) x)
#define zext_i8_i64(x) ((int64_t) (uint8_t) x)
#define zext_i16_i8(x) ((int8_t) (uint16_t) x)
#define zext_i16_i16(x) ((int16_t) (uint16_t) x)
#define zext_i16_i32(x) ((int32_t) (uint16_t) x)
#define zext_i16_i64(x) ((int64_t) (uint16_t) x)
#define zext_i32_i8(x) ((int8_t) (uint32_t) x)
#define zext_i32_i16(x) ((int16_t) (uint32_t) x)
#define zext_i32_i32(x) ((int32_t) (uint32_t) x)
#define zext_i32_i64(x) ((int64_t) (uint32_t) x)
#define zext_i64_i8(x) ((int8_t) (uint64_t) x)
#define zext_i64_i16(x) ((int16_t) (uint64_t) x)
#define zext_i64_i32(x) ((int32_t) (uint64_t) x)
#define zext_i64_i64(x) ((int64_t) (uint64_t) x)
#if defined(__OPENCL_VERSION__)
static int32_t futrts_popc8(int8_t x)
{
    return popcount(x);
}
static int32_t futrts_popc16(int16_t x)
{
    return popcount(x);
}
static int32_t futrts_popc32(int32_t x)
{
    return popcount(x);
}
static int32_t futrts_popc64(int64_t x)
{
    return popcount(x);
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_popc8(int8_t x)
{
    return __popc(zext_i8_i32(x));
}
static int32_t futrts_popc16(int16_t x)
{
    return __popc(zext_i16_i32(x));
}
static int32_t futrts_popc32(int32_t x)
{
    return __popc(x);
}
static int32_t futrts_popc64(int64_t x)
{
    return __popcll(x);
}
#else
static int32_t futrts_popc8(int8_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc16(int16_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc32(int32_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc64(int64_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
#endif
#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    return mul_hi(a, b);
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    return mul_hi(a, b);
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    return mul_hi(a, b);
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    return mul_hi(a, b);
}
#elif defined(__CUDA_ARCH__)
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    uint16_t aa = a;
    uint16_t bb = b;
    
    return aa * bb >> 8;
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    uint32_t aa = a;
    uint32_t bb = b;
    
    return aa * bb >> 16;
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    return mulhi(a, b);
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    return mul64hi(a, b);
}
#else
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    uint16_t aa = a;
    uint16_t bb = b;
    
    return aa * bb >> 8;
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    uint32_t aa = a;
    uint32_t bb = b;
    
    return aa * bb >> 16;
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    uint64_t aa = a;
    uint64_t bb = b;
    
    return aa * bb >> 32;
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    __uint128_t aa = a;
    __uint128_t bb = b;
    
    return aa * bb >> 64;
}
#endif
#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)
{
    return mad_hi(a, b, c);
}
static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)
{
    return mad_hi(a, b, c);
}
static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)
{
    return mad_hi(a, b, c);
}
static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)
{
    return mad_hi(a, b, c);
}
#else
static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)
{
    return futrts_mul_hi8(a, b) + c;
}
static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)
{
    return futrts_mul_hi16(a, b) + c;
}
static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)
{
    return futrts_mul_hi32(a, b) + c;
}
static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)
{
    return futrts_mul_hi64(a, b) + c;
}
#endif
#if defined(__OPENCL_VERSION__)
static int32_t futrts_clzz8(int8_t x)
{
    return clz(x);
}
static int32_t futrts_clzz16(int16_t x)
{
    return clz(x);
}
static int32_t futrts_clzz32(int32_t x)
{
    return clz(x);
}
static int32_t futrts_clzz64(int64_t x)
{
    return clz(x);
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_clzz8(int8_t x)
{
    return __clz(zext_i8_i32(x)) - 24;
}
static int32_t futrts_clzz16(int16_t x)
{
    return __clz(zext_i16_i32(x)) - 16;
}
static int32_t futrts_clzz32(int32_t x)
{
    return __clz(x);
}
static int32_t futrts_clzz64(int64_t x)
{
    return __clzll(x);
}
#else
static int32_t futrts_clzz8(int8_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz16(int16_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz32(int32_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz64(int64_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
#endif
#if defined(__OPENCL_VERSION__)
static int32_t futrts_ctzz8(int8_t x)
{
    int i = 0;
    
    for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz16(int16_t x)
{
    int i = 0;
    
    for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz32(int32_t x)
{
    int i = 0;
    
    for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz64(int64_t x)
{
    int i = 0;
    
    for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_ctzz8(int8_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 8 : y - 1;
}
static int32_t futrts_ctzz16(int16_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 16 : y - 1;
}
static int32_t futrts_ctzz32(int32_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 32 : y - 1;
}
static int32_t futrts_ctzz64(int64_t x)
{
    int y = __ffsll(x);
    
    return y == 0 ? 64 : y - 1;
}
#else
static int32_t futrts_ctzz8(int8_t x)
{
    return x == 0 ? 8 : __builtin_ctz((uint32_t) x);
}
static int32_t futrts_ctzz16(int16_t x)
{
    return x == 0 ? 16 : __builtin_ctz((uint32_t) x);
}
static int32_t futrts_ctzz32(int32_t x)
{
    return x == 0 ? 32 : __builtin_ctz(x);
}
static int32_t futrts_ctzz64(int64_t x)
{
    return x == 0 ? 64 : __builtin_ctzl(x);
}
#endif
static inline float fdiv32(float x, float y)
{
    return x / y;
}
static inline float fadd32(float x, float y)
{
    return x + y;
}
static inline float fsub32(float x, float y)
{
    return x - y;
}
static inline float fmul32(float x, float y)
{
    return x * y;
}
static inline float fmin32(float x, float y)
{
    return fmin(x, y);
}
static inline float fmax32(float x, float y)
{
    return fmax(x, y);
}
static inline float fpow32(float x, float y)
{
    return pow(x, y);
}
static inline bool cmplt32(float x, float y)
{
    return x < y;
}
static inline bool cmple32(float x, float y)
{
    return x <= y;
}
static inline float sitofp_i8_f32(int8_t x)
{
    return (float) x;
}
static inline float sitofp_i16_f32(int16_t x)
{
    return (float) x;
}
static inline float sitofp_i32_f32(int32_t x)
{
    return (float) x;
}
static inline float sitofp_i64_f32(int64_t x)
{
    return (float) x;
}
static inline float uitofp_i8_f32(uint8_t x)
{
    return (float) x;
}
static inline float uitofp_i16_f32(uint16_t x)
{
    return (float) x;
}
static inline float uitofp_i32_f32(uint32_t x)
{
    return (float) x;
}
static inline float uitofp_i64_f32(uint64_t x)
{
    return (float) x;
}
static inline int8_t fptosi_f32_i8(float x)
{
    return (int8_t) x;
}
static inline int16_t fptosi_f32_i16(float x)
{
    return (int16_t) x;
}
static inline int32_t fptosi_f32_i32(float x)
{
    return (int32_t) x;
}
static inline int64_t fptosi_f32_i64(float x)
{
    return (int64_t) x;
}
static inline uint8_t fptoui_f32_i8(float x)
{
    return (uint8_t) x;
}
static inline uint16_t fptoui_f32_i16(float x)
{
    return (uint16_t) x;
}
static inline uint32_t fptoui_f32_i32(float x)
{
    return (uint32_t) x;
}
static inline uint64_t fptoui_f32_i64(float x)
{
    return (uint64_t) x;
}
static inline double fdiv64(double x, double y)
{
    return x / y;
}
static inline double fadd64(double x, double y)
{
    return x + y;
}
static inline double fsub64(double x, double y)
{
    return x - y;
}
static inline double fmul64(double x, double y)
{
    return x * y;
}
static inline double fmin64(double x, double y)
{
    return fmin(x, y);
}
static inline double fmax64(double x, double y)
{
    return fmax(x, y);
}
static inline double fpow64(double x, double y)
{
    return pow(x, y);
}
static inline bool cmplt64(double x, double y)
{
    return x < y;
}
static inline bool cmple64(double x, double y)
{
    return x <= y;
}
static inline double sitofp_i8_f64(int8_t x)
{
    return (double) x;
}
static inline double sitofp_i16_f64(int16_t x)
{
    return (double) x;
}
static inline double sitofp_i32_f64(int32_t x)
{
    return (double) x;
}
static inline double sitofp_i64_f64(int64_t x)
{
    return (double) x;
}
static inline double uitofp_i8_f64(uint8_t x)
{
    return (double) x;
}
static inline double uitofp_i16_f64(uint16_t x)
{
    return (double) x;
}
static inline double uitofp_i32_f64(uint32_t x)
{
    return (double) x;
}
static inline double uitofp_i64_f64(uint64_t x)
{
    return (double) x;
}
static inline int8_t fptosi_f64_i8(double x)
{
    return (int8_t) x;
}
static inline int16_t fptosi_f64_i16(double x)
{
    return (int16_t) x;
}
static inline int32_t fptosi_f64_i32(double x)
{
    return (int32_t) x;
}
static inline int64_t fptosi_f64_i64(double x)
{
    return (int64_t) x;
}
static inline uint8_t fptoui_f64_i8(double x)
{
    return (uint8_t) x;
}
static inline uint16_t fptoui_f64_i16(double x)
{
    return (uint16_t) x;
}
static inline uint32_t fptoui_f64_i32(double x)
{
    return (uint32_t) x;
}
static inline uint64_t fptoui_f64_i64(double x)
{
    return (uint64_t) x;
}
static inline float fpconv_f32_f32(float x)
{
    return (float) x;
}
static inline double fpconv_f32_f64(float x)
{
    return (double) x;
}
static inline float fpconv_f64_f32(double x)
{
    return (float) x;
}
static inline double fpconv_f64_f64(double x)
{
    return (double) x;
}
static inline float futrts_log32(float x)
{
    return log(x);
}
static inline float futrts_log2_32(float x)
{
    return log2(x);
}
static inline float futrts_log10_32(float x)
{
    return log10(x);
}
static inline float futrts_sqrt32(float x)
{
    return sqrt(x);
}
static inline float futrts_exp32(float x)
{
    return exp(x);
}
static inline float futrts_cos32(float x)
{
    return cos(x);
}
static inline float futrts_sin32(float x)
{
    return sin(x);
}
static inline float futrts_tan32(float x)
{
    return tan(x);
}
static inline float futrts_acos32(float x)
{
    return acos(x);
}
static inline float futrts_asin32(float x)
{
    return asin(x);
}
static inline float futrts_atan32(float x)
{
    return atan(x);
}
static inline float futrts_cosh32(float x)
{
    return cosh(x);
}
static inline float futrts_sinh32(float x)
{
    return sinh(x);
}
static inline float futrts_tanh32(float x)
{
    return tanh(x);
}
static inline float futrts_acosh32(float x)
{
    return acosh(x);
}
static inline float futrts_asinh32(float x)
{
    return asinh(x);
}
static inline float futrts_atanh32(float x)
{
    return atanh(x);
}
static inline float futrts_atan2_32(float x, float y)
{
    return atan2(x, y);
}
static inline float futrts_gamma32(float x)
{
    return tgamma(x);
}
static inline float futrts_lgamma32(float x)
{
    return lgamma(x);
}
static inline bool futrts_isnan32(float x)
{
    return isnan(x);
}
static inline bool futrts_isinf32(float x)
{
    return isinf(x);
}
static inline int32_t futrts_to_bits32(float x)
{
    union {
        float f;
        int32_t t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline float futrts_from_bits32(int32_t x)
{
    union {
        int32_t f;
        float t;
    } p;
    
    p.f = x;
    return p.t;
}
#ifdef __OPENCL_VERSION__
static inline float fmod32(float x, float y)
{
    return fmod(x, y);
}
static inline float futrts_round32(float x)
{
    return rint(x);
}
static inline float futrts_floor32(float x)
{
    return floor(x);
}
static inline float futrts_ceil32(float x)
{
    return ceil(x);
}
static inline float futrts_lerp32(float v0, float v1, float t)
{
    return mix(v0, v1, t);
}
static inline float futrts_mad32(float a, float b, float c)
{
    return mad(a, b, c);
}
static inline float futrts_fma32(float a, float b, float c)
{
    return fma(a, b, c);
}
#else
static inline float fmod32(float x, float y)
{
    return fmodf(x, y);
}
static inline float futrts_round32(float x)
{
    return rintf(x);
}
static inline float futrts_floor32(float x)
{
    return floorf(x);
}
static inline float futrts_ceil32(float x)
{
    return ceilf(x);
}
static inline float futrts_lerp32(float v0, float v1, float t)
{
    return v0 + (v1 - v0) * t;
}
static inline float futrts_mad32(float a, float b, float c)
{
    return a * b + c;
}
static inline float futrts_fma32(float a, float b, float c)
{
    return fmaf(a, b, c);
}
#endif
static inline double futrts_log64(double x)
{
    return log(x);
}
static inline double futrts_log2_64(double x)
{
    return log2(x);
}
static inline double futrts_log10_64(double x)
{
    return log10(x);
}
static inline double futrts_sqrt64(double x)
{
    return sqrt(x);
}
static inline double futrts_exp64(double x)
{
    return exp(x);
}
static inline double futrts_cos64(double x)
{
    return cos(x);
}
static inline double futrts_sin64(double x)
{
    return sin(x);
}
static inline double futrts_tan64(double x)
{
    return tan(x);
}
static inline double futrts_acos64(double x)
{
    return acos(x);
}
static inline double futrts_asin64(double x)
{
    return asin(x);
}
static inline double futrts_atan64(double x)
{
    return atan(x);
}
static inline double futrts_cosh64(double x)
{
    return cosh(x);
}
static inline double futrts_sinh64(double x)
{
    return sinh(x);
}
static inline double futrts_tanh64(double x)
{
    return tanh(x);
}
static inline double futrts_acosh64(double x)
{
    return acosh(x);
}
static inline double futrts_asinh64(double x)
{
    return asinh(x);
}
static inline double futrts_atanh64(double x)
{
    return atanh(x);
}
static inline double futrts_atan2_64(double x, double y)
{
    return atan2(x, y);
}
static inline double futrts_gamma64(double x)
{
    return tgamma(x);
}
static inline double futrts_lgamma64(double x)
{
    return lgamma(x);
}
static inline double futrts_fma64(double a, double b, double c)
{
    return fma(a, b, c);
}
static inline double futrts_round64(double x)
{
    return rint(x);
}
static inline double futrts_ceil64(double x)
{
    return ceil(x);
}
static inline double futrts_floor64(double x)
{
    return floor(x);
}
static inline bool futrts_isnan64(double x)
{
    return isnan(x);
}
static inline bool futrts_isinf64(double x)
{
    return isinf(x);
}
static inline int64_t futrts_to_bits64(double x)
{
    union {
        double f;
        int64_t t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline double futrts_from_bits64(int64_t x)
{
    union {
        int64_t f;
        double t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline double fmod64(double x, double y)
{
    return fmod(x, y);
}
#ifdef __OPENCL_VERSION__
static inline double futrts_lerp64(double v0, double v1, double t)
{
    return mix(v0, v1, t);
}
static inline double futrts_mad64(double a, double b, double c)
{
    return mad(a, b, c);
}
#else
static inline double futrts_lerp64(double v0, double v1, double t)
{
    return v0 + (v1 - v0) * t;
}
static inline double futrts_mad64(double a, double b, double c)
{
    return a * b + c;
}
#endif
int init_constants(struct futhark_context *);
int free_constants(struct futhark_context *);
static int32_t mainzicounter_mem_realtype_30011[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_30018[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_30030[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_30072[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzihist_locks_mem_realtype_30084[100151];
static int32_t mainzicounter_mem_realtype_30095[10240];
static int32_t mainzicounter_mem_realtype_30167[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t mainzicounter_mem_realtype_30184[10240];
static int32_t mainzicounter_mem_realtype_30195[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static float testzistatic_array_realtype_30204[9] = {1.0F, -0.5F, 1.0F, 1.0F,
                                                     1.0F, 1.0F, 1.0F, 1.0F,
                                                     1.0F};
static int64_t testzistatic_array_realtype_30205[9] = {10, 20, 5, 5, 50, 20, 30,
                                                       15, 18};
static float testzistatic_array_realtype_30206[9] = {1.0F, 0.5F, 0.25F, 0.1F,
                                                     0.3F, 0.1F, 2.0F, 3.0F,
                                                     1.0F};
static int32_t testzicounter_mem_realtype_30207[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_30214[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_30226[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_30268[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzihist_locks_mem_realtype_30280[100151];
static int32_t testzicounter_mem_realtype_30291[10240];
static int32_t testzicounter_mem_realtype_30363[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
static int32_t testzicounter_mem_realtype_30380[10240];
static int32_t testzicounter_mem_realtype_30391[10] = {0, 0, 0, 0, 0, 0, 0, 0,
                                                       0, 0};
struct memblock_device {
    int *references;
    cl_mem mem;
    int64_t size;
    const char *desc;
} ;
struct memblock {
    int *references;
    char *mem;
    int64_t size;
    const char *desc;
} ;
typedef cl_mem fl_mem_t;
// Start of free_list.h.

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem_t mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries;        // Pointer to entries.
  int capacity;                           // Number of entries.
  int used;                               // Number of valid entries.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
}

static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem_t mem, const char *tag) {
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size,
                          size_t *size_out, fl_mem_t *mem_out) {
  int size_match = -1;
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid &&
        size <= l->entries[i].size &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    return 0;
  } else {
    return 1;
  }
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem_t *mem_out) {
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      return 0;
    }
  }

  return 1;
}

// End of free_list.h.

// Start of opencl.h.

#define OPENCL_SUCCEED_FATAL(e) opencl_succeed_fatal(e, #e, __FILE__, __LINE__)
#define OPENCL_SUCCEED_NONFATAL(e) opencl_succeed_nonfatal(e, #e, __FILE__, __LINE__)
// Take care not to override an existing error.
#define OPENCL_SUCCEED_OR_RETURN(e) {             \
    char *serror = OPENCL_SUCCEED_NONFATAL(e);    \
    if (serror) {                                 \
      if (!ctx->error) {                          \
        ctx->error = serror;                      \
        return bad;                               \
      } else {                                    \
        free(serror);                             \
      }                                           \
    }                                             \
  }

// OPENCL_SUCCEED_OR_RETURN returns the value of the variable 'bad' in
// scope.  By default, it will be this one.  Create a local variable
// of some other type if needed.  This is a bit of a hack, but it
// saves effort in the code generator.
static const int bad = 1;

struct opencl_config {
  int debugging;
  int profiling;
  int logging;
  int preferred_device_num;
  const char *preferred_platform;
  const char *preferred_device;
  int ignore_blacklist;

  const char* dump_program_to;
  const char* load_program_from;
  const char* dump_binary_to;
  const char* load_binary_from;

  size_t default_group_size;
  size_t default_num_groups;
  size_t default_tile_size;
  size_t default_threshold;

  int default_group_size_changed;
  int default_tile_size_changed;

  int num_sizes;
  const char **size_names;
  const char **size_vars;
  size_t *size_values;
  const char **size_classes;
};

static void opencl_config_init(struct opencl_config *cfg,
                               int num_sizes,
                               const char *size_names[],
                               const char *size_vars[],
                               size_t *size_values,
                               const char *size_classes[]) {
  cfg->debugging = 0;
  cfg->logging = 0;
  cfg->profiling = 0;
  cfg->preferred_device_num = 0;
  cfg->preferred_platform = "";
  cfg->preferred_device = "";
  cfg->ignore_blacklist = 0;
  cfg->dump_program_to = NULL;
  cfg->load_program_from = NULL;
  cfg->dump_binary_to = NULL;
  cfg->load_binary_from = NULL;

  // The following are dummy sizes that mean the concrete defaults
  // will be set during initialisation via hardware-inspection-based
  // heuristics.
  cfg->default_group_size = 0;
  cfg->default_num_groups = 0;
  cfg->default_tile_size = 0;
  cfg->default_threshold = 0;

  cfg->default_group_size_changed = 0;
  cfg->default_tile_size_changed = 0;

  cfg->num_sizes = num_sizes;
  cfg->size_names = size_names;
  cfg->size_vars = size_vars;
  cfg->size_values = size_values;
  cfg->size_classes = size_classes;
}

// A record of something that happened.
struct profiling_record {
  cl_event *event;
  int *runs;
  int64_t *runtime;
};

struct opencl_context {
  cl_device_id device;
  cl_context ctx;
  cl_command_queue queue;

  struct opencl_config cfg;

  struct free_list free_list;

  size_t max_group_size;
  size_t max_num_groups;
  size_t max_tile_size;
  size_t max_threshold;
  size_t max_local_memory;

  size_t lockstep_width;

  struct profiling_record *profiling_records;
  int profiling_records_capacity;
  int profiling_records_used;
};

struct opencl_device_option {
  cl_platform_id platform;
  cl_device_id device;
  cl_device_type device_type;
  char *platform_name;
  char *device_name;
};

// This function must be defined by the user.  It is invoked by
// setup_opencl() after the platform and device has been found, but
// before the program is loaded.  Its intended use is to tune
// constants based on the selected platform and device.
static void post_opencl_setup(struct opencl_context*, struct opencl_device_option*);

static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

static const char* opencl_error_string(cl_int err)
{
    switch (err) {
        case CL_SUCCESS:                            return "Success!";
        case CL_DEVICE_NOT_FOUND:                   return "Device not found.";
        case CL_DEVICE_NOT_AVAILABLE:               return "Device not available";
        case CL_COMPILER_NOT_AVAILABLE:             return "Compiler not available";
        case CL_MEM_OBJECT_ALLOCATION_FAILURE:      return "Memory object allocation failure";
        case CL_OUT_OF_RESOURCES:                   return "Out of resources";
        case CL_OUT_OF_HOST_MEMORY:                 return "Out of host memory";
        case CL_PROFILING_INFO_NOT_AVAILABLE:       return "Profiling information not available";
        case CL_MEM_COPY_OVERLAP:                   return "Memory copy overlap";
        case CL_IMAGE_FORMAT_MISMATCH:              return "Image format mismatch";
        case CL_IMAGE_FORMAT_NOT_SUPPORTED:         return "Image format not supported";
        case CL_BUILD_PROGRAM_FAILURE:              return "Program build failure";
        case CL_MAP_FAILURE:                        return "Map failure";
        case CL_INVALID_VALUE:                      return "Invalid value";
        case CL_INVALID_DEVICE_TYPE:                return "Invalid device type";
        case CL_INVALID_PLATFORM:                   return "Invalid platform";
        case CL_INVALID_DEVICE:                     return "Invalid device";
        case CL_INVALID_CONTEXT:                    return "Invalid context";
        case CL_INVALID_QUEUE_PROPERTIES:           return "Invalid queue properties";
        case CL_INVALID_COMMAND_QUEUE:              return "Invalid command queue";
        case CL_INVALID_HOST_PTR:                   return "Invalid host pointer";
        case CL_INVALID_MEM_OBJECT:                 return "Invalid memory object";
        case CL_INVALID_IMAGE_FORMAT_DESCRIPTOR:    return "Invalid image format descriptor";
        case CL_INVALID_IMAGE_SIZE:                 return "Invalid image size";
        case CL_INVALID_SAMPLER:                    return "Invalid sampler";
        case CL_INVALID_BINARY:                     return "Invalid binary";
        case CL_INVALID_BUILD_OPTIONS:              return "Invalid build options";
        case CL_INVALID_PROGRAM:                    return "Invalid program";
        case CL_INVALID_PROGRAM_EXECUTABLE:         return "Invalid program executable";
        case CL_INVALID_KERNEL_NAME:                return "Invalid kernel name";
        case CL_INVALID_KERNEL_DEFINITION:          return "Invalid kernel definition";
        case CL_INVALID_KERNEL:                     return "Invalid kernel";
        case CL_INVALID_ARG_INDEX:                  return "Invalid argument index";
        case CL_INVALID_ARG_VALUE:                  return "Invalid argument value";
        case CL_INVALID_ARG_SIZE:                   return "Invalid argument size";
        case CL_INVALID_KERNEL_ARGS:                return "Invalid kernel arguments";
        case CL_INVALID_WORK_DIMENSION:             return "Invalid work dimension";
        case CL_INVALID_WORK_GROUP_SIZE:            return "Invalid work group size";
        case CL_INVALID_WORK_ITEM_SIZE:             return "Invalid work item size";
        case CL_INVALID_GLOBAL_OFFSET:              return "Invalid global offset";
        case CL_INVALID_EVENT_WAIT_LIST:            return "Invalid event wait list";
        case CL_INVALID_EVENT:                      return "Invalid event";
        case CL_INVALID_OPERATION:                  return "Invalid operation";
        case CL_INVALID_GL_OBJECT:                  return "Invalid OpenGL object";
        case CL_INVALID_BUFFER_SIZE:                return "Invalid buffer size";
        case CL_INVALID_MIP_LEVEL:                  return "Invalid mip-map level";
        default:                                    return "Unknown";
    }
}

static void opencl_succeed_fatal(unsigned int ret,
                                 const char *call,
                                 const char *file,
                                 int line) {
  if (ret != CL_SUCCESS) {
    futhark_panic(-1, "%s:%d: OpenCL call\n  %s\nfailed with error code %d (%s)\n",
          file, line, call, ret, opencl_error_string(ret));
  }
}

static char* opencl_succeed_nonfatal(unsigned int ret,
                                     const char *call,
                                     const char *file,
                                     int line) {
  if (ret != CL_SUCCESS) {
    return msgprintf("%s:%d: OpenCL call\n  %s\nfailed with error code %d (%s)\n",
                     file, line, call, ret, opencl_error_string(ret));
  } else {
    return NULL;
  }
}

static void set_preferred_platform(struct opencl_config *cfg, const char *s) {
  cfg->preferred_platform = s;
  cfg->ignore_blacklist = 1;
}

static void set_preferred_device(struct opencl_config *cfg, const char *s) {
  int x = 0;
  if (*s == '#') {
    s++;
    while (isdigit(*s)) {
      x = x * 10 + (*s++)-'0';
    }
    // Skip trailing spaces.
    while (isspace(*s)) {
      s++;
    }
  }
  cfg->preferred_device = s;
  cfg->preferred_device_num = x;
  cfg->ignore_blacklist = 1;
}

static char* opencl_platform_info(cl_platform_id platform,
                                  cl_platform_info param) {
  size_t req_bytes;
  char *info;

  OPENCL_SUCCEED_FATAL(clGetPlatformInfo(platform, param, 0, NULL, &req_bytes));

  info = (char*) malloc(req_bytes);

  OPENCL_SUCCEED_FATAL(clGetPlatformInfo(platform, param, req_bytes, info, NULL));

  return info;
}

static char* opencl_device_info(cl_device_id device,
                                cl_device_info param) {
  size_t req_bytes;
  char *info;

  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device, param, 0, NULL, &req_bytes));

  info = (char*) malloc(req_bytes);

  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device, param, req_bytes, info, NULL));

  return info;
}

static void opencl_all_device_options(struct opencl_device_option **devices_out,
                                      size_t *num_devices_out) {
  size_t num_devices = 0, num_devices_added = 0;

  cl_platform_id *all_platforms;
  cl_uint *platform_num_devices;

  cl_uint num_platforms;

  // Find the number of platforms.
  OPENCL_SUCCEED_FATAL(clGetPlatformIDs(0, NULL, &num_platforms));

  // Make room for them.
  all_platforms = calloc(num_platforms, sizeof(cl_platform_id));
  platform_num_devices = calloc(num_platforms, sizeof(cl_uint));

  // Fetch all the platforms.
  OPENCL_SUCCEED_FATAL(clGetPlatformIDs(num_platforms, all_platforms, NULL));

  // Count the number of devices for each platform, as well as the
  // total number of devices.
  for (cl_uint i = 0; i < num_platforms; i++) {
    if (clGetDeviceIDs(all_platforms[i], CL_DEVICE_TYPE_ALL,
                       0, NULL, &platform_num_devices[i]) == CL_SUCCESS) {
      num_devices += platform_num_devices[i];
    } else {
      platform_num_devices[i] = 0;
    }
  }

  // Make room for all the device options.
  struct opencl_device_option *devices =
    calloc(num_devices, sizeof(struct opencl_device_option));

  // Loop through the platforms, getting information about their devices.
  for (cl_uint i = 0; i < num_platforms; i++) {
    cl_platform_id platform = all_platforms[i];
    cl_uint num_platform_devices = platform_num_devices[i];

    if (num_platform_devices == 0) {
      continue;
    }

    char *platform_name = opencl_platform_info(platform, CL_PLATFORM_NAME);
    cl_device_id *platform_devices =
      calloc(num_platform_devices, sizeof(cl_device_id));

    // Fetch all the devices.
    OPENCL_SUCCEED_FATAL(clGetDeviceIDs(platform, CL_DEVICE_TYPE_ALL,
                                  num_platform_devices, platform_devices, NULL));

    // Loop through the devices, adding them to the devices array.
    for (cl_uint i = 0; i < num_platform_devices; i++) {
      char *device_name = opencl_device_info(platform_devices[i], CL_DEVICE_NAME);
      devices[num_devices_added].platform = platform;
      devices[num_devices_added].device = platform_devices[i];
      OPENCL_SUCCEED_FATAL(clGetDeviceInfo(platform_devices[i], CL_DEVICE_TYPE,
                                     sizeof(cl_device_type),
                                     &devices[num_devices_added].device_type,
                                     NULL));
      // We don't want the structs to share memory, so copy the platform name.
      // Each device name is already unique.
      devices[num_devices_added].platform_name = strclone(platform_name);
      devices[num_devices_added].device_name = device_name;
      num_devices_added++;
    }
    free(platform_devices);
    free(platform_name);
  }
  free(all_platforms);
  free(platform_num_devices);

  *devices_out = devices;
  *num_devices_out = num_devices;
}

// Returns 0 on success.
static int list_devices(struct opencl_config *cfg) {
  struct opencl_device_option *devices;
  size_t num_devices;

  opencl_all_device_options(&devices, &num_devices);

  const char *cur_platform = "";
  for (size_t i = 0; i < num_devices; i++) {
    struct opencl_device_option device = devices[i];
    if (strcmp(cur_platform, device.platform_name) != 0) {
      printf("Platform: %s\n", device.platform_name);
      cur_platform = device.platform_name;
    }
    printf("[%d]: %s\n", (int)i, device.device_name);
  }

  // Free all the platform and device names.
  for (size_t j = 0; j < num_devices; j++) {
    free(devices[j].platform_name);
    free(devices[j].device_name);
  }
  free(devices);

  return 0;
}

// Returns 0 on success.
static int select_device_interactively(struct opencl_config *cfg) {
  struct opencl_device_option *devices;
  size_t num_devices;
  int ret = 1;

  opencl_all_device_options(&devices, &num_devices);

  printf("Choose OpenCL device:\n");
  const char *cur_platform = "";
  for (size_t i = 0; i < num_devices; i++) {
    struct opencl_device_option device = devices[i];
    if (strcmp(cur_platform, device.platform_name) != 0) {
      printf("Platform: %s\n", device.platform_name);
      cur_platform = device.platform_name;
    }
    printf("[%d] %s\n", (int)i, device.device_name);
  }

  int selection;
  printf("Choice: ");
  if (scanf("%d", &selection) == 1) {
    ret = 0;
    cfg->preferred_platform = "";
    cfg->preferred_device = "";
    cfg->preferred_device_num = selection;
    cfg->ignore_blacklist = 1;
  }

  // Free all the platform and device names.
  for (size_t j = 0; j < num_devices; j++) {
    free(devices[j].platform_name);
    free(devices[j].device_name);
  }
  free(devices);

  return ret;
}

static int is_blacklisted(const char *platform_name, const char *device_name,
                          const struct opencl_config *cfg) {
  if (strcmp(cfg->preferred_platform, "") != 0 ||
      strcmp(cfg->preferred_device, "") != 0) {
    return 0;
  } else if (strstr(platform_name, "Apple") != NULL &&
             strstr(device_name, "Intel(R) Core(TM)") != NULL) {
    return 1;
  } else {
    return 0;
  }
}

static struct opencl_device_option get_preferred_device(const struct opencl_config *cfg) {
  struct opencl_device_option *devices;
  size_t num_devices;

  opencl_all_device_options(&devices, &num_devices);

  int num_device_matches = 0;

  for (size_t i = 0; i < num_devices; i++) {
    struct opencl_device_option device = devices[i];
    if (strstr(device.platform_name, cfg->preferred_platform) != NULL &&
        strstr(device.device_name, cfg->preferred_device) != NULL &&
        (cfg->ignore_blacklist ||
         !is_blacklisted(device.platform_name, device.device_name, cfg)) &&
        num_device_matches++ == cfg->preferred_device_num) {
      // Free all the platform and device names, except the ones we have chosen.
      for (size_t j = 0; j < num_devices; j++) {
        if (j != i) {
          free(devices[j].platform_name);
          free(devices[j].device_name);
        }
      }
      free(devices);
      return device;
    }
  }

  futhark_panic(1, "Could not find acceptable OpenCL device.\n");
  exit(1); // Never reached
}

static void describe_device_option(struct opencl_device_option device) {
  fprintf(stderr, "Using platform: %s\n", device.platform_name);
  fprintf(stderr, "Using device: %s\n", device.device_name);
}

static cl_build_status build_opencl_program(cl_program program, cl_device_id device, const char* options) {
  cl_int clBuildProgram_error = clBuildProgram(program, 1, &device, options, NULL, NULL);

  // Avoid termination due to CL_BUILD_PROGRAM_FAILURE
  if (clBuildProgram_error != CL_SUCCESS &&
      clBuildProgram_error != CL_BUILD_PROGRAM_FAILURE) {
    OPENCL_SUCCEED_FATAL(clBuildProgram_error);
  }

  cl_build_status build_status;
  OPENCL_SUCCEED_FATAL(clGetProgramBuildInfo(program,
                                             device,
                                             CL_PROGRAM_BUILD_STATUS,
                                             sizeof(cl_build_status),
                                             &build_status,
                                             NULL));

  if (build_status != CL_SUCCESS) {
    char *build_log;
    size_t ret_val_size;
    OPENCL_SUCCEED_FATAL(clGetProgramBuildInfo(program, device, CL_PROGRAM_BUILD_LOG, 0, NULL, &ret_val_size));

    build_log = (char*) malloc(ret_val_size+1);
    OPENCL_SUCCEED_FATAL(clGetProgramBuildInfo(program, device, CL_PROGRAM_BUILD_LOG, ret_val_size, build_log, NULL));

    // The spec technically does not say whether the build log is zero-terminated, so let's be careful.
    build_log[ret_val_size] = '\0';

    fprintf(stderr, "Build log:\n%s\n", build_log);

    free(build_log);
  }

  return build_status;
}

// Fields in a bitmask indicating which types we must be sure are
// available.
enum opencl_required_type { OPENCL_F64 = 1 };

// We take as input several strings representing the program, because
// C does not guarantee that the compiler supports particularly large
// literals.  Notably, Visual C has a limit of 2048 characters.  The
// array must be NULL-terminated.
static cl_program setup_opencl_with_command_queue(struct opencl_context *ctx,
                                                  cl_command_queue queue,
                                                  const char *srcs[],
                                                  int required_types,
                                                  const char *extra_build_opts[]) {
  int error;

  free_list_init(&ctx->free_list);
  ctx->queue = queue;

  OPENCL_SUCCEED_FATAL(clGetCommandQueueInfo(ctx->queue, CL_QUEUE_CONTEXT, sizeof(cl_context), &ctx->ctx, NULL));

  // Fill out the device info.  This is redundant work if we are
  // called from setup_opencl() (which is the common case), but I
  // doubt it matters much.
  struct opencl_device_option device_option;
  OPENCL_SUCCEED_FATAL(clGetCommandQueueInfo(ctx->queue, CL_QUEUE_DEVICE,
                                       sizeof(cl_device_id),
                                       &device_option.device,
                                       NULL));
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_PLATFORM,
                                 sizeof(cl_platform_id),
                                 &device_option.platform,
                                 NULL));
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_TYPE,
                                 sizeof(cl_device_type),
                                 &device_option.device_type,
                                 NULL));
  device_option.platform_name = opencl_platform_info(device_option.platform, CL_PLATFORM_NAME);
  device_option.device_name = opencl_device_info(device_option.device, CL_DEVICE_NAME);

  ctx->device = device_option.device;

  if (required_types & OPENCL_F64) {
    cl_uint supported;
    OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_PREFERRED_VECTOR_WIDTH_DOUBLE,
                                   sizeof(cl_uint), &supported, NULL));
    if (!supported) {
      futhark_panic(1, "Program uses double-precision floats, but this is not supported on the chosen device: %s\n",
            device_option.device_name);
    }
  }

  size_t max_group_size;
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_MAX_WORK_GROUP_SIZE,
                                 sizeof(size_t), &max_group_size, NULL));

  size_t max_tile_size = sqrt(max_group_size);

  cl_ulong max_local_memory;
  OPENCL_SUCCEED_FATAL(clGetDeviceInfo(device_option.device, CL_DEVICE_LOCAL_MEM_SIZE,
                                       sizeof(size_t), &max_local_memory, NULL));

  // Futhark reserves 4 bytes for bookkeeping information.
  max_local_memory -= 4;

  // The OpenCL implementation may reserve some local memory bytes for
  // various purposes.  In principle, we should use
  // clGetKernelWorkGroupInfo() to figure out for each kernel how much
  // is actually available, but our current code generator design
  // makes this infeasible.  Instead, we have this nasty hack where we
  // arbitrarily subtract some bytes, based on empirical measurements
  // (but which might be arbitrarily wrong).  Fortunately, we rarely
  // try to really push the local memory usage.
  if (strstr(device_option.platform_name, "NVIDIA CUDA") != NULL) {
    max_local_memory -= 12;
  } else if (strstr(device_option.platform_name, "AMD") != NULL) {
    max_local_memory -= 16;
  }

  // Make sure this function is defined.
  post_opencl_setup(ctx, &device_option);

  if (max_group_size < ctx->cfg.default_group_size) {
    if (ctx->cfg.default_group_size_changed) {
      fprintf(stderr, "Note: Device limits default group size to %zu (down from %zu).\n",
              max_group_size, ctx->cfg.default_group_size);
    }
    ctx->cfg.default_group_size = max_group_size;
  }

  if (max_tile_size < ctx->cfg.default_tile_size) {
    if (ctx->cfg.default_tile_size_changed) {
      fprintf(stderr, "Note: Device limits default tile size to %zu (down from %zu).\n",
              max_tile_size, ctx->cfg.default_tile_size);
    }
    ctx->cfg.default_tile_size = max_tile_size;
  }

  ctx->max_group_size = max_group_size;
  ctx->max_tile_size = max_tile_size; // No limit.
  ctx->max_threshold = ctx->max_num_groups = 0; // No limit.
  ctx->max_local_memory = max_local_memory;

  // Now we go through all the sizes, clamp them to the valid range,
  // or set them to the default.
  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    const char *size_class = ctx->cfg.size_classes[i];
    size_t *size_value = &ctx->cfg.size_values[i];
    const char* size_name = ctx->cfg.size_names[i];
    size_t max_value = 0, default_value = 0;
    if (strstr(size_class, "group_size") == size_class) {
      max_value = max_group_size;
      default_value = ctx->cfg.default_group_size;
    } else if (strstr(size_class, "num_groups") == size_class) {
      max_value = max_group_size; // Futhark assumes this constraint.
      default_value = ctx->cfg.default_num_groups;
      // XXX: as a quick and dirty hack, use twice as many threads for
      // histograms by default.  We really should just be smarter
      // about sizes somehow.
      if (strstr(size_name, ".seghist_") != NULL) {
        default_value *= 2;
      }
    } else if (strstr(size_class, "tile_size") == size_class) {
      max_value = sqrt(max_group_size);
      default_value = ctx->cfg.default_tile_size;
    } else if (strstr(size_class, "threshold") == size_class) {
      // Threshold can be as large as it takes.
      default_value = ctx->cfg.default_threshold;
    } else {
      // Bespoke sizes have no limit or default.
    }
    if (*size_value == 0) {
      *size_value = default_value;
    } else if (max_value > 0 && *size_value > max_value) {
      fprintf(stderr, "Note: Device limits %s to %d (down from %d)\n",
              size_name, (int)max_value, (int)*size_value);
      *size_value = max_value;
    }
  }

  if (ctx->lockstep_width == 0) {
    ctx->lockstep_width = 1;
  }

  if (ctx->cfg.logging) {
    fprintf(stderr, "Lockstep width: %d\n", (int)ctx->lockstep_width);
    fprintf(stderr, "Default group size: %d\n", (int)ctx->cfg.default_group_size);
    fprintf(stderr, "Default number of groups: %d\n", (int)ctx->cfg.default_num_groups);
  }

  char *fut_opencl_src = NULL;
  cl_program prog;
  error = CL_SUCCESS;

  if (ctx->cfg.load_binary_from == NULL) {
    size_t src_size = 0;

    // Maybe we have to read OpenCL source from somewhere else (used for debugging).
    if (ctx->cfg.load_program_from != NULL) {
      fut_opencl_src = slurp_file(ctx->cfg.load_program_from, NULL);
      assert(fut_opencl_src != NULL);
    } else {
      // Construct the OpenCL source concatenating all the fragments.
      for (const char **src = srcs; src && *src; src++) {
        src_size += strlen(*src);
      }

      fut_opencl_src = (char*) malloc(src_size + 1);

      size_t n, i;
      for (i = 0, n = 0; srcs && srcs[i]; i++) {
        strncpy(fut_opencl_src+n, srcs[i], src_size-n);
        n += strlen(srcs[i]);
      }
      fut_opencl_src[src_size] = 0;
    }

    if (ctx->cfg.dump_program_to != NULL) {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "Dumping OpenCL source to %s...\n", ctx->cfg.dump_program_to);
      }

      dump_file(ctx->cfg.dump_program_to, fut_opencl_src, strlen(fut_opencl_src));
    }

    if (ctx->cfg.debugging) {
      fprintf(stderr, "Creating OpenCL program...\n");
    }

    const char* src_ptr[] = {fut_opencl_src};
    prog = clCreateProgramWithSource(ctx->ctx, 1, src_ptr, &src_size, &error);
    OPENCL_SUCCEED_FATAL(error);
  } else {
    if (ctx->cfg.debugging) {
      fprintf(stderr, "Loading OpenCL binary from %s...\n", ctx->cfg.load_binary_from);
    }
    size_t binary_size;
    unsigned char *fut_opencl_bin =
      (unsigned char*) slurp_file(ctx->cfg.load_binary_from, &binary_size);
    assert(fut_opencl_bin != NULL);
    const unsigned char *binaries[1] = { fut_opencl_bin };
    cl_int status = 0;

    prog = clCreateProgramWithBinary(ctx->ctx, 1, &device_option.device,
                                     &binary_size, binaries,
                                     &status, &error);

    OPENCL_SUCCEED_FATAL(status);
    OPENCL_SUCCEED_FATAL(error);
  }

  int compile_opts_size = 1024;

  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    compile_opts_size += strlen(ctx->cfg.size_names[i]) + 20;
  }

  for (int i = 0; extra_build_opts[i] != NULL; i++) {
    compile_opts_size += strlen(extra_build_opts[i] + 1);
  }

  char *compile_opts = (char*) malloc(compile_opts_size);

  int w = snprintf(compile_opts, compile_opts_size,
                   "-DLOCKSTEP_WIDTH=%d ",
                   (int)ctx->lockstep_width);

  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    w += snprintf(compile_opts+w, compile_opts_size-w,
                  "-D%s=%d ",
                  ctx->cfg.size_vars[i],
                  (int)ctx->cfg.size_values[i]);
  }

  for (int i = 0; extra_build_opts[i] != NULL; i++) {
    w += snprintf(compile_opts+w, compile_opts_size-w,
                  "%s ", extra_build_opts[i]);
  }

  if (ctx->cfg.debugging) {
    fprintf(stderr, "OpenCL compiler options: %s\n", compile_opts);
    fprintf(stderr, "Building OpenCL program...\n");
  }
  OPENCL_SUCCEED_FATAL(build_opencl_program(prog, device_option.device, compile_opts));

  free(compile_opts);
  free(fut_opencl_src);

  if (ctx->cfg.dump_binary_to != NULL) {
    if (ctx->cfg.debugging) {
      fprintf(stderr, "Dumping OpenCL binary to %s...\n", ctx->cfg.dump_binary_to);
    }

    size_t binary_size;
    OPENCL_SUCCEED_FATAL(clGetProgramInfo(prog, CL_PROGRAM_BINARY_SIZES,
                                          sizeof(size_t), &binary_size, NULL));
    unsigned char *binary = (unsigned char*) malloc(binary_size);
    unsigned char *binaries[1] = { binary };
    OPENCL_SUCCEED_FATAL(clGetProgramInfo(prog, CL_PROGRAM_BINARIES,
                                          sizeof(unsigned char*), binaries, NULL));

    dump_file(ctx->cfg.dump_binary_to, binary, binary_size);
  }

  return prog;
}

static cl_program setup_opencl(struct opencl_context *ctx,
                               const char *srcs[],
                               int required_types,
                               const char *extra_build_opts[]) {

  ctx->lockstep_width = 0; // Real value set later.

  struct opencl_device_option device_option = get_preferred_device(&ctx->cfg);

  if (ctx->cfg.logging) {
    describe_device_option(device_option);
  }

  // Note that NVIDIA's OpenCL requires the platform property
  cl_context_properties properties[] = {
    CL_CONTEXT_PLATFORM,
    (cl_context_properties)device_option.platform,
    0
  };

  cl_int clCreateContext_error;
  ctx->ctx = clCreateContext(properties, 1, &device_option.device, NULL, NULL, &clCreateContext_error);
  OPENCL_SUCCEED_FATAL(clCreateContext_error);

  cl_int clCreateCommandQueue_error;
  cl_command_queue queue =
    clCreateCommandQueue(ctx->ctx,
                         device_option.device,
                         ctx->cfg.profiling ? CL_QUEUE_PROFILING_ENABLE : 0,
                         &clCreateCommandQueue_error);
  OPENCL_SUCCEED_FATAL(clCreateCommandQueue_error);

  return setup_opencl_with_command_queue(ctx, queue, srcs, required_types, extra_build_opts);
}

// Count up the runtime all the profiling_records that occured during execution.
// Also clears the buffer of profiling_records.
static cl_int opencl_tally_profiling_records(struct opencl_context *ctx) {
  cl_int err;
  for (int i = 0; i < ctx->profiling_records_used; i++) {
    struct profiling_record record = ctx->profiling_records[i];

    cl_ulong start_t, end_t;

    if ((err = clGetEventProfilingInfo(*record.event,
                                       CL_PROFILING_COMMAND_START,
                                       sizeof(start_t),
                                       &start_t,
                                       NULL)) != CL_SUCCESS) {
      return err;
    }

    if ((err = clGetEventProfilingInfo(*record.event,
                                       CL_PROFILING_COMMAND_END,
                                       sizeof(end_t),
                                       &end_t,
                                       NULL)) != CL_SUCCESS) {
      return err;
    }

    // OpenCL provides nanosecond resolution, but we want
    // microseconds.
    *record.runs += 1;
    *record.runtime += (end_t - start_t)/1000;

    if ((err = clReleaseEvent(*record.event)) != CL_SUCCESS) {
      return err;
    }
    free(record.event);
  }

  ctx->profiling_records_used = 0;

  return CL_SUCCESS;
}

// If profiling, produce an event associated with a profiling record.
static cl_event* opencl_get_event(struct opencl_context *ctx, int *runs, int64_t *runtime) {
    if (ctx->profiling_records_used == ctx->profiling_records_capacity) {
      ctx->profiling_records_capacity *= 2;
      ctx->profiling_records =
        realloc(ctx->profiling_records,
                ctx->profiling_records_capacity *
                sizeof(struct profiling_record));
    }
    cl_event *event = malloc(sizeof(cl_event));
    ctx->profiling_records[ctx->profiling_records_used].event = event;
    ctx->profiling_records[ctx->profiling_records_used].runs = runs;
    ctx->profiling_records[ctx->profiling_records_used].runtime = runtime;
    ctx->profiling_records_used++;
    return event;
}

// Allocate memory from driver. The problem is that OpenCL may perform
// lazy allocation, so we cannot know whether an allocation succeeded
// until the first time we try to use it.  Hence we immediately
// perform a write to see if the allocation succeeded.  This is slow,
// but the assumption is that this operation will be rare (most things
// will go through the free list).
static int opencl_alloc_actual(struct opencl_context *ctx, size_t size, cl_mem *mem_out) {
  int error;
  *mem_out = clCreateBuffer(ctx->ctx, CL_MEM_READ_WRITE, size, NULL, &error);

  if (error != CL_SUCCESS) {
    return error;
  }

  int x = 2;
  error = clEnqueueWriteBuffer(ctx->queue, *mem_out, 1, 0, sizeof(x), &x, 0, NULL, NULL);

  // No need to wait for completion here. clWaitForEvents() cannot
  // return mem object allocation failures. This implies that the
  // buffer is faulted onto the device on enqueue. (Observation by
  // Andreas Kloeckner.)

  return error;
}

static int opencl_alloc(struct opencl_context *ctx, size_t min_size, const char *tag, cl_mem *mem_out) {
  (void)tag;
  if (min_size < sizeof(int)) {
    min_size = sizeof(int);
  }

  size_t size;

  if (free_list_find(&ctx->free_list, min_size, &size, mem_out) == 0) {
    // Successfully found a free block.  Is it big enough?
    //
    // FIXME: we might also want to check whether the block is *too
    // big*, to avoid internal fragmentation.  However, this can
    // sharply impact performance on programs where arrays change size
    // frequently.  Fortunately, such allocations are usually fairly
    // short-lived, as they are necessarily within a loop, so the risk
    // of internal fragmentation resulting in an OOM situation is
    // limited.  However, it would be preferable if we could go back
    // and *shrink* oversize allocations when we encounter an OOM
    // condition.  That is technically feasible, since we do not
    // expose OpenCL pointer values directly to the application, but
    // instead rely on a level of indirection.
    if (size >= min_size) {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "No need to allocate: Found a block in the free list.\n");
      }

      return CL_SUCCESS;
    } else {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "Found a free block, but it was too small.\n");
      }

      // Not just right - free it.
      int error = clReleaseMemObject(*mem_out);
      if (error != CL_SUCCESS) {
        return error;
      }
    }
  }

  // We have to allocate a new block from the driver.  If the
  // allocation does not succeed, then we might be in an out-of-memory
  // situation.  We now start freeing things from the free list until
  // we think we have freed enough that the allocation will succeed.
  // Since we don't know how far the allocation is from fitting, we
  // have to check after every deallocation.  This might be pretty
  // expensive.  Let's hope that this case is hit rarely.

  if (ctx->cfg.debugging) {
    fprintf(stderr, "Actually allocating the desired block.\n");
  }

  int error = opencl_alloc_actual(ctx, min_size, mem_out);

  while (error == CL_MEM_OBJECT_ALLOCATION_FAILURE) {
    if (ctx->cfg.debugging) {
      fprintf(stderr, "Out of OpenCL memory: releasing entry from the free list...\n");
    }
    cl_mem mem;
    if (free_list_first(&ctx->free_list, &mem) == 0) {
      error = clReleaseMemObject(mem);
      if (error != CL_SUCCESS) {
        return error;
      }
    } else {
      break;
    }
    error = opencl_alloc_actual(ctx, min_size, mem_out);
  }

  return error;
}

static int opencl_free(struct opencl_context *ctx, cl_mem mem, const char *tag) {
  size_t size;
  cl_mem existing_mem;

  // If there is already a block with this tag, then remove it.
  if (free_list_find(&ctx->free_list, -1, &size, &existing_mem) == 0) {
    int error = clReleaseMemObject(existing_mem);
    if (error != CL_SUCCESS) {
      return error;
    }
  }

  int error = clGetMemObjectInfo(mem, CL_MEM_SIZE, sizeof(size_t), &size, NULL);

  if (error == CL_SUCCESS) {
    free_list_insert(&ctx->free_list, size, mem, tag);
  }

  return error;
}

static int opencl_free_all(struct opencl_context *ctx) {
  cl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, &mem) == 0) {
    int error = clReleaseMemObject(mem);
    if (error != CL_SUCCESS) {
      return error;
    }
  }

  return CL_SUCCESS;
}

// Free everything that belongs to 'ctx', but do not free 'ctx'
// itself.
static void teardown_opencl(struct opencl_context *ctx) {
  (void)opencl_tally_profiling_records(ctx);
  free(ctx->profiling_records);
  (void)opencl_free_all(ctx);
  (void)clReleaseCommandQueue(ctx->queue);
  (void)clReleaseContext(ctx->ctx);
}

// End of opencl.h.

static const char *opencl_program[] =
                  {"#ifdef cl_clang_storage_class_specifiers\n#pragma OPENCL EXTENSION cl_clang_storage_class_specifiers : enable\n#endif\n#pragma OPENCL EXTENSION cl_khr_byte_addressable_store : enable\n__kernel void dummy_kernel(__global unsigned char *dummy, int n)\n{\n    const int thread_gid = get_global_id(0);\n    \n    if (thread_gid >= n)\n        return;\n}\ntypedef char int8_t;\ntypedef short int16_t;\ntypedef int int32_t;\ntypedef long int64_t;\ntypedef uchar uint8_t;\ntypedef ushort uint16_t;\ntypedef uint uint32_t;\ntypedef ulong uint64_t;\n#ifdef cl_nv_pragma_unroll\nstatic inline void mem_fence_global()\n{\n    asm(\"membar.gl;\");\n}\n#else\nstatic inline void mem_fence_global()\n{\n    mem_fence(CLK_LOCAL_MEM_FENCE | CLK_GLOBAL_MEM_FENCE);\n}\n#endif\nstatic inline void mem_fence_local()\n{\n    mem_fence(CLK_LOCAL_MEM_FENCE);\n}\nstatic inline uint8_t add8(uint8_t x, uint8_t y)\n{\n    return x + y;\n}\nstatic inline uint16_t add16(uint16_t x, uint16_t y)\n{\n    return x + y;\n}\nstatic inline uint32_t add32(uint32_t x, uint32_t y)\n{\n    return x + y;\n}\nstatic inline uint64_t add64(uint64_t x, uint64_t y)\n{\n    return x + y;\n}\nstatic inline uint8_t sub8(uint8_t x, uint8_t y)\n{\n    return x - y;\n}\nstatic inline uint16_t sub16(uint16_t x, uint16_t y)\n{\n    return x - y;\n}\nstatic inline uint32_t sub32(uint32_t x, uint32_t y)\n{\n    return x - y;\n}\nstatic inline uint64_t sub64(uint64_t x, uint64_t y)\n{\n    return x - y;\n}\nstatic inline uint8_t mul8(uint8_t x, uint8_t y)\n{\n    return x * y;\n}\nstatic inline uint16_t mul16(uint16_t x, uint16_t y)\n{\n    return x * y;\n}\nstatic inline uint32_t mul32(uint32_t x, uint32_t y)\n{\n    return x * y;\n}\nstatic inline uint64_t mul64(uint64_t x, uint64_t y)\n{\n    return x * y;\n}\nstatic inline uint8_t udiv8(uint8_t x, uint8_t y)\n{\n    return x / y;\n}\nstatic inline uint16_t udiv16(uint16_t x, uint16_t y)\n{\n    return x / y;\n}\nstatic inline uint32_t udiv32(uint32_t x, uint32_t y)\n{\n    return x / y;\n}\nstatic inline uint64_t udiv64(uint64_t x, uint64_t y)\n{\n    return x / y;\n}\nstatic ",
                   "inline uint8_t udiv_up8(uint8_t x, uint8_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint16_t udiv_up16(uint16_t x, uint16_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint32_t udiv_up32(uint32_t x, uint32_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint64_t udiv_up64(uint64_t x, uint64_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint8_t umod8(uint8_t x, uint8_t y)\n{\n    return x % y;\n}\nstatic inline uint16_t umod16(uint16_t x, uint16_t y)\n{\n    return x % y;\n}\nstatic inline uint32_t umod32(uint32_t x, uint32_t y)\n{\n    return x % y;\n}\nstatic inline uint64_t umod64(uint64_t x, uint64_t y)\n{\n    return x % y;\n}\nstatic inline uint8_t udiv_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint16_t udiv_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint32_t udiv_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint64_t udiv_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint8_t umod_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint16_t umod_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint32_t umod_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint64_t umod_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int8_t sdiv8(int8_t x, int8_t y)\n{\n    int8_t q = x / y;\n    int8_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int16_t sdiv16(int16",
                   "_t x, int16_t y)\n{\n    int16_t q = x / y;\n    int16_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int32_t sdiv32(int32_t x, int32_t y)\n{\n    int32_t q = x / y;\n    int32_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int64_t sdiv64(int64_t x, int64_t y)\n{\n    int64_t q = x / y;\n    int64_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int8_t sdiv_up8(int8_t x, int8_t y)\n{\n    return sdiv8(x + y - 1, y);\n}\nstatic inline int16_t sdiv_up16(int16_t x, int16_t y)\n{\n    return sdiv16(x + y - 1, y);\n}\nstatic inline int32_t sdiv_up32(int32_t x, int32_t y)\n{\n    return sdiv32(x + y - 1, y);\n}\nstatic inline int64_t sdiv_up64(int64_t x, int64_t y)\n{\n    return sdiv64(x + y - 1, y);\n}\nstatic inline int8_t smod8(int8_t x, int8_t y)\n{\n    int8_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int16_t smod16(int16_t x, int16_t y)\n{\n    int16_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int32_t smod32(int32_t x, int32_t y)\n{\n    int32_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int64_t smod64(int64_t x, int64_t y)\n{\n    int64_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int8_t sdiv_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : sdiv8(x, y);\n}\nstatic inline int16_t sdiv_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : sdiv16(x, y);\n}\nstatic inline int32_t sdiv_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : sdiv32(x, y);\n}\nstatic inline int64_t sdiv_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : sdiv64(x, y);\n}\nstatic inline int8_t sdiv_up_safe8(int8_t x, int8_t y)\n{\n    return sdiv_safe8(x + y - 1, y);\n}\nstatic inline int16_t sdiv_up_safe16(int16_t x, int16_t y)\n{\n    return sdiv_safe16(x + y - 1, y",
                   ");\n}\nstatic inline int32_t sdiv_up_safe32(int32_t x, int32_t y)\n{\n    return sdiv_safe32(x + y - 1, y);\n}\nstatic inline int64_t sdiv_up_safe64(int64_t x, int64_t y)\n{\n    return sdiv_safe64(x + y - 1, y);\n}\nstatic inline int8_t smod_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : smod8(x, y);\n}\nstatic inline int16_t smod_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : smod16(x, y);\n}\nstatic inline int32_t smod_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : smod32(x, y);\n}\nstatic inline int64_t smod_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : smod64(x, y);\n}\nstatic inline int8_t squot8(int8_t x, int8_t y)\n{\n    return x / y;\n}\nstatic inline int16_t squot16(int16_t x, int16_t y)\n{\n    return x / y;\n}\nstatic inline int32_t squot32(int32_t x, int32_t y)\n{\n    return x / y;\n}\nstatic inline int64_t squot64(int64_t x, int64_t y)\n{\n    return x / y;\n}\nstatic inline int8_t srem8(int8_t x, int8_t y)\n{\n    return x % y;\n}\nstatic inline int16_t srem16(int16_t x, int16_t y)\n{\n    return x % y;\n}\nstatic inline int32_t srem32(int32_t x, int32_t y)\n{\n    return x % y;\n}\nstatic inline int64_t srem64(int64_t x, int64_t y)\n{\n    return x % y;\n}\nstatic inline int8_t squot_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int16_t squot_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int32_t squot_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int64_t squot_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int8_t srem_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int16_t srem_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int32_t srem_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int64_t srem_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int8_t smin8(int8_t x, int8_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int16_t smi",
                   "n16(int16_t x, int16_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int32_t smin32(int32_t x, int32_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int64_t smin64(int64_t x, int64_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint8_t umin8(uint8_t x, uint8_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint16_t umin16(uint16_t x, uint16_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint32_t umin32(uint32_t x, uint32_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint64_t umin64(uint64_t x, uint64_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int8_t smax8(int8_t x, int8_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int16_t smax16(int16_t x, int16_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int32_t smax32(int32_t x, int32_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int64_t smax64(int64_t x, int64_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint8_t umax8(uint8_t x, uint8_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint16_t umax16(uint16_t x, uint16_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint32_t umax32(uint32_t x, uint32_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint64_t umax64(uint64_t x, uint64_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint8_t shl8(uint8_t x, uint8_t y)\n{\n    return x << y;\n}\nstatic inline uint16_t shl16(uint16_t x, uint16_t y)\n{\n    return x << y;\n}\nstatic inline uint32_t shl32(uint32_t x, uint32_t y)\n{\n    return x << y;\n}\nstatic inline uint64_t shl64(uint64_t x, uint64_t y)\n{\n    return x << y;\n}\nstatic inline uint8_t lshr8(uint8_t x, uint8_t y)\n{\n    return x >> y;\n}\nstatic inline uint16_t lshr16(uint16_t x, uint16_t y)\n{\n    return x >> y;\n}\nstatic inline uint32_t lshr32(uint32_t x, uint32_t y)\n{\n    return x >> y;\n}\nstatic inline uint64_t lshr64(uint64_t x, uint64_t y)\n{\n    return x >> y;\n}\nstatic inline int8_t ashr8(int8_t x, int8_t y)\n{\n    return x >> y;\n}\nstatic inline int16_t ashr16(int16_t x, int16_t y)\n{\n    return x >> y;\n}\nstatic inline int32_t ashr32(int32_t x, int32_t y)",
                   "\n{\n    return x >> y;\n}\nstatic inline int64_t ashr64(int64_t x, int64_t y)\n{\n    return x >> y;\n}\nstatic inline uint8_t and8(uint8_t x, uint8_t y)\n{\n    return x & y;\n}\nstatic inline uint16_t and16(uint16_t x, uint16_t y)\n{\n    return x & y;\n}\nstatic inline uint32_t and32(uint32_t x, uint32_t y)\n{\n    return x & y;\n}\nstatic inline uint64_t and64(uint64_t x, uint64_t y)\n{\n    return x & y;\n}\nstatic inline uint8_t or8(uint8_t x, uint8_t y)\n{\n    return x | y;\n}\nstatic inline uint16_t or16(uint16_t x, uint16_t y)\n{\n    return x | y;\n}\nstatic inline uint32_t or32(uint32_t x, uint32_t y)\n{\n    return x | y;\n}\nstatic inline uint64_t or64(uint64_t x, uint64_t y)\n{\n    return x | y;\n}\nstatic inline uint8_t xor8(uint8_t x, uint8_t y)\n{\n    return x ^ y;\n}\nstatic inline uint16_t xor16(uint16_t x, uint16_t y)\n{\n    return x ^ y;\n}\nstatic inline uint32_t xor32(uint32_t x, uint32_t y)\n{\n    return x ^ y;\n}\nstatic inline uint64_t xor64(uint64_t x, uint64_t y)\n{\n    return x ^ y;\n}\nstatic inline bool ult8(uint8_t x, uint8_t y)\n{\n    return x < y;\n}\nstatic inline bool ult16(uint16_t x, uint16_t y)\n{\n    return x < y;\n}\nstatic inline bool ult32(uint32_t x, uint32_t y)\n{\n    return x < y;\n}\nstatic inline bool ult64(uint64_t x, uint64_t y)\n{\n    return x < y;\n}\nstatic inline bool ule8(uint8_t x, uint8_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule16(uint16_t x, uint16_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule32(uint32_t x, uint32_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule64(uint64_t x, uint64_t y)\n{\n    return x <= y;\n}\nstatic inline bool slt8(int8_t x, int8_t y)\n{\n    return x < y;\n}\nstatic inline bool slt16(int16_t x, int16_t y)\n{\n    return x < y;\n}\nstatic inline bool slt32(int32_t x, int32_t y)\n{\n    return x < y;\n}\nstatic inline bool slt64(int64_t x, int64_t y)\n{\n    return x < y;\n}\nstatic inline bool sle8(int8_t x, int8_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle16(int16_t x, int16_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle32(int32_t x, int32_",
                   "t y)\n{\n    return x <= y;\n}\nstatic inline bool sle64(int64_t x, int64_t y)\n{\n    return x <= y;\n}\nstatic inline int8_t pow8(int8_t x, int8_t y)\n{\n    int8_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int16_t pow16(int16_t x, int16_t y)\n{\n    int16_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int32_t pow32(int32_t x, int32_t y)\n{\n    int32_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int64_t pow64(int64_t x, int64_t y)\n{\n    int64_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline bool itob_i8_bool(int8_t x)\n{\n    return x;\n}\nstatic inline bool itob_i16_bool(int16_t x)\n{\n    return x;\n}\nstatic inline bool itob_i32_bool(int32_t x)\n{\n    return x;\n}\nstatic inline bool itob_i64_bool(int64_t x)\n{\n    return x;\n}\nstatic inline int8_t btoi_bool_i8(bool x)\n{\n    return x;\n}\nstatic inline int16_t btoi_bool_i16(bool x)\n{\n    return x;\n}\nstatic inline int32_t btoi_bool_i32(bool x)\n{\n    return x;\n}\nstatic inline int64_t btoi_bool_i64(bool x)\n{\n    return x;\n}\n#define sext_i8_i8(x) ((int8_t) (int8_t) x)\n#define sext_i8_i16(x) ((int16_t) (int8_t) x)\n#define sext_i8_i32(x) ((int32_t) (int8_t) x)\n#define sext_i8_i64(x) ((int64_t) (int8_t) x)\n#define sext_i16_i8(x) ((int8_t) (int16_t) x)\n#define sext_i16_i16(x) ((int16_t) (int16_t) x)\n#define sext_i16_i32(x) ((int32_t) (int16_t) x)\n#define sext_i16_i64(x) ((int64_t) (int16_t) x)\n#define sext_i32_i8(x) ((int8_t) (int32_t) x)\n#define sext_i32_i16(x) ((int16_t) (int32_t) x)\n#define sext_i32_i32(x) ((int32_t) (int32_t) x)\n#define sext_i32_i64(x) ((int64_t) (int32_t) x)\n#defi",
                   "ne sext_i64_i8(x) ((int8_t) (int64_t) x)\n#define sext_i64_i16(x) ((int16_t) (int64_t) x)\n#define sext_i64_i32(x) ((int32_t) (int64_t) x)\n#define sext_i64_i64(x) ((int64_t) (int64_t) x)\n#define zext_i8_i8(x) ((int8_t) (uint8_t) x)\n#define zext_i8_i16(x) ((int16_t) (uint8_t) x)\n#define zext_i8_i32(x) ((int32_t) (uint8_t) x)\n#define zext_i8_i64(x) ((int64_t) (uint8_t) x)\n#define zext_i16_i8(x) ((int8_t) (uint16_t) x)\n#define zext_i16_i16(x) ((int16_t) (uint16_t) x)\n#define zext_i16_i32(x) ((int32_t) (uint16_t) x)\n#define zext_i16_i64(x) ((int64_t) (uint16_t) x)\n#define zext_i32_i8(x) ((int8_t) (uint32_t) x)\n#define zext_i32_i16(x) ((int16_t) (uint32_t) x)\n#define zext_i32_i32(x) ((int32_t) (uint32_t) x)\n#define zext_i32_i64(x) ((int64_t) (uint32_t) x)\n#define zext_i64_i8(x) ((int8_t) (uint64_t) x)\n#define zext_i64_i16(x) ((int16_t) (uint64_t) x)\n#define zext_i64_i32(x) ((int32_t) (uint64_t) x)\n#define zext_i64_i64(x) ((int64_t) (uint64_t) x)\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_popc8(int8_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    return popcount(x);\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_popc8(int8_t x)\n{\n    return __popc(zext_i8_i32(x));\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    return __popc(zext_i16_i32(x));\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    return __popc(x);\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    return __popcll(x);\n}\n#else\nstatic int32_t futrts_popc8(int8_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    int c = 0;\n    \n    for ",
                   "(; x; ++c)\n        x &= x - 1;\n    return c;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    return mul_hi(a, b);\n}\n#elif defined(__CUDA_ARCH__)\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    uint16_t aa = a;\n    uint16_t bb = b;\n    \n    return aa * bb >> 8;\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    uint32_t aa = a;\n    uint32_t bb = b;\n    \n    return aa * bb >> 16;\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    return mulhi(a, b);\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    return mul64hi(a, b);\n}\n#else\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    uint16_t aa = a;\n    uint16_t bb = b;\n    \n    return aa * bb >> 8;\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    uint32_t aa = a;\n    uint32_t bb = b;\n    \n    return aa * bb >> 16;\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    uint64_t aa = a;\n    uint64_t bb = b;\n    \n    return aa * bb >> 32;\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    __uint128_t aa = a;\n    __uint128_t bb = b;\n    \n    return aa * bb >> 64;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)\n{\n    return mad_hi(a, b, c);\n}\n#else\nstatic uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)\n{\n    return futrts_mul_hi8(a, b) + c;\n}\nstatic uint16_t futrts_mad_hi16(uin",
                   "t16_t a, uint16_t b, uint16_t c)\n{\n    return futrts_mul_hi16(a, b) + c;\n}\nstatic uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)\n{\n    return futrts_mul_hi32(a, b) + c;\n}\nstatic uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)\n{\n    return futrts_mul_hi64(a, b) + c;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    return clz(x);\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    return __clz(zext_i8_i32(x)) - 24;\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    return __clz(zext_i16_i32(x)) - 16;\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    return __clz(x);\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    return __clzll(x);\n}\n#else\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    int i = 0;\n    \n    for (; i < 8 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz16(int16_t ",
                   "x)\n{\n    int i = 0;\n    \n    for (; i < 16 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    int i = 0;\n    \n    for (; i < 32 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    int i = 0;\n    \n    for (; i < 64 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 8 : y - 1;\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 16 : y - 1;\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 32 : y - 1;\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    int y = __ffsll(x);\n    \n    return y == 0 ? 64 : y - 1;\n}\n#else\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    return x == 0 ? 8 : __builtin_ctz((uint32_t) x);\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    return x == 0 ? 16 : __builtin_ctz((uint32_t) x);\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    return x == 0 ? 32 : __builtin_ctz(x);\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    return x == 0 ? 64 : __builtin_ctzl(x);\n}\n#endif\nstatic inline float fdiv32(float x, float y)\n{\n    return x / y;\n}\nstatic inline float fadd32(float x, float y)\n{\n    return x + y;\n}\nstatic inline float fsub32(float x, float y)\n{\n    return x - y;\n}\nstatic inline float fmul32(float x, float y)\n{\n    return x * y;\n}\nstatic inline float fmin32(float x, float y)\n{\n    return fmin(x, y);\n}\nstatic inline float fmax32(float x, float y)\n{\n    return fmax(x, y);\n}\nstatic inline float fpow32(float x, float y)\n{\n    return pow(x, y);\n}\nstatic inline bool cmplt32(float x, float y)\n{\n    return x < y;\n}\nstatic inline bool cmple32(float x, float y)\n{\n    return x <= y;\n}\nstatic inline float sitofp_i8_f32(int8_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i16_f32(int16_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i32_f32(int32_t x)",
                   "\n{\n    return (float) x;\n}\nstatic inline float sitofp_i64_f32(int64_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i8_f32(uint8_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i16_f32(uint16_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i32_f32(uint32_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i64_f32(uint64_t x)\n{\n    return (float) x;\n}\nstatic inline int8_t fptosi_f32_i8(float x)\n{\n    return (int8_t) x;\n}\nstatic inline int16_t fptosi_f32_i16(float x)\n{\n    return (int16_t) x;\n}\nstatic inline int32_t fptosi_f32_i32(float x)\n{\n    return (int32_t) x;\n}\nstatic inline int64_t fptosi_f32_i64(float x)\n{\n    return (int64_t) x;\n}\nstatic inline uint8_t fptoui_f32_i8(float x)\n{\n    return (uint8_t) x;\n}\nstatic inline uint16_t fptoui_f32_i16(float x)\n{\n    return (uint16_t) x;\n}\nstatic inline uint32_t fptoui_f32_i32(float x)\n{\n    return (uint32_t) x;\n}\nstatic inline uint64_t fptoui_f32_i64(float x)\n{\n    return (uint64_t) x;\n}\nstatic inline float futrts_log32(float x)\n{\n    return log(x);\n}\nstatic inline float futrts_log2_32(float x)\n{\n    return log2(x);\n}\nstatic inline float futrts_log10_32(float x)\n{\n    return log10(x);\n}\nstatic inline float futrts_sqrt32(float x)\n{\n    return sqrt(x);\n}\nstatic inline float futrts_exp32(float x)\n{\n    return exp(x);\n}\nstatic inline float futrts_cos32(float x)\n{\n    return cos(x);\n}\nstatic inline float futrts_sin32(float x)\n{\n    return sin(x);\n}\nstatic inline float futrts_tan32(float x)\n{\n    return tan(x);\n}\nstatic inline float futrts_acos32(float x)\n{\n    return acos(x);\n}\nstatic inline float futrts_asin32(float x)\n{\n    return asin(x);\n}\nstatic inline float futrts_atan32(float x)\n{\n    return atan(x);\n}\nstatic inline float futrts_cosh32(float x)\n{\n    return cosh(x);\n}\nstatic inline float futrts_sinh32(float x)\n{\n    return sinh(x);\n}\nstatic inline float futrts_tanh32(float x)\n{\n    return tanh(x);\n}\nstatic inline float futrts_acosh32(float x)\n{\n    return acosh(x);\n}\nstatic inline fl",
                   "oat futrts_asinh32(float x)\n{\n    return asinh(x);\n}\nstatic inline float futrts_atanh32(float x)\n{\n    return atanh(x);\n}\nstatic inline float futrts_atan2_32(float x, float y)\n{\n    return atan2(x, y);\n}\nstatic inline float futrts_gamma32(float x)\n{\n    return tgamma(x);\n}\nstatic inline float futrts_lgamma32(float x)\n{\n    return lgamma(x);\n}\nstatic inline bool futrts_isnan32(float x)\n{\n    return isnan(x);\n}\nstatic inline bool futrts_isinf32(float x)\n{\n    return isinf(x);\n}\nstatic inline int32_t futrts_to_bits32(float x)\n{\n    union {\n        float f;\n        int32_t t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\nstatic inline float futrts_from_bits32(int32_t x)\n{\n    union {\n        int32_t f;\n        float t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\n#ifdef __OPENCL_VERSION__\nstatic inline float fmod32(float x, float y)\n{\n    return fmod(x, y);\n}\nstatic inline float futrts_round32(float x)\n{\n    return rint(x);\n}\nstatic inline float futrts_floor32(float x)\n{\n    return floor(x);\n}\nstatic inline float futrts_ceil32(float x)\n{\n    return ceil(x);\n}\nstatic inline float futrts_lerp32(float v0, float v1, float t)\n{\n    return mix(v0, v1, t);\n}\nstatic inline float futrts_mad32(float a, float b, float c)\n{\n    return mad(a, b, c);\n}\nstatic inline float futrts_fma32(float a, float b, float c)\n{\n    return fma(a, b, c);\n}\n#else\nstatic inline float fmod32(float x, float y)\n{\n    return fmodf(x, y);\n}\nstatic inline float futrts_round32(float x)\n{\n    return rintf(x);\n}\nstatic inline float futrts_floor32(float x)\n{\n    return floorf(x);\n}\nstatic inline float futrts_ceil32(float x)\n{\n    return ceilf(x);\n}\nstatic inline float futrts_lerp32(float v0, float v1, float t)\n{\n    return v0 + (v1 - v0) * t;\n}\nstatic inline float futrts_mad32(float a, float b, float c)\n{\n    return a * b + c;\n}\nstatic inline float futrts_fma32(float a, float b, float c)\n{\n    return fmaf(a, b, c);\n}\n#endif\n// Start of atomics.h\n\ninline int32_t atomic_add_i32_global(volatile __global int32_t *p, ",
                   "int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\ninline int32_t atomic_add_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\ninline float atomic_fadd_f32_global(volatile __global float *p, float x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg((volatile __global int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\ninline float atomic_fadd_f32_local(volatile __local float *p, float x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg((volatile __local int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\ninline int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline int32_t atomic_smax_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline int32_t atomic_smin_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p",
                   ", x);\n#endif\n}\n\ninline uint32_t atomic_umax_i32_local(volatile __local uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline uint32_t atomic_umin_i32_local(volatile __local uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\ninline int32_t atomic_and_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\ninline int32_t atomic_or_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\ninline int32_t atomic_or_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\ninline int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xor_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xchg_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t",
                   " atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                         int32_t cmp, int32_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\ninline int32_t atomic_cmpxchg_i32_local(volatile __local int32_t *p,\n                                         int32_t cmp, int32_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\n// End of atomics.h\n\n\n\n\n__kernel void builtinzhreplicate_f32zireplicate_29834(__global\n                                                      unsigned char *mem_29830,\n                                                      int32_t num_elems_29831,\n                                                      float val_29832)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t replicate_gtid_29834;\n    int32_t replicate_ltid_29835;\n    int32_t replicate_gid_29836;\n    \n    replicate_gtid_29834 = get_global_id(0);\n    replicate_ltid_29835 = get_local_id(0);\n    replicate_gid_29836 = get_group_id(0);\n    if (slt64(replicate_gtid_29834, num_elems_29831)) {\n        ((__global float *) mem_29830)[sext_i32_i64(replicate_gtid_29834)] =\n            val_29832;\n    }\n    \n  error_0:\n    return;\n}\n__kernel void builtinzhreplicate_i64zireplicate_29426(__global\n                                                      unsigned char *mem_29422,\n                                                      int32_t num_elems_29423,\n                                                      int64_t val_29424)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t replicate_gtid_29426;\n    int32_t replicate_ltid_29427;\n    int32_t replicate_gid_29428;\n    \n    replicate_gtid_29426 = get_global_id(0);\n    replicate_ltid_29427 = get_local_id(0);\n    replicate_gid_29428 = get_group_id(0);\n    if (slt64(replicate_gtid_29426, nu",
                   "m_elems_29423)) {\n        ((__global int64_t *) mem_29422)[sext_i32_i64(replicate_gtid_29426)] =\n            val_29424;\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32(__local volatile\n                                    int64_t *block_9_backing_aligned_0,\n                                    int32_t destoffset_1, int32_t srcoffset_3,\n                                    int32_t num_arrays_4, int32_t x_elems_5,\n                                    int32_t y_elems_6, int32_t mulx_7,\n                                    int32_t muly_8, __global\n                                    unsigned char *destmem_0, __global\n                                    unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = get_group_id_2_42 * x_elems_5 * y_elems_6;\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t x_index_31 = get_global_id_0_37;\n    int32_t y_index_32 = get_group_id_1_41 * 32 + get_local_id_1_39;\n    \n    if (slt32(x_index_31, x_elems_5)) {\n        for (int32_t j_43 = 0; j_43 < 4; j_43++) {\n            int32",
                   "_t index_in_35 = (y_index_32 + j_43 * 8) * x_elems_5 +\n                    x_index_31;\n            \n            if (slt32(y_index_32 + j_43 * 8, y_elems_6)) {\n                ((__local float *) block_9)[sext_i32_i64((get_local_id_1_39 +\n                                                          j_43 * 8) * 33 +\n                                            get_local_id_0_38)] = ((__global\n                                                                    float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                                       index_in_35)];\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    x_index_31 = get_group_id_1_41 * 32 + get_local_id_0_38;\n    y_index_32 = get_group_id_0_40 * 32 + get_local_id_1_39;\n    if (slt32(x_index_31, y_elems_6)) {\n        for (int32_t j_43 = 0; j_43 < 4; j_43++) {\n            int32_t index_out_36 = (y_index_32 + j_43 * 8) * y_elems_6 +\n                    x_index_31;\n            \n            if (slt32(y_index_32 + j_43 * 8, x_elems_5)) {\n                ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                               index_out_36)] = ((__local\n                                                                  float *) block_9)[sext_i32_i64(get_local_id_0_38 *\n                                                                                    33 +\n                                                                                    get_local_id_1_39 +\n                                                                                    j_43 *\n                                                                                    8)];\n            }\n        }\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32_low_height(__local volatile\n                                               int64_t *block_9_backing_aligned_0,\n                                               int32_t destoffset_1,\n                   ",
                   "                            int32_t srcoffset_3,\n                                               int32_t num_arrays_4,\n                                               int32_t x_elems_5,\n                                               int32_t y_elems_6,\n                                               int32_t mulx_7, int32_t muly_8,\n                                               __global\n                                               unsigned char *destmem_0,\n                                               __global unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = get_group_id_2_42 * x_elems_5 * y_elems_6;\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t x_index_31 = get_group_id_0_40 * 16 * mulx_7 + get_local_id_0_38 +\n            srem32(get_local_id_1_39, mulx_7) * 16;\n    int32_t y_index_32 = get_group_id_1_41 * 16 + squot32(get_local_id_1_39,\n                                                          mulx_7);\n    int32_t index_in_35 = y_index_32 * x_elems_5 + x_index_31;\n    \n    if (slt32(x_index_31, x_elems_5) && slt32(",
                   "y_index_32, y_elems_6)) {\n        ((__local float *) block_9)[sext_i32_i64(get_local_id_1_39 * 17 +\n                                    get_local_id_0_38)] = ((__global\n                                                            float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                               index_in_35)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    x_index_31 = get_group_id_1_41 * 16 + squot32(get_local_id_0_38, mulx_7);\n    y_index_32 = get_group_id_0_40 * 16 * mulx_7 + get_local_id_1_39 +\n        srem32(get_local_id_0_38, mulx_7) * 16;\n    \n    int32_t index_out_36 = y_index_32 * y_elems_6 + x_index_31;\n    \n    if (slt32(x_index_31, y_elems_6) && slt32(y_index_32, x_elems_5)) {\n        ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                       index_out_36)] = ((__local\n                                                          float *) block_9)[sext_i32_i64(get_local_id_0_38 *\n                                                                            17 +\n                                                                            get_local_id_1_39)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32_low_width(__local volatile\n                                              int64_t *block_9_backing_aligned_0,\n                                              int32_t destoffset_1,\n                                              int32_t srcoffset_3,\n                                              int32_t num_arrays_4,\n                                              int32_t x_elems_5,\n                                              int32_t y_elems_6, int32_t mulx_7,\n                                              int32_t muly_8, __global\n                                              unsigned char *destmem_0, __global\n                                              unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    co",
                   "nst int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    \n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = get_group_id_2_42 * x_elems_5 * y_elems_6;\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t x_index_31 = get_group_id_0_40 * 16 + squot32(get_local_id_0_38,\n                                                          muly_8);\n    int32_t y_index_32 = get_group_id_1_41 * 16 * muly_8 + get_local_id_1_39 +\n            srem32(get_local_id_0_38, muly_8) * 16;\n    int32_t index_in_35 = y_index_32 * x_elems_5 + x_index_31;\n    \n    if (slt32(x_index_31, x_elems_5) && slt32(y_index_32, y_elems_6)) {\n        ((__local float *) block_9)[sext_i32_i64(get_local_id_1_39 * 17 +\n                                    get_local_id_0_38)] = ((__global\n                                                            float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                               index_in_35)];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    x_index_31 = get_group_id_1_41 * 16 * muly_8 + get_local_id_0_38 +\n        srem32(get_local_id_1_39, muly_8) * 16;\n    y_index_32 = get_group_id_0_40 * 16 + squot32(get_local_id_1_39, muly_8",
                   ");\n    \n    int32_t index_out_36 = y_index_32 * y_elems_6 + x_index_31;\n    \n    if (slt32(x_index_31, y_elems_6) && slt32(y_index_32, x_elems_5)) {\n        ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                       index_out_36)] = ((__local\n                                                          float *) block_9)[sext_i32_i64(get_local_id_0_38 *\n                                                                            17 +\n                                                                            get_local_id_1_39)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void gpu_map_transpose_f32_small(__local volatile\n                                          int64_t *block_9_backing_aligned_0,\n                                          int32_t destoffset_1,\n                                          int32_t srcoffset_3,\n                                          int32_t num_arrays_4,\n                                          int32_t x_elems_5, int32_t y_elems_6,\n                                          int32_t mulx_7, int32_t muly_8,\n                                          __global unsigned char *destmem_0,\n                                          __global unsigned char *srcmem_2)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict block_9_backing_0 = (__local volatile\n                                                         char *) block_9_backing_aligned_0;\n    __local char *block_9;\n    \n    block_9 = (__local char *) block_9_backing_0;\n    \n    int32_t get_global_id_0_37;\n    \n    get_global_id_0_37 = get_global_id(0);\n    \n    int32_t get_local_id_0_38;\n    \n    get_local_id_0_38 = get_local_id(0);\n    \n    int32_t get_local_id_1_39;\n    \n    get_local_id_1_39 = get_local_id(1);\n    \n    int32_t get_group_id_0_40;\n    \n    get_group_id_0_40 = get_group_id(0);\n    \n    int32_t get_group_id_1_41;\n    \n    get_group_id_1_41 = get_group_id(1);\n    ",
                   "\n    int32_t get_group_id_2_42;\n    \n    get_group_id_2_42 = get_group_id(2);\n    \n    int32_t our_array_offset_30 = squot32(get_global_id_0_37, y_elems_6 *\n                                          x_elems_5) * (y_elems_6 * x_elems_5);\n    int32_t x_index_31 = squot32(srem32(get_global_id_0_37, y_elems_6 *\n                                        x_elems_5), y_elems_6);\n    int32_t y_index_32 = srem32(get_global_id_0_37, y_elems_6);\n    int32_t odata_offset_33 = squot32(destoffset_1, 4) + our_array_offset_30;\n    int32_t idata_offset_34 = squot32(srcoffset_3, 4) + our_array_offset_30;\n    int32_t index_in_35 = y_index_32 * x_elems_5 + x_index_31;\n    int32_t index_out_36 = x_index_31 * y_elems_6 + y_index_32;\n    \n    if (slt32(get_global_id_0_37, x_elems_5 * y_elems_6 * num_arrays_4)) {\n        ((__global float *) destmem_0)[sext_i32_i64(odata_offset_33 +\n                                       index_out_36)] = ((__global\n                                                          float *) srcmem_2)[sext_i32_i64(idata_offset_34 +\n                                                                             index_in_35)];\n    }\n    \n  error_0:\n    return;\n}\n__kernel void mainziscan_stage1_27426(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29350_backing_aligned_0,\n                                      int64_t n_25418, int64_t flat_dim_25607,\n                                      float res_25869, __global\n                                      unsigned char *res_mem_28932, __global\n                                      unsigned char *res_mem_28933, __global\n                                      unsigned char *mem_28973, __global\n                                      unsigned char *mem_28975,\n                                      int32_t num_threads_29344)\n{\n    #define segscan_group_sizze_27421 (mainzisegscan_group_sizze_27420)\n    \n    const int block_dim0 = 0;\n    const in",
                   "t block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29350_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29350_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29345;\n    int32_t local_tid_29346;\n    int64_t group_sizze_29349;\n    int32_t wave_sizze_29348;\n    int32_t group_tid_29347;\n    \n    global_tid_29345 = get_global_id(0);\n    local_tid_29346 = get_local_id(0);\n    group_sizze_29349 = get_local_size(0);\n    wave_sizze_29348 = LOCKSTEP_WIDTH;\n    group_tid_29347 = get_group_id(0);\n    \n    int32_t phys_tid_27426;\n    \n    phys_tid_27426 = global_tid_29345;\n    \n    __local char *scan_arr_mem_29350;\n    \n    scan_arr_mem_29350 = (__local char *) scan_arr_mem_29350_backing_0;\n    \n    int64_t x_25875;\n    int64_t x_25876;\n    \n    x_25875 = 0;\n    for (int64_t j_29352 = 0; j_29352 < sdiv_up64(flat_dim_25607,\n                                                  sext_i32_i64(num_threads_29344));\n         j_29352++) {\n        int64_t chunk_offset_29353 = segscan_group_sizze_27421 * j_29352 +\n                sext_i32_i64(group_tid_29347) * (segscan_group_sizze_27421 *\n                                                 sdiv_up64(flat_dim_25607,\n                                                           sext_i32_i64(num_threads_29344)));\n        int64_t flat_idx_29354 = chunk_offset_29353 +\n                sext_i32_i64(local_tid_29346);\n        int64_t gtid_27425 = flat_idx_29354;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27425, flat_dim_25607)) {\n                int64_t binop_x_28804 = squot64(gtid_27425, n_25418);\n                int64_t binop_y_28805 = n_25418 * binop_x_28804;\n                int64_t new_index_28806 = gtid_27425 - binop_y_28805;\n                int64_t x_25878 = ((__global\n                                    int64_t *) res_mem_28932)[new_index_28806];\n          ",
                   "      float x_25879 = ((__global\n                                  float *) res_mem_28933)[new_index_28806];\n                float x_25880 = res_25869 / x_25879;\n                float ceil_arg_25881 = x_25880 - 1.0F;\n                float res_25882;\n                \n                res_25882 = futrts_ceil32(ceil_arg_25881);\n                \n                int64_t res_25883 = fptosi_f32_i64(res_25882);\n                int64_t max_arg_25884 = sub64(x_25878, res_25883);\n                int64_t res_25885 = smax64(0, max_arg_25884);\n                bool cond_25886 = res_25885 == 0;\n                int64_t res_25887;\n                \n                if (cond_25886) {\n                    res_25887 = 1;\n                } else {\n                    res_25887 = res_25885;\n                }\n                // write to-scan values to parameters\n                {\n                    x_25876 = res_25887;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global int64_t *) mem_28975)[gtid_27425] = res_25887;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27425, flat_dim_25607)) {\n                    x_25876 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_25877 = add64(x_25875, x_25876);\n                \n                ((__local\n                  int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)] =\n                    res_25877;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_29355;\n            int64_t x_29356;\n            int64_t x_29358;\n            int64_t x_29359;\n            bool ltid_in_bounds_29361;\n            \n            ltid_in_bounds_29361 = slt64(sext_i32_i64(local_tid_29346),\n   ",
                   "                                      segscan_group_sizze_27421);\n            \n            int32_t skip_threads_29362;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_29361) {\n                    x_29356 = ((volatile __local\n                                int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)];\n                    if ((local_tid_29346 - squot32(local_tid_29346, 32) * 32) ==\n                        0) {\n                        x_29355 = x_29356;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29362 = 1;\n                while (slt32(skip_threads_29362, 32)) {\n                    if (sle32(skip_threads_29362, local_tid_29346 -\n                              squot32(local_tid_29346, 32) * 32) &&\n                        ltid_in_bounds_29361) {\n                        // read operands\n                        {\n                            x_29355 = ((volatile __local\n                                        int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346) -\n                                                                       sext_i32_i64(skip_threads_29362)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_29357 = add64(x_29355, x_29356);\n                            \n                            x_29355 = res_29357;\n                        }\n                    }\n                    if (sle32(wave_sizze_29348, skip_threads_29362)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29362, local_tid_29346 -\n                              squot32(local_tid_29346, 32) * 32) &&\n                        ltid_in_bounds_29361) {\n                        // write result\n                        {\n                            ((volat",
                   "ile __local\n                              int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)] =\n                                x_29355;\n                            x_29356 = x_29355;\n                        }\n                    }\n                    if (sle32(wave_sizze_29348, skip_threads_29362)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29362 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_29346 - squot32(local_tid_29346, 32) * 32) ==\n                    31 && ltid_in_bounds_29361) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29350)[sext_i32_i64(squot32(local_tid_29346,\n                                                                          32))] =\n                        x_29355;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_29363;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_29346, 32) == 0 &&\n                        ltid_in_bounds_29361) {\n                        x_29359 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)];\n                        if ((local_tid_29346 - squot32(local_tid_29346, 32) *\n                             32) == 0) {\n                            x_29358 = x_29359;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29363 = 1;\n                    while (slt32(skip_threads_29363, 32)) {\n                        if (sle32(skip_threads",
                   "_29363, local_tid_29346 -\n                                  squot32(local_tid_29346, 32) * 32) &&\n                            (squot32(local_tid_29346, 32) == 0 &&\n                             ltid_in_bounds_29361)) {\n                            // read operands\n                            {\n                                x_29358 = ((volatile __local\n                                            int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346) -\n                                                                           sext_i32_i64(skip_threads_29363)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_29360 = add64(x_29358, x_29359);\n                                \n                                x_29358 = res_29360;\n                            }\n                        }\n                        if (sle32(wave_sizze_29348, skip_threads_29363)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29363, local_tid_29346 -\n                                  squot32(local_tid_29346, 32) * 32) &&\n                            (squot32(local_tid_29346, 32) == 0 &&\n                             ltid_in_bounds_29361)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)] =\n                                    x_29358;\n                                x_29359 = x_29358;\n                            }\n                        }\n                        if (sle32(wave_sizze_29348, skip_threads_29363)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29363 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);",
                   "\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_29346, 32) == 0 ||\n                      !ltid_in_bounds_29361)) {\n                    // read operands\n                    {\n                        x_29356 = x_29355;\n                        x_29355 = ((__local\n                                    int64_t *) scan_arr_mem_29350)[sext_i32_i64(squot32(local_tid_29346,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_29357 = add64(x_29355, x_29356);\n                        \n                        x_29355 = res_29357;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)] =\n                            x_29355;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_29346, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)] =\n                        x_29356;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_27425, flat_dim_25607)) {\n                    ((__global int64_t *) mem_28973)[gtid_27425] = ((__local\n                                                                     int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteratio",
                   "n\n            {\n                bool crosses_segment_29364 = 0;\n                bool should_load_carry_29365 = local_tid_29346 == 0 &&\n                     !crosses_segment_29364;\n                \n                if (should_load_carry_29365) {\n                    x_25875 = ((__local\n                                int64_t *) scan_arr_mem_29350)[segscan_group_sizze_27421 -\n                                                               1];\n                }\n                if (!should_load_carry_29365) {\n                    x_25875 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27421\n}\n__kernel void mainziscan_stage1_27459(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29589_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29587_backing_aligned_1,\n                                      int64_t res_25889, __global\n                                      unsigned char *mem_28980, __global\n                                      unsigned char *mem_28984, __global\n                                      unsigned char *mem_28986,\n                                      int32_t num_threads_29581)\n{\n    #define segscan_group_sizze_27454 (mainzisegscan_group_sizze_27453)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29589_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_29589_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29587_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29587_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_t",
                   "id_29582;\n    int32_t local_tid_29583;\n    int64_t group_sizze_29586;\n    int32_t wave_sizze_29585;\n    int32_t group_tid_29584;\n    \n    global_tid_29582 = get_global_id(0);\n    local_tid_29583 = get_local_id(0);\n    group_sizze_29586 = get_local_size(0);\n    wave_sizze_29585 = LOCKSTEP_WIDTH;\n    group_tid_29584 = get_group_id(0);\n    \n    int32_t phys_tid_27459;\n    \n    phys_tid_27459 = global_tid_29582;\n    \n    __local char *scan_arr_mem_29587;\n    __local char *scan_arr_mem_29589;\n    \n    scan_arr_mem_29587 = (__local char *) scan_arr_mem_29587_backing_0;\n    scan_arr_mem_29589 = (__local char *) scan_arr_mem_29589_backing_1;\n    \n    bool x_25908;\n    int64_t x_25909;\n    bool x_25910;\n    int64_t x_25911;\n    \n    x_25908 = 0;\n    x_25909 = 0;\n    for (int64_t j_29591 = 0; j_29591 < sdiv_up64(res_25889,\n                                                  sext_i32_i64(num_threads_29581));\n         j_29591++) {\n        int64_t chunk_offset_29592 = segscan_group_sizze_27454 * j_29591 +\n                sext_i32_i64(group_tid_29584) * (segscan_group_sizze_27454 *\n                                                 sdiv_up64(res_25889,\n                                                           sext_i32_i64(num_threads_29581)));\n        int64_t flat_idx_29593 = chunk_offset_29592 +\n                sext_i32_i64(local_tid_29583);\n        int64_t gtid_27458 = flat_idx_29593;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27458, res_25889)) {\n                int64_t x_25915 = ((__global int64_t *) mem_28980)[gtid_27458];\n                bool res_25916 = slt64(0, x_25915);\n                \n                // write to-scan values to parameters\n                {\n                    x_25910 = res_25916;\n                    x_25911 = x_25915;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // may",
                   "be restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27458, res_25889)) {\n                    x_25910 = 0;\n                    x_25911 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_25912 = x_25908 || x_25910;\n                int64_t res_25913;\n                \n                if (x_25910) {\n                    res_25913 = x_25911;\n                } else {\n                    int64_t res_25914 = add64(x_25909, x_25911);\n                    \n                    res_25913 = res_25914;\n                }\n                ((__local\n                  bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)] =\n                    res_25912;\n                ((__local\n                  int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)] =\n                    res_25913;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_29594;\n            int64_t x_29595;\n            bool x_29596;\n            int64_t x_29597;\n            bool x_29601;\n            int64_t x_29602;\n            bool x_29603;\n            int64_t x_29604;\n            bool ltid_in_bounds_29608;\n            \n            ltid_in_bounds_29608 = slt64(sext_i32_i64(local_tid_29583),\n                                         segscan_group_sizze_27454);\n            \n            int32_t skip_threads_29609;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_29608) {\n                    x_29596 = ((volatile __local\n                                bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)];\n                    x_29597 = ((volatile __local\n                                int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)];\n                    if ((local_tid_29583 - squot32(local_tid_29583, 32) * 32) ==\n                        0) {\n                        x_2959",
                   "4 = x_29596;\n                        x_29595 = x_29597;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29609 = 1;\n                while (slt32(skip_threads_29609, 32)) {\n                    if (sle32(skip_threads_29609, local_tid_29583 -\n                              squot32(local_tid_29583, 32) * 32) &&\n                        ltid_in_bounds_29608) {\n                        // read operands\n                        {\n                            x_29594 = ((volatile __local\n                                        bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583) -\n                                                                    sext_i32_i64(skip_threads_29609)];\n                            x_29595 = ((volatile __local\n                                        int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583) -\n                                                                       sext_i32_i64(skip_threads_29609)];\n                        }\n                        // perform operation\n                        {\n                            bool res_29598 = x_29594 || x_29596;\n                            int64_t res_29599;\n                            \n                            if (x_29596) {\n                                res_29599 = x_29597;\n                            } else {\n                                int64_t res_29600 = add64(x_29595, x_29597);\n                                \n                                res_29599 = res_29600;\n                            }\n                            x_29594 = res_29598;\n                            x_29595 = res_29599;\n                        }\n                    }\n                    if (sle32(wave_sizze_29585, skip_threads_29609)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29609, local_tid_29583 -\n                ",
                   "              squot32(local_tid_29583, 32) * 32) &&\n                        ltid_in_bounds_29608) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)] =\n                                x_29594;\n                            x_29596 = x_29594;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)] =\n                                x_29595;\n                            x_29597 = x_29595;\n                        }\n                    }\n                    if (sle32(wave_sizze_29585, skip_threads_29609)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29609 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_29583 - squot32(local_tid_29583, 32) * 32) ==\n                    31 && ltid_in_bounds_29608) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_29587)[sext_i32_i64(squot32(local_tid_29583,\n                                                                       32))] =\n                        x_29594;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29589)[sext_i32_i64(squot32(local_tid_29583,\n                                                                          32))] =\n                        x_29595;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_29610;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_29583, 32) == 0 &",
                   "&\n                        ltid_in_bounds_29608) {\n                        x_29603 = ((volatile __local\n                                    bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)];\n                        x_29604 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)];\n                        if ((local_tid_29583 - squot32(local_tid_29583, 32) *\n                             32) == 0) {\n                            x_29601 = x_29603;\n                            x_29602 = x_29604;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29610 = 1;\n                    while (slt32(skip_threads_29610, 32)) {\n                        if (sle32(skip_threads_29610, local_tid_29583 -\n                                  squot32(local_tid_29583, 32) * 32) &&\n                            (squot32(local_tid_29583, 32) == 0 &&\n                             ltid_in_bounds_29608)) {\n                            // read operands\n                            {\n                                x_29601 = ((volatile __local\n                                            bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583) -\n                                                                        sext_i32_i64(skip_threads_29610)];\n                                x_29602 = ((volatile __local\n                                            int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583) -\n                                                                           sext_i32_i64(skip_threads_29610)];\n                            }\n                            // perform operation\n                            {\n                                bool res_29605 = x_29601 || x_29603;\n                                int64_t res_29606;\n                                \n                                i",
                   "f (x_29603) {\n                                    res_29606 = x_29604;\n                                } else {\n                                    int64_t res_29607 = add64(x_29602, x_29604);\n                                    \n                                    res_29606 = res_29607;\n                                }\n                                x_29601 = res_29605;\n                                x_29602 = res_29606;\n                            }\n                        }\n                        if (sle32(wave_sizze_29585, skip_threads_29610)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29610, local_tid_29583 -\n                                  squot32(local_tid_29583, 32) * 32) &&\n                            (squot32(local_tid_29583, 32) == 0 &&\n                             ltid_in_bounds_29608)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)] =\n                                    x_29601;\n                                x_29603 = x_29601;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)] =\n                                    x_29602;\n                                x_29604 = x_29602;\n                            }\n                        }\n                        if (sle32(wave_sizze_29585, skip_threads_29610)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29610 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_29583, 32) == 0 ||\n                      !ltid_in_bounds_296",
                   "08)) {\n                    // read operands\n                    {\n                        x_29596 = x_29594;\n                        x_29597 = x_29595;\n                        x_29594 = ((__local\n                                    bool *) scan_arr_mem_29587)[sext_i32_i64(squot32(local_tid_29583,\n                                                                                     32)) -\n                                                                1];\n                        x_29595 = ((__local\n                                    int64_t *) scan_arr_mem_29589)[sext_i32_i64(squot32(local_tid_29583,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        bool res_29598 = x_29594 || x_29596;\n                        int64_t res_29599;\n                        \n                        if (x_29596) {\n                            res_29599 = x_29597;\n                        } else {\n                            int64_t res_29600 = add64(x_29595, x_29597);\n                            \n                            res_29599 = res_29600;\n                        }\n                        x_29594 = res_29598;\n                        x_29595 = res_29599;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)] =\n                            x_29594;\n                        ((__local\n                          int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)] =\n                            x_29595;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_29583, 32) == 0)",
                   " {\n                    ((__local\n                      bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)] =\n                        x_29596;\n                    ((__local\n                      int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)] =\n                        x_29597;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_27458, res_25889)) {\n                    ((__global bool *) mem_28984)[gtid_27458] = ((__local\n                                                                  bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)];\n                    ((__global int64_t *) mem_28986)[gtid_27458] = ((__local\n                                                                     int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_29611 = 0;\n                bool should_load_carry_29612 = local_tid_29583 == 0 &&\n                     !crosses_segment_29611;\n                \n                if (should_load_carry_29612) {\n                    x_25908 = ((__local\n                                bool *) scan_arr_mem_29587)[segscan_group_sizze_27454 -\n                                                            1];\n                    x_25909 = ((__local\n                                int64_t *) scan_arr_mem_29589)[segscan_group_sizze_27454 -\n                                                               1];\n                }\n                if (!should_load_carry_29612) {\n                    x_25908 = 0;\n                    x_25909 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27454\n}\n__kernel void mainzis",
                   "can_stage1_27467(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29656_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29654_backing_aligned_1,\n                                      int64_t res_25889, __global\n                                      unsigned char *mem_28986, __global\n                                      unsigned char *mem_28989, __global\n                                      unsigned char *mem_28991, __global\n                                      unsigned char *mem_28993,\n                                      int32_t num_threads_29648)\n{\n    #define segscan_group_sizze_27462 (mainzisegscan_group_sizze_27461)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29656_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_29656_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29654_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29654_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29649;\n    int32_t local_tid_29650;\n    int64_t group_sizze_29653;\n    int32_t wave_sizze_29652;\n    int32_t group_tid_29651;\n    \n    global_tid_29649 = get_global_id(0);\n    local_tid_29650 = get_local_id(0);\n    group_sizze_29653 = get_local_size(0);\n    wave_sizze_29652 = LOCKSTEP_WIDTH;\n    group_tid_29651 = get_group_id(0);\n    \n    int32_t phys_tid_27467;\n    \n    phys_tid_27467 = global_tid_29649;\n    \n    __local char *scan_arr_mem_29654;\n    __local char *scan_arr_mem_29656;\n    \n    scan_arr_mem_29654 = (__local char *) scan_arr_mem_29654_backing_0;\n    scan_arr_mem_29656 = (__local char *) scan_arr_mem_29656_backing_1;\n    ",
                   "\n    bool x_25947;\n    int64_t x_25948;\n    bool x_25949;\n    int64_t x_25950;\n    \n    x_25947 = 0;\n    x_25948 = 0;\n    for (int64_t j_29658 = 0; j_29658 < sdiv_up64(res_25889,\n                                                  sext_i32_i64(num_threads_29648));\n         j_29658++) {\n        int64_t chunk_offset_29659 = segscan_group_sizze_27462 * j_29658 +\n                sext_i32_i64(group_tid_29651) * (segscan_group_sizze_27462 *\n                                                 sdiv_up64(res_25889,\n                                                           sext_i32_i64(num_threads_29648)));\n        int64_t flat_idx_29660 = chunk_offset_29659 +\n                sext_i32_i64(local_tid_29650);\n        int64_t gtid_27466 = flat_idx_29660;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27466, res_25889)) {\n                int64_t x_25954 = ((__global int64_t *) mem_28986)[gtid_27466];\n                int64_t i_p_o_28815 = add64(-1, gtid_27466);\n                int64_t rot_i_28816 = smod64(i_p_o_28815, res_25889);\n                int64_t x_25955 = ((__global int64_t *) mem_28986)[rot_i_28816];\n                bool res_25957 = x_25954 == x_25955;\n                bool res_25958 = !res_25957;\n                \n                // write to-scan values to parameters\n                {\n                    x_25949 = res_25958;\n                    x_25950 = 1;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global bool *) mem_28993)[gtid_27466] = res_25958;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27466, res_25889)) {\n                    x_25949 = 0;\n                    x_25950 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n  ",
                   "              bool res_25951 = x_25947 || x_25949;\n                int64_t res_25952;\n                \n                if (x_25949) {\n                    res_25952 = x_25950;\n                } else {\n                    int64_t res_25953 = add64(x_25948, x_25950);\n                    \n                    res_25952 = res_25953;\n                }\n                ((__local\n                  bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)] =\n                    res_25951;\n                ((__local\n                  int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650)] =\n                    res_25952;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_29661;\n            int64_t x_29662;\n            bool x_29663;\n            int64_t x_29664;\n            bool x_29668;\n            int64_t x_29669;\n            bool x_29670;\n            int64_t x_29671;\n            bool ltid_in_bounds_29675;\n            \n            ltid_in_bounds_29675 = slt64(sext_i32_i64(local_tid_29650),\n                                         segscan_group_sizze_27462);\n            \n            int32_t skip_threads_29676;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_29675) {\n                    x_29663 = ((volatile __local\n                                bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)];\n                    x_29664 = ((volatile __local\n                                int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650)];\n                    if ((local_tid_29650 - squot32(local_tid_29650, 32) * 32) ==\n                        0) {\n                        x_29661 = x_29663;\n                        x_29662 = x_29664;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29676 = 1;\n                while (slt32(skip_threads_29676, 32)) {\n                    if ",
                   "(sle32(skip_threads_29676, local_tid_29650 -\n                              squot32(local_tid_29650, 32) * 32) &&\n                        ltid_in_bounds_29675) {\n                        // read operands\n                        {\n                            x_29661 = ((volatile __local\n                                        bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650) -\n                                                                    sext_i32_i64(skip_threads_29676)];\n                            x_29662 = ((volatile __local\n                                        int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650) -\n                                                                       sext_i32_i64(skip_threads_29676)];\n                        }\n                        // perform operation\n                        {\n                            bool res_29665 = x_29661 || x_29663;\n                            int64_t res_29666;\n                            \n                            if (x_29663) {\n                                res_29666 = x_29664;\n                            } else {\n                                int64_t res_29667 = add64(x_29662, x_29664);\n                                \n                                res_29666 = res_29667;\n                            }\n                            x_29661 = res_29665;\n                            x_29662 = res_29666;\n                        }\n                    }\n                    if (sle32(wave_sizze_29652, skip_threads_29676)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29676, local_tid_29650 -\n                              squot32(local_tid_29650, 32) * 32) &&\n                        ltid_in_bounds_29675) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)] =",
                   "\n                                x_29661;\n                            x_29663 = x_29661;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650)] =\n                                x_29662;\n                            x_29664 = x_29662;\n                        }\n                    }\n                    if (sle32(wave_sizze_29652, skip_threads_29676)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29676 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_29650 - squot32(local_tid_29650, 32) * 32) ==\n                    31 && ltid_in_bounds_29675) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_29654)[sext_i32_i64(squot32(local_tid_29650,\n                                                                       32))] =\n                        x_29661;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29656)[sext_i32_i64(squot32(local_tid_29650,\n                                                                          32))] =\n                        x_29662;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_29677;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_29650, 32) == 0 &&\n                        ltid_in_bounds_29675) {\n                        x_29670 = ((volatile __local\n                                    bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)];\n                        x_29671 = ((volatile __local\n                                    int64_t *) scan",
                   "_arr_mem_29656)[sext_i32_i64(local_tid_29650)];\n                        if ((local_tid_29650 - squot32(local_tid_29650, 32) *\n                             32) == 0) {\n                            x_29668 = x_29670;\n                            x_29669 = x_29671;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29677 = 1;\n                    while (slt32(skip_threads_29677, 32)) {\n                        if (sle32(skip_threads_29677, local_tid_29650 -\n                                  squot32(local_tid_29650, 32) * 32) &&\n                            (squot32(local_tid_29650, 32) == 0 &&\n                             ltid_in_bounds_29675)) {\n                            // read operands\n                            {\n                                x_29668 = ((volatile __local\n                                            bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650) -\n                                                                        sext_i32_i64(skip_threads_29677)];\n                                x_29669 = ((volatile __local\n                                            int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650) -\n                                                                           sext_i32_i64(skip_threads_29677)];\n                            }\n                            // perform operation\n                            {\n                                bool res_29672 = x_29668 || x_29670;\n                                int64_t res_29673;\n                                \n                                if (x_29670) {\n                                    res_29673 = x_29671;\n                                } else {\n                                    int64_t res_29674 = add64(x_29669, x_29671);\n                                    \n                                    res_29673 = res_29674;\n              ",
                   "                  }\n                                x_29668 = res_29672;\n                                x_29669 = res_29673;\n                            }\n                        }\n                        if (sle32(wave_sizze_29652, skip_threads_29677)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29677, local_tid_29650 -\n                                  squot32(local_tid_29650, 32) * 32) &&\n                            (squot32(local_tid_29650, 32) == 0 &&\n                             ltid_in_bounds_29675)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)] =\n                                    x_29668;\n                                x_29670 = x_29668;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650)] =\n                                    x_29669;\n                                x_29671 = x_29669;\n                            }\n                        }\n                        if (sle32(wave_sizze_29652, skip_threads_29677)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29677 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_29650, 32) == 0 ||\n                      !ltid_in_bounds_29675)) {\n                    // read operands\n                    {\n                        x_29663 = x_29661;\n                        x_29664 = x_29662;\n                        x_29661 = ((__local\n                                    bool *) scan_arr_mem_29654)[sext_i32_i64(squot32(local_tid_29650,\n     ",
                   "                                                                                32)) -\n                                                                1];\n                        x_29662 = ((__local\n                                    int64_t *) scan_arr_mem_29656)[sext_i32_i64(squot32(local_tid_29650,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        bool res_29665 = x_29661 || x_29663;\n                        int64_t res_29666;\n                        \n                        if (x_29663) {\n                            res_29666 = x_29664;\n                        } else {\n                            int64_t res_29667 = add64(x_29662, x_29664);\n                            \n                            res_29666 = res_29667;\n                        }\n                        x_29661 = res_29665;\n                        x_29662 = res_29666;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)] =\n                            x_29661;\n                        ((__local\n                          int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650)] =\n                            x_29662;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_29650, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)] =\n                        x_29663;\n                    ((__local\n                      int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650)] =\n                        x_29664;\n     ",
                   "           }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_27466, res_25889)) {\n                    ((__global bool *) mem_28989)[gtid_27466] = ((__local\n                                                                  bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)];\n                    ((__global int64_t *) mem_28991)[gtid_27466] = ((__local\n                                                                     int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_29678 = 0;\n                bool should_load_carry_29679 = local_tid_29650 == 0 &&\n                     !crosses_segment_29678;\n                \n                if (should_load_carry_29679) {\n                    x_25947 = ((__local\n                                bool *) scan_arr_mem_29654)[segscan_group_sizze_27462 -\n                                                            1];\n                    x_25948 = ((__local\n                                int64_t *) scan_arr_mem_29656)[segscan_group_sizze_27462 -\n                                                               1];\n                }\n                if (!should_load_carry_29679) {\n                    x_25947 = 0;\n                    x_25948 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27462\n}\n__kernel void mainziscan_stage1_27475(__global int *global_failure,\n                                      int failure_is_an_option, __global\n                                      int64_t *global_failure_args,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_",
                   "29723_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29721_backing_aligned_1,\n                                      int64_t n_25418, int64_t paths_25421,\n                                      float a_25426, float b_25427,\n                                      float sigma_25428, int64_t flat_dim_25607,\n                                      float res_25869, int64_t res_25889,\n                                      int64_t i_27351, __global\n                                      unsigned char *res_mem_28930, __global\n                                      unsigned char *res_mem_28931, __global\n                                      unsigned char *res_mem_28932, __global\n                                      unsigned char *res_mem_28933, __global\n                                      unsigned char *mem_28961, __global\n                                      unsigned char *mem_28986, __global\n                                      unsigned char *mem_28991, __global\n                                      unsigned char *mem_28993, __global\n                                      unsigned char *mem_28996, __global\n                                      unsigned char *mem_28998,\n                                      int32_t num_threads_29715)\n{\n    #define segscan_group_sizze_27470 (mainzisegscan_group_sizze_27469)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29723_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_29723_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29721_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29721_backing_aligned_1;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n   ",
                   "     if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29716;\n    int32_t local_tid_29717;\n    int64_t group_sizze_29720;\n    int32_t wave_sizze_29719;\n    int32_t group_tid_29718;\n    \n    global_tid_29716 = get_global_id(0);\n    local_tid_29717 = get_local_id(0);\n    group_sizze_29720 = get_local_size(0);\n    wave_sizze_29719 = LOCKSTEP_WIDTH;\n    group_tid_29718 = get_group_id(0);\n    \n    int32_t phys_tid_27475;\n    \n    phys_tid_27475 = global_tid_29716;\n    \n    __local char *scan_arr_mem_29721;\n    __local char *scan_arr_mem_29723;\n    \n    scan_arr_mem_29721 = (__local char *) scan_arr_mem_29721_backing_0;\n    scan_arr_mem_29723 = (__local char *) scan_arr_mem_29723_backing_1;\n    \n    bool x_25973;\n    float x_25974;\n    bool x_25975;\n    float x_25976;\n    \n    x_25973 = 0;\n    x_25974 = 0.0F;\n    for (int64_t j_29725 = 0; j_29725 < sdiv_up64(res_25889,\n                                                  sext_i32_i64(num_threads_29715));\n         j_29725++) {\n        int64_t chunk_offset_29726 = segscan_group_sizze_27470 * j_29725 +\n                sext_i32_i64(group_tid_29718) * (segscan_group_sizze_27470 *\n                                                 sdiv_up64(res_25889,\n                                                           sext_i32_i64(num_threads_29715)));\n        int64_t flat_idx_29727 = chunk_offset_29726 +\n                sext_i32_i64(local_tid_29717);\n        int64_t gtid_27474 = flat_idx_29727;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27474, res_25889)) {\n                int64_t x_25981 = ((__global int64_t *) mem_28991)[gtid_27474];\n                int64_t x_25982 = ((__global int64_t *) mem_28986)[gtid_27474];\n                bool x_25983 = ((__global bool *) mem_28993)[gtid_27474];\n                int64_t res_25986 = sub64(x_25981, 1);\n                bool x_25987 = sle64(0, x_25982);\n                bool y_25988 = sl",
                   "t64(x_25982, flat_dim_25607);\n                bool bounds_check_25989 = x_25987 && y_25988;\n                bool index_certs_25990;\n                \n                if (!bounds_check_25989) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 8) ==\n                            -1) {\n                            global_failure_args[0] = x_25982;\n                            global_failure_args[1] = flat_dim_25607;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t new_index_25991 = squot64(x_25982, n_25418);\n                int64_t binop_y_25992 = n_25418 * new_index_25991;\n                int64_t new_index_25993 = x_25982 - binop_y_25992;\n                int64_t lifted_0_get_arg_25997 = ((__global\n                                                   int64_t *) res_mem_28932)[new_index_25993];\n                float lifted_0_get_arg_25998 = ((__global\n                                                 float *) res_mem_28933)[new_index_25993];\n                float x_25999 = res_25869 / lifted_0_get_arg_25998;\n                float ceil_arg_26000 = x_25999 - 1.0F;\n                float res_26001;\n                \n                res_26001 = futrts_ceil32(ceil_arg_26000);\n                \n                int64_t res_26002 = fptosi_f32_i64(res_26001);\n                int64_t max_arg_26003 = sub64(lifted_0_get_arg_25997,\n                                              res_26002);\n                int64_t res_26004 = smax64(0, max_arg_26003);\n                bool cond_26005 = res_26004 == 0;\n                float res_26006;\n                \n                if (cond_26005) {\n                    res_26006 = 0.0F;\n                } else {\n                    float lifted_0_get_arg_25994 = ((__global\n                                                     float *) mem_28961)[i_2",
                   "7351 *\n                                                                         paths_25421 +\n                                                                         new_index_25991];\n                    float lifted_0_get_arg_25995 = ((__global\n                                                     float *) res_mem_28930)[new_index_25993];\n                    float lifted_0_get_arg_25996 = ((__global\n                                                     float *) res_mem_28931)[new_index_25993];\n                    float res_26007;\n                    \n                    res_26007 = futrts_ceil32(x_25999);\n                    \n                    float start_26008 = lifted_0_get_arg_25998 * res_26007;\n                    float res_26009;\n                    \n                    res_26009 = futrts_ceil32(ceil_arg_26000);\n                    \n                    int64_t res_26010 = fptosi_f32_i64(res_26009);\n                    int64_t max_arg_26011 = sub64(lifted_0_get_arg_25997,\n                                                  res_26010);\n                    int64_t res_26012 = smax64(0, max_arg_26011);\n                    int64_t sizze_26013 = sub64(res_26012, 1);\n                    bool cond_26014 = res_25986 == 0;\n                    float res_26015;\n                    \n                    if (cond_26014) {\n                        res_26015 = 1.0F;\n                    } else {\n                        res_26015 = 0.0F;\n                    }\n                    \n                    bool cond_26016 = slt64(0, res_25986);\n                    float res_26017;\n                    \n                    if (cond_26016) {\n                        float y_26018 = lifted_0_get_arg_25995 *\n                              lifted_0_get_arg_25998;\n                        float res_26019 = res_26015 - y_26018;\n                        \n                        res_26017 = res_26019;\n                    } else {\n                        res_26017 = res_26015;\n                    }\n   ",
                   "                 \n                    bool cond_26020 = res_25986 == sizze_26013;\n                    float res_26021;\n                    \n                    if (cond_26020) {\n                        float res_26022 = res_26017 - 1.0F;\n                        \n                        res_26021 = res_26022;\n                    } else {\n                        res_26021 = res_26017;\n                    }\n                    \n                    float res_26023 = lifted_0_get_arg_25996 * res_26021;\n                    float res_26024 = sitofp_i64_f32(res_25986);\n                    float y_26025 = lifted_0_get_arg_25998 * res_26024;\n                    float bondprice_arg_26026 = start_26008 + y_26025;\n                    float y_26027 = bondprice_arg_26026 - res_25869;\n                    float negate_arg_26028 = a_25426 * y_26027;\n                    float exp_arg_26029 = 0.0F - negate_arg_26028;\n                    float res_26030 = fpow32(2.7182817F, exp_arg_26029);\n                    float x_26031 = 1.0F - res_26030;\n                    float B_26032 = x_26031 / a_25426;\n                    float x_26033 = B_26032 - bondprice_arg_26026;\n                    float x_26034 = res_25869 + x_26033;\n                    float x_26035 = fpow32(a_25426, 2.0F);\n                    float x_26036 = b_25427 * x_26035;\n                    float x_26037 = fpow32(sigma_25428, 2.0F);\n                    float y_26038 = x_26037 / 2.0F;\n                    float y_26039 = x_26036 - y_26038;\n                    float x_26040 = x_26034 * y_26039;\n                    float A1_26041 = x_26040 / x_26035;\n                    float y_26042 = fpow32(B_26032, 2.0F);\n                    float x_26043 = x_26037 * y_26042;\n                    float y_26044 = 4.0F * a_25426;\n                    float A2_26045 = x_26043 / y_26044;\n                    float exp_arg_26046 = A1_26041 - A2_26045;\n                    float res_26047 = fpow32(2.7182817F, exp_arg_26046);\n                    float nega",
                   "te_arg_26048 = lifted_0_get_arg_25994 * B_26032;\n                    float exp_arg_26049 = 0.0F - negate_arg_26048;\n                    float res_26050 = fpow32(2.7182817F, exp_arg_26049);\n                    float res_26051 = res_26047 * res_26050;\n                    float res_26052 = res_26023 * res_26051;\n                    \n                    res_26006 = res_26052;\n                }\n                // write to-scan values to parameters\n                {\n                    x_25975 = x_25983;\n                    x_25976 = res_26006;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27474, res_25889)) {\n                    x_25975 = 0;\n                    x_25976 = 0.0F;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_25977 = x_25973 || x_25975;\n                float res_25978;\n                \n                if (x_25975) {\n                    res_25978 = x_25976;\n                } else {\n                    float res_25979 = x_25974 + x_25976;\n                    \n                    res_25978 = res_25979;\n                }\n                ((__local\n                  bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)] =\n                    res_25977;\n                ((__local\n                  float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)] =\n                    res_25978;\n            }\n            \n          error_0:\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_failure)\n                return;\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_29728;\n            float x_29729;\n            bool x_29730;\n            float x_29731;\n            bool x_29735;\n          ",
                   "  float x_29736;\n            bool x_29737;\n            float x_29738;\n            bool ltid_in_bounds_29742;\n            \n            ltid_in_bounds_29742 = slt64(sext_i32_i64(local_tid_29717),\n                                         segscan_group_sizze_27470);\n            \n            int32_t skip_threads_29743;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_29742) {\n                    x_29730 = ((volatile __local\n                                bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)];\n                    x_29731 = ((volatile __local\n                                float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)];\n                    if ((local_tid_29717 - squot32(local_tid_29717, 32) * 32) ==\n                        0) {\n                        x_29728 = x_29730;\n                        x_29729 = x_29731;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29743 = 1;\n                while (slt32(skip_threads_29743, 32)) {\n                    if (sle32(skip_threads_29743, local_tid_29717 -\n                              squot32(local_tid_29717, 32) * 32) &&\n                        ltid_in_bounds_29742) {\n                        // read operands\n                        {\n                            x_29728 = ((volatile __local\n                                        bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717) -\n                                                                    sext_i32_i64(skip_threads_29743)];\n                            x_29729 = ((volatile __local\n                                        float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717) -\n                                                                     sext_i32_i64(skip_threads_29743)];\n                        }\n                        // perform operation\n                      ",
                   "  {\n                            bool res_29732 = x_29728 || x_29730;\n                            float res_29733;\n                            \n                            if (x_29730) {\n                                res_29733 = x_29731;\n                            } else {\n                                float res_29734 = x_29729 + x_29731;\n                                \n                                res_29733 = res_29734;\n                            }\n                            x_29728 = res_29732;\n                            x_29729 = res_29733;\n                        }\n                    }\n                    if (sle32(wave_sizze_29719, skip_threads_29743)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29743, local_tid_29717 -\n                              squot32(local_tid_29717, 32) * 32) &&\n                        ltid_in_bounds_29742) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)] =\n                                x_29728;\n                            x_29730 = x_29728;\n                            ((volatile __local\n                              float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)] =\n                                x_29729;\n                            x_29731 = x_29729;\n                        }\n                    }\n                    if (sle32(wave_sizze_29719, skip_threads_29743)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29743 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_29717 - squot32(local_tid_29717, 32) * 32) ==\n                    31 && ltid_in_bounds_29742) {\n              ",
                   "      ((volatile __local\n                      bool *) scan_arr_mem_29721)[sext_i32_i64(squot32(local_tid_29717,\n                                                                       32))] =\n                        x_29728;\n                    ((volatile __local\n                      float *) scan_arr_mem_29723)[sext_i32_i64(squot32(local_tid_29717,\n                                                                        32))] =\n                        x_29729;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_29744;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_29717, 32) == 0 &&\n                        ltid_in_bounds_29742) {\n                        x_29737 = ((volatile __local\n                                    bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)];\n                        x_29738 = ((volatile __local\n                                    float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)];\n                        if ((local_tid_29717 - squot32(local_tid_29717, 32) *\n                             32) == 0) {\n                            x_29735 = x_29737;\n                            x_29736 = x_29738;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29744 = 1;\n                    while (slt32(skip_threads_29744, 32)) {\n                        if (sle32(skip_threads_29744, local_tid_29717 -\n                                  squot32(local_tid_29717, 32) * 32) &&\n                            (squot32(local_tid_29717, 32) == 0 &&\n                             ltid_in_bounds_29742)) {\n                            // read operands\n                            {\n             ",
                   "                   x_29735 = ((volatile __local\n                                            bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717) -\n                                                                        sext_i32_i64(skip_threads_29744)];\n                                x_29736 = ((volatile __local\n                                            float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717) -\n                                                                         sext_i32_i64(skip_threads_29744)];\n                            }\n                            // perform operation\n                            {\n                                bool res_29739 = x_29735 || x_29737;\n                                float res_29740;\n                                \n                                if (x_29737) {\n                                    res_29740 = x_29738;\n                                } else {\n                                    float res_29741 = x_29736 + x_29738;\n                                    \n                                    res_29740 = res_29741;\n                                }\n                                x_29735 = res_29739;\n                                x_29736 = res_29740;\n                            }\n                        }\n                        if (sle32(wave_sizze_29719, skip_threads_29744)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29744, local_tid_29717 -\n                                  squot32(local_tid_29717, 32) * 32) &&\n                            (squot32(local_tid_29717, 32) == 0 &&\n                             ltid_in_bounds_29742)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)] =\n                                    x_29735;\n         ",
                   "                       x_29737 = x_29735;\n                                ((volatile __local\n                                  float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)] =\n                                    x_29736;\n                                x_29738 = x_29736;\n                            }\n                        }\n                        if (sle32(wave_sizze_29719, skip_threads_29744)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29744 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_29717, 32) == 0 ||\n                      !ltid_in_bounds_29742)) {\n                    // read operands\n                    {\n                        x_29730 = x_29728;\n                        x_29731 = x_29729;\n                        x_29728 = ((__local\n                                    bool *) scan_arr_mem_29721)[sext_i32_i64(squot32(local_tid_29717,\n                                                                                     32)) -\n                                                                1];\n                        x_29729 = ((__local\n                                    float *) scan_arr_mem_29723)[sext_i32_i64(squot32(local_tid_29717,\n                                                                                      32)) -\n                                                                 1];\n                    }\n                    // perform operation\n                    {\n                        bool res_29732 = x_29728 || x_29730;\n                        float res_29733;\n                        \n                        if (x_29730) {\n                            res_29733 = x_29731;\n                        } else {\n                            float res_29734 = x_29729 + x_29731;\n                   ",
                   "         \n                            res_29733 = res_29734;\n                        }\n                        x_29728 = res_29732;\n                        x_29729 = res_29733;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)] =\n                            x_29728;\n                        ((__local\n                          float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)] =\n                            x_29729;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_29717, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)] =\n                        x_29730;\n                    ((__local\n                      float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)] =\n                        x_29731;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_27474, res_25889)) {\n                    ((__global bool *) mem_28996)[gtid_27474] = ((__local\n                                                                  bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)];\n                    ((__global float *) mem_28998)[gtid_27474] = ((__local\n                                                                   float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_29745 = 0;\n                bool should_load_carry_29746 = local_tid_29717 == 0 &&\n                   ",
                   "  !crosses_segment_29745;\n                \n                if (should_load_carry_29746) {\n                    x_25973 = ((__local\n                                bool *) scan_arr_mem_29721)[segscan_group_sizze_27470 -\n                                                            1];\n                    x_25974 = ((__local\n                                float *) scan_arr_mem_29723)[segscan_group_sizze_27470 -\n                                                             1];\n                }\n                if (!should_load_carry_29746) {\n                    x_25973 = 0;\n                    x_25974 = 0.0F;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27470\n}\n__kernel void mainziscan_stage1_27527(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29788_backing_aligned_0,\n                                      int64_t res_25889, __global\n                                      unsigned char *mem_28993, __global\n                                      unsigned char *mem_29001,\n                                      int32_t num_threads_29782)\n{\n    #define segscan_group_sizze_27522 (mainzisegscan_group_sizze_27521)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29788_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29788_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29783;\n    int32_t local_tid_29784;\n    int64_t group_sizze_29787;\n    int32_t wave_sizze_29786;\n    int32_t group_tid_29785;\n    \n    global_tid_29783 = get_global_id(0);\n    local_tid_29784 = get_local_id(0);\n    group_sizze_29787 = get_local_size(0);\n    wave_sizze_29786 = LOCKSTEP_WIDTH;\n    group_tid_29785 = get_group",
                   "_id(0);\n    \n    int32_t phys_tid_27527;\n    \n    phys_tid_27527 = global_tid_29783;\n    \n    __local char *scan_arr_mem_29788;\n    \n    scan_arr_mem_29788 = (__local char *) scan_arr_mem_29788_backing_0;\n    \n    int64_t x_26076;\n    int64_t x_26077;\n    \n    x_26076 = 0;\n    for (int64_t j_29790 = 0; j_29790 < sdiv_up64(res_25889,\n                                                  sext_i32_i64(num_threads_29782));\n         j_29790++) {\n        int64_t chunk_offset_29791 = segscan_group_sizze_27522 * j_29790 +\n                sext_i32_i64(group_tid_29785) * (segscan_group_sizze_27522 *\n                                                 sdiv_up64(res_25889,\n                                                           sext_i32_i64(num_threads_29782)));\n        int64_t flat_idx_29792 = chunk_offset_29791 +\n                sext_i32_i64(local_tid_29784);\n        int64_t gtid_27526 = flat_idx_29792;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_27526, res_25889)) {\n                int64_t i_p_o_28817 = add64(1, gtid_27526);\n                int64_t rot_i_28818 = smod64(i_p_o_28817, res_25889);\n                bool x_26079 = ((__global bool *) mem_28993)[rot_i_28818];\n                int64_t res_26080 = btoi_bool_i64(x_26079);\n                \n                // write to-scan values to parameters\n                {\n                    x_26077 = res_26080;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_27526, res_25889)) {\n                    x_26077 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_26078 = add64(x_26076, x_26077);\n                \n                ((__local\n                  int64_",
                   "t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)] =\n                    res_26078;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_29793;\n            int64_t x_29794;\n            int64_t x_29796;\n            int64_t x_29797;\n            bool ltid_in_bounds_29799;\n            \n            ltid_in_bounds_29799 = slt64(sext_i32_i64(local_tid_29784),\n                                         segscan_group_sizze_27522);\n            \n            int32_t skip_threads_29800;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_29799) {\n                    x_29794 = ((volatile __local\n                                int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)];\n                    if ((local_tid_29784 - squot32(local_tid_29784, 32) * 32) ==\n                        0) {\n                        x_29793 = x_29794;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29800 = 1;\n                while (slt32(skip_threads_29800, 32)) {\n                    if (sle32(skip_threads_29800, local_tid_29784 -\n                              squot32(local_tid_29784, 32) * 32) &&\n                        ltid_in_bounds_29799) {\n                        // read operands\n                        {\n                            x_29793 = ((volatile __local\n                                        int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784) -\n                                                                       sext_i32_i64(skip_threads_29800)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_29795 = add64(x_29793, x_29794);\n                            \n                            x_29793 = res_29795;\n                        }\n                    }\n                    if (sle32(w",
                   "ave_sizze_29786, skip_threads_29800)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29800, local_tid_29784 -\n                              squot32(local_tid_29784, 32) * 32) &&\n                        ltid_in_bounds_29799) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)] =\n                                x_29793;\n                            x_29794 = x_29793;\n                        }\n                    }\n                    if (sle32(wave_sizze_29786, skip_threads_29800)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29800 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_29784 - squot32(local_tid_29784, 32) * 32) ==\n                    31 && ltid_in_bounds_29799) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29788)[sext_i32_i64(squot32(local_tid_29784,\n                                                                          32))] =\n                        x_29793;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_29801;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_29784, 32) == 0 &&\n                        ltid_in_bounds_29799) {\n                        x_29797 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)];\n                        if ((local_tid_29784 - squot32(local_ti",
                   "d_29784, 32) *\n                             32) == 0) {\n                            x_29796 = x_29797;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29801 = 1;\n                    while (slt32(skip_threads_29801, 32)) {\n                        if (sle32(skip_threads_29801, local_tid_29784 -\n                                  squot32(local_tid_29784, 32) * 32) &&\n                            (squot32(local_tid_29784, 32) == 0 &&\n                             ltid_in_bounds_29799)) {\n                            // read operands\n                            {\n                                x_29796 = ((volatile __local\n                                            int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784) -\n                                                                           sext_i32_i64(skip_threads_29801)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_29798 = add64(x_29796, x_29797);\n                                \n                                x_29796 = res_29798;\n                            }\n                        }\n                        if (sle32(wave_sizze_29786, skip_threads_29801)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29801, local_tid_29784 -\n                                  squot32(local_tid_29784, 32) * 32) &&\n                            (squot32(local_tid_29784, 32) == 0 &&\n                             ltid_in_bounds_29799)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)] =\n                                    x_29796;\n         ",
                   "                       x_29797 = x_29796;\n                            }\n                        }\n                        if (sle32(wave_sizze_29786, skip_threads_29801)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29801 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_29784, 32) == 0 ||\n                      !ltid_in_bounds_29799)) {\n                    // read operands\n                    {\n                        x_29794 = x_29793;\n                        x_29793 = ((__local\n                                    int64_t *) scan_arr_mem_29788)[sext_i32_i64(squot32(local_tid_29784,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_29795 = add64(x_29793, x_29794);\n                        \n                        x_29793 = res_29795;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)] =\n                            x_29793;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_29784, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)] =\n                        x_29794;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n               ",
                   " if (slt64(gtid_27526, res_25889)) {\n                    ((__global int64_t *) mem_29001)[gtid_27526] = ((__local\n                                                                     int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_29802 = 0;\n                bool should_load_carry_29803 = local_tid_29784 == 0 &&\n                     !crosses_segment_29802;\n                \n                if (should_load_carry_29803) {\n                    x_26076 = ((__local\n                                int64_t *) scan_arr_mem_29788)[segscan_group_sizze_27522 -\n                                                               1];\n                }\n                if (!should_load_carry_29803) {\n                    x_26076 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_27522\n}\n__kernel void mainziscan_stage2_27426(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29371_backing_aligned_0,\n                                      int64_t flat_dim_25607, __global\n                                      unsigned char *mem_28973,\n                                      int64_t stage1_num_groups_29343,\n                                      int32_t num_threads_29344)\n{\n    #define segscan_group_sizze_27421 (mainzisegscan_group_sizze_27420)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29371_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29371_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global",
                   "_tid_29366;\n    int32_t local_tid_29367;\n    int64_t group_sizze_29370;\n    int32_t wave_sizze_29369;\n    int32_t group_tid_29368;\n    \n    global_tid_29366 = get_global_id(0);\n    local_tid_29367 = get_local_id(0);\n    group_sizze_29370 = get_local_size(0);\n    wave_sizze_29369 = LOCKSTEP_WIDTH;\n    group_tid_29368 = get_group_id(0);\n    \n    int32_t phys_tid_27426;\n    \n    phys_tid_27426 = global_tid_29366;\n    \n    __local char *scan_arr_mem_29371;\n    \n    scan_arr_mem_29371 = (__local char *) scan_arr_mem_29371_backing_0;\n    \n    int64_t flat_idx_29373;\n    \n    flat_idx_29373 = (sext_i32_i64(local_tid_29367) + 1) *\n        (segscan_group_sizze_27421 * sdiv_up64(flat_dim_25607,\n                                               sext_i32_i64(num_threads_29344))) -\n        1;\n    \n    int64_t gtid_27425;\n    \n    gtid_27425 = flat_idx_29373;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27425, flat_dim_25607)) {\n            ((__local\n              int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)] =\n                ((__global int64_t *) mem_28973)[gtid_27425];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_25875;\n    int64_t x_25876;\n    int64_t x_29374;\n    int64_t x_29375;\n    bool ltid_in_bounds_29377;\n    \n    ltid_in_bounds_29377 = slt64(sext_i32_i64(local_tid_29367),\n                                 stage1_num_groups_29343);\n    \n    int32_t skip_threads_29378;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29377) {\n            x_25876 = ((volatile __local\n                        int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)];\n            if ((local_tid_29367 - squot32(local_tid_29367, 32) * 32) == 0) {\n                x_25875 = x_25876;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n  ",
                   "  {\n        skip_threads_29378 = 1;\n        while (slt32(skip_threads_29378, 32)) {\n            if (sle32(skip_threads_29378, local_tid_29367 -\n                      squot32(local_tid_29367, 32) * 32) &&\n                ltid_in_bounds_29377) {\n                // read operands\n                {\n                    x_25875 = ((volatile __local\n                                int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367) -\n                                                               sext_i32_i64(skip_threads_29378)];\n                }\n                // perform operation\n                {\n                    int64_t res_25877 = add64(x_25875, x_25876);\n                    \n                    x_25875 = res_25877;\n                }\n            }\n            if (sle32(wave_sizze_29369, skip_threads_29378)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29378, local_tid_29367 -\n                      squot32(local_tid_29367, 32) * 32) &&\n                ltid_in_bounds_29377) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)] =\n                        x_25875;\n                    x_25876 = x_25875;\n                }\n            }\n            if (sle32(wave_sizze_29369, skip_threads_29378)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_29378 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_29367 - squot32(local_tid_29367, 32) * 32) == 31 &&\n            ltid_in_bounds_29377) {\n            ((volatile __local\n              int64_t *) scan_arr_mem_29371)[sext_i32_i64(squot32(local_tid_29367,\n                                                                  32))] =\n                x_25875;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the",
                   " first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29379;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_29367, 32) == 0 && ltid_in_bounds_29377) {\n                x_29375 = ((volatile __local\n                            int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)];\n                if ((local_tid_29367 - squot32(local_tid_29367, 32) * 32) ==\n                    0) {\n                    x_29374 = x_29375;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29379 = 1;\n            while (slt32(skip_threads_29379, 32)) {\n                if (sle32(skip_threads_29379, local_tid_29367 -\n                          squot32(local_tid_29367, 32) * 32) &&\n                    (squot32(local_tid_29367, 32) == 0 &&\n                     ltid_in_bounds_29377)) {\n                    // read operands\n                    {\n                        x_29374 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367) -\n                                                                   sext_i32_i64(skip_threads_29379)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_29376 = add64(x_29374, x_29375);\n                        \n                        x_29374 = res_29376;\n                    }\n                }\n                if (sle32(wave_sizze_29369, skip_threads_29379)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29379, local_tid_29367 -\n                          squot32(local_tid_29367, 32) * 32) &&\n                    (squot32(local_tid_29367, 32) == 0 &&\n                     ltid_in_bounds_29377)) {\n                    // write result\n                    {\n                        ((volatile __local\n ",
                   "                         int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)] =\n                            x_29374;\n                        x_29375 = x_29374;\n                    }\n                }\n                if (sle32(wave_sizze_29369, skip_threads_29379)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29379 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_29367, 32) == 0 || !ltid_in_bounds_29377)) {\n            // read operands\n            {\n                x_25876 = x_25875;\n                x_25875 = ((__local\n                            int64_t *) scan_arr_mem_29371)[sext_i32_i64(squot32(local_tid_29367,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_25877 = add64(x_25875, x_25876);\n                \n                x_25875 = res_25877;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)] =\n                    x_25875;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_29367, 32) == 0) {\n            ((__local\n              int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)] =\n                x_25876;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_27425, flat_dim_25607)) {\n            ((__global int64_t *) mem_28973)[gtid_27425] = ((__local\n                                                             int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)];\n        }\n    }\n    \n  error_0:\n    return;\n    ",
                   "#undef segscan_group_sizze_27421\n}\n__kernel void mainziscan_stage2_27459(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29620_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29618_backing_aligned_1,\n                                      int64_t res_25889, __global\n                                      unsigned char *mem_28984, __global\n                                      unsigned char *mem_28986,\n                                      int64_t stage1_num_groups_29580,\n                                      int32_t num_threads_29581)\n{\n    #define segscan_group_sizze_27454 (mainzisegscan_group_sizze_27453)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29620_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_29620_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29618_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29618_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29613;\n    int32_t local_tid_29614;\n    int64_t group_sizze_29617;\n    int32_t wave_sizze_29616;\n    int32_t group_tid_29615;\n    \n    global_tid_29613 = get_global_id(0);\n    local_tid_29614 = get_local_id(0);\n    group_sizze_29617 = get_local_size(0);\n    wave_sizze_29616 = LOCKSTEP_WIDTH;\n    group_tid_29615 = get_group_id(0);\n    \n    int32_t phys_tid_27459;\n    \n    phys_tid_27459 = global_tid_29613;\n    \n    __local char *scan_arr_mem_29618;\n    __local char *scan_arr_mem_29620;\n    \n    scan_arr_mem_29618 = (__local char *) scan_arr_mem_29618_backing_0;\n    scan_arr_mem_29620 = (__local char *) scan_arr_mem_29620_backing_1;\n    \n    int64_t flat_i",
                   "dx_29622;\n    \n    flat_idx_29622 = (sext_i32_i64(local_tid_29614) + 1) *\n        (segscan_group_sizze_27454 * sdiv_up64(res_25889,\n                                               sext_i32_i64(num_threads_29581))) -\n        1;\n    \n    int64_t gtid_27458;\n    \n    gtid_27458 = flat_idx_29622;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27458, res_25889)) {\n            ((__local\n              bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)] =\n                ((__global bool *) mem_28984)[gtid_27458];\n            ((__local\n              int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)] =\n                ((__global int64_t *) mem_28986)[gtid_27458];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_25908;\n    int64_t x_25909;\n    bool x_25910;\n    int64_t x_25911;\n    bool x_29623;\n    int64_t x_29624;\n    bool x_29625;\n    int64_t x_29626;\n    bool ltid_in_bounds_29630;\n    \n    ltid_in_bounds_29630 = slt64(sext_i32_i64(local_tid_29614),\n                                 stage1_num_groups_29580);\n    \n    int32_t skip_threads_29631;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29630) {\n            x_25910 = ((volatile __local\n                        bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)];\n            x_25911 = ((volatile __local\n                        int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)];\n            if ((local_tid_29614 - squot32(local_tid_29614, 32) * 32) == 0) {\n                x_25908 = x_25910;\n                x_25909 = x_25911;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_29631 = 1;\n        while (slt32(skip_threads_29631, 32",
                   ")) {\n            if (sle32(skip_threads_29631, local_tid_29614 -\n                      squot32(local_tid_29614, 32) * 32) &&\n                ltid_in_bounds_29630) {\n                // read operands\n                {\n                    x_25908 = ((volatile __local\n                                bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614) -\n                                                            sext_i32_i64(skip_threads_29631)];\n                    x_25909 = ((volatile __local\n                                int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614) -\n                                                               sext_i32_i64(skip_threads_29631)];\n                }\n                // perform operation\n                {\n                    bool res_25912 = x_25908 || x_25910;\n                    int64_t res_25913;\n                    \n                    if (x_25910) {\n                        res_25913 = x_25911;\n                    } else {\n                        int64_t res_25914 = add64(x_25909, x_25911);\n                        \n                        res_25913 = res_25914;\n                    }\n                    x_25908 = res_25912;\n                    x_25909 = res_25913;\n                }\n            }\n            if (sle32(wave_sizze_29616, skip_threads_29631)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29631, local_tid_29614 -\n                      squot32(local_tid_29614, 32) * 32) &&\n                ltid_in_bounds_29630) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)] =\n                        x_25908;\n                    x_25910 = x_25908;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)] =\n                        x_25909;\n                    x_25911 = x_25909;\n      ",
                   "          }\n            }\n            if (sle32(wave_sizze_29616, skip_threads_29631)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_29631 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_29614 - squot32(local_tid_29614, 32) * 32) == 31 &&\n            ltid_in_bounds_29630) {\n            ((volatile __local\n              bool *) scan_arr_mem_29618)[sext_i32_i64(squot32(local_tid_29614,\n                                                               32))] = x_25908;\n            ((volatile __local\n              int64_t *) scan_arr_mem_29620)[sext_i32_i64(squot32(local_tid_29614,\n                                                                  32))] =\n                x_25909;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29632;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_29614, 32) == 0 && ltid_in_bounds_29630) {\n                x_29625 = ((volatile __local\n                            bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)];\n                x_29626 = ((volatile __local\n                            int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)];\n                if ((local_tid_29614 - squot32(local_tid_29614, 32) * 32) ==\n                    0) {\n                    x_29623 = x_29625;\n                    x_29624 = x_29626;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29632 = 1;\n            while (slt32(skip_threads_29632, 32)) {\n                if (sle32(skip_threads_29632, local_tid_29614 -\n                          squot32(local_tid_29614, 32) * 32) &&\n                    (squot32(local_tid_29614, 32) == 0 &&\n                     ltid_in_bound",
                   "s_29630)) {\n                    // read operands\n                    {\n                        x_29623 = ((volatile __local\n                                    bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614) -\n                                                                sext_i32_i64(skip_threads_29632)];\n                        x_29624 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614) -\n                                                                   sext_i32_i64(skip_threads_29632)];\n                    }\n                    // perform operation\n                    {\n                        bool res_29627 = x_29623 || x_29625;\n                        int64_t res_29628;\n                        \n                        if (x_29625) {\n                            res_29628 = x_29626;\n                        } else {\n                            int64_t res_29629 = add64(x_29624, x_29626);\n                            \n                            res_29628 = res_29629;\n                        }\n                        x_29623 = res_29627;\n                        x_29624 = res_29628;\n                    }\n                }\n                if (sle32(wave_sizze_29616, skip_threads_29632)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29632, local_tid_29614 -\n                          squot32(local_tid_29614, 32) * 32) &&\n                    (squot32(local_tid_29614, 32) == 0 &&\n                     ltid_in_bounds_29630)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)] =\n                            x_29623;\n                        x_29625 = x_29623;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)] =\n               ",
                   "             x_29624;\n                        x_29626 = x_29624;\n                    }\n                }\n                if (sle32(wave_sizze_29616, skip_threads_29632)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29632 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_29614, 32) == 0 || !ltid_in_bounds_29630)) {\n            // read operands\n            {\n                x_25910 = x_25908;\n                x_25911 = x_25909;\n                x_25908 = ((__local\n                            bool *) scan_arr_mem_29618)[sext_i32_i64(squot32(local_tid_29614,\n                                                                             32)) -\n                                                        1];\n                x_25909 = ((__local\n                            int64_t *) scan_arr_mem_29620)[sext_i32_i64(squot32(local_tid_29614,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_25912 = x_25908 || x_25910;\n                int64_t res_25913;\n                \n                if (x_25910) {\n                    res_25913 = x_25911;\n                } else {\n                    int64_t res_25914 = add64(x_25909, x_25911);\n                    \n                    res_25913 = res_25914;\n                }\n                x_25908 = res_25912;\n                x_25909 = res_25913;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)] =\n                    x_25908;\n                ((__local\n                  int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)] =\n                    x_25909;\n            }\n        }\n    }\n    ba",
                   "rrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_29614, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)] =\n                x_25910;\n            ((__local\n              int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)] =\n                x_25911;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_27458, res_25889)) {\n            ((__global bool *) mem_28984)[gtid_27458] = ((__local\n                                                          bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)];\n            ((__global int64_t *) mem_28986)[gtid_27458] = ((__local\n                                                             int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27454\n}\n__kernel void mainziscan_stage2_27467(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29687_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29685_backing_aligned_1,\n                                      int64_t res_25889, __global\n                                      unsigned char *mem_28989, __global\n                                      unsigned char *mem_28991,\n                                      int64_t stage1_num_groups_29647,\n                                      int32_t num_threads_29648)\n{\n    #define segscan_group_sizze_27462 (mainzisegscan_group_sizze_27461)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29687_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_29",
                   "687_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29685_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29685_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29680;\n    int32_t local_tid_29681;\n    int64_t group_sizze_29684;\n    int32_t wave_sizze_29683;\n    int32_t group_tid_29682;\n    \n    global_tid_29680 = get_global_id(0);\n    local_tid_29681 = get_local_id(0);\n    group_sizze_29684 = get_local_size(0);\n    wave_sizze_29683 = LOCKSTEP_WIDTH;\n    group_tid_29682 = get_group_id(0);\n    \n    int32_t phys_tid_27467;\n    \n    phys_tid_27467 = global_tid_29680;\n    \n    __local char *scan_arr_mem_29685;\n    __local char *scan_arr_mem_29687;\n    \n    scan_arr_mem_29685 = (__local char *) scan_arr_mem_29685_backing_0;\n    scan_arr_mem_29687 = (__local char *) scan_arr_mem_29687_backing_1;\n    \n    int64_t flat_idx_29689;\n    \n    flat_idx_29689 = (sext_i32_i64(local_tid_29681) + 1) *\n        (segscan_group_sizze_27462 * sdiv_up64(res_25889,\n                                               sext_i32_i64(num_threads_29648))) -\n        1;\n    \n    int64_t gtid_27466;\n    \n    gtid_27466 = flat_idx_29689;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27466, res_25889)) {\n            ((__local\n              bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)] =\n                ((__global bool *) mem_28989)[gtid_27466];\n            ((__local\n              int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)] =\n                ((__global int64_t *) mem_28991)[gtid_27466];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_25947;\n    int64_t x_25948;\n    bool x_2",
                   "5949;\n    int64_t x_25950;\n    bool x_29690;\n    int64_t x_29691;\n    bool x_29692;\n    int64_t x_29693;\n    bool ltid_in_bounds_29697;\n    \n    ltid_in_bounds_29697 = slt64(sext_i32_i64(local_tid_29681),\n                                 stage1_num_groups_29647);\n    \n    int32_t skip_threads_29698;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29697) {\n            x_25949 = ((volatile __local\n                        bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)];\n            x_25950 = ((volatile __local\n                        int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)];\n            if ((local_tid_29681 - squot32(local_tid_29681, 32) * 32) == 0) {\n                x_25947 = x_25949;\n                x_25948 = x_25950;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_29698 = 1;\n        while (slt32(skip_threads_29698, 32)) {\n            if (sle32(skip_threads_29698, local_tid_29681 -\n                      squot32(local_tid_29681, 32) * 32) &&\n                ltid_in_bounds_29697) {\n                // read operands\n                {\n                    x_25947 = ((volatile __local\n                                bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681) -\n                                                            sext_i32_i64(skip_threads_29698)];\n                    x_25948 = ((volatile __local\n                                int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681) -\n                                                               sext_i32_i64(skip_threads_29698)];\n                }\n                // perform operation\n                {\n                    bool res_25951 = x_25947 || x_25949;\n                    int64_t res_25952;\n                    \n                    if (x_25949) {\n                        res_25952 = x_25950;\n                    } else {\n                        int64_t res_25953 = add64(x_25948, ",
                   "x_25950);\n                        \n                        res_25952 = res_25953;\n                    }\n                    x_25947 = res_25951;\n                    x_25948 = res_25952;\n                }\n            }\n            if (sle32(wave_sizze_29683, skip_threads_29698)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29698, local_tid_29681 -\n                      squot32(local_tid_29681, 32) * 32) &&\n                ltid_in_bounds_29697) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)] =\n                        x_25947;\n                    x_25949 = x_25947;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)] =\n                        x_25948;\n                    x_25950 = x_25948;\n                }\n            }\n            if (sle32(wave_sizze_29683, skip_threads_29698)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_29698 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_29681 - squot32(local_tid_29681, 32) * 32) == 31 &&\n            ltid_in_bounds_29697) {\n            ((volatile __local\n              bool *) scan_arr_mem_29685)[sext_i32_i64(squot32(local_tid_29681,\n                                                               32))] = x_25947;\n            ((volatile __local\n              int64_t *) scan_arr_mem_29687)[sext_i32_i64(squot32(local_tid_29681,\n                                                                  32))] =\n                x_25948;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29699;\n        \n        // read input for in-block scan\n    ",
                   "    {\n            if (squot32(local_tid_29681, 32) == 0 && ltid_in_bounds_29697) {\n                x_29692 = ((volatile __local\n                            bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)];\n                x_29693 = ((volatile __local\n                            int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)];\n                if ((local_tid_29681 - squot32(local_tid_29681, 32) * 32) ==\n                    0) {\n                    x_29690 = x_29692;\n                    x_29691 = x_29693;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29699 = 1;\n            while (slt32(skip_threads_29699, 32)) {\n                if (sle32(skip_threads_29699, local_tid_29681 -\n                          squot32(local_tid_29681, 32) * 32) &&\n                    (squot32(local_tid_29681, 32) == 0 &&\n                     ltid_in_bounds_29697)) {\n                    // read operands\n                    {\n                        x_29690 = ((volatile __local\n                                    bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681) -\n                                                                sext_i32_i64(skip_threads_29699)];\n                        x_29691 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681) -\n                                                                   sext_i32_i64(skip_threads_29699)];\n                    }\n                    // perform operation\n                    {\n                        bool res_29694 = x_29690 || x_29692;\n                        int64_t res_29695;\n                        \n                        if (x_29692) {\n                            res_29695 = x_29693;\n                        } else {\n                            int64_t res_29696 = add64(x_29691, x_29693);\n                            \n                            res_29695 = re",
                   "s_29696;\n                        }\n                        x_29690 = res_29694;\n                        x_29691 = res_29695;\n                    }\n                }\n                if (sle32(wave_sizze_29683, skip_threads_29699)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29699, local_tid_29681 -\n                          squot32(local_tid_29681, 32) * 32) &&\n                    (squot32(local_tid_29681, 32) == 0 &&\n                     ltid_in_bounds_29697)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)] =\n                            x_29690;\n                        x_29692 = x_29690;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)] =\n                            x_29691;\n                        x_29693 = x_29691;\n                    }\n                }\n                if (sle32(wave_sizze_29683, skip_threads_29699)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29699 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_29681, 32) == 0 || !ltid_in_bounds_29697)) {\n            // read operands\n            {\n                x_25949 = x_25947;\n                x_25950 = x_25948;\n                x_25947 = ((__local\n                            bool *) scan_arr_mem_29685)[sext_i32_i64(squot32(local_tid_29681,\n                                                                             32)) -\n                                                        1];\n                x_25948 = ((__local\n                            int64_t *) scan_arr_mem_29687)[sext_i32_i64(squot32(local_tid_29681,\n                                                       ",
                   "                         32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_25951 = x_25947 || x_25949;\n                int64_t res_25952;\n                \n                if (x_25949) {\n                    res_25952 = x_25950;\n                } else {\n                    int64_t res_25953 = add64(x_25948, x_25950);\n                    \n                    res_25952 = res_25953;\n                }\n                x_25947 = res_25951;\n                x_25948 = res_25952;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)] =\n                    x_25947;\n                ((__local\n                  int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)] =\n                    x_25948;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_29681, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)] =\n                x_25949;\n            ((__local\n              int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)] =\n                x_25950;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_27466, res_25889)) {\n            ((__global bool *) mem_28989)[gtid_27466] = ((__local\n                                                          bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)];\n            ((__global int64_t *) mem_28991)[gtid_27466] = ((__local\n                                                             int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27462\n}\n__kernel void mainziscan_stage2_27475(__global int *global_failure,\n ",
                   "                                     __local volatile\n                                      int64_t *scan_arr_mem_29754_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29752_backing_aligned_1,\n                                      int64_t res_25889, __global\n                                      unsigned char *mem_28996, __global\n                                      unsigned char *mem_28998,\n                                      int64_t stage1_num_groups_29714,\n                                      int32_t num_threads_29715)\n{\n    #define segscan_group_sizze_27470 (mainzisegscan_group_sizze_27469)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29754_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_29754_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29752_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29752_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29747;\n    int32_t local_tid_29748;\n    int64_t group_sizze_29751;\n    int32_t wave_sizze_29750;\n    int32_t group_tid_29749;\n    \n    global_tid_29747 = get_global_id(0);\n    local_tid_29748 = get_local_id(0);\n    group_sizze_29751 = get_local_size(0);\n    wave_sizze_29750 = LOCKSTEP_WIDTH;\n    group_tid_29749 = get_group_id(0);\n    \n    int32_t phys_tid_27475;\n    \n    phys_tid_27475 = global_tid_29747;\n    \n    __local char *scan_arr_mem_29752;\n    __local char *scan_arr_mem_29754;\n    \n    scan_arr_mem_29752 = (__local char *) scan_arr_mem_29752_backing_0;\n    scan_arr_mem_29754 = (__local char *) scan_arr_mem_29754_backing_1;\n    \n    int64_t flat_idx_29756;\n    \n    flat_idx_29756 = (sext_i32_i64(local_tid_29748) + 1) *\n        (segscan_group_sizze_2",
                   "7470 * sdiv_up64(res_25889,\n                                               sext_i32_i64(num_threads_29715))) -\n        1;\n    \n    int64_t gtid_27474;\n    \n    gtid_27474 = flat_idx_29756;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27474, res_25889)) {\n            ((__local\n              bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)] =\n                ((__global bool *) mem_28996)[gtid_27474];\n            ((__local\n              float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)] =\n                ((__global float *) mem_28998)[gtid_27474];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)] = 0;\n            ((__local\n              float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)] =\n                0.0F;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_25973;\n    float x_25974;\n    bool x_25975;\n    float x_25976;\n    bool x_29757;\n    float x_29758;\n    bool x_29759;\n    float x_29760;\n    bool ltid_in_bounds_29764;\n    \n    ltid_in_bounds_29764 = slt64(sext_i32_i64(local_tid_29748),\n                                 stage1_num_groups_29714);\n    \n    int32_t skip_threads_29765;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29764) {\n            x_25975 = ((volatile __local\n                        bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)];\n            x_25976 = ((volatile __local\n                        float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)];\n            if ((local_tid_29748 - squot32(local_tid_29748, 32) * 32) == 0) {\n                x_25973 = x_25975;\n                x_25974 = x_25976;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_29765 = 1;\n        while (slt32(skip_threads_29765, 32)) {\n            if (sle32(skip_threads_29765, local_tid_29748 -\n                      squot32(local_",
                   "tid_29748, 32) * 32) &&\n                ltid_in_bounds_29764) {\n                // read operands\n                {\n                    x_25973 = ((volatile __local\n                                bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748) -\n                                                            sext_i32_i64(skip_threads_29765)];\n                    x_25974 = ((volatile __local\n                                float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748) -\n                                                             sext_i32_i64(skip_threads_29765)];\n                }\n                // perform operation\n                {\n                    bool res_25977 = x_25973 || x_25975;\n                    float res_25978;\n                    \n                    if (x_25975) {\n                        res_25978 = x_25976;\n                    } else {\n                        float res_25979 = x_25974 + x_25976;\n                        \n                        res_25978 = res_25979;\n                    }\n                    x_25973 = res_25977;\n                    x_25974 = res_25978;\n                }\n            }\n            if (sle32(wave_sizze_29750, skip_threads_29765)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29765, local_tid_29748 -\n                      squot32(local_tid_29748, 32) * 32) &&\n                ltid_in_bounds_29764) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)] =\n                        x_25973;\n                    x_25975 = x_25973;\n                    ((volatile __local\n                      float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)] =\n                        x_25974;\n                    x_25976 = x_25974;\n                }\n            }\n            if (sle32(wave_sizze_29750, skip_threads_29765)) {\n                barrier(CLK_",
                   "LOCAL_MEM_FENCE);\n            }\n            skip_threads_29765 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_29748 - squot32(local_tid_29748, 32) * 32) == 31 &&\n            ltid_in_bounds_29764) {\n            ((volatile __local\n              bool *) scan_arr_mem_29752)[sext_i32_i64(squot32(local_tid_29748,\n                                                               32))] = x_25973;\n            ((volatile __local\n              float *) scan_arr_mem_29754)[sext_i32_i64(squot32(local_tid_29748,\n                                                                32))] = x_25974;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29766;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_29748, 32) == 0 && ltid_in_bounds_29764) {\n                x_29759 = ((volatile __local\n                            bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)];\n                x_29760 = ((volatile __local\n                            float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)];\n                if ((local_tid_29748 - squot32(local_tid_29748, 32) * 32) ==\n                    0) {\n                    x_29757 = x_29759;\n                    x_29758 = x_29760;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29766 = 1;\n            while (slt32(skip_threads_29766, 32)) {\n                if (sle32(skip_threads_29766, local_tid_29748 -\n                          squot32(local_tid_29748, 32) * 32) &&\n                    (squot32(local_tid_29748, 32) == 0 &&\n                     ltid_in_bounds_29764)) {\n                    // read operands\n                    {\n                        x_29757 = ((volatile __local\n               ",
                   "                     bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748) -\n                                                                sext_i32_i64(skip_threads_29766)];\n                        x_29758 = ((volatile __local\n                                    float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748) -\n                                                                 sext_i32_i64(skip_threads_29766)];\n                    }\n                    // perform operation\n                    {\n                        bool res_29761 = x_29757 || x_29759;\n                        float res_29762;\n                        \n                        if (x_29759) {\n                            res_29762 = x_29760;\n                        } else {\n                            float res_29763 = x_29758 + x_29760;\n                            \n                            res_29762 = res_29763;\n                        }\n                        x_29757 = res_29761;\n                        x_29758 = res_29762;\n                    }\n                }\n                if (sle32(wave_sizze_29750, skip_threads_29766)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29766, local_tid_29748 -\n                          squot32(local_tid_29748, 32) * 32) &&\n                    (squot32(local_tid_29748, 32) == 0 &&\n                     ltid_in_bounds_29764)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)] =\n                            x_29757;\n                        x_29759 = x_29757;\n                        ((volatile __local\n                          float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)] =\n                            x_29758;\n                        x_29760 = x_29758;\n                    }\n                }\n                if (sle32(wave_sizze_29750, skip_t",
                   "hreads_29766)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29766 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_29748, 32) == 0 || !ltid_in_bounds_29764)) {\n            // read operands\n            {\n                x_25975 = x_25973;\n                x_25976 = x_25974;\n                x_25973 = ((__local\n                            bool *) scan_arr_mem_29752)[sext_i32_i64(squot32(local_tid_29748,\n                                                                             32)) -\n                                                        1];\n                x_25974 = ((__local\n                            float *) scan_arr_mem_29754)[sext_i32_i64(squot32(local_tid_29748,\n                                                                              32)) -\n                                                         1];\n            }\n            // perform operation\n            {\n                bool res_25977 = x_25973 || x_25975;\n                float res_25978;\n                \n                if (x_25975) {\n                    res_25978 = x_25976;\n                } else {\n                    float res_25979 = x_25974 + x_25976;\n                    \n                    res_25978 = res_25979;\n                }\n                x_25973 = res_25977;\n                x_25974 = res_25978;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)] =\n                    x_25973;\n                ((__local\n                  float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)] =\n                    x_25974;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_29748, 32) == 0) {\n            ((__local\n              bool *) ",
                   "scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)] =\n                x_25975;\n            ((__local\n              float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)] =\n                x_25976;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_27474, res_25889)) {\n            ((__global bool *) mem_28996)[gtid_27474] = ((__local\n                                                          bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)];\n            ((__global float *) mem_28998)[gtid_27474] = ((__local\n                                                           float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27470\n}\n__kernel void mainziscan_stage2_27527(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29809_backing_aligned_0,\n                                      int64_t res_25889, __global\n                                      unsigned char *mem_29001,\n                                      int64_t stage1_num_groups_29781,\n                                      int32_t num_threads_29782)\n{\n    #define segscan_group_sizze_27522 (mainzisegscan_group_sizze_27521)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29809_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29809_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29804;\n    int32_t local_tid_29805;\n    int64_t group_sizze_29808;\n    int32_t wave_sizze_29807;\n    int32_t group_tid_29806;\n    \n    global_tid_29804 = get_global_id(0);\n    local_tid_29805 = get_local_id(0);\n    group_sizze_29808 = get_local_size(0);\n    wave_sizze_29807 = LOCKSTEP_WIDTH;",
                   "\n    group_tid_29806 = get_group_id(0);\n    \n    int32_t phys_tid_27527;\n    \n    phys_tid_27527 = global_tid_29804;\n    \n    __local char *scan_arr_mem_29809;\n    \n    scan_arr_mem_29809 = (__local char *) scan_arr_mem_29809_backing_0;\n    \n    int64_t flat_idx_29811;\n    \n    flat_idx_29811 = (sext_i32_i64(local_tid_29805) + 1) *\n        (segscan_group_sizze_27522 * sdiv_up64(res_25889,\n                                               sext_i32_i64(num_threads_29782))) -\n        1;\n    \n    int64_t gtid_27526;\n    \n    gtid_27526 = flat_idx_29811;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_27526, res_25889)) {\n            ((__local\n              int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)] =\n                ((__global int64_t *) mem_29001)[gtid_27526];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_26076;\n    int64_t x_26077;\n    int64_t x_29812;\n    int64_t x_29813;\n    bool ltid_in_bounds_29815;\n    \n    ltid_in_bounds_29815 = slt64(sext_i32_i64(local_tid_29805),\n                                 stage1_num_groups_29781);\n    \n    int32_t skip_threads_29816;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29815) {\n            x_26077 = ((volatile __local\n                        int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)];\n            if ((local_tid_29805 - squot32(local_tid_29805, 32) * 32) == 0) {\n                x_26076 = x_26077;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_29816 = 1;\n        while (slt32(skip_threads_29816, 32)) {\n            if (sle32(skip_threads_29816, local_tid_29805 -\n                      squot32(local_tid_29805, 32) * 32) &&\n                ltid_in_bounds_29815) {\n                // read operands\n                {\n            ",
                   "        x_26076 = ((volatile __local\n                                int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805) -\n                                                               sext_i32_i64(skip_threads_29816)];\n                }\n                // perform operation\n                {\n                    int64_t res_26078 = add64(x_26076, x_26077);\n                    \n                    x_26076 = res_26078;\n                }\n            }\n            if (sle32(wave_sizze_29807, skip_threads_29816)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29816, local_tid_29805 -\n                      squot32(local_tid_29805, 32) * 32) &&\n                ltid_in_bounds_29815) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)] =\n                        x_26076;\n                    x_26077 = x_26076;\n                }\n            }\n            if (sle32(wave_sizze_29807, skip_threads_29816)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_29816 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_29805 - squot32(local_tid_29805, 32) * 32) == 31 &&\n            ltid_in_bounds_29815) {\n            ((volatile __local\n              int64_t *) scan_arr_mem_29809)[sext_i32_i64(squot32(local_tid_29805,\n                                                                  32))] =\n                x_26076;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29817;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_29805, 32) == 0 && ltid_in_bounds_29815) {\n                x_29813 = ((volatile __local\n             ",
                   "               int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)];\n                if ((local_tid_29805 - squot32(local_tid_29805, 32) * 32) ==\n                    0) {\n                    x_29812 = x_29813;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29817 = 1;\n            while (slt32(skip_threads_29817, 32)) {\n                if (sle32(skip_threads_29817, local_tid_29805 -\n                          squot32(local_tid_29805, 32) * 32) &&\n                    (squot32(local_tid_29805, 32) == 0 &&\n                     ltid_in_bounds_29815)) {\n                    // read operands\n                    {\n                        x_29812 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805) -\n                                                                   sext_i32_i64(skip_threads_29817)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_29814 = add64(x_29812, x_29813);\n                        \n                        x_29812 = res_29814;\n                    }\n                }\n                if (sle32(wave_sizze_29807, skip_threads_29817)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29817, local_tid_29805 -\n                          squot32(local_tid_29805, 32) * 32) &&\n                    (squot32(local_tid_29805, 32) == 0 &&\n                     ltid_in_bounds_29815)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)] =\n                            x_29812;\n                        x_29813 = x_29812;\n                    }\n                }\n                if (sle32(wave_sizze_29807, skip_threads_29817)) {\n                    barrier(CLK",
                   "_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29817 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_29805, 32) == 0 || !ltid_in_bounds_29815)) {\n            // read operands\n            {\n                x_26077 = x_26076;\n                x_26076 = ((__local\n                            int64_t *) scan_arr_mem_29809)[sext_i32_i64(squot32(local_tid_29805,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_26078 = add64(x_26076, x_26077);\n                \n                x_26076 = res_26078;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)] =\n                    x_26076;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_29805, 32) == 0) {\n            ((__local\n              int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)] =\n                x_26077;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_27526, res_25889)) {\n            ((__global int64_t *) mem_29001)[gtid_27526] = ((__local\n                                                             int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27522\n}\n__kernel void mainziscan_stage3_27426(__global int *global_failure,\n                                      int64_t flat_dim_25607,\n                                      int64_t num_groups_27423, __global\n                                      unsigned char *mem_28973,\n          ",
                   "                            int32_t num_threads_29344,\n                                      int32_t required_groups_29380)\n{\n    #define segscan_group_sizze_27421 (mainzisegscan_group_sizze_27420)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29381;\n    int32_t local_tid_29382;\n    int64_t group_sizze_29385;\n    int32_t wave_sizze_29384;\n    int32_t group_tid_29383;\n    \n    global_tid_29381 = get_global_id(0);\n    local_tid_29382 = get_local_id(0);\n    group_sizze_29385 = get_local_size(0);\n    wave_sizze_29384 = LOCKSTEP_WIDTH;\n    group_tid_29383 = get_group_id(0);\n    \n    int32_t phys_tid_27426;\n    \n    phys_tid_27426 = global_tid_29381;\n    \n    int32_t phys_group_id_29386;\n    \n    phys_group_id_29386 = get_group_id(0);\n    for (int32_t i_29387 = 0; i_29387 < sdiv_up32(required_groups_29380 -\n                                                  phys_group_id_29386,\n                                                  sext_i64_i32(num_groups_27423));\n         i_29387++) {\n        int32_t virt_group_id_29388 = phys_group_id_29386 + i_29387 *\n                sext_i64_i32(num_groups_27423);\n        int64_t flat_idx_29389 = sext_i32_i64(virt_group_id_29388) *\n                segscan_group_sizze_27421 + sext_i32_i64(local_tid_29382);\n        int64_t gtid_27425 = flat_idx_29389;\n        int64_t orig_group_29390 = squot64(flat_idx_29389,\n                                           segscan_group_sizze_27421 *\n                                           sdiv_up64(flat_dim_25607,\n                                                     sext_i32_i64(num_threads_29344)));\n        int64_t carry_in_flat_idx_29391 = orig_group_29390 *\n                (segscan_group_sizze_27421 * sdiv_up64(flat_dim_25607,\n                                                       sext_i32_i64(num_threads_29344))) -\n                1;\n        \n        if (slt64(gtid_27425, flat_dim",
                   "_25607)) {\n            if (!(orig_group_29390 == 0 || flat_idx_29389 == (orig_group_29390 +\n                                                              1) *\n                  (segscan_group_sizze_27421 * sdiv_up64(flat_dim_25607,\n                                                         sext_i32_i64(num_threads_29344))) -\n                  1)) {\n                int64_t x_25875;\n                int64_t x_25876;\n                \n                x_25875 = ((__global\n                            int64_t *) mem_28973)[carry_in_flat_idx_29391];\n                x_25876 = ((__global int64_t *) mem_28973)[gtid_27425];\n                \n                int64_t res_25877;\n                \n                res_25877 = add64(x_25875, x_25876);\n                x_25875 = res_25877;\n                ((__global int64_t *) mem_28973)[gtid_27425] = x_25875;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27421\n}\n__kernel void mainziscan_stage3_27459(__global int *global_failure,\n                                      int64_t res_25889,\n                                      int64_t num_groups_27456, __global\n                                      unsigned char *mem_28984, __global\n                                      unsigned char *mem_28986,\n                                      int32_t num_threads_29581,\n                                      int32_t required_groups_29633)\n{\n    #define segscan_group_sizze_27454 (mainzisegscan_group_sizze_27453)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29634;\n    int32_t local_tid_29635;\n    int64_t group_sizze_29638;\n    int32_t wave_sizze_29637;\n    int32_t group_tid_29636;\n    \n    global_tid_29634 = get_global_id(0);\n    local_tid_29635 = get_local_id(0);\n    group_sizze_29638 = get_local_size(0);\n    wave_sizze_29637 = ",
                   "LOCKSTEP_WIDTH;\n    group_tid_29636 = get_group_id(0);\n    \n    int32_t phys_tid_27459;\n    \n    phys_tid_27459 = global_tid_29634;\n    \n    int32_t phys_group_id_29639;\n    \n    phys_group_id_29639 = get_group_id(0);\n    for (int32_t i_29640 = 0; i_29640 < sdiv_up32(required_groups_29633 -\n                                                  phys_group_id_29639,\n                                                  sext_i64_i32(num_groups_27456));\n         i_29640++) {\n        int32_t virt_group_id_29641 = phys_group_id_29639 + i_29640 *\n                sext_i64_i32(num_groups_27456);\n        int64_t flat_idx_29642 = sext_i32_i64(virt_group_id_29641) *\n                segscan_group_sizze_27454 + sext_i32_i64(local_tid_29635);\n        int64_t gtid_27458 = flat_idx_29642;\n        int64_t orig_group_29643 = squot64(flat_idx_29642,\n                                           segscan_group_sizze_27454 *\n                                           sdiv_up64(res_25889,\n                                                     sext_i32_i64(num_threads_29581)));\n        int64_t carry_in_flat_idx_29644 = orig_group_29643 *\n                (segscan_group_sizze_27454 * sdiv_up64(res_25889,\n                                                       sext_i32_i64(num_threads_29581))) -\n                1;\n        \n        if (slt64(gtid_27458, res_25889)) {\n            if (!(orig_group_29643 == 0 || flat_idx_29642 == (orig_group_29643 +\n                                                              1) *\n                  (segscan_group_sizze_27454 * sdiv_up64(res_25889,\n                                                         sext_i32_i64(num_threads_29581))) -\n                  1)) {\n                bool x_25908;\n                int64_t x_25909;\n                bool x_25910;\n                int64_t x_25911;\n                \n                x_25908 = ((__global\n                            bool *) mem_28984)[carry_in_flat_idx_29644];\n                x_25909 = ((__global\n                            in",
                   "t64_t *) mem_28986)[carry_in_flat_idx_29644];\n                x_25910 = ((__global bool *) mem_28984)[gtid_27458];\n                x_25911 = ((__global int64_t *) mem_28986)[gtid_27458];\n                \n                bool res_25912;\n                \n                res_25912 = x_25908 || x_25910;\n                \n                int64_t res_25913;\n                \n                if (x_25910) {\n                    res_25913 = x_25911;\n                } else {\n                    int64_t res_25914 = add64(x_25909, x_25911);\n                    \n                    res_25913 = res_25914;\n                }\n                x_25908 = res_25912;\n                x_25909 = res_25913;\n                ((__global bool *) mem_28984)[gtid_27458] = x_25908;\n                ((__global int64_t *) mem_28986)[gtid_27458] = x_25909;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27454\n}\n__kernel void mainziscan_stage3_27467(__global int *global_failure,\n                                      int64_t res_25889,\n                                      int64_t num_groups_27464, __global\n                                      unsigned char *mem_28989, __global\n                                      unsigned char *mem_28991,\n                                      int32_t num_threads_29648,\n                                      int32_t required_groups_29700)\n{\n    #define segscan_group_sizze_27462 (mainzisegscan_group_sizze_27461)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29701;\n    int32_t local_tid_29702;\n    int64_t group_sizze_29705;\n    int32_t wave_sizze_29704;\n    int32_t group_tid_29703;\n    \n    global_tid_29701 = get_global_id(0);\n    local_tid_29702 = get_local_id(0);\n    group_sizze_29705 = get_local_size(0);\n    wave_sizze_29704 = LOCKSTEP_WIDTH;\n   ",
                   " group_tid_29703 = get_group_id(0);\n    \n    int32_t phys_tid_27467;\n    \n    phys_tid_27467 = global_tid_29701;\n    \n    int32_t phys_group_id_29706;\n    \n    phys_group_id_29706 = get_group_id(0);\n    for (int32_t i_29707 = 0; i_29707 < sdiv_up32(required_groups_29700 -\n                                                  phys_group_id_29706,\n                                                  sext_i64_i32(num_groups_27464));\n         i_29707++) {\n        int32_t virt_group_id_29708 = phys_group_id_29706 + i_29707 *\n                sext_i64_i32(num_groups_27464);\n        int64_t flat_idx_29709 = sext_i32_i64(virt_group_id_29708) *\n                segscan_group_sizze_27462 + sext_i32_i64(local_tid_29702);\n        int64_t gtid_27466 = flat_idx_29709;\n        int64_t orig_group_29710 = squot64(flat_idx_29709,\n                                           segscan_group_sizze_27462 *\n                                           sdiv_up64(res_25889,\n                                                     sext_i32_i64(num_threads_29648)));\n        int64_t carry_in_flat_idx_29711 = orig_group_29710 *\n                (segscan_group_sizze_27462 * sdiv_up64(res_25889,\n                                                       sext_i32_i64(num_threads_29648))) -\n                1;\n        \n        if (slt64(gtid_27466, res_25889)) {\n            if (!(orig_group_29710 == 0 || flat_idx_29709 == (orig_group_29710 +\n                                                              1) *\n                  (segscan_group_sizze_27462 * sdiv_up64(res_25889,\n                                                         sext_i32_i64(num_threads_29648))) -\n                  1)) {\n                bool x_25947;\n                int64_t x_25948;\n                bool x_25949;\n                int64_t x_25950;\n                \n                x_25947 = ((__global\n                            bool *) mem_28989)[carry_in_flat_idx_29711];\n                x_25948 = ((__global\n                            int64_t *) mem_28991)",
                   "[carry_in_flat_idx_29711];\n                x_25949 = ((__global bool *) mem_28989)[gtid_27466];\n                x_25950 = ((__global int64_t *) mem_28991)[gtid_27466];\n                \n                bool res_25951;\n                \n                res_25951 = x_25947 || x_25949;\n                \n                int64_t res_25952;\n                \n                if (x_25949) {\n                    res_25952 = x_25950;\n                } else {\n                    int64_t res_25953 = add64(x_25948, x_25950);\n                    \n                    res_25952 = res_25953;\n                }\n                x_25947 = res_25951;\n                x_25948 = res_25952;\n                ((__global bool *) mem_28989)[gtid_27466] = x_25947;\n                ((__global int64_t *) mem_28991)[gtid_27466] = x_25948;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27462\n}\n__kernel void mainziscan_stage3_27475(__global int *global_failure,\n                                      int64_t res_25889,\n                                      int64_t num_groups_27472, __global\n                                      unsigned char *mem_28996, __global\n                                      unsigned char *mem_28998,\n                                      int32_t num_threads_29715,\n                                      int32_t required_groups_29767)\n{\n    #define segscan_group_sizze_27470 (mainzisegscan_group_sizze_27469)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29768;\n    int32_t local_tid_29769;\n    int64_t group_sizze_29772;\n    int32_t wave_sizze_29771;\n    int32_t group_tid_29770;\n    \n    global_tid_29768 = get_global_id(0);\n    local_tid_29769 = get_local_id(0);\n    group_sizze_29772 = get_local_size(0);\n    wave_sizze_29771 = LOCKSTEP_WIDTH;\n    group_tid_29770 = ",
                   "get_group_id(0);\n    \n    int32_t phys_tid_27475;\n    \n    phys_tid_27475 = global_tid_29768;\n    \n    int32_t phys_group_id_29773;\n    \n    phys_group_id_29773 = get_group_id(0);\n    for (int32_t i_29774 = 0; i_29774 < sdiv_up32(required_groups_29767 -\n                                                  phys_group_id_29773,\n                                                  sext_i64_i32(num_groups_27472));\n         i_29774++) {\n        int32_t virt_group_id_29775 = phys_group_id_29773 + i_29774 *\n                sext_i64_i32(num_groups_27472);\n        int64_t flat_idx_29776 = sext_i32_i64(virt_group_id_29775) *\n                segscan_group_sizze_27470 + sext_i32_i64(local_tid_29769);\n        int64_t gtid_27474 = flat_idx_29776;\n        int64_t orig_group_29777 = squot64(flat_idx_29776,\n                                           segscan_group_sizze_27470 *\n                                           sdiv_up64(res_25889,\n                                                     sext_i32_i64(num_threads_29715)));\n        int64_t carry_in_flat_idx_29778 = orig_group_29777 *\n                (segscan_group_sizze_27470 * sdiv_up64(res_25889,\n                                                       sext_i32_i64(num_threads_29715))) -\n                1;\n        \n        if (slt64(gtid_27474, res_25889)) {\n            if (!(orig_group_29777 == 0 || flat_idx_29776 == (orig_group_29777 +\n                                                              1) *\n                  (segscan_group_sizze_27470 * sdiv_up64(res_25889,\n                                                         sext_i32_i64(num_threads_29715))) -\n                  1)) {\n                bool x_25973;\n                float x_25974;\n                bool x_25975;\n                float x_25976;\n                \n                x_25973 = ((__global\n                            bool *) mem_28996)[carry_in_flat_idx_29778];\n                x_25974 = ((__global\n                            float *) mem_28998)[carry_in_flat_idx_29778]",
                   ";\n                x_25975 = ((__global bool *) mem_28996)[gtid_27474];\n                x_25976 = ((__global float *) mem_28998)[gtid_27474];\n                \n                bool res_25977;\n                \n                res_25977 = x_25973 || x_25975;\n                \n                float res_25978;\n                \n                if (x_25975) {\n                    res_25978 = x_25976;\n                } else {\n                    float res_25979 = x_25974 + x_25976;\n                    \n                    res_25978 = res_25979;\n                }\n                x_25973 = res_25977;\n                x_25974 = res_25978;\n                ((__global bool *) mem_28996)[gtid_27474] = x_25973;\n                ((__global float *) mem_28998)[gtid_27474] = x_25974;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27470\n}\n__kernel void mainziscan_stage3_27527(__global int *global_failure,\n                                      int64_t res_25889,\n                                      int64_t num_groups_27524, __global\n                                      unsigned char *mem_29001,\n                                      int32_t num_threads_29782,\n                                      int32_t required_groups_29818)\n{\n    #define segscan_group_sizze_27522 (mainzisegscan_group_sizze_27521)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29819;\n    int32_t local_tid_29820;\n    int64_t group_sizze_29823;\n    int32_t wave_sizze_29822;\n    int32_t group_tid_29821;\n    \n    global_tid_29819 = get_global_id(0);\n    local_tid_29820 = get_local_id(0);\n    group_sizze_29823 = get_local_size(0);\n    wave_sizze_29822 = LOCKSTEP_WIDTH;\n    group_tid_29821 = get_group_id(0);\n    \n    int32_t phys_tid_27527;\n    \n    phys_tid_27527 = global_tid_29819;\n    \n    int32_t p",
                   "hys_group_id_29824;\n    \n    phys_group_id_29824 = get_group_id(0);\n    for (int32_t i_29825 = 0; i_29825 < sdiv_up32(required_groups_29818 -\n                                                  phys_group_id_29824,\n                                                  sext_i64_i32(num_groups_27524));\n         i_29825++) {\n        int32_t virt_group_id_29826 = phys_group_id_29824 + i_29825 *\n                sext_i64_i32(num_groups_27524);\n        int64_t flat_idx_29827 = sext_i32_i64(virt_group_id_29826) *\n                segscan_group_sizze_27522 + sext_i32_i64(local_tid_29820);\n        int64_t gtid_27526 = flat_idx_29827;\n        int64_t orig_group_29828 = squot64(flat_idx_29827,\n                                           segscan_group_sizze_27522 *\n                                           sdiv_up64(res_25889,\n                                                     sext_i32_i64(num_threads_29782)));\n        int64_t carry_in_flat_idx_29829 = orig_group_29828 *\n                (segscan_group_sizze_27522 * sdiv_up64(res_25889,\n                                                       sext_i32_i64(num_threads_29782))) -\n                1;\n        \n        if (slt64(gtid_27526, res_25889)) {\n            if (!(orig_group_29828 == 0 || flat_idx_29827 == (orig_group_29828 +\n                                                              1) *\n                  (segscan_group_sizze_27522 * sdiv_up64(res_25889,\n                                                         sext_i32_i64(num_threads_29782))) -\n                  1)) {\n                int64_t x_26076;\n                int64_t x_26077;\n                \n                x_26076 = ((__global\n                            int64_t *) mem_29001)[carry_in_flat_idx_29829];\n                x_26077 = ((__global int64_t *) mem_29001)[gtid_27526];\n                \n                int64_t res_26078;\n                \n                res_26078 = add64(x_26076, x_26077);\n                x_26076 = res_26078;\n                ((__global int64_t *) mem_2",
                   "9001)[gtid_27526] = x_26076;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27522\n}\n__kernel void mainziseghist_global_27444(__global int *global_failure,\n                                         int64_t flat_dim_25607,\n                                         int64_t res_25889,\n                                         int64_t num_groups_27441, __global\n                                         unsigned char *mem_28973,\n                                         int32_t num_subhistos_29431, __global\n                                         unsigned char *res_subhistos_mem_29432,\n                                         __global\n                                         unsigned char *mainzihist_locks_mem_29502,\n                                         int32_t chk_i_29504,\n                                         int64_t hist_H_chk_29505)\n{\n    #define seghist_group_sizze_27439 (mainziseghist_group_sizze_27438)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29506;\n    int32_t local_tid_29507;\n    int64_t group_sizze_29510;\n    int32_t wave_sizze_29509;\n    int32_t group_tid_29508;\n    \n    global_tid_29506 = get_global_id(0);\n    local_tid_29507 = get_local_id(0);\n    group_sizze_29510 = get_local_size(0);\n    wave_sizze_29509 = LOCKSTEP_WIDTH;\n    group_tid_29508 = get_group_id(0);\n    \n    int32_t phys_tid_27444;\n    \n    phys_tid_27444 = global_tid_29506;\n    \n    int32_t subhisto_ind_29511;\n    \n    subhisto_ind_29511 = squot32(global_tid_29506,\n                                 sdiv_up32(sext_i64_i32(seghist_group_sizze_27439 *\n                                           num_groups_27441),\n                                           num_subhistos_29431));\n    for (int64_t i_29512 = 0; i_29512 < sdiv_up64(flat_dim_25607 -\n                      ",
                   "                            sext_i32_i64(global_tid_29506),\n                                                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_27439 *\n                                                  num_groups_27441)));\n         i_29512++) {\n        int32_t gtid_27443 = sext_i64_i32(i_29512 *\n                sext_i32_i64(sext_i64_i32(seghist_group_sizze_27439 *\n                num_groups_27441)) + sext_i32_i64(global_tid_29506));\n        \n        if (slt64(i_29512 *\n                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_27439 *\n                  num_groups_27441)) + sext_i32_i64(global_tid_29506),\n                  flat_dim_25607)) {\n            int64_t i_p_o_28811 = add64(-1, gtid_27443);\n            int64_t rot_i_28812 = smod64(i_p_o_28811, flat_dim_25607);\n            bool cond_27450 = gtid_27443 == 0;\n            int64_t res_27451;\n            \n            if (cond_27450) {\n                res_27451 = 0;\n            } else {\n                int64_t x_27449 = ((__global int64_t *) mem_28973)[rot_i_28812];\n                \n                res_27451 = x_27449;\n            }\n            // save map-out results\n            { }\n            // perform atomic updates\n            {\n                if (sle64(sext_i32_i64(chk_i_29504) * hist_H_chk_29505,\n                          res_27451) && (slt64(res_27451,\n                                               sext_i32_i64(chk_i_29504) *\n                                               hist_H_chk_29505 +\n                                               hist_H_chk_29505) &&\n                                         slt64(res_27451, res_25889))) {\n                    int64_t x_27445;\n                    int64_t x_27446;\n                    \n                    x_27446 = gtid_27443;\n                    \n                    int32_t old_29513;\n                    volatile bool continue_29514;\n                    \n                    continue_29514 = 1;\n                    while (continue_29514) {\n               ",
                   "         old_29513 =\n                            atomic_cmpxchg_i32_global(&((volatile __global\n                                                         int *) mainzihist_locks_mem_29502)[srem64(sext_i32_i64(subhisto_ind_29511) *\n                                                                                                   res_25889 +\n                                                                                                   res_27451,\n                                                                                                   100151)],\n                                                      0, 1);\n                        if (old_29513 == 0) {\n                            int64_t x_27445;\n                            \n                            // bind lhs\n                            {\n                                x_27445 = ((volatile __global\n                                            int64_t *) res_subhistos_mem_29432)[sext_i32_i64(subhisto_ind_29511) *\n                                                                                res_25889 +\n                                                                                res_27451];\n                            }\n                            // execute operation\n                            {\n                                int64_t res_27447 = smax64(x_27445, x_27446);\n                                \n                                x_27445 = res_27447;\n                            }\n                            // update global result\n                            {\n                                ((volatile __global\n                                  int64_t *) res_subhistos_mem_29432)[sext_i32_i64(subhisto_ind_29511) *\n                                                                      res_25889 +\n                                                                      res_27451] =\n                                    x_27445;\n                            }\n                            mem_fence_global()",
                   ";\n                            old_29513 =\n                                atomic_cmpxchg_i32_global(&((volatile __global\n                                                             int *) mainzihist_locks_mem_29502)[srem64(sext_i32_i64(subhisto_ind_29511) *\n                                                                                                       res_25889 +\n                                                                                                       res_27451,\n                                                                                                       100151)],\n                                                          1, 0);\n                            continue_29514 = 0;\n                        }\n                        mem_fence_global();\n                    }\n                }\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef seghist_group_sizze_27439\n}\n__kernel void mainziseghist_local_27444(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *locks_mem_29472_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *subhistogram_local_mem_29470_backing_aligned_1,\n                                        int64_t flat_dim_25607,\n                                        int64_t res_25889, __global\n                                        unsigned char *mem_28973, __global\n                                        unsigned char *res_subhistos_mem_29432,\n                                        int32_t max_group_sizze_29441,\n                                        int64_t num_groups_29442,\n                                        int32_t hist_M_29448,\n                                        int32_t chk_i_29453,\n                                        int64_t num_segments_29454,\n                                        int64_t hist_H_chk_29455,\n                                 ",
                   "       int64_t histo_sizze_29456,\n                                        int32_t init_per_thread_29457)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict locks_mem_29472_backing_1 =\n                          (__local volatile\n                           char *) locks_mem_29472_backing_aligned_0;\n    __local volatile char *restrict subhistogram_local_mem_29470_backing_0 =\n                          (__local volatile\n                           char *) subhistogram_local_mem_29470_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29458;\n    int32_t local_tid_29459;\n    int64_t group_sizze_29462;\n    int32_t wave_sizze_29461;\n    int32_t group_tid_29460;\n    \n    global_tid_29458 = get_global_id(0);\n    local_tid_29459 = get_local_id(0);\n    group_sizze_29462 = get_local_size(0);\n    wave_sizze_29461 = LOCKSTEP_WIDTH;\n    group_tid_29460 = get_group_id(0);\n    \n    int32_t phys_tid_27444;\n    \n    phys_tid_27444 = global_tid_29458;\n    \n    int32_t phys_group_id_29463;\n    \n    phys_group_id_29463 = get_group_id(0);\n    for (int32_t i_29464 = 0; i_29464 <\n         sdiv_up32(sext_i64_i32(num_groups_29442 * num_segments_29454) -\n                   phys_group_id_29463, sext_i64_i32(num_groups_29442));\n         i_29464++) {\n        int32_t virt_group_id_29465 = phys_group_id_29463 + i_29464 *\n                sext_i64_i32(num_groups_29442);\n        int32_t flat_segment_id_29466 = squot32(virt_group_id_29465,\n                                                sext_i64_i32(num_groups_29442));\n        int32_t gid_in_segment_29467 = srem32(virt_group_id_29465,\n                                              sext_i64_i32(num_groups_29442));\n        int32_t pgtid_in_segment_29468 = gid_in_segment_29467 *\n                sext_i64_i32(max_group_sizze_29441) + local_tid_29459;\n        int32_t threads_per_segment_29469 = sext_i64_i32(num_groups_29442 *\n              ",
                   "  max_group_sizze_29441);\n        __local char *subhistogram_local_mem_29470;\n        \n        subhistogram_local_mem_29470 = (__local\n                                        char *) subhistogram_local_mem_29470_backing_0;\n        \n        __local char *locks_mem_29472;\n        \n        locks_mem_29472 = (__local char *) locks_mem_29472_backing_1;\n        // All locks start out unlocked\n        {\n            for (int64_t i_29474 = 0; i_29474 < sdiv_up64(hist_M_29448 *\n                                                          hist_H_chk_29455 -\n                                                          sext_i32_i64(local_tid_29459),\n                                                          max_group_sizze_29441);\n                 i_29474++) {\n                ((__local int32_t *) locks_mem_29472)[squot64(i_29474 *\n                                                              max_group_sizze_29441 +\n                                                              sext_i32_i64(local_tid_29459),\n                                                              hist_H_chk_29455) *\n                                                      hist_H_chk_29455 +\n                                                      (i_29474 *\n                                                       max_group_sizze_29441 +\n                                                       sext_i32_i64(local_tid_29459) -\n                                                       squot64(i_29474 *\n                                                               max_group_sizze_29441 +\n                                                               sext_i32_i64(local_tid_29459),\n                                                               hist_H_chk_29455) *\n                                                       hist_H_chk_29455)] = 0;\n            }\n        }\n        \n        int32_t thread_local_subhisto_i_29475;\n        \n        thread_local_subhisto_i_29475 = srem32(local_tid_29459, hist_M_29448);\n        // initialize histog",
                   "rams in local memory\n        {\n            for (int32_t local_i_29476 = 0; local_i_29476 <\n                 init_per_thread_29457; local_i_29476++) {\n                int32_t j_29477 = local_i_29476 *\n                        sext_i64_i32(max_group_sizze_29441) + local_tid_29459;\n                int32_t j_offset_29478 = hist_M_29448 *\n                        sext_i64_i32(histo_sizze_29456) * gid_in_segment_29467 +\n                        j_29477;\n                int32_t local_subhisto_i_29479 = squot32(j_29477,\n                                                         sext_i64_i32(histo_sizze_29456));\n                int32_t global_subhisto_i_29480 = squot32(j_offset_29478,\n                                                          sext_i64_i32(histo_sizze_29456));\n                \n                if (slt32(j_29477, hist_M_29448 *\n                          sext_i64_i32(histo_sizze_29456))) {\n                    // First subhistogram is initialised from global memory; others with neutral element.\n                    {\n                        if (global_subhisto_i_29480 == 0) {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_29470)[sext_i32_i64(local_subhisto_i_29479) *\n                                                                       hist_H_chk_29455 +\n                                                                       sext_i32_i64(srem32(j_29477,\n                                                                                           sext_i64_i32(histo_sizze_29456)))] =\n                                ((__global\n                                  int64_t *) res_subhistos_mem_29432)[sext_i32_i64(srem32(j_29477,\n                                                                                          sext_i64_i32(histo_sizze_29456))) +\n                                                                      sext_i32_i64(chk_i_29453) *\n                                                                      hist_H_ch",
                   "k_29455];\n                        } else {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_29470)[sext_i32_i64(local_subhisto_i_29479) *\n                                                                       hist_H_chk_29455 +\n                                                                       sext_i32_i64(srem32(j_29477,\n                                                                                           sext_i64_i32(histo_sizze_29456)))] =\n                                0;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29481 = 0; i_29481 <\n             sdiv_up32(sext_i64_i32(flat_dim_25607) - pgtid_in_segment_29468,\n                       threads_per_segment_29469); i_29481++) {\n            int32_t gtid_27443 = i_29481 * threads_per_segment_29469 +\n                    pgtid_in_segment_29468;\n            int64_t i_p_o_28811 = add64(-1, gtid_27443);\n            int64_t rot_i_28812 = smod64(i_p_o_28811, flat_dim_25607);\n            bool cond_27450 = gtid_27443 == 0;\n            int64_t res_27451;\n            \n            if (cond_27450) {\n                res_27451 = 0;\n            } else {\n                int64_t x_27449 = ((__global int64_t *) mem_28973)[rot_i_28812];\n                \n                res_27451 = x_27449;\n            }\n            if (chk_i_29453 == 0) {\n                // save map-out results\n                { }\n            }\n            // perform atomic updates\n            {\n                if (slt64(res_27451, res_25889) &&\n                    (sle64(sext_i32_i64(chk_i_29453) * hist_H_chk_29455,\n                           res_27451) && slt64(res_27451,\n                                               sext_i32_i64(chk_i_29453) *\n                                               hist_H_chk_29455 +\n                                               hist_H_chk_29455))) {\n                    int",
                   "64_t x_27445;\n                    int64_t x_27446;\n                    \n                    x_27446 = gtid_27443;\n                    \n                    int32_t old_29482;\n                    volatile bool continue_29483;\n                    \n                    continue_29483 = 1;\n                    while (continue_29483) {\n                        old_29482 = atomic_cmpxchg_i32_local(&((volatile __local\n                                                                int *) locks_mem_29472)[sext_i32_i64(thread_local_subhisto_i_29475) *\n                                                                                        hist_H_chk_29455 +\n                                                                                        (res_27451 -\n                                                                                         sext_i32_i64(chk_i_29453) *\n                                                                                         hist_H_chk_29455)],\n                                                             0, 1);\n                        if (old_29482 == 0) {\n                            int64_t x_27445;\n                            \n                            // bind lhs\n                            {\n                                x_27445 = ((volatile __local\n                                            int64_t *) subhistogram_local_mem_29470)[sext_i32_i64(thread_local_subhisto_i_29475) *\n                                                                                     hist_H_chk_29455 +\n                                                                                     (res_27451 -\n                                                                                      sext_i32_i64(chk_i_29453) *\n                                                                                      hist_H_chk_29455)];\n                            }\n                            // execute operation\n                            {\n                                int64_t ",
                   "res_27447 = smax64(x_27445, x_27446);\n                                \n                                x_27445 = res_27447;\n                            }\n                            // update global result\n                            {\n                                ((volatile __local\n                                  int64_t *) subhistogram_local_mem_29470)[sext_i32_i64(thread_local_subhisto_i_29475) *\n                                                                           hist_H_chk_29455 +\n                                                                           (res_27451 -\n                                                                            sext_i32_i64(chk_i_29453) *\n                                                                            hist_H_chk_29455)] =\n                                    x_27445;\n                            }\n                            mem_fence_local();\n                            old_29482 =\n                                atomic_cmpxchg_i32_local(&((volatile __local\n                                                            int *) locks_mem_29472)[sext_i32_i64(thread_local_subhisto_i_29475) *\n                                                                                    hist_H_chk_29455 +\n                                                                                    (res_27451 -\n                                                                                     sext_i32_i64(chk_i_29453) *\n                                                                                     hist_H_chk_29455)],\n                                                         1, 0);\n                            continue_29483 = 0;\n                        }\n                        mem_fence_local();\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Compact the multiple local memory subhistograms to result in global memory\n        {\n            int64_t trunc_H_29484 = smin64(",
                   "hist_H_chk_29455, res_25889 -\n                                           sext_i32_i64(chk_i_29453) *\n                                           hist_H_chk_29455);\n            int32_t histo_sizze_29485 = sext_i64_i32(trunc_H_29484);\n            \n            for (int32_t local_i_29486 = 0; local_i_29486 <\n                 init_per_thread_29457; local_i_29486++) {\n                int32_t j_29487 = local_i_29486 *\n                        sext_i64_i32(max_group_sizze_29441) + local_tid_29459;\n                \n                if (slt32(j_29487, histo_sizze_29485)) {\n                    int64_t x_27445;\n                    int64_t x_27446;\n                    \n                    // Read values from subhistogram 0.\n                    {\n                        x_27445 = ((__local\n                                    int64_t *) subhistogram_local_mem_29470)[sext_i32_i64(j_29487)];\n                    }\n                    // Accumulate based on values in other subhistograms.\n                    {\n                        for (int32_t subhisto_id_29488 = 0; subhisto_id_29488 <\n                             hist_M_29448 - 1; subhisto_id_29488++) {\n                            x_27446 = ((__local\n                                        int64_t *) subhistogram_local_mem_29470)[(sext_i32_i64(subhisto_id_29488) +\n                                                                                  1) *\n                                                                                 hist_H_chk_29455 +\n                                                                                 sext_i32_i64(j_29487)];\n                            \n                            int64_t res_27447;\n                            \n                            res_27447 = smax64(x_27445, x_27446);\n                            x_27445 = res_27447;\n                        }\n                    }\n                    // Put final bucket value in global memory.\n                    {\n                        ((__global\n  ",
                   "                        int64_t *) res_subhistos_mem_29432)[srem64(sext_i32_i64(virt_group_id_29465),\n                                                                     num_groups_29442) *\n                                                              res_25889 +\n                                                              (sext_i32_i64(j_29487) +\n                                                               sext_i32_i64(chk_i_29453) *\n                                                               hist_H_chk_29455)] =\n                            x_27445;\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\n__kernel void mainzisegmap_26596(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, int64_t n_25418,\n                                 float a_25426, float r0_25429, float x_25446,\n                                 float x_25448, float y_25450, float y_25451,\n                                 __global unsigned char *swap_term_mem_28878,\n                                 __global unsigned char *payments_mem_28879,\n                                 __global unsigned char *mem_28892, __global\n                                 unsigned char *mem_28906,\n                                 int64_t num_threads_29040)\n{\n    #define segmap_group_sizze_26674 (mainzisegmap_group_sizze_26598)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29267;\n    int32_t local_tid_29268;\n    int64_t group_sizze_29271;\n    int32_t wave_sizze_29270;\n    int32_t group_tid_29269;\n    \n    global_tid_29267 = get_global_id(0);\n    local_tid_29268 = get_local_id(0);\n    group_sizze_29271 = get_local_size(0);\n    wave_sizze_29270 = LOCKSTEP_WIDTH;\n    group_tid_292",
                   "69 = get_group_id(0);\n    \n    int32_t phys_tid_26596;\n    \n    phys_tid_26596 = global_tid_29267;\n    \n    int64_t gtid_26595;\n    \n    gtid_26595 = sext_i32_i64(group_tid_29269) * segmap_group_sizze_26674 +\n        sext_i32_i64(local_tid_29268);\n    if (slt64(gtid_26595, n_25418)) {\n        float res_26685 = ((__global float *) swap_term_mem_28878)[gtid_26595];\n        int64_t res_26686 = ((__global\n                              int64_t *) payments_mem_28879)[gtid_26595];\n        int64_t range_end_26688 = sub64(res_26686, 1);\n        bool bounds_invalid_upwards_26689 = slt64(range_end_26688, 0);\n        bool valid_26690 = !bounds_invalid_upwards_26689;\n        bool range_valid_c_26691;\n        \n        if (!valid_26690) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 0) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = 1;\n                    global_failure_args[2] = range_end_26688;\n                    ;\n                }\n                return;\n            }\n        }\n        for (int64_t i_28856 = 0; i_28856 < res_26686; i_28856++) {\n            float res_26695 = sitofp_i64_f32(i_28856);\n            float res_26696 = res_26685 * res_26695;\n            \n            ((__global float *) mem_28892)[phys_tid_26596 + i_28856 *\n                                           num_threads_29040] = res_26696;\n        }\n        \n        bool y_26697 = slt64(0, res_26686);\n        bool index_certs_26698;\n        \n        if (!y_26697) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 1) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_26686;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_26699 = sitofp_i64_f32(range_end_26688);\n        float index_primexp_26700 = res_26685 * binop_y_26699;\n        float negate_arg_26701 = a_25426 * inde",
                   "x_primexp_26700;\n        float exp_arg_26702 = 0.0F - negate_arg_26701;\n        float res_26703 = fpow32(2.7182817F, exp_arg_26702);\n        float x_26704 = 1.0F - res_26703;\n        float B_26705 = x_26704 / a_25426;\n        float x_26706 = B_26705 - index_primexp_26700;\n        float x_26707 = y_25450 * x_26706;\n        float A1_26708 = x_26707 / x_25446;\n        float y_26709 = fpow32(B_26705, 2.0F);\n        float x_26710 = x_25448 * y_26709;\n        float A2_26711 = x_26710 / y_25451;\n        float exp_arg_26712 = A1_26708 - A2_26711;\n        float res_26713 = fpow32(2.7182817F, exp_arg_26712);\n        float negate_arg_26714 = r0_25429 * B_26705;\n        float exp_arg_26715 = 0.0F - negate_arg_26714;\n        float res_26716 = fpow32(2.7182817F, exp_arg_26715);\n        float res_26717 = res_26713 * res_26716;\n        bool empty_slice_26718 = range_end_26688 == 0;\n        bool zzero_leq_i_p_m_t_s_26719 = sle64(0, range_end_26688);\n        bool i_p_m_t_s_leq_w_26720 = slt64(range_end_26688, res_26686);\n        bool i_lte_j_26721 = sle64(1, res_26686);\n        bool y_26722 = zzero_leq_i_p_m_t_s_26719 && i_p_m_t_s_leq_w_26720;\n        bool y_26723 = i_lte_j_26721 && y_26722;\n        bool ok_or_empty_26724 = empty_slice_26718 || y_26723;\n        bool index_certs_26725;\n        \n        if (!ok_or_empty_26724) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 2) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = res_26686;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float res_26727;\n        float redout_28858 = 0.0F;\n        \n        for (int64_t i_28859 = 0; i_28859 < range_end_26688; i_28859++) {\n            int64_t slice_28872 = 1 + i_28859;\n            float x_26731 = ((__global float *) mem_28892)[phys_tid_26596 +\n                                                           slice_28872 *\n                                     ",
                   "                      num_threads_29040];\n            float negate_arg_26732 = a_25426 * x_26731;\n            float exp_arg_26733 = 0.0F - negate_arg_26732;\n            float res_26734 = fpow32(2.7182817F, exp_arg_26733);\n            float x_26735 = 1.0F - res_26734;\n            float B_26736 = x_26735 / a_25426;\n            float x_26737 = B_26736 - x_26731;\n            float x_26738 = y_25450 * x_26737;\n            float A1_26739 = x_26738 / x_25446;\n            float y_26740 = fpow32(B_26736, 2.0F);\n            float x_26741 = x_25448 * y_26740;\n            float A2_26742 = x_26741 / y_25451;\n            float exp_arg_26743 = A1_26739 - A2_26742;\n            float res_26744 = fpow32(2.7182817F, exp_arg_26743);\n            float negate_arg_26745 = r0_25429 * B_26736;\n            float exp_arg_26746 = 0.0F - negate_arg_26745;\n            float res_26747 = fpow32(2.7182817F, exp_arg_26746);\n            float res_26748 = res_26744 * res_26747;\n            float res_26730 = res_26748 + redout_28858;\n            float redout_tmp_29273 = res_26730;\n            \n            redout_28858 = redout_tmp_29273;\n        }\n        res_26727 = redout_28858;\n        \n        float x_26749 = 1.0F - res_26717;\n        float y_26750 = res_26685 * res_26727;\n        float res_26751 = x_26749 / y_26750;\n        \n        ((__global float *) mem_28906)[gtid_26595] = res_26751;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26674\n}\n__kernel void mainzisegmap_26772(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, int64_t n_25418,\n                                 float a_25426, float r0_25429, float x_25446,\n                                 float x_25448, float y_25450, float y_25451,\n                                 __global unsigned char *swap_term_mem_28878,\n                                 __global unsigned char *payments_mem_28879,\n                          ",
                   "       __global unsigned char *mem_28915, __global\n                                 unsigned char *mem_28929,\n                                 int64_t num_threads_29072)\n{\n    #define segmap_group_sizze_26850 (mainzisegmap_group_sizze_26774)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29304;\n    int32_t local_tid_29305;\n    int64_t group_sizze_29308;\n    int32_t wave_sizze_29307;\n    int32_t group_tid_29306;\n    \n    global_tid_29304 = get_global_id(0);\n    local_tid_29305 = get_local_id(0);\n    group_sizze_29308 = get_local_size(0);\n    wave_sizze_29307 = LOCKSTEP_WIDTH;\n    group_tid_29306 = get_group_id(0);\n    \n    int32_t phys_tid_26772;\n    \n    phys_tid_26772 = global_tid_29304;\n    \n    int64_t gtid_26771;\n    \n    gtid_26771 = sext_i32_i64(group_tid_29306) * segmap_group_sizze_26850 +\n        sext_i32_i64(local_tid_29305);\n    if (slt64(gtid_26771, n_25418)) {\n        float res_26861 = ((__global float *) swap_term_mem_28878)[gtid_26771];\n        int64_t res_26862 = ((__global\n                              int64_t *) payments_mem_28879)[gtid_26771];\n        int64_t range_end_26864 = sub64(res_26862, 1);\n        bool bounds_invalid_upwards_26865 = slt64(range_end_26864, 0);\n        bool valid_26866 = !bounds_invalid_upwards_26865;\n        bool range_valid_c_26867;\n        \n        if (!valid_26866) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 3) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = 1;\n                    global_failure_args[2] = range_end_26864;\n                    ;\n                }\n                return;\n            }\n        }\n        for (int64_t i_28862 = 0; i_28862 < res_26862; i_28862++) {\n            float res_26871 = sitofp_i64_f32(i_28862);\n            float res_26872 = res_26861 * res_26871;\n            \n            (",
                   "(__global float *) mem_28915)[phys_tid_26772 + i_28862 *\n                                           num_threads_29072] = res_26872;\n        }\n        \n        bool y_26873 = slt64(0, res_26862);\n        bool index_certs_26874;\n        \n        if (!y_26873) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 4) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_26862;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_26875 = sitofp_i64_f32(range_end_26864);\n        float index_primexp_26876 = res_26861 * binop_y_26875;\n        float negate_arg_26877 = a_25426 * index_primexp_26876;\n        float exp_arg_26878 = 0.0F - negate_arg_26877;\n        float res_26879 = fpow32(2.7182817F, exp_arg_26878);\n        float x_26880 = 1.0F - res_26879;\n        float B_26881 = x_26880 / a_25426;\n        float x_26882 = B_26881 - index_primexp_26876;\n        float x_26883 = y_25450 * x_26882;\n        float A1_26884 = x_26883 / x_25446;\n        float y_26885 = fpow32(B_26881, 2.0F);\n        float x_26886 = x_25448 * y_26885;\n        float A2_26887 = x_26886 / y_25451;\n        float exp_arg_26888 = A1_26884 - A2_26887;\n        float res_26889 = fpow32(2.7182817F, exp_arg_26888);\n        float negate_arg_26890 = r0_25429 * B_26881;\n        float exp_arg_26891 = 0.0F - negate_arg_26890;\n        float res_26892 = fpow32(2.7182817F, exp_arg_26891);\n        float res_26893 = res_26889 * res_26892;\n        bool empty_slice_26894 = range_end_26864 == 0;\n        bool zzero_leq_i_p_m_t_s_26895 = sle64(0, range_end_26864);\n        bool i_p_m_t_s_leq_w_26896 = slt64(range_end_26864, res_26862);\n        bool i_lte_j_26897 = sle64(1, res_26862);\n        bool y_26898 = zzero_leq_i_p_m_t_s_26895 && i_p_m_t_s_leq_w_26896;\n        bool y_26899 = i_lte_j_26897 && y_26898;\n        bool ok_or_empty_26900 = empty_slice_26894 || y_26899;\n        bool index",
                   "_certs_26901;\n        \n        if (!ok_or_empty_26900) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 5) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = res_26862;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float res_26903;\n        float redout_28864 = 0.0F;\n        \n        for (int64_t i_28865 = 0; i_28865 < range_end_26864; i_28865++) {\n            int64_t slice_28875 = 1 + i_28865;\n            float x_26907 = ((__global float *) mem_28915)[phys_tid_26772 +\n                                                           slice_28875 *\n                                                           num_threads_29072];\n            float negate_arg_26908 = a_25426 * x_26907;\n            float exp_arg_26909 = 0.0F - negate_arg_26908;\n            float res_26910 = fpow32(2.7182817F, exp_arg_26909);\n            float x_26911 = 1.0F - res_26910;\n            float B_26912 = x_26911 / a_25426;\n            float x_26913 = B_26912 - x_26907;\n            float x_26914 = y_25450 * x_26913;\n            float A1_26915 = x_26914 / x_25446;\n            float y_26916 = fpow32(B_26912, 2.0F);\n            float x_26917 = x_25448 * y_26916;\n            float A2_26918 = x_26917 / y_25451;\n            float exp_arg_26919 = A1_26915 - A2_26918;\n            float res_26920 = fpow32(2.7182817F, exp_arg_26919);\n            float negate_arg_26921 = r0_25429 * B_26912;\n            float exp_arg_26922 = 0.0F - negate_arg_26921;\n            float res_26923 = fpow32(2.7182817F, exp_arg_26922);\n            float res_26924 = res_26920 * res_26923;\n            float res_26906 = res_26924 + redout_28864;\n            float redout_tmp_29310 = res_26906;\n            \n            redout_28864 = redout_tmp_29310;\n        }\n        res_26903 = redout_28864;\n        \n        float x_26925 = 1.0F - res_26893;\n        float y_26926 = res_26861 * res_26903;\n        float",
                   " res_26927 = x_26925 / y_26926;\n        \n        ((__global float *) mem_28929)[gtid_26771] = res_26927;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_26850\n}\n__kernel void mainzisegmap_27071(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args,\n                                 int64_t paths_25421, int64_t steps_25422,\n                                 float a_25426, float b_25427,\n                                 float sigma_25428, float r0_25429,\n                                 float dt_25444, int64_t upper_bound_25542,\n                                 float res_25543, int64_t num_groups_27323,\n                                 __global unsigned char *mem_28943, __global\n                                 unsigned char *mem_28946, __global\n                                 unsigned char *mem_28961)\n{\n    #define segmap_group_sizze_27322 (mainzisegmap_group_sizze_27073)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29323;\n    int32_t local_tid_29324;\n    int64_t group_sizze_29327;\n    int32_t wave_sizze_29326;\n    int32_t group_tid_29325;\n    \n    global_tid_29323 = get_global_id(0);\n    local_tid_29324 = get_local_id(0);\n    group_sizze_29327 = get_local_size(0);\n    wave_sizze_29326 = LOCKSTEP_WIDTH;\n    group_tid_29325 = get_group_id(0);\n    \n    int32_t phys_tid_27071;\n    \n    phys_tid_27071 = global_tid_29323;\n    \n    int32_t phys_group_id_29328;\n    \n    phys_group_id_29328 = get_group_id(0);\n    for (int32_t i_29329 = 0; i_29329 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(paths_25421,\n                                          seg",
                   "map_group_sizze_27322)) -\n                   phys_group_id_29328, sext_i64_i32(num_groups_27323));\n         i_29329++) {\n        int32_t virt_group_id_29330 = phys_group_id_29328 + i_29329 *\n                sext_i64_i32(num_groups_27323);\n        int64_t gtid_27070 = sext_i32_i64(virt_group_id_29330) *\n                segmap_group_sizze_27322 + sext_i32_i64(local_tid_29324);\n        \n        if (slt64(gtid_27070, paths_25421)) {\n            for (int64_t i_29331 = 0; i_29331 < steps_25422; i_29331++) {\n                ((__global float *) mem_28946)[phys_tid_27071 + i_29331 *\n                                               (num_groups_27323 *\n                                                segmap_group_sizze_27322)] =\n                    r0_25429;\n            }\n            for (int64_t i_27329 = 0; i_27329 < upper_bound_25542; i_27329++) {\n                bool y_27331 = slt64(i_27329, steps_25422);\n                bool index_certs_27332;\n                \n                if (!y_27331) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 6) ==\n                            -1) {\n                            global_failure_args[0] = i_27329;\n                            global_failure_args[1] = steps_25422;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float shortstep_arg_27333 = ((__global\n                                              float *) mem_28943)[i_27329 *\n                                                                  paths_25421 +\n                                                                  gtid_27070];\n                float shortstep_arg_27334 = ((__global\n                                              float *) mem_28946)[phys_tid_27071 +\n                                                                  i_27329 *\n                                     ",
                   "                             (num_groups_27323 *\n                                                                   segmap_group_sizze_27322)];\n                float y_27335 = b_25427 - shortstep_arg_27334;\n                float x_27336 = a_25426 * y_27335;\n                float x_27337 = dt_25444 * x_27336;\n                float x_27338 = res_25543 * shortstep_arg_27333;\n                float y_27339 = sigma_25428 * x_27338;\n                float delta_r_27340 = x_27337 + y_27339;\n                float res_27341 = shortstep_arg_27334 + delta_r_27340;\n                int64_t i_27342 = add64(1, i_27329);\n                bool x_27343 = sle64(0, i_27342);\n                bool y_27344 = slt64(i_27342, steps_25422);\n                bool bounds_check_27345 = x_27343 && y_27344;\n                bool index_certs_27346;\n                \n                if (!bounds_check_27345) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 7) ==\n                            -1) {\n                            global_failure_args[0] = i_27342;\n                            global_failure_args[1] = steps_25422;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                ((__global float *) mem_28946)[phys_tid_27071 + i_27342 *\n                                               (num_groups_27323 *\n                                                segmap_group_sizze_27322)] =\n                    res_27341;\n            }\n            for (int64_t i_29333 = 0; i_29333 < steps_25422; i_29333++) {\n                ((__global float *) mem_28961)[i_29333 * paths_25421 +\n                                               gtid_27070] = ((__global\n                                                               float *) mem_28946)[phys_tid_27071 +\n                                                                                   i_29333 *\n",
                   "                                                                                   (num_groups_27323 *\n                                                                                    segmap_group_sizze_27322)];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27322\n}\n__kernel void mainzisegmap_27169(__global int *global_failure,\n                                 int64_t paths_25421, int64_t steps_25422,\n                                 __global unsigned char *mem_28936, __global\n                                 unsigned char *mem_28940)\n{\n    #define segmap_group_sizze_27277 (mainzisegmap_group_sizze_27172)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29317;\n    int32_t local_tid_29318;\n    int64_t group_sizze_29321;\n    int32_t wave_sizze_29320;\n    int32_t group_tid_29319;\n    \n    global_tid_29317 = get_global_id(0);\n    local_tid_29318 = get_local_id(0);\n    group_sizze_29321 = get_local_size(0);\n    wave_sizze_29320 = LOCKSTEP_WIDTH;\n    group_tid_29319 = get_group_id(0);\n    \n    int32_t phys_tid_27169;\n    \n    phys_tid_27169 = global_tid_29317;\n    \n    int64_t gtid_27167;\n    \n    gtid_27167 = squot64(sext_i32_i64(group_tid_29319) *\n                         segmap_group_sizze_27277 +\n                         sext_i32_i64(local_tid_29318), steps_25422);\n    \n    int64_t gtid_27168;\n    \n    gtid_27168 = sext_i32_i64(group_tid_29319) * segmap_group_sizze_27277 +\n        sext_i32_i64(local_tid_29318) - squot64(sext_i32_i64(group_tid_29319) *\n                                                segmap_group_sizze_27277 +\n                                                sext_i32_i64(local_tid_29318),\n                                                steps_25422) * steps_25422;\n    if (slt64(gtid_27167, paths_25421) && slt64(gtid_27168, steps_",
                   "25422)) {\n        int32_t unsign_arg_27280 = ((__global int32_t *) mem_28936)[gtid_27167];\n        int32_t res_27282 = sext_i64_i32(gtid_27168);\n        int32_t x_27283 = lshr32(res_27282, 16);\n        int32_t x_27284 = res_27282 ^ x_27283;\n        int32_t x_27285 = mul32(73244475, x_27284);\n        int32_t x_27286 = lshr32(x_27285, 16);\n        int32_t x_27287 = x_27285 ^ x_27286;\n        int32_t x_27288 = mul32(73244475, x_27287);\n        int32_t x_27289 = lshr32(x_27288, 16);\n        int32_t x_27290 = x_27288 ^ x_27289;\n        int32_t unsign_arg_27291 = unsign_arg_27280 ^ x_27290;\n        int32_t unsign_arg_27292 = mul32(48271, unsign_arg_27291);\n        int32_t unsign_arg_27293 = umod32(unsign_arg_27292, 2147483647);\n        int32_t unsign_arg_27294 = mul32(48271, unsign_arg_27293);\n        int32_t unsign_arg_27295 = umod32(unsign_arg_27294, 2147483647);\n        float res_27296 = uitofp_i32_f32(unsign_arg_27293);\n        float res_27297 = res_27296 / 2.1474836e9F;\n        float res_27298 = uitofp_i32_f32(unsign_arg_27295);\n        float res_27299 = res_27298 / 2.1474836e9F;\n        float res_27300;\n        \n        res_27300 = futrts_log32(res_27297);\n        \n        float res_27301 = -2.0F * res_27300;\n        float res_27302;\n        \n        res_27302 = futrts_sqrt32(res_27301);\n        \n        float res_27303 = 6.2831855F * res_27299;\n        float res_27304;\n        \n        res_27304 = futrts_cos32(res_27303);\n        \n        float res_27305 = res_27302 * res_27304;\n        \n        ((__global float *) mem_28940)[gtid_27167 * steps_25422 + gtid_27168] =\n            res_27305;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27277\n}\n__kernel void mainzisegmap_27233(__global int *global_failure,\n                                 int64_t paths_25421, __global\n                                 unsigned char *mem_28936)\n{\n    #define segmap_group_sizze_27252 (mainzisegmap_group_sizze_27235)\n    \n    const int block_dim0 = 0;\n    const int block",
                   "_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29312;\n    int32_t local_tid_29313;\n    int64_t group_sizze_29316;\n    int32_t wave_sizze_29315;\n    int32_t group_tid_29314;\n    \n    global_tid_29312 = get_global_id(0);\n    local_tid_29313 = get_local_id(0);\n    group_sizze_29316 = get_local_size(0);\n    wave_sizze_29315 = LOCKSTEP_WIDTH;\n    group_tid_29314 = get_group_id(0);\n    \n    int32_t phys_tid_27233;\n    \n    phys_tid_27233 = global_tid_29312;\n    \n    int64_t gtid_27232;\n    \n    gtid_27232 = sext_i32_i64(group_tid_29314) * segmap_group_sizze_27252 +\n        sext_i32_i64(local_tid_29313);\n    if (slt64(gtid_27232, paths_25421)) {\n        int32_t res_27256 = sext_i64_i32(gtid_27232);\n        int32_t x_27257 = lshr32(res_27256, 16);\n        int32_t x_27258 = res_27256 ^ x_27257;\n        int32_t x_27259 = mul32(73244475, x_27258);\n        int32_t x_27260 = lshr32(x_27259, 16);\n        int32_t x_27261 = x_27259 ^ x_27260;\n        int32_t x_27262 = mul32(73244475, x_27261);\n        int32_t x_27263 = lshr32(x_27262, 16);\n        int32_t x_27264 = x_27262 ^ x_27263;\n        int32_t unsign_arg_27265 = 777822902 ^ x_27264;\n        int32_t unsign_arg_27266 = mul32(48271, unsign_arg_27265);\n        int32_t unsign_arg_27267 = umod32(unsign_arg_27266, 2147483647);\n        \n        ((__global int32_t *) mem_28936)[gtid_27232] = unsign_arg_27267;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27252\n}\n__kernel void mainzisegmap_27529(__global int *global_failure,\n                                 int64_t res_25889, int64_t num_segments_26082,\n                                 __global unsigned char *mem_28993, __global\n                                 unsigned char *mem_28998, __global\n                                 unsigned char *mem_29001, __global\n                                 unsigned char *mem_29003)\n{\n    #define segmap_group_sizze_27532 (mainzisegmap_group_sizze_27531)\n    \n",
                   "    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29839;\n    int32_t local_tid_29840;\n    int64_t group_sizze_29843;\n    int32_t wave_sizze_29842;\n    int32_t group_tid_29841;\n    \n    global_tid_29839 = get_global_id(0);\n    local_tid_29840 = get_local_id(0);\n    group_sizze_29843 = get_local_size(0);\n    wave_sizze_29842 = LOCKSTEP_WIDTH;\n    group_tid_29841 = get_group_id(0);\n    \n    int32_t phys_tid_27529;\n    \n    phys_tid_27529 = global_tid_29839;\n    \n    int64_t write_i_27528;\n    \n    write_i_27528 = sext_i32_i64(group_tid_29841) * segmap_group_sizze_27532 +\n        sext_i32_i64(local_tid_29840);\n    if (slt64(write_i_27528, res_25889)) {\n        int64_t i_p_o_28819 = add64(1, write_i_27528);\n        int64_t rot_i_28820 = smod64(i_p_o_28819, res_25889);\n        bool x_26095 = ((__global bool *) mem_28993)[rot_i_28820];\n        float write_value_26096 = ((__global float *) mem_28998)[write_i_27528];\n        int64_t res_26097;\n        \n        if (x_26095) {\n            int64_t x_26094 = ((__global int64_t *) mem_29001)[write_i_27528];\n            int64_t res_26098 = sub64(x_26094, 1);\n            \n            res_26097 = res_26098;\n        } else {\n            res_26097 = -1;\n        }\n        if (sle64(0, res_26097) && slt64(res_26097, num_segments_26082)) {\n            ((__global float *) mem_29003)[res_26097] = write_value_26096;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27532\n}\n__kernel void mainzisegmap_27567(__global int *global_failure, int64_t n_25418,\n                                 int64_t paths_25421, __global\n                                 unsigned char *mem_29013, __global\n                                 unsigned char *mem_29016)\n{\n    #define segmap_group_sizze_27646 (mainzisegmap_group_sizze_27569)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2",
                   ";\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29875;\n    int32_t local_tid_29876;\n    int64_t group_sizze_29879;\n    int32_t wave_sizze_29878;\n    int32_t group_tid_29877;\n    \n    global_tid_29875 = get_global_id(0);\n    local_tid_29876 = get_local_id(0);\n    group_sizze_29879 = get_local_size(0);\n    wave_sizze_29878 = LOCKSTEP_WIDTH;\n    group_tid_29877 = get_group_id(0);\n    \n    int32_t phys_tid_27567;\n    \n    phys_tid_27567 = global_tid_29875;\n    \n    int64_t gtid_27566;\n    \n    gtid_27566 = sext_i32_i64(group_tid_29877) * segmap_group_sizze_27646 +\n        sext_i32_i64(local_tid_29876);\n    if (slt64(gtid_27566, paths_25421)) {\n        float res_27650;\n        float redout_28868 = 0.0F;\n        \n        for (int64_t i_28869 = 0; i_28869 < n_25418; i_28869++) {\n            float x_27654 = ((__global float *) mem_29013)[i_28869 *\n                                                           paths_25421 +\n                                                           gtid_27566];\n            float res_27653 = x_27654 + redout_28868;\n            float redout_tmp_29880 = res_27653;\n            \n            redout_28868 = redout_tmp_29880;\n        }\n        res_27650 = redout_28868;\n        \n        float res_27655 = fmax32(0.0F, res_27650);\n        \n        ((__global float *) mem_29016)[gtid_27566] = res_27655;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27646\n}\n__kernel void mainzisegmap_27592(__global int *global_failure,\n                                 int64_t paths_25421, __global\n                                 unsigned char *mem_29019, __global\n                                 unsigned char *mem_29022)\n{\n    #define segmap_group_sizze_27668 (mainzisegmap_group_sizze_27594)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29941;\n    int32_t local_tid_29942;\n    int64_t group_sizze_29",
                   "945;\n    int32_t wave_sizze_29944;\n    int32_t group_tid_29943;\n    \n    global_tid_29941 = get_global_id(0);\n    local_tid_29942 = get_local_id(0);\n    group_sizze_29945 = get_local_size(0);\n    wave_sizze_29944 = LOCKSTEP_WIDTH;\n    group_tid_29943 = get_group_id(0);\n    \n    int32_t phys_tid_27592;\n    \n    phys_tid_27592 = global_tid_29941;\n    \n    int64_t gtid_27591;\n    \n    gtid_27591 = sext_i32_i64(group_tid_29943) * segmap_group_sizze_27668 +\n        sext_i32_i64(local_tid_29942);\n    if (slt64(gtid_27591, paths_25421)) {\n        float res_27671 = ((__global float *) mem_29019)[gtid_27591];\n        float res_27672 = fmax32(0.0F, res_27671);\n        \n        ((__global float *) mem_29022)[gtid_27591] = res_27672;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27668\n}\n__kernel void mainzisegred_large_27608(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_29918_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_29916_backing_aligned_1,\n                                       int64_t n_25418,\n                                       int64_t num_groups_27659, __global\n                                       unsigned char *mem_29003, __global\n                                       unsigned char *mem_29019,\n                                       int64_t groups_per_segment_29902,\n                                       int64_t elements_per_thread_29903,\n                                       int64_t virt_num_groups_29904,\n                                       int64_t threads_per_segment_29906,\n                                       __global\n                                       unsigned char *group_res_arr_mem_29907,\n                                       __global\n                                       unsigned char *mainzicounter_mem_29909)\n{\n    #define segred_group_siz",
                   "ze_27658 (mainzisegred_group_sizze_27602)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_29918_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_29918_backing_aligned_0;\n    __local volatile char *restrict red_arr_mem_29916_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_29916_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29911;\n    int32_t local_tid_29912;\n    int64_t group_sizze_29915;\n    int32_t wave_sizze_29914;\n    int32_t group_tid_29913;\n    \n    global_tid_29911 = get_global_id(0);\n    local_tid_29912 = get_local_id(0);\n    group_sizze_29915 = get_local_size(0);\n    wave_sizze_29914 = LOCKSTEP_WIDTH;\n    group_tid_29913 = get_group_id(0);\n    \n    int32_t phys_tid_27608;\n    \n    phys_tid_27608 = global_tid_29911;\n    \n    __local char *red_arr_mem_29916;\n    \n    red_arr_mem_29916 = (__local char *) red_arr_mem_29916_backing_0;\n    \n    __local char *sync_arr_mem_29918;\n    \n    sync_arr_mem_29918 = (__local char *) sync_arr_mem_29918_backing_1;\n    \n    int32_t phys_group_id_29920;\n    \n    phys_group_id_29920 = get_group_id(0);\n    for (int32_t i_29921 = 0; i_29921 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_29904) - phys_group_id_29920,\n                   sext_i64_i32(num_groups_27659)); i_29921++) {\n        int32_t virt_group_id_29922 = phys_group_id_29920 + i_29921 *\n                sext_i64_i32(num_groups_27659);\n        int32_t flat_segment_id_29923 = squot32(virt_group_id_29922,\n                                                sext_i64_i32(groups_per_segment_29902));\n        int64_t global_tid_29924 = srem64(sext_i32_i64(virt_group_id_29922) *\n                                          segred_group_sizze_27658 +\n                                          sext_i32_i64(local_tid_29912),\n       ",
                   "                                   segred_group_sizze_27658 *\n                                          groups_per_segment_29902);\n        int64_t gtid_27599 = sext_i32_i64(flat_segment_id_29923);\n        int64_t gtid_27607;\n        float x_acc_29925;\n        int64_t chunk_sizze_29926;\n        \n        chunk_sizze_29926 = smin64(elements_per_thread_29903,\n                                   sdiv_up64(n_25418 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_29924)),\n                                             threads_per_segment_29906));\n        \n        float x_27662;\n        float x_27663;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_29925 = 0.0F;\n        }\n        for (int64_t i_29930 = 0; i_29930 < chunk_sizze_29926; i_29930++) {\n            gtid_27607 = sext_i32_i64(sext_i64_i32(global_tid_29924)) +\n                threads_per_segment_29906 * i_29930;\n            // apply map function\n            {\n                int64_t binop_x_28829 = n_25418 * gtid_27599;\n                int64_t new_index_28830 = gtid_27607 + binop_x_28829;\n                float x_27666 = ((__global float *) mem_29003)[new_index_28830];\n                \n                // save map-out results\n                { }\n                // load accumulator\n                {\n                    x_27662 = x_acc_29925;\n                }\n                // load new values\n                {\n                    x_27663 = x_27666;\n                }\n                // apply reduction operator\n                {\n                    float res_27664 = x_27662 + x_27663;\n                    \n                    // store in accumulator\n                    {\n                        x_acc_29925 = res_27664;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_27662 = x_acc_29925;\n            ((__local\n              float *) red_arr_mem_29916",
                   ")[sext_i32_i64(local_tid_29912)] =\n                x_27662;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_29931;\n        int32_t skip_waves_29932;\n        \n        skip_waves_29932 = 1;\n        \n        float x_29927;\n        float x_29928;\n        \n        offset_29931 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_29912,\n                      sext_i64_i32(segred_group_sizze_27658))) {\n                x_29927 = ((__local\n                            float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912 +\n                                                        offset_29931)];\n            }\n        }\n        offset_29931 = 1;\n        while (slt32(offset_29931, wave_sizze_29914)) {\n            if (slt32(local_tid_29912 + offset_29931,\n                      sext_i64_i32(segred_group_sizze_27658)) &&\n                ((local_tid_29912 - squot32(local_tid_29912, wave_sizze_29914) *\n                  wave_sizze_29914) & (2 * offset_29931 - 1)) == 0) {\n                // read array element\n                {\n                    x_29928 = ((volatile __local\n                                float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912 +\n                                                            offset_29931)];\n                }\n                // apply reduction operation\n                {\n                    float res_29929 = x_29927 + x_29928;\n                    \n                    x_29927 = res_29929;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912)] =\n                        x_29927;\n                }\n            }\n            offset_29931 *= 2;\n        }\n        while (slt32(skip_waves_29932,\n                     squot32(sext_i64_i32(segred_group_sizze_27658) +\n                             wave_sizze_29914 - 1, wave_s",
                   "izze_29914))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_29931 = skip_waves_29932 * wave_sizze_29914;\n            if (slt32(local_tid_29912 + offset_29931,\n                      sext_i64_i32(segred_group_sizze_27658)) &&\n                ((local_tid_29912 - squot32(local_tid_29912, wave_sizze_29914) *\n                  wave_sizze_29914) == 0 && (squot32(local_tid_29912,\n                                                     wave_sizze_29914) & (2 *\n                                                                          skip_waves_29932 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_29928 = ((__local\n                                float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912 +\n                                                            offset_29931)];\n                }\n                // apply reduction operation\n                {\n                    float res_29929 = x_29927 + x_29928;\n                    \n                    x_29927 = res_29929;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912)] =\n                        x_29927;\n                }\n            }\n            skip_waves_29932 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_29912) == 0) {\n                x_acc_29925 = x_29927;\n            }\n        }\n        if (groups_per_segment_29902 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_29912 == 0) {\n                    ((__global float *) mem_29019)[gtid_27599] = x_acc_29925;\n                }\n            }\n        } else {\n            int32_t old_counter_29933;\n          ",
                   "  \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_29912 == 0) {\n                    ((__global\n                      float *) group_res_arr_mem_29907)[sext_i32_i64(virt_group_id_29922) *\n                                                        segred_group_sizze_27658] =\n                        x_acc_29925;\n                    mem_fence_global();\n                    old_counter_29933 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_29909)[sext_i32_i64(srem32(flat_segment_id_29923,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_29918)[0] =\n                        old_counter_29933 == groups_per_segment_29902 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_29934;\n            \n            is_last_group_29934 = ((__local bool *) sync_arr_mem_29918)[0];\n            if (is_last_group_29934) {\n                if (local_tid_29912 == 0) {\n                    old_counter_29933 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_29909)[sext_i32_i64(srem32(flat_segment_id_29923,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_29902));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_29935 =\n                            sdiv_up64(groups_per_segment_29902,\n                                      segred_",
                   "group_sizze_27658);\n                    \n                    x_27662 = 0.0F;\n                    for (int64_t i_29936 = 0; i_29936 < read_per_thread_29935;\n                         i_29936++) {\n                        int64_t group_res_id_29937 =\n                                sext_i32_i64(local_tid_29912) *\n                                read_per_thread_29935 + i_29936;\n                        int64_t index_of_group_res_29938 =\n                                sext_i32_i64(flat_segment_id_29923) *\n                                groups_per_segment_29902 + group_res_id_29937;\n                        \n                        if (slt64(group_res_id_29937,\n                                  groups_per_segment_29902)) {\n                            x_27663 = ((__global\n                                        float *) group_res_arr_mem_29907)[index_of_group_res_29938 *\n                                                                          segred_group_sizze_27658];\n                            \n                            float res_27664;\n                            \n                            res_27664 = x_27662 + x_27663;\n                            x_27662 = res_27664;\n                        }\n                    }\n                }\n                ((__local\n                  float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912)] =\n                    x_27662;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_29939;\n                    int32_t skip_waves_29940;\n                    \n                    skip_waves_29940 = 1;\n                    \n                    float x_29927;\n                    float x_29928;\n                    \n                    offset_29939 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_29912,\n                                  sext_i64_i32(segred_gr",
                   "oup_sizze_27658))) {\n                            x_29927 = ((__local\n                                        float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912 +\n                                                                    offset_29939)];\n                        }\n                    }\n                    offset_29939 = 1;\n                    while (slt32(offset_29939, wave_sizze_29914)) {\n                        if (slt32(local_tid_29912 + offset_29939,\n                                  sext_i64_i32(segred_group_sizze_27658)) &&\n                            ((local_tid_29912 - squot32(local_tid_29912,\n                                                        wave_sizze_29914) *\n                              wave_sizze_29914) & (2 * offset_29939 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_29928 = ((volatile __local\n                                            float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912 +\n                                                                        offset_29939)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_29929 = x_29927 + x_29928;\n                                \n                                x_29927 = res_29929;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912)] =\n                                    x_29927;\n                            }\n                        }\n                        offset_29939 *= 2;\n                    }\n                    while (slt32(skip_waves_29940,\n                                 squot32(sext_i64_i32(segred_group_sizze_27658) +\n                          ",
                   "               wave_sizze_29914 - 1,\n                                         wave_sizze_29914))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_29939 = skip_waves_29940 * wave_sizze_29914;\n                        if (slt32(local_tid_29912 + offset_29939,\n                                  sext_i64_i32(segred_group_sizze_27658)) &&\n                            ((local_tid_29912 - squot32(local_tid_29912,\n                                                        wave_sizze_29914) *\n                              wave_sizze_29914) == 0 &&\n                             (squot32(local_tid_29912, wave_sizze_29914) & (2 *\n                                                                            skip_waves_29940 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_29928 = ((__local\n                                            float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912 +\n                                                                        offset_29939)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_29929 = x_29927 + x_29928;\n                                \n                                x_29927 = res_29929;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912)] =\n                                    x_29927;\n                            }\n                        }\n                        skip_waves_29940 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        ",
                   "if (local_tid_29912 == 0) {\n                            ((__global float *) mem_29019)[gtid_27599] =\n                                x_29927;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27658\n}\n__kernel void mainzisegred_large_29517(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_29555_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_29553_backing_aligned_1,\n                                       int64_t res_25889,\n                                       int64_t num_groups_27441, __global\n                                       unsigned char *mem_28980,\n                                       int32_t num_subhistos_29431, __global\n                                       unsigned char *res_subhistos_mem_29432,\n                                       int64_t groups_per_segment_29539,\n                                       int64_t elements_per_thread_29540,\n                                       int64_t virt_num_groups_29541,\n                                       int64_t threads_per_segment_29543,\n                                       __global\n                                       unsigned char *group_res_arr_mem_29544,\n                                       __global\n                                       unsigned char *mainzicounter_mem_29546)\n{\n    #define seghist_group_sizze_27439 (mainziseghist_group_sizze_27438)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_29555_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_29555_backing_aligned_0;\n    __local volatile char *restr",
                   "ict red_arr_mem_29553_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_29553_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29548;\n    int32_t local_tid_29549;\n    int64_t group_sizze_29552;\n    int32_t wave_sizze_29551;\n    int32_t group_tid_29550;\n    \n    global_tid_29548 = get_global_id(0);\n    local_tid_29549 = get_local_id(0);\n    group_sizze_29552 = get_local_size(0);\n    wave_sizze_29551 = LOCKSTEP_WIDTH;\n    group_tid_29550 = get_group_id(0);\n    \n    int32_t flat_gtid_29517;\n    \n    flat_gtid_29517 = global_tid_29548;\n    \n    __local char *red_arr_mem_29553;\n    \n    red_arr_mem_29553 = (__local char *) red_arr_mem_29553_backing_0;\n    \n    __local char *sync_arr_mem_29555;\n    \n    sync_arr_mem_29555 = (__local char *) sync_arr_mem_29555_backing_1;\n    \n    int32_t phys_group_id_29557;\n    \n    phys_group_id_29557 = get_group_id(0);\n    for (int32_t i_29558 = 0; i_29558 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_29541) - phys_group_id_29557,\n                   sext_i64_i32(num_groups_27441)); i_29558++) {\n        int32_t virt_group_id_29559 = phys_group_id_29557 + i_29558 *\n                sext_i64_i32(num_groups_27441);\n        int32_t flat_segment_id_29560 = squot32(virt_group_id_29559,\n                                                sext_i64_i32(groups_per_segment_29539));\n        int64_t global_tid_29561 = srem64(sext_i32_i64(virt_group_id_29559) *\n                                          seghist_group_sizze_27439 +\n                                          sext_i32_i64(local_tid_29549),\n                                          seghist_group_sizze_27439 *\n                                          groups_per_segment_29539);\n        int64_t bucket_id_29515 = sext_i32_i64(flat_segment_id_29560);\n        int64_t subhistogram_id_29516;\n        int64_t x_acc_29562;\n        int64_t chunk_sizze_29563;\n        \n        chunk_sizze_29563 = smin64(",
                   "elements_per_thread_29540,\n                                   sdiv_up64(num_subhistos_29431 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_29561)),\n                                             threads_per_segment_29543));\n        \n        int64_t x_27445;\n        int64_t x_27446;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_29562 = 0;\n        }\n        for (int64_t i_29567 = 0; i_29567 < chunk_sizze_29563; i_29567++) {\n            subhistogram_id_29516 =\n                sext_i32_i64(sext_i64_i32(global_tid_29561)) +\n                threads_per_segment_29543 * i_29567;\n            // apply map function\n            {\n                // load accumulator\n                {\n                    x_27445 = x_acc_29562;\n                }\n                // load new values\n                {\n                    x_27446 = ((__global\n                                int64_t *) res_subhistos_mem_29432)[subhistogram_id_29516 *\n                                                                    res_25889 +\n                                                                    bucket_id_29515];\n                }\n                // apply reduction operator\n                {\n                    int64_t res_27447 = smax64(x_27445, x_27446);\n                    \n                    // store in accumulator\n                    {\n                        x_acc_29562 = res_27447;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_27445 = x_acc_29562;\n            ((__local\n              int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549)] =\n                x_27445;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_29568;\n        int32_t skip_waves_29569;\n        \n        skip_waves_29569 = 1;\n        \n        int64_t x_29564;\n        int64_t x_29565;\n        \n        offset_29568 =",
                   " 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_29549,\n                      sext_i64_i32(seghist_group_sizze_27439))) {\n                x_29564 = ((__local\n                            int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549 +\n                                                          offset_29568)];\n            }\n        }\n        offset_29568 = 1;\n        while (slt32(offset_29568, wave_sizze_29551)) {\n            if (slt32(local_tid_29549 + offset_29568,\n                      sext_i64_i32(seghist_group_sizze_27439)) &&\n                ((local_tid_29549 - squot32(local_tid_29549, wave_sizze_29551) *\n                  wave_sizze_29551) & (2 * offset_29568 - 1)) == 0) {\n                // read array element\n                {\n                    x_29565 = ((volatile __local\n                                int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549 +\n                                                              offset_29568)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_29566 = smax64(x_29564, x_29565);\n                    \n                    x_29564 = res_29566;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549)] =\n                        x_29564;\n                }\n            }\n            offset_29568 *= 2;\n        }\n        while (slt32(skip_waves_29569,\n                     squot32(sext_i64_i32(seghist_group_sizze_27439) +\n                             wave_sizze_29551 - 1, wave_sizze_29551))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_29568 = skip_waves_29569 * wave_sizze_29551;\n            if (slt32(local_tid_29549 + offset_29568,\n                      sext_i64_i32(seghist_group_sizze_27439)) &&\n                ((local_tid_29549 - squot3",
                   "2(local_tid_29549, wave_sizze_29551) *\n                  wave_sizze_29551) == 0 && (squot32(local_tid_29549,\n                                                     wave_sizze_29551) & (2 *\n                                                                          skip_waves_29569 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_29565 = ((__local\n                                int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549 +\n                                                              offset_29568)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_29566 = smax64(x_29564, x_29565);\n                    \n                    x_29564 = res_29566;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549)] =\n                        x_29564;\n                }\n            }\n            skip_waves_29569 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_29549) == 0) {\n                x_acc_29562 = x_29564;\n            }\n        }\n        if (groups_per_segment_29539 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_29549 == 0) {\n                    ((__global int64_t *) mem_28980)[bucket_id_29515] =\n                        x_acc_29562;\n                }\n            }\n        } else {\n            int32_t old_counter_29570;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_29549 == 0) {\n                    ((__global\n                      int64_t *) group_res_arr_mem_29544)[sext_i32_i64(v",
                   "irt_group_id_29559) *\n                                                          seghist_group_sizze_27439] =\n                        x_acc_29562;\n                    mem_fence_global();\n                    old_counter_29570 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_29546)[sext_i32_i64(srem32(flat_segment_id_29560,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_29555)[0] =\n                        old_counter_29570 == groups_per_segment_29539 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_29571;\n            \n            is_last_group_29571 = ((__local bool *) sync_arr_mem_29555)[0];\n            if (is_last_group_29571) {\n                if (local_tid_29549 == 0) {\n                    old_counter_29570 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) mainzicounter_mem_29546)[sext_i32_i64(srem32(flat_segment_id_29560,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_29539));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_29572 =\n                            sdiv_up64(groups_per_segment_29539,\n                                      seghist_group_sizze_27439);\n                    \n                    x_27445 = 0;\n                    for (int64_t i_29573 = 0; i_29573 < read_per_thread_29572;\n                         i_29573++) {\n                        int64_t group_re",
                   "s_id_29574 =\n                                sext_i32_i64(local_tid_29549) *\n                                read_per_thread_29572 + i_29573;\n                        int64_t index_of_group_res_29575 =\n                                sext_i32_i64(flat_segment_id_29560) *\n                                groups_per_segment_29539 + group_res_id_29574;\n                        \n                        if (slt64(group_res_id_29574,\n                                  groups_per_segment_29539)) {\n                            x_27446 = ((__global\n                                        int64_t *) group_res_arr_mem_29544)[index_of_group_res_29575 *\n                                                                            seghist_group_sizze_27439];\n                            \n                            int64_t res_27447;\n                            \n                            res_27447 = smax64(x_27445, x_27446);\n                            x_27445 = res_27447;\n                        }\n                    }\n                }\n                ((__local\n                  int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549)] =\n                    x_27445;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_29576;\n                    int32_t skip_waves_29577;\n                    \n                    skip_waves_29577 = 1;\n                    \n                    int64_t x_29564;\n                    int64_t x_29565;\n                    \n                    offset_29576 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_29549,\n                                  sext_i64_i32(seghist_group_sizze_27439))) {\n                            x_29564 = ((__local\n                                        int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549 +\n                                           ",
                   "                           offset_29576)];\n                        }\n                    }\n                    offset_29576 = 1;\n                    while (slt32(offset_29576, wave_sizze_29551)) {\n                        if (slt32(local_tid_29549 + offset_29576,\n                                  sext_i64_i32(seghist_group_sizze_27439)) &&\n                            ((local_tid_29549 - squot32(local_tid_29549,\n                                                        wave_sizze_29551) *\n                              wave_sizze_29551) & (2 * offset_29576 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_29565 = ((volatile __local\n                                            int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549 +\n                                                                          offset_29576)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_29566 = smax64(x_29564, x_29565);\n                                \n                                x_29564 = res_29566;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549)] =\n                                    x_29564;\n                            }\n                        }\n                        offset_29576 *= 2;\n                    }\n                    while (slt32(skip_waves_29577,\n                                 squot32(sext_i64_i32(seghist_group_sizze_27439) +\n                                         wave_sizze_29551 - 1,\n                                         wave_sizze_29551))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_29576 =",
                   " skip_waves_29577 * wave_sizze_29551;\n                        if (slt32(local_tid_29549 + offset_29576,\n                                  sext_i64_i32(seghist_group_sizze_27439)) &&\n                            ((local_tid_29549 - squot32(local_tid_29549,\n                                                        wave_sizze_29551) *\n                              wave_sizze_29551) == 0 &&\n                             (squot32(local_tid_29549, wave_sizze_29551) & (2 *\n                                                                            skip_waves_29577 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_29565 = ((__local\n                                            int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549 +\n                                                                          offset_29576)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_29566 = smax64(x_29564, x_29565);\n                                \n                                x_29564 = res_29566;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549)] =\n                                    x_29564;\n                            }\n                        }\n                        skip_waves_29577 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_29549 == 0) {\n                            ((__global int64_t *) mem_28980)[bucket_id_29515] =\n                                x_29564;\n                        }\n ",
                   "                   }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_27439\n}\n__kernel void mainzisegred_nonseg_26582(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29219_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29217_backing_aligned_1,\n                                        int64_t n_25418,\n                                        int64_t num_groups_26577, __global\n                                        unsigned char *swap_term_mem_28878,\n                                        __global\n                                        unsigned char *payments_mem_28879,\n                                        __global unsigned char *mem_28883,\n                                        __global\n                                        unsigned char *mainzicounter_mem_29207,\n                                        __global\n                                        unsigned char *group_res_arr_mem_29209,\n                                        int64_t num_threads_29211)\n{\n    #define segred_group_sizze_26575 (mainzisegred_group_sizze_26574)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29219_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_29219_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_29217_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29217_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29212;\n    int32_t local_tid_29213;\n    int64_t group_sizze_29216;\n    int32_t wave_sizze_29215;\n    i",
                   "nt32_t group_tid_29214;\n    \n    global_tid_29212 = get_global_id(0);\n    local_tid_29213 = get_local_id(0);\n    group_sizze_29216 = get_local_size(0);\n    wave_sizze_29215 = LOCKSTEP_WIDTH;\n    group_tid_29214 = get_group_id(0);\n    \n    int32_t phys_tid_26582;\n    \n    phys_tid_26582 = global_tid_29212;\n    \n    __local char *sync_arr_mem_29217;\n    \n    sync_arr_mem_29217 = (__local char *) sync_arr_mem_29217_backing_0;\n    \n    __local char *red_arr_mem_29219;\n    \n    red_arr_mem_29219 = (__local char *) red_arr_mem_29219_backing_1;\n    \n    int64_t dummy_26580;\n    \n    dummy_26580 = 0;\n    \n    int64_t gtid_26581;\n    \n    gtid_26581 = 0;\n    \n    float x_acc_29221;\n    int64_t chunk_sizze_29222;\n    \n    chunk_sizze_29222 = smin64(sdiv_up64(n_25418,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_26575 *\n                                         num_groups_26577))),\n                               sdiv_up64(n_25418 - sext_i32_i64(phys_tid_26582),\n                                         num_threads_29211));\n    \n    float x_25436;\n    float x_25437;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29221 = -INFINITY;\n    }\n    for (int64_t i_29226 = 0; i_29226 < chunk_sizze_29222; i_29226++) {\n        gtid_26581 = sext_i32_i64(phys_tid_26582) + num_threads_29211 * i_29226;\n        // apply map function\n        {\n            float x_25439 = ((__global\n                              float *) swap_term_mem_28878)[gtid_26581];\n            int64_t x_25440 = ((__global\n                                int64_t *) payments_mem_28879)[gtid_26581];\n            float res_25441 = sitofp_i64_f32(x_25440);\n            float res_25442 = x_25439 * res_25441;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_25436 = x_acc_29221;\n            }\n            // load new values\n            {\n                x_25437 = res_25442;\n            }\n         ",
                   "   // apply reduction operator\n            {\n                float res_25438 = fmax32(x_25436, x_25437);\n                \n                // store in accumulator\n                {\n                    x_acc_29221 = res_25438;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_25436 = x_acc_29221;\n        ((__local float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29213)] =\n            x_25436;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29227;\n    int32_t skip_waves_29228;\n    \n    skip_waves_29228 = 1;\n    \n    float x_29223;\n    float x_29224;\n    \n    offset_29227 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29213, sext_i64_i32(segred_group_sizze_26575))) {\n            x_29223 = ((__local\n                        float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29213 +\n                                                    offset_29227)];\n        }\n    }\n    offset_29227 = 1;\n    while (slt32(offset_29227, wave_sizze_29215)) {\n        if (slt32(local_tid_29213 + offset_29227,\n                  sext_i64_i32(segred_group_sizze_26575)) && ((local_tid_29213 -\n                                                               squot32(local_tid_29213,\n                                                                       wave_sizze_29215) *\n                                                               wave_sizze_29215) &\n                                                              (2 *\n                                                               offset_29227 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_29224 = ((volatile __local\n                            float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29213 +\n                                                        offset_29227)];\n            }\n            // apply reduction op",
                   "eration\n            {\n                float res_29225 = fmax32(x_29223, x_29224);\n                \n                x_29223 = res_29225;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29213)] =\n                    x_29223;\n            }\n        }\n        offset_29227 *= 2;\n    }\n    while (slt32(skip_waves_29228,\n                 squot32(sext_i64_i32(segred_group_sizze_26575) +\n                         wave_sizze_29215 - 1, wave_sizze_29215))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29227 = skip_waves_29228 * wave_sizze_29215;\n        if (slt32(local_tid_29213 + offset_29227,\n                  sext_i64_i32(segred_group_sizze_26575)) && ((local_tid_29213 -\n                                                               squot32(local_tid_29213,\n                                                                       wave_sizze_29215) *\n                                                               wave_sizze_29215) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29213,\n                                                                       wave_sizze_29215) &\n                                                               (2 *\n                                                                skip_waves_29228 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_29224 = ((__local\n                            float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29213 +\n                                                        offset_29227)];\n            }\n            // apply reduction operation\n            {\n                float res_29225 = fmax32(x_29223, x_29224);\n                \n                x_29223 = res_29225;\n            }\n            // writ",
                   "e result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29213)] =\n                    x_29223;\n            }\n        }\n        skip_waves_29228 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29213) == 0) {\n            x_acc_29221 = x_29223;\n        }\n    }\n    \n    int32_t old_counter_29229;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29213 == 0) {\n            ((__global\n              float *) group_res_arr_mem_29209)[sext_i32_i64(group_tid_29214) *\n                                                segred_group_sizze_26575] =\n                x_acc_29221;\n            mem_fence_global();\n            old_counter_29229 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29207)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29217)[0] = old_counter_29229 ==\n                num_groups_26577 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29230;\n    \n    is_last_group_29230 = ((__local bool *) sync_arr_mem_29217)[0];\n    if (is_last_group_29230) {\n        if (local_tid_29213 == 0) {\n            old_counter_29229 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29207)[0],\n                                                      (int) (0 -\n                                                             num_groups_26577));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29231 = sdiv_up64(num_groups_26577,\n                                                      segred_group_sizze_26575);\n            \n            x_25436 = -INFINITY;\n            for (int",
                   "64_t i_29232 = 0; i_29232 < read_per_thread_29231;\n                 i_29232++) {\n                int64_t group_res_id_29233 = sext_i32_i64(local_tid_29213) *\n                        read_per_thread_29231 + i_29232;\n                int64_t index_of_group_res_29234 = group_res_id_29233;\n                \n                if (slt64(group_res_id_29233, num_groups_26577)) {\n                    x_25437 = ((__global\n                                float *) group_res_arr_mem_29209)[index_of_group_res_29234 *\n                                                                  segred_group_sizze_26575];\n                    \n                    float res_25438;\n                    \n                    res_25438 = fmax32(x_25436, x_25437);\n                    x_25436 = res_25438;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29213)] =\n            x_25436;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29235;\n            int32_t skip_waves_29236;\n            \n            skip_waves_29236 = 1;\n            \n            float x_29223;\n            float x_29224;\n            \n            offset_29235 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29213,\n                          sext_i64_i32(segred_group_sizze_26575))) {\n                    x_29223 = ((__local\n                                float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29213 +\n                                                            offset_29235)];\n                }\n            }\n            offset_29235 = 1;\n            while (slt32(offset_29235, wave_sizze_29215)) {\n                if (slt32(local_tid_29213 + offset_29235,\n                          sext_i64_i32(segred_group_sizze_26575)) &&\n                    ((local_tid_29213 - squot32(local_tid_29213,\n                                                wave_sizz",
                   "e_29215) *\n                      wave_sizze_29215) & (2 * offset_29235 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_29224 = ((volatile __local\n                                    float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29213 +\n                                                                offset_29235)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29225 = fmax32(x_29223, x_29224);\n                        \n                        x_29223 = res_29225;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29213)] =\n                            x_29223;\n                    }\n                }\n                offset_29235 *= 2;\n            }\n            while (slt32(skip_waves_29236,\n                         squot32(sext_i64_i32(segred_group_sizze_26575) +\n                                 wave_sizze_29215 - 1, wave_sizze_29215))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29235 = skip_waves_29236 * wave_sizze_29215;\n                if (slt32(local_tid_29213 + offset_29235,\n                          sext_i64_i32(segred_group_sizze_26575)) &&\n                    ((local_tid_29213 - squot32(local_tid_29213,\n                                                wave_sizze_29215) *\n                      wave_sizze_29215) == 0 && (squot32(local_tid_29213,\n                                                         wave_sizze_29215) &\n                                                 (2 * skip_waves_29236 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_29224 = ((__local\n                                    float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29213 +\n              ",
                   "                                                  offset_29235)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29225 = fmax32(x_29223, x_29224);\n                        \n                        x_29223 = res_29225;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_29219)[sext_i32_i64(local_tid_29213)] =\n                            x_29223;\n                    }\n                }\n                skip_waves_29236 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29213 == 0) {\n                    ((__global float *) mem_28883)[0] = x_29223;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_26575\n}\n__kernel void mainzisegred_nonseg_27436(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29404_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29402_backing_aligned_1,\n                                        int64_t flat_dim_25607,\n                                        int64_t num_groups_27431, __global\n                                        unsigned char *mem_28975, __global\n                                        unsigned char *mem_28978, __global\n                                        unsigned char *mainzicounter_mem_29392,\n                                        __global\n                                        unsigned char *group_res_arr_mem_29394,\n                                        int64_t num_threads_29396)\n{\n    #define segred_group_sizze_27429 (mainzisegred_group_sizze_27428)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    con",
                   "st int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29404_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_29404_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_29402_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29402_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29397;\n    int32_t local_tid_29398;\n    int64_t group_sizze_29401;\n    int32_t wave_sizze_29400;\n    int32_t group_tid_29399;\n    \n    global_tid_29397 = get_global_id(0);\n    local_tid_29398 = get_local_id(0);\n    group_sizze_29401 = get_local_size(0);\n    wave_sizze_29400 = LOCKSTEP_WIDTH;\n    group_tid_29399 = get_group_id(0);\n    \n    int32_t phys_tid_27436;\n    \n    phys_tid_27436 = global_tid_29397;\n    \n    __local char *sync_arr_mem_29402;\n    \n    sync_arr_mem_29402 = (__local char *) sync_arr_mem_29402_backing_0;\n    \n    __local char *red_arr_mem_29404;\n    \n    red_arr_mem_29404 = (__local char *) red_arr_mem_29404_backing_1;\n    \n    int64_t dummy_27434;\n    \n    dummy_27434 = 0;\n    \n    int64_t gtid_27435;\n    \n    gtid_27435 = 0;\n    \n    int64_t x_acc_29406;\n    int64_t chunk_sizze_29407;\n    \n    chunk_sizze_29407 = smin64(sdiv_up64(flat_dim_25607,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_27429 *\n                                         num_groups_27431))),\n                               sdiv_up64(flat_dim_25607 -\n                                         sext_i32_i64(phys_tid_27436),\n                                         num_threads_29396));\n    \n    int64_t x_25890;\n    int64_t x_25891;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29406 = 0;\n    }\n    for (int64_t i_29411 = 0; i_29411 < chunk_sizze_29407; i_29411++) {\n        gtid_27435 = sext_i32_i64(phys_tid_27436) + num_threads_29396 * i_29411;\n        // apply map ",
                   "function\n        {\n            int64_t x_25893 = ((__global int64_t *) mem_28975)[gtid_27435];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_25890 = x_acc_29406;\n            }\n            // load new values\n            {\n                x_25891 = x_25893;\n            }\n            // apply reduction operator\n            {\n                int64_t res_25892 = add64(x_25890, x_25891);\n                \n                // store in accumulator\n                {\n                    x_acc_29406 = res_25892;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_25890 = x_acc_29406;\n        ((__local int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398)] =\n            x_25890;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29412;\n    int32_t skip_waves_29413;\n    \n    skip_waves_29413 = 1;\n    \n    int64_t x_29408;\n    int64_t x_29409;\n    \n    offset_29412 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29398, sext_i64_i32(segred_group_sizze_27429))) {\n            x_29408 = ((__local\n                        int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398 +\n                                                      offset_29412)];\n        }\n    }\n    offset_29412 = 1;\n    while (slt32(offset_29412, wave_sizze_29400)) {\n        if (slt32(local_tid_29398 + offset_29412,\n                  sext_i64_i32(segred_group_sizze_27429)) && ((local_tid_29398 -\n                                                               squot32(local_tid_29398,\n                                                                       wave_sizze_29400) *\n                                                               wave_sizze_29400) &\n                                                              (2 *\n                                                               offset_29412 -\n ",
                   "                                                              1)) == 0) {\n            // read array element\n            {\n                x_29409 = ((volatile __local\n                            int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398 +\n                                                          offset_29412)];\n            }\n            // apply reduction operation\n            {\n                int64_t res_29410 = add64(x_29408, x_29409);\n                \n                x_29408 = res_29410;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398)] =\n                    x_29408;\n            }\n        }\n        offset_29412 *= 2;\n    }\n    while (slt32(skip_waves_29413,\n                 squot32(sext_i64_i32(segred_group_sizze_27429) +\n                         wave_sizze_29400 - 1, wave_sizze_29400))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29412 = skip_waves_29413 * wave_sizze_29400;\n        if (slt32(local_tid_29398 + offset_29412,\n                  sext_i64_i32(segred_group_sizze_27429)) && ((local_tid_29398 -\n                                                               squot32(local_tid_29398,\n                                                                       wave_sizze_29400) *\n                                                               wave_sizze_29400) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29398,\n                                                                       wave_sizze_29400) &\n                                                               (2 *\n                                                                skip_waves_29413 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_29409 = ((__l",
                   "ocal\n                            int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398 +\n                                                          offset_29412)];\n            }\n            // apply reduction operation\n            {\n                int64_t res_29410 = add64(x_29408, x_29409);\n                \n                x_29408 = res_29410;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398)] =\n                    x_29408;\n            }\n        }\n        skip_waves_29413 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29398) == 0) {\n            x_acc_29406 = x_29408;\n        }\n    }\n    \n    int32_t old_counter_29414;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29398 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_29394)[sext_i32_i64(group_tid_29399) *\n                                                  segred_group_sizze_27429] =\n                x_acc_29406;\n            mem_fence_global();\n            old_counter_29414 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29392)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29402)[0] = old_counter_29414 ==\n                num_groups_27431 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29415;\n    \n    is_last_group_29415 = ((__local bool *) sync_arr_mem_29402)[0];\n    if (is_last_group_29415) {\n        if (local_tid_29398 == 0) {\n            old_counter_29414 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29392)[0],\n                                   ",
                   "                   (int) (0 -\n                                                             num_groups_27431));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29416 = sdiv_up64(num_groups_27431,\n                                                      segred_group_sizze_27429);\n            \n            x_25890 = 0;\n            for (int64_t i_29417 = 0; i_29417 < read_per_thread_29416;\n                 i_29417++) {\n                int64_t group_res_id_29418 = sext_i32_i64(local_tid_29398) *\n                        read_per_thread_29416 + i_29417;\n                int64_t index_of_group_res_29419 = group_res_id_29418;\n                \n                if (slt64(group_res_id_29418, num_groups_27431)) {\n                    x_25891 = ((__global\n                                int64_t *) group_res_arr_mem_29394)[index_of_group_res_29419 *\n                                                                    segred_group_sizze_27429];\n                    \n                    int64_t res_25892;\n                    \n                    res_25892 = add64(x_25890, x_25891);\n                    x_25890 = res_25892;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398)] =\n            x_25890;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29420;\n            int32_t skip_waves_29421;\n            \n            skip_waves_29421 = 1;\n            \n            int64_t x_29408;\n            int64_t x_29409;\n            \n            offset_29420 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29398,\n                          sext_i64_i32(segred_group_sizze_27429))) {\n                    x_29408 = ((__local\n                                int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398 +\n                                                   ",
                   "           offset_29420)];\n                }\n            }\n            offset_29420 = 1;\n            while (slt32(offset_29420, wave_sizze_29400)) {\n                if (slt32(local_tid_29398 + offset_29420,\n                          sext_i64_i32(segred_group_sizze_27429)) &&\n                    ((local_tid_29398 - squot32(local_tid_29398,\n                                                wave_sizze_29400) *\n                      wave_sizze_29400) & (2 * offset_29420 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_29409 = ((volatile __local\n                                    int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398 +\n                                                                  offset_29420)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_29410 = add64(x_29408, x_29409);\n                        \n                        x_29408 = res_29410;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398)] =\n                            x_29408;\n                    }\n                }\n                offset_29420 *= 2;\n            }\n            while (slt32(skip_waves_29421,\n                         squot32(sext_i64_i32(segred_group_sizze_27429) +\n                                 wave_sizze_29400 - 1, wave_sizze_29400))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29420 = skip_waves_29421 * wave_sizze_29400;\n                if (slt32(local_tid_29398 + offset_29420,\n                          sext_i64_i32(segred_group_sizze_27429)) &&\n                    ((local_tid_29398 - squot32(local_tid_29398,\n                                                wave_sizze_29400) *\n                      wave_sizze_29400) == 0 && (squot32(local_tid_293",
                   "98,\n                                                         wave_sizze_29400) &\n                                                 (2 * skip_waves_29421 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_29409 = ((__local\n                                    int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398 +\n                                                                  offset_29420)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_29410 = add64(x_29408, x_29409);\n                        \n                        x_29408 = res_29410;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398)] =\n                            x_29408;\n                    }\n                }\n                skip_waves_29421 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29398 == 0) {\n                    ((__global int64_t *) mem_28978)[0] = x_29408;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27429\n}\n__kernel void mainzisegred_nonseg_27545(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29856_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29854_backing_aligned_1,\n                                        int64_t n_25418, int64_t paths_25421,\n                                        int64_t num_groups_27548, __global\n                                        unsigned char *mem_29007, __global\n                                        unsigned char *mem_29010, _",
                   "_global\n                                        unsigned char *mainzicounter_mem_29844,\n                                        __global\n                                        unsigned char *group_res_arr_mem_29846,\n                                        int64_t num_threads_29848)\n{\n    #define segred_group_sizze_27547 (mainzisegred_group_sizze_27537)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29856_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_29856_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_29854_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29854_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29849;\n    int32_t local_tid_29850;\n    int64_t group_sizze_29853;\n    int32_t wave_sizze_29852;\n    int32_t group_tid_29851;\n    \n    global_tid_29849 = get_global_id(0);\n    local_tid_29850 = get_local_id(0);\n    group_sizze_29853 = get_local_size(0);\n    wave_sizze_29852 = LOCKSTEP_WIDTH;\n    group_tid_29851 = get_group_id(0);\n    \n    int32_t phys_tid_27545;\n    \n    phys_tid_27545 = global_tid_29849;\n    \n    __local char *sync_arr_mem_29854;\n    \n    sync_arr_mem_29854 = (__local char *) sync_arr_mem_29854_backing_0;\n    \n    __local char *red_arr_mem_29856;\n    \n    red_arr_mem_29856 = (__local char *) red_arr_mem_29856_backing_1;\n    \n    int64_t dummy_27543;\n    \n    dummy_27543 = 0;\n    \n    int64_t gtid_27544;\n    \n    gtid_27544 = 0;\n    \n    float x_acc_29858;\n    int64_t chunk_sizze_29859;\n    \n    chunk_sizze_29859 = smin64(sdiv_up64(paths_25421,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_27547 *\n                                         num_groups_27548))),\n                               sdiv_up64(paths_25421 -\n                   ",
                   "                      sext_i32_i64(phys_tid_27545),\n                                         num_threads_29848));\n    \n    float x_27551;\n    float x_27552;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29858 = 0.0F;\n    }\n    for (int64_t i_29863 = 0; i_29863 < chunk_sizze_29859; i_29863++) {\n        gtid_27544 = sext_i32_i64(phys_tid_27545) + num_threads_29848 * i_29863;\n        // apply map function\n        {\n            float res_27555;\n            float redout_28866 = 0.0F;\n            \n            for (int64_t i_28867 = 0; i_28867 < n_25418; i_28867++) {\n                float x_27559 = ((__global float *) mem_29007)[i_28867 *\n                                                               paths_25421 +\n                                                               gtid_27544];\n                float res_27558 = x_27559 + redout_28866;\n                float redout_tmp_29864 = res_27558;\n                \n                redout_28866 = redout_tmp_29864;\n            }\n            res_27555 = redout_28866;\n            \n            float res_27560 = fmax32(0.0F, res_27555);\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_27551 = x_acc_29858;\n            }\n            // load new values\n            {\n                x_27552 = res_27560;\n            }\n            // apply reduction operator\n            {\n                float res_27553 = x_27551 + x_27552;\n                \n                // store in accumulator\n                {\n                    x_acc_29858 = res_27553;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_27551 = x_acc_29858;\n        ((__local float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850)] =\n            x_27551;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29865;\n    int32_t skip_waves_29866;\n    \n    skip_waves_29866 = 1;\n    \n    float x_298",
                   "60;\n    float x_29861;\n    \n    offset_29865 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29850, sext_i64_i32(segred_group_sizze_27547))) {\n            x_29860 = ((__local\n                        float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850 +\n                                                    offset_29865)];\n        }\n    }\n    offset_29865 = 1;\n    while (slt32(offset_29865, wave_sizze_29852)) {\n        if (slt32(local_tid_29850 + offset_29865,\n                  sext_i64_i32(segred_group_sizze_27547)) && ((local_tid_29850 -\n                                                               squot32(local_tid_29850,\n                                                                       wave_sizze_29852) *\n                                                               wave_sizze_29852) &\n                                                              (2 *\n                                                               offset_29865 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_29861 = ((volatile __local\n                            float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850 +\n                                                        offset_29865)];\n            }\n            // apply reduction operation\n            {\n                float res_29862 = x_29860 + x_29861;\n                \n                x_29860 = res_29862;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850)] =\n                    x_29860;\n            }\n        }\n        offset_29865 *= 2;\n    }\n    while (slt32(skip_waves_29866,\n                 squot32(sext_i64_i32(segred_group_sizze_27547) +\n                         wave_sizze_29852 - 1, wave_sizze_29852))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29865 ",
                   "= skip_waves_29866 * wave_sizze_29852;\n        if (slt32(local_tid_29850 + offset_29865,\n                  sext_i64_i32(segred_group_sizze_27547)) && ((local_tid_29850 -\n                                                               squot32(local_tid_29850,\n                                                                       wave_sizze_29852) *\n                                                               wave_sizze_29852) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29850,\n                                                                       wave_sizze_29852) &\n                                                               (2 *\n                                                                skip_waves_29866 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_29861 = ((__local\n                            float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850 +\n                                                        offset_29865)];\n            }\n            // apply reduction operation\n            {\n                float res_29862 = x_29860 + x_29861;\n                \n                x_29860 = res_29862;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850)] =\n                    x_29860;\n            }\n        }\n        skip_waves_29866 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29850) == 0) {\n            x_acc_29858 = x_29860;\n        }\n    }\n    \n    int32_t old_counter_29867;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29850 == 0) {\n            ((__global\n              float *) group_res_arr_mem_29846",
                   ")[sext_i32_i64(group_tid_29851) *\n                                                segred_group_sizze_27547] =\n                x_acc_29858;\n            mem_fence_global();\n            old_counter_29867 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29844)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29854)[0] = old_counter_29867 ==\n                num_groups_27548 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29868;\n    \n    is_last_group_29868 = ((__local bool *) sync_arr_mem_29854)[0];\n    if (is_last_group_29868) {\n        if (local_tid_29850 == 0) {\n            old_counter_29867 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29844)[0],\n                                                      (int) (0 -\n                                                             num_groups_27548));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29869 = sdiv_up64(num_groups_27548,\n                                                      segred_group_sizze_27547);\n            \n            x_27551 = 0.0F;\n            for (int64_t i_29870 = 0; i_29870 < read_per_thread_29869;\n                 i_29870++) {\n                int64_t group_res_id_29871 = sext_i32_i64(local_tid_29850) *\n                        read_per_thread_29869 + i_29870;\n                int64_t index_of_group_res_29872 = group_res_id_29871;\n                \n                if (slt64(group_res_id_29871, num_groups_27548)) {\n                    x_27552 = ((__global\n                                float *) group_res_arr_mem_29846)[index_of_group_res_29872 *\n                                                                  segred_group_sizze_27547];\n                    \n                    float re",
                   "s_27553;\n                    \n                    res_27553 = x_27551 + x_27552;\n                    x_27551 = res_27553;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850)] =\n            x_27551;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29873;\n            int32_t skip_waves_29874;\n            \n            skip_waves_29874 = 1;\n            \n            float x_29860;\n            float x_29861;\n            \n            offset_29873 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29850,\n                          sext_i64_i32(segred_group_sizze_27547))) {\n                    x_29860 = ((__local\n                                float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850 +\n                                                            offset_29873)];\n                }\n            }\n            offset_29873 = 1;\n            while (slt32(offset_29873, wave_sizze_29852)) {\n                if (slt32(local_tid_29850 + offset_29873,\n                          sext_i64_i32(segred_group_sizze_27547)) &&\n                    ((local_tid_29850 - squot32(local_tid_29850,\n                                                wave_sizze_29852) *\n                      wave_sizze_29852) & (2 * offset_29873 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_29861 = ((volatile __local\n                                    float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850 +\n                                                                offset_29873)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29862 = x_29860 + x_29861;\n                        \n                        x_29860 = res_29862;\n                    }\n                    // write r",
                   "esult of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850)] =\n                            x_29860;\n                    }\n                }\n                offset_29873 *= 2;\n            }\n            while (slt32(skip_waves_29874,\n                         squot32(sext_i64_i32(segred_group_sizze_27547) +\n                                 wave_sizze_29852 - 1, wave_sizze_29852))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29873 = skip_waves_29874 * wave_sizze_29852;\n                if (slt32(local_tid_29850 + offset_29873,\n                          sext_i64_i32(segred_group_sizze_27547)) &&\n                    ((local_tid_29850 - squot32(local_tid_29850,\n                                                wave_sizze_29852) *\n                      wave_sizze_29852) == 0 && (squot32(local_tid_29850,\n                                                         wave_sizze_29852) &\n                                                 (2 * skip_waves_29874 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_29861 = ((__local\n                                    float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850 +\n                                                                offset_29873)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29862 = x_29860 + x_29861;\n                        \n                        x_29860 = res_29862;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850)] =\n                            x_29860;\n                    }\n                }\n                skip_waves_29874 *= 2;\n            }\n            // and back to",
                   " memory with the final result\n            {\n                if (local_tid_29850 == 0) {\n                    ((__global float *) mem_29010)[0] = x_29860;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27547\n}\n__kernel void mainzisegred_nonseg_27641(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29959_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29957_backing_aligned_1,\n                                        int64_t paths_25421,\n                                        int64_t num_groups_27676, __global\n                                        unsigned char *res_map_acc_mem_29023,\n                                        __global unsigned char *mem_29026,\n                                        __global\n                                        unsigned char *mainzicounter_mem_29947,\n                                        __global\n                                        unsigned char *group_res_arr_mem_29949,\n                                        int64_t num_threads_29951)\n{\n    #define segred_group_sizze_27675 (mainzisegred_group_sizze_27633)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29959_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_29959_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_29957_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29957_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29952;\n    int32_t local_tid_29953;\n    int64_t group_sizze_29956;\n    int32_t wave_sizze_29955;\n    int32_t group_tid_29954;\n    \n    global_tid_2995",
                   "2 = get_global_id(0);\n    local_tid_29953 = get_local_id(0);\n    group_sizze_29956 = get_local_size(0);\n    wave_sizze_29955 = LOCKSTEP_WIDTH;\n    group_tid_29954 = get_group_id(0);\n    \n    int32_t phys_tid_27641;\n    \n    phys_tid_27641 = global_tid_29952;\n    \n    __local char *sync_arr_mem_29957;\n    \n    sync_arr_mem_29957 = (__local char *) sync_arr_mem_29957_backing_0;\n    \n    __local char *red_arr_mem_29959;\n    \n    red_arr_mem_29959 = (__local char *) red_arr_mem_29959_backing_1;\n    \n    int64_t dummy_27639;\n    \n    dummy_27639 = 0;\n    \n    int64_t gtid_27640;\n    \n    gtid_27640 = 0;\n    \n    float x_acc_29961;\n    int64_t chunk_sizze_29962;\n    \n    chunk_sizze_29962 = smin64(sdiv_up64(paths_25421,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_27675 *\n                                         num_groups_27676))),\n                               sdiv_up64(paths_25421 -\n                                         sext_i32_i64(phys_tid_27641),\n                                         num_threads_29951));\n    \n    float x_27679;\n    float x_27680;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29961 = 0.0F;\n    }\n    for (int64_t i_29966 = 0; i_29966 < chunk_sizze_29962; i_29966++) {\n        gtid_27640 = sext_i32_i64(phys_tid_27641) + num_threads_29951 * i_29966;\n        // apply map function\n        {\n            float x_27682 = ((__global\n                              float *) res_map_acc_mem_29023)[gtid_27640];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_27679 = x_acc_29961;\n            }\n            // load new values\n            {\n                x_27680 = x_27682;\n            }\n            // apply reduction operator\n            {\n                float res_27681 = x_27679 + x_27680;\n                \n                // store in accumulator\n                {\n                    x_acc_29961 = res_27681;\n         ",
                   "       }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_27679 = x_acc_29961;\n        ((__local float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953)] =\n            x_27679;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29967;\n    int32_t skip_waves_29968;\n    \n    skip_waves_29968 = 1;\n    \n    float x_29963;\n    float x_29964;\n    \n    offset_29967 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29953, sext_i64_i32(segred_group_sizze_27675))) {\n            x_29963 = ((__local\n                        float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953 +\n                                                    offset_29967)];\n        }\n    }\n    offset_29967 = 1;\n    while (slt32(offset_29967, wave_sizze_29955)) {\n        if (slt32(local_tid_29953 + offset_29967,\n                  sext_i64_i32(segred_group_sizze_27675)) && ((local_tid_29953 -\n                                                               squot32(local_tid_29953,\n                                                                       wave_sizze_29955) *\n                                                               wave_sizze_29955) &\n                                                              (2 *\n                                                               offset_29967 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_29964 = ((volatile __local\n                            float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953 +\n                                                        offset_29967)];\n            }\n            // apply reduction operation\n            {\n                float res_29965 = x_29963 + x_29964;\n                \n                x_29963 = res_29965;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n ",
                   "                 float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953)] =\n                    x_29963;\n            }\n        }\n        offset_29967 *= 2;\n    }\n    while (slt32(skip_waves_29968,\n                 squot32(sext_i64_i32(segred_group_sizze_27675) +\n                         wave_sizze_29955 - 1, wave_sizze_29955))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29967 = skip_waves_29968 * wave_sizze_29955;\n        if (slt32(local_tid_29953 + offset_29967,\n                  sext_i64_i32(segred_group_sizze_27675)) && ((local_tid_29953 -\n                                                               squot32(local_tid_29953,\n                                                                       wave_sizze_29955) *\n                                                               wave_sizze_29955) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29953,\n                                                                       wave_sizze_29955) &\n                                                               (2 *\n                                                                skip_waves_29968 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_29964 = ((__local\n                            float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953 +\n                                                        offset_29967)];\n            }\n            // apply reduction operation\n            {\n                float res_29965 = x_29963 + x_29964;\n                \n                x_29963 = res_29965;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953)] =\n                    x_29963;\n            }\n        }\n        skip_waves_29968 *= 2;\n    }\n    barrier(CLK_L",
                   "OCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29953) == 0) {\n            x_acc_29961 = x_29963;\n        }\n    }\n    \n    int32_t old_counter_29969;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29953 == 0) {\n            ((__global\n              float *) group_res_arr_mem_29949)[sext_i32_i64(group_tid_29954) *\n                                                segred_group_sizze_27675] =\n                x_acc_29961;\n            mem_fence_global();\n            old_counter_29969 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29947)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29957)[0] = old_counter_29969 ==\n                num_groups_27676 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29970;\n    \n    is_last_group_29970 = ((__local bool *) sync_arr_mem_29957)[0];\n    if (is_last_group_29970) {\n        if (local_tid_29953 == 0) {\n            old_counter_29969 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29947)[0],\n                                                      (int) (0 -\n                                                             num_groups_27676));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29971 = sdiv_up64(num_groups_27676,\n                                                      segred_group_sizze_27675);\n            \n            x_27679 = 0.0F;\n            for (int64_t i_29972 = 0; i_29972 < read_per_thread_29971;\n                 i_29972++) {\n                int64_t group_res_id_29973 = sext_i32_i64(local_tid_29953) *\n                        read_per_thread_29971 + i_29972;\n                int64_t index_of_group",
                   "_res_29974 = group_res_id_29973;\n                \n                if (slt64(group_res_id_29973, num_groups_27676)) {\n                    x_27680 = ((__global\n                                float *) group_res_arr_mem_29949)[index_of_group_res_29974 *\n                                                                  segred_group_sizze_27675];\n                    \n                    float res_27681;\n                    \n                    res_27681 = x_27679 + x_27680;\n                    x_27679 = res_27681;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953)] =\n            x_27679;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29975;\n            int32_t skip_waves_29976;\n            \n            skip_waves_29976 = 1;\n            \n            float x_29963;\n            float x_29964;\n            \n            offset_29975 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29953,\n                          sext_i64_i32(segred_group_sizze_27675))) {\n                    x_29963 = ((__local\n                                float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953 +\n                                                            offset_29975)];\n                }\n            }\n            offset_29975 = 1;\n            while (slt32(offset_29975, wave_sizze_29955)) {\n                if (slt32(local_tid_29953 + offset_29975,\n                          sext_i64_i32(segred_group_sizze_27675)) &&\n                    ((local_tid_29953 - squot32(local_tid_29953,\n                                                wave_sizze_29955) *\n                      wave_sizze_29955) & (2 * offset_29975 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_29964 = ((volatile __local\n                                    float *) red_arr_mem_2",
                   "9959)[sext_i32_i64(local_tid_29953 +\n                                                                offset_29975)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29965 = x_29963 + x_29964;\n                        \n                        x_29963 = res_29965;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953)] =\n                            x_29963;\n                    }\n                }\n                offset_29975 *= 2;\n            }\n            while (slt32(skip_waves_29976,\n                         squot32(sext_i64_i32(segred_group_sizze_27675) +\n                                 wave_sizze_29955 - 1, wave_sizze_29955))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29975 = skip_waves_29976 * wave_sizze_29955;\n                if (slt32(local_tid_29953 + offset_29975,\n                          sext_i64_i32(segred_group_sizze_27675)) &&\n                    ((local_tid_29953 - squot32(local_tid_29953,\n                                                wave_sizze_29955) *\n                      wave_sizze_29955) == 0 && (squot32(local_tid_29953,\n                                                         wave_sizze_29955) &\n                                                 (2 * skip_waves_29976 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_29964 = ((__local\n                                    float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953 +\n                                                                offset_29975)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29965 = x_29963 + x_29964;\n                        \n                      ",
                   "  x_29963 = res_29965;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953)] =\n                            x_29963;\n                    }\n                }\n                skip_waves_29976 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29953 == 0) {\n                    ((__global float *) mem_29026)[0] = x_29963;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27675\n}\n__kernel void mainzisegred_nonseg_29056(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29249_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29247_backing_aligned_1,\n                                        int64_t n_25418, __global\n                                        unsigned char *payments_mem_28879,\n                                        __global unsigned char *mem_29068,\n                                        __global\n                                        unsigned char *mainzicounter_mem_29237,\n                                        __global\n                                        unsigned char *group_res_arr_mem_29239,\n                                        int64_t num_threads_29241)\n{\n    #define segred_num_groups_29050 (mainzisegred_num_groups_29049)\n    #define segred_group_sizze_29052 (mainzisegred_group_sizze_29051)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29249_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_29249_backing_aligned_0;\n    __local volatile char",
                   " *restrict sync_arr_mem_29247_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29247_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29242;\n    int32_t local_tid_29243;\n    int64_t group_sizze_29246;\n    int32_t wave_sizze_29245;\n    int32_t group_tid_29244;\n    \n    global_tid_29242 = get_global_id(0);\n    local_tid_29243 = get_local_id(0);\n    group_sizze_29246 = get_local_size(0);\n    wave_sizze_29245 = LOCKSTEP_WIDTH;\n    group_tid_29244 = get_group_id(0);\n    \n    int32_t phys_tid_29056;\n    \n    phys_tid_29056 = global_tid_29242;\n    \n    __local char *sync_arr_mem_29247;\n    \n    sync_arr_mem_29247 = (__local char *) sync_arr_mem_29247_backing_0;\n    \n    __local char *red_arr_mem_29249;\n    \n    red_arr_mem_29249 = (__local char *) red_arr_mem_29249_backing_1;\n    \n    int64_t dummy_29054;\n    \n    dummy_29054 = 0;\n    \n    int64_t gtid_29055;\n    \n    gtid_29055 = 0;\n    \n    int64_t x_acc_29251;\n    int64_t chunk_sizze_29252;\n    \n    chunk_sizze_29252 = smin64(sdiv_up64(n_25418,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_29052 *\n                                         segred_num_groups_29050))),\n                               sdiv_up64(n_25418 - sext_i32_i64(phys_tid_29056),\n                                         num_threads_29241));\n    \n    int64_t x_29057;\n    int64_t y_29058;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29251 = 0;\n    }\n    for (int64_t i_29256 = 0; i_29256 < chunk_sizze_29252; i_29256++) {\n        gtid_29055 = sext_i32_i64(phys_tid_29056) + num_threads_29241 * i_29256;\n        // apply map function\n        {\n            int64_t res_29061 = ((__global\n                                  int64_t *) payments_mem_28879)[gtid_29055];\n            int64_t bytes_29062 = 4 * res_29061;\n            \n            // save map-out results\n            { }\n            // load accu",
                   "mulator\n            {\n                x_29057 = x_acc_29251;\n            }\n            // load new values\n            {\n                y_29058 = bytes_29062;\n            }\n            // apply reduction operator\n            {\n                int64_t zz_29059 = smax64(x_29057, y_29058);\n                \n                // store in accumulator\n                {\n                    x_acc_29251 = zz_29059;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_29057 = x_acc_29251;\n        ((__local int64_t *) red_arr_mem_29249)[sext_i32_i64(local_tid_29243)] =\n            x_29057;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29257;\n    int32_t skip_waves_29258;\n    \n    skip_waves_29258 = 1;\n    \n    int64_t x_29253;\n    int64_t y_29254;\n    \n    offset_29257 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29243, sext_i64_i32(segred_group_sizze_29052))) {\n            x_29253 = ((__local\n                        int64_t *) red_arr_mem_29249)[sext_i32_i64(local_tid_29243 +\n                                                      offset_29257)];\n        }\n    }\n    offset_29257 = 1;\n    while (slt32(offset_29257, wave_sizze_29245)) {\n        if (slt32(local_tid_29243 + offset_29257,\n                  sext_i64_i32(segred_group_sizze_29052)) && ((local_tid_29243 -\n                                                               squot32(local_tid_29243,\n                                                                       wave_sizze_29245) *\n                                                               wave_sizze_29245) &\n                                                              (2 *\n                                                               offset_29257 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_29254 = ((volatile __local\n              ",
                   "              int64_t *) red_arr_mem_29249)[sext_i32_i64(local_tid_29243 +\n                                                          offset_29257)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_29255 = smax64(x_29253, y_29254);\n                \n                x_29253 = zz_29255;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_29249)[sext_i32_i64(local_tid_29243)] =\n                    x_29253;\n            }\n        }\n        offset_29257 *= 2;\n    }\n    while (slt32(skip_waves_29258,\n                 squot32(sext_i64_i32(segred_group_sizze_29052) +\n                         wave_sizze_29245 - 1, wave_sizze_29245))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29257 = skip_waves_29258 * wave_sizze_29245;\n        if (slt32(local_tid_29243 + offset_29257,\n                  sext_i64_i32(segred_group_sizze_29052)) && ((local_tid_29243 -\n                                                               squot32(local_tid_29243,\n                                                                       wave_sizze_29245) *\n                                                               wave_sizze_29245) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29243,\n                                                                       wave_sizze_29245) &\n                                                               (2 *\n                                                                skip_waves_29258 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                y_29254 = ((__local\n                            int64_t *) red_arr_mem_29249)[sext_i32_i64(local_tid_29243 +\n                                                          offset_29257)];\n            }\n",
                   "            // apply reduction operation\n            {\n                int64_t zz_29255 = smax64(x_29253, y_29254);\n                \n                x_29253 = zz_29255;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_29249)[sext_i32_i64(local_tid_29243)] =\n                    x_29253;\n            }\n        }\n        skip_waves_29258 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29243) == 0) {\n            x_acc_29251 = x_29253;\n        }\n    }\n    \n    int32_t old_counter_29259;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29243 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_29239)[sext_i32_i64(group_tid_29244) *\n                                                  segred_group_sizze_29052] =\n                x_acc_29251;\n            mem_fence_global();\n            old_counter_29259 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29237)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29247)[0] = old_counter_29259 ==\n                segred_num_groups_29050 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29260;\n    \n    is_last_group_29260 = ((__local bool *) sync_arr_mem_29247)[0];\n    if (is_last_group_29260) {\n        if (local_tid_29243 == 0) {\n            old_counter_29259 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29237)[0],\n                                                      (int) (0 -\n                                                             segred_num_groups_29050));\n        }\n        // read in the per-group-results\n       ",
                   " {\n            int64_t read_per_thread_29261 = sdiv_up64(segred_num_groups_29050,\n                                                      segred_group_sizze_29052);\n            \n            x_29057 = 0;\n            for (int64_t i_29262 = 0; i_29262 < read_per_thread_29261;\n                 i_29262++) {\n                int64_t group_res_id_29263 = sext_i32_i64(local_tid_29243) *\n                        read_per_thread_29261 + i_29262;\n                int64_t index_of_group_res_29264 = group_res_id_29263;\n                \n                if (slt64(group_res_id_29263, segred_num_groups_29050)) {\n                    y_29058 = ((__global\n                                int64_t *) group_res_arr_mem_29239)[index_of_group_res_29264 *\n                                                                    segred_group_sizze_29052];\n                    \n                    int64_t zz_29059;\n                    \n                    zz_29059 = smax64(x_29057, y_29058);\n                    x_29057 = zz_29059;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_29249)[sext_i32_i64(local_tid_29243)] =\n            x_29057;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29265;\n            int32_t skip_waves_29266;\n            \n            skip_waves_29266 = 1;\n            \n            int64_t x_29253;\n            int64_t y_29254;\n            \n            offset_29265 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29243,\n                          sext_i64_i32(segred_group_sizze_29052))) {\n                    x_29253 = ((__local\n                                int64_t *) red_arr_mem_29249)[sext_i32_i64(local_tid_29243 +\n                                                              offset_29265)];\n                }\n            }\n            offset_29265 = 1;\n            while (slt32(offset_29265, wave_sizze_29245)) {\n        ",
                   "        if (slt32(local_tid_29243 + offset_29265,\n                          sext_i64_i32(segred_group_sizze_29052)) &&\n                    ((local_tid_29243 - squot32(local_tid_29243,\n                                                wave_sizze_29245) *\n                      wave_sizze_29245) & (2 * offset_29265 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_29254 = ((volatile __local\n                                    int64_t *) red_arr_mem_29249)[sext_i32_i64(local_tid_29243 +\n                                                                  offset_29265)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_29255 = smax64(x_29253, y_29254);\n                        \n                        x_29253 = zz_29255;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29249)[sext_i32_i64(local_tid_29243)] =\n                            x_29253;\n                    }\n                }\n                offset_29265 *= 2;\n            }\n            while (slt32(skip_waves_29266,\n                         squot32(sext_i64_i32(segred_group_sizze_29052) +\n                                 wave_sizze_29245 - 1, wave_sizze_29245))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29265 = skip_waves_29266 * wave_sizze_29245;\n                if (slt32(local_tid_29243 + offset_29265,\n                          sext_i64_i32(segred_group_sizze_29052)) &&\n                    ((local_tid_29243 - squot32(local_tid_29243,\n                                                wave_sizze_29245) *\n                      wave_sizze_29245) == 0 && (squot32(local_tid_29243,\n                                                         wave_sizze_29245) &\n                                                 (2 * skip_waves_29266 - 1)) ",
                   "==\n                     0)) {\n                    // read array element\n                    {\n                        y_29254 = ((__local\n                                    int64_t *) red_arr_mem_29249)[sext_i32_i64(local_tid_29243 +\n                                                                  offset_29265)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_29255 = smax64(x_29253, y_29254);\n                        \n                        x_29253 = zz_29255;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_29249)[sext_i32_i64(local_tid_29243)] =\n                            x_29253;\n                    }\n                }\n                skip_waves_29266 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29243 == 0) {\n                    ((__global int64_t *) mem_29068)[0] = x_29253;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_29050\n    #undef segred_group_sizze_29052\n}\n__kernel void mainzisegred_nonseg_29088(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29286_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29284_backing_aligned_1,\n                                        int64_t n_25418, __global\n                                        unsigned char *payments_mem_28879,\n                                        __global unsigned char *mem_29100,\n                                        __global\n                                        unsigned char *mainzicounter_mem_29274,\n                                        __global\n                         ",
                   "               unsigned char *group_res_arr_mem_29276,\n                                        int64_t num_threads_29278)\n{\n    #define segred_num_groups_29082 (mainzisegred_num_groups_29081)\n    #define segred_group_sizze_29084 (mainzisegred_group_sizze_29083)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29286_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_29286_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_29284_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29284_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29279;\n    int32_t local_tid_29280;\n    int64_t group_sizze_29283;\n    int32_t wave_sizze_29282;\n    int32_t group_tid_29281;\n    \n    global_tid_29279 = get_global_id(0);\n    local_tid_29280 = get_local_id(0);\n    group_sizze_29283 = get_local_size(0);\n    wave_sizze_29282 = LOCKSTEP_WIDTH;\n    group_tid_29281 = get_group_id(0);\n    \n    int32_t phys_tid_29088;\n    \n    phys_tid_29088 = global_tid_29279;\n    \n    __local char *sync_arr_mem_29284;\n    \n    sync_arr_mem_29284 = (__local char *) sync_arr_mem_29284_backing_0;\n    \n    __local char *red_arr_mem_29286;\n    \n    red_arr_mem_29286 = (__local char *) red_arr_mem_29286_backing_1;\n    \n    int64_t dummy_29086;\n    \n    dummy_29086 = 0;\n    \n    int64_t gtid_29087;\n    \n    gtid_29087 = 0;\n    \n    int64_t x_acc_29288;\n    int64_t chunk_sizze_29289;\n    \n    chunk_sizze_29289 = smin64(sdiv_up64(n_25418,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_29084 *\n                                         segred_num_groups_29082))),\n                               sdiv_up64(n_25418 - sext_i32_i64(phys_tid_29088),\n                                         num_threads_29278));\n    \n    int64_t x_2",
                   "9089;\n    int64_t y_29090;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29288 = 0;\n    }\n    for (int64_t i_29293 = 0; i_29293 < chunk_sizze_29289; i_29293++) {\n        gtid_29087 = sext_i32_i64(phys_tid_29088) + num_threads_29278 * i_29293;\n        // apply map function\n        {\n            int64_t res_29093 = ((__global\n                                  int64_t *) payments_mem_28879)[gtid_29087];\n            int64_t bytes_29094 = 4 * res_29093;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_29089 = x_acc_29288;\n            }\n            // load new values\n            {\n                y_29090 = bytes_29094;\n            }\n            // apply reduction operator\n            {\n                int64_t zz_29091 = smax64(x_29089, y_29090);\n                \n                // store in accumulator\n                {\n                    x_acc_29288 = zz_29091;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_29089 = x_acc_29288;\n        ((__local int64_t *) red_arr_mem_29286)[sext_i32_i64(local_tid_29280)] =\n            x_29089;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29294;\n    int32_t skip_waves_29295;\n    \n    skip_waves_29295 = 1;\n    \n    int64_t x_29290;\n    int64_t y_29291;\n    \n    offset_29294 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29280, sext_i64_i32(segred_group_sizze_29084))) {\n            x_29290 = ((__local\n                        int64_t *) red_arr_mem_29286)[sext_i32_i64(local_tid_29280 +\n                                                      offset_29294)];\n        }\n    }\n    offset_29294 = 1;\n    while (slt32(offset_29294, wave_sizze_29282)) {\n        if (slt32(local_tid_29280 + offset_29294,\n                  sext_i64_i32(segred_group_sizze_29084)) && ((local_tid_29280 -\n                         ",
                   "                                      squot32(local_tid_29280,\n                                                                       wave_sizze_29282) *\n                                                               wave_sizze_29282) &\n                                                              (2 *\n                                                               offset_29294 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_29291 = ((volatile __local\n                            int64_t *) red_arr_mem_29286)[sext_i32_i64(local_tid_29280 +\n                                                          offset_29294)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_29292 = smax64(x_29290, y_29291);\n                \n                x_29290 = zz_29292;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_29286)[sext_i32_i64(local_tid_29280)] =\n                    x_29290;\n            }\n        }\n        offset_29294 *= 2;\n    }\n    while (slt32(skip_waves_29295,\n                 squot32(sext_i64_i32(segred_group_sizze_29084) +\n                         wave_sizze_29282 - 1, wave_sizze_29282))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29294 = skip_waves_29295 * wave_sizze_29282;\n        if (slt32(local_tid_29280 + offset_29294,\n                  sext_i64_i32(segred_group_sizze_29084)) && ((local_tid_29280 -\n                                                               squot32(local_tid_29280,\n                                                                       wave_sizze_29282) *\n                                                               wave_sizze_29282) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29280,\n                ",
                   "                                                       wave_sizze_29282) &\n                                                               (2 *\n                                                                skip_waves_29295 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                y_29291 = ((__local\n                            int64_t *) red_arr_mem_29286)[sext_i32_i64(local_tid_29280 +\n                                                          offset_29294)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_29292 = smax64(x_29290, y_29291);\n                \n                x_29290 = zz_29292;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_29286)[sext_i32_i64(local_tid_29280)] =\n                    x_29290;\n            }\n        }\n        skip_waves_29295 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29280) == 0) {\n            x_acc_29288 = x_29290;\n        }\n    }\n    \n    int32_t old_counter_29296;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29280 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_29276)[sext_i32_i64(group_tid_29281) *\n                                                  segred_group_sizze_29084] =\n                x_acc_29288;\n            mem_fence_global();\n            old_counter_29296 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29274)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29284)[0] = old_counter_29296 ==\n                segred_num_groups_29082 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_ME",
                   "M_FENCE);\n    \n    bool is_last_group_29297;\n    \n    is_last_group_29297 = ((__local bool *) sync_arr_mem_29284)[0];\n    if (is_last_group_29297) {\n        if (local_tid_29280 == 0) {\n            old_counter_29296 = atomic_add_i32_global(&((volatile __global\n                                                         int *) mainzicounter_mem_29274)[0],\n                                                      (int) (0 -\n                                                             segred_num_groups_29082));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29298 = sdiv_up64(segred_num_groups_29082,\n                                                      segred_group_sizze_29084);\n            \n            x_29089 = 0;\n            for (int64_t i_29299 = 0; i_29299 < read_per_thread_29298;\n                 i_29299++) {\n                int64_t group_res_id_29300 = sext_i32_i64(local_tid_29280) *\n                        read_per_thread_29298 + i_29299;\n                int64_t index_of_group_res_29301 = group_res_id_29300;\n                \n                if (slt64(group_res_id_29300, segred_num_groups_29082)) {\n                    y_29090 = ((__global\n                                int64_t *) group_res_arr_mem_29276)[index_of_group_res_29301 *\n                                                                    segred_group_sizze_29084];\n                    \n                    int64_t zz_29091;\n                    \n                    zz_29091 = smax64(x_29089, y_29090);\n                    x_29089 = zz_29091;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_29286)[sext_i32_i64(local_tid_29280)] =\n            x_29089;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29302;\n            int32_t skip_waves_29303;\n            \n            skip_waves_29303 = 1;\n            \n            int64_t x_29290;\n            int64_t y_29291;\n        ",
                   "    \n            offset_29302 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29280,\n                          sext_i64_i32(segred_group_sizze_29084))) {\n                    x_29290 = ((__local\n                                int64_t *) red_arr_mem_29286)[sext_i32_i64(local_tid_29280 +\n                                                              offset_29302)];\n                }\n            }\n            offset_29302 = 1;\n            while (slt32(offset_29302, wave_sizze_29282)) {\n                if (slt32(local_tid_29280 + offset_29302,\n                          sext_i64_i32(segred_group_sizze_29084)) &&\n                    ((local_tid_29280 - squot32(local_tid_29280,\n                                                wave_sizze_29282) *\n                      wave_sizze_29282) & (2 * offset_29302 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_29291 = ((volatile __local\n                                    int64_t *) red_arr_mem_29286)[sext_i32_i64(local_tid_29280 +\n                                                                  offset_29302)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_29292 = smax64(x_29290, y_29291);\n                        \n                        x_29290 = zz_29292;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29286)[sext_i32_i64(local_tid_29280)] =\n                            x_29290;\n                    }\n                }\n                offset_29302 *= 2;\n            }\n            while (slt32(skip_waves_29303,\n                         squot32(sext_i64_i32(segred_group_sizze_29084) +\n                                 wave_sizze_29282 - 1, wave_sizze_29282))) {\n                barrier(CLK_LOCAL_MEM_",
                   "FENCE);\n                offset_29302 = skip_waves_29303 * wave_sizze_29282;\n                if (slt32(local_tid_29280 + offset_29302,\n                          sext_i64_i32(segred_group_sizze_29084)) &&\n                    ((local_tid_29280 - squot32(local_tid_29280,\n                                                wave_sizze_29282) *\n                      wave_sizze_29282) == 0 && (squot32(local_tid_29280,\n                                                         wave_sizze_29282) &\n                                                 (2 * skip_waves_29303 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        y_29291 = ((__local\n                                    int64_t *) red_arr_mem_29286)[sext_i32_i64(local_tid_29280 +\n                                                                  offset_29302)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_29292 = smax64(x_29290, y_29291);\n                        \n                        x_29290 = zz_29292;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_29286)[sext_i32_i64(local_tid_29280)] =\n                            x_29290;\n                    }\n                }\n                skip_waves_29303 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29280 == 0) {\n                    ((__global int64_t *) mem_29100)[0] = x_29290;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_29082\n    #undef segred_group_sizze_29084\n}\n__kernel void mainzisegred_small_27608(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *red_arr_mem_29888_backing_aligned_0,\n  ",
                   "                                     int64_t n_25418, int64_t paths_25421,\n                                       int64_t num_groups_27659, __global\n                                       unsigned char *mem_29003, __global\n                                       unsigned char *mem_29019,\n                                       int64_t segment_sizze_nonzzero_29881)\n{\n    #define segred_group_sizze_27658 (mainzisegred_group_sizze_27602)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29888_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_29888_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29883;\n    int32_t local_tid_29884;\n    int64_t group_sizze_29887;\n    int32_t wave_sizze_29886;\n    int32_t group_tid_29885;\n    \n    global_tid_29883 = get_global_id(0);\n    local_tid_29884 = get_local_id(0);\n    group_sizze_29887 = get_local_size(0);\n    wave_sizze_29886 = LOCKSTEP_WIDTH;\n    group_tid_29885 = get_group_id(0);\n    \n    int32_t phys_tid_27608;\n    \n    phys_tid_27608 = global_tid_29883;\n    \n    __local char *red_arr_mem_29888;\n    \n    red_arr_mem_29888 = (__local char *) red_arr_mem_29888_backing_0;\n    \n    int32_t phys_group_id_29890;\n    \n    phys_group_id_29890 = get_group_id(0);\n    for (int32_t i_29891 = 0; i_29891 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(paths_25421,\n                                          squot64(segred_group_sizze_27658,\n                                                  segment_sizze_nonzzero_29881))) -\n                   phys_group_id_29890, sext_i64_i32(num_groups_27659));\n         i_29891++) {\n        int32_t virt_group_id_29892 = phys_group_id_29890 + i_29891 *\n                sext_i64_i32(num_groups_27659);\n        int64_t gtid_27599 = squot64(sext_i32_i64(local_tid_29884),\n                                     segment_sizze_nonzzero",
                   "_29881) +\n                sext_i32_i64(virt_group_id_29892) *\n                squot64(segred_group_sizze_27658, segment_sizze_nonzzero_29881);\n        int64_t gtid_27607 = srem64(sext_i32_i64(local_tid_29884), n_25418);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, n_25418) && (slt64(gtid_27599, paths_25421) &&\n                                      slt64(sext_i32_i64(local_tid_29884),\n                                            n_25418 *\n                                            squot64(segred_group_sizze_27658,\n                                                    segment_sizze_nonzzero_29881)))) {\n                int64_t binop_x_28829 = n_25418 * gtid_27599;\n                int64_t new_index_28830 = gtid_27607 + binop_x_28829;\n                float x_27666 = ((__global float *) mem_29003)[new_index_28830];\n                \n                // save map-out results\n                { }\n                // save results to be reduced\n                {\n                    ((__local\n                      float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)] =\n                        x_27666;\n                }\n            } else {\n                ((__local\n                  float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)] =\n                    0.0F;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, n_25418)) {\n            // perform segmented scan to imitate reduction\n            {\n                float x_27662;\n                float x_27663;\n                float x_29893;\n                float x_29894;\n                bool ltid_in_bounds_29896;\n                \n                ltid_in_bounds_29896 = slt64(sext_i32_i64(local_tid_29884),\n                                             n_25418 *\n                                             squot64(segred_group_sizze_27658,\n                                                     segment_sizze_nonzzero_29881));\n                \n                in",
                   "t32_t skip_threads_29897;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_29896) {\n                        x_27663 = ((volatile __local\n                                    float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)];\n                        if ((local_tid_29884 - squot32(local_tid_29884, 32) *\n                             32) == 0) {\n                            x_27662 = x_27663;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29897 = 1;\n                    while (slt32(skip_threads_29897, 32)) {\n                        if (sle32(skip_threads_29897, local_tid_29884 -\n                                  squot32(local_tid_29884, 32) * 32) &&\n                            ltid_in_bounds_29896) {\n                            // read operands\n                            {\n                                x_27662 = ((volatile __local\n                                            float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884) -\n                                                                        sext_i32_i64(skip_threads_29897)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_29898 =\n                                     slt64(srem64(sext_i32_i64(local_tid_29884),\n                                                  n_25418),\n                                           sext_i32_i64(local_tid_29884) -\n                                           sext_i32_i64(local_tid_29884 -\n                                           skip_threads_29897));\n                                \n                                if (inactive_29898) {\n                                    x_27662 = x_27663;\n                                }\n                                if (!in",
                   "active_29898) {\n                                    float res_27664 = x_27662 + x_27663;\n                                    \n                                    x_27662 = res_27664;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_29886, skip_threads_29897)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29897, local_tid_29884 -\n                                  squot32(local_tid_29884, 32) * 32) &&\n                            ltid_in_bounds_29896) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)] =\n                                    x_27662;\n                                x_27663 = x_27662;\n                            }\n                        }\n                        if (sle32(wave_sizze_29886, skip_threads_29897)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29897 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_29884 - squot32(local_tid_29884, 32) * 32) ==\n                        31 && ltid_in_bounds_29896) {\n                        ((volatile __local\n                          float *) red_arr_mem_29888)[sext_i32_i64(squot32(local_tid_29884,\n                                                                           32))] =\n                            x_27662;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    ",
                   "int32_t skip_threads_29899;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_29884, 32) == 0 &&\n                            ltid_in_bounds_29896) {\n                            x_29894 = ((volatile __local\n                                        float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)];\n                            if ((local_tid_29884 - squot32(local_tid_29884,\n                                                           32) * 32) == 0) {\n                                x_29893 = x_29894;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_29899 = 1;\n                        while (slt32(skip_threads_29899, 32)) {\n                            if (sle32(skip_threads_29899, local_tid_29884 -\n                                      squot32(local_tid_29884, 32) * 32) &&\n                                (squot32(local_tid_29884, 32) == 0 &&\n                                 ltid_in_bounds_29896)) {\n                                // read operands\n                                {\n                                    x_29893 = ((volatile __local\n                                                float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884) -\n                                                                            sext_i32_i64(skip_threads_29899)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_29900 =\n                                         slt64(srem64(sext_i32_i64(local_tid_29884 *\n                                                      32 + 32 - 1), n_25418),\n                                               sext_i32_i64(local_tid_29884 *\n                                               32 + ",
                   "32 - 1) -\n                                               sext_i32_i64((local_tid_29884 -\n                                                             skip_threads_29899) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_29900) {\n                                        x_29893 = x_29894;\n                                    }\n                                    if (!inactive_29900) {\n                                        float res_29895 = x_29893 + x_29894;\n                                        \n                                        x_29893 = res_29895;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_29886, skip_threads_29899)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_29899, local_tid_29884 -\n                                      squot32(local_tid_29884, 32) * 32) &&\n                                (squot32(local_tid_29884, 32) == 0 &&\n                                 ltid_in_bounds_29896)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)] =\n                                        x_29893;\n                                    x_29894 = x_29893;\n                                }\n                            }\n                            if (sle32(wave_sizze_29886, skip_threads_29899)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_29899 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block",
                   " except the first\n                {\n                    if (!(squot32(local_tid_29884, 32) == 0 ||\n                          !ltid_in_bounds_29896)) {\n                        // read operands\n                        {\n                            x_27663 = x_27662;\n                            x_27662 = ((__local\n                                        float *) red_arr_mem_29888)[sext_i32_i64(squot32(local_tid_29884,\n                                                                                         32)) -\n                                                                    1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_29901 =\n                                 slt64(srem64(sext_i32_i64(local_tid_29884),\n                                              n_25418),\n                                       sext_i32_i64(local_tid_29884) -\n                                       sext_i32_i64(squot32(local_tid_29884,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_29901) {\n                                x_27662 = x_27663;\n                            }\n                            if (!inactive_29901) {\n                                float res_27664 = x_27662 + x_27663;\n                                \n                                x_27662 = res_27664;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)] =\n                                x_27662;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_29884, 32) == 0",
                   ") {\n                        ((__local\n                          float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)] =\n                            x_27663;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_29892) *\n                      squot64(segred_group_sizze_27658,\n                              segment_sizze_nonzzero_29881) +\n                      sext_i32_i64(local_tid_29884), paths_25421) &&\n                slt64(sext_i32_i64(local_tid_29884),\n                      squot64(segred_group_sizze_27658,\n                              segment_sizze_nonzzero_29881))) {\n                ((__global\n                  float *) mem_29019)[sext_i32_i64(virt_group_id_29892) *\n                                      squot64(segred_group_sizze_27658,\n                                              segment_sizze_nonzzero_29881) +\n                                      sext_i32_i64(local_tid_29884)] = ((__local\n                                                                         float *) red_arr_mem_29888)[(sext_i32_i64(local_tid_29884) +\n                                                                                                      1) *\n                                                                                                     segment_sizze_nonzzero_29881 -\n                                                                                                     1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27658\n}\n__kernel void mainzisegred_small_29517(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *red_arr_mem_29525_backing_aligned_0,\n      ",
                   "                                 int64_t res_25889,\n                                       int64_t num_groups_27441, __global\n                                       unsigned char *mem_28980,\n                                       int32_t num_subhistos_29431, __global\n                                       unsigned char *res_subhistos_mem_29432,\n                                       int64_t segment_sizze_nonzzero_29518)\n{\n    #define seghist_group_sizze_27439 (mainziseghist_group_sizze_27438)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29525_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_29525_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29520;\n    int32_t local_tid_29521;\n    int64_t group_sizze_29524;\n    int32_t wave_sizze_29523;\n    int32_t group_tid_29522;\n    \n    global_tid_29520 = get_global_id(0);\n    local_tid_29521 = get_local_id(0);\n    group_sizze_29524 = get_local_size(0);\n    wave_sizze_29523 = LOCKSTEP_WIDTH;\n    group_tid_29522 = get_group_id(0);\n    \n    int32_t flat_gtid_29517;\n    \n    flat_gtid_29517 = global_tid_29520;\n    \n    __local char *red_arr_mem_29525;\n    \n    red_arr_mem_29525 = (__local char *) red_arr_mem_29525_backing_0;\n    \n    int32_t phys_group_id_29527;\n    \n    phys_group_id_29527 = get_group_id(0);\n    for (int32_t i_29528 = 0; i_29528 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(res_25889,\n                                          squot64(seghist_group_sizze_27439,\n                                                  segment_sizze_nonzzero_29518))) -\n                   phys_group_id_29527, sext_i64_i32(num_groups_27441));\n         i_29528++) {\n        int32_t virt_group_id_29529 = phys_group_id_29527 + i_29528 *\n                sext_i64_i32(num_groups_27441);\n        int64_t bucket_id_29515 = squot64(sext_i32_i64(local_tid_",
                   "29521),\n                                          segment_sizze_nonzzero_29518) +\n                sext_i32_i64(virt_group_id_29529) *\n                squot64(seghist_group_sizze_27439,\n                        segment_sizze_nonzzero_29518);\n        int64_t subhistogram_id_29516 = srem64(sext_i32_i64(local_tid_29521),\n                                               num_subhistos_29431);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, num_subhistos_29431) && (slt64(bucket_id_29515,\n                                                        res_25889) &&\n                                                  slt64(sext_i32_i64(local_tid_29521),\n                                                        num_subhistos_29431 *\n                                                        squot64(seghist_group_sizze_27439,\n                                                                segment_sizze_nonzzero_29518)))) {\n                // save results to be reduced\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521)] =\n                        ((__global\n                          int64_t *) res_subhistos_mem_29432)[subhistogram_id_29516 *\n                                                              res_25889 +\n                                                              bucket_id_29515];\n                }\n            } else {\n                ((__local\n                  int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521)] =\n                    0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, num_subhistos_29431)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t x_27445;\n                int64_t x_27446;\n                int64_t x_29530;\n                int64_t x_29531;\n                bool ltid_in_bounds_29533;\n                \n                ltid_in_bounds_29533 = slt64(sext_i32_i64(",
                   "local_tid_29521),\n                                             num_subhistos_29431 *\n                                             squot64(seghist_group_sizze_27439,\n                                                     segment_sizze_nonzzero_29518));\n                \n                int32_t skip_threads_29534;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_29533) {\n                        x_27446 = ((volatile __local\n                                    int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521)];\n                        if ((local_tid_29521 - squot32(local_tid_29521, 32) *\n                             32) == 0) {\n                            x_27445 = x_27446;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29534 = 1;\n                    while (slt32(skip_threads_29534, 32)) {\n                        if (sle32(skip_threads_29534, local_tid_29521 -\n                                  squot32(local_tid_29521, 32) * 32) &&\n                            ltid_in_bounds_29533) {\n                            // read operands\n                            {\n                                x_27445 = ((volatile __local\n                                            int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521) -\n                                                                          sext_i32_i64(skip_threads_29534)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_29535 =\n                                     slt64(srem64(sext_i32_i64(local_tid_29521),\n                                                  num_subhistos_29431),\n                                           sext_i32_i64(local_tid_29521) -\n                                           sext_i32",
                   "_i64(local_tid_29521 -\n                                           skip_threads_29534));\n                                \n                                if (inactive_29535) {\n                                    x_27445 = x_27446;\n                                }\n                                if (!inactive_29535) {\n                                    int64_t res_27447 = smax64(x_27445,\n                                                               x_27446);\n                                    \n                                    x_27445 = res_27447;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_29523, skip_threads_29534)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29534, local_tid_29521 -\n                                  squot32(local_tid_29521, 32) * 32) &&\n                            ltid_in_bounds_29533) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521)] =\n                                    x_27445;\n                                x_27446 = x_27445;\n                            }\n                        }\n                        if (sle32(wave_sizze_29523, skip_threads_29534)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29534 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_29521 - squot32(local_tid_29521, 32) * 32) ==\n                        31 && ltid_in_bounds_29533) {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29525)[s",
                   "ext_i32_i64(squot32(local_tid_29521,\n                                                                             32))] =\n                            x_27445;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_29536;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_29521, 32) == 0 &&\n                            ltid_in_bounds_29533) {\n                            x_29531 = ((volatile __local\n                                        int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521)];\n                            if ((local_tid_29521 - squot32(local_tid_29521,\n                                                           32) * 32) == 0) {\n                                x_29530 = x_29531;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_29536 = 1;\n                        while (slt32(skip_threads_29536, 32)) {\n                            if (sle32(skip_threads_29536, local_tid_29521 -\n                                      squot32(local_tid_29521, 32) * 32) &&\n                                (squot32(local_tid_29521, 32) == 0 &&\n                                 ltid_in_bounds_29533)) {\n                                // read operands\n                                {\n                                    x_29530 = ((volatile __local\n                                                int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521) -\n                                                                              sext_i32_i64(skip_threads_29536)];\n                                }\n                                // perform operatio",
                   "n\n                                {\n                                    bool inactive_29537 =\n                                         slt64(srem64(sext_i32_i64(local_tid_29521 *\n                                                      32 + 32 - 1),\n                                                      num_subhistos_29431),\n                                               sext_i32_i64(local_tid_29521 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_29521 -\n                                                             skip_threads_29536) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_29537) {\n                                        x_29530 = x_29531;\n                                    }\n                                    if (!inactive_29537) {\n                                        int64_t res_29532 = smax64(x_29530,\n                                                                   x_29531);\n                                        \n                                        x_29530 = res_29532;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_29523, skip_threads_29536)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_29536, local_tid_29521 -\n                                      squot32(local_tid_29521, 32) * 32) &&\n                                (squot32(local_tid_29521, 32) == 0 &&\n                                 ltid_in_bounds_29533)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521)] =\n                ",
                   "                        x_29530;\n                                    x_29531 = x_29530;\n                                }\n                            }\n                            if (sle32(wave_sizze_29523, skip_threads_29536)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_29536 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_29521, 32) == 0 ||\n                          !ltid_in_bounds_29533)) {\n                        // read operands\n                        {\n                            x_27446 = x_27445;\n                            x_27445 = ((__local\n                                        int64_t *) red_arr_mem_29525)[sext_i32_i64(squot32(local_tid_29521,\n                                                                                           32)) -\n                                                                      1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_29538 =\n                                 slt64(srem64(sext_i32_i64(local_tid_29521),\n                                              num_subhistos_29431),\n                                       sext_i32_i64(local_tid_29521) -\n                                       sext_i32_i64(squot32(local_tid_29521,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_29538) {\n                                x_27445 = x_27446;\n                            }\n                            if (!inactive_29538) {\n                                int64_t res_27447 = smax64(x_27445, x_27446);\n                                \n                                x_2744",
                   "5 = res_27447;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521)] =\n                                x_27445;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_29521, 32) == 0) {\n                        ((__local\n                          int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521)] =\n                            x_27446;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_29529) *\n                      squot64(seghist_group_sizze_27439,\n                              segment_sizze_nonzzero_29518) +\n                      sext_i32_i64(local_tid_29521), res_25889) &&\n                slt64(sext_i32_i64(local_tid_29521),\n                      squot64(seghist_group_sizze_27439,\n                              segment_sizze_nonzzero_29518))) {\n                ((__global\n                  int64_t *) mem_28980)[sext_i32_i64(virt_group_id_29529) *\n                                        squot64(seghist_group_sizze_27439,\n                                                segment_sizze_nonzzero_29518) +\n                                        sext_i32_i64(local_tid_29521)] =\n                    ((__local\n                      int64_t *) red_arr_mem_29525)[(sext_i32_i64(local_tid_29521) +\n                                                     1) *\n                                                    segment_sizze_nonzzero_29518 -\n                                                    1];\n            }\n  ",
                   "      }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_27439\n}\n__kernel void testziscan_stage1_28535(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29350_backing_aligned_0,\n                                      int64_t flat_dim_26302, float res_26315,\n                                      __global unsigned char *res_mem_28935,\n                                      __global unsigned char *res_mem_28936,\n                                      __global unsigned char *mem_28967,\n                                      __global unsigned char *mem_28969,\n                                      int32_t num_threads_29344)\n{\n    #define segscan_group_sizze_28530 (testzisegscan_group_sizze_28529)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29350_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29350_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29345;\n    int32_t local_tid_29346;\n    int64_t group_sizze_29349;\n    int32_t wave_sizze_29348;\n    int32_t group_tid_29347;\n    \n    global_tid_29345 = get_global_id(0);\n    local_tid_29346 = get_local_id(0);\n    group_sizze_29349 = get_local_size(0);\n    wave_sizze_29348 = LOCKSTEP_WIDTH;\n    group_tid_29347 = get_group_id(0);\n    \n    int32_t phys_tid_28535;\n    \n    phys_tid_28535 = global_tid_29345;\n    \n    __local char *scan_arr_mem_29350;\n    \n    scan_arr_mem_29350 = (__local char *) scan_arr_mem_29350_backing_0;\n    \n    int64_t x_26321;\n    int64_t x_26322;\n    \n    x_26321 = 0;\n    for (int64_t j_29352 = 0; j_29352 < sdiv_up64(flat_dim_26302,\n                                                  sext_i32_i64(num_threa",
                   "ds_29344));\n         j_29352++) {\n        int64_t chunk_offset_29353 = segscan_group_sizze_28530 * j_29352 +\n                sext_i32_i64(group_tid_29347) * (segscan_group_sizze_28530 *\n                                                 sdiv_up64(flat_dim_26302,\n                                                           sext_i32_i64(num_threads_29344)));\n        int64_t flat_idx_29354 = chunk_offset_29353 +\n                sext_i32_i64(local_tid_29346);\n        int64_t gtid_28534 = flat_idx_29354;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_28534, flat_dim_26302)) {\n                int64_t binop_x_28804 = squot64(gtid_28534, 9);\n                int64_t binop_y_28805 = 9 * binop_x_28804;\n                int64_t new_index_28806 = gtid_28534 - binop_y_28805;\n                int64_t x_26324 = ((__global\n                                    int64_t *) res_mem_28935)[new_index_28806];\n                float x_26325 = ((__global\n                                  float *) res_mem_28936)[new_index_28806];\n                float x_26326 = res_26315 / x_26325;\n                float ceil_arg_26327 = x_26326 - 1.0F;\n                float res_26328;\n                \n                res_26328 = futrts_ceil32(ceil_arg_26327);\n                \n                int64_t res_26329 = fptosi_f32_i64(res_26328);\n                int64_t max_arg_26330 = sub64(x_26324, res_26329);\n                int64_t res_26331 = smax64(0, max_arg_26330);\n                bool cond_26332 = res_26331 == 0;\n                int64_t res_26333;\n                \n                if (cond_26332) {\n                    res_26333 = 1;\n                } else {\n                    res_26333 = res_26331;\n                }\n                // write to-scan values to parameters\n                {\n                    x_26322 = res_26333;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global int64_t *) mem_28969)[g",
                   "tid_28534] = res_26333;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_28534, flat_dim_26302)) {\n                    x_26322 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_26323 = add64(x_26321, x_26322);\n                \n                ((__local\n                  int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)] =\n                    res_26323;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_29355;\n            int64_t x_29356;\n            int64_t x_29358;\n            int64_t x_29359;\n            bool ltid_in_bounds_29361;\n            \n            ltid_in_bounds_29361 = slt64(sext_i32_i64(local_tid_29346),\n                                         segscan_group_sizze_28530);\n            \n            int32_t skip_threads_29362;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_29361) {\n                    x_29356 = ((volatile __local\n                                int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)];\n                    if ((local_tid_29346 - squot32(local_tid_29346, 32) * 32) ==\n                        0) {\n                        x_29355 = x_29356;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29362 = 1;\n                while (slt32(skip_threads_29362, 32)) {\n                    if (sle32(skip_threads_29362, local_tid_29346 -\n                              squot32(local_tid_29346, 32) * 32) &&\n                        ltid_in_bounds_29361) {\n                        // read operands\n                        {\n                            x_29355 = ((volatile __lo",
                   "cal\n                                        int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346) -\n                                                                       sext_i32_i64(skip_threads_29362)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_29357 = add64(x_29355, x_29356);\n                            \n                            x_29355 = res_29357;\n                        }\n                    }\n                    if (sle32(wave_sizze_29348, skip_threads_29362)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29362, local_tid_29346 -\n                              squot32(local_tid_29346, 32) * 32) &&\n                        ltid_in_bounds_29361) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)] =\n                                x_29355;\n                            x_29356 = x_29355;\n                        }\n                    }\n                    if (sle32(wave_sizze_29348, skip_threads_29362)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29362 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_29346 - squot32(local_tid_29346, 32) * 32) ==\n                    31 && ltid_in_bounds_29361) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29350)[sext_i32_i64(squot32(local_tid_29346,\n                                                                          32))] =\n                        x_29355;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan",
                   " the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_29363;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_29346, 32) == 0 &&\n                        ltid_in_bounds_29361) {\n                        x_29359 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)];\n                        if ((local_tid_29346 - squot32(local_tid_29346, 32) *\n                             32) == 0) {\n                            x_29358 = x_29359;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29363 = 1;\n                    while (slt32(skip_threads_29363, 32)) {\n                        if (sle32(skip_threads_29363, local_tid_29346 -\n                                  squot32(local_tid_29346, 32) * 32) &&\n                            (squot32(local_tid_29346, 32) == 0 &&\n                             ltid_in_bounds_29361)) {\n                            // read operands\n                            {\n                                x_29358 = ((volatile __local\n                                            int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346) -\n                                                                           sext_i32_i64(skip_threads_29363)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_29360 = add64(x_29358, x_29359);\n                                \n                                x_29358 = res_29360;\n                            }\n                        }\n                        if (sle32(wave_sizze_29348, skip_threads_29363)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n ",
                   "                       if (sle32(skip_threads_29363, local_tid_29346 -\n                                  squot32(local_tid_29346, 32) * 32) &&\n                            (squot32(local_tid_29346, 32) == 0 &&\n                             ltid_in_bounds_29361)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)] =\n                                    x_29358;\n                                x_29359 = x_29358;\n                            }\n                        }\n                        if (sle32(wave_sizze_29348, skip_threads_29363)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29363 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_29346, 32) == 0 ||\n                      !ltid_in_bounds_29361)) {\n                    // read operands\n                    {\n                        x_29356 = x_29355;\n                        x_29355 = ((__local\n                                    int64_t *) scan_arr_mem_29350)[sext_i32_i64(squot32(local_tid_29346,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_29357 = add64(x_29355, x_29356);\n                        \n                        x_29355 = res_29357;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)] =\n                            x",
                   "_29355;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_29346, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)] =\n                        x_29356;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_28534, flat_dim_26302)) {\n                    ((__global int64_t *) mem_28967)[gtid_28534] = ((__local\n                                                                     int64_t *) scan_arr_mem_29350)[sext_i32_i64(local_tid_29346)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_29364 = 0;\n                bool should_load_carry_29365 = local_tid_29346 == 0 &&\n                     !crosses_segment_29364;\n                \n                if (should_load_carry_29365) {\n                    x_26321 = ((__local\n                                int64_t *) scan_arr_mem_29350)[segscan_group_sizze_28530 -\n                                                               1];\n                }\n                if (!should_load_carry_29365) {\n                    x_26321 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_28530\n}\n__kernel void testziscan_stage1_28568(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29589_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29587_backing_aligned_1,\n             ",
                   "                         int64_t res_26335, __global\n                                      unsigned char *mem_28974, __global\n                                      unsigned char *mem_28978, __global\n                                      unsigned char *mem_28980,\n                                      int32_t num_threads_29581)\n{\n    #define segscan_group_sizze_28563 (testzisegscan_group_sizze_28562)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29589_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_29589_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29587_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29587_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29582;\n    int32_t local_tid_29583;\n    int64_t group_sizze_29586;\n    int32_t wave_sizze_29585;\n    int32_t group_tid_29584;\n    \n    global_tid_29582 = get_global_id(0);\n    local_tid_29583 = get_local_id(0);\n    group_sizze_29586 = get_local_size(0);\n    wave_sizze_29585 = LOCKSTEP_WIDTH;\n    group_tid_29584 = get_group_id(0);\n    \n    int32_t phys_tid_28568;\n    \n    phys_tid_28568 = global_tid_29582;\n    \n    __local char *scan_arr_mem_29587;\n    __local char *scan_arr_mem_29589;\n    \n    scan_arr_mem_29587 = (__local char *) scan_arr_mem_29587_backing_0;\n    scan_arr_mem_29589 = (__local char *) scan_arr_mem_29589_backing_1;\n    \n    bool x_26354;\n    int64_t x_26355;\n    bool x_26356;\n    int64_t x_26357;\n    \n    x_26354 = 0;\n    x_26355 = 0;\n    for (int64_t j_29591 = 0; j_29591 < sdiv_up64(res_26335,\n                                                  sext_i32_i64(num_threads_29581));\n         j_29591++) {\n        int64_t chunk_offset_29592 = segscan_group_sizze_28563 * j_29591 +\n                sext_i32_i64(group_tid_29584) * (segs",
                   "can_group_sizze_28563 *\n                                                 sdiv_up64(res_26335,\n                                                           sext_i32_i64(num_threads_29581)));\n        int64_t flat_idx_29593 = chunk_offset_29592 +\n                sext_i32_i64(local_tid_29583);\n        int64_t gtid_28567 = flat_idx_29593;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_28567, res_26335)) {\n                int64_t x_26361 = ((__global int64_t *) mem_28974)[gtid_28567];\n                bool res_26362 = slt64(0, x_26361);\n                \n                // write to-scan values to parameters\n                {\n                    x_26356 = res_26362;\n                    x_26357 = x_26361;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_28567, res_26335)) {\n                    x_26356 = 0;\n                    x_26357 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_26358 = x_26354 || x_26356;\n                int64_t res_26359;\n                \n                if (x_26356) {\n                    res_26359 = x_26357;\n                } else {\n                    int64_t res_26360 = add64(x_26355, x_26357);\n                    \n                    res_26359 = res_26360;\n                }\n                ((__local\n                  bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)] =\n                    res_26358;\n                ((__local\n                  int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)] =\n                    res_26359;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_29594;\n            int64_t x_29595;\n          ",
                   "  bool x_29596;\n            int64_t x_29597;\n            bool x_29601;\n            int64_t x_29602;\n            bool x_29603;\n            int64_t x_29604;\n            bool ltid_in_bounds_29608;\n            \n            ltid_in_bounds_29608 = slt64(sext_i32_i64(local_tid_29583),\n                                         segscan_group_sizze_28563);\n            \n            int32_t skip_threads_29609;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_29608) {\n                    x_29596 = ((volatile __local\n                                bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)];\n                    x_29597 = ((volatile __local\n                                int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)];\n                    if ((local_tid_29583 - squot32(local_tid_29583, 32) * 32) ==\n                        0) {\n                        x_29594 = x_29596;\n                        x_29595 = x_29597;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29609 = 1;\n                while (slt32(skip_threads_29609, 32)) {\n                    if (sle32(skip_threads_29609, local_tid_29583 -\n                              squot32(local_tid_29583, 32) * 32) &&\n                        ltid_in_bounds_29608) {\n                        // read operands\n                        {\n                            x_29594 = ((volatile __local\n                                        bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583) -\n                                                                    sext_i32_i64(skip_threads_29609)];\n                            x_29595 = ((volatile __local\n                                        int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583) -\n                                                                       sext_i32_i64(skip_threads_29609)];\n  ",
                   "                      }\n                        // perform operation\n                        {\n                            bool res_29598 = x_29594 || x_29596;\n                            int64_t res_29599;\n                            \n                            if (x_29596) {\n                                res_29599 = x_29597;\n                            } else {\n                                int64_t res_29600 = add64(x_29595, x_29597);\n                                \n                                res_29599 = res_29600;\n                            }\n                            x_29594 = res_29598;\n                            x_29595 = res_29599;\n                        }\n                    }\n                    if (sle32(wave_sizze_29585, skip_threads_29609)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29609, local_tid_29583 -\n                              squot32(local_tid_29583, 32) * 32) &&\n                        ltid_in_bounds_29608) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)] =\n                                x_29594;\n                            x_29596 = x_29594;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)] =\n                                x_29595;\n                            x_29597 = x_29595;\n                        }\n                    }\n                    if (sle32(wave_sizze_29585, skip_threads_29609)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29609 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_29583 -",
                   " squot32(local_tid_29583, 32) * 32) ==\n                    31 && ltid_in_bounds_29608) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_29587)[sext_i32_i64(squot32(local_tid_29583,\n                                                                       32))] =\n                        x_29594;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29589)[sext_i32_i64(squot32(local_tid_29583,\n                                                                          32))] =\n                        x_29595;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_29610;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_29583, 32) == 0 &&\n                        ltid_in_bounds_29608) {\n                        x_29603 = ((volatile __local\n                                    bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)];\n                        x_29604 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)];\n                        if ((local_tid_29583 - squot32(local_tid_29583, 32) *\n                             32) == 0) {\n                            x_29601 = x_29603;\n                            x_29602 = x_29604;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29610 = 1;\n                    while (slt32(skip_threads_29610, 32)) {\n                        if (sle32(skip_threads_29610, local_tid_29583 -\n                                  squot32(local_tid_29583, 32) * 32) &&\n                            (squot32(local_tid_29583, 32) == 0 &&\n                             ltid",
                   "_in_bounds_29608)) {\n                            // read operands\n                            {\n                                x_29601 = ((volatile __local\n                                            bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583) -\n                                                                        sext_i32_i64(skip_threads_29610)];\n                                x_29602 = ((volatile __local\n                                            int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583) -\n                                                                           sext_i32_i64(skip_threads_29610)];\n                            }\n                            // perform operation\n                            {\n                                bool res_29605 = x_29601 || x_29603;\n                                int64_t res_29606;\n                                \n                                if (x_29603) {\n                                    res_29606 = x_29604;\n                                } else {\n                                    int64_t res_29607 = add64(x_29602, x_29604);\n                                    \n                                    res_29606 = res_29607;\n                                }\n                                x_29601 = res_29605;\n                                x_29602 = res_29606;\n                            }\n                        }\n                        if (sle32(wave_sizze_29585, skip_threads_29610)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29610, local_tid_29583 -\n                                  squot32(local_tid_29583, 32) * 32) &&\n                            (squot32(local_tid_29583, 32) == 0 &&\n                             ltid_in_bounds_29608)) {\n                            // write result\n                            {\n                                ((volatile __local\n                          ",
                   "        bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)] =\n                                    x_29601;\n                                x_29603 = x_29601;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)] =\n                                    x_29602;\n                                x_29604 = x_29602;\n                            }\n                        }\n                        if (sle32(wave_sizze_29585, skip_threads_29610)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29610 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_29583, 32) == 0 ||\n                      !ltid_in_bounds_29608)) {\n                    // read operands\n                    {\n                        x_29596 = x_29594;\n                        x_29597 = x_29595;\n                        x_29594 = ((__local\n                                    bool *) scan_arr_mem_29587)[sext_i32_i64(squot32(local_tid_29583,\n                                                                                     32)) -\n                                                                1];\n                        x_29595 = ((__local\n                                    int64_t *) scan_arr_mem_29589)[sext_i32_i64(squot32(local_tid_29583,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        bool res_29598 = x_29594 || x_29596;\n                        int64_t res_29599;\n                        \n                        if (x_29596) {\n                            res_2",
                   "9599 = x_29597;\n                        } else {\n                            int64_t res_29600 = add64(x_29595, x_29597);\n                            \n                            res_29599 = res_29600;\n                        }\n                        x_29594 = res_29598;\n                        x_29595 = res_29599;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)] =\n                            x_29594;\n                        ((__local\n                          int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)] =\n                            x_29595;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_29583, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)] =\n                        x_29596;\n                    ((__local\n                      int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)] =\n                        x_29597;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_28567, res_26335)) {\n                    ((__global bool *) mem_28978)[gtid_28567] = ((__local\n                                                                  bool *) scan_arr_mem_29587)[sext_i32_i64(local_tid_29583)];\n                    ((__global int64_t *) mem_28980)[gtid_28567] = ((__local\n                                                                     int64_t *) scan_arr_mem_29589)[sext_i32_i64(local_tid_29583)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n ",
                   "           {\n                bool crosses_segment_29611 = 0;\n                bool should_load_carry_29612 = local_tid_29583 == 0 &&\n                     !crosses_segment_29611;\n                \n                if (should_load_carry_29612) {\n                    x_26354 = ((__local\n                                bool *) scan_arr_mem_29587)[segscan_group_sizze_28563 -\n                                                            1];\n                    x_26355 = ((__local\n                                int64_t *) scan_arr_mem_29589)[segscan_group_sizze_28563 -\n                                                               1];\n                }\n                if (!should_load_carry_29612) {\n                    x_26354 = 0;\n                    x_26355 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_28563\n}\n__kernel void testziscan_stage1_28576(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29656_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29654_backing_aligned_1,\n                                      int64_t res_26335, __global\n                                      unsigned char *mem_28980, __global\n                                      unsigned char *mem_28983, __global\n                                      unsigned char *mem_28985, __global\n                                      unsigned char *mem_28987,\n                                      int32_t num_threads_29648)\n{\n    #define segscan_group_sizze_28571 (testzisegscan_group_sizze_28570)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29656_backing_1 =\n                          (__local volatile\n                           char *) sca",
                   "n_arr_mem_29656_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29654_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29654_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29649;\n    int32_t local_tid_29650;\n    int64_t group_sizze_29653;\n    int32_t wave_sizze_29652;\n    int32_t group_tid_29651;\n    \n    global_tid_29649 = get_global_id(0);\n    local_tid_29650 = get_local_id(0);\n    group_sizze_29653 = get_local_size(0);\n    wave_sizze_29652 = LOCKSTEP_WIDTH;\n    group_tid_29651 = get_group_id(0);\n    \n    int32_t phys_tid_28576;\n    \n    phys_tid_28576 = global_tid_29649;\n    \n    __local char *scan_arr_mem_29654;\n    __local char *scan_arr_mem_29656;\n    \n    scan_arr_mem_29654 = (__local char *) scan_arr_mem_29654_backing_0;\n    scan_arr_mem_29656 = (__local char *) scan_arr_mem_29656_backing_1;\n    \n    bool x_26393;\n    int64_t x_26394;\n    bool x_26395;\n    int64_t x_26396;\n    \n    x_26393 = 0;\n    x_26394 = 0;\n    for (int64_t j_29658 = 0; j_29658 < sdiv_up64(res_26335,\n                                                  sext_i32_i64(num_threads_29648));\n         j_29658++) {\n        int64_t chunk_offset_29659 = segscan_group_sizze_28571 * j_29658 +\n                sext_i32_i64(group_tid_29651) * (segscan_group_sizze_28571 *\n                                                 sdiv_up64(res_26335,\n                                                           sext_i32_i64(num_threads_29648)));\n        int64_t flat_idx_29660 = chunk_offset_29659 +\n                sext_i32_i64(local_tid_29650);\n        int64_t gtid_28575 = flat_idx_29660;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_28575, res_26335)) {\n                int64_t x_26400 = ((__global int64_t *) mem_28980)[gtid_28575];\n                int64_t i_p_o_28815 = add64(-1, gtid_28575);\n                int64_t rot_i_28816 = smod64(i_p_o_28815, res_26",
                   "335);\n                int64_t x_26401 = ((__global int64_t *) mem_28980)[rot_i_28816];\n                bool res_26403 = x_26400 == x_26401;\n                bool res_26404 = !res_26403;\n                \n                // write to-scan values to parameters\n                {\n                    x_26395 = res_26404;\n                    x_26396 = 1;\n                }\n                // write mapped values results to global memory\n                {\n                    ((__global bool *) mem_28987)[gtid_28575] = res_26404;\n                }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_28575, res_26335)) {\n                    x_26395 = 0;\n                    x_26396 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_26397 = x_26393 || x_26395;\n                int64_t res_26398;\n                \n                if (x_26395) {\n                    res_26398 = x_26396;\n                } else {\n                    int64_t res_26399 = add64(x_26394, x_26396);\n                    \n                    res_26398 = res_26399;\n                }\n                ((__local\n                  bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)] =\n                    res_26397;\n                ((__local\n                  int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650)] =\n                    res_26398;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_29661;\n            int64_t x_29662;\n            bool x_29663;\n            int64_t x_29664;\n            bool x_29668;\n            int64_t x_29669;\n            bool x_29670;\n            int64_t x_29671;\n            bool ltid_in_bounds_29675;\n            \n            ltid_in_bounds_29675 = slt64(sext_i32_i64(local_tid_29650),\n                        ",
                   "                 segscan_group_sizze_28571);\n            \n            int32_t skip_threads_29676;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_29675) {\n                    x_29663 = ((volatile __local\n                                bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)];\n                    x_29664 = ((volatile __local\n                                int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650)];\n                    if ((local_tid_29650 - squot32(local_tid_29650, 32) * 32) ==\n                        0) {\n                        x_29661 = x_29663;\n                        x_29662 = x_29664;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29676 = 1;\n                while (slt32(skip_threads_29676, 32)) {\n                    if (sle32(skip_threads_29676, local_tid_29650 -\n                              squot32(local_tid_29650, 32) * 32) &&\n                        ltid_in_bounds_29675) {\n                        // read operands\n                        {\n                            x_29661 = ((volatile __local\n                                        bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650) -\n                                                                    sext_i32_i64(skip_threads_29676)];\n                            x_29662 = ((volatile __local\n                                        int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650) -\n                                                                       sext_i32_i64(skip_threads_29676)];\n                        }\n                        // perform operation\n                        {\n                            bool res_29665 = x_29661 || x_29663;\n                            int64_t res_29666;\n                            \n                            if (x_29663) {\n                        ",
                   "        res_29666 = x_29664;\n                            } else {\n                                int64_t res_29667 = add64(x_29662, x_29664);\n                                \n                                res_29666 = res_29667;\n                            }\n                            x_29661 = res_29665;\n                            x_29662 = res_29666;\n                        }\n                    }\n                    if (sle32(wave_sizze_29652, skip_threads_29676)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29676, local_tid_29650 -\n                              squot32(local_tid_29650, 32) * 32) &&\n                        ltid_in_bounds_29675) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)] =\n                                x_29661;\n                            x_29663 = x_29661;\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650)] =\n                                x_29662;\n                            x_29664 = x_29662;\n                        }\n                    }\n                    if (sle32(wave_sizze_29652, skip_threads_29676)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29676 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_29650 - squot32(local_tid_29650, 32) * 32) ==\n                    31 && ltid_in_bounds_29675) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_29654)[sext_i32_i64(squot32(local_tid_29650,\n                                                                       32))] =\n        ",
                   "                x_29661;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29656)[sext_i32_i64(squot32(local_tid_29650,\n                                                                          32))] =\n                        x_29662;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_29677;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_29650, 32) == 0 &&\n                        ltid_in_bounds_29675) {\n                        x_29670 = ((volatile __local\n                                    bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)];\n                        x_29671 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650)];\n                        if ((local_tid_29650 - squot32(local_tid_29650, 32) *\n                             32) == 0) {\n                            x_29668 = x_29670;\n                            x_29669 = x_29671;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29677 = 1;\n                    while (slt32(skip_threads_29677, 32)) {\n                        if (sle32(skip_threads_29677, local_tid_29650 -\n                                  squot32(local_tid_29650, 32) * 32) &&\n                            (squot32(local_tid_29650, 32) == 0 &&\n                             ltid_in_bounds_29675)) {\n                            // read operands\n                            {\n                                x_29668 = ((volatile __local\n                                            bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650) -\n                                          ",
                   "                              sext_i32_i64(skip_threads_29677)];\n                                x_29669 = ((volatile __local\n                                            int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650) -\n                                                                           sext_i32_i64(skip_threads_29677)];\n                            }\n                            // perform operation\n                            {\n                                bool res_29672 = x_29668 || x_29670;\n                                int64_t res_29673;\n                                \n                                if (x_29670) {\n                                    res_29673 = x_29671;\n                                } else {\n                                    int64_t res_29674 = add64(x_29669, x_29671);\n                                    \n                                    res_29673 = res_29674;\n                                }\n                                x_29668 = res_29672;\n                                x_29669 = res_29673;\n                            }\n                        }\n                        if (sle32(wave_sizze_29652, skip_threads_29677)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29677, local_tid_29650 -\n                                  squot32(local_tid_29650, 32) * 32) &&\n                            (squot32(local_tid_29650, 32) == 0 &&\n                             ltid_in_bounds_29675)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)] =\n                                    x_29668;\n                                x_29670 = x_29668;\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid",
                   "_29650)] =\n                                    x_29669;\n                                x_29671 = x_29669;\n                            }\n                        }\n                        if (sle32(wave_sizze_29652, skip_threads_29677)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29677 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_29650, 32) == 0 ||\n                      !ltid_in_bounds_29675)) {\n                    // read operands\n                    {\n                        x_29663 = x_29661;\n                        x_29664 = x_29662;\n                        x_29661 = ((__local\n                                    bool *) scan_arr_mem_29654)[sext_i32_i64(squot32(local_tid_29650,\n                                                                                     32)) -\n                                                                1];\n                        x_29662 = ((__local\n                                    int64_t *) scan_arr_mem_29656)[sext_i32_i64(squot32(local_tid_29650,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        bool res_29665 = x_29661 || x_29663;\n                        int64_t res_29666;\n                        \n                        if (x_29663) {\n                            res_29666 = x_29664;\n                        } else {\n                            int64_t res_29667 = add64(x_29662, x_29664);\n                            \n                            res_29666 = res_29667;\n                        }\n                        x_29661 = res_29665;\n                        x_2966",
                   "2 = res_29666;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)] =\n                            x_29661;\n                        ((__local\n                          int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650)] =\n                            x_29662;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_29650, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)] =\n                        x_29663;\n                    ((__local\n                      int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650)] =\n                        x_29664;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_28575, res_26335)) {\n                    ((__global bool *) mem_28983)[gtid_28575] = ((__local\n                                                                  bool *) scan_arr_mem_29654)[sext_i32_i64(local_tid_29650)];\n                    ((__global int64_t *) mem_28985)[gtid_28575] = ((__local\n                                                                     int64_t *) scan_arr_mem_29656)[sext_i32_i64(local_tid_29650)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_29678 = 0;\n                bool should_load_carry_29679 = local_tid_29650 == 0 &&\n                     !crosses_segment_29678;\n                \n                if (should_load_carry_29679) {\n                    x_26393 = ((__local\n                      ",
                   "          bool *) scan_arr_mem_29654)[segscan_group_sizze_28571 -\n                                                            1];\n                    x_26394 = ((__local\n                                int64_t *) scan_arr_mem_29656)[segscan_group_sizze_28571 -\n                                                               1];\n                }\n                if (!should_load_carry_29679) {\n                    x_26393 = 0;\n                    x_26394 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_28571\n}\n__kernel void testziscan_stage1_28584(__global int *global_failure,\n                                      int failure_is_an_option, __global\n                                      int64_t *global_failure_args,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29723_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29721_backing_aligned_1,\n                                      int64_t paths_26135,\n                                      int64_t flat_dim_26302, float res_26315,\n                                      int64_t res_26335, int64_t i_28461,\n                                      __global unsigned char *res_mem_28933,\n                                      __global unsigned char *res_mem_28934,\n                                      __global unsigned char *res_mem_28935,\n                                      __global unsigned char *res_mem_28936,\n                                      __global unsigned char *mem_28964,\n                                      __global unsigned char *mem_28980,\n                                      __global unsigned char *mem_28985,\n                                      __global unsigned char *mem_28987,\n                                      __global unsigned char *mem_28990,\n         ",
                   "                             __global unsigned char *mem_28992,\n                                      int32_t num_threads_29715)\n{\n    #define segscan_group_sizze_28579 (testzisegscan_group_sizze_28578)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29723_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_29723_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29721_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29721_backing_aligned_1;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29716;\n    int32_t local_tid_29717;\n    int64_t group_sizze_29720;\n    int32_t wave_sizze_29719;\n    int32_t group_tid_29718;\n    \n    global_tid_29716 = get_global_id(0);\n    local_tid_29717 = get_local_id(0);\n    group_sizze_29720 = get_local_size(0);\n    wave_sizze_29719 = LOCKSTEP_WIDTH;\n    group_tid_29718 = get_group_id(0);\n    \n    int32_t phys_tid_28584;\n    \n    phys_tid_28584 = global_tid_29716;\n    \n    __local char *scan_arr_mem_29721;\n    __local char *scan_arr_mem_29723;\n    \n    scan_arr_mem_29721 = (__local char *) scan_arr_mem_29721_backing_0;\n    scan_arr_mem_29723 = (__local char *) scan_arr_mem_29723_backing_1;\n    \n    bool x_26419;\n    float x_26420;\n    bool x_26421;\n    float x_26422;\n    \n    x_26419 = 0;\n    x_26420 = 0.0F;\n    for (int64_t j_29725 = 0; j_29725 < sdiv_up64(res_26335,\n                                                  sext_i32_i64(num_threads_29715));\n         j_29725++) {\n        int64_t chunk_offset_29726 = segscan_group_sizze_28579 * j_29725 +\n                sext_i32_i64(group_tid_29718) * (segscan_group_sizz",
                   "e_28579 *\n                                                 sdiv_up64(res_26335,\n                                                           sext_i32_i64(num_threads_29715)));\n        int64_t flat_idx_29727 = chunk_offset_29726 +\n                sext_i32_i64(local_tid_29717);\n        int64_t gtid_28583 = flat_idx_29727;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_28583, res_26335)) {\n                int64_t x_26427 = ((__global int64_t *) mem_28985)[gtid_28583];\n                int64_t x_26428 = ((__global int64_t *) mem_28980)[gtid_28583];\n                bool x_26429 = ((__global bool *) mem_28987)[gtid_28583];\n                int64_t res_26432 = sub64(x_26427, 1);\n                bool x_26433 = sle64(0, x_26428);\n                bool y_26434 = slt64(x_26428, flat_dim_26302);\n                bool bounds_check_26435 = x_26433 && y_26434;\n                bool index_certs_26436;\n                \n                if (!bounds_check_26435) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 17) ==\n                            -1) {\n                            global_failure_args[0] = x_26428;\n                            global_failure_args[1] = flat_dim_26302;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t new_index_26437 = squot64(x_26428, 9);\n                int64_t binop_y_26438 = 9 * new_index_26437;\n                int64_t new_index_26439 = x_26428 - binop_y_26438;\n                int64_t lifted_0_get_arg_26443 = ((__global\n                                                   int64_t *) res_mem_28935)[new_index_26439];\n                float lifted_0_get_arg_26444 = ((__global\n                                                 float *) res_mem_28936)[new_index_26439];\n                float x_26445 = res_26315 / lifte",
                   "d_0_get_arg_26444;\n                float ceil_arg_26446 = x_26445 - 1.0F;\n                float res_26447;\n                \n                res_26447 = futrts_ceil32(ceil_arg_26446);\n                \n                int64_t res_26448 = fptosi_f32_i64(res_26447);\n                int64_t max_arg_26449 = sub64(lifted_0_get_arg_26443,\n                                              res_26448);\n                int64_t res_26450 = smax64(0, max_arg_26449);\n                bool cond_26451 = res_26450 == 0;\n                float res_26452;\n                \n                if (cond_26451) {\n                    res_26452 = 0.0F;\n                } else {\n                    float lifted_0_get_arg_26440 = ((__global\n                                                     float *) mem_28964)[i_28461 *\n                                                                         paths_26135 +\n                                                                         new_index_26437];\n                    float lifted_0_get_arg_26441 = ((__global\n                                                     float *) res_mem_28933)[new_index_26439];\n                    float lifted_0_get_arg_26442 = ((__global\n                                                     float *) res_mem_28934)[new_index_26439];\n                    float res_26453;\n                    \n                    res_26453 = futrts_ceil32(x_26445);\n                    \n                    float start_26454 = lifted_0_get_arg_26444 * res_26453;\n                    float res_26455;\n                    \n                    res_26455 = futrts_ceil32(ceil_arg_26446);\n                    \n                    int64_t res_26456 = fptosi_f32_i64(res_26455);\n                    int64_t max_arg_26457 = sub64(lifted_0_get_arg_26443,\n                                                  res_26456);\n                    int64_t res_26458 = smax64(0, max_arg_26457);\n                    int64_t sizze_26459 = sub64(res_26458, 1);\n                    bool con",
                   "d_26460 = res_26432 == 0;\n                    float res_26461;\n                    \n                    if (cond_26460) {\n                        res_26461 = 1.0F;\n                    } else {\n                        res_26461 = 0.0F;\n                    }\n                    \n                    bool cond_26462 = slt64(0, res_26432);\n                    float res_26463;\n                    \n                    if (cond_26462) {\n                        float y_26464 = lifted_0_get_arg_26441 *\n                              lifted_0_get_arg_26444;\n                        float res_26465 = res_26461 - y_26464;\n                        \n                        res_26463 = res_26465;\n                    } else {\n                        res_26463 = res_26461;\n                    }\n                    \n                    bool cond_26466 = res_26432 == sizze_26459;\n                    float res_26467;\n                    \n                    if (cond_26466) {\n                        float res_26468 = res_26463 - 1.0F;\n                        \n                        res_26467 = res_26468;\n                    } else {\n                        res_26467 = res_26463;\n                    }\n                    \n                    float res_26469 = lifted_0_get_arg_26442 * res_26467;\n                    float res_26470 = sitofp_i64_f32(res_26432);\n                    float y_26471 = lifted_0_get_arg_26444 * res_26470;\n                    float bondprice_arg_26472 = start_26454 + y_26471;\n                    float y_26473 = bondprice_arg_26472 - res_26315;\n                    float negate_arg_26474 = 1.0e-2F * y_26473;\n                    float exp_arg_26475 = 0.0F - negate_arg_26474;\n                    float res_26476 = fpow32(2.7182817F, exp_arg_26475);\n                    float x_26477 = 1.0F - res_26476;\n                    float B_26478 = x_26477 / 1.0e-2F;\n                    float x_26479 = B_26478 - bondprice_arg_26472;\n                    float x_26480 = res_26315 + x_26",
                   "479;\n                    float x_26481 = 4.4999997e-6F * x_26480;\n                    float A1_26482 = x_26481 / 1.0e-4F;\n                    float y_26483 = fpow32(B_26478, 2.0F);\n                    float x_26484 = 1.0000001e-6F * y_26483;\n                    float A2_26485 = x_26484 / 4.0e-2F;\n                    float exp_arg_26486 = A1_26482 - A2_26485;\n                    float res_26487 = fpow32(2.7182817F, exp_arg_26486);\n                    float negate_arg_26488 = lifted_0_get_arg_26440 * B_26478;\n                    float exp_arg_26489 = 0.0F - negate_arg_26488;\n                    float res_26490 = fpow32(2.7182817F, exp_arg_26489);\n                    float res_26491 = res_26487 * res_26490;\n                    float res_26492 = res_26469 * res_26491;\n                    \n                    res_26452 = res_26492;\n                }\n                // write to-scan values to parameters\n                {\n                    x_26421 = x_26429;\n                    x_26422 = res_26452;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n        // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_28583, res_26335)) {\n                    x_26421 = 0;\n                    x_26422 = 0.0F;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                bool res_26423 = x_26419 || x_26421;\n                float res_26424;\n                \n                if (x_26421) {\n                    res_26424 = x_26422;\n                } else {\n                    float res_26425 = x_26420 + x_26422;\n                    \n                    res_26424 = res_26425;\n                }\n                ((__local\n                  bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)] =\n                    res_26423;\n             ",
                   "   ((__local\n                  float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)] =\n                    res_26424;\n            }\n            \n          error_0:\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_failure)\n                return;\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool x_29728;\n            float x_29729;\n            bool x_29730;\n            float x_29731;\n            bool x_29735;\n            float x_29736;\n            bool x_29737;\n            float x_29738;\n            bool ltid_in_bounds_29742;\n            \n            ltid_in_bounds_29742 = slt64(sext_i32_i64(local_tid_29717),\n                                         segscan_group_sizze_28579);\n            \n            int32_t skip_threads_29743;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_29742) {\n                    x_29730 = ((volatile __local\n                                bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)];\n                    x_29731 = ((volatile __local\n                                float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)];\n                    if ((local_tid_29717 - squot32(local_tid_29717, 32) * 32) ==\n                        0) {\n                        x_29728 = x_29730;\n                        x_29729 = x_29731;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29743 = 1;\n                while (slt32(skip_threads_29743, 32)) {\n                    if (sle32(skip_threads_29743, local_tid_29717 -\n                              squot32(local_tid_29717, 32) * 32) &&\n                        ltid_in_bounds_29742) {\n                        // read operands\n                        {\n                            x_29728 = ((volatile __local\n                                        bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_297",
                   "17) -\n                                                                    sext_i32_i64(skip_threads_29743)];\n                            x_29729 = ((volatile __local\n                                        float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717) -\n                                                                     sext_i32_i64(skip_threads_29743)];\n                        }\n                        // perform operation\n                        {\n                            bool res_29732 = x_29728 || x_29730;\n                            float res_29733;\n                            \n                            if (x_29730) {\n                                res_29733 = x_29731;\n                            } else {\n                                float res_29734 = x_29729 + x_29731;\n                                \n                                res_29733 = res_29734;\n                            }\n                            x_29728 = res_29732;\n                            x_29729 = res_29733;\n                        }\n                    }\n                    if (sle32(wave_sizze_29719, skip_threads_29743)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29743, local_tid_29717 -\n                              squot32(local_tid_29717, 32) * 32) &&\n                        ltid_in_bounds_29742) {\n                        // write result\n                        {\n                            ((volatile __local\n                              bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)] =\n                                x_29728;\n                            x_29730 = x_29728;\n                            ((volatile __local\n                              float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)] =\n                                x_29729;\n                            x_29731 = x_29729;\n                        }\n                    }\n                    if (sle32",
                   "(wave_sizze_29719, skip_threads_29743)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29743 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_29717 - squot32(local_tid_29717, 32) * 32) ==\n                    31 && ltid_in_bounds_29742) {\n                    ((volatile __local\n                      bool *) scan_arr_mem_29721)[sext_i32_i64(squot32(local_tid_29717,\n                                                                       32))] =\n                        x_29728;\n                    ((volatile __local\n                      float *) scan_arr_mem_29723)[sext_i32_i64(squot32(local_tid_29717,\n                                                                        32))] =\n                        x_29729;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_29744;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_29717, 32) == 0 &&\n                        ltid_in_bounds_29742) {\n                        x_29737 = ((volatile __local\n                                    bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)];\n                        x_29738 = ((volatile __local\n                                    float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)];\n                        if ((local_tid_29717 - squot32(local_tid_29717, 32) *\n                             32) == 0) {\n                            x_29735 = x_29737;\n                            x_29736 = x_29738;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n          ",
                   "      {\n                    skip_threads_29744 = 1;\n                    while (slt32(skip_threads_29744, 32)) {\n                        if (sle32(skip_threads_29744, local_tid_29717 -\n                                  squot32(local_tid_29717, 32) * 32) &&\n                            (squot32(local_tid_29717, 32) == 0 &&\n                             ltid_in_bounds_29742)) {\n                            // read operands\n                            {\n                                x_29735 = ((volatile __local\n                                            bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717) -\n                                                                        sext_i32_i64(skip_threads_29744)];\n                                x_29736 = ((volatile __local\n                                            float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717) -\n                                                                         sext_i32_i64(skip_threads_29744)];\n                            }\n                            // perform operation\n                            {\n                                bool res_29739 = x_29735 || x_29737;\n                                float res_29740;\n                                \n                                if (x_29737) {\n                                    res_29740 = x_29738;\n                                } else {\n                                    float res_29741 = x_29736 + x_29738;\n                                    \n                                    res_29740 = res_29741;\n                                }\n                                x_29735 = res_29739;\n                                x_29736 = res_29740;\n                            }\n                        }\n                        if (sle32(wave_sizze_29719, skip_threads_29744)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29744, local_tid_29717 -\n  ",
                   "                                squot32(local_tid_29717, 32) * 32) &&\n                            (squot32(local_tid_29717, 32) == 0 &&\n                             ltid_in_bounds_29742)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)] =\n                                    x_29735;\n                                x_29737 = x_29735;\n                                ((volatile __local\n                                  float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)] =\n                                    x_29736;\n                                x_29738 = x_29736;\n                            }\n                        }\n                        if (sle32(wave_sizze_29719, skip_threads_29744)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29744 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_29717, 32) == 0 ||\n                      !ltid_in_bounds_29742)) {\n                    // read operands\n                    {\n                        x_29730 = x_29728;\n                        x_29731 = x_29729;\n                        x_29728 = ((__local\n                                    bool *) scan_arr_mem_29721)[sext_i32_i64(squot32(local_tid_29717,\n                                                                                     32)) -\n                                                                1];\n                        x_29729 = ((__local\n                                    float *) scan_arr_mem_29723)[sext_i32_i64(squot32(local_tid_29717,\n                                                                                      32)) -\n                      ",
                   "                                           1];\n                    }\n                    // perform operation\n                    {\n                        bool res_29732 = x_29728 || x_29730;\n                        float res_29733;\n                        \n                        if (x_29730) {\n                            res_29733 = x_29731;\n                        } else {\n                            float res_29734 = x_29729 + x_29731;\n                            \n                            res_29733 = res_29734;\n                        }\n                        x_29728 = res_29732;\n                        x_29729 = res_29733;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)] =\n                            x_29728;\n                        ((__local\n                          float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)] =\n                            x_29729;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_29717, 32) == 0) {\n                    ((__local\n                      bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)] =\n                        x_29730;\n                    ((__local\n                      float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)] =\n                        x_29731;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_28583, res_26335)) {\n                    ((__global bool *) mem_28990)[gtid_28583] = ((__local\n                                                                  bool *) scan_arr_mem_29721)[sext_i32_i64(local_tid_29717)];\n                    ((__global float *) mem",
                   "_28992)[gtid_28583] = ((__local\n                                                                   float *) scan_arr_mem_29723)[sext_i32_i64(local_tid_29717)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_29745 = 0;\n                bool should_load_carry_29746 = local_tid_29717 == 0 &&\n                     !crosses_segment_29745;\n                \n                if (should_load_carry_29746) {\n                    x_26419 = ((__local\n                                bool *) scan_arr_mem_29721)[segscan_group_sizze_28579 -\n                                                            1];\n                    x_26420 = ((__local\n                                float *) scan_arr_mem_29723)[segscan_group_sizze_28579 -\n                                                             1];\n                }\n                if (!should_load_carry_29746) {\n                    x_26419 = 0;\n                    x_26420 = 0.0F;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_28579\n}\n__kernel void testziscan_stage1_28636(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29788_backing_aligned_0,\n                                      int64_t res_26335, __global\n                                      unsigned char *mem_28987, __global\n                                      unsigned char *mem_28995,\n                                      int32_t num_threads_29782)\n{\n    #define segscan_group_sizze_28631 (testzisegscan_group_sizze_28630)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29788_backing_0 =\n                          (__local volatile\n            ",
                   "               char *) scan_arr_mem_29788_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29783;\n    int32_t local_tid_29784;\n    int64_t group_sizze_29787;\n    int32_t wave_sizze_29786;\n    int32_t group_tid_29785;\n    \n    global_tid_29783 = get_global_id(0);\n    local_tid_29784 = get_local_id(0);\n    group_sizze_29787 = get_local_size(0);\n    wave_sizze_29786 = LOCKSTEP_WIDTH;\n    group_tid_29785 = get_group_id(0);\n    \n    int32_t phys_tid_28636;\n    \n    phys_tid_28636 = global_tid_29783;\n    \n    __local char *scan_arr_mem_29788;\n    \n    scan_arr_mem_29788 = (__local char *) scan_arr_mem_29788_backing_0;\n    \n    int64_t x_26516;\n    int64_t x_26517;\n    \n    x_26516 = 0;\n    for (int64_t j_29790 = 0; j_29790 < sdiv_up64(res_26335,\n                                                  sext_i32_i64(num_threads_29782));\n         j_29790++) {\n        int64_t chunk_offset_29791 = segscan_group_sizze_28631 * j_29790 +\n                sext_i32_i64(group_tid_29785) * (segscan_group_sizze_28631 *\n                                                 sdiv_up64(res_26335,\n                                                           sext_i32_i64(num_threads_29782)));\n        int64_t flat_idx_29792 = chunk_offset_29791 +\n                sext_i32_i64(local_tid_29784);\n        int64_t gtid_28635 = flat_idx_29792;\n        \n        // threads in bounds read input\n        {\n            if (slt64(gtid_28635, res_26335)) {\n                int64_t i_p_o_28817 = add64(1, gtid_28635);\n                int64_t rot_i_28818 = smod64(i_p_o_28817, res_26335);\n                bool x_26519 = ((__global bool *) mem_28987)[rot_i_28818];\n                int64_t res_26520 = btoi_bool_i64(x_26519);\n                \n                // write to-scan values to parameters\n                {\n                    x_26517 = res_26520;\n                }\n                // write mapped values results to global memory\n                { }\n            }\n        }\n     ",
                   "   // do one intra-group scan operation\n        {\n            // maybe restore some to-scan values to parameters, or read neutral\n            {\n                if (!slt64(gtid_28635, res_26335)) {\n                    x_26517 = 0;\n                }\n            }\n            // combine with carry and write to local memory\n            {\n                int64_t res_26518 = add64(x_26516, x_26517);\n                \n                ((__local\n                  int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)] =\n                    res_26518;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            int64_t x_29793;\n            int64_t x_29794;\n            int64_t x_29796;\n            int64_t x_29797;\n            bool ltid_in_bounds_29799;\n            \n            ltid_in_bounds_29799 = slt64(sext_i32_i64(local_tid_29784),\n                                         segscan_group_sizze_28631);\n            \n            int32_t skip_threads_29800;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_29799) {\n                    x_29794 = ((volatile __local\n                                int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)];\n                    if ((local_tid_29784 - squot32(local_tid_29784, 32) * 32) ==\n                        0) {\n                        x_29793 = x_29794;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29800 = 1;\n                while (slt32(skip_threads_29800, 32)) {\n                    if (sle32(skip_threads_29800, local_tid_29784 -\n                              squot32(local_tid_29784, 32) * 32) &&\n                        ltid_in_bounds_29799) {\n                        // read operands\n                        {\n                            x_29793 = ((volatile __local\n                                        int64_t *) scan_arr_mem_29788)[s",
                   "ext_i32_i64(local_tid_29784) -\n                                                                       sext_i32_i64(skip_threads_29800)];\n                        }\n                        // perform operation\n                        {\n                            int64_t res_29795 = add64(x_29793, x_29794);\n                            \n                            x_29793 = res_29795;\n                        }\n                    }\n                    if (sle32(wave_sizze_29786, skip_threads_29800)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29800, local_tid_29784 -\n                              squot32(local_tid_29784, 32) * 32) &&\n                        ltid_in_bounds_29799) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)] =\n                                x_29793;\n                            x_29794 = x_29793;\n                        }\n                    }\n                    if (sle32(wave_sizze_29786, skip_threads_29800)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29800 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_29784 - squot32(local_tid_29784, 32) * 32) ==\n                    31 && ltid_in_bounds_29799) {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29788)[sext_i32_i64(squot32(local_tid_29784,\n                                                                          32))] =\n                        x_29793;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n ",
                   "           {\n                int32_t skip_threads_29801;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_29784, 32) == 0 &&\n                        ltid_in_bounds_29799) {\n                        x_29797 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)];\n                        if ((local_tid_29784 - squot32(local_tid_29784, 32) *\n                             32) == 0) {\n                            x_29796 = x_29797;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29801 = 1;\n                    while (slt32(skip_threads_29801, 32)) {\n                        if (sle32(skip_threads_29801, local_tid_29784 -\n                                  squot32(local_tid_29784, 32) * 32) &&\n                            (squot32(local_tid_29784, 32) == 0 &&\n                             ltid_in_bounds_29799)) {\n                            // read operands\n                            {\n                                x_29796 = ((volatile __local\n                                            int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784) -\n                                                                           sext_i32_i64(skip_threads_29801)];\n                            }\n                            // perform operation\n                            {\n                                int64_t res_29798 = add64(x_29796, x_29797);\n                                \n                                x_29796 = res_29798;\n                            }\n                        }\n                        if (sle32(wave_sizze_29786, skip_threads_29801)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29801, local_tid_29784 -\n     ",
                   "                             squot32(local_tid_29784, 32) * 32) &&\n                            (squot32(local_tid_29784, 32) == 0 &&\n                             ltid_in_bounds_29799)) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)] =\n                                    x_29796;\n                                x_29797 = x_29796;\n                            }\n                        }\n                        if (sle32(wave_sizze_29786, skip_threads_29801)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29801 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // carry-in for every block except the first\n            {\n                if (!(squot32(local_tid_29784, 32) == 0 ||\n                      !ltid_in_bounds_29799)) {\n                    // read operands\n                    {\n                        x_29794 = x_29793;\n                        x_29793 = ((__local\n                                    int64_t *) scan_arr_mem_29788)[sext_i32_i64(squot32(local_tid_29784,\n                                                                                        32)) -\n                                                                   1];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_29795 = add64(x_29793, x_29794);\n                        \n                        x_29793 = res_29795;\n                    }\n                    // write final result\n                    {\n                        ((__local\n                          int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)] =\n                            x_29793;\n                    }\n                }\n            }\n            ba",
                   "rrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_29784, 32) == 0) {\n                    ((__local\n                      int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)] =\n                        x_29794;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // threads in bounds write partial scan result\n            {\n                if (slt64(gtid_28635, res_26335)) {\n                    ((__global int64_t *) mem_28995)[gtid_28635] = ((__local\n                                                                     int64_t *) scan_arr_mem_29788)[sext_i32_i64(local_tid_29784)];\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // first thread reads last element as carry-in for next iteration\n            {\n                bool crosses_segment_29802 = 0;\n                bool should_load_carry_29803 = local_tid_29784 == 0 &&\n                     !crosses_segment_29802;\n                \n                if (should_load_carry_29803) {\n                    x_26516 = ((__local\n                                int64_t *) scan_arr_mem_29788)[segscan_group_sizze_28631 -\n                                                               1];\n                }\n                if (!should_load_carry_29803) {\n                    x_26516 = 0;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segscan_group_sizze_28631\n}\n__kernel void testziscan_stage2_28535(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29371_backing_aligned_0,\n                                      int64_t flat_dim_26302, __global\n                                      unsigned char *mem_28967,\n                                      int64_t stage1_num_groups_29343,\n                            ",
                   "          int32_t num_threads_29344)\n{\n    #define segscan_group_sizze_28530 (testzisegscan_group_sizze_28529)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29371_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29371_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29366;\n    int32_t local_tid_29367;\n    int64_t group_sizze_29370;\n    int32_t wave_sizze_29369;\n    int32_t group_tid_29368;\n    \n    global_tid_29366 = get_global_id(0);\n    local_tid_29367 = get_local_id(0);\n    group_sizze_29370 = get_local_size(0);\n    wave_sizze_29369 = LOCKSTEP_WIDTH;\n    group_tid_29368 = get_group_id(0);\n    \n    int32_t phys_tid_28535;\n    \n    phys_tid_28535 = global_tid_29366;\n    \n    __local char *scan_arr_mem_29371;\n    \n    scan_arr_mem_29371 = (__local char *) scan_arr_mem_29371_backing_0;\n    \n    int64_t flat_idx_29373;\n    \n    flat_idx_29373 = (sext_i32_i64(local_tid_29367) + 1) *\n        (segscan_group_sizze_28530 * sdiv_up64(flat_dim_26302,\n                                               sext_i32_i64(num_threads_29344))) -\n        1;\n    \n    int64_t gtid_28534;\n    \n    gtid_28534 = flat_idx_29373;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_28534, flat_dim_26302)) {\n            ((__local\n              int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)] =\n                ((__global int64_t *) mem_28967)[gtid_28534];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_26321;\n    int64_t x_26322;\n    int64_t x_29374;\n    int64_t x_29375;\n    bool ltid_in_bounds_29377;\n    \n    ltid_in_bounds_29377 = slt64(sext_i32_i64(local_tid_29367),\n                                 stage1_",
                   "num_groups_29343);\n    \n    int32_t skip_threads_29378;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29377) {\n            x_26322 = ((volatile __local\n                        int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)];\n            if ((local_tid_29367 - squot32(local_tid_29367, 32) * 32) == 0) {\n                x_26321 = x_26322;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_29378 = 1;\n        while (slt32(skip_threads_29378, 32)) {\n            if (sle32(skip_threads_29378, local_tid_29367 -\n                      squot32(local_tid_29367, 32) * 32) &&\n                ltid_in_bounds_29377) {\n                // read operands\n                {\n                    x_26321 = ((volatile __local\n                                int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367) -\n                                                               sext_i32_i64(skip_threads_29378)];\n                }\n                // perform operation\n                {\n                    int64_t res_26323 = add64(x_26321, x_26322);\n                    \n                    x_26321 = res_26323;\n                }\n            }\n            if (sle32(wave_sizze_29369, skip_threads_29378)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29378, local_tid_29367 -\n                      squot32(local_tid_29367, 32) * 32) &&\n                ltid_in_bounds_29377) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)] =\n                        x_26321;\n                    x_26322 = x_26321;\n                }\n            }\n            if (sle32(wave_sizze_29369, skip_threads_29378)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_29378 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FEN",
                   "CE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_29367 - squot32(local_tid_29367, 32) * 32) == 31 &&\n            ltid_in_bounds_29377) {\n            ((volatile __local\n              int64_t *) scan_arr_mem_29371)[sext_i32_i64(squot32(local_tid_29367,\n                                                                  32))] =\n                x_26321;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29379;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_29367, 32) == 0 && ltid_in_bounds_29377) {\n                x_29375 = ((volatile __local\n                            int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)];\n                if ((local_tid_29367 - squot32(local_tid_29367, 32) * 32) ==\n                    0) {\n                    x_29374 = x_29375;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29379 = 1;\n            while (slt32(skip_threads_29379, 32)) {\n                if (sle32(skip_threads_29379, local_tid_29367 -\n                          squot32(local_tid_29367, 32) * 32) &&\n                    (squot32(local_tid_29367, 32) == 0 &&\n                     ltid_in_bounds_29377)) {\n                    // read operands\n                    {\n                        x_29374 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367) -\n                                                                   sext_i32_i64(skip_threads_29379)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_29376 = add64(x_29374, x_29375);\n                        \n                        x_29374 = res_29376;\n                    }\n                }\n     ",
                   "           if (sle32(wave_sizze_29369, skip_threads_29379)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29379, local_tid_29367 -\n                          squot32(local_tid_29367, 32) * 32) &&\n                    (squot32(local_tid_29367, 32) == 0 &&\n                     ltid_in_bounds_29377)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)] =\n                            x_29374;\n                        x_29375 = x_29374;\n                    }\n                }\n                if (sle32(wave_sizze_29369, skip_threads_29379)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29379 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_29367, 32) == 0 || !ltid_in_bounds_29377)) {\n            // read operands\n            {\n                x_26322 = x_26321;\n                x_26321 = ((__local\n                            int64_t *) scan_arr_mem_29371)[sext_i32_i64(squot32(local_tid_29367,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_26323 = add64(x_26321, x_26322);\n                \n                x_26321 = res_26323;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)] =\n                    x_26321;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_29367, 32) == 0) {\n            ((__local\n              int64_t *) scan_ar",
                   "r_mem_29371)[sext_i32_i64(local_tid_29367)] =\n                x_26322;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_28534, flat_dim_26302)) {\n            ((__global int64_t *) mem_28967)[gtid_28534] = ((__local\n                                                             int64_t *) scan_arr_mem_29371)[sext_i32_i64(local_tid_29367)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_28530\n}\n__kernel void testziscan_stage2_28568(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29620_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29618_backing_aligned_1,\n                                      int64_t res_26335, __global\n                                      unsigned char *mem_28978, __global\n                                      unsigned char *mem_28980,\n                                      int64_t stage1_num_groups_29580,\n                                      int32_t num_threads_29581)\n{\n    #define segscan_group_sizze_28563 (testzisegscan_group_sizze_28562)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29620_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_29620_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29618_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29618_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29613;\n    int32_t local_tid_29614;\n    int64_t group_sizze_29617;\n    int32_t wave_sizze_29616;\n    int32_t group_tid_29615;\n    \n    global_tid_29613 = get_global_id(0);\n    local_tid_29614 = get_",
                   "local_id(0);\n    group_sizze_29617 = get_local_size(0);\n    wave_sizze_29616 = LOCKSTEP_WIDTH;\n    group_tid_29615 = get_group_id(0);\n    \n    int32_t phys_tid_28568;\n    \n    phys_tid_28568 = global_tid_29613;\n    \n    __local char *scan_arr_mem_29618;\n    __local char *scan_arr_mem_29620;\n    \n    scan_arr_mem_29618 = (__local char *) scan_arr_mem_29618_backing_0;\n    scan_arr_mem_29620 = (__local char *) scan_arr_mem_29620_backing_1;\n    \n    int64_t flat_idx_29622;\n    \n    flat_idx_29622 = (sext_i32_i64(local_tid_29614) + 1) *\n        (segscan_group_sizze_28563 * sdiv_up64(res_26335,\n                                               sext_i32_i64(num_threads_29581))) -\n        1;\n    \n    int64_t gtid_28567;\n    \n    gtid_28567 = flat_idx_29622;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_28567, res_26335)) {\n            ((__local\n              bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)] =\n                ((__global bool *) mem_28978)[gtid_28567];\n            ((__local\n              int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)] =\n                ((__global int64_t *) mem_28980)[gtid_28567];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_26354;\n    int64_t x_26355;\n    bool x_26356;\n    int64_t x_26357;\n    bool x_29623;\n    int64_t x_29624;\n    bool x_29625;\n    int64_t x_29626;\n    bool ltid_in_bounds_29630;\n    \n    ltid_in_bounds_29630 = slt64(sext_i32_i64(local_tid_29614),\n                                 stage1_num_groups_29580);\n    \n    int32_t skip_threads_29631;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29630) {\n            x_26356 = ((volatile __local\n                        bool *) scan_arr_mem_29618)[sext_i3",
                   "2_i64(local_tid_29614)];\n            x_26357 = ((volatile __local\n                        int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)];\n            if ((local_tid_29614 - squot32(local_tid_29614, 32) * 32) == 0) {\n                x_26354 = x_26356;\n                x_26355 = x_26357;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_29631 = 1;\n        while (slt32(skip_threads_29631, 32)) {\n            if (sle32(skip_threads_29631, local_tid_29614 -\n                      squot32(local_tid_29614, 32) * 32) &&\n                ltid_in_bounds_29630) {\n                // read operands\n                {\n                    x_26354 = ((volatile __local\n                                bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614) -\n                                                            sext_i32_i64(skip_threads_29631)];\n                    x_26355 = ((volatile __local\n                                int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614) -\n                                                               sext_i32_i64(skip_threads_29631)];\n                }\n                // perform operation\n                {\n                    bool res_26358 = x_26354 || x_26356;\n                    int64_t res_26359;\n                    \n                    if (x_26356) {\n                        res_26359 = x_26357;\n                    } else {\n                        int64_t res_26360 = add64(x_26355, x_26357);\n                        \n                        res_26359 = res_26360;\n                    }\n                    x_26354 = res_26358;\n                    x_26355 = res_26359;\n                }\n            }\n            if (sle32(wave_sizze_29616, skip_threads_29631)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29631, local_tid_29614 -\n                      squot32(local_tid_29614, 32) * 32) &&\n                ltid_in",
                   "_bounds_29630) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)] =\n                        x_26354;\n                    x_26356 = x_26354;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)] =\n                        x_26355;\n                    x_26357 = x_26355;\n                }\n            }\n            if (sle32(wave_sizze_29616, skip_threads_29631)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_29631 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_29614 - squot32(local_tid_29614, 32) * 32) == 31 &&\n            ltid_in_bounds_29630) {\n            ((volatile __local\n              bool *) scan_arr_mem_29618)[sext_i32_i64(squot32(local_tid_29614,\n                                                               32))] = x_26354;\n            ((volatile __local\n              int64_t *) scan_arr_mem_29620)[sext_i32_i64(squot32(local_tid_29614,\n                                                                  32))] =\n                x_26355;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29632;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_29614, 32) == 0 && ltid_in_bounds_29630) {\n                x_29625 = ((volatile __local\n                            bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)];\n                x_29626 = ((volatile __local\n                            int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)];\n                if ((local_tid_29614 - squot32(local_tid_29614, 32) * 32) ==\n                    0) {\n                    x_29623 = ",
                   "x_29625;\n                    x_29624 = x_29626;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29632 = 1;\n            while (slt32(skip_threads_29632, 32)) {\n                if (sle32(skip_threads_29632, local_tid_29614 -\n                          squot32(local_tid_29614, 32) * 32) &&\n                    (squot32(local_tid_29614, 32) == 0 &&\n                     ltid_in_bounds_29630)) {\n                    // read operands\n                    {\n                        x_29623 = ((volatile __local\n                                    bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614) -\n                                                                sext_i32_i64(skip_threads_29632)];\n                        x_29624 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614) -\n                                                                   sext_i32_i64(skip_threads_29632)];\n                    }\n                    // perform operation\n                    {\n                        bool res_29627 = x_29623 || x_29625;\n                        int64_t res_29628;\n                        \n                        if (x_29625) {\n                            res_29628 = x_29626;\n                        } else {\n                            int64_t res_29629 = add64(x_29624, x_29626);\n                            \n                            res_29628 = res_29629;\n                        }\n                        x_29623 = res_29627;\n                        x_29624 = res_29628;\n                    }\n                }\n                if (sle32(wave_sizze_29616, skip_threads_29632)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29632, local_tid_29614 -\n                          squot32(local_tid_29614, 32) * 32) &&\n                    (squot32(local_tid_29614, 32) == 0 &",
                   "&\n                     ltid_in_bounds_29630)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)] =\n                            x_29623;\n                        x_29625 = x_29623;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)] =\n                            x_29624;\n                        x_29626 = x_29624;\n                    }\n                }\n                if (sle32(wave_sizze_29616, skip_threads_29632)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29632 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_29614, 32) == 0 || !ltid_in_bounds_29630)) {\n            // read operands\n            {\n                x_26356 = x_26354;\n                x_26357 = x_26355;\n                x_26354 = ((__local\n                            bool *) scan_arr_mem_29618)[sext_i32_i64(squot32(local_tid_29614,\n                                                                             32)) -\n                                                        1];\n                x_26355 = ((__local\n                            int64_t *) scan_arr_mem_29620)[sext_i32_i64(squot32(local_tid_29614,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_26358 = x_26354 || x_26356;\n                int64_t res_26359;\n                \n                if (x_26356) {\n                    res_26359 = x_26357;\n                } else {\n                    int64_t res_26360 = add64(x_26355, x_26357);\n                    \n                    res_26359 = res_2636",
                   "0;\n                }\n                x_26354 = res_26358;\n                x_26355 = res_26359;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)] =\n                    x_26354;\n                ((__local\n                  int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)] =\n                    x_26355;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_29614, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)] =\n                x_26356;\n            ((__local\n              int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)] =\n                x_26357;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_28567, res_26335)) {\n            ((__global bool *) mem_28978)[gtid_28567] = ((__local\n                                                          bool *) scan_arr_mem_29618)[sext_i32_i64(local_tid_29614)];\n            ((__global int64_t *) mem_28980)[gtid_28567] = ((__local\n                                                             int64_t *) scan_arr_mem_29620)[sext_i32_i64(local_tid_29614)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_28563\n}\n__kernel void testziscan_stage2_28576(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29687_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29685_backing_aligned_1,\n                                      int64_t res_26335, __global\n                                      unsigned char *mem_28983, __global\n                                      unsigned char *mem_28985,\n  ",
                   "                                    int64_t stage1_num_groups_29647,\n                                      int32_t num_threads_29648)\n{\n    #define segscan_group_sizze_28571 (testzisegscan_group_sizze_28570)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29687_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_29687_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29685_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29685_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29680;\n    int32_t local_tid_29681;\n    int64_t group_sizze_29684;\n    int32_t wave_sizze_29683;\n    int32_t group_tid_29682;\n    \n    global_tid_29680 = get_global_id(0);\n    local_tid_29681 = get_local_id(0);\n    group_sizze_29684 = get_local_size(0);\n    wave_sizze_29683 = LOCKSTEP_WIDTH;\n    group_tid_29682 = get_group_id(0);\n    \n    int32_t phys_tid_28576;\n    \n    phys_tid_28576 = global_tid_29680;\n    \n    __local char *scan_arr_mem_29685;\n    __local char *scan_arr_mem_29687;\n    \n    scan_arr_mem_29685 = (__local char *) scan_arr_mem_29685_backing_0;\n    scan_arr_mem_29687 = (__local char *) scan_arr_mem_29687_backing_1;\n    \n    int64_t flat_idx_29689;\n    \n    flat_idx_29689 = (sext_i32_i64(local_tid_29681) + 1) *\n        (segscan_group_sizze_28571 * sdiv_up64(res_26335,\n                                               sext_i32_i64(num_threads_29648))) -\n        1;\n    \n    int64_t gtid_28575;\n    \n    gtid_28575 = flat_idx_29689;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_28575, res_26335)) {\n            ((__local\n              bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)] =\n                ((__global bool *) mem_28983)[gtid_28575];\n            ((__local\n  ",
                   "            int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)] =\n                ((__global int64_t *) mem_28985)[gtid_28575];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)] = 0;\n            ((__local\n              int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_26393;\n    int64_t x_26394;\n    bool x_26395;\n    int64_t x_26396;\n    bool x_29690;\n    int64_t x_29691;\n    bool x_29692;\n    int64_t x_29693;\n    bool ltid_in_bounds_29697;\n    \n    ltid_in_bounds_29697 = slt64(sext_i32_i64(local_tid_29681),\n                                 stage1_num_groups_29647);\n    \n    int32_t skip_threads_29698;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29697) {\n            x_26395 = ((volatile __local\n                        bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)];\n            x_26396 = ((volatile __local\n                        int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)];\n            if ((local_tid_29681 - squot32(local_tid_29681, 32) * 32) == 0) {\n                x_26393 = x_26395;\n                x_26394 = x_26396;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_29698 = 1;\n        while (slt32(skip_threads_29698, 32)) {\n            if (sle32(skip_threads_29698, local_tid_29681 -\n                      squot32(local_tid_29681, 32) * 32) &&\n                ltid_in_bounds_29697) {\n                // read operands\n                {\n                    x_26393 = ((volatile __local\n                                bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681) -\n                                                            sext_i32_i64(skip_threads_29698)];\n                    x_26394 = ((volatile __local\n                                int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_2",
                   "9681) -\n                                                               sext_i32_i64(skip_threads_29698)];\n                }\n                // perform operation\n                {\n                    bool res_26397 = x_26393 || x_26395;\n                    int64_t res_26398;\n                    \n                    if (x_26395) {\n                        res_26398 = x_26396;\n                    } else {\n                        int64_t res_26399 = add64(x_26394, x_26396);\n                        \n                        res_26398 = res_26399;\n                    }\n                    x_26393 = res_26397;\n                    x_26394 = res_26398;\n                }\n            }\n            if (sle32(wave_sizze_29683, skip_threads_29698)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29698, local_tid_29681 -\n                      squot32(local_tid_29681, 32) * 32) &&\n                ltid_in_bounds_29697) {\n                // write result\n                {\n                    ((volatile __local\n                      bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)] =\n                        x_26393;\n                    x_26395 = x_26393;\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)] =\n                        x_26394;\n                    x_26396 = x_26394;\n                }\n            }\n            if (sle32(wave_sizze_29683, skip_threads_29698)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_29698 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_29681 - squot32(local_tid_29681, 32) * 32) == 31 &&\n            ltid_in_bounds_29697) {\n            ((volatile __local\n              bool *) scan_arr_mem_29685)[sext_i32_i64(squot32(local_tid_29681,\n                                                            ",
                   "   32))] = x_26393;\n            ((volatile __local\n              int64_t *) scan_arr_mem_29687)[sext_i32_i64(squot32(local_tid_29681,\n                                                                  32))] =\n                x_26394;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29699;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_29681, 32) == 0 && ltid_in_bounds_29697) {\n                x_29692 = ((volatile __local\n                            bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)];\n                x_29693 = ((volatile __local\n                            int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)];\n                if ((local_tid_29681 - squot32(local_tid_29681, 32) * 32) ==\n                    0) {\n                    x_29690 = x_29692;\n                    x_29691 = x_29693;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29699 = 1;\n            while (slt32(skip_threads_29699, 32)) {\n                if (sle32(skip_threads_29699, local_tid_29681 -\n                          squot32(local_tid_29681, 32) * 32) &&\n                    (squot32(local_tid_29681, 32) == 0 &&\n                     ltid_in_bounds_29697)) {\n                    // read operands\n                    {\n                        x_29690 = ((volatile __local\n                                    bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681) -\n                                                                sext_i32_i64(skip_threads_29699)];\n                        x_29691 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681) -\n                                                                   sext_i32_i64(skip_threads_29699)];\n               ",
                   "     }\n                    // perform operation\n                    {\n                        bool res_29694 = x_29690 || x_29692;\n                        int64_t res_29695;\n                        \n                        if (x_29692) {\n                            res_29695 = x_29693;\n                        } else {\n                            int64_t res_29696 = add64(x_29691, x_29693);\n                            \n                            res_29695 = res_29696;\n                        }\n                        x_29690 = res_29694;\n                        x_29691 = res_29695;\n                    }\n                }\n                if (sle32(wave_sizze_29683, skip_threads_29699)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29699, local_tid_29681 -\n                          squot32(local_tid_29681, 32) * 32) &&\n                    (squot32(local_tid_29681, 32) == 0 &&\n                     ltid_in_bounds_29697)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)] =\n                            x_29690;\n                        x_29692 = x_29690;\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)] =\n                            x_29691;\n                        x_29693 = x_29691;\n                    }\n                }\n                if (sle32(wave_sizze_29683, skip_threads_29699)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29699 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_29681, 32) == 0 || !ltid_in_bounds_29697)) {\n            // read operands\n            {\n                x_26395 = x_26393;\n                x_26396 = x_26394",
                   ";\n                x_26393 = ((__local\n                            bool *) scan_arr_mem_29685)[sext_i32_i64(squot32(local_tid_29681,\n                                                                             32)) -\n                                                        1];\n                x_26394 = ((__local\n                            int64_t *) scan_arr_mem_29687)[sext_i32_i64(squot32(local_tid_29681,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                bool res_26397 = x_26393 || x_26395;\n                int64_t res_26398;\n                \n                if (x_26395) {\n                    res_26398 = x_26396;\n                } else {\n                    int64_t res_26399 = add64(x_26394, x_26396);\n                    \n                    res_26398 = res_26399;\n                }\n                x_26393 = res_26397;\n                x_26394 = res_26398;\n            }\n            // write final result\n            {\n                ((__local\n                  bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)] =\n                    x_26393;\n                ((__local\n                  int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)] =\n                    x_26394;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_29681, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)] =\n                x_26395;\n            ((__local\n              int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)] =\n                x_26396;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_28575, res_26335)) {\n            ((__global bool *) mem_28983)[gtid_28575] = ((__local",
                   "\n                                                          bool *) scan_arr_mem_29685)[sext_i32_i64(local_tid_29681)];\n            ((__global int64_t *) mem_28985)[gtid_28575] = ((__local\n                                                             int64_t *) scan_arr_mem_29687)[sext_i32_i64(local_tid_29681)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_28571\n}\n__kernel void testziscan_stage2_28584(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29754_backing_aligned_0,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29752_backing_aligned_1,\n                                      int64_t res_26335, __global\n                                      unsigned char *mem_28990, __global\n                                      unsigned char *mem_28992,\n                                      int64_t stage1_num_groups_29714,\n                                      int32_t num_threads_29715)\n{\n    #define segscan_group_sizze_28579 (testzisegscan_group_sizze_28578)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29754_backing_1 =\n                          (__local volatile\n                           char *) scan_arr_mem_29754_backing_aligned_0;\n    __local volatile char *restrict scan_arr_mem_29752_backing_0 =\n                          (__local volatile\n                           char *) scan_arr_mem_29752_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29747;\n    int32_t local_tid_29748;\n    int64_t group_sizze_29751;\n    int32_t wave_sizze_29750;\n    int32_t group_tid_29749;\n    \n    global_tid_29747 = get_global_id(0);\n    local_tid_29748 = get_local_id(0);\n    group_sizze_29751 = get_local_size(0);\n    wave_sizze_29750 = LOCKSTEP_WIDTH;\n    group",
                   "_tid_29749 = get_group_id(0);\n    \n    int32_t phys_tid_28584;\n    \n    phys_tid_28584 = global_tid_29747;\n    \n    __local char *scan_arr_mem_29752;\n    __local char *scan_arr_mem_29754;\n    \n    scan_arr_mem_29752 = (__local char *) scan_arr_mem_29752_backing_0;\n    scan_arr_mem_29754 = (__local char *) scan_arr_mem_29754_backing_1;\n    \n    int64_t flat_idx_29756;\n    \n    flat_idx_29756 = (sext_i32_i64(local_tid_29748) + 1) *\n        (segscan_group_sizze_28579 * sdiv_up64(res_26335,\n                                               sext_i32_i64(num_threads_29715))) -\n        1;\n    \n    int64_t gtid_28583;\n    \n    gtid_28583 = flat_idx_29756;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_28583, res_26335)) {\n            ((__local\n              bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)] =\n                ((__global bool *) mem_28990)[gtid_28583];\n            ((__local\n              float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)] =\n                ((__global float *) mem_28992)[gtid_28583];\n        } else {\n            ((__local\n              bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)] = 0;\n            ((__local\n              float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)] =\n                0.0F;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    bool x_26419;\n    float x_26420;\n    bool x_26421;\n    float x_26422;\n    bool x_29757;\n    float x_29758;\n    bool x_29759;\n    float x_29760;\n    bool ltid_in_bounds_29764;\n    \n    ltid_in_bounds_29764 = slt64(sext_i32_i64(local_tid_29748),\n                                 stage1_num_groups_29714);\n    \n    int32_t skip_threads_29765;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29764) {\n            x_26421 = ((volatile __local\n                        bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)];\n            x_26422 = ((volatile __local\n                        float *) ",
                   "scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)];\n            if ((local_tid_29748 - squot32(local_tid_29748, 32) * 32) == 0) {\n                x_26419 = x_26421;\n                x_26420 = x_26422;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_29765 = 1;\n        while (slt32(skip_threads_29765, 32)) {\n            if (sle32(skip_threads_29765, local_tid_29748 -\n                      squot32(local_tid_29748, 32) * 32) &&\n                ltid_in_bounds_29764) {\n                // read operands\n                {\n                    x_26419 = ((volatile __local\n                                bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748) -\n                                                            sext_i32_i64(skip_threads_29765)];\n                    x_26420 = ((volatile __local\n                                float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748) -\n                                                             sext_i32_i64(skip_threads_29765)];\n                }\n                // perform operation\n                {\n                    bool res_26423 = x_26419 || x_26421;\n                    float res_26424;\n                    \n                    if (x_26421) {\n                        res_26424 = x_26422;\n                    } else {\n                        float res_26425 = x_26420 + x_26422;\n                        \n                        res_26424 = res_26425;\n                    }\n                    x_26419 = res_26423;\n                    x_26420 = res_26424;\n                }\n            }\n            if (sle32(wave_sizze_29750, skip_threads_29765)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29765, local_tid_29748 -\n                      squot32(local_tid_29748, 32) * 32) &&\n                ltid_in_bounds_29764) {\n                // write result\n                {\n                    ((volatile __local\n         ",
                   "             bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)] =\n                        x_26419;\n                    x_26421 = x_26419;\n                    ((volatile __local\n                      float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)] =\n                        x_26420;\n                    x_26422 = x_26420;\n                }\n            }\n            if (sle32(wave_sizze_29750, skip_threads_29765)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_29765 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_29748 - squot32(local_tid_29748, 32) * 32) == 31 &&\n            ltid_in_bounds_29764) {\n            ((volatile __local\n              bool *) scan_arr_mem_29752)[sext_i32_i64(squot32(local_tid_29748,\n                                                               32))] = x_26419;\n            ((volatile __local\n              float *) scan_arr_mem_29754)[sext_i32_i64(squot32(local_tid_29748,\n                                                                32))] = x_26420;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29766;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_29748, 32) == 0 && ltid_in_bounds_29764) {\n                x_29759 = ((volatile __local\n                            bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)];\n                x_29760 = ((volatile __local\n                            float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)];\n                if ((local_tid_29748 - squot32(local_tid_29748, 32) * 32) ==\n                    0) {\n                    x_29757 = x_29759;\n                    x_29758 = x_29760;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers n",
                   "eeded)\n        {\n            skip_threads_29766 = 1;\n            while (slt32(skip_threads_29766, 32)) {\n                if (sle32(skip_threads_29766, local_tid_29748 -\n                          squot32(local_tid_29748, 32) * 32) &&\n                    (squot32(local_tid_29748, 32) == 0 &&\n                     ltid_in_bounds_29764)) {\n                    // read operands\n                    {\n                        x_29757 = ((volatile __local\n                                    bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748) -\n                                                                sext_i32_i64(skip_threads_29766)];\n                        x_29758 = ((volatile __local\n                                    float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748) -\n                                                                 sext_i32_i64(skip_threads_29766)];\n                    }\n                    // perform operation\n                    {\n                        bool res_29761 = x_29757 || x_29759;\n                        float res_29762;\n                        \n                        if (x_29759) {\n                            res_29762 = x_29760;\n                        } else {\n                            float res_29763 = x_29758 + x_29760;\n                            \n                            res_29762 = res_29763;\n                        }\n                        x_29757 = res_29761;\n                        x_29758 = res_29762;\n                    }\n                }\n                if (sle32(wave_sizze_29750, skip_threads_29766)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29766, local_tid_29748 -\n                          squot32(local_tid_29748, 32) * 32) &&\n                    (squot32(local_tid_29748, 32) == 0 &&\n                     ltid_in_bounds_29764)) {\n                    // write result\n                    {\n                        ((volatile __local\n    ",
                   "                      bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)] =\n                            x_29757;\n                        x_29759 = x_29757;\n                        ((volatile __local\n                          float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)] =\n                            x_29758;\n                        x_29760 = x_29758;\n                    }\n                }\n                if (sle32(wave_sizze_29750, skip_threads_29766)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29766 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_29748, 32) == 0 || !ltid_in_bounds_29764)) {\n            // read operands\n            {\n                x_26421 = x_26419;\n                x_26422 = x_26420;\n                x_26419 = ((__local\n                            bool *) scan_arr_mem_29752)[sext_i32_i64(squot32(local_tid_29748,\n                                                                             32)) -\n                                                        1];\n                x_26420 = ((__local\n                            float *) scan_arr_mem_29754)[sext_i32_i64(squot32(local_tid_29748,\n                                                                              32)) -\n                                                         1];\n            }\n            // perform operation\n            {\n                bool res_26423 = x_26419 || x_26421;\n                float res_26424;\n                \n                if (x_26421) {\n                    res_26424 = x_26422;\n                } else {\n                    float res_26425 = x_26420 + x_26422;\n                    \n                    res_26424 = res_26425;\n                }\n                x_26419 = res_26423;\n                x_26420 = res_26424;\n            }\n            // write final result\n            {\n              ",
                   "  ((__local\n                  bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)] =\n                    x_26419;\n                ((__local\n                  float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)] =\n                    x_26420;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_29748, 32) == 0) {\n            ((__local\n              bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)] =\n                x_26421;\n            ((__local\n              float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)] =\n                x_26422;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_28583, res_26335)) {\n            ((__global bool *) mem_28990)[gtid_28583] = ((__local\n                                                          bool *) scan_arr_mem_29752)[sext_i32_i64(local_tid_29748)];\n            ((__global float *) mem_28992)[gtid_28583] = ((__local\n                                                           float *) scan_arr_mem_29754)[sext_i32_i64(local_tid_29748)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_28579\n}\n__kernel void testziscan_stage2_28636(__global int *global_failure,\n                                      __local volatile\n                                      int64_t *scan_arr_mem_29809_backing_aligned_0,\n                                      int64_t res_26335, __global\n                                      unsigned char *mem_28995,\n                                      int64_t stage1_num_groups_29781,\n                                      int32_t num_threads_29782)\n{\n    #define segscan_group_sizze_28631 (testzisegscan_group_sizze_28630)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict scan_arr_mem_29809_backing_0 =\n                        ",
                   "  (__local volatile\n                           char *) scan_arr_mem_29809_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29804;\n    int32_t local_tid_29805;\n    int64_t group_sizze_29808;\n    int32_t wave_sizze_29807;\n    int32_t group_tid_29806;\n    \n    global_tid_29804 = get_global_id(0);\n    local_tid_29805 = get_local_id(0);\n    group_sizze_29808 = get_local_size(0);\n    wave_sizze_29807 = LOCKSTEP_WIDTH;\n    group_tid_29806 = get_group_id(0);\n    \n    int32_t phys_tid_28636;\n    \n    phys_tid_28636 = global_tid_29804;\n    \n    __local char *scan_arr_mem_29809;\n    \n    scan_arr_mem_29809 = (__local char *) scan_arr_mem_29809_backing_0;\n    \n    int64_t flat_idx_29811;\n    \n    flat_idx_29811 = (sext_i32_i64(local_tid_29805) + 1) *\n        (segscan_group_sizze_28631 * sdiv_up64(res_26335,\n                                               sext_i32_i64(num_threads_29782))) -\n        1;\n    \n    int64_t gtid_28635;\n    \n    gtid_28635 = flat_idx_29811;\n    // threads in bound read carries; others get neutral element\n    {\n        if (slt64(gtid_28635, res_26335)) {\n            ((__local\n              int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)] =\n                ((__global int64_t *) mem_28995)[gtid_28635];\n        } else {\n            ((__local\n              int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)] = 0;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t x_26516;\n    int64_t x_26517;\n    int64_t x_29812;\n    int64_t x_29813;\n    bool ltid_in_bounds_29815;\n    \n    ltid_in_bounds_29815 = slt64(sext_i32_i64(local_tid_29805),\n                                 stage1_num_groups_29781);\n    \n    int32_t skip_threads_29816;\n    \n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_29815) {\n            x_26517 = ((volatile __local\n                        int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)];\n            if ((local_tid_29805 - squot",
                   "32(local_tid_29805, 32) * 32) == 0) {\n                x_26516 = x_26517;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_29816 = 1;\n        while (slt32(skip_threads_29816, 32)) {\n            if (sle32(skip_threads_29816, local_tid_29805 -\n                      squot32(local_tid_29805, 32) * 32) &&\n                ltid_in_bounds_29815) {\n                // read operands\n                {\n                    x_26516 = ((volatile __local\n                                int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805) -\n                                                               sext_i32_i64(skip_threads_29816)];\n                }\n                // perform operation\n                {\n                    int64_t res_26518 = add64(x_26516, x_26517);\n                    \n                    x_26516 = res_26518;\n                }\n            }\n            if (sle32(wave_sizze_29807, skip_threads_29816)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (sle32(skip_threads_29816, local_tid_29805 -\n                      squot32(local_tid_29805, 32) * 32) &&\n                ltid_in_bounds_29815) {\n                // write result\n                {\n                    ((volatile __local\n                      int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)] =\n                        x_26516;\n                    x_26517 = x_26516;\n                }\n            }\n            if (sle32(wave_sizze_29807, skip_threads_29816)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_29816 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_29805 - squot32(local_tid_29805, 32) * 32) == 31 &&\n            ltid_in_bounds_29815) {\n            ((volatile __local\n              int64_t *) scan_arr_mem_29809)[sext_i32_i64(squot32(local_tid_29805,\n       ",
                   "                                                           32))] =\n                x_26516;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_29817;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_29805, 32) == 0 && ltid_in_bounds_29815) {\n                x_29813 = ((volatile __local\n                            int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)];\n                if ((local_tid_29805 - squot32(local_tid_29805, 32) * 32) ==\n                    0) {\n                    x_29812 = x_29813;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29817 = 1;\n            while (slt32(skip_threads_29817, 32)) {\n                if (sle32(skip_threads_29817, local_tid_29805 -\n                          squot32(local_tid_29805, 32) * 32) &&\n                    (squot32(local_tid_29805, 32) == 0 &&\n                     ltid_in_bounds_29815)) {\n                    // read operands\n                    {\n                        x_29812 = ((volatile __local\n                                    int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805) -\n                                                                   sext_i32_i64(skip_threads_29817)];\n                    }\n                    // perform operation\n                    {\n                        int64_t res_29814 = add64(x_29812, x_29813);\n                        \n                        x_29812 = res_29814;\n                    }\n                }\n                if (sle32(wave_sizze_29807, skip_threads_29817)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29817, local_tid_29805 -\n                          squot32(local_tid_29805, 32) * 32) &&\n                    (squot32(local_tid_29805, 32)",
                   " == 0 &&\n                     ltid_in_bounds_29815)) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)] =\n                            x_29812;\n                        x_29813 = x_29812;\n                    }\n                }\n                if (sle32(wave_sizze_29807, skip_threads_29817)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29817 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // carry-in for every block except the first\n    {\n        if (!(squot32(local_tid_29805, 32) == 0 || !ltid_in_bounds_29815)) {\n            // read operands\n            {\n                x_26517 = x_26516;\n                x_26516 = ((__local\n                            int64_t *) scan_arr_mem_29809)[sext_i32_i64(squot32(local_tid_29805,\n                                                                                32)) -\n                                                           1];\n            }\n            // perform operation\n            {\n                int64_t res_26518 = add64(x_26516, x_26517);\n                \n                x_26516 = res_26518;\n            }\n            // write final result\n            {\n                ((__local\n                  int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)] =\n                    x_26516;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_29805, 32) == 0) {\n            ((__local\n              int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)] =\n                x_26517;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // threads in bounds write scanned carries\n    {\n        if (slt64(gtid_28635, res_26335)) {\n            ((__global int64_t *) mem_28995)[gtid_28635] = ((__local\n                    ",
                   "                                         int64_t *) scan_arr_mem_29809)[sext_i32_i64(local_tid_29805)];\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_28631\n}\n__kernel void testziscan_stage3_28535(__global int *global_failure,\n                                      int64_t flat_dim_26302,\n                                      int64_t num_groups_28532, __global\n                                      unsigned char *mem_28967,\n                                      int32_t num_threads_29344,\n                                      int32_t required_groups_29380)\n{\n    #define segscan_group_sizze_28530 (testzisegscan_group_sizze_28529)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29381;\n    int32_t local_tid_29382;\n    int64_t group_sizze_29385;\n    int32_t wave_sizze_29384;\n    int32_t group_tid_29383;\n    \n    global_tid_29381 = get_global_id(0);\n    local_tid_29382 = get_local_id(0);\n    group_sizze_29385 = get_local_size(0);\n    wave_sizze_29384 = LOCKSTEP_WIDTH;\n    group_tid_29383 = get_group_id(0);\n    \n    int32_t phys_tid_28535;\n    \n    phys_tid_28535 = global_tid_29381;\n    \n    int32_t phys_group_id_29386;\n    \n    phys_group_id_29386 = get_group_id(0);\n    for (int32_t i_29387 = 0; i_29387 < sdiv_up32(required_groups_29380 -\n                                                  phys_group_id_29386,\n                                                  sext_i64_i32(num_groups_28532));\n         i_29387++) {\n        int32_t virt_group_id_29388 = phys_group_id_29386 + i_29387 *\n                sext_i64_i32(num_groups_28532);\n        int64_t flat_idx_29389 = sext_i32_i64(virt_group_id_29388) *\n                segscan_group_sizze_28530 + sext_i32_i64(local_tid_29382);\n        int64_t gtid_28534 = flat_idx_29389;\n        int64_t orig_group_29390 = squot64(flat_idx_29389,\n                                           segscan_gr",
                   "oup_sizze_28530 *\n                                           sdiv_up64(flat_dim_26302,\n                                                     sext_i32_i64(num_threads_29344)));\n        int64_t carry_in_flat_idx_29391 = orig_group_29390 *\n                (segscan_group_sizze_28530 * sdiv_up64(flat_dim_26302,\n                                                       sext_i32_i64(num_threads_29344))) -\n                1;\n        \n        if (slt64(gtid_28534, flat_dim_26302)) {\n            if (!(orig_group_29390 == 0 || flat_idx_29389 == (orig_group_29390 +\n                                                              1) *\n                  (segscan_group_sizze_28530 * sdiv_up64(flat_dim_26302,\n                                                         sext_i32_i64(num_threads_29344))) -\n                  1)) {\n                int64_t x_26321;\n                int64_t x_26322;\n                \n                x_26321 = ((__global\n                            int64_t *) mem_28967)[carry_in_flat_idx_29391];\n                x_26322 = ((__global int64_t *) mem_28967)[gtid_28534];\n                \n                int64_t res_26323;\n                \n                res_26323 = add64(x_26321, x_26322);\n                x_26321 = res_26323;\n                ((__global int64_t *) mem_28967)[gtid_28534] = x_26321;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_28530\n}\n__kernel void testziscan_stage3_28568(__global int *global_failure,\n                                      int64_t res_26335,\n                                      int64_t num_groups_28565, __global\n                                      unsigned char *mem_28978, __global\n                                      unsigned char *mem_28980,\n                                      int32_t num_threads_29581,\n                                      int32_t required_groups_29633)\n{\n    #define segscan_group_sizze_28563 (testzisegscan_group_",
                   "sizze_28562)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29634;\n    int32_t local_tid_29635;\n    int64_t group_sizze_29638;\n    int32_t wave_sizze_29637;\n    int32_t group_tid_29636;\n    \n    global_tid_29634 = get_global_id(0);\n    local_tid_29635 = get_local_id(0);\n    group_sizze_29638 = get_local_size(0);\n    wave_sizze_29637 = LOCKSTEP_WIDTH;\n    group_tid_29636 = get_group_id(0);\n    \n    int32_t phys_tid_28568;\n    \n    phys_tid_28568 = global_tid_29634;\n    \n    int32_t phys_group_id_29639;\n    \n    phys_group_id_29639 = get_group_id(0);\n    for (int32_t i_29640 = 0; i_29640 < sdiv_up32(required_groups_29633 -\n                                                  phys_group_id_29639,\n                                                  sext_i64_i32(num_groups_28565));\n         i_29640++) {\n        int32_t virt_group_id_29641 = phys_group_id_29639 + i_29640 *\n                sext_i64_i32(num_groups_28565);\n        int64_t flat_idx_29642 = sext_i32_i64(virt_group_id_29641) *\n                segscan_group_sizze_28563 + sext_i32_i64(local_tid_29635);\n        int64_t gtid_28567 = flat_idx_29642;\n        int64_t orig_group_29643 = squot64(flat_idx_29642,\n                                           segscan_group_sizze_28563 *\n                                           sdiv_up64(res_26335,\n                                                     sext_i32_i64(num_threads_29581)));\n        int64_t carry_in_flat_idx_29644 = orig_group_29643 *\n                (segscan_group_sizze_28563 * sdiv_up64(res_26335,\n                                                       sext_i32_i64(num_threads_29581))) -\n                1;\n        \n        if (slt64(gtid_28567, res_26335)) {\n            if (!(orig_group_29643 == 0 || flat_idx_29642 == (orig_group_29643 +\n                                                              1) *\n                  (segscan_group_sizze_28",
                   "563 * sdiv_up64(res_26335,\n                                                         sext_i32_i64(num_threads_29581))) -\n                  1)) {\n                bool x_26354;\n                int64_t x_26355;\n                bool x_26356;\n                int64_t x_26357;\n                \n                x_26354 = ((__global\n                            bool *) mem_28978)[carry_in_flat_idx_29644];\n                x_26355 = ((__global\n                            int64_t *) mem_28980)[carry_in_flat_idx_29644];\n                x_26356 = ((__global bool *) mem_28978)[gtid_28567];\n                x_26357 = ((__global int64_t *) mem_28980)[gtid_28567];\n                \n                bool res_26358;\n                \n                res_26358 = x_26354 || x_26356;\n                \n                int64_t res_26359;\n                \n                if (x_26356) {\n                    res_26359 = x_26357;\n                } else {\n                    int64_t res_26360 = add64(x_26355, x_26357);\n                    \n                    res_26359 = res_26360;\n                }\n                x_26354 = res_26358;\n                x_26355 = res_26359;\n                ((__global bool *) mem_28978)[gtid_28567] = x_26354;\n                ((__global int64_t *) mem_28980)[gtid_28567] = x_26355;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_28563\n}\n__kernel void testziscan_stage3_28576(__global int *global_failure,\n                                      int64_t res_26335,\n                                      int64_t num_groups_28573, __global\n                                      unsigned char *mem_28983, __global\n                                      unsigned char *mem_28985,\n                                      int32_t num_threads_29648,\n                                      int32_t required_groups_29700)\n{\n    #define segscan_group_sizze_28571 (testzisegscan_group_sizze_28570)\n    \n ",
                   "   const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29701;\n    int32_t local_tid_29702;\n    int64_t group_sizze_29705;\n    int32_t wave_sizze_29704;\n    int32_t group_tid_29703;\n    \n    global_tid_29701 = get_global_id(0);\n    local_tid_29702 = get_local_id(0);\n    group_sizze_29705 = get_local_size(0);\n    wave_sizze_29704 = LOCKSTEP_WIDTH;\n    group_tid_29703 = get_group_id(0);\n    \n    int32_t phys_tid_28576;\n    \n    phys_tid_28576 = global_tid_29701;\n    \n    int32_t phys_group_id_29706;\n    \n    phys_group_id_29706 = get_group_id(0);\n    for (int32_t i_29707 = 0; i_29707 < sdiv_up32(required_groups_29700 -\n                                                  phys_group_id_29706,\n                                                  sext_i64_i32(num_groups_28573));\n         i_29707++) {\n        int32_t virt_group_id_29708 = phys_group_id_29706 + i_29707 *\n                sext_i64_i32(num_groups_28573);\n        int64_t flat_idx_29709 = sext_i32_i64(virt_group_id_29708) *\n                segscan_group_sizze_28571 + sext_i32_i64(local_tid_29702);\n        int64_t gtid_28575 = flat_idx_29709;\n        int64_t orig_group_29710 = squot64(flat_idx_29709,\n                                           segscan_group_sizze_28571 *\n                                           sdiv_up64(res_26335,\n                                                     sext_i32_i64(num_threads_29648)));\n        int64_t carry_in_flat_idx_29711 = orig_group_29710 *\n                (segscan_group_sizze_28571 * sdiv_up64(res_26335,\n                                                       sext_i32_i64(num_threads_29648))) -\n                1;\n        \n        if (slt64(gtid_28575, res_26335)) {\n            if (!(orig_group_29710 == 0 || flat_idx_29709 == (orig_group_29710 +\n                                                              1) *\n                  (segscan_group_sizze_28571 * sdiv_up64(res",
                   "_26335,\n                                                         sext_i32_i64(num_threads_29648))) -\n                  1)) {\n                bool x_26393;\n                int64_t x_26394;\n                bool x_26395;\n                int64_t x_26396;\n                \n                x_26393 = ((__global\n                            bool *) mem_28983)[carry_in_flat_idx_29711];\n                x_26394 = ((__global\n                            int64_t *) mem_28985)[carry_in_flat_idx_29711];\n                x_26395 = ((__global bool *) mem_28983)[gtid_28575];\n                x_26396 = ((__global int64_t *) mem_28985)[gtid_28575];\n                \n                bool res_26397;\n                \n                res_26397 = x_26393 || x_26395;\n                \n                int64_t res_26398;\n                \n                if (x_26395) {\n                    res_26398 = x_26396;\n                } else {\n                    int64_t res_26399 = add64(x_26394, x_26396);\n                    \n                    res_26398 = res_26399;\n                }\n                x_26393 = res_26397;\n                x_26394 = res_26398;\n                ((__global bool *) mem_28983)[gtid_28575] = x_26393;\n                ((__global int64_t *) mem_28985)[gtid_28575] = x_26394;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_28571\n}\n__kernel void testziscan_stage3_28584(__global int *global_failure,\n                                      int64_t res_26335,\n                                      int64_t num_groups_28581, __global\n                                      unsigned char *mem_28990, __global\n                                      unsigned char *mem_28992,\n                                      int32_t num_threads_29715,\n                                      int32_t required_groups_29767)\n{\n    #define segscan_group_sizze_28579 (testzisegscan_group_sizze_28578)\n    \n    const int block_",
                   "dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29768;\n    int32_t local_tid_29769;\n    int64_t group_sizze_29772;\n    int32_t wave_sizze_29771;\n    int32_t group_tid_29770;\n    \n    global_tid_29768 = get_global_id(0);\n    local_tid_29769 = get_local_id(0);\n    group_sizze_29772 = get_local_size(0);\n    wave_sizze_29771 = LOCKSTEP_WIDTH;\n    group_tid_29770 = get_group_id(0);\n    \n    int32_t phys_tid_28584;\n    \n    phys_tid_28584 = global_tid_29768;\n    \n    int32_t phys_group_id_29773;\n    \n    phys_group_id_29773 = get_group_id(0);\n    for (int32_t i_29774 = 0; i_29774 < sdiv_up32(required_groups_29767 -\n                                                  phys_group_id_29773,\n                                                  sext_i64_i32(num_groups_28581));\n         i_29774++) {\n        int32_t virt_group_id_29775 = phys_group_id_29773 + i_29774 *\n                sext_i64_i32(num_groups_28581);\n        int64_t flat_idx_29776 = sext_i32_i64(virt_group_id_29775) *\n                segscan_group_sizze_28579 + sext_i32_i64(local_tid_29769);\n        int64_t gtid_28583 = flat_idx_29776;\n        int64_t orig_group_29777 = squot64(flat_idx_29776,\n                                           segscan_group_sizze_28579 *\n                                           sdiv_up64(res_26335,\n                                                     sext_i32_i64(num_threads_29715)));\n        int64_t carry_in_flat_idx_29778 = orig_group_29777 *\n                (segscan_group_sizze_28579 * sdiv_up64(res_26335,\n                                                       sext_i32_i64(num_threads_29715))) -\n                1;\n        \n        if (slt64(gtid_28583, res_26335)) {\n            if (!(orig_group_29777 == 0 || flat_idx_29776 == (orig_group_29777 +\n                                                              1) *\n                  (segscan_group_sizze_28579 * sdiv_up64(res_26335,\n           ",
                   "                                              sext_i32_i64(num_threads_29715))) -\n                  1)) {\n                bool x_26419;\n                float x_26420;\n                bool x_26421;\n                float x_26422;\n                \n                x_26419 = ((__global\n                            bool *) mem_28990)[carry_in_flat_idx_29778];\n                x_26420 = ((__global\n                            float *) mem_28992)[carry_in_flat_idx_29778];\n                x_26421 = ((__global bool *) mem_28990)[gtid_28583];\n                x_26422 = ((__global float *) mem_28992)[gtid_28583];\n                \n                bool res_26423;\n                \n                res_26423 = x_26419 || x_26421;\n                \n                float res_26424;\n                \n                if (x_26421) {\n                    res_26424 = x_26422;\n                } else {\n                    float res_26425 = x_26420 + x_26422;\n                    \n                    res_26424 = res_26425;\n                }\n                x_26419 = res_26423;\n                x_26420 = res_26424;\n                ((__global bool *) mem_28990)[gtid_28583] = x_26419;\n                ((__global float *) mem_28992)[gtid_28583] = x_26420;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_28579\n}\n__kernel void testziscan_stage3_28636(__global int *global_failure,\n                                      int64_t res_26335,\n                                      int64_t num_groups_28633, __global\n                                      unsigned char *mem_28995,\n                                      int32_t num_threads_29782,\n                                      int32_t required_groups_29818)\n{\n    #define segscan_group_sizze_28631 (testzisegscan_group_sizze_28630)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n       ",
                   " return;\n    \n    int32_t global_tid_29819;\n    int32_t local_tid_29820;\n    int64_t group_sizze_29823;\n    int32_t wave_sizze_29822;\n    int32_t group_tid_29821;\n    \n    global_tid_29819 = get_global_id(0);\n    local_tid_29820 = get_local_id(0);\n    group_sizze_29823 = get_local_size(0);\n    wave_sizze_29822 = LOCKSTEP_WIDTH;\n    group_tid_29821 = get_group_id(0);\n    \n    int32_t phys_tid_28636;\n    \n    phys_tid_28636 = global_tid_29819;\n    \n    int32_t phys_group_id_29824;\n    \n    phys_group_id_29824 = get_group_id(0);\n    for (int32_t i_29825 = 0; i_29825 < sdiv_up32(required_groups_29818 -\n                                                  phys_group_id_29824,\n                                                  sext_i64_i32(num_groups_28633));\n         i_29825++) {\n        int32_t virt_group_id_29826 = phys_group_id_29824 + i_29825 *\n                sext_i64_i32(num_groups_28633);\n        int64_t flat_idx_29827 = sext_i32_i64(virt_group_id_29826) *\n                segscan_group_sizze_28631 + sext_i32_i64(local_tid_29820);\n        int64_t gtid_28635 = flat_idx_29827;\n        int64_t orig_group_29828 = squot64(flat_idx_29827,\n                                           segscan_group_sizze_28631 *\n                                           sdiv_up64(res_26335,\n                                                     sext_i32_i64(num_threads_29782)));\n        int64_t carry_in_flat_idx_29829 = orig_group_29828 *\n                (segscan_group_sizze_28631 * sdiv_up64(res_26335,\n                                                       sext_i32_i64(num_threads_29782))) -\n                1;\n        \n        if (slt64(gtid_28635, res_26335)) {\n            if (!(orig_group_29828 == 0 || flat_idx_29827 == (orig_group_29828 +\n                                                              1) *\n                  (segscan_group_sizze_28631 * sdiv_up64(res_26335,\n                                                         sext_i32_i64(num_threads_29782))) -\n                  1)) {\n      ",
                   "          int64_t x_26516;\n                int64_t x_26517;\n                \n                x_26516 = ((__global\n                            int64_t *) mem_28995)[carry_in_flat_idx_29829];\n                x_26517 = ((__global int64_t *) mem_28995)[gtid_28635];\n                \n                int64_t res_26518;\n                \n                res_26518 = add64(x_26516, x_26517);\n                x_26516 = res_26518;\n                ((__global int64_t *) mem_28995)[gtid_28635] = x_26516;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_28631\n}\n__kernel void testziseghist_global_28553(__global int *global_failure,\n                                         int64_t flat_dim_26302,\n                                         int64_t res_26335,\n                                         int64_t num_groups_28550, __global\n                                         unsigned char *mem_28967,\n                                         int32_t num_subhistos_29431, __global\n                                         unsigned char *res_subhistos_mem_29432,\n                                         __global\n                                         unsigned char *testzihist_locks_mem_29502,\n                                         int32_t chk_i_29504,\n                                         int64_t hist_H_chk_29505)\n{\n    #define seghist_group_sizze_28548 (testziseghist_group_sizze_28547)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29506;\n    int32_t local_tid_29507;\n    int64_t group_sizze_29510;\n    int32_t wave_sizze_29509;\n    int32_t group_tid_29508;\n    \n    global_tid_29506 = get_global_id(0);\n    local_tid_29507 = get_local_id(0);\n    group_sizze_29510 = get_local_size(0);\n    wave_sizze_29509 = LOCKSTEP_WIDTH;\n    group_tid_29508 = get_group_id(0);\n    \n  ",
                   "  int32_t phys_tid_28553;\n    \n    phys_tid_28553 = global_tid_29506;\n    \n    int32_t subhisto_ind_29511;\n    \n    subhisto_ind_29511 = squot32(global_tid_29506,\n                                 sdiv_up32(sext_i64_i32(seghist_group_sizze_28548 *\n                                           num_groups_28550),\n                                           num_subhistos_29431));\n    for (int64_t i_29512 = 0; i_29512 < sdiv_up64(flat_dim_26302 -\n                                                  sext_i32_i64(global_tid_29506),\n                                                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_28548 *\n                                                  num_groups_28550)));\n         i_29512++) {\n        int32_t gtid_28552 = sext_i64_i32(i_29512 *\n                sext_i32_i64(sext_i64_i32(seghist_group_sizze_28548 *\n                num_groups_28550)) + sext_i32_i64(global_tid_29506));\n        \n        if (slt64(i_29512 *\n                  sext_i32_i64(sext_i64_i32(seghist_group_sizze_28548 *\n                  num_groups_28550)) + sext_i32_i64(global_tid_29506),\n                  flat_dim_26302)) {\n            int64_t i_p_o_28811 = add64(-1, gtid_28552);\n            int64_t rot_i_28812 = smod64(i_p_o_28811, flat_dim_26302);\n            bool cond_28559 = gtid_28552 == 0;\n            int64_t res_28560;\n            \n            if (cond_28559) {\n                res_28560 = 0;\n            } else {\n                int64_t x_28558 = ((__global int64_t *) mem_28967)[rot_i_28812];\n                \n                res_28560 = x_28558;\n            }\n            // save map-out results\n            { }\n            // perform atomic updates\n            {\n                if (sle64(sext_i32_i64(chk_i_29504) * hist_H_chk_29505,\n                          res_28560) && (slt64(res_28560,\n                                               sext_i32_i64(chk_i_29504) *\n                                               hist_H_chk_29505 +\n                                             ",
                   "  hist_H_chk_29505) &&\n                                         slt64(res_28560, res_26335))) {\n                    int64_t x_28554;\n                    int64_t x_28555;\n                    \n                    x_28555 = gtid_28552;\n                    \n                    int32_t old_29513;\n                    volatile bool continue_29514;\n                    \n                    continue_29514 = 1;\n                    while (continue_29514) {\n                        old_29513 =\n                            atomic_cmpxchg_i32_global(&((volatile __global\n                                                         int *) testzihist_locks_mem_29502)[srem64(sext_i32_i64(subhisto_ind_29511) *\n                                                                                                   res_26335 +\n                                                                                                   res_28560,\n                                                                                                   100151)],\n                                                      0, 1);\n                        if (old_29513 == 0) {\n                            int64_t x_28554;\n                            \n                            // bind lhs\n                            {\n                                x_28554 = ((volatile __global\n                                            int64_t *) res_subhistos_mem_29432)[sext_i32_i64(subhisto_ind_29511) *\n                                                                                res_26335 +\n                                                                                res_28560];\n                            }\n                            // execute operation\n                            {\n                                int64_t res_28556 = smax64(x_28554, x_28555);\n                                \n                                x_28554 = res_28556;\n                            }\n                            // update global result\n         ",
                   "                   {\n                                ((volatile __global\n                                  int64_t *) res_subhistos_mem_29432)[sext_i32_i64(subhisto_ind_29511) *\n                                                                      res_26335 +\n                                                                      res_28560] =\n                                    x_28554;\n                            }\n                            mem_fence_global();\n                            old_29513 =\n                                atomic_cmpxchg_i32_global(&((volatile __global\n                                                             int *) testzihist_locks_mem_29502)[srem64(sext_i32_i64(subhisto_ind_29511) *\n                                                                                                       res_26335 +\n                                                                                                       res_28560,\n                                                                                                       100151)],\n                                                          1, 0);\n                            continue_29514 = 0;\n                        }\n                        mem_fence_global();\n                    }\n                }\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef seghist_group_sizze_28548\n}\n__kernel void testziseghist_local_28553(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *locks_mem_29472_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *subhistogram_local_mem_29470_backing_aligned_1,\n                                        int64_t flat_dim_26302,\n                                        int64_t res_26335, __global\n                                        unsigned char *mem_28967, __global\n                                        uns",
                   "igned char *res_subhistos_mem_29432,\n                                        int32_t max_group_sizze_29441,\n                                        int64_t num_groups_29442,\n                                        int32_t hist_M_29448,\n                                        int32_t chk_i_29453,\n                                        int64_t num_segments_29454,\n                                        int64_t hist_H_chk_29455,\n                                        int64_t histo_sizze_29456,\n                                        int32_t init_per_thread_29457)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict locks_mem_29472_backing_1 =\n                          (__local volatile\n                           char *) locks_mem_29472_backing_aligned_0;\n    __local volatile char *restrict subhistogram_local_mem_29470_backing_0 =\n                          (__local volatile\n                           char *) subhistogram_local_mem_29470_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29458;\n    int32_t local_tid_29459;\n    int64_t group_sizze_29462;\n    int32_t wave_sizze_29461;\n    int32_t group_tid_29460;\n    \n    global_tid_29458 = get_global_id(0);\n    local_tid_29459 = get_local_id(0);\n    group_sizze_29462 = get_local_size(0);\n    wave_sizze_29461 = LOCKSTEP_WIDTH;\n    group_tid_29460 = get_group_id(0);\n    \n    int32_t phys_tid_28553;\n    \n    phys_tid_28553 = global_tid_29458;\n    \n    int32_t phys_group_id_29463;\n    \n    phys_group_id_29463 = get_group_id(0);\n    for (int32_t i_29464 = 0; i_29464 <\n         sdiv_up32(sext_i64_i32(num_groups_29442 * num_segments_29454) -\n                   phys_group_id_29463, sext_i64_i32(num_groups_29442));\n         i_29464++) {\n        int32_t virt_group_id_29465 = phys_group_id_29463 + i_29464 *\n                sext_i64_i32(num_groups_29442);\n        int32_t flat_segment_id_29466 = squot32(virt_grou",
                   "p_id_29465,\n                                                sext_i64_i32(num_groups_29442));\n        int32_t gid_in_segment_29467 = srem32(virt_group_id_29465,\n                                              sext_i64_i32(num_groups_29442));\n        int32_t pgtid_in_segment_29468 = gid_in_segment_29467 *\n                sext_i64_i32(max_group_sizze_29441) + local_tid_29459;\n        int32_t threads_per_segment_29469 = sext_i64_i32(num_groups_29442 *\n                max_group_sizze_29441);\n        __local char *subhistogram_local_mem_29470;\n        \n        subhistogram_local_mem_29470 = (__local\n                                        char *) subhistogram_local_mem_29470_backing_0;\n        \n        __local char *locks_mem_29472;\n        \n        locks_mem_29472 = (__local char *) locks_mem_29472_backing_1;\n        // All locks start out unlocked\n        {\n            for (int64_t i_29474 = 0; i_29474 < sdiv_up64(hist_M_29448 *\n                                                          hist_H_chk_29455 -\n                                                          sext_i32_i64(local_tid_29459),\n                                                          max_group_sizze_29441);\n                 i_29474++) {\n                ((__local int32_t *) locks_mem_29472)[squot64(i_29474 *\n                                                              max_group_sizze_29441 +\n                                                              sext_i32_i64(local_tid_29459),\n                                                              hist_H_chk_29455) *\n                                                      hist_H_chk_29455 +\n                                                      (i_29474 *\n                                                       max_group_sizze_29441 +\n                                                       sext_i32_i64(local_tid_29459) -\n                                                       squot64(i_29474 *\n                                                               max_group_si",
                   "zze_29441 +\n                                                               sext_i32_i64(local_tid_29459),\n                                                               hist_H_chk_29455) *\n                                                       hist_H_chk_29455)] = 0;\n            }\n        }\n        \n        int32_t thread_local_subhisto_i_29475;\n        \n        thread_local_subhisto_i_29475 = srem32(local_tid_29459, hist_M_29448);\n        // initialize histograms in local memory\n        {\n            for (int32_t local_i_29476 = 0; local_i_29476 <\n                 init_per_thread_29457; local_i_29476++) {\n                int32_t j_29477 = local_i_29476 *\n                        sext_i64_i32(max_group_sizze_29441) + local_tid_29459;\n                int32_t j_offset_29478 = hist_M_29448 *\n                        sext_i64_i32(histo_sizze_29456) * gid_in_segment_29467 +\n                        j_29477;\n                int32_t local_subhisto_i_29479 = squot32(j_29477,\n                                                         sext_i64_i32(histo_sizze_29456));\n                int32_t global_subhisto_i_29480 = squot32(j_offset_29478,\n                                                          sext_i64_i32(histo_sizze_29456));\n                \n                if (slt32(j_29477, hist_M_29448 *\n                          sext_i64_i32(histo_sizze_29456))) {\n                    // First subhistogram is initialised from global memory; others with neutral element.\n                    {\n                        if (global_subhisto_i_29480 == 0) {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_29470)[sext_i32_i64(local_subhisto_i_29479) *\n                                                                       hist_H_chk_29455 +\n                                                                       sext_i32_i64(srem32(j_29477,\n                                                                                           sext_i64_i32(histo",
                   "_sizze_29456)))] =\n                                ((__global\n                                  int64_t *) res_subhistos_mem_29432)[sext_i32_i64(srem32(j_29477,\n                                                                                          sext_i64_i32(histo_sizze_29456))) +\n                                                                      sext_i32_i64(chk_i_29453) *\n                                                                      hist_H_chk_29455];\n                        } else {\n                            ((__local\n                              int64_t *) subhistogram_local_mem_29470)[sext_i32_i64(local_subhisto_i_29479) *\n                                                                       hist_H_chk_29455 +\n                                                                       sext_i32_i64(srem32(j_29477,\n                                                                                           sext_i64_i32(histo_sizze_29456)))] =\n                                0;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29481 = 0; i_29481 <\n             sdiv_up32(sext_i64_i32(flat_dim_26302) - pgtid_in_segment_29468,\n                       threads_per_segment_29469); i_29481++) {\n            int32_t gtid_28552 = i_29481 * threads_per_segment_29469 +\n                    pgtid_in_segment_29468;\n            int64_t i_p_o_28811 = add64(-1, gtid_28552);\n            int64_t rot_i_28812 = smod64(i_p_o_28811, flat_dim_26302);\n            bool cond_28559 = gtid_28552 == 0;\n            int64_t res_28560;\n            \n            if (cond_28559) {\n                res_28560 = 0;\n            } else {\n                int64_t x_28558 = ((__global int64_t *) mem_28967)[rot_i_28812];\n                \n                res_28560 = x_28558;\n            }\n            if (chk_i_29453 == 0) {\n                // save map-out results\n                { }\n            }\n   ",
                   "         // perform atomic updates\n            {\n                if (slt64(res_28560, res_26335) &&\n                    (sle64(sext_i32_i64(chk_i_29453) * hist_H_chk_29455,\n                           res_28560) && slt64(res_28560,\n                                               sext_i32_i64(chk_i_29453) *\n                                               hist_H_chk_29455 +\n                                               hist_H_chk_29455))) {\n                    int64_t x_28554;\n                    int64_t x_28555;\n                    \n                    x_28555 = gtid_28552;\n                    \n                    int32_t old_29482;\n                    volatile bool continue_29483;\n                    \n                    continue_29483 = 1;\n                    while (continue_29483) {\n                        old_29482 = atomic_cmpxchg_i32_local(&((volatile __local\n                                                                int *) locks_mem_29472)[sext_i32_i64(thread_local_subhisto_i_29475) *\n                                                                                        hist_H_chk_29455 +\n                                                                                        (res_28560 -\n                                                                                         sext_i32_i64(chk_i_29453) *\n                                                                                         hist_H_chk_29455)],\n                                                             0, 1);\n                        if (old_29482 == 0) {\n                            int64_t x_28554;\n                            \n                            // bind lhs\n                            {\n                                x_28554 = ((volatile __local\n                                            int64_t *) subhistogram_local_mem_29470)[sext_i32_i64(thread_local_subhisto_i_29475) *\n                                                                                     hist_H_chk_29455 +\n   ",
                   "                                                                                  (res_28560 -\n                                                                                      sext_i32_i64(chk_i_29453) *\n                                                                                      hist_H_chk_29455)];\n                            }\n                            // execute operation\n                            {\n                                int64_t res_28556 = smax64(x_28554, x_28555);\n                                \n                                x_28554 = res_28556;\n                            }\n                            // update global result\n                            {\n                                ((volatile __local\n                                  int64_t *) subhistogram_local_mem_29470)[sext_i32_i64(thread_local_subhisto_i_29475) *\n                                                                           hist_H_chk_29455 +\n                                                                           (res_28560 -\n                                                                            sext_i32_i64(chk_i_29453) *\n                                                                            hist_H_chk_29455)] =\n                                    x_28554;\n                            }\n                            mem_fence_local();\n                            old_29482 =\n                                atomic_cmpxchg_i32_local(&((volatile __local\n                                                            int *) locks_mem_29472)[sext_i32_i64(thread_local_subhisto_i_29475) *\n                                                                                    hist_H_chk_29455 +\n                                                                                    (res_28560 -\n                                                                                     sext_i32_i64(chk_i_29453) *\n                                                               ",
                   "                      hist_H_chk_29455)],\n                                                         1, 0);\n                            continue_29483 = 0;\n                        }\n                        mem_fence_local();\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Compact the multiple local memory subhistograms to result in global memory\n        {\n            int64_t trunc_H_29484 = smin64(hist_H_chk_29455, res_26335 -\n                                           sext_i32_i64(chk_i_29453) *\n                                           hist_H_chk_29455);\n            int32_t histo_sizze_29485 = sext_i64_i32(trunc_H_29484);\n            \n            for (int32_t local_i_29486 = 0; local_i_29486 <\n                 init_per_thread_29457; local_i_29486++) {\n                int32_t j_29487 = local_i_29486 *\n                        sext_i64_i32(max_group_sizze_29441) + local_tid_29459;\n                \n                if (slt32(j_29487, histo_sizze_29485)) {\n                    int64_t x_28554;\n                    int64_t x_28555;\n                    \n                    // Read values from subhistogram 0.\n                    {\n                        x_28554 = ((__local\n                                    int64_t *) subhistogram_local_mem_29470)[sext_i32_i64(j_29487)];\n                    }\n                    // Accumulate based on values in other subhistograms.\n                    {\n                        for (int32_t subhisto_id_29488 = 0; subhisto_id_29488 <\n                             hist_M_29448 - 1; subhisto_id_29488++) {\n                            x_28555 = ((__local\n                                        int64_t *) subhistogram_local_mem_29470)[(sext_i32_i64(subhisto_id_29488) +\n                                                                                  1) *\n                                                                                 hist_H_chk_29455 +\n                                ",
                   "                                                 sext_i32_i64(j_29487)];\n                            \n                            int64_t res_28556;\n                            \n                            res_28556 = smax64(x_28554, x_28555);\n                            x_28554 = res_28556;\n                        }\n                    }\n                    // Put final bucket value in global memory.\n                    {\n                        ((__global\n                          int64_t *) res_subhistos_mem_29432)[srem64(sext_i32_i64(virt_group_id_29465),\n                                                                     num_groups_29442) *\n                                                              res_26335 +\n                                                              (sext_i32_i64(j_29487) +\n                                                               sext_i32_i64(chk_i_29453) *\n                                                               hist_H_chk_29455)] =\n                            x_28554;\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\n__kernel void testzisegmap_27708(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, __global\n                                 unsigned char *mem_28881, __global\n                                 unsigned char *mem_28883, __global\n                                 unsigned char *mem_28895, __global\n                                 unsigned char *mem_28909)\n{\n    #define segmap_group_sizze_27786 (testzisegmap_group_sizze_27710)\n    #define num_threads_29122 (testzisegmap_group_sizze_27710 * sdiv_up64(9, testzisegmap_group_sizze_27710))\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t ",
                   "global_tid_29268;\n    int32_t local_tid_29269;\n    int64_t group_sizze_29272;\n    int32_t wave_sizze_29271;\n    int32_t group_tid_29270;\n    \n    global_tid_29268 = get_global_id(0);\n    local_tid_29269 = get_local_id(0);\n    group_sizze_29272 = get_local_size(0);\n    wave_sizze_29271 = LOCKSTEP_WIDTH;\n    group_tid_29270 = get_group_id(0);\n    \n    int32_t phys_tid_27708;\n    \n    phys_tid_27708 = global_tid_29268;\n    \n    int64_t gtid_27707;\n    \n    gtid_27707 = sext_i32_i64(group_tid_29270) * segmap_group_sizze_27786 +\n        sext_i32_i64(local_tid_29269);\n    if (slt64(gtid_27707, 9)) {\n        float res_27797 = ((__global float *) mem_28883)[gtid_27707];\n        int64_t res_27798 = ((__global int64_t *) mem_28881)[gtid_27707];\n        int64_t range_end_27800 = sub64(res_27798, 1);\n        bool bounds_invalid_upwards_27801 = slt64(range_end_27800, 0);\n        bool valid_27802 = !bounds_invalid_upwards_27801;\n        bool range_valid_c_27803;\n        \n        if (!valid_27802) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 9) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = 1;\n                    global_failure_args[2] = range_end_27800;\n                    ;\n                }\n                return;\n            }\n        }\n        for (int64_t i_28856 = 0; i_28856 < res_27798; i_28856++) {\n            float res_27807 = sitofp_i64_f32(i_28856);\n            float res_27808 = res_27797 * res_27807;\n            \n            ((__global float *) mem_28895)[phys_tid_27708 + i_28856 *\n                                           num_threads_29122] = res_27808;\n        }\n        \n        bool y_27809 = slt64(0, res_27798);\n        bool index_certs_27810;\n        \n        if (!y_27809) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 10) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_27798;\n   ",
                   "                 ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_27811 = sitofp_i64_f32(range_end_27800);\n        float index_primexp_27812 = res_27797 * binop_y_27811;\n        float negate_arg_27813 = 1.0e-2F * index_primexp_27812;\n        float exp_arg_27814 = 0.0F - negate_arg_27813;\n        float res_27815 = fpow32(2.7182817F, exp_arg_27814);\n        float x_27816 = 1.0F - res_27815;\n        float B_27817 = x_27816 / 1.0e-2F;\n        float x_27818 = B_27817 - index_primexp_27812;\n        float x_27819 = 4.4999997e-6F * x_27818;\n        float A1_27820 = x_27819 / 1.0e-4F;\n        float y_27821 = fpow32(B_27817, 2.0F);\n        float x_27822 = 1.0000001e-6F * y_27821;\n        float A2_27823 = x_27822 / 4.0e-2F;\n        float exp_arg_27824 = A1_27820 - A2_27823;\n        float res_27825 = fpow32(2.7182817F, exp_arg_27824);\n        float negate_arg_27826 = 5.0e-2F * B_27817;\n        float exp_arg_27827 = 0.0F - negate_arg_27826;\n        float res_27828 = fpow32(2.7182817F, exp_arg_27827);\n        float res_27829 = res_27825 * res_27828;\n        bool empty_slice_27830 = range_end_27800 == 0;\n        bool zzero_leq_i_p_m_t_s_27831 = sle64(0, range_end_27800);\n        bool i_p_m_t_s_leq_w_27832 = slt64(range_end_27800, res_27798);\n        bool i_lte_j_27833 = sle64(1, res_27798);\n        bool y_27834 = zzero_leq_i_p_m_t_s_27831 && i_p_m_t_s_leq_w_27832;\n        bool y_27835 = i_lte_j_27833 && y_27834;\n        bool ok_or_empty_27836 = empty_slice_27830 || y_27835;\n        bool index_certs_27837;\n        \n        if (!ok_or_empty_27836) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 11) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = res_27798;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float res_27839;\n        float redout_28858 = 0.0F;\n        \n        for (int64_t i_28859",
                   " = 0; i_28859 < range_end_27800; i_28859++) {\n            int64_t slice_28872 = 1 + i_28859;\n            float x_27843 = ((__global float *) mem_28895)[phys_tid_27708 +\n                                                           slice_28872 *\n                                                           num_threads_29122];\n            float negate_arg_27844 = 1.0e-2F * x_27843;\n            float exp_arg_27845 = 0.0F - negate_arg_27844;\n            float res_27846 = fpow32(2.7182817F, exp_arg_27845);\n            float x_27847 = 1.0F - res_27846;\n            float B_27848 = x_27847 / 1.0e-2F;\n            float x_27849 = B_27848 - x_27843;\n            float x_27850 = 4.4999997e-6F * x_27849;\n            float A1_27851 = x_27850 / 1.0e-4F;\n            float y_27852 = fpow32(B_27848, 2.0F);\n            float x_27853 = 1.0000001e-6F * y_27852;\n            float A2_27854 = x_27853 / 4.0e-2F;\n            float exp_arg_27855 = A1_27851 - A2_27854;\n            float res_27856 = fpow32(2.7182817F, exp_arg_27855);\n            float negate_arg_27857 = 5.0e-2F * B_27848;\n            float exp_arg_27858 = 0.0F - negate_arg_27857;\n            float res_27859 = fpow32(2.7182817F, exp_arg_27858);\n            float res_27860 = res_27856 * res_27859;\n            float res_27842 = res_27860 + redout_28858;\n            float redout_tmp_29274 = res_27842;\n            \n            redout_28858 = redout_tmp_29274;\n        }\n        res_27839 = redout_28858;\n        \n        float x_27861 = 1.0F - res_27829;\n        float y_27862 = res_27797 * res_27839;\n        float res_27863 = x_27861 / y_27862;\n        \n        ((__global float *) mem_28909)[gtid_27707] = res_27863;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27786\n    #undef num_threads_29122\n}\n__kernel void testzisegmap_27884(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args, __global\n                           ",
                   "      unsigned char *mem_28881, __global\n                                 unsigned char *mem_28883, __global\n                                 unsigned char *mem_28918, __global\n                                 unsigned char *mem_28932)\n{\n    #define segmap_group_sizze_27962 (testzisegmap_group_sizze_27886)\n    #define num_threads_29154 (testzisegmap_group_sizze_27886 * sdiv_up64(9, testzisegmap_group_sizze_27886))\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29305;\n    int32_t local_tid_29306;\n    int64_t group_sizze_29309;\n    int32_t wave_sizze_29308;\n    int32_t group_tid_29307;\n    \n    global_tid_29305 = get_global_id(0);\n    local_tid_29306 = get_local_id(0);\n    group_sizze_29309 = get_local_size(0);\n    wave_sizze_29308 = LOCKSTEP_WIDTH;\n    group_tid_29307 = get_group_id(0);\n    \n    int32_t phys_tid_27884;\n    \n    phys_tid_27884 = global_tid_29305;\n    \n    int64_t gtid_27883;\n    \n    gtid_27883 = sext_i32_i64(group_tid_29307) * segmap_group_sizze_27962 +\n        sext_i32_i64(local_tid_29306);\n    if (slt64(gtid_27883, 9)) {\n        float res_27973 = ((__global float *) mem_28883)[gtid_27883];\n        int64_t res_27974 = ((__global int64_t *) mem_28881)[gtid_27883];\n        int64_t range_end_27976 = sub64(res_27974, 1);\n        bool bounds_invalid_upwards_27977 = slt64(range_end_27976, 0);\n        bool valid_27978 = !bounds_invalid_upwards_27977;\n        bool range_valid_c_27979;\n        \n        if (!valid_27978) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 12) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = 1;\n                    global_failure_args[2] = range_end_27976;\n                    ;\n                }\n                return;\n            }\n        }\n        for (int64_t i_28862 = 0; i_28862 < res_27974; i_28862++) {\n            ",
                   "float res_27983 = sitofp_i64_f32(i_28862);\n            float res_27984 = res_27973 * res_27983;\n            \n            ((__global float *) mem_28918)[phys_tid_27884 + i_28862 *\n                                           num_threads_29154] = res_27984;\n        }\n        \n        bool y_27985 = slt64(0, res_27974);\n        bool index_certs_27986;\n        \n        if (!y_27985) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 13) == -1) {\n                    global_failure_args[0] = 0;\n                    global_failure_args[1] = res_27974;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float binop_y_27987 = sitofp_i64_f32(range_end_27976);\n        float index_primexp_27988 = res_27973 * binop_y_27987;\n        float negate_arg_27989 = 1.0e-2F * index_primexp_27988;\n        float exp_arg_27990 = 0.0F - negate_arg_27989;\n        float res_27991 = fpow32(2.7182817F, exp_arg_27990);\n        float x_27992 = 1.0F - res_27991;\n        float B_27993 = x_27992 / 1.0e-2F;\n        float x_27994 = B_27993 - index_primexp_27988;\n        float x_27995 = 4.4999997e-6F * x_27994;\n        float A1_27996 = x_27995 / 1.0e-4F;\n        float y_27997 = fpow32(B_27993, 2.0F);\n        float x_27998 = 1.0000001e-6F * y_27997;\n        float A2_27999 = x_27998 / 4.0e-2F;\n        float exp_arg_28000 = A1_27996 - A2_27999;\n        float res_28001 = fpow32(2.7182817F, exp_arg_28000);\n        float negate_arg_28002 = 5.0e-2F * B_27993;\n        float exp_arg_28003 = 0.0F - negate_arg_28002;\n        float res_28004 = fpow32(2.7182817F, exp_arg_28003);\n        float res_28005 = res_28001 * res_28004;\n        bool empty_slice_28006 = range_end_27976 == 0;\n        bool zzero_leq_i_p_m_t_s_28007 = sle64(0, range_end_27976);\n        bool i_p_m_t_s_leq_w_28008 = slt64(range_end_27976, res_27974);\n        bool i_lte_j_28009 = sle64(1, res_27974);\n        bool y_28010 = zzero_leq_i_p_m_t_s_28007 && i_p_m_t_s_leq_w_280",
                   "08;\n        bool y_28011 = i_lte_j_28009 && y_28010;\n        bool ok_or_empty_28012 = empty_slice_28006 || y_28011;\n        bool index_certs_28013;\n        \n        if (!ok_or_empty_28012) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 14) == -1) {\n                    global_failure_args[0] = 1;\n                    global_failure_args[1] = res_27974;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        float res_28015;\n        float redout_28864 = 0.0F;\n        \n        for (int64_t i_28865 = 0; i_28865 < range_end_27976; i_28865++) {\n            int64_t slice_28875 = 1 + i_28865;\n            float x_28019 = ((__global float *) mem_28918)[phys_tid_27884 +\n                                                           slice_28875 *\n                                                           num_threads_29154];\n            float negate_arg_28020 = 1.0e-2F * x_28019;\n            float exp_arg_28021 = 0.0F - negate_arg_28020;\n            float res_28022 = fpow32(2.7182817F, exp_arg_28021);\n            float x_28023 = 1.0F - res_28022;\n            float B_28024 = x_28023 / 1.0e-2F;\n            float x_28025 = B_28024 - x_28019;\n            float x_28026 = 4.4999997e-6F * x_28025;\n            float A1_28027 = x_28026 / 1.0e-4F;\n            float y_28028 = fpow32(B_28024, 2.0F);\n            float x_28029 = 1.0000001e-6F * y_28028;\n            float A2_28030 = x_28029 / 4.0e-2F;\n            float exp_arg_28031 = A1_28027 - A2_28030;\n            float res_28032 = fpow32(2.7182817F, exp_arg_28031);\n            float negate_arg_28033 = 5.0e-2F * B_28024;\n            float exp_arg_28034 = 0.0F - negate_arg_28033;\n            float res_28035 = fpow32(2.7182817F, exp_arg_28034);\n            float res_28036 = res_28032 * res_28035;\n            float res_28018 = res_28036 + redout_28864;\n            float redout_tmp_29311 = res_28018;\n            \n            redout_28864 = redout_tmp_29311;\n        }",
                   "\n        res_28015 = redout_28864;\n        \n        float x_28037 = 1.0F - res_28005;\n        float y_28038 = res_27973 * res_28015;\n        float res_28039 = x_28037 / y_28038;\n        \n        ((__global float *) mem_28932)[gtid_27883] = res_28039;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27962\n    #undef num_threads_29154\n}\n__kernel void testzisegmap_28183(__global int *global_failure,\n                                 int failure_is_an_option, __global\n                                 int64_t *global_failure_args,\n                                 int64_t paths_26135, int64_t steps_26136,\n                                 float dt_26149, int64_t upper_bound_26237,\n                                 float res_26238, int64_t num_groups_28435,\n                                 __global unsigned char *mem_28946, __global\n                                 unsigned char *mem_28949, __global\n                                 unsigned char *mem_28964)\n{\n    #define segmap_group_sizze_28434 (testzisegmap_group_sizze_28185)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29324;\n    int32_t local_tid_29325;\n    int64_t group_sizze_29328;\n    int32_t wave_sizze_29327;\n    int32_t group_tid_29326;\n    \n    global_tid_29324 = get_global_id(0);\n    local_tid_29325 = get_local_id(0);\n    group_sizze_29328 = get_local_size(0);\n    wave_sizze_29327 = LOCKSTEP_WIDTH;\n    group_tid_29326 = get_group_id(0);\n    \n    int32_t phys_tid_28183;\n    \n    phys_tid_28183 = global_tid_29324;\n    \n    int32_t phys_group_id_29329;\n    \n    phys_group_id_29329 = get_group_id(0);\n    for (int32_t i_29330 = 0; i_29330 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(paths_26135,\n ",
                   "                                         segmap_group_sizze_28434)) -\n                   phys_group_id_29329, sext_i64_i32(num_groups_28435));\n         i_29330++) {\n        int32_t virt_group_id_29331 = phys_group_id_29329 + i_29330 *\n                sext_i64_i32(num_groups_28435);\n        int64_t gtid_28182 = sext_i32_i64(virt_group_id_29331) *\n                segmap_group_sizze_28434 + sext_i32_i64(local_tid_29325);\n        \n        if (slt64(gtid_28182, paths_26135)) {\n            for (int64_t i_29332 = 0; i_29332 < steps_26136; i_29332++) {\n                ((__global float *) mem_28949)[phys_tid_28183 + i_29332 *\n                                               (num_groups_28435 *\n                                                segmap_group_sizze_28434)] =\n                    5.0e-2F;\n            }\n            for (int64_t i_28441 = 0; i_28441 < upper_bound_26237; i_28441++) {\n                bool y_28443 = slt64(i_28441, steps_26136);\n                bool index_certs_28444;\n                \n                if (!y_28443) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 15) ==\n                            -1) {\n                            global_failure_args[0] = i_28441;\n                            global_failure_args[1] = steps_26136;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                float shortstep_arg_28445 = ((__global\n                                              float *) mem_28946)[i_28441 *\n                                                                  paths_26135 +\n                                                                  gtid_28182];\n                float shortstep_arg_28446 = ((__global\n                                              float *) mem_28949)[phys_tid_28183 +\n                                                                  i_2",
                   "8441 *\n                                                                  (num_groups_28435 *\n                                                                   segmap_group_sizze_28434)];\n                float y_28447 = 5.0e-2F - shortstep_arg_28446;\n                float x_28448 = 1.0e-2F * y_28447;\n                float x_28449 = dt_26149 * x_28448;\n                float x_28450 = res_26238 * shortstep_arg_28445;\n                float y_28451 = 1.0e-3F * x_28450;\n                float delta_r_28452 = x_28449 + y_28451;\n                float res_28453 = shortstep_arg_28446 + delta_r_28452;\n                int64_t i_28454 = add64(1, i_28441);\n                bool x_28455 = sle64(0, i_28454);\n                bool y_28456 = slt64(i_28454, steps_26136);\n                bool bounds_check_28457 = x_28455 && y_28456;\n                bool index_certs_28458;\n                \n                if (!bounds_check_28457) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 16) ==\n                            -1) {\n                            global_failure_args[0] = i_28454;\n                            global_failure_args[1] = steps_26136;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                ((__global float *) mem_28949)[phys_tid_28183 + i_28454 *\n                                               (num_groups_28435 *\n                                                segmap_group_sizze_28434)] =\n                    res_28453;\n            }\n            for (int64_t i_29334 = 0; i_29334 < steps_26136; i_29334++) {\n                ((__global float *) mem_28964)[i_29334 * paths_26135 +\n                                               gtid_28182] = ((__global\n                                                               float *) mem_28949)[phys_tid_28183 +\n                                                    ",
                   "                               i_29334 *\n                                                                                   (num_groups_28435 *\n                                                                                    segmap_group_sizze_28434)];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_28434\n}\n__kernel void testzisegmap_28281(__global int *global_failure,\n                                 int64_t paths_26135, int64_t steps_26136,\n                                 __global unsigned char *mem_28939, __global\n                                 unsigned char *mem_28943)\n{\n    #define segmap_group_sizze_28389 (testzisegmap_group_sizze_28284)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29318;\n    int32_t local_tid_29319;\n    int64_t group_sizze_29322;\n    int32_t wave_sizze_29321;\n    int32_t group_tid_29320;\n    \n    global_tid_29318 = get_global_id(0);\n    local_tid_29319 = get_local_id(0);\n    group_sizze_29322 = get_local_size(0);\n    wave_sizze_29321 = LOCKSTEP_WIDTH;\n    group_tid_29320 = get_group_id(0);\n    \n    int32_t phys_tid_28281;\n    \n    phys_tid_28281 = global_tid_29318;\n    \n    int64_t gtid_28279;\n    \n    gtid_28279 = squot64(sext_i32_i64(group_tid_29320) *\n                         segmap_group_sizze_28389 +\n                         sext_i32_i64(local_tid_29319), steps_26136);\n    \n    int64_t gtid_28280;\n    \n    gtid_28280 = sext_i32_i64(group_tid_29320) * segmap_group_sizze_28389 +\n        sext_i32_i64(local_tid_29319) - squot64(sext_i32_i64(group_tid_29320) *\n                                                segmap_group_sizze_28389 +\n                                                sext_i32_i64(local_tid_29319),\n                                                steps_26136) * steps_26136;\n    if (slt64(gtid_28279,",
                   " paths_26135) && slt64(gtid_28280, steps_26136)) {\n        int32_t unsign_arg_28392 = ((__global int32_t *) mem_28939)[gtid_28279];\n        int32_t res_28394 = sext_i64_i32(gtid_28280);\n        int32_t x_28395 = lshr32(res_28394, 16);\n        int32_t x_28396 = res_28394 ^ x_28395;\n        int32_t x_28397 = mul32(73244475, x_28396);\n        int32_t x_28398 = lshr32(x_28397, 16);\n        int32_t x_28399 = x_28397 ^ x_28398;\n        int32_t x_28400 = mul32(73244475, x_28399);\n        int32_t x_28401 = lshr32(x_28400, 16);\n        int32_t x_28402 = x_28400 ^ x_28401;\n        int32_t unsign_arg_28403 = unsign_arg_28392 ^ x_28402;\n        int32_t unsign_arg_28404 = mul32(48271, unsign_arg_28403);\n        int32_t unsign_arg_28405 = umod32(unsign_arg_28404, 2147483647);\n        int32_t unsign_arg_28406 = mul32(48271, unsign_arg_28405);\n        int32_t unsign_arg_28407 = umod32(unsign_arg_28406, 2147483647);\n        float res_28408 = uitofp_i32_f32(unsign_arg_28405);\n        float res_28409 = res_28408 / 2.1474836e9F;\n        float res_28410 = uitofp_i32_f32(unsign_arg_28407);\n        float res_28411 = res_28410 / 2.1474836e9F;\n        float res_28412;\n        \n        res_28412 = futrts_log32(res_28409);\n        \n        float res_28413 = -2.0F * res_28412;\n        float res_28414;\n        \n        res_28414 = futrts_sqrt32(res_28413);\n        \n        float res_28415 = 6.2831855F * res_28411;\n        float res_28416;\n        \n        res_28416 = futrts_cos32(res_28415);\n        \n        float res_28417 = res_28414 * res_28416;\n        \n        ((__global float *) mem_28943)[gtid_28279 * steps_26136 + gtid_28280] =\n            res_28417;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_28389\n}\n__kernel void testzisegmap_28345(__global int *global_failure,\n                                 int64_t paths_26135, __global\n                                 unsigned char *mem_28939)\n{\n    #define segmap_group_sizze_28364 (testzisegmap_group_sizze_28347)\n    \n    cons",
                   "t int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29313;\n    int32_t local_tid_29314;\n    int64_t group_sizze_29317;\n    int32_t wave_sizze_29316;\n    int32_t group_tid_29315;\n    \n    global_tid_29313 = get_global_id(0);\n    local_tid_29314 = get_local_id(0);\n    group_sizze_29317 = get_local_size(0);\n    wave_sizze_29316 = LOCKSTEP_WIDTH;\n    group_tid_29315 = get_group_id(0);\n    \n    int32_t phys_tid_28345;\n    \n    phys_tid_28345 = global_tid_29313;\n    \n    int64_t gtid_28344;\n    \n    gtid_28344 = sext_i32_i64(group_tid_29315) * segmap_group_sizze_28364 +\n        sext_i32_i64(local_tid_29314);\n    if (slt64(gtid_28344, paths_26135)) {\n        int32_t res_28368 = sext_i64_i32(gtid_28344);\n        int32_t x_28369 = lshr32(res_28368, 16);\n        int32_t x_28370 = res_28368 ^ x_28369;\n        int32_t x_28371 = mul32(73244475, x_28370);\n        int32_t x_28372 = lshr32(x_28371, 16);\n        int32_t x_28373 = x_28371 ^ x_28372;\n        int32_t x_28374 = mul32(73244475, x_28373);\n        int32_t x_28375 = lshr32(x_28374, 16);\n        int32_t x_28376 = x_28374 ^ x_28375;\n        int32_t unsign_arg_28377 = 777822902 ^ x_28376;\n        int32_t unsign_arg_28378 = mul32(48271, unsign_arg_28377);\n        int32_t unsign_arg_28379 = umod32(unsign_arg_28378, 2147483647);\n        \n        ((__global int32_t *) mem_28939)[gtid_28344] = unsign_arg_28379;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_28364\n}\n__kernel void testzisegmap_28638(__global int *global_failure,\n                                 int64_t res_26335, int64_t num_segments_26522,\n                                 __global unsigned char *mem_28987, __global\n                                 unsigned char *mem_28992, __global\n                                 unsigned char *mem_28995, __global\n                                 unsigned char *mem_28997)\n{\n    #define segmap_group_sizze_286",
                   "41 (testzisegmap_group_sizze_28640)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29839;\n    int32_t local_tid_29840;\n    int64_t group_sizze_29843;\n    int32_t wave_sizze_29842;\n    int32_t group_tid_29841;\n    \n    global_tid_29839 = get_global_id(0);\n    local_tid_29840 = get_local_id(0);\n    group_sizze_29843 = get_local_size(0);\n    wave_sizze_29842 = LOCKSTEP_WIDTH;\n    group_tid_29841 = get_group_id(0);\n    \n    int32_t phys_tid_28638;\n    \n    phys_tid_28638 = global_tid_29839;\n    \n    int64_t write_i_28637;\n    \n    write_i_28637 = sext_i32_i64(group_tid_29841) * segmap_group_sizze_28641 +\n        sext_i32_i64(local_tid_29840);\n    if (slt64(write_i_28637, res_26335)) {\n        int64_t i_p_o_28819 = add64(1, write_i_28637);\n        int64_t rot_i_28820 = smod64(i_p_o_28819, res_26335);\n        bool x_26535 = ((__global bool *) mem_28987)[rot_i_28820];\n        float write_value_26536 = ((__global float *) mem_28992)[write_i_28637];\n        int64_t res_26537;\n        \n        if (x_26535) {\n            int64_t x_26534 = ((__global int64_t *) mem_28995)[write_i_28637];\n            int64_t res_26538 = sub64(x_26534, 1);\n            \n            res_26537 = res_26538;\n        } else {\n            res_26537 = -1;\n        }\n        if (sle64(0, res_26537) && slt64(res_26537, num_segments_26522)) {\n            ((__global float *) mem_28997)[res_26537] = write_value_26536;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_28641\n}\n__kernel void testzisegmap_28676(__global int *global_failure,\n                                 int64_t paths_26135, __global\n                                 unsigned char *mem_29007, __global\n                                 unsigned char *mem_29010)\n{\n    #define segmap_group_sizze_28755 (testzisegmap_group_sizze_28678)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    ",
                   "const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29875;\n    int32_t local_tid_29876;\n    int64_t group_sizze_29879;\n    int32_t wave_sizze_29878;\n    int32_t group_tid_29877;\n    \n    global_tid_29875 = get_global_id(0);\n    local_tid_29876 = get_local_id(0);\n    group_sizze_29879 = get_local_size(0);\n    wave_sizze_29878 = LOCKSTEP_WIDTH;\n    group_tid_29877 = get_group_id(0);\n    \n    int32_t phys_tid_28676;\n    \n    phys_tid_28676 = global_tid_29875;\n    \n    int64_t gtid_28675;\n    \n    gtid_28675 = sext_i32_i64(group_tid_29877) * segmap_group_sizze_28755 +\n        sext_i32_i64(local_tid_29876);\n    if (slt64(gtid_28675, paths_26135)) {\n        float res_28759;\n        float redout_28868 = 0.0F;\n        \n        for (int32_t i_28877 = 0; i_28877 < 9; i_28877++) {\n            int64_t i_28869 = sext_i32_i64(i_28877);\n            float x_28763 = ((__global float *) mem_29007)[i_28869 *\n                                                           paths_26135 +\n                                                           gtid_28675];\n            float res_28762 = x_28763 + redout_28868;\n            float redout_tmp_29880 = res_28762;\n            \n            redout_28868 = redout_tmp_29880;\n        }\n        res_28759 = redout_28868;\n        \n        float res_28764 = fmax32(0.0F, res_28759);\n        \n        ((__global float *) mem_29010)[gtid_28675] = res_28764;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_28755\n}\n__kernel void testzisegmap_28701(__global int *global_failure,\n                                 int64_t paths_26135, __global\n                                 unsigned char *mem_29013, __global\n                                 unsigned char *mem_29016)\n{\n    #define segmap_group_sizze_28777 (testzisegmap_group_sizze_28703)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t gl",
                   "obal_tid_29941;\n    int32_t local_tid_29942;\n    int64_t group_sizze_29945;\n    int32_t wave_sizze_29944;\n    int32_t group_tid_29943;\n    \n    global_tid_29941 = get_global_id(0);\n    local_tid_29942 = get_local_id(0);\n    group_sizze_29945 = get_local_size(0);\n    wave_sizze_29944 = LOCKSTEP_WIDTH;\n    group_tid_29943 = get_group_id(0);\n    \n    int32_t phys_tid_28701;\n    \n    phys_tid_28701 = global_tid_29941;\n    \n    int64_t gtid_28700;\n    \n    gtid_28700 = sext_i32_i64(group_tid_29943) * segmap_group_sizze_28777 +\n        sext_i32_i64(local_tid_29942);\n    if (slt64(gtid_28700, paths_26135)) {\n        float res_28780 = ((__global float *) mem_29013)[gtid_28700];\n        float res_28781 = fmax32(0.0F, res_28780);\n        \n        ((__global float *) mem_29016)[gtid_28700] = res_28781;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_28777\n}\n__kernel void testzisegred_large_28717(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_29918_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_29916_backing_aligned_1,\n                                       int64_t num_groups_28768, __global\n                                       unsigned char *mem_28997, __global\n                                       unsigned char *mem_29013,\n                                       int64_t groups_per_segment_29902,\n                                       int64_t elements_per_thread_29903,\n                                       int64_t virt_num_groups_29904,\n                                       int64_t threads_per_segment_29906,\n                                       __global\n                                       unsigned char *group_res_arr_mem_29907,\n                                       __global\n                                       unsigned char *testzicounter_mem_29909)\n{\n    #define s",
                   "egred_group_sizze_28767 (testzisegred_group_sizze_28711)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_29918_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_29918_backing_aligned_0;\n    __local volatile char *restrict red_arr_mem_29916_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_29916_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29911;\n    int32_t local_tid_29912;\n    int64_t group_sizze_29915;\n    int32_t wave_sizze_29914;\n    int32_t group_tid_29913;\n    \n    global_tid_29911 = get_global_id(0);\n    local_tid_29912 = get_local_id(0);\n    group_sizze_29915 = get_local_size(0);\n    wave_sizze_29914 = LOCKSTEP_WIDTH;\n    group_tid_29913 = get_group_id(0);\n    \n    int32_t phys_tid_28717;\n    \n    phys_tid_28717 = global_tid_29911;\n    \n    __local char *red_arr_mem_29916;\n    \n    red_arr_mem_29916 = (__local char *) red_arr_mem_29916_backing_0;\n    \n    __local char *sync_arr_mem_29918;\n    \n    sync_arr_mem_29918 = (__local char *) sync_arr_mem_29918_backing_1;\n    \n    int32_t phys_group_id_29920;\n    \n    phys_group_id_29920 = get_group_id(0);\n    for (int32_t i_29921 = 0; i_29921 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_29904) - phys_group_id_29920,\n                   sext_i64_i32(num_groups_28768)); i_29921++) {\n        int32_t virt_group_id_29922 = phys_group_id_29920 + i_29921 *\n                sext_i64_i32(num_groups_28768);\n        int32_t flat_segment_id_29923 = squot32(virt_group_id_29922,\n                                                sext_i64_i32(groups_per_segment_29902));\n        int64_t global_tid_29924 = srem64(sext_i32_i64(virt_group_id_29922) *\n                                          segred_group_sizze_28767 +\n                                          sext_i32_i64(local_tid_",
                   "29912),\n                                          segred_group_sizze_28767 *\n                                          groups_per_segment_29902);\n        int64_t gtid_28708 = sext_i32_i64(flat_segment_id_29923);\n        int64_t gtid_28716;\n        float x_acc_29925;\n        int64_t chunk_sizze_29926;\n        \n        chunk_sizze_29926 = smin64(elements_per_thread_29903, sdiv_up64(9 -\n                                                                        sext_i32_i64(sext_i64_i32(global_tid_29924)),\n                                                                        threads_per_segment_29906));\n        \n        float x_28771;\n        float x_28772;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_29925 = 0.0F;\n        }\n        for (int64_t i_29930 = 0; i_29930 < chunk_sizze_29926; i_29930++) {\n            gtid_28716 = sext_i32_i64(sext_i64_i32(global_tid_29924)) +\n                threads_per_segment_29906 * i_29930;\n            // apply map function\n            {\n                int64_t binop_x_28829 = 9 * gtid_28708;\n                int64_t new_index_28830 = gtid_28716 + binop_x_28829;\n                float x_28775 = ((__global float *) mem_28997)[new_index_28830];\n                \n                // save map-out results\n                { }\n                // load accumulator\n                {\n                    x_28771 = x_acc_29925;\n                }\n                // load new values\n                {\n                    x_28772 = x_28775;\n                }\n                // apply reduction operator\n                {\n                    float res_28773 = x_28771 + x_28772;\n                    \n                    // store in accumulator\n                    {\n                        x_acc_29925 = res_28773;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_28771 = x_acc_29925;\n            ((__local\n              floa",
                   "t *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912)] =\n                x_28771;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_29931;\n        int32_t skip_waves_29932;\n        \n        skip_waves_29932 = 1;\n        \n        float x_29927;\n        float x_29928;\n        \n        offset_29931 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_29912,\n                      sext_i64_i32(segred_group_sizze_28767))) {\n                x_29927 = ((__local\n                            float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912 +\n                                                        offset_29931)];\n            }\n        }\n        offset_29931 = 1;\n        while (slt32(offset_29931, wave_sizze_29914)) {\n            if (slt32(local_tid_29912 + offset_29931,\n                      sext_i64_i32(segred_group_sizze_28767)) &&\n                ((local_tid_29912 - squot32(local_tid_29912, wave_sizze_29914) *\n                  wave_sizze_29914) & (2 * offset_29931 - 1)) == 0) {\n                // read array element\n                {\n                    x_29928 = ((volatile __local\n                                float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912 +\n                                                            offset_29931)];\n                }\n                // apply reduction operation\n                {\n                    float res_29929 = x_29927 + x_29928;\n                    \n                    x_29927 = res_29929;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912)] =\n                        x_29927;\n                }\n            }\n            offset_29931 *= 2;\n        }\n        while (slt32(skip_waves_29932,\n                     squot32(sext_i64_i32(segred_group_sizze_28767) +\n                             wave_s",
                   "izze_29914 - 1, wave_sizze_29914))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_29931 = skip_waves_29932 * wave_sizze_29914;\n            if (slt32(local_tid_29912 + offset_29931,\n                      sext_i64_i32(segred_group_sizze_28767)) &&\n                ((local_tid_29912 - squot32(local_tid_29912, wave_sizze_29914) *\n                  wave_sizze_29914) == 0 && (squot32(local_tid_29912,\n                                                     wave_sizze_29914) & (2 *\n                                                                          skip_waves_29932 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_29928 = ((__local\n                                float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912 +\n                                                            offset_29931)];\n                }\n                // apply reduction operation\n                {\n                    float res_29929 = x_29927 + x_29928;\n                    \n                    x_29927 = res_29929;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912)] =\n                        x_29927;\n                }\n            }\n            skip_waves_29932 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_29912) == 0) {\n                x_acc_29925 = x_29927;\n            }\n        }\n        if (groups_per_segment_29902 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_29912 == 0) {\n                    ((__global float *) mem_29013)[gtid_28708] = x_acc_29925;\n                }\n            }\n        } else {\n            int32_t old_cou",
                   "nter_29933;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_29912 == 0) {\n                    ((__global\n                      float *) group_res_arr_mem_29907)[sext_i32_i64(virt_group_id_29922) *\n                                                        segred_group_sizze_28767] =\n                        x_acc_29925;\n                    mem_fence_global();\n                    old_counter_29933 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_29909)[sext_i32_i64(srem32(flat_segment_id_29923,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_29918)[0] =\n                        old_counter_29933 == groups_per_segment_29902 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_29934;\n            \n            is_last_group_29934 = ((__local bool *) sync_arr_mem_29918)[0];\n            if (is_last_group_29934) {\n                if (local_tid_29912 == 0) {\n                    old_counter_29933 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_29909)[sext_i32_i64(srem32(flat_segment_id_29923,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_29902));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_29935 =\n                            sdiv_up64(groups_per_segment_29902,\n                       ",
                   "               segred_group_sizze_28767);\n                    \n                    x_28771 = 0.0F;\n                    for (int64_t i_29936 = 0; i_29936 < read_per_thread_29935;\n                         i_29936++) {\n                        int64_t group_res_id_29937 =\n                                sext_i32_i64(local_tid_29912) *\n                                read_per_thread_29935 + i_29936;\n                        int64_t index_of_group_res_29938 =\n                                sext_i32_i64(flat_segment_id_29923) *\n                                groups_per_segment_29902 + group_res_id_29937;\n                        \n                        if (slt64(group_res_id_29937,\n                                  groups_per_segment_29902)) {\n                            x_28772 = ((__global\n                                        float *) group_res_arr_mem_29907)[index_of_group_res_29938 *\n                                                                          segred_group_sizze_28767];\n                            \n                            float res_28773;\n                            \n                            res_28773 = x_28771 + x_28772;\n                            x_28771 = res_28773;\n                        }\n                    }\n                }\n                ((__local\n                  float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912)] =\n                    x_28771;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_29939;\n                    int32_t skip_waves_29940;\n                    \n                    skip_waves_29940 = 1;\n                    \n                    float x_29927;\n                    float x_29928;\n                    \n                    offset_29939 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_29912,\n                                  ",
                   "sext_i64_i32(segred_group_sizze_28767))) {\n                            x_29927 = ((__local\n                                        float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912 +\n                                                                    offset_29939)];\n                        }\n                    }\n                    offset_29939 = 1;\n                    while (slt32(offset_29939, wave_sizze_29914)) {\n                        if (slt32(local_tid_29912 + offset_29939,\n                                  sext_i64_i32(segred_group_sizze_28767)) &&\n                            ((local_tid_29912 - squot32(local_tid_29912,\n                                                        wave_sizze_29914) *\n                              wave_sizze_29914) & (2 * offset_29939 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_29928 = ((volatile __local\n                                            float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912 +\n                                                                        offset_29939)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_29929 = x_29927 + x_29928;\n                                \n                                x_29927 = res_29929;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912)] =\n                                    x_29927;\n                            }\n                        }\n                        offset_29939 *= 2;\n                    }\n                    while (slt32(skip_waves_29940,\n                                 squot32(sext_i64_i32(segred_group_sizze_28767) +\n    ",
                   "                                     wave_sizze_29914 - 1,\n                                         wave_sizze_29914))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_29939 = skip_waves_29940 * wave_sizze_29914;\n                        if (slt32(local_tid_29912 + offset_29939,\n                                  sext_i64_i32(segred_group_sizze_28767)) &&\n                            ((local_tid_29912 - squot32(local_tid_29912,\n                                                        wave_sizze_29914) *\n                              wave_sizze_29914) == 0 &&\n                             (squot32(local_tid_29912, wave_sizze_29914) & (2 *\n                                                                            skip_waves_29940 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_29928 = ((__local\n                                            float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912 +\n                                                                        offset_29939)];\n                            }\n                            // apply reduction operation\n                            {\n                                float res_29929 = x_29927 + x_29928;\n                                \n                                x_29927 = res_29929;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  float *) red_arr_mem_29916)[sext_i32_i64(local_tid_29912)] =\n                                    x_29927;\n                            }\n                        }\n                        skip_waves_29940 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n  ",
                   "                      if (local_tid_29912 == 0) {\n                            ((__global float *) mem_29013)[gtid_28708] =\n                                x_29927;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_28767\n}\n__kernel void testzisegred_large_29517(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *sync_arr_mem_29555_backing_aligned_0,\n                                       __local volatile\n                                       int64_t *red_arr_mem_29553_backing_aligned_1,\n                                       int64_t res_26335,\n                                       int64_t num_groups_28550, __global\n                                       unsigned char *mem_28974,\n                                       int32_t num_subhistos_29431, __global\n                                       unsigned char *res_subhistos_mem_29432,\n                                       int64_t groups_per_segment_29539,\n                                       int64_t elements_per_thread_29540,\n                                       int64_t virt_num_groups_29541,\n                                       int64_t threads_per_segment_29543,\n                                       __global\n                                       unsigned char *group_res_arr_mem_29544,\n                                       __global\n                                       unsigned char *testzicounter_mem_29546)\n{\n    #define seghist_group_sizze_28548 (testziseghist_group_sizze_28547)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict sync_arr_mem_29555_backing_1 =\n                          (__local volatile\n                           char *) sync_arr_mem_29555_backing_aligned_0;\n    __loca",
                   "l volatile char *restrict red_arr_mem_29553_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_29553_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29548;\n    int32_t local_tid_29549;\n    int64_t group_sizze_29552;\n    int32_t wave_sizze_29551;\n    int32_t group_tid_29550;\n    \n    global_tid_29548 = get_global_id(0);\n    local_tid_29549 = get_local_id(0);\n    group_sizze_29552 = get_local_size(0);\n    wave_sizze_29551 = LOCKSTEP_WIDTH;\n    group_tid_29550 = get_group_id(0);\n    \n    int32_t flat_gtid_29517;\n    \n    flat_gtid_29517 = global_tid_29548;\n    \n    __local char *red_arr_mem_29553;\n    \n    red_arr_mem_29553 = (__local char *) red_arr_mem_29553_backing_0;\n    \n    __local char *sync_arr_mem_29555;\n    \n    sync_arr_mem_29555 = (__local char *) sync_arr_mem_29555_backing_1;\n    \n    int32_t phys_group_id_29557;\n    \n    phys_group_id_29557 = get_group_id(0);\n    for (int32_t i_29558 = 0; i_29558 <\n         sdiv_up32(sext_i64_i32(virt_num_groups_29541) - phys_group_id_29557,\n                   sext_i64_i32(num_groups_28550)); i_29558++) {\n        int32_t virt_group_id_29559 = phys_group_id_29557 + i_29558 *\n                sext_i64_i32(num_groups_28550);\n        int32_t flat_segment_id_29560 = squot32(virt_group_id_29559,\n                                                sext_i64_i32(groups_per_segment_29539));\n        int64_t global_tid_29561 = srem64(sext_i32_i64(virt_group_id_29559) *\n                                          seghist_group_sizze_28548 +\n                                          sext_i32_i64(local_tid_29549),\n                                          seghist_group_sizze_28548 *\n                                          groups_per_segment_29539);\n        int64_t bucket_id_29515 = sext_i32_i64(flat_segment_id_29560);\n        int64_t subhistogram_id_29516;\n        int64_t x_acc_29562;\n        int64_t chunk_sizze_29563;\n        \n        chunk",
                   "_sizze_29563 = smin64(elements_per_thread_29540,\n                                   sdiv_up64(num_subhistos_29431 -\n                                             sext_i32_i64(sext_i64_i32(global_tid_29561)),\n                                             threads_per_segment_29543));\n        \n        int64_t x_28554;\n        int64_t x_28555;\n        \n        // neutral-initialise the accumulators\n        {\n            x_acc_29562 = 0;\n        }\n        for (int64_t i_29567 = 0; i_29567 < chunk_sizze_29563; i_29567++) {\n            subhistogram_id_29516 =\n                sext_i32_i64(sext_i64_i32(global_tid_29561)) +\n                threads_per_segment_29543 * i_29567;\n            // apply map function\n            {\n                // load accumulator\n                {\n                    x_28554 = x_acc_29562;\n                }\n                // load new values\n                {\n                    x_28555 = ((__global\n                                int64_t *) res_subhistos_mem_29432)[subhistogram_id_29516 *\n                                                                    res_26335 +\n                                                                    bucket_id_29515];\n                }\n                // apply reduction operator\n                {\n                    int64_t res_28556 = smax64(x_28554, x_28555);\n                    \n                    // store in accumulator\n                    {\n                        x_acc_29562 = res_28556;\n                    }\n                }\n            }\n        }\n        // to reduce current chunk, first store our result in memory\n        {\n            x_28554 = x_acc_29562;\n            ((__local\n              int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549)] =\n                x_28554;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        \n        int32_t offset_29568;\n        int32_t skip_waves_29569;\n        \n        skip_waves_29569 = 1;\n        \n        int64_t x_29564;\n        int64_t x_29565;\n        \n",
                   "        offset_29568 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_29549,\n                      sext_i64_i32(seghist_group_sizze_28548))) {\n                x_29564 = ((__local\n                            int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549 +\n                                                          offset_29568)];\n            }\n        }\n        offset_29568 = 1;\n        while (slt32(offset_29568, wave_sizze_29551)) {\n            if (slt32(local_tid_29549 + offset_29568,\n                      sext_i64_i32(seghist_group_sizze_28548)) &&\n                ((local_tid_29549 - squot32(local_tid_29549, wave_sizze_29551) *\n                  wave_sizze_29551) & (2 * offset_29568 - 1)) == 0) {\n                // read array element\n                {\n                    x_29565 = ((volatile __local\n                                int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549 +\n                                                              offset_29568)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_29566 = smax64(x_29564, x_29565);\n                    \n                    x_29564 = res_29566;\n                }\n                // write result of operation\n                {\n                    ((volatile __local\n                      int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549)] =\n                        x_29564;\n                }\n            }\n            offset_29568 *= 2;\n        }\n        while (slt32(skip_waves_29569,\n                     squot32(sext_i64_i32(seghist_group_sizze_28548) +\n                             wave_sizze_29551 - 1, wave_sizze_29551))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_29568 = skip_waves_29569 * wave_sizze_29551;\n            if (slt32(local_tid_29549 + offset_29568,\n                      sext_i64_i32(seghist_group_sizze_28548)) &&\n                ((lo",
                   "cal_tid_29549 - squot32(local_tid_29549, wave_sizze_29551) *\n                  wave_sizze_29551) == 0 && (squot32(local_tid_29549,\n                                                     wave_sizze_29551) & (2 *\n                                                                          skip_waves_29569 -\n                                                                          1)) ==\n                 0)) {\n                // read array element\n                {\n                    x_29565 = ((__local\n                                int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549 +\n                                                              offset_29568)];\n                }\n                // apply reduction operation\n                {\n                    int64_t res_29566 = smax64(x_29564, x_29565);\n                    \n                    x_29564 = res_29566;\n                }\n                // write result of operation\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549)] =\n                        x_29564;\n                }\n            }\n            skip_waves_29569 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // first thread saves the result in accumulator\n        {\n            if (sext_i32_i64(local_tid_29549) == 0) {\n                x_acc_29562 = x_29564;\n            }\n        }\n        if (groups_per_segment_29539 == 1) {\n            // first thread in group saves final result to memory\n            {\n                if (local_tid_29549 == 0) {\n                    ((__global int64_t *) mem_28974)[bucket_id_29515] =\n                        x_acc_29562;\n                }\n            }\n        } else {\n            int32_t old_counter_29570;\n            \n            // first thread in group saves group result to global memory\n            {\n                if (local_tid_29549 == 0) {\n                    ((__global\n                      int64_t *) group_res_arr_mem",
                   "_29544)[sext_i32_i64(virt_group_id_29559) *\n                                                          seghist_group_sizze_28548] =\n                        x_acc_29562;\n                    mem_fence_global();\n                    old_counter_29570 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_29546)[sext_i32_i64(srem32(flat_segment_id_29560,\n                                                                                                     10240))],\n                                              (int) 1);\n                    ((__local bool *) sync_arr_mem_29555)[0] =\n                        old_counter_29570 == groups_per_segment_29539 - 1;\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            \n            bool is_last_group_29571;\n            \n            is_last_group_29571 = ((__local bool *) sync_arr_mem_29555)[0];\n            if (is_last_group_29571) {\n                if (local_tid_29549 == 0) {\n                    old_counter_29570 =\n                        atomic_add_i32_global(&((volatile __global\n                                                 int *) testzicounter_mem_29546)[sext_i32_i64(srem32(flat_segment_id_29560,\n                                                                                                     10240))],\n                                              (int) (0 -\n                                                     groups_per_segment_29539));\n                }\n                // read in the per-group-results\n                {\n                    int64_t read_per_thread_29572 =\n                            sdiv_up64(groups_per_segment_29539,\n                                      seghist_group_sizze_28548);\n                    \n                    x_28554 = 0;\n                    for (int64_t i_29573 = 0; i_29573 < read_per_thread_29572;\n                         i_29573++) {\n                  ",
                   "      int64_t group_res_id_29574 =\n                                sext_i32_i64(local_tid_29549) *\n                                read_per_thread_29572 + i_29573;\n                        int64_t index_of_group_res_29575 =\n                                sext_i32_i64(flat_segment_id_29560) *\n                                groups_per_segment_29539 + group_res_id_29574;\n                        \n                        if (slt64(group_res_id_29574,\n                                  groups_per_segment_29539)) {\n                            x_28555 = ((__global\n                                        int64_t *) group_res_arr_mem_29544)[index_of_group_res_29575 *\n                                                                            seghist_group_sizze_28548];\n                            \n                            int64_t res_28556;\n                            \n                            res_28556 = smax64(x_28554, x_28555);\n                            x_28554 = res_28556;\n                        }\n                    }\n                }\n                ((__local\n                  int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549)] =\n                    x_28554;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-group results\n                {\n                    int32_t offset_29576;\n                    int32_t skip_waves_29577;\n                    \n                    skip_waves_29577 = 1;\n                    \n                    int64_t x_29564;\n                    int64_t x_29565;\n                    \n                    offset_29576 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_29549,\n                                  sext_i64_i32(seghist_group_sizze_28548))) {\n                            x_29564 = ((__local\n                                        int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549 +\n                     ",
                   "                                                 offset_29576)];\n                        }\n                    }\n                    offset_29576 = 1;\n                    while (slt32(offset_29576, wave_sizze_29551)) {\n                        if (slt32(local_tid_29549 + offset_29576,\n                                  sext_i64_i32(seghist_group_sizze_28548)) &&\n                            ((local_tid_29549 - squot32(local_tid_29549,\n                                                        wave_sizze_29551) *\n                              wave_sizze_29551) & (2 * offset_29576 - 1)) ==\n                            0) {\n                            // read array element\n                            {\n                                x_29565 = ((volatile __local\n                                            int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549 +\n                                                                          offset_29576)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_29566 = smax64(x_29564, x_29565);\n                                \n                                x_29564 = res_29566;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549)] =\n                                    x_29564;\n                            }\n                        }\n                        offset_29576 *= 2;\n                    }\n                    while (slt32(skip_waves_29577,\n                                 squot32(sext_i64_i32(seghist_group_sizze_28548) +\n                                         wave_sizze_29551 - 1,\n                                         wave_sizze_29551))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                ",
                   "        offset_29576 = skip_waves_29577 * wave_sizze_29551;\n                        if (slt32(local_tid_29549 + offset_29576,\n                                  sext_i64_i32(seghist_group_sizze_28548)) &&\n                            ((local_tid_29549 - squot32(local_tid_29549,\n                                                        wave_sizze_29551) *\n                              wave_sizze_29551) == 0 &&\n                             (squot32(local_tid_29549, wave_sizze_29551) & (2 *\n                                                                            skip_waves_29577 -\n                                                                            1)) ==\n                             0)) {\n                            // read array element\n                            {\n                                x_29565 = ((__local\n                                            int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549 +\n                                                                          offset_29576)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t res_29566 = smax64(x_29564, x_29565);\n                                \n                                x_29564 = res_29566;\n                            }\n                            // write result of operation\n                            {\n                                ((__local\n                                  int64_t *) red_arr_mem_29553)[sext_i32_i64(local_tid_29549)] =\n                                    x_29564;\n                            }\n                        }\n                        skip_waves_29577 *= 2;\n                    }\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_29549 == 0) {\n                            ((__global int64_t *) mem_28974)[bucket_id_29515] =\n                                x_29564;\n     ",
                   "                   }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_28548\n}\n__kernel void testzisegred_nonseg_27694(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29220_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29218_backing_aligned_1,\n                                        int64_t num_groups_27689, __global\n                                        unsigned char *mem_28881, __global\n                                        unsigned char *mem_28883, __global\n                                        unsigned char *mem_28886, __global\n                                        unsigned char *testzicounter_mem_29208,\n                                        __global\n                                        unsigned char *group_res_arr_mem_29210,\n                                        int64_t num_threads_29212)\n{\n    #define segred_group_sizze_27687 (testzisegred_group_sizze_27686)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29220_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_29220_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_29218_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29218_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29213;\n    int32_t local_tid_29214;\n    int64_t group_sizze_29217;\n    int32_t wave_sizze_29216;\n    int32_t group_tid_29215;\n    \n    global_tid_29213 = get_global_id(0);\n    local_tid_29214 = get_local_id(0);\n    group_sizze_29217 = g",
                   "et_local_size(0);\n    wave_sizze_29216 = LOCKSTEP_WIDTH;\n    group_tid_29215 = get_group_id(0);\n    \n    int32_t phys_tid_27694;\n    \n    phys_tid_27694 = global_tid_29213;\n    \n    __local char *sync_arr_mem_29218;\n    \n    sync_arr_mem_29218 = (__local char *) sync_arr_mem_29218_backing_0;\n    \n    __local char *red_arr_mem_29220;\n    \n    red_arr_mem_29220 = (__local char *) red_arr_mem_29220_backing_1;\n    \n    int64_t dummy_27692;\n    \n    dummy_27692 = 0;\n    \n    int64_t gtid_27693;\n    \n    gtid_27693 = 0;\n    \n    float x_acc_29222;\n    int64_t chunk_sizze_29223;\n    \n    chunk_sizze_29223 = smin64(sdiv_up64(9,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_27687 *\n                                         num_groups_27689))), sdiv_up64(9 -\n                                                                        sext_i32_i64(phys_tid_27694),\n                                                                        num_threads_29212));\n    \n    float x_26141;\n    float x_26142;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29222 = -INFINITY;\n    }\n    for (int64_t i_29227 = 0; i_29227 < chunk_sizze_29223; i_29227++) {\n        gtid_27693 = sext_i32_i64(phys_tid_27694) + num_threads_29212 * i_29227;\n        // apply map function\n        {\n            float x_26144 = ((__global float *) mem_28883)[gtid_27693];\n            int64_t x_26145 = ((__global int64_t *) mem_28881)[gtid_27693];\n            float res_26146 = sitofp_i64_f32(x_26145);\n            float res_26147 = x_26144 * res_26146;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_26141 = x_acc_29222;\n            }\n            // load new values\n            {\n                x_26142 = res_26147;\n            }\n            // apply reduction operator\n            {\n                float res_26143 = fmax32(x_26141, x_26142);\n                \n                // store in accum",
                   "ulator\n                {\n                    x_acc_29222 = res_26143;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_26141 = x_acc_29222;\n        ((__local float *) red_arr_mem_29220)[sext_i32_i64(local_tid_29214)] =\n            x_26141;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29228;\n    int32_t skip_waves_29229;\n    \n    skip_waves_29229 = 1;\n    \n    float x_29224;\n    float x_29225;\n    \n    offset_29228 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29214, sext_i64_i32(segred_group_sizze_27687))) {\n            x_29224 = ((__local\n                        float *) red_arr_mem_29220)[sext_i32_i64(local_tid_29214 +\n                                                    offset_29228)];\n        }\n    }\n    offset_29228 = 1;\n    while (slt32(offset_29228, wave_sizze_29216)) {\n        if (slt32(local_tid_29214 + offset_29228,\n                  sext_i64_i32(segred_group_sizze_27687)) && ((local_tid_29214 -\n                                                               squot32(local_tid_29214,\n                                                                       wave_sizze_29216) *\n                                                               wave_sizze_29216) &\n                                                              (2 *\n                                                               offset_29228 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_29225 = ((volatile __local\n                            float *) red_arr_mem_29220)[sext_i32_i64(local_tid_29214 +\n                                                        offset_29228)];\n            }\n            // apply reduction operation\n            {\n                float res_29226 = fmax32(x_29224, x_29225);\n                \n                x_29224 = res_29226;\n            }\n     ",
                   "       // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_29220)[sext_i32_i64(local_tid_29214)] =\n                    x_29224;\n            }\n        }\n        offset_29228 *= 2;\n    }\n    while (slt32(skip_waves_29229,\n                 squot32(sext_i64_i32(segred_group_sizze_27687) +\n                         wave_sizze_29216 - 1, wave_sizze_29216))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29228 = skip_waves_29229 * wave_sizze_29216;\n        if (slt32(local_tid_29214 + offset_29228,\n                  sext_i64_i32(segred_group_sizze_27687)) && ((local_tid_29214 -\n                                                               squot32(local_tid_29214,\n                                                                       wave_sizze_29216) *\n                                                               wave_sizze_29216) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29214,\n                                                                       wave_sizze_29216) &\n                                                               (2 *\n                                                                skip_waves_29229 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_29225 = ((__local\n                            float *) red_arr_mem_29220)[sext_i32_i64(local_tid_29214 +\n                                                        offset_29228)];\n            }\n            // apply reduction operation\n            {\n                float res_29226 = fmax32(x_29224, x_29225);\n                \n                x_29224 = res_29226;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_29220)[sext_i32_i64(local_tid_29214)] =\n              ",
                   "      x_29224;\n            }\n        }\n        skip_waves_29229 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29214) == 0) {\n            x_acc_29222 = x_29224;\n        }\n    }\n    \n    int32_t old_counter_29230;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29214 == 0) {\n            ((__global\n              float *) group_res_arr_mem_29210)[sext_i32_i64(group_tid_29215) *\n                                                segred_group_sizze_27687] =\n                x_acc_29222;\n            mem_fence_global();\n            old_counter_29230 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29208)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29218)[0] = old_counter_29230 ==\n                num_groups_27689 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29231;\n    \n    is_last_group_29231 = ((__local bool *) sync_arr_mem_29218)[0];\n    if (is_last_group_29231) {\n        if (local_tid_29214 == 0) {\n            old_counter_29230 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29208)[0],\n                                                      (int) (0 -\n                                                             num_groups_27689));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29232 = sdiv_up64(num_groups_27689,\n                                                      segred_group_sizze_27687);\n            \n            x_26141 = -INFINITY;\n            for (int64_t i_29233 = 0; i_29233 < read_per_thread_29232;\n                 i_29233++) {\n                int64_t group_res_id_29234 = sext_i32_i64(local_tid_29214)",
                   " *\n                        read_per_thread_29232 + i_29233;\n                int64_t index_of_group_res_29235 = group_res_id_29234;\n                \n                if (slt64(group_res_id_29234, num_groups_27689)) {\n                    x_26142 = ((__global\n                                float *) group_res_arr_mem_29210)[index_of_group_res_29235 *\n                                                                  segred_group_sizze_27687];\n                    \n                    float res_26143;\n                    \n                    res_26143 = fmax32(x_26141, x_26142);\n                    x_26141 = res_26143;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_29220)[sext_i32_i64(local_tid_29214)] =\n            x_26141;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29236;\n            int32_t skip_waves_29237;\n            \n            skip_waves_29237 = 1;\n            \n            float x_29224;\n            float x_29225;\n            \n            offset_29236 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29214,\n                          sext_i64_i32(segred_group_sizze_27687))) {\n                    x_29224 = ((__local\n                                float *) red_arr_mem_29220)[sext_i32_i64(local_tid_29214 +\n                                                            offset_29236)];\n                }\n            }\n            offset_29236 = 1;\n            while (slt32(offset_29236, wave_sizze_29216)) {\n                if (slt32(local_tid_29214 + offset_29236,\n                          sext_i64_i32(segred_group_sizze_27687)) &&\n                    ((local_tid_29214 - squot32(local_tid_29214,\n                                                wave_sizze_29216) *\n                      wave_sizze_29216) & (2 * offset_29236 - 1)) == 0) {\n                    // read array element\n                    {\n      ",
                   "                  x_29225 = ((volatile __local\n                                    float *) red_arr_mem_29220)[sext_i32_i64(local_tid_29214 +\n                                                                offset_29236)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29226 = fmax32(x_29224, x_29225);\n                        \n                        x_29224 = res_29226;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_29220)[sext_i32_i64(local_tid_29214)] =\n                            x_29224;\n                    }\n                }\n                offset_29236 *= 2;\n            }\n            while (slt32(skip_waves_29237,\n                         squot32(sext_i64_i32(segred_group_sizze_27687) +\n                                 wave_sizze_29216 - 1, wave_sizze_29216))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29236 = skip_waves_29237 * wave_sizze_29216;\n                if (slt32(local_tid_29214 + offset_29236,\n                          sext_i64_i32(segred_group_sizze_27687)) &&\n                    ((local_tid_29214 - squot32(local_tid_29214,\n                                                wave_sizze_29216) *\n                      wave_sizze_29216) == 0 && (squot32(local_tid_29214,\n                                                         wave_sizze_29216) &\n                                                 (2 * skip_waves_29237 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_29225 = ((__local\n                                    float *) red_arr_mem_29220)[sext_i32_i64(local_tid_29214 +\n                                                                offset_29236)];\n                    }\n                    // apply reduction operation\n                  ",
                   "  {\n                        float res_29226 = fmax32(x_29224, x_29225);\n                        \n                        x_29224 = res_29226;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_29220)[sext_i32_i64(local_tid_29214)] =\n                            x_29224;\n                    }\n                }\n                skip_waves_29237 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29214 == 0) {\n                    ((__global float *) mem_28886)[0] = x_29224;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_27687\n}\n__kernel void testzisegred_nonseg_28545(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29404_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29402_backing_aligned_1,\n                                        int64_t flat_dim_26302,\n                                        int64_t num_groups_28540, __global\n                                        unsigned char *mem_28969, __global\n                                        unsigned char *mem_28972, __global\n                                        unsigned char *testzicounter_mem_29392,\n                                        __global\n                                        unsigned char *group_res_arr_mem_29394,\n                                        int64_t num_threads_29396)\n{\n    #define segred_group_sizze_28538 (testzisegred_group_sizze_28537)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29404_backing_1 =\n                          (__local volatile\n                      ",
                   "     char *) red_arr_mem_29404_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_29402_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29402_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29397;\n    int32_t local_tid_29398;\n    int64_t group_sizze_29401;\n    int32_t wave_sizze_29400;\n    int32_t group_tid_29399;\n    \n    global_tid_29397 = get_global_id(0);\n    local_tid_29398 = get_local_id(0);\n    group_sizze_29401 = get_local_size(0);\n    wave_sizze_29400 = LOCKSTEP_WIDTH;\n    group_tid_29399 = get_group_id(0);\n    \n    int32_t phys_tid_28545;\n    \n    phys_tid_28545 = global_tid_29397;\n    \n    __local char *sync_arr_mem_29402;\n    \n    sync_arr_mem_29402 = (__local char *) sync_arr_mem_29402_backing_0;\n    \n    __local char *red_arr_mem_29404;\n    \n    red_arr_mem_29404 = (__local char *) red_arr_mem_29404_backing_1;\n    \n    int64_t dummy_28543;\n    \n    dummy_28543 = 0;\n    \n    int64_t gtid_28544;\n    \n    gtid_28544 = 0;\n    \n    int64_t x_acc_29406;\n    int64_t chunk_sizze_29407;\n    \n    chunk_sizze_29407 = smin64(sdiv_up64(flat_dim_26302,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_28538 *\n                                         num_groups_28540))),\n                               sdiv_up64(flat_dim_26302 -\n                                         sext_i32_i64(phys_tid_28545),\n                                         num_threads_29396));\n    \n    int64_t x_26336;\n    int64_t x_26337;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29406 = 0;\n    }\n    for (int64_t i_29411 = 0; i_29411 < chunk_sizze_29407; i_29411++) {\n        gtid_28544 = sext_i32_i64(phys_tid_28545) + num_threads_29396 * i_29411;\n        // apply map function\n        {\n            int64_t x_26339 = ((__global int64_t *) mem_28969)[gtid_28544];\n            \n            // save map-out results\n           ",
                   " { }\n            // load accumulator\n            {\n                x_26336 = x_acc_29406;\n            }\n            // load new values\n            {\n                x_26337 = x_26339;\n            }\n            // apply reduction operator\n            {\n                int64_t res_26338 = add64(x_26336, x_26337);\n                \n                // store in accumulator\n                {\n                    x_acc_29406 = res_26338;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_26336 = x_acc_29406;\n        ((__local int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398)] =\n            x_26336;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29412;\n    int32_t skip_waves_29413;\n    \n    skip_waves_29413 = 1;\n    \n    int64_t x_29408;\n    int64_t x_29409;\n    \n    offset_29412 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29398, sext_i64_i32(segred_group_sizze_28538))) {\n            x_29408 = ((__local\n                        int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398 +\n                                                      offset_29412)];\n        }\n    }\n    offset_29412 = 1;\n    while (slt32(offset_29412, wave_sizze_29400)) {\n        if (slt32(local_tid_29398 + offset_29412,\n                  sext_i64_i32(segred_group_sizze_28538)) && ((local_tid_29398 -\n                                                               squot32(local_tid_29398,\n                                                                       wave_sizze_29400) *\n                                                               wave_sizze_29400) &\n                                                              (2 *\n                                                               offset_29412 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_29409 = ((volat",
                   "ile __local\n                            int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398 +\n                                                          offset_29412)];\n            }\n            // apply reduction operation\n            {\n                int64_t res_29410 = add64(x_29408, x_29409);\n                \n                x_29408 = res_29410;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398)] =\n                    x_29408;\n            }\n        }\n        offset_29412 *= 2;\n    }\n    while (slt32(skip_waves_29413,\n                 squot32(sext_i64_i32(segred_group_sizze_28538) +\n                         wave_sizze_29400 - 1, wave_sizze_29400))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29412 = skip_waves_29413 * wave_sizze_29400;\n        if (slt32(local_tid_29398 + offset_29412,\n                  sext_i64_i32(segred_group_sizze_28538)) && ((local_tid_29398 -\n                                                               squot32(local_tid_29398,\n                                                                       wave_sizze_29400) *\n                                                               wave_sizze_29400) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29398,\n                                                                       wave_sizze_29400) &\n                                                               (2 *\n                                                                skip_waves_29413 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_29409 = ((__local\n                            int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398 +\n                                                          off",
                   "set_29412)];\n            }\n            // apply reduction operation\n            {\n                int64_t res_29410 = add64(x_29408, x_29409);\n                \n                x_29408 = res_29410;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398)] =\n                    x_29408;\n            }\n        }\n        skip_waves_29413 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29398) == 0) {\n            x_acc_29406 = x_29408;\n        }\n    }\n    \n    int32_t old_counter_29414;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29398 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_29394)[sext_i32_i64(group_tid_29399) *\n                                                  segred_group_sizze_28538] =\n                x_acc_29406;\n            mem_fence_global();\n            old_counter_29414 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29392)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29402)[0] = old_counter_29414 ==\n                num_groups_28540 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29415;\n    \n    is_last_group_29415 = ((__local bool *) sync_arr_mem_29402)[0];\n    if (is_last_group_29415) {\n        if (local_tid_29398 == 0) {\n            old_counter_29414 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29392)[0],\n                                                      (int) (0 -\n                                                             num_groups_28540));\n        }\n        // read in the per-group-r",
                   "esults\n        {\n            int64_t read_per_thread_29416 = sdiv_up64(num_groups_28540,\n                                                      segred_group_sizze_28538);\n            \n            x_26336 = 0;\n            for (int64_t i_29417 = 0; i_29417 < read_per_thread_29416;\n                 i_29417++) {\n                int64_t group_res_id_29418 = sext_i32_i64(local_tid_29398) *\n                        read_per_thread_29416 + i_29417;\n                int64_t index_of_group_res_29419 = group_res_id_29418;\n                \n                if (slt64(group_res_id_29418, num_groups_28540)) {\n                    x_26337 = ((__global\n                                int64_t *) group_res_arr_mem_29394)[index_of_group_res_29419 *\n                                                                    segred_group_sizze_28538];\n                    \n                    int64_t res_26338;\n                    \n                    res_26338 = add64(x_26336, x_26337);\n                    x_26336 = res_26338;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398)] =\n            x_26336;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29420;\n            int32_t skip_waves_29421;\n            \n            skip_waves_29421 = 1;\n            \n            int64_t x_29408;\n            int64_t x_29409;\n            \n            offset_29420 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29398,\n                          sext_i64_i32(segred_group_sizze_28538))) {\n                    x_29408 = ((__local\n                                int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398 +\n                                                              offset_29420)];\n                }\n            }\n            offset_29420 = 1;\n            while (slt32(offset_29420, wave_sizze_29400)) {\n      ",
                   "          if (slt32(local_tid_29398 + offset_29420,\n                          sext_i64_i32(segred_group_sizze_28538)) &&\n                    ((local_tid_29398 - squot32(local_tid_29398,\n                                                wave_sizze_29400) *\n                      wave_sizze_29400) & (2 * offset_29420 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_29409 = ((volatile __local\n                                    int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398 +\n                                                                  offset_29420)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_29410 = add64(x_29408, x_29409);\n                        \n                        x_29408 = res_29410;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398)] =\n                            x_29408;\n                    }\n                }\n                offset_29420 *= 2;\n            }\n            while (slt32(skip_waves_29421,\n                         squot32(sext_i64_i32(segred_group_sizze_28538) +\n                                 wave_sizze_29400 - 1, wave_sizze_29400))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29420 = skip_waves_29421 * wave_sizze_29400;\n                if (slt32(local_tid_29398 + offset_29420,\n                          sext_i64_i32(segred_group_sizze_28538)) &&\n                    ((local_tid_29398 - squot32(local_tid_29398,\n                                                wave_sizze_29400) *\n                      wave_sizze_29400) == 0 && (squot32(local_tid_29398,\n                                                         wave_sizze_29400) &\n                                                 (2 * skip_waves_29421 - 1",
                   ")) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_29409 = ((__local\n                                    int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398 +\n                                                                  offset_29420)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t res_29410 = add64(x_29408, x_29409);\n                        \n                        x_29408 = res_29410;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_29404)[sext_i32_i64(local_tid_29398)] =\n                            x_29408;\n                    }\n                }\n                skip_waves_29421 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29398 == 0) {\n                    ((__global int64_t *) mem_28972)[0] = x_29408;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_28538\n}\n__kernel void testzisegred_nonseg_28654(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29856_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29854_backing_aligned_1,\n                                        int64_t paths_26135,\n                                        int64_t num_groups_28657, __global\n                                        unsigned char *mem_29001, __global\n                                        unsigned char *mem_29004, __global\n                                        unsigned char *testzicounter_mem_29844,\n                                        __global\n                                   ",
                   "     unsigned char *group_res_arr_mem_29846,\n                                        int64_t num_threads_29848)\n{\n    #define segred_group_sizze_28656 (testzisegred_group_sizze_28646)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29856_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_29856_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_29854_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29854_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29849;\n    int32_t local_tid_29850;\n    int64_t group_sizze_29853;\n    int32_t wave_sizze_29852;\n    int32_t group_tid_29851;\n    \n    global_tid_29849 = get_global_id(0);\n    local_tid_29850 = get_local_id(0);\n    group_sizze_29853 = get_local_size(0);\n    wave_sizze_29852 = LOCKSTEP_WIDTH;\n    group_tid_29851 = get_group_id(0);\n    \n    int32_t phys_tid_28654;\n    \n    phys_tid_28654 = global_tid_29849;\n    \n    __local char *sync_arr_mem_29854;\n    \n    sync_arr_mem_29854 = (__local char *) sync_arr_mem_29854_backing_0;\n    \n    __local char *red_arr_mem_29856;\n    \n    red_arr_mem_29856 = (__local char *) red_arr_mem_29856_backing_1;\n    \n    int64_t dummy_28652;\n    \n    dummy_28652 = 0;\n    \n    int64_t gtid_28653;\n    \n    gtid_28653 = 0;\n    \n    float x_acc_29858;\n    int64_t chunk_sizze_29859;\n    \n    chunk_sizze_29859 = smin64(sdiv_up64(paths_26135,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_28656 *\n                                         num_groups_28657))),\n                               sdiv_up64(paths_26135 -\n                                         sext_i32_i64(phys_tid_28654),\n                                         num_threads_29848));\n    \n    float x_28660;\n    float x_28661;\n    \n    // neu",
                   "tral-initialise the accumulators\n    {\n        x_acc_29858 = 0.0F;\n    }\n    for (int64_t i_29863 = 0; i_29863 < chunk_sizze_29859; i_29863++) {\n        gtid_28653 = sext_i32_i64(phys_tid_28654) + num_threads_29848 * i_29863;\n        // apply map function\n        {\n            float res_28664;\n            float redout_28866 = 0.0F;\n            \n            for (int32_t i_28876 = 0; i_28876 < 9; i_28876++) {\n                int64_t i_28867 = sext_i32_i64(i_28876);\n                float x_28668 = ((__global float *) mem_29001)[i_28867 *\n                                                               paths_26135 +\n                                                               gtid_28653];\n                float res_28667 = x_28668 + redout_28866;\n                float redout_tmp_29864 = res_28667;\n                \n                redout_28866 = redout_tmp_29864;\n            }\n            res_28664 = redout_28866;\n            \n            float res_28669 = fmax32(0.0F, res_28664);\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_28660 = x_acc_29858;\n            }\n            // load new values\n            {\n                x_28661 = res_28669;\n            }\n            // apply reduction operator\n            {\n                float res_28662 = x_28660 + x_28661;\n                \n                // store in accumulator\n                {\n                    x_acc_29858 = res_28662;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_28660 = x_acc_29858;\n        ((__local float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850)] =\n            x_28660;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29865;\n    int32_t skip_waves_29866;\n    \n    skip_waves_29866 = 1;\n    \n    float x_29860;\n    float x_29861;\n    \n    offset_29865 = 0;\n    // participating threads read initial accumulator\n    {\n        if ",
                   "(slt32(local_tid_29850, sext_i64_i32(segred_group_sizze_28656))) {\n            x_29860 = ((__local\n                        float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850 +\n                                                    offset_29865)];\n        }\n    }\n    offset_29865 = 1;\n    while (slt32(offset_29865, wave_sizze_29852)) {\n        if (slt32(local_tid_29850 + offset_29865,\n                  sext_i64_i32(segred_group_sizze_28656)) && ((local_tid_29850 -\n                                                               squot32(local_tid_29850,\n                                                                       wave_sizze_29852) *\n                                                               wave_sizze_29852) &\n                                                              (2 *\n                                                               offset_29865 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_29861 = ((volatile __local\n                            float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850 +\n                                                        offset_29865)];\n            }\n            // apply reduction operation\n            {\n                float res_29862 = x_29860 + x_29861;\n                \n                x_29860 = res_29862;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850)] =\n                    x_29860;\n            }\n        }\n        offset_29865 *= 2;\n    }\n    while (slt32(skip_waves_29866,\n                 squot32(sext_i64_i32(segred_group_sizze_28656) +\n                         wave_sizze_29852 - 1, wave_sizze_29852))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29865 = skip_waves_29866 * wave_sizze_29852;\n        if (slt32(local_tid_29850 + offset_29865,\n                  sext_i64_i32(s",
                   "egred_group_sizze_28656)) && ((local_tid_29850 -\n                                                               squot32(local_tid_29850,\n                                                                       wave_sizze_29852) *\n                                                               wave_sizze_29852) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29850,\n                                                                       wave_sizze_29852) &\n                                                               (2 *\n                                                                skip_waves_29866 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_29861 = ((__local\n                            float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850 +\n                                                        offset_29865)];\n            }\n            // apply reduction operation\n            {\n                float res_29862 = x_29860 + x_29861;\n                \n                x_29860 = res_29862;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850)] =\n                    x_29860;\n            }\n        }\n        skip_waves_29866 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29850) == 0) {\n            x_acc_29858 = x_29860;\n        }\n    }\n    \n    int32_t old_counter_29867;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29850 == 0) {\n            ((__global\n              float *) group_res_arr_mem_29846)[sext_i32_i64(group_tid_29851) *\n                                                segred_group_sizze_28656] =\n           ",
                   "     x_acc_29858;\n            mem_fence_global();\n            old_counter_29867 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29844)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29854)[0] = old_counter_29867 ==\n                num_groups_28657 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29868;\n    \n    is_last_group_29868 = ((__local bool *) sync_arr_mem_29854)[0];\n    if (is_last_group_29868) {\n        if (local_tid_29850 == 0) {\n            old_counter_29867 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29844)[0],\n                                                      (int) (0 -\n                                                             num_groups_28657));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29869 = sdiv_up64(num_groups_28657,\n                                                      segred_group_sizze_28656);\n            \n            x_28660 = 0.0F;\n            for (int64_t i_29870 = 0; i_29870 < read_per_thread_29869;\n                 i_29870++) {\n                int64_t group_res_id_29871 = sext_i32_i64(local_tid_29850) *\n                        read_per_thread_29869 + i_29870;\n                int64_t index_of_group_res_29872 = group_res_id_29871;\n                \n                if (slt64(group_res_id_29871, num_groups_28657)) {\n                    x_28661 = ((__global\n                                float *) group_res_arr_mem_29846)[index_of_group_res_29872 *\n                                                                  segred_group_sizze_28656];\n                    \n                    float res_28662;\n                    \n                    res_28662 = x_28660 + x_28661;\n                    x_28660 = res_28662;",
                   "\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850)] =\n            x_28660;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29873;\n            int32_t skip_waves_29874;\n            \n            skip_waves_29874 = 1;\n            \n            float x_29860;\n            float x_29861;\n            \n            offset_29873 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29850,\n                          sext_i64_i32(segred_group_sizze_28656))) {\n                    x_29860 = ((__local\n                                float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850 +\n                                                            offset_29873)];\n                }\n            }\n            offset_29873 = 1;\n            while (slt32(offset_29873, wave_sizze_29852)) {\n                if (slt32(local_tid_29850 + offset_29873,\n                          sext_i64_i32(segred_group_sizze_28656)) &&\n                    ((local_tid_29850 - squot32(local_tid_29850,\n                                                wave_sizze_29852) *\n                      wave_sizze_29852) & (2 * offset_29873 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_29861 = ((volatile __local\n                                    float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850 +\n                                                                offset_29873)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29862 = x_29860 + x_29861;\n                        \n                        x_29860 = res_29862;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) re",
                   "d_arr_mem_29856)[sext_i32_i64(local_tid_29850)] =\n                            x_29860;\n                    }\n                }\n                offset_29873 *= 2;\n            }\n            while (slt32(skip_waves_29874,\n                         squot32(sext_i64_i32(segred_group_sizze_28656) +\n                                 wave_sizze_29852 - 1, wave_sizze_29852))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29873 = skip_waves_29874 * wave_sizze_29852;\n                if (slt32(local_tid_29850 + offset_29873,\n                          sext_i64_i32(segred_group_sizze_28656)) &&\n                    ((local_tid_29850 - squot32(local_tid_29850,\n                                                wave_sizze_29852) *\n                      wave_sizze_29852) == 0 && (squot32(local_tid_29850,\n                                                         wave_sizze_29852) &\n                                                 (2 * skip_waves_29874 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_29861 = ((__local\n                                    float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850 +\n                                                                offset_29873)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29862 = x_29860 + x_29861;\n                        \n                        x_29860 = res_29862;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          float *) red_arr_mem_29856)[sext_i32_i64(local_tid_29850)] =\n                            x_29860;\n                    }\n                }\n                skip_waves_29874 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29850 == 0) {\n                    ((__global fl",
                   "oat *) mem_29004)[0] = x_29860;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_28656\n}\n__kernel void testzisegred_nonseg_28750(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29959_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29957_backing_aligned_1,\n                                        int64_t paths_26135,\n                                        int64_t num_groups_28785, __global\n                                        unsigned char *res_map_acc_mem_29017,\n                                        __global unsigned char *mem_29020,\n                                        __global\n                                        unsigned char *testzicounter_mem_29947,\n                                        __global\n                                        unsigned char *group_res_arr_mem_29949,\n                                        int64_t num_threads_29951)\n{\n    #define segred_group_sizze_28784 (testzisegred_group_sizze_28742)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29959_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_29959_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_29957_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29957_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29952;\n    int32_t local_tid_29953;\n    int64_t group_sizze_29956;\n    int32_t wave_sizze_29955;\n    int32_t group_tid_29954;\n    \n    global_tid_29952 = get_global_id(0);\n    local_tid_29953 = get_local_id(0);\n    group_sizze_29956 = get_local_size(0);\n    wave_sizze_29",
                   "955 = LOCKSTEP_WIDTH;\n    group_tid_29954 = get_group_id(0);\n    \n    int32_t phys_tid_28750;\n    \n    phys_tid_28750 = global_tid_29952;\n    \n    __local char *sync_arr_mem_29957;\n    \n    sync_arr_mem_29957 = (__local char *) sync_arr_mem_29957_backing_0;\n    \n    __local char *red_arr_mem_29959;\n    \n    red_arr_mem_29959 = (__local char *) red_arr_mem_29959_backing_1;\n    \n    int64_t dummy_28748;\n    \n    dummy_28748 = 0;\n    \n    int64_t gtid_28749;\n    \n    gtid_28749 = 0;\n    \n    float x_acc_29961;\n    int64_t chunk_sizze_29962;\n    \n    chunk_sizze_29962 = smin64(sdiv_up64(paths_26135,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_28784 *\n                                         num_groups_28785))),\n                               sdiv_up64(paths_26135 -\n                                         sext_i32_i64(phys_tid_28750),\n                                         num_threads_29951));\n    \n    float x_28788;\n    float x_28789;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29961 = 0.0F;\n    }\n    for (int64_t i_29966 = 0; i_29966 < chunk_sizze_29962; i_29966++) {\n        gtid_28749 = sext_i32_i64(phys_tid_28750) + num_threads_29951 * i_29966;\n        // apply map function\n        {\n            float x_28791 = ((__global\n                              float *) res_map_acc_mem_29017)[gtid_28749];\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_28788 = x_acc_29961;\n            }\n            // load new values\n            {\n                x_28789 = x_28791;\n            }\n            // apply reduction operator\n            {\n                float res_28790 = x_28788 + x_28789;\n                \n                // store in accumulator\n                {\n                    x_acc_29961 = res_28790;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_2",
                   "8788 = x_acc_29961;\n        ((__local float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953)] =\n            x_28788;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29967;\n    int32_t skip_waves_29968;\n    \n    skip_waves_29968 = 1;\n    \n    float x_29963;\n    float x_29964;\n    \n    offset_29967 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29953, sext_i64_i32(segred_group_sizze_28784))) {\n            x_29963 = ((__local\n                        float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953 +\n                                                    offset_29967)];\n        }\n    }\n    offset_29967 = 1;\n    while (slt32(offset_29967, wave_sizze_29955)) {\n        if (slt32(local_tid_29953 + offset_29967,\n                  sext_i64_i32(segred_group_sizze_28784)) && ((local_tid_29953 -\n                                                               squot32(local_tid_29953,\n                                                                       wave_sizze_29955) *\n                                                               wave_sizze_29955) &\n                                                              (2 *\n                                                               offset_29967 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                x_29964 = ((volatile __local\n                            float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953 +\n                                                        offset_29967)];\n            }\n            // apply reduction operation\n            {\n                float res_29965 = x_29963 + x_29964;\n                \n                x_29963 = res_29965;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953)] =\n                    x_29963;\n            }\n",
                   "        }\n        offset_29967 *= 2;\n    }\n    while (slt32(skip_waves_29968,\n                 squot32(sext_i64_i32(segred_group_sizze_28784) +\n                         wave_sizze_29955 - 1, wave_sizze_29955))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29967 = skip_waves_29968 * wave_sizze_29955;\n        if (slt32(local_tid_29953 + offset_29967,\n                  sext_i64_i32(segred_group_sizze_28784)) && ((local_tid_29953 -\n                                                               squot32(local_tid_29953,\n                                                                       wave_sizze_29955) *\n                                                               wave_sizze_29955) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29953,\n                                                                       wave_sizze_29955) &\n                                                               (2 *\n                                                                skip_waves_29968 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                x_29964 = ((__local\n                            float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953 +\n                                                        offset_29967)];\n            }\n            // apply reduction operation\n            {\n                float res_29965 = x_29963 + x_29964;\n                \n                x_29963 = res_29965;\n            }\n            // write result of operation\n            {\n                ((__local\n                  float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953)] =\n                    x_29963;\n            }\n        }\n        skip_waves_29968 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29953) == 0",
                   ") {\n            x_acc_29961 = x_29963;\n        }\n    }\n    \n    int32_t old_counter_29969;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29953 == 0) {\n            ((__global\n              float *) group_res_arr_mem_29949)[sext_i32_i64(group_tid_29954) *\n                                                segred_group_sizze_28784] =\n                x_acc_29961;\n            mem_fence_global();\n            old_counter_29969 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29947)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29957)[0] = old_counter_29969 ==\n                num_groups_28785 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29970;\n    \n    is_last_group_29970 = ((__local bool *) sync_arr_mem_29957)[0];\n    if (is_last_group_29970) {\n        if (local_tid_29953 == 0) {\n            old_counter_29969 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29947)[0],\n                                                      (int) (0 -\n                                                             num_groups_28785));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29971 = sdiv_up64(num_groups_28785,\n                                                      segred_group_sizze_28784);\n            \n            x_28788 = 0.0F;\n            for (int64_t i_29972 = 0; i_29972 < read_per_thread_29971;\n                 i_29972++) {\n                int64_t group_res_id_29973 = sext_i32_i64(local_tid_29953) *\n                        read_per_thread_29971 + i_29972;\n                int64_t index_of_group_res_29974 = group_res_id_29973;\n                \n                if (slt64(group_res_id_29973, num_groups_28785)) {\n    ",
                   "                x_28789 = ((__global\n                                float *) group_res_arr_mem_29949)[index_of_group_res_29974 *\n                                                                  segred_group_sizze_28784];\n                    \n                    float res_28790;\n                    \n                    res_28790 = x_28788 + x_28789;\n                    x_28788 = res_28790;\n                }\n            }\n        }\n        ((__local float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953)] =\n            x_28788;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29975;\n            int32_t skip_waves_29976;\n            \n            skip_waves_29976 = 1;\n            \n            float x_29963;\n            float x_29964;\n            \n            offset_29975 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29953,\n                          sext_i64_i32(segred_group_sizze_28784))) {\n                    x_29963 = ((__local\n                                float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953 +\n                                                            offset_29975)];\n                }\n            }\n            offset_29975 = 1;\n            while (slt32(offset_29975, wave_sizze_29955)) {\n                if (slt32(local_tid_29953 + offset_29975,\n                          sext_i64_i32(segred_group_sizze_28784)) &&\n                    ((local_tid_29953 - squot32(local_tid_29953,\n                                                wave_sizze_29955) *\n                      wave_sizze_29955) & (2 * offset_29975 - 1)) == 0) {\n                    // read array element\n                    {\n                        x_29964 = ((volatile __local\n                                    float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953 +\n                                                                offset_29975)];\n    ",
                   "                }\n                    // apply reduction operation\n                    {\n                        float res_29965 = x_29963 + x_29964;\n                        \n                        x_29963 = res_29965;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953)] =\n                            x_29963;\n                    }\n                }\n                offset_29975 *= 2;\n            }\n            while (slt32(skip_waves_29976,\n                         squot32(sext_i64_i32(segred_group_sizze_28784) +\n                                 wave_sizze_29955 - 1, wave_sizze_29955))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29975 = skip_waves_29976 * wave_sizze_29955;\n                if (slt32(local_tid_29953 + offset_29975,\n                          sext_i64_i32(segred_group_sizze_28784)) &&\n                    ((local_tid_29953 - squot32(local_tid_29953,\n                                                wave_sizze_29955) *\n                      wave_sizze_29955) == 0 && (squot32(local_tid_29953,\n                                                         wave_sizze_29955) &\n                                                 (2 * skip_waves_29976 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        x_29964 = ((__local\n                                    float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953 +\n                                                                offset_29975)];\n                    }\n                    // apply reduction operation\n                    {\n                        float res_29965 = x_29963 + x_29964;\n                        \n                        x_29963 = res_29965;\n                    }\n                    // write result of operation\n                    {\n     ",
                   "                   ((__local\n                          float *) red_arr_mem_29959)[sext_i32_i64(local_tid_29953)] =\n                            x_29963;\n                    }\n                }\n                skip_waves_29976 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29953 == 0) {\n                    ((__global float *) mem_29020)[0] = x_29963;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_28784\n}\n__kernel void testzisegred_nonseg_29138(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29250_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29248_backing_aligned_1,\n                                        __global unsigned char *mem_28881,\n                                        __global unsigned char *mem_29150,\n                                        __global\n                                        unsigned char *testzicounter_mem_29238,\n                                        __global\n                                        unsigned char *group_res_arr_mem_29240,\n                                        int64_t num_threads_29242)\n{\n    #define segred_num_groups_29132 (testzisegred_num_groups_29131)\n    #define segred_group_sizze_29134 (testzisegred_group_sizze_29133)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29250_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_29250_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_29248_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29248_backing_aligned_1;\n    \n    if (*global_failure",
                   " >= 0)\n        return;\n    \n    int32_t global_tid_29243;\n    int32_t local_tid_29244;\n    int64_t group_sizze_29247;\n    int32_t wave_sizze_29246;\n    int32_t group_tid_29245;\n    \n    global_tid_29243 = get_global_id(0);\n    local_tid_29244 = get_local_id(0);\n    group_sizze_29247 = get_local_size(0);\n    wave_sizze_29246 = LOCKSTEP_WIDTH;\n    group_tid_29245 = get_group_id(0);\n    \n    int32_t phys_tid_29138;\n    \n    phys_tid_29138 = global_tid_29243;\n    \n    __local char *sync_arr_mem_29248;\n    \n    sync_arr_mem_29248 = (__local char *) sync_arr_mem_29248_backing_0;\n    \n    __local char *red_arr_mem_29250;\n    \n    red_arr_mem_29250 = (__local char *) red_arr_mem_29250_backing_1;\n    \n    int64_t dummy_29136;\n    \n    dummy_29136 = 0;\n    \n    int64_t gtid_29137;\n    \n    gtid_29137 = 0;\n    \n    int64_t x_acc_29252;\n    int64_t chunk_sizze_29253;\n    \n    chunk_sizze_29253 = smin64(sdiv_up64(9,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_29134 *\n                                         segred_num_groups_29132))),\n                               sdiv_up64(9 - sext_i32_i64(phys_tid_29138),\n                                         num_threads_29242));\n    \n    int64_t x_29139;\n    int64_t y_29140;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29252 = 0;\n    }\n    for (int64_t i_29257 = 0; i_29257 < chunk_sizze_29253; i_29257++) {\n        gtid_29137 = sext_i32_i64(phys_tid_29138) + num_threads_29242 * i_29257;\n        // apply map function\n        {\n            int64_t res_29143 = ((__global int64_t *) mem_28881)[gtid_29137];\n            int64_t bytes_29144 = 4 * res_29143;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_29139 = x_acc_29252;\n            }\n            // load new values\n            {\n                y_29140 = bytes_29144;\n            }\n            // apply reduction operator\n            {\n               ",
                   " int64_t zz_29141 = smax64(x_29139, y_29140);\n                \n                // store in accumulator\n                {\n                    x_acc_29252 = zz_29141;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_29139 = x_acc_29252;\n        ((__local int64_t *) red_arr_mem_29250)[sext_i32_i64(local_tid_29244)] =\n            x_29139;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29258;\n    int32_t skip_waves_29259;\n    \n    skip_waves_29259 = 1;\n    \n    int64_t x_29254;\n    int64_t y_29255;\n    \n    offset_29258 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29244, sext_i64_i32(segred_group_sizze_29134))) {\n            x_29254 = ((__local\n                        int64_t *) red_arr_mem_29250)[sext_i32_i64(local_tid_29244 +\n                                                      offset_29258)];\n        }\n    }\n    offset_29258 = 1;\n    while (slt32(offset_29258, wave_sizze_29246)) {\n        if (slt32(local_tid_29244 + offset_29258,\n                  sext_i64_i32(segred_group_sizze_29134)) && ((local_tid_29244 -\n                                                               squot32(local_tid_29244,\n                                                                       wave_sizze_29246) *\n                                                               wave_sizze_29246) &\n                                                              (2 *\n                                                               offset_29258 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_29255 = ((volatile __local\n                            int64_t *) red_arr_mem_29250)[sext_i32_i64(local_tid_29244 +\n                                                          offset_29258)];\n            }\n            // apply reduction operation\n            {\n                int64_t ",
                   "zz_29256 = smax64(x_29254, y_29255);\n                \n                x_29254 = zz_29256;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_29250)[sext_i32_i64(local_tid_29244)] =\n                    x_29254;\n            }\n        }\n        offset_29258 *= 2;\n    }\n    while (slt32(skip_waves_29259,\n                 squot32(sext_i64_i32(segred_group_sizze_29134) +\n                         wave_sizze_29246 - 1, wave_sizze_29246))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29258 = skip_waves_29259 * wave_sizze_29246;\n        if (slt32(local_tid_29244 + offset_29258,\n                  sext_i64_i32(segred_group_sizze_29134)) && ((local_tid_29244 -\n                                                               squot32(local_tid_29244,\n                                                                       wave_sizze_29246) *\n                                                               wave_sizze_29246) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29244,\n                                                                       wave_sizze_29246) &\n                                                               (2 *\n                                                                skip_waves_29259 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                y_29255 = ((__local\n                            int64_t *) red_arr_mem_29250)[sext_i32_i64(local_tid_29244 +\n                                                          offset_29258)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_29256 = smax64(x_29254, y_29255);\n                \n                x_29254 = zz_29256;\n            }\n            // write result of operation\n            {\n    ",
                   "            ((__local\n                  int64_t *) red_arr_mem_29250)[sext_i32_i64(local_tid_29244)] =\n                    x_29254;\n            }\n        }\n        skip_waves_29259 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29244) == 0) {\n            x_acc_29252 = x_29254;\n        }\n    }\n    \n    int32_t old_counter_29260;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29244 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_29240)[sext_i32_i64(group_tid_29245) *\n                                                  segred_group_sizze_29134] =\n                x_acc_29252;\n            mem_fence_global();\n            old_counter_29260 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29238)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29248)[0] = old_counter_29260 ==\n                segred_num_groups_29132 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29261;\n    \n    is_last_group_29261 = ((__local bool *) sync_arr_mem_29248)[0];\n    if (is_last_group_29261) {\n        if (local_tid_29244 == 0) {\n            old_counter_29260 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29238)[0],\n                                                      (int) (0 -\n                                                             segred_num_groups_29132));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29262 = sdiv_up64(segred_num_groups_29132,\n                                                      segred_group_sizze_29134);\n            \n            x_29139 = 0;\n            for (int64_t i_29263 = 0; i_2",
                   "9263 < read_per_thread_29262;\n                 i_29263++) {\n                int64_t group_res_id_29264 = sext_i32_i64(local_tid_29244) *\n                        read_per_thread_29262 + i_29263;\n                int64_t index_of_group_res_29265 = group_res_id_29264;\n                \n                if (slt64(group_res_id_29264, segred_num_groups_29132)) {\n                    y_29140 = ((__global\n                                int64_t *) group_res_arr_mem_29240)[index_of_group_res_29265 *\n                                                                    segred_group_sizze_29134];\n                    \n                    int64_t zz_29141;\n                    \n                    zz_29141 = smax64(x_29139, y_29140);\n                    x_29139 = zz_29141;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_29250)[sext_i32_i64(local_tid_29244)] =\n            x_29139;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29266;\n            int32_t skip_waves_29267;\n            \n            skip_waves_29267 = 1;\n            \n            int64_t x_29254;\n            int64_t y_29255;\n            \n            offset_29266 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29244,\n                          sext_i64_i32(segred_group_sizze_29134))) {\n                    x_29254 = ((__local\n                                int64_t *) red_arr_mem_29250)[sext_i32_i64(local_tid_29244 +\n                                                              offset_29266)];\n                }\n            }\n            offset_29266 = 1;\n            while (slt32(offset_29266, wave_sizze_29246)) {\n                if (slt32(local_tid_29244 + offset_29266,\n                          sext_i64_i32(segred_group_sizze_29134)) &&\n                    ((local_tid_29244 - squot32(local_tid_29244,\n                                                wave_sizze",
                   "_29246) *\n                      wave_sizze_29246) & (2 * offset_29266 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_29255 = ((volatile __local\n                                    int64_t *) red_arr_mem_29250)[sext_i32_i64(local_tid_29244 +\n                                                                  offset_29266)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_29256 = smax64(x_29254, y_29255);\n                        \n                        x_29254 = zz_29256;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29250)[sext_i32_i64(local_tid_29244)] =\n                            x_29254;\n                    }\n                }\n                offset_29266 *= 2;\n            }\n            while (slt32(skip_waves_29267,\n                         squot32(sext_i64_i32(segred_group_sizze_29134) +\n                                 wave_sizze_29246 - 1, wave_sizze_29246))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29266 = skip_waves_29267 * wave_sizze_29246;\n                if (slt32(local_tid_29244 + offset_29266,\n                          sext_i64_i32(segred_group_sizze_29134)) &&\n                    ((local_tid_29244 - squot32(local_tid_29244,\n                                                wave_sizze_29246) *\n                      wave_sizze_29246) == 0 && (squot32(local_tid_29244,\n                                                         wave_sizze_29246) &\n                                                 (2 * skip_waves_29267 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        y_29255 = ((__local\n                                    int64_t *) red_arr_mem_29250)[sext_i32_i64(local_tid_29244 +\n       ",
                   "                                                           offset_29266)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_29256 = smax64(x_29254, y_29255);\n                        \n                        x_29254 = zz_29256;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_29250)[sext_i32_i64(local_tid_29244)] =\n                            x_29254;\n                    }\n                }\n                skip_waves_29267 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29244 == 0) {\n                    ((__global int64_t *) mem_29150)[0] = x_29254;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_29132\n    #undef segred_group_sizze_29134\n}\n__kernel void testzisegred_nonseg_29170(__global int *global_failure,\n                                        __local volatile\n                                        int64_t *red_arr_mem_29287_backing_aligned_0,\n                                        __local volatile\n                                        int64_t *sync_arr_mem_29285_backing_aligned_1,\n                                        __global unsigned char *mem_28881,\n                                        __global unsigned char *mem_29182,\n                                        __global\n                                        unsigned char *testzicounter_mem_29275,\n                                        __global\n                                        unsigned char *group_res_arr_mem_29277,\n                                        int64_t num_threads_29279)\n{\n    #define segred_num_groups_29164 (testzisegred_num_groups_29163)\n    #define segred_group_sizze_29166 (testzisegred_group_sizze_29165)\n    \n    const int block_dim0 = 0;\n    const i",
                   "nt block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29287_backing_1 =\n                          (__local volatile\n                           char *) red_arr_mem_29287_backing_aligned_0;\n    __local volatile char *restrict sync_arr_mem_29285_backing_0 =\n                          (__local volatile\n                           char *) sync_arr_mem_29285_backing_aligned_1;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29280;\n    int32_t local_tid_29281;\n    int64_t group_sizze_29284;\n    int32_t wave_sizze_29283;\n    int32_t group_tid_29282;\n    \n    global_tid_29280 = get_global_id(0);\n    local_tid_29281 = get_local_id(0);\n    group_sizze_29284 = get_local_size(0);\n    wave_sizze_29283 = LOCKSTEP_WIDTH;\n    group_tid_29282 = get_group_id(0);\n    \n    int32_t phys_tid_29170;\n    \n    phys_tid_29170 = global_tid_29280;\n    \n    __local char *sync_arr_mem_29285;\n    \n    sync_arr_mem_29285 = (__local char *) sync_arr_mem_29285_backing_0;\n    \n    __local char *red_arr_mem_29287;\n    \n    red_arr_mem_29287 = (__local char *) red_arr_mem_29287_backing_1;\n    \n    int64_t dummy_29168;\n    \n    dummy_29168 = 0;\n    \n    int64_t gtid_29169;\n    \n    gtid_29169 = 0;\n    \n    int64_t x_acc_29289;\n    int64_t chunk_sizze_29290;\n    \n    chunk_sizze_29290 = smin64(sdiv_up64(9,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_29166 *\n                                         segred_num_groups_29164))),\n                               sdiv_up64(9 - sext_i32_i64(phys_tid_29170),\n                                         num_threads_29279));\n    \n    int64_t x_29171;\n    int64_t y_29172;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29289 = 0;\n    }\n    for (int64_t i_29294 = 0; i_29294 < chunk_sizze_29290; i_29294++) {\n        gtid_29169 = sext_i32_i64(phys_tid_29170) + num_threads_29279 * i_29294;\n        // apply map function\n        {\n            int",
                   "64_t res_29175 = ((__global int64_t *) mem_28881)[gtid_29169];\n            int64_t bytes_29176 = 4 * res_29175;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_29171 = x_acc_29289;\n            }\n            // load new values\n            {\n                y_29172 = bytes_29176;\n            }\n            // apply reduction operator\n            {\n                int64_t zz_29173 = smax64(x_29171, y_29172);\n                \n                // store in accumulator\n                {\n                    x_acc_29289 = zz_29173;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_29171 = x_acc_29289;\n        ((__local int64_t *) red_arr_mem_29287)[sext_i32_i64(local_tid_29281)] =\n            x_29171;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29295;\n    int32_t skip_waves_29296;\n    \n    skip_waves_29296 = 1;\n    \n    int64_t x_29291;\n    int64_t y_29292;\n    \n    offset_29295 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29281, sext_i64_i32(segred_group_sizze_29166))) {\n            x_29291 = ((__local\n                        int64_t *) red_arr_mem_29287)[sext_i32_i64(local_tid_29281 +\n                                                      offset_29295)];\n        }\n    }\n    offset_29295 = 1;\n    while (slt32(offset_29295, wave_sizze_29283)) {\n        if (slt32(local_tid_29281 + offset_29295,\n                  sext_i64_i32(segred_group_sizze_29166)) && ((local_tid_29281 -\n                                                               squot32(local_tid_29281,\n                                                                       wave_sizze_29283) *\n                                                               wave_sizze_29283) &\n                                                              (2 *\n                                                           ",
                   "    offset_29295 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_29292 = ((volatile __local\n                            int64_t *) red_arr_mem_29287)[sext_i32_i64(local_tid_29281 +\n                                                          offset_29295)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_29293 = smax64(x_29291, y_29292);\n                \n                x_29291 = zz_29293;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_29287)[sext_i32_i64(local_tid_29281)] =\n                    x_29291;\n            }\n        }\n        offset_29295 *= 2;\n    }\n    while (slt32(skip_waves_29296,\n                 squot32(sext_i64_i32(segred_group_sizze_29166) +\n                         wave_sizze_29283 - 1, wave_sizze_29283))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29295 = skip_waves_29296 * wave_sizze_29283;\n        if (slt32(local_tid_29281 + offset_29295,\n                  sext_i64_i32(segred_group_sizze_29166)) && ((local_tid_29281 -\n                                                               squot32(local_tid_29281,\n                                                                       wave_sizze_29283) *\n                                                               wave_sizze_29283) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29281,\n                                                                       wave_sizze_29283) &\n                                                               (2 *\n                                                                skip_waves_29296 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n            ",
                   "    y_29292 = ((__local\n                            int64_t *) red_arr_mem_29287)[sext_i32_i64(local_tid_29281 +\n                                                          offset_29295)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_29293 = smax64(x_29291, y_29292);\n                \n                x_29291 = zz_29293;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_29287)[sext_i32_i64(local_tid_29281)] =\n                    x_29291;\n            }\n        }\n        skip_waves_29296 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29281) == 0) {\n            x_acc_29289 = x_29291;\n        }\n    }\n    \n    int32_t old_counter_29297;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29281 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_29277)[sext_i32_i64(group_tid_29282) *\n                                                  segred_group_sizze_29166] =\n                x_acc_29289;\n            mem_fence_global();\n            old_counter_29297 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29275)[0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29285)[0] = old_counter_29297 ==\n                segred_num_groups_29164 - 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29298;\n    \n    is_last_group_29298 = ((__local bool *) sync_arr_mem_29285)[0];\n    if (is_last_group_29298) {\n        if (local_tid_29281 == 0) {\n            old_counter_29297 = atomic_add_i32_global(&((volatile __global\n                                                         int *) testzicounter_mem_29275)[0],\n          ",
                   "                                            (int) (0 -\n                                                             segred_num_groups_29164));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29299 = sdiv_up64(segred_num_groups_29164,\n                                                      segred_group_sizze_29166);\n            \n            x_29171 = 0;\n            for (int64_t i_29300 = 0; i_29300 < read_per_thread_29299;\n                 i_29300++) {\n                int64_t group_res_id_29301 = sext_i32_i64(local_tid_29281) *\n                        read_per_thread_29299 + i_29300;\n                int64_t index_of_group_res_29302 = group_res_id_29301;\n                \n                if (slt64(group_res_id_29301, segred_num_groups_29164)) {\n                    y_29172 = ((__global\n                                int64_t *) group_res_arr_mem_29277)[index_of_group_res_29302 *\n                                                                    segred_group_sizze_29166];\n                    \n                    int64_t zz_29173;\n                    \n                    zz_29173 = smax64(x_29171, y_29172);\n                    x_29171 = zz_29173;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_29287)[sext_i32_i64(local_tid_29281)] =\n            x_29171;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29303;\n            int32_t skip_waves_29304;\n            \n            skip_waves_29304 = 1;\n            \n            int64_t x_29291;\n            int64_t y_29292;\n            \n            offset_29303 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29281,\n                          sext_i64_i32(segred_group_sizze_29166))) {\n                    x_29291 = ((__local\n                                int64_t *) red_arr_mem_29287)[sext_i32_i64(local_tid_29281 +\n       ",
                   "                                                       offset_29303)];\n                }\n            }\n            offset_29303 = 1;\n            while (slt32(offset_29303, wave_sizze_29283)) {\n                if (slt32(local_tid_29281 + offset_29303,\n                          sext_i64_i32(segred_group_sizze_29166)) &&\n                    ((local_tid_29281 - squot32(local_tid_29281,\n                                                wave_sizze_29283) *\n                      wave_sizze_29283) & (2 * offset_29303 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_29292 = ((volatile __local\n                                    int64_t *) red_arr_mem_29287)[sext_i32_i64(local_tid_29281 +\n                                                                  offset_29303)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_29293 = smax64(x_29291, y_29292);\n                        \n                        x_29291 = zz_29293;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29287)[sext_i32_i64(local_tid_29281)] =\n                            x_29291;\n                    }\n                }\n                offset_29303 *= 2;\n            }\n            while (slt32(skip_waves_29304,\n                         squot32(sext_i64_i32(segred_group_sizze_29166) +\n                                 wave_sizze_29283 - 1, wave_sizze_29283))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29303 = skip_waves_29304 * wave_sizze_29283;\n                if (slt32(local_tid_29281 + offset_29303,\n                          sext_i64_i32(segred_group_sizze_29166)) &&\n                    ((local_tid_29281 - squot32(local_tid_29281,\n                                                wave_sizze_29283) *\n                      wave_",
                   "sizze_29283) == 0 && (squot32(local_tid_29281,\n                                                         wave_sizze_29283) &\n                                                 (2 * skip_waves_29304 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        y_29292 = ((__local\n                                    int64_t *) red_arr_mem_29287)[sext_i32_i64(local_tid_29281 +\n                                                                  offset_29303)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_29293 = smax64(x_29291, y_29292);\n                        \n                        x_29291 = zz_29293;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_29287)[sext_i32_i64(local_tid_29281)] =\n                            x_29291;\n                    }\n                }\n                skip_waves_29304 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29281 == 0) {\n                    ((__global int64_t *) mem_29182)[0] = x_29291;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_29164\n    #undef segred_group_sizze_29166\n}\n__kernel void testzisegred_small_28717(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *red_arr_mem_29888_backing_aligned_0,\n                                       int64_t paths_26135,\n                                       int64_t num_groups_28768, __global\n                                       unsigned char *mem_28997, __global\n                                       unsigned char *mem_29013,\n                                       int64_t segment_sizze_nonzzero_29881)\n{\n    #define s",
                   "egred_group_sizze_28767 (testzisegred_group_sizze_28711)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    __local volatile char *restrict red_arr_mem_29888_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_29888_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29883;\n    int32_t local_tid_29884;\n    int64_t group_sizze_29887;\n    int32_t wave_sizze_29886;\n    int32_t group_tid_29885;\n    \n    global_tid_29883 = get_global_id(0);\n    local_tid_29884 = get_local_id(0);\n    group_sizze_29887 = get_local_size(0);\n    wave_sizze_29886 = LOCKSTEP_WIDTH;\n    group_tid_29885 = get_group_id(0);\n    \n    int32_t phys_tid_28717;\n    \n    phys_tid_28717 = global_tid_29883;\n    \n    __local char *red_arr_mem_29888;\n    \n    red_arr_mem_29888 = (__local char *) red_arr_mem_29888_backing_0;\n    \n    int32_t phys_group_id_29890;\n    \n    phys_group_id_29890 = get_group_id(0);\n    for (int32_t i_29891 = 0; i_29891 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(paths_26135,\n                                          squot64(segred_group_sizze_28767,\n                                                  segment_sizze_nonzzero_29881))) -\n                   phys_group_id_29890, sext_i64_i32(num_groups_28768));\n         i_29891++) {\n        int32_t virt_group_id_29892 = phys_group_id_29890 + i_29891 *\n                sext_i64_i32(num_groups_28768);\n        int64_t gtid_28708 = squot64(sext_i32_i64(local_tid_29884),\n                                     segment_sizze_nonzzero_29881) +\n                sext_i32_i64(virt_group_id_29892) *\n                squot64(segred_group_sizze_28767, segment_sizze_nonzzero_29881);\n        int64_t gtid_28716 = srem64(sext_i32_i64(local_tid_29884), 9);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, 9) && (slt64(gtid_28708, paths_26135) &&\n                                slt64(",
                   "sext_i32_i64(local_tid_29884), 9 *\n                                      squot64(segred_group_sizze_28767,\n                                              segment_sizze_nonzzero_29881)))) {\n                int64_t binop_x_28829 = 9 * gtid_28708;\n                int64_t new_index_28830 = gtid_28716 + binop_x_28829;\n                float x_28775 = ((__global float *) mem_28997)[new_index_28830];\n                \n                // save map-out results\n                { }\n                // save results to be reduced\n                {\n                    ((__local\n                      float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)] =\n                        x_28775;\n                }\n            } else {\n                ((__local\n                  float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)] =\n                    0.0F;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, 9)) {\n            // perform segmented scan to imitate reduction\n            {\n                float x_28771;\n                float x_28772;\n                float x_29893;\n                float x_29894;\n                bool ltid_in_bounds_29896;\n                \n                ltid_in_bounds_29896 = slt64(sext_i32_i64(local_tid_29884), 9 *\n                                             squot64(segred_group_sizze_28767,\n                                                     segment_sizze_nonzzero_29881));\n                \n                int32_t skip_threads_29897;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_29896) {\n                        x_28772 = ((volatile __local\n                                    float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)];\n                        if ((local_tid_29884 - squot32(local_tid_29884, 32) *\n                             32) == 0) {\n                            x_28771 = x_28772;\n                        }\n                    }\n   ",
                   "             }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29897 = 1;\n                    while (slt32(skip_threads_29897, 32)) {\n                        if (sle32(skip_threads_29897, local_tid_29884 -\n                                  squot32(local_tid_29884, 32) * 32) &&\n                            ltid_in_bounds_29896) {\n                            // read operands\n                            {\n                                x_28771 = ((volatile __local\n                                            float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884) -\n                                                                        sext_i32_i64(skip_threads_29897)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_29898 =\n                                     slt64(srem64(sext_i32_i64(local_tid_29884),\n                                                  9),\n                                           sext_i32_i64(local_tid_29884) -\n                                           sext_i32_i64(local_tid_29884 -\n                                           skip_threads_29897));\n                                \n                                if (inactive_29898) {\n                                    x_28771 = x_28772;\n                                }\n                                if (!inactive_29898) {\n                                    float res_28773 = x_28771 + x_28772;\n                                    \n                                    x_28771 = res_28773;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_29886, skip_threads_29897)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29897, local_tid_29884 -\n                         ",
                   "         squot32(local_tid_29884, 32) * 32) &&\n                            ltid_in_bounds_29896) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)] =\n                                    x_28771;\n                                x_28772 = x_28771;\n                            }\n                        }\n                        if (sle32(wave_sizze_29886, skip_threads_29897)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29897 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_29884 - squot32(local_tid_29884, 32) * 32) ==\n                        31 && ltid_in_bounds_29896) {\n                        ((volatile __local\n                          float *) red_arr_mem_29888)[sext_i32_i64(squot32(local_tid_29884,\n                                                                           32))] =\n                            x_28771;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_29899;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_29884, 32) == 0 &&\n                            ltid_in_bounds_29896) {\n                            x_29894 = ((volatile __local\n                                        float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)];\n                            if ((local_tid_29884 - squot32(local_tid_29884,\n                                                        ",
                   "   32) * 32) == 0) {\n                                x_29893 = x_29894;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_29899 = 1;\n                        while (slt32(skip_threads_29899, 32)) {\n                            if (sle32(skip_threads_29899, local_tid_29884 -\n                                      squot32(local_tid_29884, 32) * 32) &&\n                                (squot32(local_tid_29884, 32) == 0 &&\n                                 ltid_in_bounds_29896)) {\n                                // read operands\n                                {\n                                    x_29893 = ((volatile __local\n                                                float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884) -\n                                                                            sext_i32_i64(skip_threads_29899)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_29900 =\n                                         slt64(srem64(sext_i32_i64(local_tid_29884 *\n                                                      32 + 32 - 1), 9),\n                                               sext_i32_i64(local_tid_29884 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_29884 -\n                                                             skip_threads_29899) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_29900) {\n                                        x_29893 = x_29894;\n                                    }\n                                    if (!inactive_29900) {\n                                        float res_",
                   "29895 = x_29893 + x_29894;\n                                        \n                                        x_29893 = res_29895;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_29886, skip_threads_29899)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_29899, local_tid_29884 -\n                                      squot32(local_tid_29884, 32) * 32) &&\n                                (squot32(local_tid_29884, 32) == 0 &&\n                                 ltid_in_bounds_29896)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)] =\n                                        x_29893;\n                                    x_29894 = x_29893;\n                                }\n                            }\n                            if (sle32(wave_sizze_29886, skip_threads_29899)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_29899 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    if (!(squot32(local_tid_29884, 32) == 0 ||\n                          !ltid_in_bounds_29896)) {\n                        // read operands\n                        {\n                            x_28772 = x_28771;\n                            x_28771 = ((__local\n                                        float *) red_arr_mem_29888)[sext_i32_i64(squot32(local_tid_29884,\n                                                                                         32)) -\n                    ",
                   "                                                1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_29901 =\n                                 slt64(srem64(sext_i32_i64(local_tid_29884), 9),\n                                       sext_i32_i64(local_tid_29884) -\n                                       sext_i32_i64(squot32(local_tid_29884,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_29901) {\n                                x_28771 = x_28772;\n                            }\n                            if (!inactive_29901) {\n                                float res_28773 = x_28771 + x_28772;\n                                \n                                x_28771 = res_28773;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)] =\n                                x_28771;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_29884, 32) == 0) {\n                        ((__local\n                          float *) red_arr_mem_29888)[sext_i32_i64(local_tid_29884)] =\n                            x_28772;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_29892) *\n                      squot64(segred_group_sizze_28767,\n                              segment_sizze_nonzzero_29881) +\n                      sext_i32_i64(local_tid_29884",
                   "), paths_26135) &&\n                slt64(sext_i32_i64(local_tid_29884),\n                      squot64(segred_group_sizze_28767,\n                              segment_sizze_nonzzero_29881))) {\n                ((__global\n                  float *) mem_29013)[sext_i32_i64(virt_group_id_29892) *\n                                      squot64(segred_group_sizze_28767,\n                                              segment_sizze_nonzzero_29881) +\n                                      sext_i32_i64(local_tid_29884)] = ((__local\n                                                                         float *) red_arr_mem_29888)[(sext_i32_i64(local_tid_29884) +\n                                                                                                      1) *\n                                                                                                     segment_sizze_nonzzero_29881 -\n                                                                                                     1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segred_group_sizze_28767\n}\n__kernel void testzisegred_small_29517(__global int *global_failure,\n                                       __local volatile\n                                       int64_t *red_arr_mem_29525_backing_aligned_0,\n                                       int64_t res_26335,\n                                       int64_t num_groups_28550, __global\n                                       unsigned char *mem_28974,\n                                       int32_t num_subhistos_29431, __global\n                                       unsigned char *res_subhistos_mem_29432,\n                                       int64_t segment_sizze_nonzzero_29518)\n{\n    #define seghist_group_sizze_28548 (testziseghist_group_sizze_28547)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2",
                   " = 2;\n    __local volatile char *restrict red_arr_mem_29525_backing_0 =\n                          (__local volatile\n                           char *) red_arr_mem_29525_backing_aligned_0;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29520;\n    int32_t local_tid_29521;\n    int64_t group_sizze_29524;\n    int32_t wave_sizze_29523;\n    int32_t group_tid_29522;\n    \n    global_tid_29520 = get_global_id(0);\n    local_tid_29521 = get_local_id(0);\n    group_sizze_29524 = get_local_size(0);\n    wave_sizze_29523 = LOCKSTEP_WIDTH;\n    group_tid_29522 = get_group_id(0);\n    \n    int32_t flat_gtid_29517;\n    \n    flat_gtid_29517 = global_tid_29520;\n    \n    __local char *red_arr_mem_29525;\n    \n    red_arr_mem_29525 = (__local char *) red_arr_mem_29525_backing_0;\n    \n    int32_t phys_group_id_29527;\n    \n    phys_group_id_29527 = get_group_id(0);\n    for (int32_t i_29528 = 0; i_29528 <\n         sdiv_up32(sext_i64_i32(sdiv_up64(res_26335,\n                                          squot64(seghist_group_sizze_28548,\n                                                  segment_sizze_nonzzero_29518))) -\n                   phys_group_id_29527, sext_i64_i32(num_groups_28550));\n         i_29528++) {\n        int32_t virt_group_id_29529 = phys_group_id_29527 + i_29528 *\n                sext_i64_i32(num_groups_28550);\n        int64_t bucket_id_29515 = squot64(sext_i32_i64(local_tid_29521),\n                                          segment_sizze_nonzzero_29518) +\n                sext_i32_i64(virt_group_id_29529) *\n                squot64(seghist_group_sizze_28548,\n                        segment_sizze_nonzzero_29518);\n        int64_t subhistogram_id_29516 = srem64(sext_i32_i64(local_tid_29521),\n                                               num_subhistos_29431);\n        \n        // apply map function if in bounds\n        {\n            if (slt64(0, num_subhistos_29431) && (slt64(bucket_id_29515,\n                                                        res_26335",
                   ") &&\n                                                  slt64(sext_i32_i64(local_tid_29521),\n                                                        num_subhistos_29431 *\n                                                        squot64(seghist_group_sizze_28548,\n                                                                segment_sizze_nonzzero_29518)))) {\n                // save results to be reduced\n                {\n                    ((__local\n                      int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521)] =\n                        ((__global\n                          int64_t *) res_subhistos_mem_29432)[subhistogram_id_29516 *\n                                                              res_26335 +\n                                                              bucket_id_29515];\n                }\n            } else {\n                ((__local\n                  int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521)] =\n                    0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64(0, num_subhistos_29431)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t x_28554;\n                int64_t x_28555;\n                int64_t x_29530;\n                int64_t x_29531;\n                bool ltid_in_bounds_29533;\n                \n                ltid_in_bounds_29533 = slt64(sext_i32_i64(local_tid_29521),\n                                             num_subhistos_29431 *\n                                             squot64(seghist_group_sizze_28548,\n                                                     segment_sizze_nonzzero_29518));\n                \n                int32_t skip_threads_29534;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_29533) {\n                        x_28555 = ((volatile __local\n                                    int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_295",
                   "21)];\n                        if ((local_tid_29521 - squot32(local_tid_29521, 32) *\n                             32) == 0) {\n                            x_28554 = x_28555;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_29534 = 1;\n                    while (slt32(skip_threads_29534, 32)) {\n                        if (sle32(skip_threads_29534, local_tid_29521 -\n                                  squot32(local_tid_29521, 32) * 32) &&\n                            ltid_in_bounds_29533) {\n                            // read operands\n                            {\n                                x_28554 = ((volatile __local\n                                            int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521) -\n                                                                          sext_i32_i64(skip_threads_29534)];\n                            }\n                            // perform operation\n                            {\n                                bool inactive_29535 =\n                                     slt64(srem64(sext_i32_i64(local_tid_29521),\n                                                  num_subhistos_29431),\n                                           sext_i32_i64(local_tid_29521) -\n                                           sext_i32_i64(local_tid_29521 -\n                                           skip_threads_29534));\n                                \n                                if (inactive_29535) {\n                                    x_28554 = x_28555;\n                                }\n                                if (!inactive_29535) {\n                                    int64_t res_28556 = smax64(x_28554,\n                                                               x_28555);\n                                    \n                                    x_28554 = res_28556;\n                             ",
                   "   }\n                            }\n                        }\n                        if (sle32(wave_sizze_29523, skip_threads_29534)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (sle32(skip_threads_29534, local_tid_29521 -\n                                  squot32(local_tid_29521, 32) * 32) &&\n                            ltid_in_bounds_29533) {\n                            // write result\n                            {\n                                ((volatile __local\n                                  int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521)] =\n                                    x_28554;\n                                x_28555 = x_28554;\n                            }\n                        }\n                        if (sle32(wave_sizze_29523, skip_threads_29534)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_29534 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_29521 - squot32(local_tid_29521, 32) * 32) ==\n                        31 && ltid_in_bounds_29533) {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29525)[sext_i32_i64(squot32(local_tid_29521,\n                                                                             32))] =\n                            x_28554;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_29536;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_29521, 32) == 0 &&\n                  ",
                   "          ltid_in_bounds_29533) {\n                            x_29531 = ((volatile __local\n                                        int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521)];\n                            if ((local_tid_29521 - squot32(local_tid_29521,\n                                                           32) * 32) == 0) {\n                                x_29530 = x_29531;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_29536 = 1;\n                        while (slt32(skip_threads_29536, 32)) {\n                            if (sle32(skip_threads_29536, local_tid_29521 -\n                                      squot32(local_tid_29521, 32) * 32) &&\n                                (squot32(local_tid_29521, 32) == 0 &&\n                                 ltid_in_bounds_29533)) {\n                                // read operands\n                                {\n                                    x_29530 = ((volatile __local\n                                                int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521) -\n                                                                              sext_i32_i64(skip_threads_29536)];\n                                }\n                                // perform operation\n                                {\n                                    bool inactive_29537 =\n                                         slt64(srem64(sext_i32_i64(local_tid_29521 *\n                                                      32 + 32 - 1),\n                                                      num_subhistos_29431),\n                                               sext_i32_i64(local_tid_29521 *\n                                               32 + 32 - 1) -\n                                               sext_i32_i64((local_tid_29521 -\n                                             ",
                   "                skip_threads_29536) *\n                                               32 + 32 - 1));\n                                    \n                                    if (inactive_29537) {\n                                        x_29530 = x_29531;\n                                    }\n                                    if (!inactive_29537) {\n                                        int64_t res_29532 = smax64(x_29530,\n                                                                   x_29531);\n                                        \n                                        x_29530 = res_29532;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_29523, skip_threads_29536)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (sle32(skip_threads_29536, local_tid_29521 -\n                                      squot32(local_tid_29521, 32) * 32) &&\n                                (squot32(local_tid_29521, 32) == 0 &&\n                                 ltid_in_bounds_29533)) {\n                                // write result\n                                {\n                                    ((volatile __local\n                                      int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521)] =\n                                        x_29530;\n                                    x_29531 = x_29530;\n                                }\n                            }\n                            if (sle32(wave_sizze_29523, skip_threads_29536)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_29536 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // carry-in for every block except the first\n                {\n                    ",
                   "if (!(squot32(local_tid_29521, 32) == 0 ||\n                          !ltid_in_bounds_29533)) {\n                        // read operands\n                        {\n                            x_28555 = x_28554;\n                            x_28554 = ((__local\n                                        int64_t *) red_arr_mem_29525)[sext_i32_i64(squot32(local_tid_29521,\n                                                                                           32)) -\n                                                                      1];\n                        }\n                        // perform operation\n                        {\n                            bool inactive_29538 =\n                                 slt64(srem64(sext_i32_i64(local_tid_29521),\n                                              num_subhistos_29431),\n                                       sext_i32_i64(local_tid_29521) -\n                                       sext_i32_i64(squot32(local_tid_29521,\n                                                            32) * 32 - 1));\n                            \n                            if (inactive_29538) {\n                                x_28554 = x_28555;\n                            }\n                            if (!inactive_29538) {\n                                int64_t res_28556 = smax64(x_28554, x_28555);\n                                \n                                x_28554 = res_28556;\n                            }\n                        }\n                        // write final result\n                        {\n                            ((__local\n                              int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521)] =\n                                x_28554;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_29521, 32) == 0) {\n                       ",
                   " ((__local\n                          int64_t *) red_arr_mem_29525)[sext_i32_i64(local_tid_29521)] =\n                            x_28555;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_group_id_29529) *\n                      squot64(seghist_group_sizze_28548,\n                              segment_sizze_nonzzero_29518) +\n                      sext_i32_i64(local_tid_29521), res_26335) &&\n                slt64(sext_i32_i64(local_tid_29521),\n                      squot64(seghist_group_sizze_28548,\n                              segment_sizze_nonzzero_29518))) {\n                ((__global\n                  int64_t *) mem_28974)[sext_i32_i64(virt_group_id_29529) *\n                                        squot64(seghist_group_sizze_28548,\n                                                segment_sizze_nonzzero_29518) +\n                                        sext_i32_i64(local_tid_29521)] =\n                    ((__local\n                      int64_t *) red_arr_mem_29525)[(sext_i32_i64(local_tid_29521) +\n                                                     1) *\n                                                    segment_sizze_nonzzero_29518 -\n                                                    1];\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef seghist_group_sizze_28548\n}\n",
                   NULL};
static const char *size_names[] = {"builtin#replicate_f32.group_size_29837",
                                   "builtin#replicate_i64.group_size_29429",
                                   "main.L2_size_29494",
                                   "main.seghist_group_size_27438",
                                   "main.seghist_num_groups_27440",
                                   "main.segmap_group_size_26598",
                                   "main.segmap_group_size_26774",
                                   "main.segmap_group_size_27073",
                                   "main.segmap_group_size_27172",
                                   "main.segmap_group_size_27235",
                                   "main.segmap_group_size_27531",
                                   "main.segmap_group_size_27569",
                                   "main.segmap_group_size_27594",
                                   "main.segmap_num_groups_27075",
                                   "main.segred_group_size_26574",
                                   "main.segred_group_size_27428",
                                   "main.segred_group_size_27537",
                                   "main.segred_group_size_27602",
                                   "main.segred_group_size_27633",
                                   "main.segred_group_size_29051",
                                   "main.segred_group_size_29083",
                                   "main.segred_num_groups_26576",
                                   "main.segred_num_groups_27430",
                                   "main.segred_num_groups_27539",
                                   "main.segred_num_groups_27604",
                                   "main.segred_num_groups_27635",
                                   "main.segred_num_groups_29049",
                                   "main.segred_num_groups_29081",
                                   "main.segscan_group_size_27420",
                                   "main.segscan_group_size_27453",
                                   "main.segscan_group_size_27461",
                                   "main.segscan_group_size_27469",
                                   "main.segscan_group_size_27521",
                                   "main.segscan_num_groups_27422",
                                   "main.segscan_num_groups_27455",
                                   "main.segscan_num_groups_27463",
                                   "main.segscan_num_groups_27471",
                                   "main.segscan_num_groups_27523",
                                   "main.suff_outer_par_0",
                                   "main.suff_outer_par_8",
                                   "main.suff_outer_redomap_7",
                                   "test.L2_size_29494",
                                   "test.seghist_group_size_28547",
                                   "test.seghist_num_groups_28549",
                                   "test.segmap_group_size_27710",
                                   "test.segmap_group_size_27886",
                                   "test.segmap_group_size_28185",
                                   "test.segmap_group_size_28284",
                                   "test.segmap_group_size_28347",
                                   "test.segmap_group_size_28640",
                                   "test.segmap_group_size_28678",
                                   "test.segmap_group_size_28703",
                                   "test.segmap_num_groups_28187",
                                   "test.segred_group_size_27686",
                                   "test.segred_group_size_28537",
                                   "test.segred_group_size_28646",
                                   "test.segred_group_size_28711",
                                   "test.segred_group_size_28742",
                                   "test.segred_group_size_29133",
                                   "test.segred_group_size_29165",
                                   "test.segred_num_groups_27688",
                                   "test.segred_num_groups_28539",
                                   "test.segred_num_groups_28648",
                                   "test.segred_num_groups_28713",
                                   "test.segred_num_groups_28744",
                                   "test.segred_num_groups_29131",
                                   "test.segred_num_groups_29163",
                                   "test.segscan_group_size_28529",
                                   "test.segscan_group_size_28562",
                                   "test.segscan_group_size_28570",
                                   "test.segscan_group_size_28578",
                                   "test.segscan_group_size_28630",
                                   "test.segscan_num_groups_28531",
                                   "test.segscan_num_groups_28564",
                                   "test.segscan_num_groups_28572",
                                   "test.segscan_num_groups_28580",
                                   "test.segscan_num_groups_28632",
                                   "test.suff_outer_par_0",
                                   "test.suff_outer_par_8",
                                   "test.suff_outer_redomap_7"};
static const char *size_vars[] = {"builtinzhreplicate_f32zigroup_sizze_29837",
                                  "builtinzhreplicate_i64zigroup_sizze_29429",
                                  "mainziL2_sizze_29494",
                                  "mainziseghist_group_sizze_27438",
                                  "mainziseghist_num_groups_27440",
                                  "mainzisegmap_group_sizze_26598",
                                  "mainzisegmap_group_sizze_26774",
                                  "mainzisegmap_group_sizze_27073",
                                  "mainzisegmap_group_sizze_27172",
                                  "mainzisegmap_group_sizze_27235",
                                  "mainzisegmap_group_sizze_27531",
                                  "mainzisegmap_group_sizze_27569",
                                  "mainzisegmap_group_sizze_27594",
                                  "mainzisegmap_num_groups_27075",
                                  "mainzisegred_group_sizze_26574",
                                  "mainzisegred_group_sizze_27428",
                                  "mainzisegred_group_sizze_27537",
                                  "mainzisegred_group_sizze_27602",
                                  "mainzisegred_group_sizze_27633",
                                  "mainzisegred_group_sizze_29051",
                                  "mainzisegred_group_sizze_29083",
                                  "mainzisegred_num_groups_26576",
                                  "mainzisegred_num_groups_27430",
                                  "mainzisegred_num_groups_27539",
                                  "mainzisegred_num_groups_27604",
                                  "mainzisegred_num_groups_27635",
                                  "mainzisegred_num_groups_29049",
                                  "mainzisegred_num_groups_29081",
                                  "mainzisegscan_group_sizze_27420",
                                  "mainzisegscan_group_sizze_27453",
                                  "mainzisegscan_group_sizze_27461",
                                  "mainzisegscan_group_sizze_27469",
                                  "mainzisegscan_group_sizze_27521",
                                  "mainzisegscan_num_groups_27422",
                                  "mainzisegscan_num_groups_27455",
                                  "mainzisegscan_num_groups_27463",
                                  "mainzisegscan_num_groups_27471",
                                  "mainzisegscan_num_groups_27523",
                                  "mainzisuff_outer_par_0",
                                  "mainzisuff_outer_par_8",
                                  "mainzisuff_outer_redomap_7",
                                  "testziL2_sizze_29494",
                                  "testziseghist_group_sizze_28547",
                                  "testziseghist_num_groups_28549",
                                  "testzisegmap_group_sizze_27710",
                                  "testzisegmap_group_sizze_27886",
                                  "testzisegmap_group_sizze_28185",
                                  "testzisegmap_group_sizze_28284",
                                  "testzisegmap_group_sizze_28347",
                                  "testzisegmap_group_sizze_28640",
                                  "testzisegmap_group_sizze_28678",
                                  "testzisegmap_group_sizze_28703",
                                  "testzisegmap_num_groups_28187",
                                  "testzisegred_group_sizze_27686",
                                  "testzisegred_group_sizze_28537",
                                  "testzisegred_group_sizze_28646",
                                  "testzisegred_group_sizze_28711",
                                  "testzisegred_group_sizze_28742",
                                  "testzisegred_group_sizze_29133",
                                  "testzisegred_group_sizze_29165",
                                  "testzisegred_num_groups_27688",
                                  "testzisegred_num_groups_28539",
                                  "testzisegred_num_groups_28648",
                                  "testzisegred_num_groups_28713",
                                  "testzisegred_num_groups_28744",
                                  "testzisegred_num_groups_29131",
                                  "testzisegred_num_groups_29163",
                                  "testzisegscan_group_sizze_28529",
                                  "testzisegscan_group_sizze_28562",
                                  "testzisegscan_group_sizze_28570",
                                  "testzisegscan_group_sizze_28578",
                                  "testzisegscan_group_sizze_28630",
                                  "testzisegscan_num_groups_28531",
                                  "testzisegscan_num_groups_28564",
                                  "testzisegscan_num_groups_28572",
                                  "testzisegscan_num_groups_28580",
                                  "testzisegscan_num_groups_28632",
                                  "testzisuff_outer_par_0",
                                  "testzisuff_outer_par_8",
                                  "testzisuff_outer_redomap_7"};
static const char *size_classes[] = {"group_size", "group_size",
                                     "L2_for_histogram", "group_size",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "threshold ()",
                                     "threshold (!main.suff_outer_redomap_7)",
                                     "threshold ()", "L2_for_histogram",
                                     "group_size", "num_groups", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "num_groups", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "threshold ()",
                                     "threshold (!test.suff_outer_redomap_7)",
                                     "threshold ()"};
int futhark_get_num_sizes(void)
{
    return 80;
}
const char *futhark_get_size_name(int i)
{
    return size_names[i];
}
const char *futhark_get_size_class(int i)
{
    return size_classes[i];
}
struct sizes {
    size_t builtinzhreplicate_f32zigroup_sizze_29837;
    size_t builtinzhreplicate_i64zigroup_sizze_29429;
    size_t mainziL2_sizze_29494;
    size_t mainziseghist_group_sizze_27438;
    size_t mainziseghist_num_groups_27440;
    size_t mainzisegmap_group_sizze_26598;
    size_t mainzisegmap_group_sizze_26774;
    size_t mainzisegmap_group_sizze_27073;
    size_t mainzisegmap_group_sizze_27172;
    size_t mainzisegmap_group_sizze_27235;
    size_t mainzisegmap_group_sizze_27531;
    size_t mainzisegmap_group_sizze_27569;
    size_t mainzisegmap_group_sizze_27594;
    size_t mainzisegmap_num_groups_27075;
    size_t mainzisegred_group_sizze_26574;
    size_t mainzisegred_group_sizze_27428;
    size_t mainzisegred_group_sizze_27537;
    size_t mainzisegred_group_sizze_27602;
    size_t mainzisegred_group_sizze_27633;
    size_t mainzisegred_group_sizze_29051;
    size_t mainzisegred_group_sizze_29083;
    size_t mainzisegred_num_groups_26576;
    size_t mainzisegred_num_groups_27430;
    size_t mainzisegred_num_groups_27539;
    size_t mainzisegred_num_groups_27604;
    size_t mainzisegred_num_groups_27635;
    size_t mainzisegred_num_groups_29049;
    size_t mainzisegred_num_groups_29081;
    size_t mainzisegscan_group_sizze_27420;
    size_t mainzisegscan_group_sizze_27453;
    size_t mainzisegscan_group_sizze_27461;
    size_t mainzisegscan_group_sizze_27469;
    size_t mainzisegscan_group_sizze_27521;
    size_t mainzisegscan_num_groups_27422;
    size_t mainzisegscan_num_groups_27455;
    size_t mainzisegscan_num_groups_27463;
    size_t mainzisegscan_num_groups_27471;
    size_t mainzisegscan_num_groups_27523;
    size_t mainzisuff_outer_par_0;
    size_t mainzisuff_outer_par_8;
    size_t mainzisuff_outer_redomap_7;
    size_t testziL2_sizze_29494;
    size_t testziseghist_group_sizze_28547;
    size_t testziseghist_num_groups_28549;
    size_t testzisegmap_group_sizze_27710;
    size_t testzisegmap_group_sizze_27886;
    size_t testzisegmap_group_sizze_28185;
    size_t testzisegmap_group_sizze_28284;
    size_t testzisegmap_group_sizze_28347;
    size_t testzisegmap_group_sizze_28640;
    size_t testzisegmap_group_sizze_28678;
    size_t testzisegmap_group_sizze_28703;
    size_t testzisegmap_num_groups_28187;
    size_t testzisegred_group_sizze_27686;
    size_t testzisegred_group_sizze_28537;
    size_t testzisegred_group_sizze_28646;
    size_t testzisegred_group_sizze_28711;
    size_t testzisegred_group_sizze_28742;
    size_t testzisegred_group_sizze_29133;
    size_t testzisegred_group_sizze_29165;
    size_t testzisegred_num_groups_27688;
    size_t testzisegred_num_groups_28539;
    size_t testzisegred_num_groups_28648;
    size_t testzisegred_num_groups_28713;
    size_t testzisegred_num_groups_28744;
    size_t testzisegred_num_groups_29131;
    size_t testzisegred_num_groups_29163;
    size_t testzisegscan_group_sizze_28529;
    size_t testzisegscan_group_sizze_28562;
    size_t testzisegscan_group_sizze_28570;
    size_t testzisegscan_group_sizze_28578;
    size_t testzisegscan_group_sizze_28630;
    size_t testzisegscan_num_groups_28531;
    size_t testzisegscan_num_groups_28564;
    size_t testzisegscan_num_groups_28572;
    size_t testzisegscan_num_groups_28580;
    size_t testzisegscan_num_groups_28632;
    size_t testzisuff_outer_par_0;
    size_t testzisuff_outer_par_8;
    size_t testzisuff_outer_redomap_7;
} ;
struct futhark_context_config {
    struct opencl_config opencl;
    size_t sizes[80];
    int num_build_opts;
    const char **build_opts;
} ;
struct futhark_context_config *futhark_context_config_new(void)
{
    struct futhark_context_config *cfg =
                                  (struct futhark_context_config *) malloc(sizeof(struct futhark_context_config));
    
    if (cfg == NULL)
        return NULL;
    cfg->num_build_opts = 0;
    cfg->build_opts = (const char **) malloc(sizeof(const char *));
    cfg->build_opts[0] = NULL;
    cfg->sizes[0] = 0;
    cfg->sizes[1] = 0;
    cfg->sizes[2] = 4194304;
    cfg->sizes[3] = 0;
    cfg->sizes[4] = 0;
    cfg->sizes[5] = 0;
    cfg->sizes[6] = 0;
    cfg->sizes[7] = 0;
    cfg->sizes[8] = 0;
    cfg->sizes[9] = 0;
    cfg->sizes[10] = 0;
    cfg->sizes[11] = 0;
    cfg->sizes[12] = 0;
    cfg->sizes[13] = 0;
    cfg->sizes[14] = 0;
    cfg->sizes[15] = 0;
    cfg->sizes[16] = 0;
    cfg->sizes[17] = 0;
    cfg->sizes[18] = 0;
    cfg->sizes[19] = 0;
    cfg->sizes[20] = 0;
    cfg->sizes[21] = 0;
    cfg->sizes[22] = 0;
    cfg->sizes[23] = 0;
    cfg->sizes[24] = 0;
    cfg->sizes[25] = 0;
    cfg->sizes[26] = 0;
    cfg->sizes[27] = 0;
    cfg->sizes[28] = 0;
    cfg->sizes[29] = 0;
    cfg->sizes[30] = 0;
    cfg->sizes[31] = 0;
    cfg->sizes[32] = 0;
    cfg->sizes[33] = 0;
    cfg->sizes[34] = 0;
    cfg->sizes[35] = 0;
    cfg->sizes[36] = 0;
    cfg->sizes[37] = 0;
    cfg->sizes[38] = 0;
    cfg->sizes[39] = 0;
    cfg->sizes[40] = 0;
    cfg->sizes[41] = 4194304;
    cfg->sizes[42] = 0;
    cfg->sizes[43] = 0;
    cfg->sizes[44] = 0;
    cfg->sizes[45] = 0;
    cfg->sizes[46] = 0;
    cfg->sizes[47] = 0;
    cfg->sizes[48] = 0;
    cfg->sizes[49] = 0;
    cfg->sizes[50] = 0;
    cfg->sizes[51] = 0;
    cfg->sizes[52] = 0;
    cfg->sizes[53] = 0;
    cfg->sizes[54] = 0;
    cfg->sizes[55] = 0;
    cfg->sizes[56] = 0;
    cfg->sizes[57] = 0;
    cfg->sizes[58] = 0;
    cfg->sizes[59] = 0;
    cfg->sizes[60] = 0;
    cfg->sizes[61] = 0;
    cfg->sizes[62] = 0;
    cfg->sizes[63] = 0;
    cfg->sizes[64] = 0;
    cfg->sizes[65] = 0;
    cfg->sizes[66] = 0;
    cfg->sizes[67] = 0;
    cfg->sizes[68] = 0;
    cfg->sizes[69] = 0;
    cfg->sizes[70] = 0;
    cfg->sizes[71] = 0;
    cfg->sizes[72] = 0;
    cfg->sizes[73] = 0;
    cfg->sizes[74] = 0;
    cfg->sizes[75] = 0;
    cfg->sizes[76] = 0;
    cfg->sizes[77] = 0;
    cfg->sizes[78] = 0;
    cfg->sizes[79] = 0;
    opencl_config_init(&cfg->opencl, 80, size_names, size_vars, cfg->sizes,
                       size_classes);
    return cfg;
}
void futhark_context_config_free(struct futhark_context_config *cfg)
{
    free(cfg->build_opts);
    free(cfg);
}
void futhark_context_config_add_build_option(struct futhark_context_config *cfg,
                                             const char *opt)
{
    cfg->build_opts[cfg->num_build_opts] = opt;
    cfg->num_build_opts++;
    cfg->build_opts = (const char **) realloc(cfg->build_opts,
                                              (cfg->num_build_opts + 1) *
                                              sizeof(const char *));
    cfg->build_opts[cfg->num_build_opts] = NULL;
}
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int flag)
{
    cfg->opencl.profiling = cfg->opencl.logging = cfg->opencl.debugging = flag;
}
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag)
{
    cfg->opencl.profiling = flag;
}
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int flag)
{
    cfg->opencl.logging = flag;
}
void futhark_context_config_set_device(struct futhark_context_config *cfg, const
                                       char *s)
{
    set_preferred_device(&cfg->opencl, s);
}
void futhark_context_config_set_platform(struct futhark_context_config *cfg,
                                         const char *s)
{
    set_preferred_platform(&cfg->opencl, s);
}
void futhark_context_config_select_device_interactively(struct futhark_context_config *cfg)
{
    select_device_interactively(&cfg->opencl);
}
void futhark_context_config_list_devices(struct futhark_context_config *cfg)
{
    list_devices(&cfg->opencl);
}
void futhark_context_config_dump_program_to(struct futhark_context_config *cfg,
                                            const char *path)
{
    cfg->opencl.dump_program_to = path;
}
void futhark_context_config_load_program_from(struct futhark_context_config *cfg,
                                              const char *path)
{
    cfg->opencl.load_program_from = path;
}
void futhark_context_config_dump_binary_to(struct futhark_context_config *cfg,
                                           const char *path)
{
    cfg->opencl.dump_binary_to = path;
}
void futhark_context_config_load_binary_from(struct futhark_context_config *cfg,
                                             const char *path)
{
    cfg->opencl.load_binary_from = path;
}
void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg,
                                                   int size)
{
    cfg->opencl.default_group_size = size;
    cfg->opencl.default_group_size_changed = 1;
}
void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg,
                                                   int num)
{
    cfg->opencl.default_num_groups = num;
}
void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg,
                                                  int size)
{
    cfg->opencl.default_tile_size = size;
    cfg->opencl.default_tile_size_changed = 1;
}
void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg,
                                                  int size)
{
    cfg->opencl.default_threshold = size;
}
int futhark_context_config_set_size(struct futhark_context_config *cfg, const
                                    char *size_name, size_t size_value)
{
    for (int i = 0; i < 80; i++) {
        if (strcmp(size_name, size_names[i]) == 0) {
            cfg->sizes[i] = size_value;
            return 0;
        }
    }
    if (strcmp(size_name, "default_group_size") == 0) {
        cfg->opencl.default_group_size = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_num_groups") == 0) {
        cfg->opencl.default_num_groups = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_threshold") == 0) {
        cfg->opencl.default_threshold = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_tile_size") == 0) {
        cfg->opencl.default_tile_size = size_value;
        return 0;
    }
    return 1;
}
struct futhark_context {
    int detail_memory;
    int debugging;
    int profiling;
    int profiling_paused;
    int logging;
    lock_t lock;
    char *error;
    int64_t peak_mem_usage_device;
    int64_t cur_mem_usage_device;
    int64_t peak_mem_usage_default;
    int64_t cur_mem_usage_default;
    struct {
        int dummy;
    } constants;
    struct memblock_device mainzicounter_mem_29207;
    struct memblock_device mainzicounter_mem_29237;
    struct memblock_device mainzicounter_mem_29274;
    struct memblock_device mainzicounter_mem_29392;
    struct memblock_device mainzihist_locks_mem_29502;
    struct memblock_device mainzicounter_mem_29546;
    struct memblock_device mainzicounter_mem_29844;
    struct memblock_device mainzicounter_mem_29909;
    struct memblock_device mainzicounter_mem_29947;
    struct memblock_device testzistatic_array_29204;
    struct memblock_device testzistatic_array_29205;
    struct memblock_device testzistatic_array_29206;
    struct memblock_device testzicounter_mem_29208;
    struct memblock_device testzicounter_mem_29238;
    struct memblock_device testzicounter_mem_29275;
    struct memblock_device testzicounter_mem_29392;
    struct memblock_device testzihist_locks_mem_29502;
    struct memblock_device testzicounter_mem_29546;
    struct memblock_device testzicounter_mem_29844;
    struct memblock_device testzicounter_mem_29909;
    struct memblock_device testzicounter_mem_29947;
    int total_runs;
    long total_runtime;
    cl_kernel builtinzhreplicate_f32zireplicate_29834;
    cl_kernel builtinzhreplicate_i64zireplicate_29426;
    cl_kernel gpu_map_transpose_f32;
    cl_kernel gpu_map_transpose_f32_low_height;
    cl_kernel gpu_map_transpose_f32_low_width;
    cl_kernel gpu_map_transpose_f32_small;
    cl_kernel mainziscan_stage1_27426;
    cl_kernel mainziscan_stage1_27459;
    cl_kernel mainziscan_stage1_27467;
    cl_kernel mainziscan_stage1_27475;
    cl_kernel mainziscan_stage1_27527;
    cl_kernel mainziscan_stage2_27426;
    cl_kernel mainziscan_stage2_27459;
    cl_kernel mainziscan_stage2_27467;
    cl_kernel mainziscan_stage2_27475;
    cl_kernel mainziscan_stage2_27527;
    cl_kernel mainziscan_stage3_27426;
    cl_kernel mainziscan_stage3_27459;
    cl_kernel mainziscan_stage3_27467;
    cl_kernel mainziscan_stage3_27475;
    cl_kernel mainziscan_stage3_27527;
    cl_kernel mainziseghist_global_27444;
    cl_kernel mainziseghist_local_27444;
    cl_kernel mainzisegmap_26596;
    cl_kernel mainzisegmap_26772;
    cl_kernel mainzisegmap_27071;
    cl_kernel mainzisegmap_27169;
    cl_kernel mainzisegmap_27233;
    cl_kernel mainzisegmap_27529;
    cl_kernel mainzisegmap_27567;
    cl_kernel mainzisegmap_27592;
    cl_kernel mainzisegred_large_27608;
    cl_kernel mainzisegred_large_29517;
    cl_kernel mainzisegred_nonseg_26582;
    cl_kernel mainzisegred_nonseg_27436;
    cl_kernel mainzisegred_nonseg_27545;
    cl_kernel mainzisegred_nonseg_27641;
    cl_kernel mainzisegred_nonseg_29056;
    cl_kernel mainzisegred_nonseg_29088;
    cl_kernel mainzisegred_small_27608;
    cl_kernel mainzisegred_small_29517;
    cl_kernel testziscan_stage1_28535;
    cl_kernel testziscan_stage1_28568;
    cl_kernel testziscan_stage1_28576;
    cl_kernel testziscan_stage1_28584;
    cl_kernel testziscan_stage1_28636;
    cl_kernel testziscan_stage2_28535;
    cl_kernel testziscan_stage2_28568;
    cl_kernel testziscan_stage2_28576;
    cl_kernel testziscan_stage2_28584;
    cl_kernel testziscan_stage2_28636;
    cl_kernel testziscan_stage3_28535;
    cl_kernel testziscan_stage3_28568;
    cl_kernel testziscan_stage3_28576;
    cl_kernel testziscan_stage3_28584;
    cl_kernel testziscan_stage3_28636;
    cl_kernel testziseghist_global_28553;
    cl_kernel testziseghist_local_28553;
    cl_kernel testzisegmap_27708;
    cl_kernel testzisegmap_27884;
    cl_kernel testzisegmap_28183;
    cl_kernel testzisegmap_28281;
    cl_kernel testzisegmap_28345;
    cl_kernel testzisegmap_28638;
    cl_kernel testzisegmap_28676;
    cl_kernel testzisegmap_28701;
    cl_kernel testzisegred_large_28717;
    cl_kernel testzisegred_large_29517;
    cl_kernel testzisegred_nonseg_27694;
    cl_kernel testzisegred_nonseg_28545;
    cl_kernel testzisegred_nonseg_28654;
    cl_kernel testzisegred_nonseg_28750;
    cl_kernel testzisegred_nonseg_29138;
    cl_kernel testzisegred_nonseg_29170;
    cl_kernel testzisegred_small_28717;
    cl_kernel testzisegred_small_29517;
    int64_t copy_dev_to_dev_total_runtime;
    int copy_dev_to_dev_runs;
    int64_t copy_dev_to_host_total_runtime;
    int copy_dev_to_host_runs;
    int64_t copy_host_to_dev_total_runtime;
    int copy_host_to_dev_runs;
    int64_t copy_scalar_to_dev_total_runtime;
    int copy_scalar_to_dev_runs;
    int64_t copy_scalar_from_dev_total_runtime;
    int copy_scalar_from_dev_runs;
    int64_t builtinzhreplicate_f32zireplicate_29834_total_runtime;
    int builtinzhreplicate_f32zireplicate_29834_runs;
    int64_t builtinzhreplicate_i64zireplicate_29426_total_runtime;
    int builtinzhreplicate_i64zireplicate_29426_runs;
    int64_t gpu_map_transpose_f32_total_runtime;
    int gpu_map_transpose_f32_runs;
    int64_t gpu_map_transpose_f32_low_height_total_runtime;
    int gpu_map_transpose_f32_low_height_runs;
    int64_t gpu_map_transpose_f32_low_width_total_runtime;
    int gpu_map_transpose_f32_low_width_runs;
    int64_t gpu_map_transpose_f32_small_total_runtime;
    int gpu_map_transpose_f32_small_runs;
    int64_t mainziscan_stage1_27426_total_runtime;
    int mainziscan_stage1_27426_runs;
    int64_t mainziscan_stage1_27459_total_runtime;
    int mainziscan_stage1_27459_runs;
    int64_t mainziscan_stage1_27467_total_runtime;
    int mainziscan_stage1_27467_runs;
    int64_t mainziscan_stage1_27475_total_runtime;
    int mainziscan_stage1_27475_runs;
    int64_t mainziscan_stage1_27527_total_runtime;
    int mainziscan_stage1_27527_runs;
    int64_t mainziscan_stage2_27426_total_runtime;
    int mainziscan_stage2_27426_runs;
    int64_t mainziscan_stage2_27459_total_runtime;
    int mainziscan_stage2_27459_runs;
    int64_t mainziscan_stage2_27467_total_runtime;
    int mainziscan_stage2_27467_runs;
    int64_t mainziscan_stage2_27475_total_runtime;
    int mainziscan_stage2_27475_runs;
    int64_t mainziscan_stage2_27527_total_runtime;
    int mainziscan_stage2_27527_runs;
    int64_t mainziscan_stage3_27426_total_runtime;
    int mainziscan_stage3_27426_runs;
    int64_t mainziscan_stage3_27459_total_runtime;
    int mainziscan_stage3_27459_runs;
    int64_t mainziscan_stage3_27467_total_runtime;
    int mainziscan_stage3_27467_runs;
    int64_t mainziscan_stage3_27475_total_runtime;
    int mainziscan_stage3_27475_runs;
    int64_t mainziscan_stage3_27527_total_runtime;
    int mainziscan_stage3_27527_runs;
    int64_t mainziseghist_global_27444_total_runtime;
    int mainziseghist_global_27444_runs;
    int64_t mainziseghist_local_27444_total_runtime;
    int mainziseghist_local_27444_runs;
    int64_t mainzisegmap_26596_total_runtime;
    int mainzisegmap_26596_runs;
    int64_t mainzisegmap_26772_total_runtime;
    int mainzisegmap_26772_runs;
    int64_t mainzisegmap_27071_total_runtime;
    int mainzisegmap_27071_runs;
    int64_t mainzisegmap_27169_total_runtime;
    int mainzisegmap_27169_runs;
    int64_t mainzisegmap_27233_total_runtime;
    int mainzisegmap_27233_runs;
    int64_t mainzisegmap_27529_total_runtime;
    int mainzisegmap_27529_runs;
    int64_t mainzisegmap_27567_total_runtime;
    int mainzisegmap_27567_runs;
    int64_t mainzisegmap_27592_total_runtime;
    int mainzisegmap_27592_runs;
    int64_t mainzisegred_large_27608_total_runtime;
    int mainzisegred_large_27608_runs;
    int64_t mainzisegred_large_29517_total_runtime;
    int mainzisegred_large_29517_runs;
    int64_t mainzisegred_nonseg_26582_total_runtime;
    int mainzisegred_nonseg_26582_runs;
    int64_t mainzisegred_nonseg_27436_total_runtime;
    int mainzisegred_nonseg_27436_runs;
    int64_t mainzisegred_nonseg_27545_total_runtime;
    int mainzisegred_nonseg_27545_runs;
    int64_t mainzisegred_nonseg_27641_total_runtime;
    int mainzisegred_nonseg_27641_runs;
    int64_t mainzisegred_nonseg_29056_total_runtime;
    int mainzisegred_nonseg_29056_runs;
    int64_t mainzisegred_nonseg_29088_total_runtime;
    int mainzisegred_nonseg_29088_runs;
    int64_t mainzisegred_small_27608_total_runtime;
    int mainzisegred_small_27608_runs;
    int64_t mainzisegred_small_29517_total_runtime;
    int mainzisegred_small_29517_runs;
    int64_t testziscan_stage1_28535_total_runtime;
    int testziscan_stage1_28535_runs;
    int64_t testziscan_stage1_28568_total_runtime;
    int testziscan_stage1_28568_runs;
    int64_t testziscan_stage1_28576_total_runtime;
    int testziscan_stage1_28576_runs;
    int64_t testziscan_stage1_28584_total_runtime;
    int testziscan_stage1_28584_runs;
    int64_t testziscan_stage1_28636_total_runtime;
    int testziscan_stage1_28636_runs;
    int64_t testziscan_stage2_28535_total_runtime;
    int testziscan_stage2_28535_runs;
    int64_t testziscan_stage2_28568_total_runtime;
    int testziscan_stage2_28568_runs;
    int64_t testziscan_stage2_28576_total_runtime;
    int testziscan_stage2_28576_runs;
    int64_t testziscan_stage2_28584_total_runtime;
    int testziscan_stage2_28584_runs;
    int64_t testziscan_stage2_28636_total_runtime;
    int testziscan_stage2_28636_runs;
    int64_t testziscan_stage3_28535_total_runtime;
    int testziscan_stage3_28535_runs;
    int64_t testziscan_stage3_28568_total_runtime;
    int testziscan_stage3_28568_runs;
    int64_t testziscan_stage3_28576_total_runtime;
    int testziscan_stage3_28576_runs;
    int64_t testziscan_stage3_28584_total_runtime;
    int testziscan_stage3_28584_runs;
    int64_t testziscan_stage3_28636_total_runtime;
    int testziscan_stage3_28636_runs;
    int64_t testziseghist_global_28553_total_runtime;
    int testziseghist_global_28553_runs;
    int64_t testziseghist_local_28553_total_runtime;
    int testziseghist_local_28553_runs;
    int64_t testzisegmap_27708_total_runtime;
    int testzisegmap_27708_runs;
    int64_t testzisegmap_27884_total_runtime;
    int testzisegmap_27884_runs;
    int64_t testzisegmap_28183_total_runtime;
    int testzisegmap_28183_runs;
    int64_t testzisegmap_28281_total_runtime;
    int testzisegmap_28281_runs;
    int64_t testzisegmap_28345_total_runtime;
    int testzisegmap_28345_runs;
    int64_t testzisegmap_28638_total_runtime;
    int testzisegmap_28638_runs;
    int64_t testzisegmap_28676_total_runtime;
    int testzisegmap_28676_runs;
    int64_t testzisegmap_28701_total_runtime;
    int testzisegmap_28701_runs;
    int64_t testzisegred_large_28717_total_runtime;
    int testzisegred_large_28717_runs;
    int64_t testzisegred_large_29517_total_runtime;
    int testzisegred_large_29517_runs;
    int64_t testzisegred_nonseg_27694_total_runtime;
    int testzisegred_nonseg_27694_runs;
    int64_t testzisegred_nonseg_28545_total_runtime;
    int testzisegred_nonseg_28545_runs;
    int64_t testzisegred_nonseg_28654_total_runtime;
    int testzisegred_nonseg_28654_runs;
    int64_t testzisegred_nonseg_28750_total_runtime;
    int testzisegred_nonseg_28750_runs;
    int64_t testzisegred_nonseg_29138_total_runtime;
    int testzisegred_nonseg_29138_runs;
    int64_t testzisegred_nonseg_29170_total_runtime;
    int testzisegred_nonseg_29170_runs;
    int64_t testzisegred_small_28717_total_runtime;
    int testzisegred_small_28717_runs;
    int64_t testzisegred_small_29517_total_runtime;
    int testzisegred_small_29517_runs;
    cl_mem global_failure;
    cl_mem global_failure_args;
    struct opencl_context opencl;
    struct sizes sizes;
    cl_int failure_is_an_option;
} ;
void post_opencl_setup(struct opencl_context *ctx,
                       struct opencl_device_option *option)
{
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name,
                                            "NVIDIA CUDA") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_GPU) == CL_DEVICE_TYPE_GPU) {
        ctx->lockstep_width = 32;
    }
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name,
                                            "AMD Accelerated Parallel Processing") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->lockstep_width = 32;
    }
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->lockstep_width = 1;
    }
    if ((ctx->cfg.default_num_groups == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_GPU) == CL_DEVICE_TYPE_GPU) {
        size_t MAX_COMPUTE_UNITS_val = 0;
        
        clGetDeviceInfo(ctx->device, CL_DEVICE_MAX_COMPUTE_UNITS,
                        sizeof(MAX_COMPUTE_UNITS_val), &MAX_COMPUTE_UNITS_val,
                        NULL);
        ctx->cfg.default_num_groups = 4 * MAX_COMPUTE_UNITS_val;
    }
    if ((ctx->cfg.default_group_size == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_GPU) == CL_DEVICE_TYPE_GPU) {
        ctx->cfg.default_group_size = 256;
    }
    if ((ctx->cfg.default_tile_size == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->cfg.default_tile_size = 32;
    }
    if ((ctx->cfg.default_threshold == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_GPU) ==
        CL_DEVICE_TYPE_GPU) {
        ctx->cfg.default_threshold = 32768;
    }
    if ((ctx->lockstep_width == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_CPU) ==
        CL_DEVICE_TYPE_CPU) {
        ctx->lockstep_width = 1;
    }
    if ((ctx->cfg.default_num_groups == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_CPU) == CL_DEVICE_TYPE_CPU) {
        size_t MAX_COMPUTE_UNITS_val = 0;
        
        clGetDeviceInfo(ctx->device, CL_DEVICE_MAX_COMPUTE_UNITS,
                        sizeof(MAX_COMPUTE_UNITS_val), &MAX_COMPUTE_UNITS_val,
                        NULL);
        ctx->cfg.default_num_groups = MAX_COMPUTE_UNITS_val;
    }
    if ((ctx->cfg.default_group_size == 0 && strstr(option->platform_name,
                                                    "") != NULL) &&
        (option->device_type & CL_DEVICE_TYPE_CPU) == CL_DEVICE_TYPE_CPU) {
        ctx->cfg.default_group_size = 32;
    }
    if ((ctx->cfg.default_tile_size == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_CPU) ==
        CL_DEVICE_TYPE_CPU) {
        ctx->cfg.default_tile_size = 4;
    }
    if ((ctx->cfg.default_threshold == 0 && strstr(option->platform_name, "") !=
         NULL) && (option->device_type & CL_DEVICE_TYPE_CPU) ==
        CL_DEVICE_TYPE_CPU) {
        size_t MAX_COMPUTE_UNITS_val = 0;
        
        clGetDeviceInfo(ctx->device, CL_DEVICE_MAX_COMPUTE_UNITS,
                        sizeof(MAX_COMPUTE_UNITS_val), &MAX_COMPUTE_UNITS_val,
                        NULL);
        ctx->cfg.default_threshold = MAX_COMPUTE_UNITS_val;
    }
}
static void init_context_early(struct futhark_context_config *cfg,
                               struct futhark_context *ctx)
{
    ctx->opencl.cfg = cfg->opencl;
    ctx->detail_memory = cfg->opencl.debugging;
    ctx->debugging = cfg->opencl.debugging;
    ctx->profiling = cfg->opencl.profiling;
    ctx->profiling_paused = 0;
    ctx->logging = cfg->opencl.logging;
    ctx->error = NULL;
    ctx->opencl.profiling_records_capacity = 200;
    ctx->opencl.profiling_records_used = 0;
    ctx->opencl.profiling_records =
        malloc(ctx->opencl.profiling_records_capacity *
        sizeof(struct profiling_record));
    create_lock(&ctx->lock);
    ctx->failure_is_an_option = 0;
    ctx->peak_mem_usage_device = 0;
    ctx->cur_mem_usage_device = 0;
    ctx->peak_mem_usage_default = 0;
    ctx->cur_mem_usage_default = 0;
    ctx->total_runs = 0;
    ctx->total_runtime = 0;
    ctx->copy_dev_to_dev_total_runtime = 0;
    ctx->copy_dev_to_dev_runs = 0;
    ctx->copy_dev_to_host_total_runtime = 0;
    ctx->copy_dev_to_host_runs = 0;
    ctx->copy_host_to_dev_total_runtime = 0;
    ctx->copy_host_to_dev_runs = 0;
    ctx->copy_scalar_to_dev_total_runtime = 0;
    ctx->copy_scalar_to_dev_runs = 0;
    ctx->copy_scalar_from_dev_total_runtime = 0;
    ctx->copy_scalar_from_dev_runs = 0;
    ctx->builtinzhreplicate_f32zireplicate_29834_total_runtime = 0;
    ctx->builtinzhreplicate_f32zireplicate_29834_runs = 0;
    ctx->builtinzhreplicate_i64zireplicate_29426_total_runtime = 0;
    ctx->builtinzhreplicate_i64zireplicate_29426_runs = 0;
    ctx->gpu_map_transpose_f32_total_runtime = 0;
    ctx->gpu_map_transpose_f32_runs = 0;
    ctx->gpu_map_transpose_f32_low_height_total_runtime = 0;
    ctx->gpu_map_transpose_f32_low_height_runs = 0;
    ctx->gpu_map_transpose_f32_low_width_total_runtime = 0;
    ctx->gpu_map_transpose_f32_low_width_runs = 0;
    ctx->gpu_map_transpose_f32_small_total_runtime = 0;
    ctx->gpu_map_transpose_f32_small_runs = 0;
    ctx->mainziscan_stage1_27426_total_runtime = 0;
    ctx->mainziscan_stage1_27426_runs = 0;
    ctx->mainziscan_stage1_27459_total_runtime = 0;
    ctx->mainziscan_stage1_27459_runs = 0;
    ctx->mainziscan_stage1_27467_total_runtime = 0;
    ctx->mainziscan_stage1_27467_runs = 0;
    ctx->mainziscan_stage1_27475_total_runtime = 0;
    ctx->mainziscan_stage1_27475_runs = 0;
    ctx->mainziscan_stage1_27527_total_runtime = 0;
    ctx->mainziscan_stage1_27527_runs = 0;
    ctx->mainziscan_stage2_27426_total_runtime = 0;
    ctx->mainziscan_stage2_27426_runs = 0;
    ctx->mainziscan_stage2_27459_total_runtime = 0;
    ctx->mainziscan_stage2_27459_runs = 0;
    ctx->mainziscan_stage2_27467_total_runtime = 0;
    ctx->mainziscan_stage2_27467_runs = 0;
    ctx->mainziscan_stage2_27475_total_runtime = 0;
    ctx->mainziscan_stage2_27475_runs = 0;
    ctx->mainziscan_stage2_27527_total_runtime = 0;
    ctx->mainziscan_stage2_27527_runs = 0;
    ctx->mainziscan_stage3_27426_total_runtime = 0;
    ctx->mainziscan_stage3_27426_runs = 0;
    ctx->mainziscan_stage3_27459_total_runtime = 0;
    ctx->mainziscan_stage3_27459_runs = 0;
    ctx->mainziscan_stage3_27467_total_runtime = 0;
    ctx->mainziscan_stage3_27467_runs = 0;
    ctx->mainziscan_stage3_27475_total_runtime = 0;
    ctx->mainziscan_stage3_27475_runs = 0;
    ctx->mainziscan_stage3_27527_total_runtime = 0;
    ctx->mainziscan_stage3_27527_runs = 0;
    ctx->mainziseghist_global_27444_total_runtime = 0;
    ctx->mainziseghist_global_27444_runs = 0;
    ctx->mainziseghist_local_27444_total_runtime = 0;
    ctx->mainziseghist_local_27444_runs = 0;
    ctx->mainzisegmap_26596_total_runtime = 0;
    ctx->mainzisegmap_26596_runs = 0;
    ctx->mainzisegmap_26772_total_runtime = 0;
    ctx->mainzisegmap_26772_runs = 0;
    ctx->mainzisegmap_27071_total_runtime = 0;
    ctx->mainzisegmap_27071_runs = 0;
    ctx->mainzisegmap_27169_total_runtime = 0;
    ctx->mainzisegmap_27169_runs = 0;
    ctx->mainzisegmap_27233_total_runtime = 0;
    ctx->mainzisegmap_27233_runs = 0;
    ctx->mainzisegmap_27529_total_runtime = 0;
    ctx->mainzisegmap_27529_runs = 0;
    ctx->mainzisegmap_27567_total_runtime = 0;
    ctx->mainzisegmap_27567_runs = 0;
    ctx->mainzisegmap_27592_total_runtime = 0;
    ctx->mainzisegmap_27592_runs = 0;
    ctx->mainzisegred_large_27608_total_runtime = 0;
    ctx->mainzisegred_large_27608_runs = 0;
    ctx->mainzisegred_large_29517_total_runtime = 0;
    ctx->mainzisegred_large_29517_runs = 0;
    ctx->mainzisegred_nonseg_26582_total_runtime = 0;
    ctx->mainzisegred_nonseg_26582_runs = 0;
    ctx->mainzisegred_nonseg_27436_total_runtime = 0;
    ctx->mainzisegred_nonseg_27436_runs = 0;
    ctx->mainzisegred_nonseg_27545_total_runtime = 0;
    ctx->mainzisegred_nonseg_27545_runs = 0;
    ctx->mainzisegred_nonseg_27641_total_runtime = 0;
    ctx->mainzisegred_nonseg_27641_runs = 0;
    ctx->mainzisegred_nonseg_29056_total_runtime = 0;
    ctx->mainzisegred_nonseg_29056_runs = 0;
    ctx->mainzisegred_nonseg_29088_total_runtime = 0;
    ctx->mainzisegred_nonseg_29088_runs = 0;
    ctx->mainzisegred_small_27608_total_runtime = 0;
    ctx->mainzisegred_small_27608_runs = 0;
    ctx->mainzisegred_small_29517_total_runtime = 0;
    ctx->mainzisegred_small_29517_runs = 0;
    ctx->testziscan_stage1_28535_total_runtime = 0;
    ctx->testziscan_stage1_28535_runs = 0;
    ctx->testziscan_stage1_28568_total_runtime = 0;
    ctx->testziscan_stage1_28568_runs = 0;
    ctx->testziscan_stage1_28576_total_runtime = 0;
    ctx->testziscan_stage1_28576_runs = 0;
    ctx->testziscan_stage1_28584_total_runtime = 0;
    ctx->testziscan_stage1_28584_runs = 0;
    ctx->testziscan_stage1_28636_total_runtime = 0;
    ctx->testziscan_stage1_28636_runs = 0;
    ctx->testziscan_stage2_28535_total_runtime = 0;
    ctx->testziscan_stage2_28535_runs = 0;
    ctx->testziscan_stage2_28568_total_runtime = 0;
    ctx->testziscan_stage2_28568_runs = 0;
    ctx->testziscan_stage2_28576_total_runtime = 0;
    ctx->testziscan_stage2_28576_runs = 0;
    ctx->testziscan_stage2_28584_total_runtime = 0;
    ctx->testziscan_stage2_28584_runs = 0;
    ctx->testziscan_stage2_28636_total_runtime = 0;
    ctx->testziscan_stage2_28636_runs = 0;
    ctx->testziscan_stage3_28535_total_runtime = 0;
    ctx->testziscan_stage3_28535_runs = 0;
    ctx->testziscan_stage3_28568_total_runtime = 0;
    ctx->testziscan_stage3_28568_runs = 0;
    ctx->testziscan_stage3_28576_total_runtime = 0;
    ctx->testziscan_stage3_28576_runs = 0;
    ctx->testziscan_stage3_28584_total_runtime = 0;
    ctx->testziscan_stage3_28584_runs = 0;
    ctx->testziscan_stage3_28636_total_runtime = 0;
    ctx->testziscan_stage3_28636_runs = 0;
    ctx->testziseghist_global_28553_total_runtime = 0;
    ctx->testziseghist_global_28553_runs = 0;
    ctx->testziseghist_local_28553_total_runtime = 0;
    ctx->testziseghist_local_28553_runs = 0;
    ctx->testzisegmap_27708_total_runtime = 0;
    ctx->testzisegmap_27708_runs = 0;
    ctx->testzisegmap_27884_total_runtime = 0;
    ctx->testzisegmap_27884_runs = 0;
    ctx->testzisegmap_28183_total_runtime = 0;
    ctx->testzisegmap_28183_runs = 0;
    ctx->testzisegmap_28281_total_runtime = 0;
    ctx->testzisegmap_28281_runs = 0;
    ctx->testzisegmap_28345_total_runtime = 0;
    ctx->testzisegmap_28345_runs = 0;
    ctx->testzisegmap_28638_total_runtime = 0;
    ctx->testzisegmap_28638_runs = 0;
    ctx->testzisegmap_28676_total_runtime = 0;
    ctx->testzisegmap_28676_runs = 0;
    ctx->testzisegmap_28701_total_runtime = 0;
    ctx->testzisegmap_28701_runs = 0;
    ctx->testzisegred_large_28717_total_runtime = 0;
    ctx->testzisegred_large_28717_runs = 0;
    ctx->testzisegred_large_29517_total_runtime = 0;
    ctx->testzisegred_large_29517_runs = 0;
    ctx->testzisegred_nonseg_27694_total_runtime = 0;
    ctx->testzisegred_nonseg_27694_runs = 0;
    ctx->testzisegred_nonseg_28545_total_runtime = 0;
    ctx->testzisegred_nonseg_28545_runs = 0;
    ctx->testzisegred_nonseg_28654_total_runtime = 0;
    ctx->testzisegred_nonseg_28654_runs = 0;
    ctx->testzisegred_nonseg_28750_total_runtime = 0;
    ctx->testzisegred_nonseg_28750_runs = 0;
    ctx->testzisegred_nonseg_29138_total_runtime = 0;
    ctx->testzisegred_nonseg_29138_runs = 0;
    ctx->testzisegred_nonseg_29170_total_runtime = 0;
    ctx->testzisegred_nonseg_29170_runs = 0;
    ctx->testzisegred_small_28717_total_runtime = 0;
    ctx->testzisegred_small_28717_runs = 0;
    ctx->testzisegred_small_29517_total_runtime = 0;
    ctx->testzisegred_small_29517_runs = 0;
}
static int init_context_late(struct futhark_context_config *cfg,
                             struct futhark_context *ctx, cl_program prog)
{
    cl_int error;
    cl_int no_error = -1;
    
    ctx->global_failure = clCreateBuffer(ctx->opencl.ctx, CL_MEM_READ_WRITE |
                                         CL_MEM_COPY_HOST_PTR, sizeof(cl_int),
                                         &no_error, &error);
    OPENCL_SUCCEED_OR_RETURN(error);
    // The +1 is to avoid zero-byte allocations.
    ctx->global_failure_args = clCreateBuffer(ctx->opencl.ctx,
                                              CL_MEM_READ_WRITE,
                                              sizeof(int64_t) * (3 + 1), NULL,
                                              &error);
    OPENCL_SUCCEED_OR_RETURN(error);
    {
        ctx->builtinzhreplicate_f32zireplicate_29834 = clCreateKernel(prog,
                                                                      "builtinzhreplicate_f32zireplicate_29834",
                                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "builtin#replicate_f32.replicate_29834");
    }
    {
        ctx->builtinzhreplicate_i64zireplicate_29426 = clCreateKernel(prog,
                                                                      "builtinzhreplicate_i64zireplicate_29426",
                                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "builtin#replicate_i64.replicate_29426");
    }
    {
        ctx->gpu_map_transpose_f32 = clCreateKernel(prog,
                                                    "gpu_map_transpose_f32",
                                                    &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "gpu_map_transpose_f32");
    }
    {
        ctx->gpu_map_transpose_f32_low_height = clCreateKernel(prog,
                                                               "gpu_map_transpose_f32_low_height",
                                                               &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "gpu_map_transpose_f32_low_height");
    }
    {
        ctx->gpu_map_transpose_f32_low_width = clCreateKernel(prog,
                                                              "gpu_map_transpose_f32_low_width",
                                                              &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "gpu_map_transpose_f32_low_width");
    }
    {
        ctx->gpu_map_transpose_f32_small = clCreateKernel(prog,
                                                          "gpu_map_transpose_f32_small",
                                                          &error);
        OPENCL_SUCCEED_FATAL(error);
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "gpu_map_transpose_f32_small");
    }
    {
        ctx->mainziscan_stage1_27426 = clCreateKernel(prog,
                                                      "mainziscan_stage1_27426",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_27426, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_27426");
    }
    {
        ctx->mainziscan_stage1_27459 = clCreateKernel(prog,
                                                      "mainziscan_stage1_27459",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_27459, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_27459");
    }
    {
        ctx->mainziscan_stage1_27467 = clCreateKernel(prog,
                                                      "mainziscan_stage1_27467",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_27467, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_27467");
    }
    {
        ctx->mainziscan_stage1_27475 = clCreateKernel(prog,
                                                      "mainziscan_stage1_27475",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_27475, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_27475, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_27475");
    }
    {
        ctx->mainziscan_stage1_27527 = clCreateKernel(prog,
                                                      "mainziscan_stage1_27527",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage1_27527, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage1_27527");
    }
    {
        ctx->mainziscan_stage2_27426 = clCreateKernel(prog,
                                                      "mainziscan_stage2_27426",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_27426, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_27426");
    }
    {
        ctx->mainziscan_stage2_27459 = clCreateKernel(prog,
                                                      "mainziscan_stage2_27459",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_27459, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_27459");
    }
    {
        ctx->mainziscan_stage2_27467 = clCreateKernel(prog,
                                                      "mainziscan_stage2_27467",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_27467, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_27467");
    }
    {
        ctx->mainziscan_stage2_27475 = clCreateKernel(prog,
                                                      "mainziscan_stage2_27475",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_27475, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_27475");
    }
    {
        ctx->mainziscan_stage2_27527 = clCreateKernel(prog,
                                                      "mainziscan_stage2_27527",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage2_27527, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage2_27527");
    }
    {
        ctx->mainziscan_stage3_27426 = clCreateKernel(prog,
                                                      "mainziscan_stage3_27426",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_27426, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_27426");
    }
    {
        ctx->mainziscan_stage3_27459 = clCreateKernel(prog,
                                                      "mainziscan_stage3_27459",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_27459, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_27459");
    }
    {
        ctx->mainziscan_stage3_27467 = clCreateKernel(prog,
                                                      "mainziscan_stage3_27467",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_27467, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_27467");
    }
    {
        ctx->mainziscan_stage3_27475 = clCreateKernel(prog,
                                                      "mainziscan_stage3_27475",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_27475, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_27475");
    }
    {
        ctx->mainziscan_stage3_27527 = clCreateKernel(prog,
                                                      "mainziscan_stage3_27527",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziscan_stage3_27527, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.scan_stage3_27527");
    }
    {
        ctx->mainziseghist_global_27444 = clCreateKernel(prog,
                                                         "mainziseghist_global_27444",
                                                         &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziseghist_global_27444, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "main.seghist_global_27444");
    }
    {
        ctx->mainziseghist_local_27444 = clCreateKernel(prog,
                                                        "mainziseghist_local_27444",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainziseghist_local_27444, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.seghist_local_27444");
    }
    {
        ctx->mainzisegmap_26596 = clCreateKernel(prog, "mainzisegmap_26596",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_26596, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_26596, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_26596");
    }
    {
        ctx->mainzisegmap_26772 = clCreateKernel(prog, "mainzisegmap_26772",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_26772, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_26772, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_26772");
    }
    {
        ctx->mainzisegmap_27071 = clCreateKernel(prog, "mainzisegmap_27071",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_27071, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_27071, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_27071");
    }
    {
        ctx->mainzisegmap_27169 = clCreateKernel(prog, "mainzisegmap_27169",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_27169, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_27169");
    }
    {
        ctx->mainzisegmap_27233 = clCreateKernel(prog, "mainzisegmap_27233",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_27233, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_27233");
    }
    {
        ctx->mainzisegmap_27529 = clCreateKernel(prog, "mainzisegmap_27529",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_27529, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_27529");
    }
    {
        ctx->mainzisegmap_27567 = clCreateKernel(prog, "mainzisegmap_27567",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_27567, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_27567");
    }
    {
        ctx->mainzisegmap_27592 = clCreateKernel(prog, "mainzisegmap_27592",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegmap_27592, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segmap_27592");
    }
    {
        ctx->mainzisegred_large_27608 = clCreateKernel(prog,
                                                       "mainzisegred_large_27608",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_large_27608, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_large_27608");
    }
    {
        ctx->mainzisegred_large_29517 = clCreateKernel(prog,
                                                       "mainzisegred_large_29517",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_large_29517, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_large_29517");
    }
    {
        ctx->mainzisegred_nonseg_26582 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_26582",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_26582, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_26582");
    }
    {
        ctx->mainzisegred_nonseg_27436 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_27436",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_27436, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_27436");
    }
    {
        ctx->mainzisegred_nonseg_27545 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_27545",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_27545, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_27545");
    }
    {
        ctx->mainzisegred_nonseg_27641 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_27641",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_27641, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_27641");
    }
    {
        ctx->mainzisegred_nonseg_29056 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_29056",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_29056, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_29056");
    }
    {
        ctx->mainzisegred_nonseg_29088 = clCreateKernel(prog,
                                                        "mainzisegred_nonseg_29088",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_nonseg_29088, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_nonseg_29088");
    }
    {
        ctx->mainzisegred_small_27608 = clCreateKernel(prog,
                                                       "mainzisegred_small_27608",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_small_27608, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_small_27608");
    }
    {
        ctx->mainzisegred_small_29517 = clCreateKernel(prog,
                                                       "mainzisegred_small_29517",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->mainzisegred_small_29517, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "main.segred_small_29517");
    }
    {
        ctx->testziscan_stage1_28535 = clCreateKernel(prog,
                                                      "testziscan_stage1_28535",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_28535, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_28535");
    }
    {
        ctx->testziscan_stage1_28568 = clCreateKernel(prog,
                                                      "testziscan_stage1_28568",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_28568, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_28568");
    }
    {
        ctx->testziscan_stage1_28576 = clCreateKernel(prog,
                                                      "testziscan_stage1_28576",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_28576, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_28576");
    }
    {
        ctx->testziscan_stage1_28584 = clCreateKernel(prog,
                                                      "testziscan_stage1_28584",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_28584, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_28584, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_28584");
    }
    {
        ctx->testziscan_stage1_28636 = clCreateKernel(prog,
                                                      "testziscan_stage1_28636",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage1_28636, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage1_28636");
    }
    {
        ctx->testziscan_stage2_28535 = clCreateKernel(prog,
                                                      "testziscan_stage2_28535",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_28535, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_28535");
    }
    {
        ctx->testziscan_stage2_28568 = clCreateKernel(prog,
                                                      "testziscan_stage2_28568",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_28568, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_28568");
    }
    {
        ctx->testziscan_stage2_28576 = clCreateKernel(prog,
                                                      "testziscan_stage2_28576",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_28576, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_28576");
    }
    {
        ctx->testziscan_stage2_28584 = clCreateKernel(prog,
                                                      "testziscan_stage2_28584",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_28584, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_28584");
    }
    {
        ctx->testziscan_stage2_28636 = clCreateKernel(prog,
                                                      "testziscan_stage2_28636",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage2_28636, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage2_28636");
    }
    {
        ctx->testziscan_stage3_28535 = clCreateKernel(prog,
                                                      "testziscan_stage3_28535",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_28535, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_28535");
    }
    {
        ctx->testziscan_stage3_28568 = clCreateKernel(prog,
                                                      "testziscan_stage3_28568",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_28568, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_28568");
    }
    {
        ctx->testziscan_stage3_28576 = clCreateKernel(prog,
                                                      "testziscan_stage3_28576",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_28576, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_28576");
    }
    {
        ctx->testziscan_stage3_28584 = clCreateKernel(prog,
                                                      "testziscan_stage3_28584",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_28584, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_28584");
    }
    {
        ctx->testziscan_stage3_28636 = clCreateKernel(prog,
                                                      "testziscan_stage3_28636",
                                                      &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziscan_stage3_28636, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.scan_stage3_28636");
    }
    {
        ctx->testziseghist_global_28553 = clCreateKernel(prog,
                                                         "testziseghist_global_28553",
                                                         &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziseghist_global_28553, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n",
                    "test.seghist_global_28553");
    }
    {
        ctx->testziseghist_local_28553 = clCreateKernel(prog,
                                                        "testziseghist_local_28553",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testziseghist_local_28553, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.seghist_local_28553");
    }
    {
        ctx->testzisegmap_27708 = clCreateKernel(prog, "testzisegmap_27708",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27708, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27708, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_27708");
    }
    {
        ctx->testzisegmap_27884 = clCreateKernel(prog, "testzisegmap_27884",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27884, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_27884, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_27884");
    }
    {
        ctx->testzisegmap_28183 = clCreateKernel(prog, "testzisegmap_28183",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_28183, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_28183, 2,
                                            sizeof(cl_mem),
                                            &ctx->global_failure_args));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_28183");
    }
    {
        ctx->testzisegmap_28281 = clCreateKernel(prog, "testzisegmap_28281",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_28281, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_28281");
    }
    {
        ctx->testzisegmap_28345 = clCreateKernel(prog, "testzisegmap_28345",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_28345, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_28345");
    }
    {
        ctx->testzisegmap_28638 = clCreateKernel(prog, "testzisegmap_28638",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_28638, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_28638");
    }
    {
        ctx->testzisegmap_28676 = clCreateKernel(prog, "testzisegmap_28676",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_28676, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_28676");
    }
    {
        ctx->testzisegmap_28701 = clCreateKernel(prog, "testzisegmap_28701",
                                                 &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegmap_28701, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segmap_28701");
    }
    {
        ctx->testzisegred_large_28717 = clCreateKernel(prog,
                                                       "testzisegred_large_28717",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_large_28717, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_large_28717");
    }
    {
        ctx->testzisegred_large_29517 = clCreateKernel(prog,
                                                       "testzisegred_large_29517",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_large_29517, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_large_29517");
    }
    {
        ctx->testzisegred_nonseg_27694 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_27694",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_27694, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_27694");
    }
    {
        ctx->testzisegred_nonseg_28545 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_28545",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_28545, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_28545");
    }
    {
        ctx->testzisegred_nonseg_28654 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_28654",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_28654, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_28654");
    }
    {
        ctx->testzisegred_nonseg_28750 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_28750",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_28750, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_28750");
    }
    {
        ctx->testzisegred_nonseg_29138 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_29138",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_29138, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_29138");
    }
    {
        ctx->testzisegred_nonseg_29170 = clCreateKernel(prog,
                                                        "testzisegred_nonseg_29170",
                                                        &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_nonseg_29170, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_nonseg_29170");
    }
    {
        ctx->testzisegred_small_28717 = clCreateKernel(prog,
                                                       "testzisegred_small_28717",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_small_28717, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_small_28717");
    }
    {
        ctx->testzisegred_small_29517 = clCreateKernel(prog,
                                                       "testzisegred_small_29517",
                                                       &error);
        OPENCL_SUCCEED_FATAL(error);
        OPENCL_SUCCEED_FATAL(clSetKernelArg(ctx->testzisegred_small_29517, 0,
                                            sizeof(cl_mem),
                                            &ctx->global_failure));
        if (ctx->debugging)
            fprintf(stderr, "Created kernel %s.\n", "test.segred_small_29517");
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_29207.references = NULL;
        ctx->mainzicounter_mem_29207.size = 0;
        ctx->mainzicounter_mem_29207.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_29207.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_30011,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_29237.references = NULL;
        ctx->mainzicounter_mem_29237.size = 0;
        ctx->mainzicounter_mem_29237.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_29237.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_30018,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_29274.references = NULL;
        ctx->mainzicounter_mem_29274.size = 0;
        ctx->mainzicounter_mem_29274.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_29274.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_30030,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_29392.references = NULL;
        ctx->mainzicounter_mem_29392.size = 0;
        ctx->mainzicounter_mem_29392.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_29392.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_30072,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzihist_locks_mem_29502.references = NULL;
        ctx->mainzihist_locks_mem_29502.size = 0;
        ctx->mainzihist_locks_mem_29502.mem = clCreateBuffer(ctx->opencl.ctx,
                                                             CL_MEM_READ_WRITE,
                                                             (100151 >
                                                              0 ? 100151 : 1) *
                                                             sizeof(int32_t),
                                                             NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (100151 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzihist_locks_mem_29502.mem,
                                                          CL_TRUE, 0, 100151 *
                                                          sizeof(int32_t),
                                                          mainzihist_locks_mem_realtype_30084,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_29546.references = NULL;
        ctx->mainzicounter_mem_29546.size = 0;
        ctx->mainzicounter_mem_29546.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_29546.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_30095,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_29844.references = NULL;
        ctx->mainzicounter_mem_29844.size = 0;
        ctx->mainzicounter_mem_29844.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_29844.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_30167,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_29909.references = NULL;
        ctx->mainzicounter_mem_29909.size = 0;
        ctx->mainzicounter_mem_29909.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_29909.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_30184,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->mainzicounter_mem_29947.references = NULL;
        ctx->mainzicounter_mem_29947.size = 0;
        ctx->mainzicounter_mem_29947.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->mainzicounter_mem_29947.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          mainzicounter_mem_realtype_30195,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzistatic_array_29204.references = NULL;
        ctx->testzistatic_array_29204.size = 0;
        ctx->testzistatic_array_29204.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (9 > 0 ? 9 : 1) *
                                                           sizeof(float), NULL,
                                                           &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (9 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzistatic_array_29204.mem,
                                                          CL_TRUE, 0, 9 *
                                                          sizeof(float),
                                                          testzistatic_array_realtype_30204,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzistatic_array_29205.references = NULL;
        ctx->testzistatic_array_29205.size = 0;
        ctx->testzistatic_array_29205.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (9 > 0 ? 9 : 1) *
                                                           sizeof(int64_t),
                                                           NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (9 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzistatic_array_29205.mem,
                                                          CL_TRUE, 0, 9 *
                                                          sizeof(int64_t),
                                                          testzistatic_array_realtype_30205,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzistatic_array_29206.references = NULL;
        ctx->testzistatic_array_29206.size = 0;
        ctx->testzistatic_array_29206.mem = clCreateBuffer(ctx->opencl.ctx,
                                                           CL_MEM_READ_WRITE,
                                                           (9 > 0 ? 9 : 1) *
                                                           sizeof(float), NULL,
                                                           &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (9 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzistatic_array_29206.mem,
                                                          CL_TRUE, 0, 9 *
                                                          sizeof(float),
                                                          testzistatic_array_realtype_30206,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_29208.references = NULL;
        ctx->testzicounter_mem_29208.size = 0;
        ctx->testzicounter_mem_29208.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_29208.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_30207,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_29238.references = NULL;
        ctx->testzicounter_mem_29238.size = 0;
        ctx->testzicounter_mem_29238.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_29238.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_30214,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_29275.references = NULL;
        ctx->testzicounter_mem_29275.size = 0;
        ctx->testzicounter_mem_29275.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_29275.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_30226,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_29392.references = NULL;
        ctx->testzicounter_mem_29392.size = 0;
        ctx->testzicounter_mem_29392.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_29392.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_30268,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzihist_locks_mem_29502.references = NULL;
        ctx->testzihist_locks_mem_29502.size = 0;
        ctx->testzihist_locks_mem_29502.mem = clCreateBuffer(ctx->opencl.ctx,
                                                             CL_MEM_READ_WRITE,
                                                             (100151 >
                                                              0 ? 100151 : 1) *
                                                             sizeof(int32_t),
                                                             NULL, &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (100151 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzihist_locks_mem_29502.mem,
                                                          CL_TRUE, 0, 100151 *
                                                          sizeof(int32_t),
                                                          testzihist_locks_mem_realtype_30280,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_29546.references = NULL;
        ctx->testzicounter_mem_29546.size = 0;
        ctx->testzicounter_mem_29546.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_29546.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_30291,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_29844.references = NULL;
        ctx->testzicounter_mem_29844.size = 0;
        ctx->testzicounter_mem_29844.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_29844.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_30363,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_29909.references = NULL;
        ctx->testzicounter_mem_29909.size = 0;
        ctx->testzicounter_mem_29909.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10240 >
                                                           0 ? 10240 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10240 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_29909.mem,
                                                          CL_TRUE, 0, 10240 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_30380,
                                                          0, NULL, NULL));
    }
    {
        cl_int success;
        
        ctx->testzicounter_mem_29947.references = NULL;
        ctx->testzicounter_mem_29947.size = 0;
        ctx->testzicounter_mem_29947.mem = clCreateBuffer(ctx->opencl.ctx,
                                                          CL_MEM_READ_WRITE,
                                                          (10 > 0 ? 10 : 1) *
                                                          sizeof(int32_t), NULL,
                                                          &success);
        OPENCL_SUCCEED_OR_RETURN(success);
        if (10 > 0)
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          ctx->testzicounter_mem_29947.mem,
                                                          CL_TRUE, 0, 10 *
                                                          sizeof(int32_t),
                                                          testzicounter_mem_realtype_30391,
                                                          0, NULL, NULL));
    }
    ctx->sizes.builtinzhreplicate_f32zigroup_sizze_29837 = cfg->sizes[0];
    ctx->sizes.builtinzhreplicate_i64zigroup_sizze_29429 = cfg->sizes[1];
    ctx->sizes.mainziL2_sizze_29494 = cfg->sizes[2];
    ctx->sizes.mainziseghist_group_sizze_27438 = cfg->sizes[3];
    ctx->sizes.mainziseghist_num_groups_27440 = cfg->sizes[4];
    ctx->sizes.mainzisegmap_group_sizze_26598 = cfg->sizes[5];
    ctx->sizes.mainzisegmap_group_sizze_26774 = cfg->sizes[6];
    ctx->sizes.mainzisegmap_group_sizze_27073 = cfg->sizes[7];
    ctx->sizes.mainzisegmap_group_sizze_27172 = cfg->sizes[8];
    ctx->sizes.mainzisegmap_group_sizze_27235 = cfg->sizes[9];
    ctx->sizes.mainzisegmap_group_sizze_27531 = cfg->sizes[10];
    ctx->sizes.mainzisegmap_group_sizze_27569 = cfg->sizes[11];
    ctx->sizes.mainzisegmap_group_sizze_27594 = cfg->sizes[12];
    ctx->sizes.mainzisegmap_num_groups_27075 = cfg->sizes[13];
    ctx->sizes.mainzisegred_group_sizze_26574 = cfg->sizes[14];
    ctx->sizes.mainzisegred_group_sizze_27428 = cfg->sizes[15];
    ctx->sizes.mainzisegred_group_sizze_27537 = cfg->sizes[16];
    ctx->sizes.mainzisegred_group_sizze_27602 = cfg->sizes[17];
    ctx->sizes.mainzisegred_group_sizze_27633 = cfg->sizes[18];
    ctx->sizes.mainzisegred_group_sizze_29051 = cfg->sizes[19];
    ctx->sizes.mainzisegred_group_sizze_29083 = cfg->sizes[20];
    ctx->sizes.mainzisegred_num_groups_26576 = cfg->sizes[21];
    ctx->sizes.mainzisegred_num_groups_27430 = cfg->sizes[22];
    ctx->sizes.mainzisegred_num_groups_27539 = cfg->sizes[23];
    ctx->sizes.mainzisegred_num_groups_27604 = cfg->sizes[24];
    ctx->sizes.mainzisegred_num_groups_27635 = cfg->sizes[25];
    ctx->sizes.mainzisegred_num_groups_29049 = cfg->sizes[26];
    ctx->sizes.mainzisegred_num_groups_29081 = cfg->sizes[27];
    ctx->sizes.mainzisegscan_group_sizze_27420 = cfg->sizes[28];
    ctx->sizes.mainzisegscan_group_sizze_27453 = cfg->sizes[29];
    ctx->sizes.mainzisegscan_group_sizze_27461 = cfg->sizes[30];
    ctx->sizes.mainzisegscan_group_sizze_27469 = cfg->sizes[31];
    ctx->sizes.mainzisegscan_group_sizze_27521 = cfg->sizes[32];
    ctx->sizes.mainzisegscan_num_groups_27422 = cfg->sizes[33];
    ctx->sizes.mainzisegscan_num_groups_27455 = cfg->sizes[34];
    ctx->sizes.mainzisegscan_num_groups_27463 = cfg->sizes[35];
    ctx->sizes.mainzisegscan_num_groups_27471 = cfg->sizes[36];
    ctx->sizes.mainzisegscan_num_groups_27523 = cfg->sizes[37];
    ctx->sizes.mainzisuff_outer_par_0 = cfg->sizes[38];
    ctx->sizes.mainzisuff_outer_par_8 = cfg->sizes[39];
    ctx->sizes.mainzisuff_outer_redomap_7 = cfg->sizes[40];
    ctx->sizes.testziL2_sizze_29494 = cfg->sizes[41];
    ctx->sizes.testziseghist_group_sizze_28547 = cfg->sizes[42];
    ctx->sizes.testziseghist_num_groups_28549 = cfg->sizes[43];
    ctx->sizes.testzisegmap_group_sizze_27710 = cfg->sizes[44];
    ctx->sizes.testzisegmap_group_sizze_27886 = cfg->sizes[45];
    ctx->sizes.testzisegmap_group_sizze_28185 = cfg->sizes[46];
    ctx->sizes.testzisegmap_group_sizze_28284 = cfg->sizes[47];
    ctx->sizes.testzisegmap_group_sizze_28347 = cfg->sizes[48];
    ctx->sizes.testzisegmap_group_sizze_28640 = cfg->sizes[49];
    ctx->sizes.testzisegmap_group_sizze_28678 = cfg->sizes[50];
    ctx->sizes.testzisegmap_group_sizze_28703 = cfg->sizes[51];
    ctx->sizes.testzisegmap_num_groups_28187 = cfg->sizes[52];
    ctx->sizes.testzisegred_group_sizze_27686 = cfg->sizes[53];
    ctx->sizes.testzisegred_group_sizze_28537 = cfg->sizes[54];
    ctx->sizes.testzisegred_group_sizze_28646 = cfg->sizes[55];
    ctx->sizes.testzisegred_group_sizze_28711 = cfg->sizes[56];
    ctx->sizes.testzisegred_group_sizze_28742 = cfg->sizes[57];
    ctx->sizes.testzisegred_group_sizze_29133 = cfg->sizes[58];
    ctx->sizes.testzisegred_group_sizze_29165 = cfg->sizes[59];
    ctx->sizes.testzisegred_num_groups_27688 = cfg->sizes[60];
    ctx->sizes.testzisegred_num_groups_28539 = cfg->sizes[61];
    ctx->sizes.testzisegred_num_groups_28648 = cfg->sizes[62];
    ctx->sizes.testzisegred_num_groups_28713 = cfg->sizes[63];
    ctx->sizes.testzisegred_num_groups_28744 = cfg->sizes[64];
    ctx->sizes.testzisegred_num_groups_29131 = cfg->sizes[65];
    ctx->sizes.testzisegred_num_groups_29163 = cfg->sizes[66];
    ctx->sizes.testzisegscan_group_sizze_28529 = cfg->sizes[67];
    ctx->sizes.testzisegscan_group_sizze_28562 = cfg->sizes[68];
    ctx->sizes.testzisegscan_group_sizze_28570 = cfg->sizes[69];
    ctx->sizes.testzisegscan_group_sizze_28578 = cfg->sizes[70];
    ctx->sizes.testzisegscan_group_sizze_28630 = cfg->sizes[71];
    ctx->sizes.testzisegscan_num_groups_28531 = cfg->sizes[72];
    ctx->sizes.testzisegscan_num_groups_28564 = cfg->sizes[73];
    ctx->sizes.testzisegscan_num_groups_28572 = cfg->sizes[74];
    ctx->sizes.testzisegscan_num_groups_28580 = cfg->sizes[75];
    ctx->sizes.testzisegscan_num_groups_28632 = cfg->sizes[76];
    ctx->sizes.testzisuff_outer_par_0 = cfg->sizes[77];
    ctx->sizes.testzisuff_outer_par_8 = cfg->sizes[78];
    ctx->sizes.testzisuff_outer_redomap_7 = cfg->sizes[79];
    init_constants(ctx);
    // Clear the free list of any deallocations that occurred while initialising constants.
    OPENCL_SUCCEED_OR_RETURN(opencl_free_all(&ctx->opencl));
    // The program will be properly freed after all the kernels have also been freed.
    OPENCL_SUCCEED_OR_RETURN(clReleaseProgram(prog));
    return futhark_context_sync(ctx);
}
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg)
{
    struct futhark_context *ctx =
                           (struct futhark_context *) malloc(sizeof(struct futhark_context));
    
    if (ctx == NULL)
        return NULL;
    
    int required_types = 0;
    
    init_context_early(cfg, ctx);
    
    cl_program prog = setup_opencl(&ctx->opencl, opencl_program, required_types,
                                   cfg->build_opts);
    
    init_context_late(cfg, ctx, prog);
    return ctx;
}
struct futhark_context *futhark_context_new_with_command_queue(struct futhark_context_config *cfg,
                                                               cl_command_queue queue)
{
    struct futhark_context *ctx =
                           (struct futhark_context *) malloc(sizeof(struct futhark_context));
    
    if (ctx == NULL)
        return NULL;
    
    int required_types = 0;
    
    init_context_early(cfg, ctx);
    
    cl_program prog = setup_opencl_with_command_queue(&ctx->opencl, queue,
                                                      opencl_program,
                                                      required_types,
                                                      cfg->build_opts);
    
    init_context_late(cfg, ctx, prog);
    return ctx;
}
void futhark_context_free(struct futhark_context *ctx)
{
    free_constants(ctx);
    free_lock(&ctx->lock);
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->builtinzhreplicate_f32zireplicate_29834));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->builtinzhreplicate_i64zireplicate_29426));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32_low_height));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32_low_width));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->gpu_map_transpose_f32_small));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_27426));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_27459));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_27467));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_27475));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage1_27527));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_27426));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_27459));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_27467));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_27475));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage2_27527));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_27426));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_27459));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_27467));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_27475));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziscan_stage3_27527));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziseghist_global_27444));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainziseghist_local_27444));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_26596));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_26772));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_27071));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_27169));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_27233));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_27529));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_27567));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegmap_27592));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_large_27608));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_large_29517));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_26582));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_27436));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_27545));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_27641));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_29056));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_nonseg_29088));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_small_27608));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->mainzisegred_small_29517));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_28535));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_28568));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_28576));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_28584));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage1_28636));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_28535));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_28568));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_28576));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_28584));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage2_28636));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_28535));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_28568));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_28576));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_28584));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziscan_stage3_28636));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziseghist_global_28553));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testziseghist_local_28553));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_27708));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_27884));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_28183));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_28281));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_28345));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_28638));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_28676));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegmap_28701));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_large_28717));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_large_29517));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_27694));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_28545));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_28654));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_28750));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_29138));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_nonseg_29170));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_small_28717));
    OPENCL_SUCCEED_FATAL(clReleaseKernel(ctx->testzisegred_small_29517));
    teardown_opencl(&ctx->opencl);
    free(ctx);
}
int futhark_context_sync(struct futhark_context *ctx)
{
    cl_int failure_idx = -1;
    
    if (ctx->failure_is_an_option) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     ctx->global_failure,
                                                     CL_FALSE, 0,
                                                     sizeof(cl_int),
                                                     &failure_idx, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        ctx->failure_is_an_option = 0;
    }
    OPENCL_SUCCEED_OR_RETURN(clFinish(ctx->opencl.queue));
    if (failure_idx >= 0) {
        cl_int no_failure = -1;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                      ctx->global_failure,
                                                      CL_TRUE, 0,
                                                      sizeof(cl_int),
                                                      &no_failure, 0, NULL,
                                                      NULL));
        
        int64_t args[3 + 1];
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     ctx->global_failure_args,
                                                     CL_TRUE, 0, sizeof(args),
                                                     &args, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_host_runs,
                                                                                               &ctx->copy_dev_to_host_total_runtime)));
        switch (failure_idx) {
            
          case 0:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva.fut:54:29-52\n   #1  cva.fut:95:25-65\n   #2  cva.fut:109:16-62\n   #3  cva.fut:105:17-109:85\n   #4  cva.fut:100:1-158:20\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 1:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:96:47-70\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:100:1-158:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 2:
            {
                ctx->error =
                    msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  cva.fut:97:74-90\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:100:1-158:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 3:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva.fut:54:29-52\n   #1  cva.fut:95:25-65\n   #2  cva.fut:109:16-62\n   #3  cva.fut:105:17-109:85\n   #4  cva.fut:100:1-158:20\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 4:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:96:47-70\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:100:1-158:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 5:
            {
                ctx->error =
                    msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  cva.fut:97:74-90\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:100:1-158:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 6:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:71:97-104\n   #1  cva.fut:123:32-62\n   #2  cva.fut:123:22-69\n   #3  cva.fut:100:1-158:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 7:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:71:58-105\n   #1  cva.fut:123:32-62\n   #2  cva.fut:123:22-69\n   #3  cva.fut:100:1-158:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 8:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/segmented/segmented.fut:90:30-35\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:90:12-49\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva.fut:133:38-97\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  cva.fut:126:44-136:50\n   #9  cva.fut:100:1-158:20\n",
                              args[0], args[1]);
                break;
            }
            
          case 9:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva.fut:54:29-52\n   #1  cva.fut:95:25-65\n   #2  cva.fut:109:16-62\n   #3  cva.fut:105:17-109:85\n   #4  cva.fut:166:3-120\n   #5  cva.fut:165:1-166:128\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 10:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:96:47-70\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:166:3-120\n   #4  cva.fut:165:1-166:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 11:
            {
                ctx->error =
                    msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  cva.fut:97:74-90\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:166:3-120\n   #4  cva.fut:165:1-166:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 12:
            {
                ctx->error =
                    msgprintf("Range %lld..%lld...%lld is invalid.\n-> #0  cva.fut:54:29-52\n   #1  cva.fut:95:25-65\n   #2  cva.fut:109:16-62\n   #3  cva.fut:105:17-109:85\n   #4  cva.fut:166:3-120\n   #5  cva.fut:165:1-166:128\n",
                              args[0], args[1], args[2]);
                break;
            }
            
          case 13:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:96:47-70\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:166:3-120\n   #4  cva.fut:165:1-166:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 14:
            {
                ctx->error =
                    msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  cva.fut:97:74-90\n   #1  cva.fut:109:16-62\n   #2  cva.fut:105:17-109:85\n   #3  cva.fut:166:3-120\n   #4  cva.fut:165:1-166:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 15:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:71:97-104\n   #1  cva.fut:123:32-62\n   #2  cva.fut:123:22-69\n   #3  cva.fut:166:3-120\n   #4  cva.fut:165:1-166:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 16:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  cva.fut:71:58-105\n   #1  cva.fut:123:32-62\n   #2  cva.fut:123:22-69\n   #3  cva.fut:166:3-120\n   #4  cva.fut:165:1-166:128\n",
                              args[0], args[1]);
                break;
            }
            
          case 17:
            {
                ctx->error =
                    msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/segmented/segmented.fut:90:30-35\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:90:12-49\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva.fut:133:38-97\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  cva.fut:126:44-136:50\n   #9  cva.fut:166:3-120\n   #10 cva.fut:165:1-166:128\n",
                              args[0], args[1]);
                break;
            }
        }
        return 1;
    }
    return 0;
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    ctx->error = OPENCL_SUCCEED_NONFATAL(opencl_free_all(&ctx->opencl));
    return ctx->error != NULL;
}
cl_command_queue futhark_context_get_command_queue(struct futhark_context *ctx)
{
    return ctx->opencl.queue;
}
static int memblock_unref_device(struct futhark_context *ctx,
                                 struct memblock_device *block, const
                                 char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(stderr,
                    "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n",
                    desc, block->desc, "space 'device'", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_device -= block->size;
            OPENCL_SUCCEED_OR_RETURN(opencl_free(&ctx->opencl, block->mem,
                                                 desc));
            free(block->references);
            if (ctx->detail_memory)
                fprintf(stderr,
                        "%lld bytes freed (now allocated: %lld bytes)\n",
                        (long long) block->size,
                        (long long) ctx->cur_mem_usage_device);
        }
        block->references = NULL;
    }
    return 0;
}
static int memblock_alloc_device(struct futhark_context *ctx,
                                 struct memblock_device *block, int64_t size,
                                 const char *desc)
{
    if (size < 0)
        futhark_panic(1,
                      "Negative allocation of %lld bytes attempted for %s in %s.\n",
                      (long long) size, desc, "space 'device'",
                      ctx->cur_mem_usage_device);
    
    int ret = memblock_unref_device(ctx, block, desc);
    
    ctx->cur_mem_usage_device += size;
    if (ctx->detail_memory)
        fprintf(stderr,
                "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)",
                (long long) size, desc, "space 'device'",
                (long long) ctx->cur_mem_usage_device);
    if (ctx->cur_mem_usage_device > ctx->peak_mem_usage_device) {
        ctx->peak_mem_usage_device = ctx->cur_mem_usage_device;
        if (ctx->detail_memory)
            fprintf(stderr, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(stderr, ".\n");
    OPENCL_SUCCEED_OR_RETURN(opencl_alloc(&ctx->opencl, size, desc,
                                          &block->mem));
    block->references = (int *) malloc(sizeof(int));
    *block->references = 1;
    block->size = size;
    block->desc = desc;
    return ret;
}
static int memblock_set_device(struct futhark_context *ctx,
                               struct memblock_device *lhs,
                               struct memblock_device *rhs, const
                               char *lhs_desc)
{
    int ret = memblock_unref_device(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
static int memblock_unref(struct futhark_context *ctx, struct memblock *block,
                          const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(stderr,
                    "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n",
                    desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            free(block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(stderr,
                        "%lld bytes freed (now allocated: %lld bytes)\n",
                        (long long) block->size,
                        (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
static int memblock_alloc(struct futhark_context *ctx, struct memblock *block,
                          int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1,
                      "Negative allocation of %lld bytes attempted for %s in %s.\n",
                      (long long) size, desc, "default space",
                      ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    ctx->cur_mem_usage_default += size;
    if (ctx->detail_memory)
        fprintf(stderr,
                "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)",
                (long long) size, desc, "default space",
                (long long) ctx->cur_mem_usage_default);
    if (ctx->cur_mem_usage_default > ctx->peak_mem_usage_default) {
        ctx->peak_mem_usage_default = ctx->cur_mem_usage_default;
        if (ctx->detail_memory)
            fprintf(stderr, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(stderr, ".\n");
    block->mem = (char *) malloc(size);
    block->references = (int *) malloc(sizeof(int));
    *block->references = 1;
    block->size = size;
    block->desc = desc;
    return ret;
}
static int memblock_set(struct futhark_context *ctx, struct memblock *lhs,
                        struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    struct str_builder builder;
    
    str_builder_init(&builder);
    if (ctx->detail_memory || ctx->profiling) {
        str_builder(&builder,
                    "Peak memory usage for space 'device': %lld bytes.\n",
                    (long long) ctx->peak_mem_usage_device);
        { }
    }
    if (ctx->profiling) {
        OPENCL_SUCCEED_FATAL(opencl_tally_profiling_records(&ctx->opencl));
        str_builder(&builder,
                    "copy_dev_to_dev                       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_dev_to_dev_runs,
                    (long) ctx->copy_dev_to_dev_total_runtime /
                    (ctx->copy_dev_to_dev_runs !=
                     0 ? ctx->copy_dev_to_dev_runs : 1),
                    (long) ctx->copy_dev_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_dev_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_dev_to_dev_runs;
        str_builder(&builder,
                    "copy_dev_to_host                      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_dev_to_host_runs,
                    (long) ctx->copy_dev_to_host_total_runtime /
                    (ctx->copy_dev_to_host_runs !=
                     0 ? ctx->copy_dev_to_host_runs : 1),
                    (long) ctx->copy_dev_to_host_total_runtime);
        ctx->total_runtime += ctx->copy_dev_to_host_total_runtime;
        ctx->total_runs += ctx->copy_dev_to_host_runs;
        str_builder(&builder,
                    "copy_host_to_dev                      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_host_to_dev_runs,
                    (long) ctx->copy_host_to_dev_total_runtime /
                    (ctx->copy_host_to_dev_runs !=
                     0 ? ctx->copy_host_to_dev_runs : 1),
                    (long) ctx->copy_host_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_host_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_host_to_dev_runs;
        str_builder(&builder,
                    "copy_scalar_to_dev                    ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_scalar_to_dev_runs,
                    (long) ctx->copy_scalar_to_dev_total_runtime /
                    (ctx->copy_scalar_to_dev_runs !=
                     0 ? ctx->copy_scalar_to_dev_runs : 1),
                    (long) ctx->copy_scalar_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_scalar_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_scalar_to_dev_runs;
        str_builder(&builder,
                    "copy_scalar_from_dev                  ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_scalar_from_dev_runs,
                    (long) ctx->copy_scalar_from_dev_total_runtime /
                    (ctx->copy_scalar_from_dev_runs !=
                     0 ? ctx->copy_scalar_from_dev_runs : 1),
                    (long) ctx->copy_scalar_from_dev_total_runtime);
        ctx->total_runtime += ctx->copy_scalar_from_dev_total_runtime;
        ctx->total_runs += ctx->copy_scalar_from_dev_runs;
        str_builder(&builder,
                    "builtin#replicate_f32.replicate_29834 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhreplicate_f32zireplicate_29834_runs,
                    (long) ctx->builtinzhreplicate_f32zireplicate_29834_total_runtime /
                    (ctx->builtinzhreplicate_f32zireplicate_29834_runs !=
                     0 ? ctx->builtinzhreplicate_f32zireplicate_29834_runs : 1),
                    (long) ctx->builtinzhreplicate_f32zireplicate_29834_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhreplicate_f32zireplicate_29834_total_runtime;
        ctx->total_runs += ctx->builtinzhreplicate_f32zireplicate_29834_runs;
        str_builder(&builder,
                    "builtin#replicate_i64.replicate_29426 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhreplicate_i64zireplicate_29426_runs,
                    (long) ctx->builtinzhreplicate_i64zireplicate_29426_total_runtime /
                    (ctx->builtinzhreplicate_i64zireplicate_29426_runs !=
                     0 ? ctx->builtinzhreplicate_i64zireplicate_29426_runs : 1),
                    (long) ctx->builtinzhreplicate_i64zireplicate_29426_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhreplicate_i64zireplicate_29426_total_runtime;
        ctx->total_runs += ctx->builtinzhreplicate_i64zireplicate_29426_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32                 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_runs,
                    (long) ctx->gpu_map_transpose_f32_total_runtime /
                    (ctx->gpu_map_transpose_f32_runs !=
                     0 ? ctx->gpu_map_transpose_f32_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_total_runtime);
        ctx->total_runtime += ctx->gpu_map_transpose_f32_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32_low_height      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_low_height_runs,
                    (long) ctx->gpu_map_transpose_f32_low_height_total_runtime /
                    (ctx->gpu_map_transpose_f32_low_height_runs !=
                     0 ? ctx->gpu_map_transpose_f32_low_height_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_low_height_total_runtime);
        ctx->total_runtime +=
            ctx->gpu_map_transpose_f32_low_height_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_low_height_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32_low_width       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_low_width_runs,
                    (long) ctx->gpu_map_transpose_f32_low_width_total_runtime /
                    (ctx->gpu_map_transpose_f32_low_width_runs !=
                     0 ? ctx->gpu_map_transpose_f32_low_width_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_low_width_total_runtime);
        ctx->total_runtime +=
            ctx->gpu_map_transpose_f32_low_width_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_low_width_runs;
        str_builder(&builder,
                    "gpu_map_transpose_f32_small           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->gpu_map_transpose_f32_small_runs,
                    (long) ctx->gpu_map_transpose_f32_small_total_runtime /
                    (ctx->gpu_map_transpose_f32_small_runs !=
                     0 ? ctx->gpu_map_transpose_f32_small_runs : 1),
                    (long) ctx->gpu_map_transpose_f32_small_total_runtime);
        ctx->total_runtime += ctx->gpu_map_transpose_f32_small_total_runtime;
        ctx->total_runs += ctx->gpu_map_transpose_f32_small_runs;
        str_builder(&builder,
                    "main.scan_stage1_27426                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_27426_runs,
                    (long) ctx->mainziscan_stage1_27426_total_runtime /
                    (ctx->mainziscan_stage1_27426_runs !=
                     0 ? ctx->mainziscan_stage1_27426_runs : 1),
                    (long) ctx->mainziscan_stage1_27426_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_27426_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_27426_runs;
        str_builder(&builder,
                    "main.scan_stage1_27459                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_27459_runs,
                    (long) ctx->mainziscan_stage1_27459_total_runtime /
                    (ctx->mainziscan_stage1_27459_runs !=
                     0 ? ctx->mainziscan_stage1_27459_runs : 1),
                    (long) ctx->mainziscan_stage1_27459_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_27459_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_27459_runs;
        str_builder(&builder,
                    "main.scan_stage1_27467                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_27467_runs,
                    (long) ctx->mainziscan_stage1_27467_total_runtime /
                    (ctx->mainziscan_stage1_27467_runs !=
                     0 ? ctx->mainziscan_stage1_27467_runs : 1),
                    (long) ctx->mainziscan_stage1_27467_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_27467_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_27467_runs;
        str_builder(&builder,
                    "main.scan_stage1_27475                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_27475_runs,
                    (long) ctx->mainziscan_stage1_27475_total_runtime /
                    (ctx->mainziscan_stage1_27475_runs !=
                     0 ? ctx->mainziscan_stage1_27475_runs : 1),
                    (long) ctx->mainziscan_stage1_27475_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_27475_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_27475_runs;
        str_builder(&builder,
                    "main.scan_stage1_27527                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage1_27527_runs,
                    (long) ctx->mainziscan_stage1_27527_total_runtime /
                    (ctx->mainziscan_stage1_27527_runs !=
                     0 ? ctx->mainziscan_stage1_27527_runs : 1),
                    (long) ctx->mainziscan_stage1_27527_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage1_27527_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage1_27527_runs;
        str_builder(&builder,
                    "main.scan_stage2_27426                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_27426_runs,
                    (long) ctx->mainziscan_stage2_27426_total_runtime /
                    (ctx->mainziscan_stage2_27426_runs !=
                     0 ? ctx->mainziscan_stage2_27426_runs : 1),
                    (long) ctx->mainziscan_stage2_27426_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_27426_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_27426_runs;
        str_builder(&builder,
                    "main.scan_stage2_27459                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_27459_runs,
                    (long) ctx->mainziscan_stage2_27459_total_runtime /
                    (ctx->mainziscan_stage2_27459_runs !=
                     0 ? ctx->mainziscan_stage2_27459_runs : 1),
                    (long) ctx->mainziscan_stage2_27459_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_27459_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_27459_runs;
        str_builder(&builder,
                    "main.scan_stage2_27467                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_27467_runs,
                    (long) ctx->mainziscan_stage2_27467_total_runtime /
                    (ctx->mainziscan_stage2_27467_runs !=
                     0 ? ctx->mainziscan_stage2_27467_runs : 1),
                    (long) ctx->mainziscan_stage2_27467_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_27467_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_27467_runs;
        str_builder(&builder,
                    "main.scan_stage2_27475                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_27475_runs,
                    (long) ctx->mainziscan_stage2_27475_total_runtime /
                    (ctx->mainziscan_stage2_27475_runs !=
                     0 ? ctx->mainziscan_stage2_27475_runs : 1),
                    (long) ctx->mainziscan_stage2_27475_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_27475_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_27475_runs;
        str_builder(&builder,
                    "main.scan_stage2_27527                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage2_27527_runs,
                    (long) ctx->mainziscan_stage2_27527_total_runtime /
                    (ctx->mainziscan_stage2_27527_runs !=
                     0 ? ctx->mainziscan_stage2_27527_runs : 1),
                    (long) ctx->mainziscan_stage2_27527_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage2_27527_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage2_27527_runs;
        str_builder(&builder,
                    "main.scan_stage3_27426                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_27426_runs,
                    (long) ctx->mainziscan_stage3_27426_total_runtime /
                    (ctx->mainziscan_stage3_27426_runs !=
                     0 ? ctx->mainziscan_stage3_27426_runs : 1),
                    (long) ctx->mainziscan_stage3_27426_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_27426_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_27426_runs;
        str_builder(&builder,
                    "main.scan_stage3_27459                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_27459_runs,
                    (long) ctx->mainziscan_stage3_27459_total_runtime /
                    (ctx->mainziscan_stage3_27459_runs !=
                     0 ? ctx->mainziscan_stage3_27459_runs : 1),
                    (long) ctx->mainziscan_stage3_27459_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_27459_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_27459_runs;
        str_builder(&builder,
                    "main.scan_stage3_27467                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_27467_runs,
                    (long) ctx->mainziscan_stage3_27467_total_runtime /
                    (ctx->mainziscan_stage3_27467_runs !=
                     0 ? ctx->mainziscan_stage3_27467_runs : 1),
                    (long) ctx->mainziscan_stage3_27467_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_27467_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_27467_runs;
        str_builder(&builder,
                    "main.scan_stage3_27475                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_27475_runs,
                    (long) ctx->mainziscan_stage3_27475_total_runtime /
                    (ctx->mainziscan_stage3_27475_runs !=
                     0 ? ctx->mainziscan_stage3_27475_runs : 1),
                    (long) ctx->mainziscan_stage3_27475_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_27475_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_27475_runs;
        str_builder(&builder,
                    "main.scan_stage3_27527                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziscan_stage3_27527_runs,
                    (long) ctx->mainziscan_stage3_27527_total_runtime /
                    (ctx->mainziscan_stage3_27527_runs !=
                     0 ? ctx->mainziscan_stage3_27527_runs : 1),
                    (long) ctx->mainziscan_stage3_27527_total_runtime);
        ctx->total_runtime += ctx->mainziscan_stage3_27527_total_runtime;
        ctx->total_runs += ctx->mainziscan_stage3_27527_runs;
        str_builder(&builder,
                    "main.seghist_global_27444             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziseghist_global_27444_runs,
                    (long) ctx->mainziseghist_global_27444_total_runtime /
                    (ctx->mainziseghist_global_27444_runs !=
                     0 ? ctx->mainziseghist_global_27444_runs : 1),
                    (long) ctx->mainziseghist_global_27444_total_runtime);
        ctx->total_runtime += ctx->mainziseghist_global_27444_total_runtime;
        ctx->total_runs += ctx->mainziseghist_global_27444_runs;
        str_builder(&builder,
                    "main.seghist_local_27444              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainziseghist_local_27444_runs,
                    (long) ctx->mainziseghist_local_27444_total_runtime /
                    (ctx->mainziseghist_local_27444_runs !=
                     0 ? ctx->mainziseghist_local_27444_runs : 1),
                    (long) ctx->mainziseghist_local_27444_total_runtime);
        ctx->total_runtime += ctx->mainziseghist_local_27444_total_runtime;
        ctx->total_runs += ctx->mainziseghist_local_27444_runs;
        str_builder(&builder,
                    "main.segmap_26596                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_26596_runs,
                    (long) ctx->mainzisegmap_26596_total_runtime /
                    (ctx->mainzisegmap_26596_runs !=
                     0 ? ctx->mainzisegmap_26596_runs : 1),
                    (long) ctx->mainzisegmap_26596_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_26596_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_26596_runs;
        str_builder(&builder,
                    "main.segmap_26772                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_26772_runs,
                    (long) ctx->mainzisegmap_26772_total_runtime /
                    (ctx->mainzisegmap_26772_runs !=
                     0 ? ctx->mainzisegmap_26772_runs : 1),
                    (long) ctx->mainzisegmap_26772_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_26772_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_26772_runs;
        str_builder(&builder,
                    "main.segmap_27071                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_27071_runs,
                    (long) ctx->mainzisegmap_27071_total_runtime /
                    (ctx->mainzisegmap_27071_runs !=
                     0 ? ctx->mainzisegmap_27071_runs : 1),
                    (long) ctx->mainzisegmap_27071_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_27071_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_27071_runs;
        str_builder(&builder,
                    "main.segmap_27169                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_27169_runs,
                    (long) ctx->mainzisegmap_27169_total_runtime /
                    (ctx->mainzisegmap_27169_runs !=
                     0 ? ctx->mainzisegmap_27169_runs : 1),
                    (long) ctx->mainzisegmap_27169_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_27169_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_27169_runs;
        str_builder(&builder,
                    "main.segmap_27233                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_27233_runs,
                    (long) ctx->mainzisegmap_27233_total_runtime /
                    (ctx->mainzisegmap_27233_runs !=
                     0 ? ctx->mainzisegmap_27233_runs : 1),
                    (long) ctx->mainzisegmap_27233_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_27233_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_27233_runs;
        str_builder(&builder,
                    "main.segmap_27529                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_27529_runs,
                    (long) ctx->mainzisegmap_27529_total_runtime /
                    (ctx->mainzisegmap_27529_runs !=
                     0 ? ctx->mainzisegmap_27529_runs : 1),
                    (long) ctx->mainzisegmap_27529_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_27529_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_27529_runs;
        str_builder(&builder,
                    "main.segmap_27567                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_27567_runs,
                    (long) ctx->mainzisegmap_27567_total_runtime /
                    (ctx->mainzisegmap_27567_runs !=
                     0 ? ctx->mainzisegmap_27567_runs : 1),
                    (long) ctx->mainzisegmap_27567_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_27567_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_27567_runs;
        str_builder(&builder,
                    "main.segmap_27592                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegmap_27592_runs,
                    (long) ctx->mainzisegmap_27592_total_runtime /
                    (ctx->mainzisegmap_27592_runs !=
                     0 ? ctx->mainzisegmap_27592_runs : 1),
                    (long) ctx->mainzisegmap_27592_total_runtime);
        ctx->total_runtime += ctx->mainzisegmap_27592_total_runtime;
        ctx->total_runs += ctx->mainzisegmap_27592_runs;
        str_builder(&builder,
                    "main.segred_large_27608               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_large_27608_runs,
                    (long) ctx->mainzisegred_large_27608_total_runtime /
                    (ctx->mainzisegred_large_27608_runs !=
                     0 ? ctx->mainzisegred_large_27608_runs : 1),
                    (long) ctx->mainzisegred_large_27608_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_large_27608_total_runtime;
        ctx->total_runs += ctx->mainzisegred_large_27608_runs;
        str_builder(&builder,
                    "main.segred_large_29517               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_large_29517_runs,
                    (long) ctx->mainzisegred_large_29517_total_runtime /
                    (ctx->mainzisegred_large_29517_runs !=
                     0 ? ctx->mainzisegred_large_29517_runs : 1),
                    (long) ctx->mainzisegred_large_29517_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_large_29517_total_runtime;
        ctx->total_runs += ctx->mainzisegred_large_29517_runs;
        str_builder(&builder,
                    "main.segred_nonseg_26582              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_26582_runs,
                    (long) ctx->mainzisegred_nonseg_26582_total_runtime /
                    (ctx->mainzisegred_nonseg_26582_runs !=
                     0 ? ctx->mainzisegred_nonseg_26582_runs : 1),
                    (long) ctx->mainzisegred_nonseg_26582_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_26582_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_26582_runs;
        str_builder(&builder,
                    "main.segred_nonseg_27436              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_27436_runs,
                    (long) ctx->mainzisegred_nonseg_27436_total_runtime /
                    (ctx->mainzisegred_nonseg_27436_runs !=
                     0 ? ctx->mainzisegred_nonseg_27436_runs : 1),
                    (long) ctx->mainzisegred_nonseg_27436_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_27436_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_27436_runs;
        str_builder(&builder,
                    "main.segred_nonseg_27545              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_27545_runs,
                    (long) ctx->mainzisegred_nonseg_27545_total_runtime /
                    (ctx->mainzisegred_nonseg_27545_runs !=
                     0 ? ctx->mainzisegred_nonseg_27545_runs : 1),
                    (long) ctx->mainzisegred_nonseg_27545_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_27545_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_27545_runs;
        str_builder(&builder,
                    "main.segred_nonseg_27641              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_27641_runs,
                    (long) ctx->mainzisegred_nonseg_27641_total_runtime /
                    (ctx->mainzisegred_nonseg_27641_runs !=
                     0 ? ctx->mainzisegred_nonseg_27641_runs : 1),
                    (long) ctx->mainzisegred_nonseg_27641_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_27641_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_27641_runs;
        str_builder(&builder,
                    "main.segred_nonseg_29056              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_29056_runs,
                    (long) ctx->mainzisegred_nonseg_29056_total_runtime /
                    (ctx->mainzisegred_nonseg_29056_runs !=
                     0 ? ctx->mainzisegred_nonseg_29056_runs : 1),
                    (long) ctx->mainzisegred_nonseg_29056_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_29056_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_29056_runs;
        str_builder(&builder,
                    "main.segred_nonseg_29088              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_nonseg_29088_runs,
                    (long) ctx->mainzisegred_nonseg_29088_total_runtime /
                    (ctx->mainzisegred_nonseg_29088_runs !=
                     0 ? ctx->mainzisegred_nonseg_29088_runs : 1),
                    (long) ctx->mainzisegred_nonseg_29088_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_nonseg_29088_total_runtime;
        ctx->total_runs += ctx->mainzisegred_nonseg_29088_runs;
        str_builder(&builder,
                    "main.segred_small_27608               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_small_27608_runs,
                    (long) ctx->mainzisegred_small_27608_total_runtime /
                    (ctx->mainzisegred_small_27608_runs !=
                     0 ? ctx->mainzisegred_small_27608_runs : 1),
                    (long) ctx->mainzisegred_small_27608_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_small_27608_total_runtime;
        ctx->total_runs += ctx->mainzisegred_small_27608_runs;
        str_builder(&builder,
                    "main.segred_small_29517               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->mainzisegred_small_29517_runs,
                    (long) ctx->mainzisegred_small_29517_total_runtime /
                    (ctx->mainzisegred_small_29517_runs !=
                     0 ? ctx->mainzisegred_small_29517_runs : 1),
                    (long) ctx->mainzisegred_small_29517_total_runtime);
        ctx->total_runtime += ctx->mainzisegred_small_29517_total_runtime;
        ctx->total_runs += ctx->mainzisegred_small_29517_runs;
        str_builder(&builder,
                    "test.scan_stage1_28535                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_28535_runs,
                    (long) ctx->testziscan_stage1_28535_total_runtime /
                    (ctx->testziscan_stage1_28535_runs !=
                     0 ? ctx->testziscan_stage1_28535_runs : 1),
                    (long) ctx->testziscan_stage1_28535_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_28535_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_28535_runs;
        str_builder(&builder,
                    "test.scan_stage1_28568                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_28568_runs,
                    (long) ctx->testziscan_stage1_28568_total_runtime /
                    (ctx->testziscan_stage1_28568_runs !=
                     0 ? ctx->testziscan_stage1_28568_runs : 1),
                    (long) ctx->testziscan_stage1_28568_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_28568_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_28568_runs;
        str_builder(&builder,
                    "test.scan_stage1_28576                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_28576_runs,
                    (long) ctx->testziscan_stage1_28576_total_runtime /
                    (ctx->testziscan_stage1_28576_runs !=
                     0 ? ctx->testziscan_stage1_28576_runs : 1),
                    (long) ctx->testziscan_stage1_28576_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_28576_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_28576_runs;
        str_builder(&builder,
                    "test.scan_stage1_28584                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_28584_runs,
                    (long) ctx->testziscan_stage1_28584_total_runtime /
                    (ctx->testziscan_stage1_28584_runs !=
                     0 ? ctx->testziscan_stage1_28584_runs : 1),
                    (long) ctx->testziscan_stage1_28584_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_28584_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_28584_runs;
        str_builder(&builder,
                    "test.scan_stage1_28636                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage1_28636_runs,
                    (long) ctx->testziscan_stage1_28636_total_runtime /
                    (ctx->testziscan_stage1_28636_runs !=
                     0 ? ctx->testziscan_stage1_28636_runs : 1),
                    (long) ctx->testziscan_stage1_28636_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage1_28636_total_runtime;
        ctx->total_runs += ctx->testziscan_stage1_28636_runs;
        str_builder(&builder,
                    "test.scan_stage2_28535                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_28535_runs,
                    (long) ctx->testziscan_stage2_28535_total_runtime /
                    (ctx->testziscan_stage2_28535_runs !=
                     0 ? ctx->testziscan_stage2_28535_runs : 1),
                    (long) ctx->testziscan_stage2_28535_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_28535_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_28535_runs;
        str_builder(&builder,
                    "test.scan_stage2_28568                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_28568_runs,
                    (long) ctx->testziscan_stage2_28568_total_runtime /
                    (ctx->testziscan_stage2_28568_runs !=
                     0 ? ctx->testziscan_stage2_28568_runs : 1),
                    (long) ctx->testziscan_stage2_28568_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_28568_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_28568_runs;
        str_builder(&builder,
                    "test.scan_stage2_28576                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_28576_runs,
                    (long) ctx->testziscan_stage2_28576_total_runtime /
                    (ctx->testziscan_stage2_28576_runs !=
                     0 ? ctx->testziscan_stage2_28576_runs : 1),
                    (long) ctx->testziscan_stage2_28576_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_28576_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_28576_runs;
        str_builder(&builder,
                    "test.scan_stage2_28584                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_28584_runs,
                    (long) ctx->testziscan_stage2_28584_total_runtime /
                    (ctx->testziscan_stage2_28584_runs !=
                     0 ? ctx->testziscan_stage2_28584_runs : 1),
                    (long) ctx->testziscan_stage2_28584_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_28584_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_28584_runs;
        str_builder(&builder,
                    "test.scan_stage2_28636                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage2_28636_runs,
                    (long) ctx->testziscan_stage2_28636_total_runtime /
                    (ctx->testziscan_stage2_28636_runs !=
                     0 ? ctx->testziscan_stage2_28636_runs : 1),
                    (long) ctx->testziscan_stage2_28636_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage2_28636_total_runtime;
        ctx->total_runs += ctx->testziscan_stage2_28636_runs;
        str_builder(&builder,
                    "test.scan_stage3_28535                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_28535_runs,
                    (long) ctx->testziscan_stage3_28535_total_runtime /
                    (ctx->testziscan_stage3_28535_runs !=
                     0 ? ctx->testziscan_stage3_28535_runs : 1),
                    (long) ctx->testziscan_stage3_28535_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_28535_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_28535_runs;
        str_builder(&builder,
                    "test.scan_stage3_28568                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_28568_runs,
                    (long) ctx->testziscan_stage3_28568_total_runtime /
                    (ctx->testziscan_stage3_28568_runs !=
                     0 ? ctx->testziscan_stage3_28568_runs : 1),
                    (long) ctx->testziscan_stage3_28568_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_28568_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_28568_runs;
        str_builder(&builder,
                    "test.scan_stage3_28576                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_28576_runs,
                    (long) ctx->testziscan_stage3_28576_total_runtime /
                    (ctx->testziscan_stage3_28576_runs !=
                     0 ? ctx->testziscan_stage3_28576_runs : 1),
                    (long) ctx->testziscan_stage3_28576_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_28576_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_28576_runs;
        str_builder(&builder,
                    "test.scan_stage3_28584                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_28584_runs,
                    (long) ctx->testziscan_stage3_28584_total_runtime /
                    (ctx->testziscan_stage3_28584_runs !=
                     0 ? ctx->testziscan_stage3_28584_runs : 1),
                    (long) ctx->testziscan_stage3_28584_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_28584_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_28584_runs;
        str_builder(&builder,
                    "test.scan_stage3_28636                ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziscan_stage3_28636_runs,
                    (long) ctx->testziscan_stage3_28636_total_runtime /
                    (ctx->testziscan_stage3_28636_runs !=
                     0 ? ctx->testziscan_stage3_28636_runs : 1),
                    (long) ctx->testziscan_stage3_28636_total_runtime);
        ctx->total_runtime += ctx->testziscan_stage3_28636_total_runtime;
        ctx->total_runs += ctx->testziscan_stage3_28636_runs;
        str_builder(&builder,
                    "test.seghist_global_28553             ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziseghist_global_28553_runs,
                    (long) ctx->testziseghist_global_28553_total_runtime /
                    (ctx->testziseghist_global_28553_runs !=
                     0 ? ctx->testziseghist_global_28553_runs : 1),
                    (long) ctx->testziseghist_global_28553_total_runtime);
        ctx->total_runtime += ctx->testziseghist_global_28553_total_runtime;
        ctx->total_runs += ctx->testziseghist_global_28553_runs;
        str_builder(&builder,
                    "test.seghist_local_28553              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testziseghist_local_28553_runs,
                    (long) ctx->testziseghist_local_28553_total_runtime /
                    (ctx->testziseghist_local_28553_runs !=
                     0 ? ctx->testziseghist_local_28553_runs : 1),
                    (long) ctx->testziseghist_local_28553_total_runtime);
        ctx->total_runtime += ctx->testziseghist_local_28553_total_runtime;
        ctx->total_runs += ctx->testziseghist_local_28553_runs;
        str_builder(&builder,
                    "test.segmap_27708                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_27708_runs,
                    (long) ctx->testzisegmap_27708_total_runtime /
                    (ctx->testzisegmap_27708_runs !=
                     0 ? ctx->testzisegmap_27708_runs : 1),
                    (long) ctx->testzisegmap_27708_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_27708_total_runtime;
        ctx->total_runs += ctx->testzisegmap_27708_runs;
        str_builder(&builder,
                    "test.segmap_27884                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_27884_runs,
                    (long) ctx->testzisegmap_27884_total_runtime /
                    (ctx->testzisegmap_27884_runs !=
                     0 ? ctx->testzisegmap_27884_runs : 1),
                    (long) ctx->testzisegmap_27884_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_27884_total_runtime;
        ctx->total_runs += ctx->testzisegmap_27884_runs;
        str_builder(&builder,
                    "test.segmap_28183                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_28183_runs,
                    (long) ctx->testzisegmap_28183_total_runtime /
                    (ctx->testzisegmap_28183_runs !=
                     0 ? ctx->testzisegmap_28183_runs : 1),
                    (long) ctx->testzisegmap_28183_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_28183_total_runtime;
        ctx->total_runs += ctx->testzisegmap_28183_runs;
        str_builder(&builder,
                    "test.segmap_28281                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_28281_runs,
                    (long) ctx->testzisegmap_28281_total_runtime /
                    (ctx->testzisegmap_28281_runs !=
                     0 ? ctx->testzisegmap_28281_runs : 1),
                    (long) ctx->testzisegmap_28281_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_28281_total_runtime;
        ctx->total_runs += ctx->testzisegmap_28281_runs;
        str_builder(&builder,
                    "test.segmap_28345                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_28345_runs,
                    (long) ctx->testzisegmap_28345_total_runtime /
                    (ctx->testzisegmap_28345_runs !=
                     0 ? ctx->testzisegmap_28345_runs : 1),
                    (long) ctx->testzisegmap_28345_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_28345_total_runtime;
        ctx->total_runs += ctx->testzisegmap_28345_runs;
        str_builder(&builder,
                    "test.segmap_28638                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_28638_runs,
                    (long) ctx->testzisegmap_28638_total_runtime /
                    (ctx->testzisegmap_28638_runs !=
                     0 ? ctx->testzisegmap_28638_runs : 1),
                    (long) ctx->testzisegmap_28638_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_28638_total_runtime;
        ctx->total_runs += ctx->testzisegmap_28638_runs;
        str_builder(&builder,
                    "test.segmap_28676                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_28676_runs,
                    (long) ctx->testzisegmap_28676_total_runtime /
                    (ctx->testzisegmap_28676_runs !=
                     0 ? ctx->testzisegmap_28676_runs : 1),
                    (long) ctx->testzisegmap_28676_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_28676_total_runtime;
        ctx->total_runs += ctx->testzisegmap_28676_runs;
        str_builder(&builder,
                    "test.segmap_28701                     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegmap_28701_runs,
                    (long) ctx->testzisegmap_28701_total_runtime /
                    (ctx->testzisegmap_28701_runs !=
                     0 ? ctx->testzisegmap_28701_runs : 1),
                    (long) ctx->testzisegmap_28701_total_runtime);
        ctx->total_runtime += ctx->testzisegmap_28701_total_runtime;
        ctx->total_runs += ctx->testzisegmap_28701_runs;
        str_builder(&builder,
                    "test.segred_large_28717               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_large_28717_runs,
                    (long) ctx->testzisegred_large_28717_total_runtime /
                    (ctx->testzisegred_large_28717_runs !=
                     0 ? ctx->testzisegred_large_28717_runs : 1),
                    (long) ctx->testzisegred_large_28717_total_runtime);
        ctx->total_runtime += ctx->testzisegred_large_28717_total_runtime;
        ctx->total_runs += ctx->testzisegred_large_28717_runs;
        str_builder(&builder,
                    "test.segred_large_29517               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_large_29517_runs,
                    (long) ctx->testzisegred_large_29517_total_runtime /
                    (ctx->testzisegred_large_29517_runs !=
                     0 ? ctx->testzisegred_large_29517_runs : 1),
                    (long) ctx->testzisegred_large_29517_total_runtime);
        ctx->total_runtime += ctx->testzisegred_large_29517_total_runtime;
        ctx->total_runs += ctx->testzisegred_large_29517_runs;
        str_builder(&builder,
                    "test.segred_nonseg_27694              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_27694_runs,
                    (long) ctx->testzisegred_nonseg_27694_total_runtime /
                    (ctx->testzisegred_nonseg_27694_runs !=
                     0 ? ctx->testzisegred_nonseg_27694_runs : 1),
                    (long) ctx->testzisegred_nonseg_27694_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_27694_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_27694_runs;
        str_builder(&builder,
                    "test.segred_nonseg_28545              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_28545_runs,
                    (long) ctx->testzisegred_nonseg_28545_total_runtime /
                    (ctx->testzisegred_nonseg_28545_runs !=
                     0 ? ctx->testzisegred_nonseg_28545_runs : 1),
                    (long) ctx->testzisegred_nonseg_28545_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_28545_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_28545_runs;
        str_builder(&builder,
                    "test.segred_nonseg_28654              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_28654_runs,
                    (long) ctx->testzisegred_nonseg_28654_total_runtime /
                    (ctx->testzisegred_nonseg_28654_runs !=
                     0 ? ctx->testzisegred_nonseg_28654_runs : 1),
                    (long) ctx->testzisegred_nonseg_28654_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_28654_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_28654_runs;
        str_builder(&builder,
                    "test.segred_nonseg_28750              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_28750_runs,
                    (long) ctx->testzisegred_nonseg_28750_total_runtime /
                    (ctx->testzisegred_nonseg_28750_runs !=
                     0 ? ctx->testzisegred_nonseg_28750_runs : 1),
                    (long) ctx->testzisegred_nonseg_28750_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_28750_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_28750_runs;
        str_builder(&builder,
                    "test.segred_nonseg_29138              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_29138_runs,
                    (long) ctx->testzisegred_nonseg_29138_total_runtime /
                    (ctx->testzisegred_nonseg_29138_runs !=
                     0 ? ctx->testzisegred_nonseg_29138_runs : 1),
                    (long) ctx->testzisegred_nonseg_29138_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_29138_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_29138_runs;
        str_builder(&builder,
                    "test.segred_nonseg_29170              ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_nonseg_29170_runs,
                    (long) ctx->testzisegred_nonseg_29170_total_runtime /
                    (ctx->testzisegred_nonseg_29170_runs !=
                     0 ? ctx->testzisegred_nonseg_29170_runs : 1),
                    (long) ctx->testzisegred_nonseg_29170_total_runtime);
        ctx->total_runtime += ctx->testzisegred_nonseg_29170_total_runtime;
        ctx->total_runs += ctx->testzisegred_nonseg_29170_runs;
        str_builder(&builder,
                    "test.segred_small_28717               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_small_28717_runs,
                    (long) ctx->testzisegred_small_28717_total_runtime /
                    (ctx->testzisegred_small_28717_runs !=
                     0 ? ctx->testzisegred_small_28717_runs : 1),
                    (long) ctx->testzisegred_small_28717_total_runtime);
        ctx->total_runtime += ctx->testzisegred_small_28717_total_runtime;
        ctx->total_runs += ctx->testzisegred_small_28717_runs;
        str_builder(&builder,
                    "test.segred_small_29517               ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->testzisegred_small_29517_runs,
                    (long) ctx->testzisegred_small_29517_total_runtime /
                    (ctx->testzisegred_small_29517_runs !=
                     0 ? ctx->testzisegred_small_29517_runs : 1),
                    (long) ctx->testzisegred_small_29517_total_runtime);
        ctx->total_runtime += ctx->testzisegred_small_29517_total_runtime;
        ctx->total_runs += ctx->testzisegred_small_29517_runs;
        str_builder(&builder, "%d operations with cumulative runtime: %6ldus\n",
                    ctx->total_runs, ctx->total_runtime);
    }
    return builder.str;
}
char *futhark_context_get_error(struct futhark_context *ctx)
{
    char *error = ctx->error;
    
    ctx->error = NULL;
    return error;
}
void futhark_context_pause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 1;
}
void futhark_context_unpause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 0;
}
static int futrts_builtinzhgpu_map_transpose_f32(struct futhark_context *ctx,
                                                 struct memblock_device destmem_0,
                                                 int32_t destoffset_1,
                                                 struct memblock_device srcmem_2,
                                                 int32_t srcoffset_3,
                                                 int32_t num_arrays_4,
                                                 int32_t x_elems_5,
                                                 int32_t y_elems_6);
static int futrts_builtinzhreplicate_f32(struct futhark_context *ctx,
                                         struct memblock_device mem_29830,
                                         int32_t num_elems_29831,
                                         float val_29832);
static int futrts_builtinzhreplicate_i64(struct futhark_context *ctx,
                                         struct memblock_device mem_29422,
                                         int32_t num_elems_29423,
                                         int64_t val_29424);
static int futrts_main(struct futhark_context *ctx, float *out_scalar_out_30008,
                       struct memblock_device *out_mem_p_30009,
                       int64_t *out_out_arrsizze_30010,
                       struct memblock_device swap_term_mem_28878,
                       struct memblock_device payments_mem_28879,
                       struct memblock_device notional_mem_28880,
                       int64_t n_25418, int64_t n_25419, int64_t n_25420,
                       int64_t paths_25421, int64_t steps_25422, float a_25426,
                       float b_25427, float sigma_25428, float r0_25429);
static int futrts_test(struct futhark_context *ctx, float *out_scalar_out_30203,
                       int64_t paths_26135, int64_t steps_26136);
int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    
  cleanup:
    return err;
}
int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    return 0;
}
static int futrts_builtinzhgpu_map_transpose_f32(struct futhark_context *ctx,
                                                 struct memblock_device destmem_0,
                                                 int32_t destoffset_1,
                                                 struct memblock_device srcmem_2,
                                                 int32_t srcoffset_3,
                                                 int32_t num_arrays_4,
                                                 int32_t x_elems_5,
                                                 int32_t y_elems_6)
{
    (void) ctx;
    
    int err = 0;
    
    if (!(num_arrays_4 == 0 || (x_elems_5 == 0 || y_elems_6 == 0))) {
        int32_t muly_8 = squot32(16, x_elems_5);
        int32_t mulx_7 = squot32(16, y_elems_6);
        
        if (num_arrays_4 == 1 && (x_elems_5 == 1 || y_elems_6 == 1)) {
            if (sext_i32_i64(x_elems_5 * y_elems_6 * (int32_t) sizeof(float)) >
                0) {
                OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                             srcmem_2.mem,
                                                             destmem_0.mem,
                                                             sext_i32_i64(srcoffset_3),
                                                             sext_i32_i64(destoffset_1),
                                                             sext_i32_i64(x_elems_5 *
                                                             y_elems_6 *
                                                             (int32_t) sizeof(float)),
                                                             0, NULL,
                                                             ctx->profiling_paused ||
                                                             !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                       &ctx->copy_dev_to_dev_runs,
                                                                                                       &ctx->copy_dev_to_dev_total_runtime)));
                if (ctx->debugging)
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            }
        } else {
            if (sle32(x_elems_5, 8) && slt32(16, y_elems_6)) {
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        0, 1088, NULL));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        1, sizeof(destoffset_1),
                                                        &destoffset_1));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        2, sizeof(srcoffset_3),
                                                        &srcoffset_3));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        3, sizeof(num_arrays_4),
                                                        &num_arrays_4));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        4, sizeof(x_elems_5),
                                                        &x_elems_5));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        5, sizeof(y_elems_6),
                                                        &y_elems_6));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        6, sizeof(mulx_7),
                                                        &mulx_7));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        7, sizeof(muly_8),
                                                        &muly_8));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        8,
                                                        sizeof(destmem_0.mem),
                                                        &destmem_0.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_width,
                                                        9, sizeof(srcmem_2.mem),
                                                        &srcmem_2.mem));
                if (1 * ((size_t) sdiv_up32(x_elems_5, 16) * (size_t) 16) *
                    ((size_t) sdiv_up32(sdiv_up32(y_elems_6, muly_8), 16) *
                     (size_t) 16) * ((size_t) num_arrays_4 * (size_t) 1) != 0) {
                    const size_t global_work_sizze_29978[3] =
                                 {(size_t) sdiv_up32(x_elems_5, 16) *
                                  (size_t) 16,
                                  (size_t) sdiv_up32(sdiv_up32(y_elems_6,
                                                               muly_8), 16) *
                                  (size_t) 16, (size_t) num_arrays_4 *
                                  (size_t) 1};
                    const size_t local_work_sizze_29982[3] = {16, 16, 1};
                    int64_t time_start_29979 = 0, time_end_29980 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "gpu_map_transpose_f32_low_width");
                        fprintf(stderr, "%zu", global_work_sizze_29978[0]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", global_work_sizze_29978[1]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", global_work_sizze_29978[2]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_29982[0]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", local_work_sizze_29982[1]);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%zu", local_work_sizze_29982[2]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) (0 + 1088));
                        time_start_29979 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->gpu_map_transpose_f32_low_width,
                                                                    3, NULL,
                                                                    global_work_sizze_29978,
                                                                    local_work_sizze_29982,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->gpu_map_transpose_f32_low_width_runs,
                                                                                                              &ctx->gpu_map_transpose_f32_low_width_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_29980 = get_wall_time();
                        
                        long time_diff_29981 = time_end_29980 -
                             time_start_29979;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "gpu_map_transpose_f32_low_width",
                                time_diff_29981);
                    }
                }
            } else {
                if (sle32(y_elems_6, 8) && slt32(16, x_elems_5)) {
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            0, 1088, NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            1,
                                                            sizeof(destoffset_1),
                                                            &destoffset_1));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            2,
                                                            sizeof(srcoffset_3),
                                                            &srcoffset_3));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            3,
                                                            sizeof(num_arrays_4),
                                                            &num_arrays_4));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            4,
                                                            sizeof(x_elems_5),
                                                            &x_elems_5));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            5,
                                                            sizeof(y_elems_6),
                                                            &y_elems_6));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            6, sizeof(mulx_7),
                                                            &mulx_7));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            7, sizeof(muly_8),
                                                            &muly_8));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            8,
                                                            sizeof(destmem_0.mem),
                                                            &destmem_0.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_low_height,
                                                            9,
                                                            sizeof(srcmem_2.mem),
                                                            &srcmem_2.mem));
                    if (1 * ((size_t) sdiv_up32(sdiv_up32(x_elems_5, mulx_7),
                                                16) * (size_t) 16) *
                        ((size_t) sdiv_up32(y_elems_6, 16) * (size_t) 16) *
                        ((size_t) num_arrays_4 * (size_t) 1) != 0) {
                        const size_t global_work_sizze_29983[3] =
                                     {(size_t) sdiv_up32(sdiv_up32(x_elems_5,
                                                                   mulx_7),
                                                         16) * (size_t) 16,
                                      (size_t) sdiv_up32(y_elems_6, 16) *
                                      (size_t) 16, (size_t) num_arrays_4 *
                                      (size_t) 1};
                        const size_t local_work_sizze_29987[3] = {16, 16, 1};
                        int64_t time_start_29984 = 0, time_end_29985 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "gpu_map_transpose_f32_low_height");
                            fprintf(stderr, "%zu", global_work_sizze_29983[0]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", global_work_sizze_29983[1]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", global_work_sizze_29983[2]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_29987[0]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", local_work_sizze_29987[1]);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%zu", local_work_sizze_29987[2]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + 1088));
                            time_start_29984 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->gpu_map_transpose_f32_low_height,
                                                                        3, NULL,
                                                                        global_work_sizze_29983,
                                                                        local_work_sizze_29987,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->gpu_map_transpose_f32_low_height_runs,
                                                                                                                  &ctx->gpu_map_transpose_f32_low_height_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_29985 = get_wall_time();
                            
                            long time_diff_29986 = time_end_29985 -
                                 time_start_29984;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "gpu_map_transpose_f32_low_height",
                                    time_diff_29986);
                        }
                    }
                } else {
                    if (sle32(x_elems_5, 8) && sle32(y_elems_6, 8)) {
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                0, 1, NULL));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                1,
                                                                sizeof(destoffset_1),
                                                                &destoffset_1));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                2,
                                                                sizeof(srcoffset_3),
                                                                &srcoffset_3));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                3,
                                                                sizeof(num_arrays_4),
                                                                &num_arrays_4));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                4,
                                                                sizeof(x_elems_5),
                                                                &x_elems_5));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                5,
                                                                sizeof(y_elems_6),
                                                                &y_elems_6));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                6,
                                                                sizeof(mulx_7),
                                                                &mulx_7));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                7,
                                                                sizeof(muly_8),
                                                                &muly_8));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                8,
                                                                sizeof(destmem_0.mem),
                                                                &destmem_0.mem));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32_small,
                                                                9,
                                                                sizeof(srcmem_2.mem),
                                                                &srcmem_2.mem));
                        if (1 * ((size_t) sdiv_up32(num_arrays_4 * x_elems_5 *
                                                    y_elems_6, 256) *
                                 (size_t) 256) != 0) {
                            const size_t global_work_sizze_29988[1] =
                                         {(size_t) sdiv_up32(num_arrays_4 *
                                                             x_elems_5 *
                                                             y_elems_6, 256) *
                                         (size_t) 256};
                            const size_t local_work_sizze_29992[1] = {256};
                            int64_t time_start_29989 = 0, time_end_29990 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(stderr,
                                        "Launching %s with global work size [",
                                        "gpu_map_transpose_f32_small");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_29988[0]);
                                fprintf(stderr, "] and local work size [");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_29992[0]);
                                fprintf(stderr,
                                        "]; local memory parameters sum to %d bytes.\n",
                                        (int) (0 + 1));
                                time_start_29989 = get_wall_time();
                            }
                            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                            ctx->gpu_map_transpose_f32_small,
                                                                            1,
                                                                            NULL,
                                                                            global_work_sizze_29988,
                                                                            local_work_sizze_29992,
                                                                            0,
                                                                            NULL,
                                                                            ctx->profiling_paused ||
                                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                      &ctx->gpu_map_transpose_f32_small_runs,
                                                                                                                      &ctx->gpu_map_transpose_f32_small_total_runtime)));
                            if (ctx->debugging) {
                                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                                time_end_29990 = get_wall_time();
                                
                                long time_diff_29991 = time_end_29990 -
                                     time_start_29989;
                                
                                fprintf(stderr, "kernel %s runtime: %ldus\n",
                                        "gpu_map_transpose_f32_small",
                                        time_diff_29991);
                            }
                        }
                    } else {
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                0, 4224, NULL));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                1,
                                                                sizeof(destoffset_1),
                                                                &destoffset_1));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                2,
                                                                sizeof(srcoffset_3),
                                                                &srcoffset_3));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                3,
                                                                sizeof(num_arrays_4),
                                                                &num_arrays_4));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                4,
                                                                sizeof(x_elems_5),
                                                                &x_elems_5));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                5,
                                                                sizeof(y_elems_6),
                                                                &y_elems_6));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                6,
                                                                sizeof(mulx_7),
                                                                &mulx_7));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                7,
                                                                sizeof(muly_8),
                                                                &muly_8));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                8,
                                                                sizeof(destmem_0.mem),
                                                                &destmem_0.mem));
                        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->gpu_map_transpose_f32,
                                                                9,
                                                                sizeof(srcmem_2.mem),
                                                                &srcmem_2.mem));
                        if (1 * ((size_t) sdiv_up32(x_elems_5, 32) *
                                 (size_t) 32) * ((size_t) sdiv_up32(y_elems_6,
                                                                    32) *
                                                 (size_t) 8) *
                            ((size_t) num_arrays_4 * (size_t) 1) != 0) {
                            const size_t global_work_sizze_29993[3] =
                                         {(size_t) sdiv_up32(x_elems_5, 32) *
                                          (size_t) 32,
                                          (size_t) sdiv_up32(y_elems_6, 32) *
                                          (size_t) 8, (size_t) num_arrays_4 *
                                          (size_t) 1};
                            const size_t local_work_sizze_29997[3] = {32, 8, 1};
                            int64_t time_start_29994 = 0, time_end_29995 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(stderr,
                                        "Launching %s with global work size [",
                                        "gpu_map_transpose_f32");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_29993[0]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_29993[1]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        global_work_sizze_29993[2]);
                                fprintf(stderr, "] and local work size [");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_29997[0]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_29997[1]);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%zu",
                                        local_work_sizze_29997[2]);
                                fprintf(stderr,
                                        "]; local memory parameters sum to %d bytes.\n",
                                        (int) (0 + 4224));
                                time_start_29994 = get_wall_time();
                            }
                            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                            ctx->gpu_map_transpose_f32,
                                                                            3,
                                                                            NULL,
                                                                            global_work_sizze_29993,
                                                                            local_work_sizze_29997,
                                                                            0,
                                                                            NULL,
                                                                            ctx->profiling_paused ||
                                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                      &ctx->gpu_map_transpose_f32_runs,
                                                                                                                      &ctx->gpu_map_transpose_f32_total_runtime)));
                            if (ctx->debugging) {
                                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                                time_end_29995 = get_wall_time();
                                
                                long time_diff_29996 = time_end_29995 -
                                     time_start_29994;
                                
                                fprintf(stderr, "kernel %s runtime: %ldus\n",
                                        "gpu_map_transpose_f32",
                                        time_diff_29996);
                            }
                        }
                    }
                }
            }
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_builtinzhreplicate_f32(struct futhark_context *ctx,
                                         struct memblock_device mem_29830,
                                         int32_t num_elems_29831,
                                         float val_29832)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_29837;
    
    group_sizze_29837 = ctx->sizes.builtinzhreplicate_f32zigroup_sizze_29837;
    
    int64_t num_groups_29838;
    
    num_groups_29838 = sdiv_up64(num_elems_29831, group_sizze_29837);
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_f32zireplicate_29834,
                                            0, sizeof(mem_29830.mem),
                                            &mem_29830.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_f32zireplicate_29834,
                                            1, sizeof(num_elems_29831),
                                            &num_elems_29831));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_f32zireplicate_29834,
                                            2, sizeof(val_29832), &val_29832));
    if (1 * ((size_t) num_groups_29838 * (size_t) group_sizze_29837) != 0) {
        const size_t global_work_sizze_29998[1] = {(size_t) num_groups_29838 *
                     (size_t) group_sizze_29837};
        const size_t local_work_sizze_30002[1] = {group_sizze_29837};
        int64_t time_start_29999 = 0, time_end_30000 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "builtin#replicate_f32.replicate_29834");
            fprintf(stderr, "%zu", global_work_sizze_29998[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_30002[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_29999 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->builtinzhreplicate_f32zireplicate_29834,
                                                        1, NULL,
                                                        global_work_sizze_29998,
                                                        local_work_sizze_30002,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->builtinzhreplicate_f32zireplicate_29834_runs,
                                                                                                  &ctx->builtinzhreplicate_f32zireplicate_29834_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_30000 = get_wall_time();
            
            long time_diff_30001 = time_end_30000 - time_start_29999;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "builtin#replicate_f32.replicate_29834", time_diff_30001);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_builtinzhreplicate_i64(struct futhark_context *ctx,
                                         struct memblock_device mem_29422,
                                         int32_t num_elems_29423,
                                         int64_t val_29424)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_29429;
    
    group_sizze_29429 = ctx->sizes.builtinzhreplicate_i64zigroup_sizze_29429;
    
    int64_t num_groups_29430;
    
    num_groups_29430 = sdiv_up64(num_elems_29423, group_sizze_29429);
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_i64zireplicate_29426,
                                            0, sizeof(mem_29422.mem),
                                            &mem_29422.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_i64zireplicate_29426,
                                            1, sizeof(num_elems_29423),
                                            &num_elems_29423));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->builtinzhreplicate_i64zireplicate_29426,
                                            2, sizeof(val_29424), &val_29424));
    if (1 * ((size_t) num_groups_29430 * (size_t) group_sizze_29429) != 0) {
        const size_t global_work_sizze_30003[1] = {(size_t) num_groups_29430 *
                     (size_t) group_sizze_29429};
        const size_t local_work_sizze_30007[1] = {group_sizze_29429};
        int64_t time_start_30004 = 0, time_end_30005 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "builtin#replicate_i64.replicate_29426");
            fprintf(stderr, "%zu", global_work_sizze_30003[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_30007[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_30004 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->builtinzhreplicate_i64zireplicate_29426,
                                                        1, NULL,
                                                        global_work_sizze_30003,
                                                        local_work_sizze_30007,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->builtinzhreplicate_i64zireplicate_29426_runs,
                                                                                                  &ctx->builtinzhreplicate_i64zireplicate_29426_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_30005 = get_wall_time();
            
            long time_diff_30006 = time_end_30005 - time_start_30004;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "builtin#replicate_i64.replicate_29426", time_diff_30006);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_main(struct futhark_context *ctx, float *out_scalar_out_30008,
                       struct memblock_device *out_mem_p_30009,
                       int64_t *out_out_arrsizze_30010,
                       struct memblock_device swap_term_mem_28878,
                       struct memblock_device payments_mem_28879,
                       struct memblock_device notional_mem_28880,
                       int64_t n_25418, int64_t n_25419, int64_t n_25420,
                       int64_t paths_25421, int64_t steps_25422, float a_25426,
                       float b_25427, float sigma_25428, float r0_25429)
{
    (void) ctx;
    
    int err = 0;
    float scalar_out_29203;
    struct memblock_device out_mem_29204;
    
    out_mem_29204.references = NULL;
    
    int64_t out_arrsizze_29205;
    bool dim_match_25430 = n_25418 == n_25419;
    bool empty_or_match_cert_25431;
    
    if (!dim_match_25430) {
        ctx->error = msgprintf("Error: %s\n\nBacktrace:\n%s",
                               "function arguments of wrong shape",
                               "-> #0  cva.fut:100:1-158:20\n");
        if (memblock_unref_device(ctx, &out_mem_29204, "out_mem_29204") != 0)
            return 1;
        return 1;
    }
    
    int64_t segred_group_sizze_26575;
    
    segred_group_sizze_26575 = ctx->sizes.mainzisegred_group_sizze_26574;
    
    int64_t num_groups_26577;
    int32_t max_num_groups_29206;
    
    max_num_groups_29206 = ctx->sizes.mainzisegred_num_groups_26576;
    num_groups_26577 = sext_i64_i32(smax64(1, smin64(sdiv_up64(n_25418,
                                                               sext_i32_i64(segred_group_sizze_26575)),
                                                     sext_i32_i64(max_num_groups_29206))));
    
    struct memblock_device mem_28883;
    
    mem_28883.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28883, 4, "mem_28883")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mainzicounter_mem_29207 =
                           ctx->mainzicounter_mem_29207;
    struct memblock_device group_res_arr_mem_29209;
    
    group_res_arr_mem_29209.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_29209,
                              (int32_t) sizeof(float) *
                              (segred_group_sizze_26575 * num_groups_26577),
                              "group_res_arr_mem_29209")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_29211;
    
    num_threads_29211 = num_groups_26577 * segred_group_sizze_26575;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26582, 1,
                                            (int32_t) sizeof(float) *
                                            segred_group_sizze_26575, NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26582, 2,
                                            (int32_t) sizeof(bool), NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26582, 3,
                                            sizeof(n_25418), &n_25418));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26582, 4,
                                            sizeof(num_groups_26577),
                                            &num_groups_26577));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26582, 5,
                                            sizeof(swap_term_mem_28878.mem),
                                            &swap_term_mem_28878.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26582, 6,
                                            sizeof(payments_mem_28879.mem),
                                            &payments_mem_28879.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26582, 7,
                                            sizeof(mem_28883.mem),
                                            &mem_28883.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26582, 8,
                                            sizeof(mainzicounter_mem_29207.mem),
                                            &mainzicounter_mem_29207.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26582, 9,
                                            sizeof(group_res_arr_mem_29209.mem),
                                            &group_res_arr_mem_29209.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_26582, 10,
                                            sizeof(num_threads_29211),
                                            &num_threads_29211));
    if (1 * ((size_t) num_groups_26577 * (size_t) segred_group_sizze_26575) !=
        0) {
        const size_t global_work_sizze_30012[1] = {(size_t) num_groups_26577 *
                     (size_t) segred_group_sizze_26575};
        const size_t local_work_sizze_30016[1] = {segred_group_sizze_26575};
        int64_t time_start_30013 = 0, time_end_30014 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segred_nonseg_26582");
            fprintf(stderr, "%zu", global_work_sizze_30012[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_30016[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) (0 + (int32_t) sizeof(float) *
                           segred_group_sizze_26575 + (int32_t) sizeof(bool)));
            time_start_30013 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegred_nonseg_26582,
                                                        1, NULL,
                                                        global_work_sizze_30012,
                                                        local_work_sizze_30016,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegred_nonseg_26582_runs,
                                                                                                  &ctx->mainzisegred_nonseg_26582_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_30014 = get_wall_time();
            
            long time_diff_30015 = time_end_30014 - time_start_30013;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "main.segred_nonseg_26582", time_diff_30015);
        }
    }
    
    float read_res_30017;
    
    OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                 mem_28883.mem,
                                                 ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                 0 * sizeof(float),
                                                 sizeof(float), &read_res_30017,
                                                 0, NULL,
                                                 ctx->profiling_paused ||
                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                           &ctx->copy_scalar_from_dev_runs,
                                                                                           &ctx->copy_scalar_from_dev_total_runtime)));
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
        return 1;
    
    float res_25435 = read_res_30017;
    
    if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
        return 1;
    
    float res_25443 = sitofp_i64_f32(steps_25422);
    float dt_25444 = res_25435 / res_25443;
    float x_25446 = fpow32(a_25426, 2.0F);
    float x_25447 = b_25427 * x_25446;
    float x_25448 = fpow32(sigma_25428, 2.0F);
    float y_25449 = x_25448 / 2.0F;
    float y_25450 = x_25447 - y_25449;
    float y_25451 = 4.0F * a_25426;
    bool suff_outer_par_26584;
    
    suff_outer_par_26584 = ctx->sizes.mainzisuff_outer_par_0 <= n_25418;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_outer_par_0",
                n_25418);
    
    int64_t segmap_group_sizze_26674;
    
    segmap_group_sizze_26674 = ctx->sizes.mainzisegmap_group_sizze_26598;
    
    int64_t segmap_group_sizze_26850;
    
    segmap_group_sizze_26850 = ctx->sizes.mainzisegmap_group_sizze_26774;
    
    int64_t bytes_28884 = 4 * n_25418;
    int64_t bytes_28886 = 8 * n_25418;
    int64_t segred_num_groups_29050;
    
    segred_num_groups_29050 = ctx->sizes.mainzisegred_num_groups_29049;
    
    int64_t segred_group_sizze_29052;
    
    segred_group_sizze_29052 = ctx->sizes.mainzisegred_group_sizze_29051;
    
    int64_t segred_num_groups_29082;
    
    segred_num_groups_29082 = ctx->sizes.mainzisegred_num_groups_29081;
    
    int64_t segred_group_sizze_29084;
    
    segred_group_sizze_29084 = ctx->sizes.mainzisegred_group_sizze_29083;
    
    struct memblock_device res_mem_28930;
    
    res_mem_28930.references = NULL;
    
    struct memblock_device res_mem_28931;
    
    res_mem_28931.references = NULL;
    
    struct memblock_device res_mem_28932;
    
    res_mem_28932.references = NULL;
    
    struct memblock_device res_mem_28933;
    
    res_mem_28933.references = NULL;
    
    int32_t local_memory_capacity_29311;
    
    local_memory_capacity_29311 = ctx->opencl.max_local_memory;
    if ((sle64((int32_t) sizeof(bool) + (int32_t) sizeof(int64_t) *
               segred_group_sizze_29052,
               sext_i32_i64(local_memory_capacity_29311)) && sle64(0,
                                                                   sext_i32_i64(local_memory_capacity_29311))) &&
        suff_outer_par_26584) {
        int64_t segmap_usable_groups_26675 = sdiv_up64(n_25418,
                                                       segmap_group_sizze_26674);
        struct memblock_device mem_28885;
        
        mem_28885.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28885, bytes_28884, "mem_28885")) {
            err = 1;
            goto cleanup;
        }
        if (n_25418 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         swap_term_mem_28878.mem,
                                                         mem_28885.mem, 0, 0,
                                                         n_25418 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28887;
        
        mem_28887.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28887, bytes_28886, "mem_28887")) {
            err = 1;
            goto cleanup;
        }
        if (n_25418 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         payments_mem_28879.mem,
                                                         mem_28887.mem, 0, 0,
                                                         n_25418 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28889;
        
        mem_28889.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28889, bytes_28884, "mem_28889")) {
            err = 1;
            goto cleanup;
        }
        if (n_25418 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         notional_mem_28880.mem,
                                                         mem_28889.mem, 0, 0,
                                                         n_25418 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28906;
        
        mem_28906.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28906, bytes_28884, "mem_28906")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_29040 = segmap_group_sizze_26674 *
                segmap_usable_groups_26675;
        struct memblock_device mem_29068;
        
        mem_29068.references = NULL;
        if (memblock_alloc_device(ctx, &mem_29068, 8, "mem_29068")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mainzicounter_mem_29237 =
                               ctx->mainzicounter_mem_29237;
        struct memblock_device group_res_arr_mem_29239;
        
        group_res_arr_mem_29239.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_29239,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_29052 *
                                   segred_num_groups_29050),
                                  "group_res_arr_mem_29239")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_29241;
        
        num_threads_29241 = segred_num_groups_29050 * segred_group_sizze_29052;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29056,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_29052,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29056,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29056,
                                                3, sizeof(n_25418), &n_25418));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29056,
                                                4,
                                                sizeof(payments_mem_28879.mem),
                                                &payments_mem_28879.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29056,
                                                5, sizeof(mem_29068.mem),
                                                &mem_29068.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29056,
                                                6,
                                                sizeof(mainzicounter_mem_29237.mem),
                                                &mainzicounter_mem_29237.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29056,
                                                7,
                                                sizeof(group_res_arr_mem_29239.mem),
                                                &group_res_arr_mem_29239.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29056,
                                                8, sizeof(num_threads_29241),
                                                &num_threads_29241));
        if (1 * ((size_t) segred_num_groups_29050 *
                 (size_t) segred_group_sizze_29052) != 0) {
            const size_t global_work_sizze_30019[1] =
                         {(size_t) segred_num_groups_29050 *
                         (size_t) segred_group_sizze_29052};
            const size_t local_work_sizze_30023[1] = {segred_group_sizze_29052};
            int64_t time_start_30020 = 0, time_end_30021 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segred_nonseg_29056");
                fprintf(stderr, "%zu", global_work_sizze_30019[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_30023[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_29052 +
                               (int32_t) sizeof(bool)));
                time_start_30020 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegred_nonseg_29056,
                                                            1, NULL,
                                                            global_work_sizze_30019,
                                                            local_work_sizze_30023,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegred_nonseg_29056_runs,
                                                                                                      &ctx->mainzisegred_nonseg_29056_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_30021 = get_wall_time();
                
                long time_diff_30022 = time_end_30021 - time_start_30020;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segred_nonseg_29056", time_diff_30022);
            }
        }
        
        int64_t read_res_30024;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_29068.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_30024, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t max_per_thread_29046 = read_res_30024;
        
        if (memblock_unref_device(ctx, &mem_29068, "mem_29068") != 0)
            return 1;
        
        int64_t sizze_sum_29063 = num_threads_29040 * max_per_thread_29046;
        struct memblock_device mem_28892;
        
        mem_28892.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28892, sizze_sum_29063,
                                  "mem_28892")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26596, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26596, 3,
                                                sizeof(n_25418), &n_25418));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26596, 4,
                                                sizeof(a_25426), &a_25426));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26596, 5,
                                                sizeof(r0_25429), &r0_25429));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26596, 6,
                                                sizeof(x_25446), &x_25446));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26596, 7,
                                                sizeof(x_25448), &x_25448));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26596, 8,
                                                sizeof(y_25450), &y_25450));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26596, 9,
                                                sizeof(y_25451), &y_25451));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26596, 10,
                                                sizeof(swap_term_mem_28878.mem),
                                                &swap_term_mem_28878.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26596, 11,
                                                sizeof(payments_mem_28879.mem),
                                                &payments_mem_28879.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26596, 12,
                                                sizeof(mem_28892.mem),
                                                &mem_28892.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26596, 13,
                                                sizeof(mem_28906.mem),
                                                &mem_28906.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26596, 14,
                                                sizeof(num_threads_29040),
                                                &num_threads_29040));
        if (1 * ((size_t) segmap_usable_groups_26675 *
                 (size_t) segmap_group_sizze_26674) != 0) {
            const size_t global_work_sizze_30025[1] =
                         {(size_t) segmap_usable_groups_26675 *
                         (size_t) segmap_group_sizze_26674};
            const size_t local_work_sizze_30029[1] = {segmap_group_sizze_26674};
            int64_t time_start_30026 = 0, time_end_30027 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_26596");
                fprintf(stderr, "%zu", global_work_sizze_30025[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_30029[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_30026 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_26596,
                                                            1, NULL,
                                                            global_work_sizze_30025,
                                                            local_work_sizze_30029,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_26596_runs,
                                                                                                      &ctx->mainzisegmap_26596_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_30027 = get_wall_time();
                
                long time_diff_30028 = time_end_30027 - time_start_30026;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_26596", time_diff_30028);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_28892, "mem_28892") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28930, &mem_28906, "mem_28906") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28931, &mem_28889, "mem_28889") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28932, &mem_28887, "mem_28887") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28933, &mem_28885, "mem_28885") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28892, "mem_28892") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29239,
                                  "group_res_arr_mem_29239") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29068, "mem_29068") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28906, "mem_28906") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28889, "mem_28889") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28887, "mem_28887") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28885, "mem_28885") != 0)
            return 1;
    } else {
        int64_t segmap_usable_groups_26851 = sdiv_up64(n_25418,
                                                       segmap_group_sizze_26850);
        struct memblock_device mem_28908;
        
        mem_28908.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28908, bytes_28884, "mem_28908")) {
            err = 1;
            goto cleanup;
        }
        if (n_25418 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         swap_term_mem_28878.mem,
                                                         mem_28908.mem, 0, 0,
                                                         n_25418 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28910;
        
        mem_28910.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28910, bytes_28886, "mem_28910")) {
            err = 1;
            goto cleanup;
        }
        if (n_25418 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         payments_mem_28879.mem,
                                                         mem_28910.mem, 0, 0,
                                                         n_25418 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28912;
        
        mem_28912.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28912, bytes_28884, "mem_28912")) {
            err = 1;
            goto cleanup;
        }
        if (n_25418 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         notional_mem_28880.mem,
                                                         mem_28912.mem, 0, 0,
                                                         n_25418 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28929;
        
        mem_28929.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28929, bytes_28884, "mem_28929")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_29072 = segmap_group_sizze_26850 *
                segmap_usable_groups_26851;
        struct memblock_device mem_29100;
        
        mem_29100.references = NULL;
        if (memblock_alloc_device(ctx, &mem_29100, 8, "mem_29100")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mainzicounter_mem_29274 =
                               ctx->mainzicounter_mem_29274;
        struct memblock_device group_res_arr_mem_29276;
        
        group_res_arr_mem_29276.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_29276,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_29084 *
                                   segred_num_groups_29082),
                                  "group_res_arr_mem_29276")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_29278;
        
        num_threads_29278 = segred_num_groups_29082 * segred_group_sizze_29084;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29088,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_29084,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29088,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29088,
                                                3, sizeof(n_25418), &n_25418));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29088,
                                                4,
                                                sizeof(payments_mem_28879.mem),
                                                &payments_mem_28879.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29088,
                                                5, sizeof(mem_29100.mem),
                                                &mem_29100.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29088,
                                                6,
                                                sizeof(mainzicounter_mem_29274.mem),
                                                &mainzicounter_mem_29274.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29088,
                                                7,
                                                sizeof(group_res_arr_mem_29276.mem),
                                                &group_res_arr_mem_29276.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_29088,
                                                8, sizeof(num_threads_29278),
                                                &num_threads_29278));
        if (1 * ((size_t) segred_num_groups_29082 *
                 (size_t) segred_group_sizze_29084) != 0) {
            const size_t global_work_sizze_30031[1] =
                         {(size_t) segred_num_groups_29082 *
                         (size_t) segred_group_sizze_29084};
            const size_t local_work_sizze_30035[1] = {segred_group_sizze_29084};
            int64_t time_start_30032 = 0, time_end_30033 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segred_nonseg_29088");
                fprintf(stderr, "%zu", global_work_sizze_30031[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_30035[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_29084 +
                               (int32_t) sizeof(bool)));
                time_start_30032 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegred_nonseg_29088,
                                                            1, NULL,
                                                            global_work_sizze_30031,
                                                            local_work_sizze_30035,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegred_nonseg_29088_runs,
                                                                                                      &ctx->mainzisegred_nonseg_29088_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_30033 = get_wall_time();
                
                long time_diff_30034 = time_end_30033 - time_start_30032;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segred_nonseg_29088", time_diff_30034);
            }
        }
        
        int64_t read_res_30036;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_29100.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_30036, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t max_per_thread_29078 = read_res_30036;
        
        if (memblock_unref_device(ctx, &mem_29100, "mem_29100") != 0)
            return 1;
        
        int64_t sizze_sum_29095 = num_threads_29072 * max_per_thread_29078;
        struct memblock_device mem_28915;
        
        mem_28915.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28915, sizze_sum_29095,
                                  "mem_28915")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26772, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26772, 3,
                                                sizeof(n_25418), &n_25418));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26772, 4,
                                                sizeof(a_25426), &a_25426));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26772, 5,
                                                sizeof(r0_25429), &r0_25429));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26772, 6,
                                                sizeof(x_25446), &x_25446));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26772, 7,
                                                sizeof(x_25448), &x_25448));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26772, 8,
                                                sizeof(y_25450), &y_25450));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26772, 9,
                                                sizeof(y_25451), &y_25451));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26772, 10,
                                                sizeof(swap_term_mem_28878.mem),
                                                &swap_term_mem_28878.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26772, 11,
                                                sizeof(payments_mem_28879.mem),
                                                &payments_mem_28879.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26772, 12,
                                                sizeof(mem_28915.mem),
                                                &mem_28915.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26772, 13,
                                                sizeof(mem_28929.mem),
                                                &mem_28929.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_26772, 14,
                                                sizeof(num_threads_29072),
                                                &num_threads_29072));
        if (1 * ((size_t) segmap_usable_groups_26851 *
                 (size_t) segmap_group_sizze_26850) != 0) {
            const size_t global_work_sizze_30037[1] =
                         {(size_t) segmap_usable_groups_26851 *
                         (size_t) segmap_group_sizze_26850};
            const size_t local_work_sizze_30041[1] = {segmap_group_sizze_26850};
            int64_t time_start_30038 = 0, time_end_30039 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_26772");
                fprintf(stderr, "%zu", global_work_sizze_30037[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_30041[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_30038 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_26772,
                                                            1, NULL,
                                                            global_work_sizze_30037,
                                                            local_work_sizze_30041,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_26772_runs,
                                                                                                      &ctx->mainzisegmap_26772_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_30039 = get_wall_time();
                
                long time_diff_30040 = time_end_30039 - time_start_30038;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_26772", time_diff_30040);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_28915, "mem_28915") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28930, &mem_28929, "mem_28929") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28931, &mem_28912, "mem_28912") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28932, &mem_28910, "mem_28910") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28933, &mem_28908, "mem_28908") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28915, "mem_28915") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29276,
                                  "group_res_arr_mem_29276") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29100, "mem_29100") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28929, "mem_28929") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28912, "mem_28912") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28910, "mem_28910") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28908, "mem_28908") != 0)
            return 1;
    }
    
    float sims_per_year_25528 = res_25443 / res_25435;
    bool bounds_invalid_upwards_25529 = slt64(steps_25422, 1);
    bool valid_25530 = !bounds_invalid_upwards_25529;
    bool range_valid_c_25531;
    
    if (!valid_25530) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 1, "..", 2, "...", steps_25422,
                               " is invalid.",
                               "-> #0  cva.fut:60:56-67\n   #1  cva.fut:111:17-44\n   #2  cva.fut:100:1-158:20\n");
        if (memblock_unref_device(ctx, &res_mem_28933, "res_mem_28933") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28932, "res_mem_28932") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28931, "res_mem_28931") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28930, "res_mem_28930") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29209,
                                  "group_res_arr_mem_29209") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29204, "out_mem_29204") != 0)
            return 1;
        return 1;
    }
    
    bool bounds_invalid_upwards_25537 = slt64(paths_25421, 0);
    bool valid_25538 = !bounds_invalid_upwards_25537;
    bool range_valid_c_25539;
    
    if (!valid_25538) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", paths_25421,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:126:11-16\n   #2  lib/github.com/diku-dk/cpprandom/random.fut:174:8-56\n   #3  cva.fut:115:19-49\n   #4  cva.fut:100:1-158:20\n");
        if (memblock_unref_device(ctx, &res_mem_28933, "res_mem_28933") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28932, "res_mem_28932") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28931, "res_mem_28931") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28930, "res_mem_28930") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29209,
                                  "group_res_arr_mem_29209") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29204, "out_mem_29204") != 0)
            return 1;
        return 1;
    }
    
    int64_t upper_bound_25542 = sub64(steps_25422, 1);
    float res_25543;
    
    res_25543 = futrts_sqrt32(dt_25444);
    
    int64_t segmap_group_sizze_27252;
    
    segmap_group_sizze_27252 = ctx->sizes.mainzisegmap_group_sizze_27235;
    
    int64_t segmap_usable_groups_27253 = sdiv_up64(paths_25421,
                                                   segmap_group_sizze_27252);
    int64_t bytes_28935 = 4 * paths_25421;
    struct memblock_device mem_28936;
    
    mem_28936.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28936, bytes_28935, "mem_28936")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27233, 1,
                                            sizeof(paths_25421), &paths_25421));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27233, 2,
                                            sizeof(mem_28936.mem),
                                            &mem_28936.mem));
    if (1 * ((size_t) segmap_usable_groups_27253 *
             (size_t) segmap_group_sizze_27252) != 0) {
        const size_t global_work_sizze_30042[1] =
                     {(size_t) segmap_usable_groups_27253 *
                     (size_t) segmap_group_sizze_27252};
        const size_t local_work_sizze_30046[1] = {segmap_group_sizze_27252};
        int64_t time_start_30043 = 0, time_end_30044 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segmap_27233");
            fprintf(stderr, "%zu", global_work_sizze_30042[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_30046[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_30043 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegmap_27233,
                                                        1, NULL,
                                                        global_work_sizze_30042,
                                                        local_work_sizze_30046,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegmap_27233_runs,
                                                                                                  &ctx->mainzisegmap_27233_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_30044 = get_wall_time();
            
            long time_diff_30045 = time_end_30044 - time_start_30043;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "main.segmap_27233",
                    time_diff_30045);
        }
    }
    
    int64_t nest_sizze_27276 = paths_25421 * steps_25422;
    int64_t segmap_group_sizze_27277;
    
    segmap_group_sizze_27277 = ctx->sizes.mainzisegmap_group_sizze_27172;
    
    int64_t segmap_usable_groups_27278 = sdiv_up64(nest_sizze_27276,
                                                   segmap_group_sizze_27277);
    int64_t bytes_28938 = 4 * nest_sizze_27276;
    struct memblock_device mem_28940;
    
    mem_28940.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28940, bytes_28938, "mem_28940")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27169, 1,
                                            sizeof(paths_25421), &paths_25421));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27169, 2,
                                            sizeof(steps_25422), &steps_25422));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27169, 3,
                                            sizeof(mem_28936.mem),
                                            &mem_28936.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27169, 4,
                                            sizeof(mem_28940.mem),
                                            &mem_28940.mem));
    if (1 * ((size_t) segmap_usable_groups_27278 *
             (size_t) segmap_group_sizze_27277) != 0) {
        const size_t global_work_sizze_30047[1] =
                     {(size_t) segmap_usable_groups_27278 *
                     (size_t) segmap_group_sizze_27277};
        const size_t local_work_sizze_30051[1] = {segmap_group_sizze_27277};
        int64_t time_start_30048 = 0, time_end_30049 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segmap_27169");
            fprintf(stderr, "%zu", global_work_sizze_30047[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_30051[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_30048 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegmap_27169,
                                                        1, NULL,
                                                        global_work_sizze_30047,
                                                        local_work_sizze_30051,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegmap_27169_runs,
                                                                                                  &ctx->mainzisegmap_27169_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_30049 = get_wall_time();
            
            long time_diff_30050 = time_end_30049 - time_start_30048;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "main.segmap_27169",
                    time_diff_30050);
        }
    }
    if (memblock_unref_device(ctx, &mem_28936, "mem_28936") != 0)
        return 1;
    
    int64_t segmap_group_sizze_27322;
    
    segmap_group_sizze_27322 = ctx->sizes.mainzisegmap_group_sizze_27073;
    
    int64_t num_groups_27323;
    int32_t max_num_groups_29322;
    
    max_num_groups_29322 = ctx->sizes.mainzisegmap_num_groups_27075;
    num_groups_27323 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_25421,
                                                               sext_i32_i64(segmap_group_sizze_27322)),
                                                     sext_i32_i64(max_num_groups_29322))));
    
    struct memblock_device mem_28943;
    
    mem_28943.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28943, bytes_28938, "mem_28943")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_28943, 0, mem_28940, 0,
                                              1, steps_25422, paths_25421) !=
        0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &mem_28940, "mem_28940") != 0)
        return 1;
    
    struct memblock_device mem_28961;
    
    mem_28961.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28961, bytes_28938, "mem_28961")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_28945 = 4 * steps_25422;
    int64_t num_threads_29106 = segmap_group_sizze_27322 * num_groups_27323;
    int64_t total_sizze_29107 = bytes_28945 * num_threads_29106;
    struct memblock_device mem_28946;
    
    mem_28946.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28946, total_sizze_29107,
                              "mem_28946")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27071, 1,
                                            sizeof(ctx->failure_is_an_option),
                                            &ctx->failure_is_an_option));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27071, 3,
                                            sizeof(paths_25421), &paths_25421));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27071, 4,
                                            sizeof(steps_25422), &steps_25422));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27071, 5,
                                            sizeof(a_25426), &a_25426));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27071, 6,
                                            sizeof(b_25427), &b_25427));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27071, 7,
                                            sizeof(sigma_25428), &sigma_25428));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27071, 8,
                                            sizeof(r0_25429), &r0_25429));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27071, 9,
                                            sizeof(dt_25444), &dt_25444));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27071, 10,
                                            sizeof(upper_bound_25542),
                                            &upper_bound_25542));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27071, 11,
                                            sizeof(res_25543), &res_25543));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27071, 12,
                                            sizeof(num_groups_27323),
                                            &num_groups_27323));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27071, 13,
                                            sizeof(mem_28943.mem),
                                            &mem_28943.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27071, 14,
                                            sizeof(mem_28946.mem),
                                            &mem_28946.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27071, 15,
                                            sizeof(mem_28961.mem),
                                            &mem_28961.mem));
    if (1 * ((size_t) num_groups_27323 * (size_t) segmap_group_sizze_27322) !=
        0) {
        const size_t global_work_sizze_30052[1] = {(size_t) num_groups_27323 *
                     (size_t) segmap_group_sizze_27322};
        const size_t local_work_sizze_30056[1] = {segmap_group_sizze_27322};
        int64_t time_start_30053 = 0, time_end_30054 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "main.segmap_27071");
            fprintf(stderr, "%zu", global_work_sizze_30052[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_30056[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_30053 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->mainzisegmap_27071,
                                                        1, NULL,
                                                        global_work_sizze_30052,
                                                        local_work_sizze_30056,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->mainzisegmap_27071_runs,
                                                                                                  &ctx->mainzisegmap_27071_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_30054 = get_wall_time();
            
            long time_diff_30055 = time_end_30054 - time_start_30053;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "main.segmap_27071",
                    time_diff_30055);
        }
    }
    ctx->failure_is_an_option = 1;
    if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28946, "mem_28946") != 0)
        return 1;
    
    int64_t flat_dim_25607 = n_25418 * paths_25421;
    float res_25611 = sitofp_i64_f32(paths_25421);
    struct memblock_device mem_28963;
    
    mem_28963.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28963, bytes_28945, "mem_28963")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segscan_group_sizze_27421;
    
    segscan_group_sizze_27421 = ctx->sizes.mainzisegscan_group_sizze_27420;
    
    int64_t num_groups_27423;
    int32_t max_num_groups_29334;
    
    max_num_groups_29334 = ctx->sizes.mainzisegscan_num_groups_27422;
    num_groups_27423 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_25607,
                                                               sext_i32_i64(segscan_group_sizze_27421)),
                                                     sext_i32_i64(max_num_groups_29334))));
    
    int64_t segred_group_sizze_27429;
    
    segred_group_sizze_27429 = ctx->sizes.mainzisegred_group_sizze_27428;
    
    int64_t num_groups_27431;
    int32_t max_num_groups_29335;
    
    max_num_groups_29335 = ctx->sizes.mainzisegred_num_groups_27430;
    num_groups_27431 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_25607,
                                                               sext_i32_i64(segred_group_sizze_27429)),
                                                     sext_i32_i64(max_num_groups_29335))));
    
    int64_t seghist_group_sizze_27439;
    
    seghist_group_sizze_27439 = ctx->sizes.mainziseghist_group_sizze_27438;
    
    int64_t num_groups_27441;
    int32_t max_num_groups_29336;
    
    max_num_groups_29336 = ctx->sizes.mainziseghist_num_groups_27440;
    num_groups_27441 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_25607,
                                                               sext_i32_i64(seghist_group_sizze_27439)),
                                                     sext_i32_i64(max_num_groups_29336))));
    
    int64_t segscan_group_sizze_27454;
    
    segscan_group_sizze_27454 = ctx->sizes.mainzisegscan_group_sizze_27453;
    
    int64_t segscan_group_sizze_27462;
    
    segscan_group_sizze_27462 = ctx->sizes.mainzisegscan_group_sizze_27461;
    
    int64_t segscan_group_sizze_27470;
    
    segscan_group_sizze_27470 = ctx->sizes.mainzisegscan_group_sizze_27469;
    
    int64_t segscan_group_sizze_27522;
    
    segscan_group_sizze_27522 = ctx->sizes.mainzisegscan_group_sizze_27521;
    
    bool suff_outer_redomap_27535;
    
    suff_outer_redomap_27535 = ctx->sizes.mainzisuff_outer_redomap_7 <=
        paths_25421;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_outer_redomap_7",
                paths_25421);
    
    int64_t segred_group_sizze_27547;
    
    segred_group_sizze_27547 = ctx->sizes.mainzisegred_group_sizze_27537;
    
    int64_t num_groups_27548;
    int32_t max_num_groups_29337;
    
    max_num_groups_29337 = ctx->sizes.mainzisegred_num_groups_27539;
    num_groups_27548 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_25421,
                                                               sext_i32_i64(segred_group_sizze_27547)),
                                                     sext_i32_i64(max_num_groups_29337))));
    
    bool suff_outer_par_27643;
    
    suff_outer_par_27643 = ctx->sizes.mainzisuff_outer_par_8 <= paths_25421;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "main.suff_outer_par_8",
                paths_25421);
    
    int64_t segmap_group_sizze_27646;
    
    segmap_group_sizze_27646 = ctx->sizes.mainzisegmap_group_sizze_27569;
    
    int64_t segred_group_sizze_27658;
    
    segred_group_sizze_27658 = ctx->sizes.mainzisegred_group_sizze_27602;
    
    int64_t num_groups_27659;
    int32_t max_num_groups_29338;
    
    max_num_groups_29338 = ctx->sizes.mainzisegred_num_groups_27604;
    num_groups_27659 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_25607,
                                                               sext_i32_i64(segred_group_sizze_27658)),
                                                     sext_i32_i64(max_num_groups_29338))));
    
    int64_t segmap_group_sizze_27668;
    
    segmap_group_sizze_27668 = ctx->sizes.mainzisegmap_group_sizze_27594;
    
    int64_t segred_group_sizze_27675;
    
    segred_group_sizze_27675 = ctx->sizes.mainzisegred_group_sizze_27633;
    
    int64_t num_groups_27676;
    int32_t max_num_groups_29339;
    
    max_num_groups_29339 = ctx->sizes.mainzisegred_num_groups_27635;
    num_groups_27676 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_25421,
                                                               sext_i32_i64(segred_group_sizze_27675)),
                                                     sext_i32_i64(max_num_groups_29339))));
    
    int64_t segmap_usable_groups_27647 = sdiv_up_safe64(paths_25421,
                                                        segmap_group_sizze_27646);
    int64_t segmap_usable_groups_27669 = sdiv_up_safe64(paths_25421,
                                                        segmap_group_sizze_27668);
    int64_t bytes_28972 = 8 * flat_dim_25607;
    struct memblock_device mem_28973;
    
    mem_28973.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28973, bytes_28972, "mem_28973")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28975;
    
    mem_28975.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28975, bytes_28972, "mem_28975")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28978;
    
    mem_28978.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28978, 8, "mem_28978")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_29005 = 4 * flat_dim_25607;
    float res_25861;
    float redout_27349 = 0.0F;
    
    for (int64_t i_27351 = 0; i_27351 < steps_25422; i_27351++) {
        int64_t index_primexp_28822 = add64(1, i_27351);
        float res_25868 = sitofp_i64_f32(index_primexp_28822);
        float res_25869 = res_25868 / sims_per_year_25528;
        
        if (slt64(0, flat_dim_25607)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_29342;
            
            stage1_max_num_groups_29342 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_29343;
            
            stage1_num_groups_29343 = smin64(stage1_max_num_groups_29342,
                                             num_groups_27423);
            
            int32_t num_threads_29344;
            
            num_threads_29344 = sext_i64_i32(stage1_num_groups_29343 *
                segscan_group_sizze_27421);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27426,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_27421),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27426,
                                                    2, sizeof(n_25418),
                                                    &n_25418));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27426,
                                                    3, sizeof(flat_dim_25607),
                                                    &flat_dim_25607));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27426,
                                                    4, sizeof(res_25869),
                                                    &res_25869));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27426,
                                                    5,
                                                    sizeof(res_mem_28932.mem),
                                                    &res_mem_28932.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27426,
                                                    6,
                                                    sizeof(res_mem_28933.mem),
                                                    &res_mem_28933.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27426,
                                                    7, sizeof(mem_28973.mem),
                                                    &mem_28973.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27426,
                                                    8, sizeof(mem_28975.mem),
                                                    &mem_28975.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27426,
                                                    9,
                                                    sizeof(num_threads_29344),
                                                    &num_threads_29344));
            if (1 * ((size_t) stage1_num_groups_29343 *
                     (size_t) segscan_group_sizze_27421) != 0) {
                const size_t global_work_sizze_30057[1] =
                             {(size_t) stage1_num_groups_29343 *
                             (size_t) segscan_group_sizze_27421};
                const size_t local_work_sizze_30061[1] =
                             {segscan_group_sizze_27421};
                int64_t time_start_30058 = 0, time_end_30059 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage1_27426");
                    fprintf(stderr, "%zu", global_work_sizze_30057[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30061[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_27421)));
                    time_start_30058 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage1_27426,
                                                                1, NULL,
                                                                global_work_sizze_30057,
                                                                local_work_sizze_30061,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage1_27426_runs,
                                                                                                          &ctx->mainziscan_stage1_27426_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30059 = get_wall_time();
                    
                    long time_diff_30060 = time_end_30059 - time_start_30058;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage1_27426", time_diff_30060);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_27421 *
                                     sdiv_up64(flat_dim_25607,
                                               sext_i32_i64(num_threads_29344))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27426,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_29343),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27426,
                                                    2, sizeof(flat_dim_25607),
                                                    &flat_dim_25607));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27426,
                                                    3, sizeof(mem_28973.mem),
                                                    &mem_28973.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27426,
                                                    4,
                                                    sizeof(stage1_num_groups_29343),
                                                    &stage1_num_groups_29343));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27426,
                                                    5,
                                                    sizeof(num_threads_29344),
                                                    &num_threads_29344));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_29343) != 0) {
                const size_t global_work_sizze_30062[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_29343};
                const size_t local_work_sizze_30066[1] =
                             {stage1_num_groups_29343};
                int64_t time_start_30063 = 0, time_end_30064 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage2_27426");
                    fprintf(stderr, "%zu", global_work_sizze_30062[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30066[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_29343)));
                    time_start_30063 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage2_27426,
                                                                1, NULL,
                                                                global_work_sizze_30062,
                                                                local_work_sizze_30066,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage2_27426_runs,
                                                                                                          &ctx->mainziscan_stage2_27426_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30064 = get_wall_time();
                    
                    long time_diff_30065 = time_end_30064 - time_start_30063;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage2_27426", time_diff_30065);
                }
            }
            
            int32_t required_groups_29380;
            
            required_groups_29380 = sext_i64_i32(sdiv_up64(flat_dim_25607,
                                                           segscan_group_sizze_27421));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27426,
                                                    1, sizeof(flat_dim_25607),
                                                    &flat_dim_25607));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27426,
                                                    2, sizeof(num_groups_27423),
                                                    &num_groups_27423));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27426,
                                                    3, sizeof(mem_28973.mem),
                                                    &mem_28973.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27426,
                                                    4,
                                                    sizeof(num_threads_29344),
                                                    &num_threads_29344));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27426,
                                                    5,
                                                    sizeof(required_groups_29380),
                                                    &required_groups_29380));
            if (1 * ((size_t) num_groups_27423 *
                     (size_t) segscan_group_sizze_27421) != 0) {
                const size_t global_work_sizze_30067[1] =
                             {(size_t) num_groups_27423 *
                             (size_t) segscan_group_sizze_27421};
                const size_t local_work_sizze_30071[1] =
                             {segscan_group_sizze_27421};
                int64_t time_start_30068 = 0, time_end_30069 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage3_27426");
                    fprintf(stderr, "%zu", global_work_sizze_30067[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30071[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_30068 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage3_27426,
                                                                1, NULL,
                                                                global_work_sizze_30067,
                                                                local_work_sizze_30071,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage3_27426_runs,
                                                                                                          &ctx->mainziscan_stage3_27426_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30069 = get_wall_time();
                    
                    long time_diff_30070 = time_end_30069 - time_start_30068;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage3_27426", time_diff_30070);
                }
            }
        }
        
        struct memblock_device mainzicounter_mem_29392 =
                               ctx->mainzicounter_mem_29392;
        struct memblock_device group_res_arr_mem_29394;
        
        group_res_arr_mem_29394.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_29394,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_27429 * num_groups_27431),
                                  "group_res_arr_mem_29394")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_29396;
        
        num_threads_29396 = num_groups_27431 * segred_group_sizze_27429;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27436,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_27429,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27436,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27436,
                                                3, sizeof(flat_dim_25607),
                                                &flat_dim_25607));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27436,
                                                4, sizeof(num_groups_27431),
                                                &num_groups_27431));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27436,
                                                5, sizeof(mem_28975.mem),
                                                &mem_28975.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27436,
                                                6, sizeof(mem_28978.mem),
                                                &mem_28978.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27436,
                                                7,
                                                sizeof(mainzicounter_mem_29392.mem),
                                                &mainzicounter_mem_29392.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27436,
                                                8,
                                                sizeof(group_res_arr_mem_29394.mem),
                                                &group_res_arr_mem_29394.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27436,
                                                9, sizeof(num_threads_29396),
                                                &num_threads_29396));
        if (1 * ((size_t) num_groups_27431 *
                 (size_t) segred_group_sizze_27429) != 0) {
            const size_t global_work_sizze_30073[1] =
                         {(size_t) num_groups_27431 *
                         (size_t) segred_group_sizze_27429};
            const size_t local_work_sizze_30077[1] = {segred_group_sizze_27429};
            int64_t time_start_30074 = 0, time_end_30075 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segred_nonseg_27436");
                fprintf(stderr, "%zu", global_work_sizze_30073[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_30077[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_27429 +
                               (int32_t) sizeof(bool)));
                time_start_30074 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegred_nonseg_27436,
                                                            1, NULL,
                                                            global_work_sizze_30073,
                                                            local_work_sizze_30077,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegred_nonseg_27436_runs,
                                                                                                      &ctx->mainzisegred_nonseg_27436_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_30075 = get_wall_time();
                
                long time_diff_30076 = time_end_30075 - time_start_30074;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segred_nonseg_27436", time_diff_30076);
            }
        }
        
        int64_t read_res_30078;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_28978.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_30078, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t res_25889 = read_res_30078;
        bool bounds_invalid_upwards_25894 = slt64(res_25889, 0);
        bool valid_25895 = !bounds_invalid_upwards_25894;
        bool range_valid_c_25896;
        
        if (!valid_25895) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Range ", 0, "..", 1, "..<", res_25889,
                          " is invalid.",
                          "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:48:30-60\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:87:14-32\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva.fut:133:38-97\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  cva.fut:126:44-136:50\n   #9  cva.fut:100:1-158:20\n");
            if (memblock_unref_device(ctx, &group_res_arr_mem_29394,
                                      "group_res_arr_mem_29394") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28978, "mem_28978") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28975, "mem_28975") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28973, "mem_28973") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28963, "mem_28963") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28946, "mem_28946") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28961, "mem_28961") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28940, "mem_28940") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28936, "mem_28936") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28933, "res_mem_28933") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28932, "res_mem_28932") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28931, "res_mem_28931") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28930, "res_mem_28930") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29209,
                                      "group_res_arr_mem_29209") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29204, "out_mem_29204") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t bytes_28979 = 8 * res_25889;
        struct memblock_device mem_28980;
        
        mem_28980.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28980, bytes_28979, "mem_28980")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_28980, res_25889, 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int32_t num_subhistos_29431;
        struct memblock_device res_subhistos_mem_29432;
        
        res_subhistos_mem_29432.references = NULL;
        
        int64_t h_29434;
        
        h_29434 = (int32_t) sizeof(int64_t) * res_25889;
        
        int64_t seg_h_29435;
        
        seg_h_29435 = (int32_t) sizeof(int64_t) * res_25889;
        if (!(seg_h_29435 == 0)) {
            int64_t hist_H_29436 = res_25889;
            int64_t hist_el_sizze_29437 = sdiv_up64(h_29434, hist_H_29436) + 4;
            int64_t hist_N_29438 = flat_dim_25607;
            int64_t hist_RF_29439 = 1;
            
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegHist");
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of threads (T)",
                        (long long) sext_i64_i32(num_groups_27441 *
                        seghist_group_sizze_27439), '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Desired group size (B)",
                        (long long) seghist_group_sizze_27439, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                        (long long) hist_H_29436, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Input elements per histogram (N)",
                        (long long) hist_N_29438, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of segments",
                        (long long) 1, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Histogram element size (el_size)",
                        (long long) hist_el_sizze_29437, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Race factor (RF)",
                        (long long) hist_RF_29439, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Memory per set of subhistograms per segment",
                        (long long) h_29434, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Memory per set of subhistograms times segments",
                        (long long) seg_h_29435, '\n');
            
            int32_t hist_L_29440;
            
            hist_L_29440 = ctx->opencl.max_local_memory;
            
            int32_t max_group_sizze_29441;
            
            max_group_sizze_29441 = ctx->opencl.max_group_size;
            
            int64_t num_groups_29442;
            
            num_groups_29442 =
                sdiv_up64(sext_i32_i64(sext_i64_i32(num_groups_27441 *
                          seghist_group_sizze_27439)), max_group_sizze_29441);
            
            double hist_m_prime_29443;
            
            hist_m_prime_29443 =
                sitofp_i64_f64(smin64(sext_i32_i64(squot32(hist_L_29440,
                                                           hist_el_sizze_29437)),
                                      sdiv_up64(hist_N_29438,
                                                num_groups_29442))) /
                sitofp_i64_f64(hist_H_29436);
            
            int64_t hist_M0_29444;
            
            hist_M0_29444 = smax64(1, smin64(fptosi_f64_i64(hist_m_prime_29443),
                                             max_group_sizze_29441));
            
            int64_t hist_Nout_29445;
            
            hist_Nout_29445 = 1;
            
            int64_t hist_Nin_29446;
            
            hist_Nin_29446 = flat_dim_25607;
            
            int64_t work_asymp_M_max_29447;
            
            work_asymp_M_max_29447 = squot64(hist_Nout_29445 * hist_N_29438, 2 *
                                             num_groups_29442 * hist_H_29436);
            
            int32_t hist_M_29448;
            
            hist_M_29448 = sext_i64_i32(smin64(hist_M0_29444,
                                               work_asymp_M_max_29447));
            
            int64_t hist_C_29449;
            
            hist_C_29449 = sdiv_up64(max_group_sizze_29441,
                                     sext_i32_i64(smax32(1, hist_M_29448)));
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local hist_M0",
                        (long long) hist_M0_29444, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local work asymp M max",
                        (long long) work_asymp_M_max_29447, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local C",
                        (long long) hist_C_29449, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local B",
                        (long long) max_group_sizze_29441, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local M",
                        (long long) hist_M_29448, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local memory needed",
                        (long long) (hist_H_29436 * hist_el_sizze_29437 *
                                     sext_i32_i64(hist_M_29448)), '\n');
            
            int64_t local_mem_needed_29450;
            
            local_mem_needed_29450 = hist_el_sizze_29437 *
                sext_i32_i64(hist_M_29448);
            
            int32_t hist_S_29451;
            
            hist_S_29451 = sext_i64_i32(sdiv_up64(hist_H_29436 *
                                                  local_mem_needed_29450,
                                                  hist_L_29440));
            if (sle64(hist_H_29436, hist_Nin_29446) &&
                (sle64(local_mem_needed_29450, hist_L_29440) &&
                 (sle32(hist_S_29451, 6) && (sle64(hist_C_29449,
                                                   max_group_sizze_29441) &&
                                             slt32(0, hist_M_29448))))) {
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "## Using local memory");
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                            (long long) hist_H_29436, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                            (long long) hist_M_29448, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Cooperation level (C)",
                            (long long) hist_C_29449, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                            (long long) hist_S_29451, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c",
                            "Number of local subhistograms per group",
                            (long long) hist_M_29448, '\n');
                
                int64_t num_segments_29452;
                
                num_segments_29452 = 1;
                num_subhistos_29431 = num_groups_29442 * num_segments_29452;
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c",
                            "Number of subhistograms in global memory",
                            (long long) num_subhistos_29431, '\n');
                if (num_subhistos_29431 == 1) {
                    if (memblock_set_device(ctx, &res_subhistos_mem_29432,
                                            &mem_28980, "mem_28980") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &res_subhistos_mem_29432,
                                              sext_i32_i64(num_subhistos_29431) *
                                              res_25889 *
                                              (int32_t) sizeof(int64_t),
                                              "res_subhistos_mem_29432")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx,
                                                      res_subhistos_mem_29432,
                                                      num_subhistos_29431 *
                                                      res_25889, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (res_25889 * (int32_t) sizeof(int64_t) > 0) {
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                     mem_28980.mem,
                                                                     res_subhistos_mem_29432.mem,
                                                                     0, 0,
                                                                     res_25889 *
                                                                     (int32_t) sizeof(int64_t),
                                                                     0, NULL,
                                                                     ctx->profiling_paused ||
                                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
                        if (ctx->debugging)
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    }
                }
                for (int32_t chk_i_29453 = 0; chk_i_29453 < hist_S_29451;
                     chk_i_29453++) {
                    int64_t num_segments_29454 = 1;
                    int64_t hist_H_chk_29455 = sdiv_up64(res_25889,
                                                         sext_i32_i64(hist_S_29451));
                    int64_t histo_sizze_29456 = hist_H_chk_29455;
                    int32_t init_per_thread_29457 =
                            sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_29448) *
                                                   histo_sizze_29456,
                                                   max_group_sizze_29441));
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_27444,
                                                            1,
                                                            (int32_t) sizeof(int32_t) *
                                                            (hist_M_29448 *
                                                             hist_H_chk_29455),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_27444,
                                                            2,
                                                            (int32_t) sizeof(int64_t) *
                                                            (hist_M_29448 *
                                                             hist_H_chk_29455),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_27444,
                                                            3,
                                                            sizeof(flat_dim_25607),
                                                            &flat_dim_25607));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_27444,
                                                            4,
                                                            sizeof(res_25889),
                                                            &res_25889));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_27444,
                                                            5,
                                                            sizeof(mem_28973.mem),
                                                            &mem_28973.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_27444,
                                                            6,
                                                            sizeof(res_subhistos_mem_29432.mem),
                                                            &res_subhistos_mem_29432.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_27444,
                                                            7,
                                                            sizeof(max_group_sizze_29441),
                                                            &max_group_sizze_29441));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_27444,
                                                            8,
                                                            sizeof(num_groups_29442),
                                                            &num_groups_29442));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_27444,
                                                            9,
                                                            sizeof(hist_M_29448),
                                                            &hist_M_29448));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_27444,
                                                            10,
                                                            sizeof(chk_i_29453),
                                                            &chk_i_29453));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_27444,
                                                            11,
                                                            sizeof(num_segments_29454),
                                                            &num_segments_29454));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_27444,
                                                            12,
                                                            sizeof(hist_H_chk_29455),
                                                            &hist_H_chk_29455));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_27444,
                                                            13,
                                                            sizeof(histo_sizze_29456),
                                                            &histo_sizze_29456));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_local_27444,
                                                            14,
                                                            sizeof(init_per_thread_29457),
                                                            &init_per_thread_29457));
                    if (1 * ((size_t) num_groups_29442 *
                             (size_t) max_group_sizze_29441) != 0) {
                        const size_t global_work_sizze_30079[1] =
                                     {(size_t) num_groups_29442 *
                                     (size_t) max_group_sizze_29441};
                        const size_t local_work_sizze_30083[1] =
                                     {max_group_sizze_29441};
                        int64_t time_start_30080 = 0, time_end_30081 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.seghist_local_27444");
                            fprintf(stderr, "%zu", global_work_sizze_30079[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_30083[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(int32_t) *
                                           (hist_M_29448 * hist_H_chk_29455) +
                                           (int32_t) sizeof(int64_t) *
                                           (hist_M_29448 * hist_H_chk_29455)));
                            time_start_30080 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainziseghist_local_27444,
                                                                        1, NULL,
                                                                        global_work_sizze_30079,
                                                                        local_work_sizze_30083,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainziseghist_local_27444_runs,
                                                                                                                  &ctx->mainziseghist_local_27444_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_30081 = get_wall_time();
                            
                            long time_diff_30082 = time_end_30081 -
                                 time_start_30080;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.seghist_local_27444",
                                    time_diff_30082);
                        }
                    }
                }
            } else {
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "## Using global memory");
                
                int64_t hist_H_29489;
                
                hist_H_29489 = res_25889;
                
                double hist_RF_29490;
                
                hist_RF_29490 = (0.0 + sitofp_i32_f64(1)) / 1.0;
                
                int32_t hist_el_sizze_29491;
                
                hist_el_sizze_29491 =
                    squot32(sext_i64_i32((int32_t) sizeof(int32_t) +
                            (int32_t) sizeof(int64_t)), 2);
                
                double hist_C_max_29492;
                
                hist_C_max_29492 =
                    fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_27441 *
                           seghist_group_sizze_27439)),
                           sitofp_i32_f64(hist_H_29489) / 2.0);
                
                int32_t hist_M_min_29493;
                
                hist_M_min_29493 = smax32(1,
                                          sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_27441 *
                                          seghist_group_sizze_27439)) /
                                          hist_C_max_29492)));
                
                int32_t L2_sizze_29494;
                
                L2_sizze_29494 = ctx->sizes.mainziL2_sizze_29494;
                
                double hist_RACE_exp_29495;
                
                hist_RACE_exp_29495 = fmax64(1.0, 0.75 * hist_RF_29490 / (64.0 /
                                                                          sitofp_i32_f64(hist_el_sizze_29491)));
                
                int32_t hist_S_29496;
                
                if (slt64(flat_dim_25607, hist_H_29489)) {
                    hist_S_29496 = 1;
                } else {
                    hist_S_29496 =
                        sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_min_29493) *
                                               hist_H_29489 *
                                               sext_i32_i64(hist_el_sizze_29491),
                                               fptosi_f64_i64(0.4 *
                                               sitofp_i32_f64(L2_sizze_29494) *
                                               hist_RACE_exp_29495)));
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s: %f%c",
                            "Race expansion factor (RACE^exp)",
                            (double) hist_RACE_exp_29495, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                            (long long) hist_S_29496, '\n');
                
                int64_t hist_H_chk_29497;
                
                hist_H_chk_29497 = sdiv_up64(res_25889,
                                             sext_i32_i64(hist_S_29496));
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Chunk size (H_chk)",
                            (long long) hist_H_chk_29497, '\n');
                
                double hist_k_max_29498;
                
                hist_k_max_29498 = fmin64(0.4 *
                                          (sitofp_i32_f64(L2_sizze_29494) /
                                           sitofp_i32_f64(sext_i64_i32((int32_t) sizeof(int32_t) +
                                           (int32_t) sizeof(int64_t)))) *
                                          hist_RACE_exp_29495,
                                          sitofp_i32_f64(flat_dim_25607)) /
                    sitofp_i32_f64(sext_i64_i32(num_groups_27441 *
                    seghist_group_sizze_27439));
                
                int64_t hist_u_29499;
                
                hist_u_29499 = 1;
                
                double hist_C_29500;
                
                hist_C_29500 =
                    fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_27441 *
                           seghist_group_sizze_27439)),
                           sitofp_i32_f64(hist_u_29499 * hist_H_chk_29497) /
                           hist_k_max_29498);
                
                int32_t hist_M_29501;
                
                hist_M_29501 = smax32(hist_M_min_29493,
                                      sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_27441 *
                                      seghist_group_sizze_27439)) /
                                      hist_C_29500)));
                if (ctx->debugging)
                    fprintf(stderr, "%s: %f%c",
                            "Elements/thread in L2 cache (k_max)",
                            (double) hist_k_max_29498, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                            (long long) hist_M_29501, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %f%c", "Cooperation level (C)",
                            (double) hist_C_29500, '\n');
                num_subhistos_29431 = sext_i32_i64(hist_M_29501);
                if (hist_M_29501 == 1) {
                    if (memblock_set_device(ctx, &res_subhistos_mem_29432,
                                            &mem_28980, "mem_28980") != 0)
                        return 1;
                } else {
                    if (num_subhistos_29431 == 1) {
                        if (memblock_set_device(ctx, &res_subhistos_mem_29432,
                                                &mem_28980, "mem_28980") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &res_subhistos_mem_29432,
                                                  sext_i32_i64(num_subhistos_29431) *
                                                  res_25889 *
                                                  (int32_t) sizeof(int64_t),
                                                  "res_subhistos_mem_29432")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx,
                                                          res_subhistos_mem_29432,
                                                          num_subhistos_29431 *
                                                          res_25889, 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (res_25889 * (int32_t) sizeof(int64_t) > 0) {
                            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                         mem_28980.mem,
                                                                         res_subhistos_mem_29432.mem,
                                                                         0, 0,
                                                                         res_25889 *
                                                                         (int32_t) sizeof(int64_t),
                                                                         0,
                                                                         NULL,
                                                                         ctx->profiling_paused ||
                                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
                            if (ctx->debugging)
                                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        }
                    }
                }
                
                struct memblock_device mainzihist_locks_mem_29502 =
                                       ctx->mainzihist_locks_mem_29502;
                
                for (int32_t chk_i_29504 = 0; chk_i_29504 < hist_S_29496;
                     chk_i_29504++) {
                    int64_t hist_H_chk_29505 = sdiv_up64(res_25889,
                                                         sext_i32_i64(hist_S_29496));
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_27444,
                                                            1,
                                                            sizeof(flat_dim_25607),
                                                            &flat_dim_25607));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_27444,
                                                            2,
                                                            sizeof(res_25889),
                                                            &res_25889));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_27444,
                                                            3,
                                                            sizeof(num_groups_27441),
                                                            &num_groups_27441));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_27444,
                                                            4,
                                                            sizeof(mem_28973.mem),
                                                            &mem_28973.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_27444,
                                                            5,
                                                            sizeof(num_subhistos_29431),
                                                            &num_subhistos_29431));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_27444,
                                                            6,
                                                            sizeof(res_subhistos_mem_29432.mem),
                                                            &res_subhistos_mem_29432.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_27444,
                                                            7,
                                                            sizeof(mainzihist_locks_mem_29502.mem),
                                                            &mainzihist_locks_mem_29502.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_27444,
                                                            8,
                                                            sizeof(chk_i_29504),
                                                            &chk_i_29504));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziseghist_global_27444,
                                                            9,
                                                            sizeof(hist_H_chk_29505),
                                                            &hist_H_chk_29505));
                    if (1 * ((size_t) num_groups_27441 *
                             (size_t) seghist_group_sizze_27439) != 0) {
                        const size_t global_work_sizze_30085[1] =
                                     {(size_t) num_groups_27441 *
                                     (size_t) seghist_group_sizze_27439};
                        const size_t local_work_sizze_30089[1] =
                                     {seghist_group_sizze_27439};
                        int64_t time_start_30086 = 0, time_end_30087 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.seghist_global_27444");
                            fprintf(stderr, "%zu", global_work_sizze_30085[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_30089[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) 0);
                            time_start_30086 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainziseghist_global_27444,
                                                                        1, NULL,
                                                                        global_work_sizze_30085,
                                                                        local_work_sizze_30089,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainziseghist_global_27444_runs,
                                                                                                                  &ctx->mainziseghist_global_27444_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_30087 = get_wall_time();
                            
                            long time_diff_30088 = time_end_30087 -
                                 time_start_30086;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.seghist_global_27444",
                                    time_diff_30088);
                        }
                    }
                }
            }
            if (num_subhistos_29431 == 1) {
                if (memblock_set_device(ctx, &mem_28980,
                                        &res_subhistos_mem_29432,
                                        "res_subhistos_mem_29432") != 0)
                    return 1;
            } else {
                if (slt64(num_subhistos_29431 * 2, seghist_group_sizze_27439)) {
                    int64_t segment_sizze_nonzzero_29518 = smax64(1,
                                                                  num_subhistos_29431);
                    int64_t num_threads_29519 = num_groups_27441 *
                            seghist_group_sizze_27439;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-small");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) res_25889, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) num_subhistos_29431, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segments_per_group",
                                (long long) squot64(seghist_group_sizze_27439,
                                                    segment_sizze_nonzzero_29518),
                                '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "required_groups",
                                (long long) sext_i64_i32(sdiv_up64(res_25889,
                                                                   squot64(seghist_group_sizze_27439,
                                                                           segment_sizze_nonzzero_29518))),
                                '\n');
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_29517,
                                                            1,
                                                            (int32_t) sizeof(int64_t) *
                                                            seghist_group_sizze_27439,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_29517,
                                                            2,
                                                            sizeof(res_25889),
                                                            &res_25889));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_29517,
                                                            3,
                                                            sizeof(num_groups_27441),
                                                            &num_groups_27441));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_29517,
                                                            4,
                                                            sizeof(mem_28980.mem),
                                                            &mem_28980.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_29517,
                                                            5,
                                                            sizeof(num_subhistos_29431),
                                                            &num_subhistos_29431));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_29517,
                                                            6,
                                                            sizeof(res_subhistos_mem_29432.mem),
                                                            &res_subhistos_mem_29432.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_29517,
                                                            7,
                                                            sizeof(segment_sizze_nonzzero_29518),
                                                            &segment_sizze_nonzzero_29518));
                    if (1 * ((size_t) num_groups_27441 *
                             (size_t) seghist_group_sizze_27439) != 0) {
                        const size_t global_work_sizze_30090[1] =
                                     {(size_t) num_groups_27441 *
                                     (size_t) seghist_group_sizze_27439};
                        const size_t local_work_sizze_30094[1] =
                                     {seghist_group_sizze_27439};
                        int64_t time_start_30091 = 0, time_end_30092 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.segred_small_29517");
                            fprintf(stderr, "%zu", global_work_sizze_30090[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_30094[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(int64_t) *
                                           seghist_group_sizze_27439));
                            time_start_30091 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainzisegred_small_29517,
                                                                        1, NULL,
                                                                        global_work_sizze_30090,
                                                                        local_work_sizze_30094,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainzisegred_small_29517_runs,
                                                                                                                  &ctx->mainzisegred_small_29517_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_30092 = get_wall_time();
                            
                            long time_diff_30093 = time_end_30092 -
                                 time_start_30091;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.segred_small_29517", time_diff_30093);
                        }
                    }
                } else {
                    int64_t groups_per_segment_29539 =
                            sdiv_up64(num_groups_27441, smax64(1, res_25889));
                    int64_t elements_per_thread_29540 =
                            sdiv_up64(num_subhistos_29431,
                                      seghist_group_sizze_27439 *
                                      groups_per_segment_29539);
                    int64_t virt_num_groups_29541 = groups_per_segment_29539 *
                            res_25889;
                    int64_t num_threads_29542 = num_groups_27441 *
                            seghist_group_sizze_27439;
                    int64_t threads_per_segment_29543 =
                            groups_per_segment_29539 *
                            seghist_group_sizze_27439;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-large");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) res_25889, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) num_subhistos_29431, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                                (long long) virt_num_groups_29541, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_groups",
                                (long long) num_groups_27441, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "group_size",
                                (long long) seghist_group_sizze_27439, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                                (long long) elements_per_thread_29540, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                                (long long) groups_per_segment_29539, '\n');
                    
                    struct memblock_device group_res_arr_mem_29544;
                    
                    group_res_arr_mem_29544.references = NULL;
                    if (memblock_alloc_device(ctx, &group_res_arr_mem_29544,
                                              (int32_t) sizeof(int64_t) *
                                              (seghist_group_sizze_27439 *
                                               virt_num_groups_29541),
                                              "group_res_arr_mem_29544")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device mainzicounter_mem_29546 =
                                           ctx->mainzicounter_mem_29546;
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_29517,
                                                            1,
                                                            (int32_t) sizeof(bool),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_29517,
                                                            2,
                                                            (int32_t) sizeof(int64_t) *
                                                            seghist_group_sizze_27439,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_29517,
                                                            3,
                                                            sizeof(res_25889),
                                                            &res_25889));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_29517,
                                                            4,
                                                            sizeof(num_groups_27441),
                                                            &num_groups_27441));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_29517,
                                                            5,
                                                            sizeof(mem_28980.mem),
                                                            &mem_28980.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_29517,
                                                            6,
                                                            sizeof(num_subhistos_29431),
                                                            &num_subhistos_29431));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_29517,
                                                            7,
                                                            sizeof(res_subhistos_mem_29432.mem),
                                                            &res_subhistos_mem_29432.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_29517,
                                                            8,
                                                            sizeof(groups_per_segment_29539),
                                                            &groups_per_segment_29539));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_29517,
                                                            9,
                                                            sizeof(elements_per_thread_29540),
                                                            &elements_per_thread_29540));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_29517,
                                                            10,
                                                            sizeof(virt_num_groups_29541),
                                                            &virt_num_groups_29541));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_29517,
                                                            11,
                                                            sizeof(threads_per_segment_29543),
                                                            &threads_per_segment_29543));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_29517,
                                                            12,
                                                            sizeof(group_res_arr_mem_29544.mem),
                                                            &group_res_arr_mem_29544.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_29517,
                                                            13,
                                                            sizeof(mainzicounter_mem_29546.mem),
                                                            &mainzicounter_mem_29546.mem));
                    if (1 * ((size_t) num_groups_27441 *
                             (size_t) seghist_group_sizze_27439) != 0) {
                        const size_t global_work_sizze_30096[1] =
                                     {(size_t) num_groups_27441 *
                                     (size_t) seghist_group_sizze_27439};
                        const size_t local_work_sizze_30100[1] =
                                     {seghist_group_sizze_27439};
                        int64_t time_start_30097 = 0, time_end_30098 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.segred_large_29517");
                            fprintf(stderr, "%zu", global_work_sizze_30096[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_30100[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(bool) +
                                           (int32_t) sizeof(int64_t) *
                                           seghist_group_sizze_27439));
                            time_start_30097 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainzisegred_large_29517,
                                                                        1, NULL,
                                                                        global_work_sizze_30096,
                                                                        local_work_sizze_30100,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainzisegred_large_29517_runs,
                                                                                                                  &ctx->mainzisegred_large_29517_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_30098 = get_wall_time();
                            
                            long time_diff_30099 = time_end_30098 -
                                 time_start_30097;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.segred_large_29517", time_diff_30099);
                        }
                    }
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29544,
                                              "group_res_arr_mem_29544") != 0)
                        return 1;
                }
            }
        }
        
        int64_t num_groups_27456;
        int32_t max_num_groups_29578;
        
        max_num_groups_29578 = ctx->sizes.mainzisegscan_num_groups_27455;
        num_groups_27456 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_25889,
                                                                   sext_i32_i64(segscan_group_sizze_27454)),
                                                         sext_i32_i64(max_num_groups_29578))));
        
        struct memblock_device mem_28984;
        
        mem_28984.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28984, res_25889, "mem_28984")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28986;
        
        mem_28986.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28986, bytes_28979, "mem_28986")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_25889)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_29579;
            
            stage1_max_num_groups_29579 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_29580;
            
            stage1_num_groups_29580 = smin64(stage1_max_num_groups_29579,
                                             num_groups_27456);
            
            int32_t num_threads_29581;
            
            num_threads_29581 = sext_i64_i32(stage1_num_groups_29580 *
                segscan_group_sizze_27454);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27459,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_27454),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27459,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              segscan_group_sizze_27454),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27459,
                                                    3, sizeof(res_25889),
                                                    &res_25889));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27459,
                                                    4, sizeof(mem_28980.mem),
                                                    &mem_28980.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27459,
                                                    5, sizeof(mem_28984.mem),
                                                    &mem_28984.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27459,
                                                    6, sizeof(mem_28986.mem),
                                                    &mem_28986.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27459,
                                                    7,
                                                    sizeof(num_threads_29581),
                                                    &num_threads_29581));
            if (1 * ((size_t) stage1_num_groups_29580 *
                     (size_t) segscan_group_sizze_27454) != 0) {
                const size_t global_work_sizze_30101[1] =
                             {(size_t) stage1_num_groups_29580 *
                             (size_t) segscan_group_sizze_27454};
                const size_t local_work_sizze_30105[1] =
                             {segscan_group_sizze_27454};
                int64_t time_start_30102 = 0, time_end_30103 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage1_27459");
                    fprintf(stderr, "%zu", global_work_sizze_30101[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30105[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_27454) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          segscan_group_sizze_27454)));
                    time_start_30102 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage1_27459,
                                                                1, NULL,
                                                                global_work_sizze_30101,
                                                                local_work_sizze_30105,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage1_27459_runs,
                                                                                                          &ctx->mainziscan_stage1_27459_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30103 = get_wall_time();
                    
                    long time_diff_30104 = time_end_30103 - time_start_30102;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage1_27459", time_diff_30104);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_27454 *
                                     sdiv_up64(res_25889,
                                               sext_i32_i64(num_threads_29581))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27459,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_29580),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27459,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              stage1_num_groups_29580),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27459,
                                                    3, sizeof(res_25889),
                                                    &res_25889));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27459,
                                                    4, sizeof(mem_28984.mem),
                                                    &mem_28984.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27459,
                                                    5, sizeof(mem_28986.mem),
                                                    &mem_28986.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27459,
                                                    6,
                                                    sizeof(stage1_num_groups_29580),
                                                    &stage1_num_groups_29580));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27459,
                                                    7,
                                                    sizeof(num_threads_29581),
                                                    &num_threads_29581));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_29580) != 0) {
                const size_t global_work_sizze_30106[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_29580};
                const size_t local_work_sizze_30110[1] =
                             {stage1_num_groups_29580};
                int64_t time_start_30107 = 0, time_end_30108 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage2_27459");
                    fprintf(stderr, "%zu", global_work_sizze_30106[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30110[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_29580) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          stage1_num_groups_29580)));
                    time_start_30107 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage2_27459,
                                                                1, NULL,
                                                                global_work_sizze_30106,
                                                                local_work_sizze_30110,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage2_27459_runs,
                                                                                                          &ctx->mainziscan_stage2_27459_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30108 = get_wall_time();
                    
                    long time_diff_30109 = time_end_30108 - time_start_30107;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage2_27459", time_diff_30109);
                }
            }
            
            int32_t required_groups_29633;
            
            required_groups_29633 = sext_i64_i32(sdiv_up64(res_25889,
                                                           segscan_group_sizze_27454));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27459,
                                                    1, sizeof(res_25889),
                                                    &res_25889));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27459,
                                                    2, sizeof(num_groups_27456),
                                                    &num_groups_27456));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27459,
                                                    3, sizeof(mem_28984.mem),
                                                    &mem_28984.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27459,
                                                    4, sizeof(mem_28986.mem),
                                                    &mem_28986.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27459,
                                                    5,
                                                    sizeof(num_threads_29581),
                                                    &num_threads_29581));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27459,
                                                    6,
                                                    sizeof(required_groups_29633),
                                                    &required_groups_29633));
            if (1 * ((size_t) num_groups_27456 *
                     (size_t) segscan_group_sizze_27454) != 0) {
                const size_t global_work_sizze_30111[1] =
                             {(size_t) num_groups_27456 *
                             (size_t) segscan_group_sizze_27454};
                const size_t local_work_sizze_30115[1] =
                             {segscan_group_sizze_27454};
                int64_t time_start_30112 = 0, time_end_30113 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage3_27459");
                    fprintf(stderr, "%zu", global_work_sizze_30111[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30115[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_30112 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage3_27459,
                                                                1, NULL,
                                                                global_work_sizze_30111,
                                                                local_work_sizze_30115,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage3_27459_runs,
                                                                                                          &ctx->mainziscan_stage3_27459_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30113 = get_wall_time();
                    
                    long time_diff_30114 = time_end_30113 - time_start_30112;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage3_27459", time_diff_30114);
                }
            }
        }
        if (memblock_unref_device(ctx, &mem_28980, "mem_28980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28984, "mem_28984") != 0)
            return 1;
        
        int64_t num_groups_27464;
        int32_t max_num_groups_29645;
        
        max_num_groups_29645 = ctx->sizes.mainzisegscan_num_groups_27463;
        num_groups_27464 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_25889,
                                                                   sext_i32_i64(segscan_group_sizze_27462)),
                                                         sext_i32_i64(max_num_groups_29645))));
        
        struct memblock_device mem_28989;
        
        mem_28989.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28989, res_25889, "mem_28989")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28991;
        
        mem_28991.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28991, bytes_28979, "mem_28991")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28993;
        
        mem_28993.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28993, res_25889, "mem_28993")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_25889)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_29646;
            
            stage1_max_num_groups_29646 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_29647;
            
            stage1_num_groups_29647 = smin64(stage1_max_num_groups_29646,
                                             num_groups_27464);
            
            int32_t num_threads_29648;
            
            num_threads_29648 = sext_i64_i32(stage1_num_groups_29647 *
                segscan_group_sizze_27462);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27467,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_27462),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27467,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              segscan_group_sizze_27462),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27467,
                                                    3, sizeof(res_25889),
                                                    &res_25889));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27467,
                                                    4, sizeof(mem_28986.mem),
                                                    &mem_28986.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27467,
                                                    5, sizeof(mem_28989.mem),
                                                    &mem_28989.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27467,
                                                    6, sizeof(mem_28991.mem),
                                                    &mem_28991.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27467,
                                                    7, sizeof(mem_28993.mem),
                                                    &mem_28993.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27467,
                                                    8,
                                                    sizeof(num_threads_29648),
                                                    &num_threads_29648));
            if (1 * ((size_t) stage1_num_groups_29647 *
                     (size_t) segscan_group_sizze_27462) != 0) {
                const size_t global_work_sizze_30116[1] =
                             {(size_t) stage1_num_groups_29647 *
                             (size_t) segscan_group_sizze_27462};
                const size_t local_work_sizze_30120[1] =
                             {segscan_group_sizze_27462};
                int64_t time_start_30117 = 0, time_end_30118 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage1_27467");
                    fprintf(stderr, "%zu", global_work_sizze_30116[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30120[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_27462) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          segscan_group_sizze_27462)));
                    time_start_30117 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage1_27467,
                                                                1, NULL,
                                                                global_work_sizze_30116,
                                                                local_work_sizze_30120,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage1_27467_runs,
                                                                                                          &ctx->mainziscan_stage1_27467_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30118 = get_wall_time();
                    
                    long time_diff_30119 = time_end_30118 - time_start_30117;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage1_27467", time_diff_30119);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_27462 *
                                     sdiv_up64(res_25889,
                                               sext_i32_i64(num_threads_29648))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27467,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_29647),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27467,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              stage1_num_groups_29647),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27467,
                                                    3, sizeof(res_25889),
                                                    &res_25889));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27467,
                                                    4, sizeof(mem_28989.mem),
                                                    &mem_28989.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27467,
                                                    5, sizeof(mem_28991.mem),
                                                    &mem_28991.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27467,
                                                    6,
                                                    sizeof(stage1_num_groups_29647),
                                                    &stage1_num_groups_29647));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27467,
                                                    7,
                                                    sizeof(num_threads_29648),
                                                    &num_threads_29648));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_29647) != 0) {
                const size_t global_work_sizze_30121[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_29647};
                const size_t local_work_sizze_30125[1] =
                             {stage1_num_groups_29647};
                int64_t time_start_30122 = 0, time_end_30123 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage2_27467");
                    fprintf(stderr, "%zu", global_work_sizze_30121[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30125[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_29647) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          stage1_num_groups_29647)));
                    time_start_30122 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage2_27467,
                                                                1, NULL,
                                                                global_work_sizze_30121,
                                                                local_work_sizze_30125,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage2_27467_runs,
                                                                                                          &ctx->mainziscan_stage2_27467_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30123 = get_wall_time();
                    
                    long time_diff_30124 = time_end_30123 - time_start_30122;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage2_27467", time_diff_30124);
                }
            }
            
            int32_t required_groups_29700;
            
            required_groups_29700 = sext_i64_i32(sdiv_up64(res_25889,
                                                           segscan_group_sizze_27462));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27467,
                                                    1, sizeof(res_25889),
                                                    &res_25889));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27467,
                                                    2, sizeof(num_groups_27464),
                                                    &num_groups_27464));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27467,
                                                    3, sizeof(mem_28989.mem),
                                                    &mem_28989.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27467,
                                                    4, sizeof(mem_28991.mem),
                                                    &mem_28991.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27467,
                                                    5,
                                                    sizeof(num_threads_29648),
                                                    &num_threads_29648));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27467,
                                                    6,
                                                    sizeof(required_groups_29700),
                                                    &required_groups_29700));
            if (1 * ((size_t) num_groups_27464 *
                     (size_t) segscan_group_sizze_27462) != 0) {
                const size_t global_work_sizze_30126[1] =
                             {(size_t) num_groups_27464 *
                             (size_t) segscan_group_sizze_27462};
                const size_t local_work_sizze_30130[1] =
                             {segscan_group_sizze_27462};
                int64_t time_start_30127 = 0, time_end_30128 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage3_27467");
                    fprintf(stderr, "%zu", global_work_sizze_30126[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30130[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_30127 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage3_27467,
                                                                1, NULL,
                                                                global_work_sizze_30126,
                                                                local_work_sizze_30130,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage3_27467_runs,
                                                                                                          &ctx->mainziscan_stage3_27467_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30128 = get_wall_time();
                    
                    long time_diff_30129 = time_end_30128 - time_start_30127;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage3_27467", time_diff_30129);
                }
            }
        }
        if (memblock_unref_device(ctx, &mem_28989, "mem_28989") != 0)
            return 1;
        
        int64_t num_groups_27472;
        int32_t max_num_groups_29712;
        
        max_num_groups_29712 = ctx->sizes.mainzisegscan_num_groups_27471;
        num_groups_27472 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_25889,
                                                                   sext_i32_i64(segscan_group_sizze_27470)),
                                                         sext_i32_i64(max_num_groups_29712))));
        
        struct memblock_device mem_28996;
        
        mem_28996.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28996, res_25889, "mem_28996")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t bytes_28997 = 4 * res_25889;
        struct memblock_device mem_28998;
        
        mem_28998.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28998, bytes_28997, "mem_28998")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_25889)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_29713;
            
            stage1_max_num_groups_29713 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_29714;
            
            stage1_num_groups_29714 = smin64(stage1_max_num_groups_29713,
                                             num_groups_27472);
            
            int32_t num_threads_29715;
            
            num_threads_29715 = sext_i64_i32(stage1_num_groups_29714 *
                segscan_group_sizze_27470);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    1,
                                                    sizeof(ctx->failure_is_an_option),
                                                    &ctx->failure_is_an_option));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    3, smax64(1,
                                                              (int32_t) sizeof(float) *
                                                              segscan_group_sizze_27470),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    4, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              segscan_group_sizze_27470),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    5, sizeof(n_25418),
                                                    &n_25418));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    6, sizeof(paths_25421),
                                                    &paths_25421));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    7, sizeof(a_25426),
                                                    &a_25426));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    8, sizeof(b_25427),
                                                    &b_25427));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    9, sizeof(sigma_25428),
                                                    &sigma_25428));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    10, sizeof(flat_dim_25607),
                                                    &flat_dim_25607));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    11, sizeof(res_25869),
                                                    &res_25869));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    12, sizeof(res_25889),
                                                    &res_25889));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    13, sizeof(i_27351),
                                                    &i_27351));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    14,
                                                    sizeof(res_mem_28930.mem),
                                                    &res_mem_28930.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    15,
                                                    sizeof(res_mem_28931.mem),
                                                    &res_mem_28931.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    16,
                                                    sizeof(res_mem_28932.mem),
                                                    &res_mem_28932.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    17,
                                                    sizeof(res_mem_28933.mem),
                                                    &res_mem_28933.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    18, sizeof(mem_28961.mem),
                                                    &mem_28961.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    19, sizeof(mem_28986.mem),
                                                    &mem_28986.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    20, sizeof(mem_28991.mem),
                                                    &mem_28991.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    21, sizeof(mem_28993.mem),
                                                    &mem_28993.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    22, sizeof(mem_28996.mem),
                                                    &mem_28996.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    23, sizeof(mem_28998.mem),
                                                    &mem_28998.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27475,
                                                    24,
                                                    sizeof(num_threads_29715),
                                                    &num_threads_29715));
            if (1 * ((size_t) stage1_num_groups_29714 *
                     (size_t) segscan_group_sizze_27470) != 0) {
                const size_t global_work_sizze_30131[1] =
                             {(size_t) stage1_num_groups_29714 *
                             (size_t) segscan_group_sizze_27470};
                const size_t local_work_sizze_30135[1] =
                             {segscan_group_sizze_27470};
                int64_t time_start_30132 = 0, time_end_30133 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage1_27475");
                    fprintf(stderr, "%zu", global_work_sizze_30131[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30135[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                              segscan_group_sizze_27470) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          segscan_group_sizze_27470)));
                    time_start_30132 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage1_27475,
                                                                1, NULL,
                                                                global_work_sizze_30131,
                                                                local_work_sizze_30135,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage1_27475_runs,
                                                                                                          &ctx->mainziscan_stage1_27475_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30133 = get_wall_time();
                    
                    long time_diff_30134 = time_end_30133 - time_start_30132;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage1_27475", time_diff_30134);
                }
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_27470 *
                                     sdiv_up64(res_25889,
                                               sext_i32_i64(num_threads_29715))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27475,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(float) *
                                                              stage1_num_groups_29714),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27475,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              stage1_num_groups_29714),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27475,
                                                    3, sizeof(res_25889),
                                                    &res_25889));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27475,
                                                    4, sizeof(mem_28996.mem),
                                                    &mem_28996.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27475,
                                                    5, sizeof(mem_28998.mem),
                                                    &mem_28998.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27475,
                                                    6,
                                                    sizeof(stage1_num_groups_29714),
                                                    &stage1_num_groups_29714));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27475,
                                                    7,
                                                    sizeof(num_threads_29715),
                                                    &num_threads_29715));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_29714) != 0) {
                const size_t global_work_sizze_30136[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_29714};
                const size_t local_work_sizze_30140[1] =
                             {stage1_num_groups_29714};
                int64_t time_start_30137 = 0, time_end_30138 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage2_27475");
                    fprintf(stderr, "%zu", global_work_sizze_30136[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30140[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                              stage1_num_groups_29714) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          stage1_num_groups_29714)));
                    time_start_30137 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage2_27475,
                                                                1, NULL,
                                                                global_work_sizze_30136,
                                                                local_work_sizze_30140,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage2_27475_runs,
                                                                                                          &ctx->mainziscan_stage2_27475_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30138 = get_wall_time();
                    
                    long time_diff_30139 = time_end_30138 - time_start_30137;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage2_27475", time_diff_30139);
                }
            }
            
            int32_t required_groups_29767;
            
            required_groups_29767 = sext_i64_i32(sdiv_up64(res_25889,
                                                           segscan_group_sizze_27470));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27475,
                                                    1, sizeof(res_25889),
                                                    &res_25889));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27475,
                                                    2, sizeof(num_groups_27472),
                                                    &num_groups_27472));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27475,
                                                    3, sizeof(mem_28996.mem),
                                                    &mem_28996.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27475,
                                                    4, sizeof(mem_28998.mem),
                                                    &mem_28998.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27475,
                                                    5,
                                                    sizeof(num_threads_29715),
                                                    &num_threads_29715));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27475,
                                                    6,
                                                    sizeof(required_groups_29767),
                                                    &required_groups_29767));
            if (1 * ((size_t) num_groups_27472 *
                     (size_t) segscan_group_sizze_27470) != 0) {
                const size_t global_work_sizze_30141[1] =
                             {(size_t) num_groups_27472 *
                             (size_t) segscan_group_sizze_27470};
                const size_t local_work_sizze_30145[1] =
                             {segscan_group_sizze_27470};
                int64_t time_start_30142 = 0, time_end_30143 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage3_27475");
                    fprintf(stderr, "%zu", global_work_sizze_30141[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30145[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_30142 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage3_27475,
                                                                1, NULL,
                                                                global_work_sizze_30141,
                                                                local_work_sizze_30145,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage3_27475_runs,
                                                                                                          &ctx->mainziscan_stage3_27475_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30143 = get_wall_time();
                    
                    long time_diff_30144 = time_end_30143 - time_start_30142;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage3_27475", time_diff_30144);
                }
            }
        }
        if (memblock_unref_device(ctx, &mem_28986, "mem_28986") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28991, "mem_28991") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28996, "mem_28996") != 0)
            return 1;
        
        int64_t num_groups_27524;
        int32_t max_num_groups_29779;
        
        max_num_groups_29779 = ctx->sizes.mainzisegscan_num_groups_27523;
        num_groups_27524 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_25889,
                                                                   sext_i32_i64(segscan_group_sizze_27522)),
                                                         sext_i32_i64(max_num_groups_29779))));
        
        struct memblock_device mem_29001;
        
        mem_29001.references = NULL;
        if (memblock_alloc_device(ctx, &mem_29001, bytes_28979, "mem_29001")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_25889)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_29780;
            
            stage1_max_num_groups_29780 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_29781;
            
            stage1_num_groups_29781 = smin64(stage1_max_num_groups_29780,
                                             num_groups_27524);
            
            int32_t num_threads_29782;
            
            num_threads_29782 = sext_i64_i32(stage1_num_groups_29781 *
                segscan_group_sizze_27522);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27527,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_27522),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27527,
                                                    2, sizeof(res_25889),
                                                    &res_25889));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27527,
                                                    3, sizeof(mem_28993.mem),
                                                    &mem_28993.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27527,
                                                    4, sizeof(mem_29001.mem),
                                                    &mem_29001.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage1_27527,
                                                    5,
                                                    sizeof(num_threads_29782),
                                                    &num_threads_29782));
            if (1 * ((size_t) stage1_num_groups_29781 *
                     (size_t) segscan_group_sizze_27522) != 0) {
                const size_t global_work_sizze_30146[1] =
                             {(size_t) stage1_num_groups_29781 *
                             (size_t) segscan_group_sizze_27522};
                const size_t local_work_sizze_30150[1] =
                             {segscan_group_sizze_27522};
                int64_t time_start_30147 = 0, time_end_30148 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage1_27527");
                    fprintf(stderr, "%zu", global_work_sizze_30146[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30150[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_27522)));
                    time_start_30147 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage1_27527,
                                                                1, NULL,
                                                                global_work_sizze_30146,
                                                                local_work_sizze_30150,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage1_27527_runs,
                                                                                                          &ctx->mainziscan_stage1_27527_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30148 = get_wall_time();
                    
                    long time_diff_30149 = time_end_30148 - time_start_30147;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage1_27527", time_diff_30149);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_27522 *
                                     sdiv_up64(res_25889,
                                               sext_i32_i64(num_threads_29782))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27527,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_29781),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27527,
                                                    2, sizeof(res_25889),
                                                    &res_25889));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27527,
                                                    3, sizeof(mem_29001.mem),
                                                    &mem_29001.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27527,
                                                    4,
                                                    sizeof(stage1_num_groups_29781),
                                                    &stage1_num_groups_29781));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage2_27527,
                                                    5,
                                                    sizeof(num_threads_29782),
                                                    &num_threads_29782));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_29781) != 0) {
                const size_t global_work_sizze_30151[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_29781};
                const size_t local_work_sizze_30155[1] =
                             {stage1_num_groups_29781};
                int64_t time_start_30152 = 0, time_end_30153 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage2_27527");
                    fprintf(stderr, "%zu", global_work_sizze_30151[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30155[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_29781)));
                    time_start_30152 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage2_27527,
                                                                1, NULL,
                                                                global_work_sizze_30151,
                                                                local_work_sizze_30155,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage2_27527_runs,
                                                                                                          &ctx->mainziscan_stage2_27527_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30153 = get_wall_time();
                    
                    long time_diff_30154 = time_end_30153 - time_start_30152;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage2_27527", time_diff_30154);
                }
            }
            
            int32_t required_groups_29818;
            
            required_groups_29818 = sext_i64_i32(sdiv_up64(res_25889,
                                                           segscan_group_sizze_27522));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27527,
                                                    1, sizeof(res_25889),
                                                    &res_25889));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27527,
                                                    2, sizeof(num_groups_27524),
                                                    &num_groups_27524));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27527,
                                                    3, sizeof(mem_29001.mem),
                                                    &mem_29001.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27527,
                                                    4,
                                                    sizeof(num_threads_29782),
                                                    &num_threads_29782));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainziscan_stage3_27527,
                                                    5,
                                                    sizeof(required_groups_29818),
                                                    &required_groups_29818));
            if (1 * ((size_t) num_groups_27524 *
                     (size_t) segscan_group_sizze_27522) != 0) {
                const size_t global_work_sizze_30156[1] =
                             {(size_t) num_groups_27524 *
                             (size_t) segscan_group_sizze_27522};
                const size_t local_work_sizze_30160[1] =
                             {segscan_group_sizze_27522};
                int64_t time_start_30157 = 0, time_end_30158 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.scan_stage3_27527");
                    fprintf(stderr, "%zu", global_work_sizze_30156[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30160[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_30157 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainziscan_stage3_27527,
                                                                1, NULL,
                                                                global_work_sizze_30156,
                                                                local_work_sizze_30160,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainziscan_stage3_27527_runs,
                                                                                                          &ctx->mainziscan_stage3_27527_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30158 = get_wall_time();
                    
                    long time_diff_30159 = time_end_30158 - time_start_30157;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.scan_stage3_27527", time_diff_30159);
                }
            }
        }
        
        bool cond_26081 = slt64(0, res_25889);
        int64_t num_segments_26082;
        
        if (cond_26081) {
            int64_t i_26083 = sub64(res_25889, 1);
            bool x_26084 = sle64(0, i_26083);
            bool y_26085 = slt64(i_26083, res_25889);
            bool bounds_check_26086 = x_26084 && y_26085;
            bool index_certs_26087;
            
            if (!bounds_check_26086) {
                ctx->error =
                    msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                              "Index [", i_26083,
                              "] out of bounds for array of shape [", res_25889,
                              "].",
                              "-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:29:36-59\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #4  cva.fut:133:38-97\n   #5  /prelude/soacs.fut:56:19-23\n   #6  /prelude/soacs.fut:56:3-37\n   #7  cva.fut:126:44-136:50\n   #8  cva.fut:100:1-158:20\n");
                if (memblock_unref_device(ctx, &mem_29001, "mem_29001") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28998, "mem_28998") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28996, "mem_28996") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28993, "mem_28993") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28991, "mem_28991") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28989, "mem_28989") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28986, "mem_28986") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28984, "mem_28984") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_subhistos_mem_29432,
                                          "res_subhistos_mem_29432") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28980, "mem_28980") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_29394,
                                          "group_res_arr_mem_29394") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28978, "mem_28978") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28975, "mem_28975") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28973, "mem_28973") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28963, "mem_28963") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28946, "mem_28946") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28961, "mem_28961") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28940, "mem_28940") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28936, "mem_28936") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28933,
                                          "res_mem_28933") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28932,
                                          "res_mem_28932") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28931,
                                          "res_mem_28931") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28930,
                                          "res_mem_28930") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_29209,
                                          "group_res_arr_mem_29209") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &out_mem_29204,
                                          "out_mem_29204") != 0)
                    return 1;
                return 1;
            }
            
            int64_t read_res_30161;
            
            OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                         mem_29001.mem,
                                                         ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                         i_26083 *
                                                         sizeof(int64_t),
                                                         sizeof(int64_t),
                                                         &read_res_30161, 0,
                                                         NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_scalar_from_dev_runs,
                                                                                                   &ctx->copy_scalar_from_dev_total_runtime)));
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
                return 1;
            
            int64_t res_26088 = read_res_30161;
            
            num_segments_26082 = res_26088;
        } else {
            num_segments_26082 = 0;
        }
        
        bool bounds_invalid_upwards_26089 = slt64(num_segments_26082, 0);
        bool valid_26090 = !bounds_invalid_upwards_26089;
        bool range_valid_c_26091;
        
        if (!valid_26090) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Range ", 0, "..", 1, "..<", num_segments_26082,
                          " is invalid.",
                          "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:33:17-41\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva.fut:133:38-97\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  cva.fut:126:44-136:50\n   #9  cva.fut:100:1-158:20\n");
            if (memblock_unref_device(ctx, &mem_29001, "mem_29001") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28998, "mem_28998") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28996, "mem_28996") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28993, "mem_28993") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28991, "mem_28991") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28989, "mem_28989") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28986, "mem_28986") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28984, "mem_28984") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_subhistos_mem_29432,
                                      "res_subhistos_mem_29432") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28980, "mem_28980") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29394,
                                      "group_res_arr_mem_29394") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28978, "mem_28978") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28975, "mem_28975") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28973, "mem_28973") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28963, "mem_28963") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28946, "mem_28946") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28961, "mem_28961") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28940, "mem_28940") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28936, "mem_28936") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28933, "res_mem_28933") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28932, "res_mem_28932") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28931, "res_mem_28931") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28930, "res_mem_28930") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29209,
                                      "group_res_arr_mem_29209") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29204, "out_mem_29204") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t bytes_29002 = 4 * num_segments_26082;
        struct memblock_device mem_29003;
        
        mem_29003.references = NULL;
        if (memblock_alloc_device(ctx, &mem_29003, bytes_29002, "mem_29003")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_f32(ctx, mem_29003, num_segments_26082,
                                          0.0F) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t segmap_group_sizze_27532;
        
        segmap_group_sizze_27532 = ctx->sizes.mainzisegmap_group_sizze_27531;
        
        int64_t segmap_usable_groups_27533 = sdiv_up64(res_25889,
                                                       segmap_group_sizze_27532);
        
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27529, 1,
                                                sizeof(res_25889), &res_25889));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27529, 2,
                                                sizeof(num_segments_26082),
                                                &num_segments_26082));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27529, 3,
                                                sizeof(mem_28993.mem),
                                                &mem_28993.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27529, 4,
                                                sizeof(mem_28998.mem),
                                                &mem_28998.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27529, 5,
                                                sizeof(mem_29001.mem),
                                                &mem_29001.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27529, 6,
                                                sizeof(mem_29003.mem),
                                                &mem_29003.mem));
        if (1 * ((size_t) segmap_usable_groups_27533 *
                 (size_t) segmap_group_sizze_27532) != 0) {
            const size_t global_work_sizze_30162[1] =
                         {(size_t) segmap_usable_groups_27533 *
                         (size_t) segmap_group_sizze_27532};
            const size_t local_work_sizze_30166[1] = {segmap_group_sizze_27532};
            int64_t time_start_30163 = 0, time_end_30164 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "main.segmap_27529");
                fprintf(stderr, "%zu", global_work_sizze_30162[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_30166[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_30163 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->mainzisegmap_27529,
                                                            1, NULL,
                                                            global_work_sizze_30162,
                                                            local_work_sizze_30166,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->mainzisegmap_27529_runs,
                                                                                                      &ctx->mainzisegmap_27529_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_30164 = get_wall_time();
                
                long time_diff_30165 = time_end_30164 - time_start_30163;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "main.segmap_27529", time_diff_30165);
            }
        }
        if (memblock_unref_device(ctx, &mem_28993, "mem_28993") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28998, "mem_28998") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29001, "mem_29001") != 0)
            return 1;
        
        bool dim_match_26099 = flat_dim_25607 == num_segments_26082;
        bool empty_or_match_cert_26100;
        
        if (!dim_match_26099) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Value of (core language) shape (",
                                   num_segments_26082,
                                   ") cannot match shape of type `[",
                                   flat_dim_25607, "]b`.",
                                   "-> #0  lib/github.com/diku-dk/segmented/segmented.fut:103:6-45\n   #1  cva.fut:133:38-97\n   #2  /prelude/soacs.fut:56:19-23\n   #3  /prelude/soacs.fut:56:3-37\n   #4  cva.fut:126:44-136:50\n   #5  cva.fut:100:1-158:20\n");
            if (memblock_unref_device(ctx, &mem_29003, "mem_29003") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29001, "mem_29001") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28998, "mem_28998") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28996, "mem_28996") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28993, "mem_28993") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28991, "mem_28991") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28989, "mem_28989") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28986, "mem_28986") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28984, "mem_28984") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_subhistos_mem_29432,
                                      "res_subhistos_mem_29432") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28980, "mem_28980") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29394,
                                      "group_res_arr_mem_29394") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28978, "mem_28978") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28975, "mem_28975") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28973, "mem_28973") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28963, "mem_28963") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28946, "mem_28946") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28961, "mem_28961") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28940, "mem_28940") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28936, "mem_28936") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28933, "res_mem_28933") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28932, "res_mem_28932") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28931, "res_mem_28931") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28930, "res_mem_28930") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29209,
                                      "group_res_arr_mem_29209") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29204, "out_mem_29204") !=
                0)
                return 1;
            return 1;
        }
        
        float res_26102;
        int32_t local_memory_capacity_29977;
        
        local_memory_capacity_29977 = ctx->opencl.max_local_memory;
        if (sle64((int32_t) sizeof(bool) + (int32_t) sizeof(float) *
                  segred_group_sizze_27547,
                  sext_i32_i64(local_memory_capacity_29977)) &&
            suff_outer_redomap_27535) {
            struct memblock_device mem_29007;
            
            mem_29007.references = NULL;
            if (memblock_alloc_device(ctx, &mem_29007, bytes_29005,
                                      "mem_29007")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_29007, 0,
                                                      mem_29003, 0, 1, n_25418,
                                                      paths_25421) != 0) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_29010;
            
            mem_29010.references = NULL;
            if (memblock_alloc_device(ctx, &mem_29010, 4, "mem_29010")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mainzicounter_mem_29844 =
                                   ctx->mainzicounter_mem_29844;
            struct memblock_device group_res_arr_mem_29846;
            
            group_res_arr_mem_29846.references = NULL;
            if (memblock_alloc_device(ctx, &group_res_arr_mem_29846,
                                      (int32_t) sizeof(float) *
                                      (segred_group_sizze_27547 *
                                       num_groups_27548),
                                      "group_res_arr_mem_29846")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_29848;
            
            num_threads_29848 = num_groups_27548 * segred_group_sizze_27547;
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegRed");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27545,
                                                    1, (int32_t) sizeof(float) *
                                                    segred_group_sizze_27547,
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27545,
                                                    2, (int32_t) sizeof(bool),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27545,
                                                    3, sizeof(n_25418),
                                                    &n_25418));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27545,
                                                    4, sizeof(paths_25421),
                                                    &paths_25421));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27545,
                                                    5, sizeof(num_groups_27548),
                                                    &num_groups_27548));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27545,
                                                    6, sizeof(mem_29007.mem),
                                                    &mem_29007.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27545,
                                                    7, sizeof(mem_29010.mem),
                                                    &mem_29010.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27545,
                                                    8,
                                                    sizeof(mainzicounter_mem_29844.mem),
                                                    &mainzicounter_mem_29844.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27545,
                                                    9,
                                                    sizeof(group_res_arr_mem_29846.mem),
                                                    &group_res_arr_mem_29846.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27545,
                                                    10,
                                                    sizeof(num_threads_29848),
                                                    &num_threads_29848));
            if (1 * ((size_t) num_groups_27548 *
                     (size_t) segred_group_sizze_27547) != 0) {
                const size_t global_work_sizze_30168[1] =
                             {(size_t) num_groups_27548 *
                             (size_t) segred_group_sizze_27547};
                const size_t local_work_sizze_30172[1] =
                             {segred_group_sizze_27547};
                int64_t time_start_30169 = 0, time_end_30170 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.segred_nonseg_27545");
                    fprintf(stderr, "%zu", global_work_sizze_30168[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30172[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + (int32_t) sizeof(float) *
                                   segred_group_sizze_27547 +
                                   (int32_t) sizeof(bool)));
                    time_start_30169 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainzisegred_nonseg_27545,
                                                                1, NULL,
                                                                global_work_sizze_30168,
                                                                local_work_sizze_30172,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainzisegred_nonseg_27545_runs,
                                                                                                          &ctx->mainzisegred_nonseg_27545_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30170 = get_wall_time();
                    
                    long time_diff_30171 = time_end_30170 - time_start_30169;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.segred_nonseg_27545", time_diff_30171);
                }
            }
            if (memblock_unref_device(ctx, &mem_29007, "mem_29007") != 0)
                return 1;
            
            float read_res_30173;
            
            OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                         mem_29010.mem,
                                                         ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                         0 * sizeof(float),
                                                         sizeof(float),
                                                         &read_res_30173, 0,
                                                         NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_scalar_from_dev_runs,
                                                                                                   &ctx->copy_scalar_from_dev_total_runtime)));
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
                return 1;
            
            float res_27561 = read_res_30173;
            
            if (memblock_unref_device(ctx, &mem_29010, "mem_29010") != 0)
                return 1;
            res_26102 = res_27561;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29846,
                                      "group_res_arr_mem_29846") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29010, "mem_29010") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29007, "mem_29007") != 0)
                return 1;
        } else {
            struct memblock_device res_map_acc_mem_29023;
            
            res_map_acc_mem_29023.references = NULL;
            
            int32_t local_memory_capacity_29946;
            
            local_memory_capacity_29946 = ctx->opencl.max_local_memory;
            if (sle64(0, sext_i32_i64(local_memory_capacity_29946)) &&
                suff_outer_par_27643) {
                struct memblock_device mem_29013;
                
                mem_29013.references = NULL;
                if (memblock_alloc_device(ctx, &mem_29013, bytes_29005,
                                          "mem_29013")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_29013, 0,
                                                          mem_29003, 0, 1,
                                                          n_25418,
                                                          paths_25421) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_29016;
                
                mem_29016.references = NULL;
                if (memblock_alloc_device(ctx, &mem_29016, bytes_28935,
                                          "mem_29016")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27567,
                                                        1, sizeof(n_25418),
                                                        &n_25418));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27567,
                                                        2, sizeof(paths_25421),
                                                        &paths_25421));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27567,
                                                        3,
                                                        sizeof(mem_29013.mem),
                                                        &mem_29013.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27567,
                                                        4,
                                                        sizeof(mem_29016.mem),
                                                        &mem_29016.mem));
                if (1 * ((size_t) segmap_usable_groups_27647 *
                         (size_t) segmap_group_sizze_27646) != 0) {
                    const size_t global_work_sizze_30174[1] =
                                 {(size_t) segmap_usable_groups_27647 *
                                 (size_t) segmap_group_sizze_27646};
                    const size_t local_work_sizze_30178[1] =
                                 {segmap_group_sizze_27646};
                    int64_t time_start_30175 = 0, time_end_30176 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.segmap_27567");
                        fprintf(stderr, "%zu", global_work_sizze_30174[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_30178[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_30175 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainzisegmap_27567,
                                                                    1, NULL,
                                                                    global_work_sizze_30174,
                                                                    local_work_sizze_30178,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainzisegmap_27567_runs,
                                                                                                              &ctx->mainzisegmap_27567_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_30176 = get_wall_time();
                        
                        long time_diff_30177 = time_end_30176 -
                             time_start_30175;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.segmap_27567", time_diff_30177);
                    }
                }
                if (memblock_unref_device(ctx, &mem_29013, "mem_29013") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_29023, &mem_29016,
                                        "mem_29016") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_29016, "mem_29016") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_29013, "mem_29013") != 0)
                    return 1;
            } else {
                struct memblock_device mem_29019;
                
                mem_29019.references = NULL;
                if (memblock_alloc_device(ctx, &mem_29019, bytes_28935,
                                          "mem_29019")) {
                    err = 1;
                    goto cleanup;
                }
                if (slt64(n_25418 * 2, segred_group_sizze_27658)) {
                    int64_t segment_sizze_nonzzero_29881 = smax64(1, n_25418);
                    int64_t num_threads_29882 = num_groups_27659 *
                            segred_group_sizze_27658;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-small");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) paths_25421, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) n_25418, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segments_per_group",
                                (long long) squot64(segred_group_sizze_27658,
                                                    segment_sizze_nonzzero_29881),
                                '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "required_groups",
                                (long long) sext_i64_i32(sdiv_up64(paths_25421,
                                                                   squot64(segred_group_sizze_27658,
                                                                           segment_sizze_nonzzero_29881))),
                                '\n');
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_27608,
                                                            1,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_27658,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_27608,
                                                            2, sizeof(n_25418),
                                                            &n_25418));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_27608,
                                                            3,
                                                            sizeof(paths_25421),
                                                            &paths_25421));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_27608,
                                                            4,
                                                            sizeof(num_groups_27659),
                                                            &num_groups_27659));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_27608,
                                                            5,
                                                            sizeof(mem_29003.mem),
                                                            &mem_29003.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_27608,
                                                            6,
                                                            sizeof(mem_29019.mem),
                                                            &mem_29019.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_small_27608,
                                                            7,
                                                            sizeof(segment_sizze_nonzzero_29881),
                                                            &segment_sizze_nonzzero_29881));
                    if (1 * ((size_t) num_groups_27659 *
                             (size_t) segred_group_sizze_27658) != 0) {
                        const size_t global_work_sizze_30179[1] =
                                     {(size_t) num_groups_27659 *
                                     (size_t) segred_group_sizze_27658};
                        const size_t local_work_sizze_30183[1] =
                                     {segred_group_sizze_27658};
                        int64_t time_start_30180 = 0, time_end_30181 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.segred_small_27608");
                            fprintf(stderr, "%zu", global_work_sizze_30179[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_30183[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(float) *
                                           segred_group_sizze_27658));
                            time_start_30180 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainzisegred_small_27608,
                                                                        1, NULL,
                                                                        global_work_sizze_30179,
                                                                        local_work_sizze_30183,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainzisegred_small_27608_runs,
                                                                                                                  &ctx->mainzisegred_small_27608_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_30181 = get_wall_time();
                            
                            long time_diff_30182 = time_end_30181 -
                                 time_start_30180;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.segred_small_27608", time_diff_30182);
                        }
                    }
                } else {
                    int64_t groups_per_segment_29902 =
                            sdiv_up64(num_groups_27659, smax64(1, paths_25421));
                    int64_t elements_per_thread_29903 = sdiv_up64(n_25418,
                                                                  segred_group_sizze_27658 *
                                                                  groups_per_segment_29902);
                    int64_t virt_num_groups_29904 = groups_per_segment_29902 *
                            paths_25421;
                    int64_t num_threads_29905 = num_groups_27659 *
                            segred_group_sizze_27658;
                    int64_t threads_per_segment_29906 =
                            groups_per_segment_29902 * segred_group_sizze_27658;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-large");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) paths_25421, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) n_25418, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                                (long long) virt_num_groups_29904, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_groups",
                                (long long) num_groups_27659, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "group_size",
                                (long long) segred_group_sizze_27658, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                                (long long) elements_per_thread_29903, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                                (long long) groups_per_segment_29902, '\n');
                    
                    struct memblock_device group_res_arr_mem_29907;
                    
                    group_res_arr_mem_29907.references = NULL;
                    if (memblock_alloc_device(ctx, &group_res_arr_mem_29907,
                                              (int32_t) sizeof(float) *
                                              (segred_group_sizze_27658 *
                                               virt_num_groups_29904),
                                              "group_res_arr_mem_29907")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device mainzicounter_mem_29909 =
                                           ctx->mainzicounter_mem_29909;
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_27608,
                                                            1,
                                                            (int32_t) sizeof(bool),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_27608,
                                                            2,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_27658,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_27608,
                                                            3, sizeof(n_25418),
                                                            &n_25418));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_27608,
                                                            4,
                                                            sizeof(num_groups_27659),
                                                            &num_groups_27659));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_27608,
                                                            5,
                                                            sizeof(mem_29003.mem),
                                                            &mem_29003.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_27608,
                                                            6,
                                                            sizeof(mem_29019.mem),
                                                            &mem_29019.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_27608,
                                                            7,
                                                            sizeof(groups_per_segment_29902),
                                                            &groups_per_segment_29902));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_27608,
                                                            8,
                                                            sizeof(elements_per_thread_29903),
                                                            &elements_per_thread_29903));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_27608,
                                                            9,
                                                            sizeof(virt_num_groups_29904),
                                                            &virt_num_groups_29904));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_27608,
                                                            10,
                                                            sizeof(threads_per_segment_29906),
                                                            &threads_per_segment_29906));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_27608,
                                                            11,
                                                            sizeof(group_res_arr_mem_29907.mem),
                                                            &group_res_arr_mem_29907.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_large_27608,
                                                            12,
                                                            sizeof(mainzicounter_mem_29909.mem),
                                                            &mainzicounter_mem_29909.mem));
                    if (1 * ((size_t) num_groups_27659 *
                             (size_t) segred_group_sizze_27658) != 0) {
                        const size_t global_work_sizze_30185[1] =
                                     {(size_t) num_groups_27659 *
                                     (size_t) segred_group_sizze_27658};
                        const size_t local_work_sizze_30189[1] =
                                     {segred_group_sizze_27658};
                        int64_t time_start_30186 = 0, time_end_30187 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "main.segred_large_27608");
                            fprintf(stderr, "%zu", global_work_sizze_30185[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_30189[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(bool) +
                                           (int32_t) sizeof(float) *
                                           segred_group_sizze_27658));
                            time_start_30186 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->mainzisegred_large_27608,
                                                                        1, NULL,
                                                                        global_work_sizze_30185,
                                                                        local_work_sizze_30189,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->mainzisegred_large_27608_runs,
                                                                                                                  &ctx->mainzisegred_large_27608_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_30187 = get_wall_time();
                            
                            long time_diff_30188 = time_end_30187 -
                                 time_start_30186;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "main.segred_large_27608", time_diff_30188);
                        }
                    }
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29907,
                                              "group_res_arr_mem_29907") != 0)
                        return 1;
                }
                
                struct memblock_device mem_29022;
                
                mem_29022.references = NULL;
                if (memblock_alloc_device(ctx, &mem_29022, bytes_28935,
                                          "mem_29022")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27592,
                                                        1, sizeof(paths_25421),
                                                        &paths_25421));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27592,
                                                        2,
                                                        sizeof(mem_29019.mem),
                                                        &mem_29019.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegmap_27592,
                                                        3,
                                                        sizeof(mem_29022.mem),
                                                        &mem_29022.mem));
                if (1 * ((size_t) segmap_usable_groups_27669 *
                         (size_t) segmap_group_sizze_27668) != 0) {
                    const size_t global_work_sizze_30190[1] =
                                 {(size_t) segmap_usable_groups_27669 *
                                 (size_t) segmap_group_sizze_27668};
                    const size_t local_work_sizze_30194[1] =
                                 {segmap_group_sizze_27668};
                    int64_t time_start_30191 = 0, time_end_30192 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "main.segmap_27592");
                        fprintf(stderr, "%zu", global_work_sizze_30190[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_30194[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_30191 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->mainzisegmap_27592,
                                                                    1, NULL,
                                                                    global_work_sizze_30190,
                                                                    local_work_sizze_30194,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->mainzisegmap_27592_runs,
                                                                                                              &ctx->mainzisegmap_27592_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_30192 = get_wall_time();
                        
                        long time_diff_30193 = time_end_30192 -
                             time_start_30191;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "main.segmap_27592", time_diff_30193);
                    }
                }
                if (memblock_unref_device(ctx, &mem_29019, "mem_29019") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_29023, &mem_29022,
                                        "mem_29022") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_29019, "mem_29019") != 0)
                    return 1;
            }
            
            struct memblock_device mem_29026;
            
            mem_29026.references = NULL;
            if (memblock_alloc_device(ctx, &mem_29026, 4, "mem_29026")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mainzicounter_mem_29947 =
                                   ctx->mainzicounter_mem_29947;
            struct memblock_device group_res_arr_mem_29949;
            
            group_res_arr_mem_29949.references = NULL;
            if (memblock_alloc_device(ctx, &group_res_arr_mem_29949,
                                      (int32_t) sizeof(float) *
                                      (segred_group_sizze_27675 *
                                       num_groups_27676),
                                      "group_res_arr_mem_29949")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_29951;
            
            num_threads_29951 = num_groups_27676 * segred_group_sizze_27675;
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegRed");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27641,
                                                    1, (int32_t) sizeof(float) *
                                                    segred_group_sizze_27675,
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27641,
                                                    2, (int32_t) sizeof(bool),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27641,
                                                    3, sizeof(paths_25421),
                                                    &paths_25421));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27641,
                                                    4, sizeof(num_groups_27676),
                                                    &num_groups_27676));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27641,
                                                    5,
                                                    sizeof(res_map_acc_mem_29023.mem),
                                                    &res_map_acc_mem_29023.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27641,
                                                    6, sizeof(mem_29026.mem),
                                                    &mem_29026.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27641,
                                                    7,
                                                    sizeof(mainzicounter_mem_29947.mem),
                                                    &mainzicounter_mem_29947.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27641,
                                                    8,
                                                    sizeof(group_res_arr_mem_29949.mem),
                                                    &group_res_arr_mem_29949.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->mainzisegred_nonseg_27641,
                                                    9,
                                                    sizeof(num_threads_29951),
                                                    &num_threads_29951));
            if (1 * ((size_t) num_groups_27676 *
                     (size_t) segred_group_sizze_27675) != 0) {
                const size_t global_work_sizze_30196[1] =
                             {(size_t) num_groups_27676 *
                             (size_t) segred_group_sizze_27675};
                const size_t local_work_sizze_30200[1] =
                             {segred_group_sizze_27675};
                int64_t time_start_30197 = 0, time_end_30198 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "main.segred_nonseg_27641");
                    fprintf(stderr, "%zu", global_work_sizze_30196[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30200[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + (int32_t) sizeof(float) *
                                   segred_group_sizze_27675 +
                                   (int32_t) sizeof(bool)));
                    time_start_30197 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->mainzisegred_nonseg_27641,
                                                                1, NULL,
                                                                global_work_sizze_30196,
                                                                local_work_sizze_30200,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->mainzisegred_nonseg_27641_runs,
                                                                                                          &ctx->mainzisegred_nonseg_27641_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30198 = get_wall_time();
                    
                    long time_diff_30199 = time_end_30198 - time_start_30197;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "main.segred_nonseg_27641", time_diff_30199);
                }
            }
            if (memblock_unref_device(ctx, &res_map_acc_mem_29023,
                                      "res_map_acc_mem_29023") != 0)
                return 1;
            
            float read_res_30201;
            
            OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                         mem_29026.mem,
                                                         ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                         0 * sizeof(float),
                                                         sizeof(float),
                                                         &read_res_30201, 0,
                                                         NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_scalar_from_dev_runs,
                                                                                                   &ctx->copy_scalar_from_dev_total_runtime)));
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
                return 1;
            
            float res_27683 = read_res_30201;
            
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            res_26102 = res_27683;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29949,
                                      "group_res_arr_mem_29949") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_map_acc_mem_29023,
                                      "res_map_acc_mem_29023") != 0)
                return 1;
        }
        if (memblock_unref_device(ctx, &mem_29003, "mem_29003") != 0)
            return 1;
        
        float res_26113 = res_26102 / res_25611;
        float negate_arg_26114 = a_25426 * res_25869;
        float exp_arg_26115 = 0.0F - negate_arg_26114;
        float res_26116 = fpow32(2.7182817F, exp_arg_26115);
        float x_26117 = 1.0F - res_26116;
        float B_26118 = x_26117 / a_25426;
        float x_26119 = B_26118 - res_25869;
        float x_26120 = y_25450 * x_26119;
        float A1_26121 = x_26120 / x_25446;
        float y_26122 = fpow32(B_26118, 2.0F);
        float x_26123 = x_25448 * y_26122;
        float A2_26124 = x_26123 / y_25451;
        float exp_arg_26125 = A1_26121 - A2_26124;
        float res_26126 = fpow32(2.7182817F, exp_arg_26125);
        float negate_arg_26127 = 5.0e-2F * B_26118;
        float exp_arg_26128 = 0.0F - negate_arg_26127;
        float res_26129 = fpow32(2.7182817F, exp_arg_26128);
        float res_26130 = res_26126 * res_26129;
        float res_26131 = res_26113 * res_26130;
        float res_25865 = res_26131 + redout_27349;
        
        {
            float write_tmp_30202 = res_26113;
            
            OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                          mem_28963.mem,
                                                          CL_TRUE, i_27351 *
                                                          sizeof(float),
                                                          sizeof(float),
                                                          &write_tmp_30202, 0,
                                                          NULL,
                                                          ctx->profiling_paused ||
                                                          !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                    &ctx->copy_scalar_to_dev_runs,
                                                                                                    &ctx->copy_scalar_to_dev_total_runtime)));
        }
        
        float redout_tmp_29340 = res_25865;
        
        redout_27349 = redout_tmp_29340;
        if (memblock_unref_device(ctx, &mem_29003, "mem_29003") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29001, "mem_29001") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28998, "mem_28998") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28996, "mem_28996") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28993, "mem_28993") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28991, "mem_28991") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28989, "mem_28989") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28986, "mem_28986") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28984, "mem_28984") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_subhistos_mem_29432,
                                  "res_subhistos_mem_29432") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28980, "mem_28980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29394,
                                  "group_res_arr_mem_29394") != 0)
            return 1;
    }
    res_25861 = redout_27349;
    if (memblock_unref_device(ctx, &res_mem_28930, "res_mem_28930") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28931, "res_mem_28931") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28932, "res_mem_28932") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28933, "res_mem_28933") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28961, "mem_28961") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28973, "mem_28973") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28975, "mem_28975") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28978, "mem_28978") != 0)
        return 1;
    
    float CVA_26134 = 6.0e-3F * res_25861;
    struct memblock_device mem_29033;
    
    mem_29033.references = NULL;
    if (memblock_alloc_device(ctx, &mem_29033, bytes_28945, "mem_29033")) {
        err = 1;
        goto cleanup;
    }
    if (steps_25422 * (int32_t) sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     mem_28963.mem,
                                                     mem_29033.mem, 0, 0,
                                                     steps_25422 *
                                                     (int32_t) sizeof(float), 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    if (memblock_unref_device(ctx, &mem_28963, "mem_28963") != 0)
        return 1;
    out_arrsizze_29205 = steps_25422;
    if (memblock_set_device(ctx, &out_mem_29204, &mem_29033, "mem_29033") != 0)
        return 1;
    scalar_out_29203 = CVA_26134;
    *out_scalar_out_30008 = scalar_out_29203;
    (*out_mem_p_30009).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_30009, &out_mem_29204,
                            "out_mem_29204") != 0)
        return 1;
    *out_out_arrsizze_30010 = out_arrsizze_29205;
    if (memblock_unref_device(ctx, &mem_29033, "mem_29033") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28978, "mem_28978") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28975, "mem_28975") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28973, "mem_28973") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28963, "mem_28963") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28946, "mem_28946") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28961, "mem_28961") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28940, "mem_28940") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28936, "mem_28936") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28933, "res_mem_28933") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28932, "res_mem_28932") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28931, "res_mem_28931") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28930, "res_mem_28930") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_29209,
                              "group_res_arr_mem_29209") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_29204, "out_mem_29204") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
static int futrts_test(struct futhark_context *ctx, float *out_scalar_out_30203,
                       int64_t paths_26135, int64_t steps_26136)
{
    (void) ctx;
    
    int err = 0;
    float scalar_out_29203;
    struct memblock_device mem_28879;
    
    mem_28879.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28879, 36, "mem_28879")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzistatic_array_29204 =
                           ctx->testzistatic_array_29204;
    
    if (9 * (int32_t) sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     testzistatic_array_29204.mem,
                                                     mem_28879.mem, 0, 0, 9 *
                                                     (int32_t) sizeof(float), 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    
    struct memblock_device mem_28881;
    
    mem_28881.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28881, 72, "mem_28881")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzistatic_array_29205 =
                           ctx->testzistatic_array_29205;
    
    if (9 * (int32_t) sizeof(int64_t) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     testzistatic_array_29205.mem,
                                                     mem_28881.mem, 0, 0, 9 *
                                                     (int32_t) sizeof(int64_t),
                                                     0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    
    struct memblock_device mem_28883;
    
    mem_28883.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28883, 36, "mem_28883")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzistatic_array_29206 =
                           ctx->testzistatic_array_29206;
    
    if (9 * (int32_t) sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                     testzistatic_array_29206.mem,
                                                     mem_28883.mem, 0, 0, 9 *
                                                     (int32_t) sizeof(float), 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    
    int64_t segred_group_sizze_27687;
    
    segred_group_sizze_27687 = ctx->sizes.testzisegred_group_sizze_27686;
    
    int64_t num_groups_27689;
    int32_t max_num_groups_29207;
    
    max_num_groups_29207 = ctx->sizes.testzisegred_num_groups_27688;
    num_groups_27689 = sext_i64_i32(smax64(1, smin64(sdiv_up64(9,
                                                               sext_i32_i64(segred_group_sizze_27687)),
                                                     sext_i32_i64(max_num_groups_29207))));
    
    struct memblock_device mem_28886;
    
    mem_28886.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28886, 4, "mem_28886")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device testzicounter_mem_29208 =
                           ctx->testzicounter_mem_29208;
    struct memblock_device group_res_arr_mem_29210;
    
    group_res_arr_mem_29210.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_29210,
                              (int32_t) sizeof(float) *
                              (segred_group_sizze_27687 * num_groups_27689),
                              "group_res_arr_mem_29210")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_29212;
    
    num_threads_29212 = num_groups_27689 * segred_group_sizze_27687;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27694, 1,
                                            (int32_t) sizeof(float) *
                                            segred_group_sizze_27687, NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27694, 2,
                                            (int32_t) sizeof(bool), NULL));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27694, 3,
                                            sizeof(num_groups_27689),
                                            &num_groups_27689));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27694, 4,
                                            sizeof(mem_28881.mem),
                                            &mem_28881.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27694, 5,
                                            sizeof(mem_28883.mem),
                                            &mem_28883.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27694, 6,
                                            sizeof(mem_28886.mem),
                                            &mem_28886.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27694, 7,
                                            sizeof(testzicounter_mem_29208.mem),
                                            &testzicounter_mem_29208.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27694, 8,
                                            sizeof(group_res_arr_mem_29210.mem),
                                            &group_res_arr_mem_29210.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_27694, 9,
                                            sizeof(num_threads_29212),
                                            &num_threads_29212));
    if (1 * ((size_t) num_groups_27689 * (size_t) segred_group_sizze_27687) !=
        0) {
        const size_t global_work_sizze_30208[1] = {(size_t) num_groups_27689 *
                     (size_t) segred_group_sizze_27687};
        const size_t local_work_sizze_30212[1] = {segred_group_sizze_27687};
        int64_t time_start_30209 = 0, time_end_30210 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segred_nonseg_27694");
            fprintf(stderr, "%zu", global_work_sizze_30208[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_30212[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) (0 + (int32_t) sizeof(float) *
                           segred_group_sizze_27687 + (int32_t) sizeof(bool)));
            time_start_30209 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegred_nonseg_27694,
                                                        1, NULL,
                                                        global_work_sizze_30208,
                                                        local_work_sizze_30212,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegred_nonseg_27694_runs,
                                                                                                  &ctx->testzisegred_nonseg_27694_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_30210 = get_wall_time();
            
            long time_diff_30211 = time_end_30210 - time_start_30209;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n",
                    "test.segred_nonseg_27694", time_diff_30211);
        }
    }
    
    float read_res_30213;
    
    OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                 mem_28886.mem,
                                                 ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                 0 * sizeof(float),
                                                 sizeof(float), &read_res_30213,
                                                 0, NULL,
                                                 ctx->profiling_paused ||
                                                 !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                           &ctx->copy_scalar_from_dev_runs,
                                                                                           &ctx->copy_scalar_from_dev_total_runtime)));
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
        return 1;
    
    float res_26140 = read_res_30213;
    
    if (memblock_unref_device(ctx, &mem_28886, "mem_28886") != 0)
        return 1;
    
    float res_26148 = sitofp_i64_f32(steps_26136);
    float dt_26149 = res_26140 / res_26148;
    bool suff_outer_par_27696;
    
    suff_outer_par_27696 = ctx->sizes.testzisuff_outer_par_0 <= 9;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_outer_par_0", 9);
    
    int64_t segmap_group_sizze_27786;
    
    segmap_group_sizze_27786 = ctx->sizes.testzisegmap_group_sizze_27710;
    
    int64_t segmap_group_sizze_27962;
    
    segmap_group_sizze_27962 = ctx->sizes.testzisegmap_group_sizze_27886;
    
    int64_t segred_num_groups_29132;
    
    segred_num_groups_29132 = ctx->sizes.testzisegred_num_groups_29131;
    
    int64_t segred_group_sizze_29134;
    
    segred_group_sizze_29134 = ctx->sizes.testzisegred_group_sizze_29133;
    
    int64_t segred_num_groups_29164;
    
    segred_num_groups_29164 = ctx->sizes.testzisegred_num_groups_29163;
    
    int64_t segred_group_sizze_29166;
    
    segred_group_sizze_29166 = ctx->sizes.testzisegred_group_sizze_29165;
    
    struct memblock_device res_mem_28933;
    
    res_mem_28933.references = NULL;
    
    struct memblock_device res_mem_28934;
    
    res_mem_28934.references = NULL;
    
    struct memblock_device res_mem_28935;
    
    res_mem_28935.references = NULL;
    
    struct memblock_device res_mem_28936;
    
    res_mem_28936.references = NULL;
    
    int32_t local_memory_capacity_29312;
    
    local_memory_capacity_29312 = ctx->opencl.max_local_memory;
    if ((sle64((int32_t) sizeof(bool) + (int32_t) sizeof(int64_t) *
               segred_group_sizze_29134,
               sext_i32_i64(local_memory_capacity_29312)) && sle64(0,
                                                                   sext_i32_i64(local_memory_capacity_29312))) &&
        suff_outer_par_27696) {
        int64_t segmap_usable_groups_27787 = sdiv_up64(9,
                                                       segmap_group_sizze_27786);
        struct memblock_device mem_28888;
        
        mem_28888.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28888, 36, "mem_28888")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_28883.mem,
                                                         mem_28888.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28890;
        
        mem_28890.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28890, 72, "mem_28890")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_28881.mem,
                                                         mem_28890.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28892;
        
        mem_28892.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28892, 36, "mem_28892")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_28879.mem,
                                                         mem_28892.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28909;
        
        mem_28909.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28909, 36, "mem_28909")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_29122 = segmap_group_sizze_27786 *
                segmap_usable_groups_27787;
        struct memblock_device mem_29150;
        
        mem_29150.references = NULL;
        if (memblock_alloc_device(ctx, &mem_29150, 8, "mem_29150")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device testzicounter_mem_29238 =
                               ctx->testzicounter_mem_29238;
        struct memblock_device group_res_arr_mem_29240;
        
        group_res_arr_mem_29240.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_29240,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_29134 *
                                   segred_num_groups_29132),
                                  "group_res_arr_mem_29240")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_29242;
        
        num_threads_29242 = segred_num_groups_29132 * segred_group_sizze_29134;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_29138,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_29134,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_29138,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_29138,
                                                3, sizeof(mem_28881.mem),
                                                &mem_28881.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_29138,
                                                4, sizeof(mem_29150.mem),
                                                &mem_29150.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_29138,
                                                5,
                                                sizeof(testzicounter_mem_29238.mem),
                                                &testzicounter_mem_29238.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_29138,
                                                6,
                                                sizeof(group_res_arr_mem_29240.mem),
                                                &group_res_arr_mem_29240.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_29138,
                                                7, sizeof(num_threads_29242),
                                                &num_threads_29242));
        if (1 * ((size_t) segred_num_groups_29132 *
                 (size_t) segred_group_sizze_29134) != 0) {
            const size_t global_work_sizze_30215[1] =
                         {(size_t) segred_num_groups_29132 *
                         (size_t) segred_group_sizze_29134};
            const size_t local_work_sizze_30219[1] = {segred_group_sizze_29134};
            int64_t time_start_30216 = 0, time_end_30217 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segred_nonseg_29138");
                fprintf(stderr, "%zu", global_work_sizze_30215[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_30219[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_29134 +
                               (int32_t) sizeof(bool)));
                time_start_30216 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegred_nonseg_29138,
                                                            1, NULL,
                                                            global_work_sizze_30215,
                                                            local_work_sizze_30219,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegred_nonseg_29138_runs,
                                                                                                      &ctx->testzisegred_nonseg_29138_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_30217 = get_wall_time();
                
                long time_diff_30218 = time_end_30217 - time_start_30216;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segred_nonseg_29138", time_diff_30218);
            }
        }
        
        int64_t read_res_30220;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_29150.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_30220, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t max_per_thread_29128 = read_res_30220;
        
        if (memblock_unref_device(ctx, &mem_29150, "mem_29150") != 0)
            return 1;
        
        int64_t sizze_sum_29145 = num_threads_29122 * max_per_thread_29128;
        struct memblock_device mem_28895;
        
        mem_28895.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28895, sizze_sum_29145,
                                  "mem_28895")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27708, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27708, 3,
                                                sizeof(mem_28881.mem),
                                                &mem_28881.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27708, 4,
                                                sizeof(mem_28883.mem),
                                                &mem_28883.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27708, 5,
                                                sizeof(mem_28895.mem),
                                                &mem_28895.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27708, 6,
                                                sizeof(mem_28909.mem),
                                                &mem_28909.mem));
        if (1 * ((size_t) segmap_usable_groups_27787 *
                 (size_t) segmap_group_sizze_27786) != 0) {
            const size_t global_work_sizze_30221[1] =
                         {(size_t) segmap_usable_groups_27787 *
                         (size_t) segmap_group_sizze_27786};
            const size_t local_work_sizze_30225[1] = {segmap_group_sizze_27786};
            int64_t time_start_30222 = 0, time_end_30223 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_27708");
                fprintf(stderr, "%zu", global_work_sizze_30221[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_30225[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_30222 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_27708,
                                                            1, NULL,
                                                            global_work_sizze_30221,
                                                            local_work_sizze_30225,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_27708_runs,
                                                                                                      &ctx->testzisegmap_27708_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_30223 = get_wall_time();
                
                long time_diff_30224 = time_end_30223 - time_start_30222;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_27708", time_diff_30224);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_28895, "mem_28895") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28933, &mem_28909, "mem_28909") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28934, &mem_28892, "mem_28892") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28935, &mem_28890, "mem_28890") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28936, &mem_28888, "mem_28888") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28895, "mem_28895") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29240,
                                  "group_res_arr_mem_29240") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29150, "mem_29150") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28909, "mem_28909") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28892, "mem_28892") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28890, "mem_28890") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28888, "mem_28888") != 0)
            return 1;
    } else {
        int64_t segmap_usable_groups_27963 = sdiv_up64(9,
                                                       segmap_group_sizze_27962);
        struct memblock_device mem_28911;
        
        mem_28911.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28911, 36, "mem_28911")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_28883.mem,
                                                         mem_28911.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28913;
        
        mem_28913.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28913, 72, "mem_28913")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(int64_t) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_28881.mem,
                                                         mem_28913.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(int64_t),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28915;
        
        mem_28915.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28915, 36, "mem_28915")) {
            err = 1;
            goto cleanup;
        }
        if (9 * (int32_t) sizeof(float) > 0) {
            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                         mem_28879.mem,
                                                         mem_28915.mem, 0, 0,
                                                         9 *
                                                         (int32_t) sizeof(float),
                                                         0, NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
            if (ctx->debugging)
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
        }
        
        struct memblock_device mem_28932;
        
        mem_28932.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28932, 36, "mem_28932")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_29154 = segmap_group_sizze_27962 *
                segmap_usable_groups_27963;
        struct memblock_device mem_29182;
        
        mem_29182.references = NULL;
        if (memblock_alloc_device(ctx, &mem_29182, 8, "mem_29182")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device testzicounter_mem_29275 =
                               ctx->testzicounter_mem_29275;
        struct memblock_device group_res_arr_mem_29277;
        
        group_res_arr_mem_29277.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_29277,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_29166 *
                                   segred_num_groups_29164),
                                  "group_res_arr_mem_29277")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_29279;
        
        num_threads_29279 = segred_num_groups_29164 * segred_group_sizze_29166;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_29170,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_29166,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_29170,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_29170,
                                                3, sizeof(mem_28881.mem),
                                                &mem_28881.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_29170,
                                                4, sizeof(mem_29182.mem),
                                                &mem_29182.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_29170,
                                                5,
                                                sizeof(testzicounter_mem_29275.mem),
                                                &testzicounter_mem_29275.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_29170,
                                                6,
                                                sizeof(group_res_arr_mem_29277.mem),
                                                &group_res_arr_mem_29277.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_29170,
                                                7, sizeof(num_threads_29279),
                                                &num_threads_29279));
        if (1 * ((size_t) segred_num_groups_29164 *
                 (size_t) segred_group_sizze_29166) != 0) {
            const size_t global_work_sizze_30227[1] =
                         {(size_t) segred_num_groups_29164 *
                         (size_t) segred_group_sizze_29166};
            const size_t local_work_sizze_30231[1] = {segred_group_sizze_29166};
            int64_t time_start_30228 = 0, time_end_30229 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segred_nonseg_29170");
                fprintf(stderr, "%zu", global_work_sizze_30227[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_30231[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_29166 +
                               (int32_t) sizeof(bool)));
                time_start_30228 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegred_nonseg_29170,
                                                            1, NULL,
                                                            global_work_sizze_30227,
                                                            local_work_sizze_30231,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegred_nonseg_29170_runs,
                                                                                                      &ctx->testzisegred_nonseg_29170_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_30229 = get_wall_time();
                
                long time_diff_30230 = time_end_30229 - time_start_30228;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segred_nonseg_29170", time_diff_30230);
            }
        }
        
        int64_t read_res_30232;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_29182.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_30232, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t max_per_thread_29160 = read_res_30232;
        
        if (memblock_unref_device(ctx, &mem_29182, "mem_29182") != 0)
            return 1;
        
        int64_t sizze_sum_29177 = num_threads_29154 * max_per_thread_29160;
        struct memblock_device mem_28918;
        
        mem_28918.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28918, sizze_sum_29177,
                                  "mem_28918")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27884, 1,
                                                sizeof(ctx->failure_is_an_option),
                                                &ctx->failure_is_an_option));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27884, 3,
                                                sizeof(mem_28881.mem),
                                                &mem_28881.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27884, 4,
                                                sizeof(mem_28883.mem),
                                                &mem_28883.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27884, 5,
                                                sizeof(mem_28918.mem),
                                                &mem_28918.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_27884, 6,
                                                sizeof(mem_28932.mem),
                                                &mem_28932.mem));
        if (1 * ((size_t) segmap_usable_groups_27963 *
                 (size_t) segmap_group_sizze_27962) != 0) {
            const size_t global_work_sizze_30233[1] =
                         {(size_t) segmap_usable_groups_27963 *
                         (size_t) segmap_group_sizze_27962};
            const size_t local_work_sizze_30237[1] = {segmap_group_sizze_27962};
            int64_t time_start_30234 = 0, time_end_30235 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_27884");
                fprintf(stderr, "%zu", global_work_sizze_30233[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_30237[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_30234 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_27884,
                                                            1, NULL,
                                                            global_work_sizze_30233,
                                                            local_work_sizze_30237,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_27884_runs,
                                                                                                      &ctx->testzisegmap_27884_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_30235 = get_wall_time();
                
                long time_diff_30236 = time_end_30235 - time_start_30234;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_27884", time_diff_30236);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &mem_28918, "mem_28918") != 0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28933, &mem_28932, "mem_28932") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28934, &mem_28915, "mem_28915") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28935, &mem_28913, "mem_28913") !=
            0)
            return 1;
        if (memblock_set_device(ctx, &res_mem_28936, &mem_28911, "mem_28911") !=
            0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28918, "mem_28918") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29277,
                                  "group_res_arr_mem_29277") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29182, "mem_29182") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28932, "mem_28932") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28915, "mem_28915") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28913, "mem_28913") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28911, "mem_28911") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_28879, "mem_28879") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28881, "mem_28881") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
        return 1;
    
    float sims_per_year_26227 = res_26148 / res_26140;
    bool bounds_invalid_upwards_26228 = slt64(steps_26136, 1);
    bool valid_26229 = !bounds_invalid_upwards_26228;
    bool range_valid_c_26230;
    
    if (!valid_26229) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 1, "..", 2, "...", steps_26136,
                               " is invalid.",
                               "-> #0  cva.fut:60:56-67\n   #1  cva.fut:111:17-44\n   #2  cva.fut:166:3-120\n   #3  cva.fut:165:1-166:128\n");
        if (memblock_unref_device(ctx, &res_mem_28936, "res_mem_28936") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28935, "res_mem_28935") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28934, "res_mem_28934") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28933, "res_mem_28933") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29210,
                                  "group_res_arr_mem_29210") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28886, "mem_28886") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28881, "mem_28881") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28879, "mem_28879") != 0)
            return 1;
        return 1;
    }
    
    bool bounds_invalid_upwards_26232 = slt64(paths_26135, 0);
    bool valid_26233 = !bounds_invalid_upwards_26232;
    bool range_valid_c_26234;
    
    if (!valid_26233) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", 0, "..", 1, "..<", paths_26135,
                               " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:126:11-16\n   #2  lib/github.com/diku-dk/cpprandom/random.fut:174:8-56\n   #3  cva.fut:115:19-49\n   #4  cva.fut:166:3-120\n   #5  cva.fut:165:1-166:128\n");
        if (memblock_unref_device(ctx, &res_mem_28936, "res_mem_28936") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28935, "res_mem_28935") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28934, "res_mem_28934") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_mem_28933, "res_mem_28933") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29210,
                                  "group_res_arr_mem_29210") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28886, "mem_28886") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28881, "mem_28881") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28879, "mem_28879") != 0)
            return 1;
        return 1;
    }
    
    int64_t upper_bound_26237 = sub64(steps_26136, 1);
    float res_26238;
    
    res_26238 = futrts_sqrt32(dt_26149);
    
    int64_t segmap_group_sizze_28364;
    
    segmap_group_sizze_28364 = ctx->sizes.testzisegmap_group_sizze_28347;
    
    int64_t segmap_usable_groups_28365 = sdiv_up64(paths_26135,
                                                   segmap_group_sizze_28364);
    int64_t bytes_28938 = 4 * paths_26135;
    struct memblock_device mem_28939;
    
    mem_28939.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28939, bytes_28938, "mem_28939")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28345, 1,
                                            sizeof(paths_26135), &paths_26135));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28345, 2,
                                            sizeof(mem_28939.mem),
                                            &mem_28939.mem));
    if (1 * ((size_t) segmap_usable_groups_28365 *
             (size_t) segmap_group_sizze_28364) != 0) {
        const size_t global_work_sizze_30238[1] =
                     {(size_t) segmap_usable_groups_28365 *
                     (size_t) segmap_group_sizze_28364};
        const size_t local_work_sizze_30242[1] = {segmap_group_sizze_28364};
        int64_t time_start_30239 = 0, time_end_30240 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segmap_28345");
            fprintf(stderr, "%zu", global_work_sizze_30238[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_30242[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_30239 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegmap_28345,
                                                        1, NULL,
                                                        global_work_sizze_30238,
                                                        local_work_sizze_30242,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegmap_28345_runs,
                                                                                                  &ctx->testzisegmap_28345_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_30240 = get_wall_time();
            
            long time_diff_30241 = time_end_30240 - time_start_30239;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "test.segmap_28345",
                    time_diff_30241);
        }
    }
    
    int64_t nest_sizze_28388 = paths_26135 * steps_26136;
    int64_t segmap_group_sizze_28389;
    
    segmap_group_sizze_28389 = ctx->sizes.testzisegmap_group_sizze_28284;
    
    int64_t segmap_usable_groups_28390 = sdiv_up64(nest_sizze_28388,
                                                   segmap_group_sizze_28389);
    int64_t bytes_28941 = 4 * nest_sizze_28388;
    struct memblock_device mem_28943;
    
    mem_28943.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28943, bytes_28941, "mem_28943")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28281, 1,
                                            sizeof(paths_26135), &paths_26135));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28281, 2,
                                            sizeof(steps_26136), &steps_26136));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28281, 3,
                                            sizeof(mem_28939.mem),
                                            &mem_28939.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28281, 4,
                                            sizeof(mem_28943.mem),
                                            &mem_28943.mem));
    if (1 * ((size_t) segmap_usable_groups_28390 *
             (size_t) segmap_group_sizze_28389) != 0) {
        const size_t global_work_sizze_30243[1] =
                     {(size_t) segmap_usable_groups_28390 *
                     (size_t) segmap_group_sizze_28389};
        const size_t local_work_sizze_30247[1] = {segmap_group_sizze_28389};
        int64_t time_start_30244 = 0, time_end_30245 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segmap_28281");
            fprintf(stderr, "%zu", global_work_sizze_30243[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_30247[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_30244 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegmap_28281,
                                                        1, NULL,
                                                        global_work_sizze_30243,
                                                        local_work_sizze_30247,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegmap_28281_runs,
                                                                                                  &ctx->testzisegmap_28281_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_30245 = get_wall_time();
            
            long time_diff_30246 = time_end_30245 - time_start_30244;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "test.segmap_28281",
                    time_diff_30246);
        }
    }
    if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
        return 1;
    
    int64_t segmap_group_sizze_28434;
    
    segmap_group_sizze_28434 = ctx->sizes.testzisegmap_group_sizze_28185;
    
    int64_t num_groups_28435;
    int32_t max_num_groups_29323;
    
    max_num_groups_29323 = ctx->sizes.testzisegmap_num_groups_28187;
    num_groups_28435 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_26135,
                                                               sext_i32_i64(segmap_group_sizze_28434)),
                                                     sext_i32_i64(max_num_groups_29323))));
    
    struct memblock_device mem_28946;
    
    mem_28946.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28946, bytes_28941, "mem_28946")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_28946, 0, mem_28943, 0,
                                              1, steps_26136, paths_26135) !=
        0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
        return 1;
    
    struct memblock_device mem_28964;
    
    mem_28964.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28964, bytes_28941, "mem_28964")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_28948 = 4 * steps_26136;
    int64_t num_threads_29188 = segmap_group_sizze_28434 * num_groups_28435;
    int64_t total_sizze_29189 = bytes_28948 * num_threads_29188;
    struct memblock_device mem_28949;
    
    mem_28949.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28949, total_sizze_29189,
                              "mem_28949")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegMap");
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28183, 1,
                                            sizeof(ctx->failure_is_an_option),
                                            &ctx->failure_is_an_option));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28183, 3,
                                            sizeof(paths_26135), &paths_26135));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28183, 4,
                                            sizeof(steps_26136), &steps_26136));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28183, 5,
                                            sizeof(dt_26149), &dt_26149));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28183, 6,
                                            sizeof(upper_bound_26237),
                                            &upper_bound_26237));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28183, 7,
                                            sizeof(res_26238), &res_26238));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28183, 8,
                                            sizeof(num_groups_28435),
                                            &num_groups_28435));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28183, 9,
                                            sizeof(mem_28946.mem),
                                            &mem_28946.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28183, 10,
                                            sizeof(mem_28949.mem),
                                            &mem_28949.mem));
    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28183, 11,
                                            sizeof(mem_28964.mem),
                                            &mem_28964.mem));
    if (1 * ((size_t) num_groups_28435 * (size_t) segmap_group_sizze_28434) !=
        0) {
        const size_t global_work_sizze_30248[1] = {(size_t) num_groups_28435 *
                     (size_t) segmap_group_sizze_28434};
        const size_t local_work_sizze_30252[1] = {segmap_group_sizze_28434};
        int64_t time_start_30249 = 0, time_end_30250 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with global work size [",
                    "test.segmap_28183");
            fprintf(stderr, "%zu", global_work_sizze_30248[0]);
            fprintf(stderr, "] and local work size [");
            fprintf(stderr, "%zu", local_work_sizze_30252[0]);
            fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                    (int) 0);
            time_start_30249 = get_wall_time();
        }
        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                        ctx->testzisegmap_28183,
                                                        1, NULL,
                                                        global_work_sizze_30248,
                                                        local_work_sizze_30252,
                                                        0, NULL,
                                                        ctx->profiling_paused ||
                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                  &ctx->testzisegmap_28183_runs,
                                                                                                  &ctx->testzisegmap_28183_total_runtime)));
        if (ctx->debugging) {
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
            time_end_30250 = get_wall_time();
            
            long time_diff_30251 = time_end_30250 - time_start_30249;
            
            fprintf(stderr, "kernel %s runtime: %ldus\n", "test.segmap_28183",
                    time_diff_30251);
        }
    }
    ctx->failure_is_an_option = 1;
    if (memblock_unref_device(ctx, &mem_28946, "mem_28946") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28949, "mem_28949") != 0)
        return 1;
    
    int64_t flat_dim_26302 = 9 * paths_26135;
    float res_26306 = sitofp_i64_f32(paths_26135);
    int64_t segscan_group_sizze_28530;
    
    segscan_group_sizze_28530 = ctx->sizes.testzisegscan_group_sizze_28529;
    
    int64_t num_groups_28532;
    int32_t max_num_groups_29335;
    
    max_num_groups_29335 = ctx->sizes.testzisegscan_num_groups_28531;
    num_groups_28532 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_26302,
                                                               sext_i32_i64(segscan_group_sizze_28530)),
                                                     sext_i32_i64(max_num_groups_29335))));
    
    int64_t segred_group_sizze_28538;
    
    segred_group_sizze_28538 = ctx->sizes.testzisegred_group_sizze_28537;
    
    int64_t num_groups_28540;
    int32_t max_num_groups_29336;
    
    max_num_groups_29336 = ctx->sizes.testzisegred_num_groups_28539;
    num_groups_28540 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_26302,
                                                               sext_i32_i64(segred_group_sizze_28538)),
                                                     sext_i32_i64(max_num_groups_29336))));
    
    int64_t seghist_group_sizze_28548;
    
    seghist_group_sizze_28548 = ctx->sizes.testziseghist_group_sizze_28547;
    
    int64_t num_groups_28550;
    int32_t max_num_groups_29337;
    
    max_num_groups_29337 = ctx->sizes.testziseghist_num_groups_28549;
    num_groups_28550 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_26302,
                                                               sext_i32_i64(seghist_group_sizze_28548)),
                                                     sext_i32_i64(max_num_groups_29337))));
    
    int64_t segscan_group_sizze_28563;
    
    segscan_group_sizze_28563 = ctx->sizes.testzisegscan_group_sizze_28562;
    
    int64_t segscan_group_sizze_28571;
    
    segscan_group_sizze_28571 = ctx->sizes.testzisegscan_group_sizze_28570;
    
    int64_t segscan_group_sizze_28579;
    
    segscan_group_sizze_28579 = ctx->sizes.testzisegscan_group_sizze_28578;
    
    int64_t segscan_group_sizze_28631;
    
    segscan_group_sizze_28631 = ctx->sizes.testzisegscan_group_sizze_28630;
    
    bool suff_outer_redomap_28644;
    
    suff_outer_redomap_28644 = ctx->sizes.testzisuff_outer_redomap_7 <=
        paths_26135;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_outer_redomap_7",
                paths_26135);
    
    int64_t segred_group_sizze_28656;
    
    segred_group_sizze_28656 = ctx->sizes.testzisegred_group_sizze_28646;
    
    int64_t num_groups_28657;
    int32_t max_num_groups_29338;
    
    max_num_groups_29338 = ctx->sizes.testzisegred_num_groups_28648;
    num_groups_28657 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_26135,
                                                               sext_i32_i64(segred_group_sizze_28656)),
                                                     sext_i32_i64(max_num_groups_29338))));
    
    bool suff_outer_par_28752;
    
    suff_outer_par_28752 = ctx->sizes.testzisuff_outer_par_8 <= paths_26135;
    if (ctx->logging)
        fprintf(stderr, "Compared %s <= %d.\n", "test.suff_outer_par_8",
                paths_26135);
    
    int64_t segmap_group_sizze_28755;
    
    segmap_group_sizze_28755 = ctx->sizes.testzisegmap_group_sizze_28678;
    
    int64_t segred_group_sizze_28767;
    
    segred_group_sizze_28767 = ctx->sizes.testzisegred_group_sizze_28711;
    
    int64_t num_groups_28768;
    int32_t max_num_groups_29339;
    
    max_num_groups_29339 = ctx->sizes.testzisegred_num_groups_28713;
    num_groups_28768 = sext_i64_i32(smax64(1, smin64(sdiv_up64(flat_dim_26302,
                                                               sext_i32_i64(segred_group_sizze_28767)),
                                                     sext_i32_i64(max_num_groups_29339))));
    
    int64_t segmap_group_sizze_28777;
    
    segmap_group_sizze_28777 = ctx->sizes.testzisegmap_group_sizze_28703;
    
    int64_t segred_group_sizze_28784;
    
    segred_group_sizze_28784 = ctx->sizes.testzisegred_group_sizze_28742;
    
    int64_t num_groups_28785;
    int32_t max_num_groups_29340;
    
    max_num_groups_29340 = ctx->sizes.testzisegred_num_groups_28744;
    num_groups_28785 = sext_i64_i32(smax64(1, smin64(sdiv_up64(paths_26135,
                                                               sext_i32_i64(segred_group_sizze_28784)),
                                                     sext_i32_i64(max_num_groups_29340))));
    
    int64_t segmap_usable_groups_28756 = sdiv_up_safe64(paths_26135,
                                                        segmap_group_sizze_28755);
    int64_t segmap_usable_groups_28778 = sdiv_up_safe64(paths_26135,
                                                        segmap_group_sizze_28777);
    int64_t bytes_28966 = 8 * flat_dim_26302;
    struct memblock_device mem_28967;
    
    mem_28967.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28967, bytes_28966, "mem_28967")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28969;
    
    mem_28969.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28969, bytes_28966, "mem_28969")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28972;
    
    mem_28972.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28972, 8, "mem_28972")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_28999 = 4 * flat_dim_26302;
    float res_26308;
    float redout_28460 = 0.0F;
    
    for (int64_t i_28461 = 0; i_28461 < steps_26136; i_28461++) {
        int64_t index_primexp_28822 = add64(1, i_28461);
        float res_26314 = sitofp_i64_f32(index_primexp_28822);
        float res_26315 = res_26314 / sims_per_year_26227;
        
        if (slt64(0, flat_dim_26302)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_29342;
            
            stage1_max_num_groups_29342 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_29343;
            
            stage1_num_groups_29343 = smin64(stage1_max_num_groups_29342,
                                             num_groups_28532);
            
            int32_t num_threads_29344;
            
            num_threads_29344 = sext_i64_i32(stage1_num_groups_29343 *
                segscan_group_sizze_28530);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28535,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_28530),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28535,
                                                    2, sizeof(flat_dim_26302),
                                                    &flat_dim_26302));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28535,
                                                    3, sizeof(res_26315),
                                                    &res_26315));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28535,
                                                    4,
                                                    sizeof(res_mem_28935.mem),
                                                    &res_mem_28935.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28535,
                                                    5,
                                                    sizeof(res_mem_28936.mem),
                                                    &res_mem_28936.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28535,
                                                    6, sizeof(mem_28967.mem),
                                                    &mem_28967.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28535,
                                                    7, sizeof(mem_28969.mem),
                                                    &mem_28969.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28535,
                                                    8,
                                                    sizeof(num_threads_29344),
                                                    &num_threads_29344));
            if (1 * ((size_t) stage1_num_groups_29343 *
                     (size_t) segscan_group_sizze_28530) != 0) {
                const size_t global_work_sizze_30253[1] =
                             {(size_t) stage1_num_groups_29343 *
                             (size_t) segscan_group_sizze_28530};
                const size_t local_work_sizze_30257[1] =
                             {segscan_group_sizze_28530};
                int64_t time_start_30254 = 0, time_end_30255 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage1_28535");
                    fprintf(stderr, "%zu", global_work_sizze_30253[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30257[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_28530)));
                    time_start_30254 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage1_28535,
                                                                1, NULL,
                                                                global_work_sizze_30253,
                                                                local_work_sizze_30257,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage1_28535_runs,
                                                                                                          &ctx->testziscan_stage1_28535_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30255 = get_wall_time();
                    
                    long time_diff_30256 = time_end_30255 - time_start_30254;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage1_28535", time_diff_30256);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_28530 *
                                     sdiv_up64(flat_dim_26302,
                                               sext_i32_i64(num_threads_29344))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28535,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_29343),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28535,
                                                    2, sizeof(flat_dim_26302),
                                                    &flat_dim_26302));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28535,
                                                    3, sizeof(mem_28967.mem),
                                                    &mem_28967.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28535,
                                                    4,
                                                    sizeof(stage1_num_groups_29343),
                                                    &stage1_num_groups_29343));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28535,
                                                    5,
                                                    sizeof(num_threads_29344),
                                                    &num_threads_29344));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_29343) != 0) {
                const size_t global_work_sizze_30258[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_29343};
                const size_t local_work_sizze_30262[1] =
                             {stage1_num_groups_29343};
                int64_t time_start_30259 = 0, time_end_30260 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage2_28535");
                    fprintf(stderr, "%zu", global_work_sizze_30258[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30262[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_29343)));
                    time_start_30259 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage2_28535,
                                                                1, NULL,
                                                                global_work_sizze_30258,
                                                                local_work_sizze_30262,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage2_28535_runs,
                                                                                                          &ctx->testziscan_stage2_28535_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30260 = get_wall_time();
                    
                    long time_diff_30261 = time_end_30260 - time_start_30259;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage2_28535", time_diff_30261);
                }
            }
            
            int32_t required_groups_29380;
            
            required_groups_29380 = sext_i64_i32(sdiv_up64(flat_dim_26302,
                                                           segscan_group_sizze_28530));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28535,
                                                    1, sizeof(flat_dim_26302),
                                                    &flat_dim_26302));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28535,
                                                    2, sizeof(num_groups_28532),
                                                    &num_groups_28532));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28535,
                                                    3, sizeof(mem_28967.mem),
                                                    &mem_28967.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28535,
                                                    4,
                                                    sizeof(num_threads_29344),
                                                    &num_threads_29344));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28535,
                                                    5,
                                                    sizeof(required_groups_29380),
                                                    &required_groups_29380));
            if (1 * ((size_t) num_groups_28532 *
                     (size_t) segscan_group_sizze_28530) != 0) {
                const size_t global_work_sizze_30263[1] =
                             {(size_t) num_groups_28532 *
                             (size_t) segscan_group_sizze_28530};
                const size_t local_work_sizze_30267[1] =
                             {segscan_group_sizze_28530};
                int64_t time_start_30264 = 0, time_end_30265 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage3_28535");
                    fprintf(stderr, "%zu", global_work_sizze_30263[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30267[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_30264 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage3_28535,
                                                                1, NULL,
                                                                global_work_sizze_30263,
                                                                local_work_sizze_30267,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage3_28535_runs,
                                                                                                          &ctx->testziscan_stage3_28535_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30265 = get_wall_time();
                    
                    long time_diff_30266 = time_end_30265 - time_start_30264;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage3_28535", time_diff_30266);
                }
            }
        }
        
        struct memblock_device testzicounter_mem_29392 =
                               ctx->testzicounter_mem_29392;
        struct memblock_device group_res_arr_mem_29394;
        
        group_res_arr_mem_29394.references = NULL;
        if (memblock_alloc_device(ctx, &group_res_arr_mem_29394,
                                  (int32_t) sizeof(int64_t) *
                                  (segred_group_sizze_28538 * num_groups_28540),
                                  "group_res_arr_mem_29394")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_29396;
        
        num_threads_29396 = num_groups_28540 * segred_group_sizze_28538;
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegRed");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28545,
                                                1, (int32_t) sizeof(int64_t) *
                                                segred_group_sizze_28538,
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28545,
                                                2, (int32_t) sizeof(bool),
                                                NULL));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28545,
                                                3, sizeof(flat_dim_26302),
                                                &flat_dim_26302));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28545,
                                                4, sizeof(num_groups_28540),
                                                &num_groups_28540));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28545,
                                                5, sizeof(mem_28969.mem),
                                                &mem_28969.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28545,
                                                6, sizeof(mem_28972.mem),
                                                &mem_28972.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28545,
                                                7,
                                                sizeof(testzicounter_mem_29392.mem),
                                                &testzicounter_mem_29392.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28545,
                                                8,
                                                sizeof(group_res_arr_mem_29394.mem),
                                                &group_res_arr_mem_29394.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28545,
                                                9, sizeof(num_threads_29396),
                                                &num_threads_29396));
        if (1 * ((size_t) num_groups_28540 *
                 (size_t) segred_group_sizze_28538) != 0) {
            const size_t global_work_sizze_30269[1] =
                         {(size_t) num_groups_28540 *
                         (size_t) segred_group_sizze_28538};
            const size_t local_work_sizze_30273[1] = {segred_group_sizze_28538};
            int64_t time_start_30270 = 0, time_end_30271 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segred_nonseg_28545");
                fprintf(stderr, "%zu", global_work_sizze_30269[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_30273[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) (0 + (int32_t) sizeof(int64_t) *
                               segred_group_sizze_28538 +
                               (int32_t) sizeof(bool)));
                time_start_30270 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegred_nonseg_28545,
                                                            1, NULL,
                                                            global_work_sizze_30269,
                                                            local_work_sizze_30273,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegred_nonseg_28545_runs,
                                                                                                      &ctx->testzisegred_nonseg_28545_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_30271 = get_wall_time();
                
                long time_diff_30272 = time_end_30271 - time_start_30270;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segred_nonseg_28545", time_diff_30272);
            }
        }
        
        int64_t read_res_30274;
        
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     mem_28972.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0 * sizeof(int64_t),
                                                     sizeof(int64_t),
                                                     &read_res_30274, 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_scalar_from_dev_runs,
                                                                                               &ctx->copy_scalar_from_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t res_26335 = read_res_30274;
        bool bounds_invalid_upwards_26340 = slt64(res_26335, 0);
        bool valid_26341 = !bounds_invalid_upwards_26340;
        bool range_valid_c_26342;
        
        if (!valid_26341) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Range ", 0, "..", 1, "..<", res_26335,
                          " is invalid.",
                          "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:48:30-60\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:87:14-32\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva.fut:133:38-97\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  cva.fut:126:44-136:50\n   #9  cva.fut:166:3-120\n   #10 cva.fut:165:1-166:128\n");
            if (memblock_unref_device(ctx, &group_res_arr_mem_29394,
                                      "group_res_arr_mem_29394") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28972, "mem_28972") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28969, "mem_28969") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28967, "mem_28967") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28949, "mem_28949") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28964, "mem_28964") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28946, "mem_28946") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28936, "res_mem_28936") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28935, "res_mem_28935") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28934, "res_mem_28934") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28933, "res_mem_28933") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29210,
                                      "group_res_arr_mem_29210") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28886, "mem_28886") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28881, "mem_28881") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28879, "mem_28879") != 0)
                return 1;
            return 1;
        }
        
        int64_t bytes_28973 = 8 * res_26335;
        struct memblock_device mem_28974;
        
        mem_28974.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28974, bytes_28973, "mem_28974")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_28974, res_26335, 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int32_t num_subhistos_29431;
        struct memblock_device res_subhistos_mem_29432;
        
        res_subhistos_mem_29432.references = NULL;
        
        int64_t h_29434;
        
        h_29434 = (int32_t) sizeof(int64_t) * res_26335;
        
        int64_t seg_h_29435;
        
        seg_h_29435 = (int32_t) sizeof(int64_t) * res_26335;
        if (!(seg_h_29435 == 0)) {
            int64_t hist_H_29436 = res_26335;
            int64_t hist_el_sizze_29437 = sdiv_up64(h_29434, hist_H_29436) + 4;
            int64_t hist_N_29438 = flat_dim_26302;
            int64_t hist_RF_29439 = 1;
            
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegHist");
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of threads (T)",
                        (long long) sext_i64_i32(num_groups_28550 *
                        seghist_group_sizze_28548), '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Desired group size (B)",
                        (long long) seghist_group_sizze_28548, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                        (long long) hist_H_29436, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Input elements per histogram (N)",
                        (long long) hist_N_29438, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Number of segments",
                        (long long) 1, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Histogram element size (el_size)",
                        (long long) hist_el_sizze_29437, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "Race factor (RF)",
                        (long long) hist_RF_29439, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Memory per set of subhistograms per segment",
                        (long long) h_29434, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c",
                        "Memory per set of subhistograms times segments",
                        (long long) seg_h_29435, '\n');
            
            int32_t hist_L_29440;
            
            hist_L_29440 = ctx->opencl.max_local_memory;
            
            int32_t max_group_sizze_29441;
            
            max_group_sizze_29441 = ctx->opencl.max_group_size;
            
            int64_t num_groups_29442;
            
            num_groups_29442 =
                sdiv_up64(sext_i32_i64(sext_i64_i32(num_groups_28550 *
                          seghist_group_sizze_28548)), max_group_sizze_29441);
            
            double hist_m_prime_29443;
            
            hist_m_prime_29443 =
                sitofp_i64_f64(smin64(sext_i32_i64(squot32(hist_L_29440,
                                                           hist_el_sizze_29437)),
                                      sdiv_up64(hist_N_29438,
                                                num_groups_29442))) /
                sitofp_i64_f64(hist_H_29436);
            
            int64_t hist_M0_29444;
            
            hist_M0_29444 = smax64(1, smin64(fptosi_f64_i64(hist_m_prime_29443),
                                             max_group_sizze_29441));
            
            int64_t hist_Nout_29445;
            
            hist_Nout_29445 = 1;
            
            int64_t hist_Nin_29446;
            
            hist_Nin_29446 = flat_dim_26302;
            
            int64_t work_asymp_M_max_29447;
            
            work_asymp_M_max_29447 = squot64(hist_Nout_29445 * hist_N_29438, 2 *
                                             num_groups_29442 * hist_H_29436);
            
            int32_t hist_M_29448;
            
            hist_M_29448 = sext_i64_i32(smin64(hist_M0_29444,
                                               work_asymp_M_max_29447));
            
            int64_t hist_C_29449;
            
            hist_C_29449 = sdiv_up64(max_group_sizze_29441,
                                     sext_i32_i64(smax32(1, hist_M_29448)));
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local hist_M0",
                        (long long) hist_M0_29444, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local work asymp M max",
                        (long long) work_asymp_M_max_29447, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local C",
                        (long long) hist_C_29449, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local B",
                        (long long) max_group_sizze_29441, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local M",
                        (long long) hist_M_29448, '\n');
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "local memory needed",
                        (long long) (hist_H_29436 * hist_el_sizze_29437 *
                                     sext_i32_i64(hist_M_29448)), '\n');
            
            int64_t local_mem_needed_29450;
            
            local_mem_needed_29450 = hist_el_sizze_29437 *
                sext_i32_i64(hist_M_29448);
            
            int32_t hist_S_29451;
            
            hist_S_29451 = sext_i64_i32(sdiv_up64(hist_H_29436 *
                                                  local_mem_needed_29450,
                                                  hist_L_29440));
            if (sle64(hist_H_29436, hist_Nin_29446) &&
                (sle64(local_mem_needed_29450, hist_L_29440) &&
                 (sle32(hist_S_29451, 6) && (sle64(hist_C_29449,
                                                   max_group_sizze_29441) &&
                                             slt32(0, hist_M_29448))))) {
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "## Using local memory");
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Histogram size (H)",
                            (long long) hist_H_29436, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                            (long long) hist_M_29448, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Cooperation level (C)",
                            (long long) hist_C_29449, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                            (long long) hist_S_29451, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c",
                            "Number of local subhistograms per group",
                            (long long) hist_M_29448, '\n');
                
                int64_t num_segments_29452;
                
                num_segments_29452 = 1;
                num_subhistos_29431 = num_groups_29442 * num_segments_29452;
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c",
                            "Number of subhistograms in global memory",
                            (long long) num_subhistos_29431, '\n');
                if (num_subhistos_29431 == 1) {
                    if (memblock_set_device(ctx, &res_subhistos_mem_29432,
                                            &mem_28974, "mem_28974") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &res_subhistos_mem_29432,
                                              sext_i32_i64(num_subhistos_29431) *
                                              res_26335 *
                                              (int32_t) sizeof(int64_t),
                                              "res_subhistos_mem_29432")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i64(ctx,
                                                      res_subhistos_mem_29432,
                                                      num_subhistos_29431 *
                                                      res_26335, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (res_26335 * (int32_t) sizeof(int64_t) > 0) {
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                     mem_28974.mem,
                                                                     res_subhistos_mem_29432.mem,
                                                                     0, 0,
                                                                     res_26335 *
                                                                     (int32_t) sizeof(int64_t),
                                                                     0, NULL,
                                                                     ctx->profiling_paused ||
                                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
                        if (ctx->debugging)
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    }
                }
                for (int32_t chk_i_29453 = 0; chk_i_29453 < hist_S_29451;
                     chk_i_29453++) {
                    int64_t num_segments_29454 = 1;
                    int64_t hist_H_chk_29455 = sdiv_up64(res_26335,
                                                         sext_i32_i64(hist_S_29451));
                    int64_t histo_sizze_29456 = hist_H_chk_29455;
                    int32_t init_per_thread_29457 =
                            sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_29448) *
                                                   histo_sizze_29456,
                                                   max_group_sizze_29441));
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_28553,
                                                            1,
                                                            (int32_t) sizeof(int32_t) *
                                                            (hist_M_29448 *
                                                             hist_H_chk_29455),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_28553,
                                                            2,
                                                            (int32_t) sizeof(int64_t) *
                                                            (hist_M_29448 *
                                                             hist_H_chk_29455),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_28553,
                                                            3,
                                                            sizeof(flat_dim_26302),
                                                            &flat_dim_26302));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_28553,
                                                            4,
                                                            sizeof(res_26335),
                                                            &res_26335));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_28553,
                                                            5,
                                                            sizeof(mem_28967.mem),
                                                            &mem_28967.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_28553,
                                                            6,
                                                            sizeof(res_subhistos_mem_29432.mem),
                                                            &res_subhistos_mem_29432.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_28553,
                                                            7,
                                                            sizeof(max_group_sizze_29441),
                                                            &max_group_sizze_29441));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_28553,
                                                            8,
                                                            sizeof(num_groups_29442),
                                                            &num_groups_29442));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_28553,
                                                            9,
                                                            sizeof(hist_M_29448),
                                                            &hist_M_29448));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_28553,
                                                            10,
                                                            sizeof(chk_i_29453),
                                                            &chk_i_29453));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_28553,
                                                            11,
                                                            sizeof(num_segments_29454),
                                                            &num_segments_29454));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_28553,
                                                            12,
                                                            sizeof(hist_H_chk_29455),
                                                            &hist_H_chk_29455));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_28553,
                                                            13,
                                                            sizeof(histo_sizze_29456),
                                                            &histo_sizze_29456));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_local_28553,
                                                            14,
                                                            sizeof(init_per_thread_29457),
                                                            &init_per_thread_29457));
                    if (1 * ((size_t) num_groups_29442 *
                             (size_t) max_group_sizze_29441) != 0) {
                        const size_t global_work_sizze_30275[1] =
                                     {(size_t) num_groups_29442 *
                                     (size_t) max_group_sizze_29441};
                        const size_t local_work_sizze_30279[1] =
                                     {max_group_sizze_29441};
                        int64_t time_start_30276 = 0, time_end_30277 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.seghist_local_28553");
                            fprintf(stderr, "%zu", global_work_sizze_30275[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_30279[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(int32_t) *
                                           (hist_M_29448 * hist_H_chk_29455) +
                                           (int32_t) sizeof(int64_t) *
                                           (hist_M_29448 * hist_H_chk_29455)));
                            time_start_30276 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testziseghist_local_28553,
                                                                        1, NULL,
                                                                        global_work_sizze_30275,
                                                                        local_work_sizze_30279,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testziseghist_local_28553_runs,
                                                                                                                  &ctx->testziseghist_local_28553_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_30277 = get_wall_time();
                            
                            long time_diff_30278 = time_end_30277 -
                                 time_start_30276;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.seghist_local_28553",
                                    time_diff_30278);
                        }
                    }
                }
            } else {
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "## Using global memory");
                
                int64_t hist_H_29489;
                
                hist_H_29489 = res_26335;
                
                double hist_RF_29490;
                
                hist_RF_29490 = (0.0 + sitofp_i32_f64(1)) / 1.0;
                
                int32_t hist_el_sizze_29491;
                
                hist_el_sizze_29491 =
                    squot32(sext_i64_i32((int32_t) sizeof(int32_t) +
                            (int32_t) sizeof(int64_t)), 2);
                
                double hist_C_max_29492;
                
                hist_C_max_29492 =
                    fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_28550 *
                           seghist_group_sizze_28548)),
                           sitofp_i32_f64(hist_H_29489) / 2.0);
                
                int32_t hist_M_min_29493;
                
                hist_M_min_29493 = smax32(1,
                                          sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_28550 *
                                          seghist_group_sizze_28548)) /
                                          hist_C_max_29492)));
                
                int32_t L2_sizze_29494;
                
                L2_sizze_29494 = ctx->sizes.testziL2_sizze_29494;
                
                double hist_RACE_exp_29495;
                
                hist_RACE_exp_29495 = fmax64(1.0, 0.75 * hist_RF_29490 / (64.0 /
                                                                          sitofp_i32_f64(hist_el_sizze_29491)));
                
                int32_t hist_S_29496;
                
                if (slt64(flat_dim_26302, hist_H_29489)) {
                    hist_S_29496 = 1;
                } else {
                    hist_S_29496 =
                        sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_min_29493) *
                                               hist_H_29489 *
                                               sext_i32_i64(hist_el_sizze_29491),
                                               fptosi_f64_i64(0.4 *
                                               sitofp_i32_f64(L2_sizze_29494) *
                                               hist_RACE_exp_29495)));
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s: %f%c",
                            "Race expansion factor (RACE^exp)",
                            (double) hist_RACE_exp_29495, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Number of chunks (S)",
                            (long long) hist_S_29496, '\n');
                
                int64_t hist_H_chk_29497;
                
                hist_H_chk_29497 = sdiv_up64(res_26335,
                                             sext_i32_i64(hist_S_29496));
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Chunk size (H_chk)",
                            (long long) hist_H_chk_29497, '\n');
                
                double hist_k_max_29498;
                
                hist_k_max_29498 = fmin64(0.4 *
                                          (sitofp_i32_f64(L2_sizze_29494) /
                                           sitofp_i32_f64(sext_i64_i32((int32_t) sizeof(int32_t) +
                                           (int32_t) sizeof(int64_t)))) *
                                          hist_RACE_exp_29495,
                                          sitofp_i32_f64(flat_dim_26302)) /
                    sitofp_i32_f64(sext_i64_i32(num_groups_28550 *
                    seghist_group_sizze_28548));
                
                int64_t hist_u_29499;
                
                hist_u_29499 = 1;
                
                double hist_C_29500;
                
                hist_C_29500 =
                    fmin64(sitofp_i32_f64(sext_i64_i32(num_groups_28550 *
                           seghist_group_sizze_28548)),
                           sitofp_i32_f64(hist_u_29499 * hist_H_chk_29497) /
                           hist_k_max_29498);
                
                int32_t hist_M_29501;
                
                hist_M_29501 = smax32(hist_M_min_29493,
                                      sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_groups_28550 *
                                      seghist_group_sizze_28548)) /
                                      hist_C_29500)));
                if (ctx->debugging)
                    fprintf(stderr, "%s: %f%c",
                            "Elements/thread in L2 cache (k_max)",
                            (double) hist_k_max_29498, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %llu%c", "Multiplication degree (M)",
                            (long long) hist_M_29501, '\n');
                if (ctx->debugging)
                    fprintf(stderr, "%s: %f%c", "Cooperation level (C)",
                            (double) hist_C_29500, '\n');
                num_subhistos_29431 = sext_i32_i64(hist_M_29501);
                if (hist_M_29501 == 1) {
                    if (memblock_set_device(ctx, &res_subhistos_mem_29432,
                                            &mem_28974, "mem_28974") != 0)
                        return 1;
                } else {
                    if (num_subhistos_29431 == 1) {
                        if (memblock_set_device(ctx, &res_subhistos_mem_29432,
                                                &mem_28974, "mem_28974") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &res_subhistos_mem_29432,
                                                  sext_i32_i64(num_subhistos_29431) *
                                                  res_26335 *
                                                  (int32_t) sizeof(int64_t),
                                                  "res_subhistos_mem_29432")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx,
                                                          res_subhistos_mem_29432,
                                                          num_subhistos_29431 *
                                                          res_26335, 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if (res_26335 * (int32_t) sizeof(int64_t) > 0) {
                            OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue,
                                                                         mem_28974.mem,
                                                                         res_subhistos_mem_29432.mem,
                                                                         0, 0,
                                                                         res_26335 *
                                                                         (int32_t) sizeof(int64_t),
                                                                         0,
                                                                         NULL,
                                                                         ctx->profiling_paused ||
                                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                   &ctx->copy_dev_to_dev_runs,
                                                                                                                   &ctx->copy_dev_to_dev_total_runtime)));
                            if (ctx->debugging)
                                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        }
                    }
                }
                
                struct memblock_device testzihist_locks_mem_29502 =
                                       ctx->testzihist_locks_mem_29502;
                
                for (int32_t chk_i_29504 = 0; chk_i_29504 < hist_S_29496;
                     chk_i_29504++) {
                    int64_t hist_H_chk_29505 = sdiv_up64(res_26335,
                                                         sext_i32_i64(hist_S_29496));
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_28553,
                                                            1,
                                                            sizeof(flat_dim_26302),
                                                            &flat_dim_26302));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_28553,
                                                            2,
                                                            sizeof(res_26335),
                                                            &res_26335));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_28553,
                                                            3,
                                                            sizeof(num_groups_28550),
                                                            &num_groups_28550));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_28553,
                                                            4,
                                                            sizeof(mem_28967.mem),
                                                            &mem_28967.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_28553,
                                                            5,
                                                            sizeof(num_subhistos_29431),
                                                            &num_subhistos_29431));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_28553,
                                                            6,
                                                            sizeof(res_subhistos_mem_29432.mem),
                                                            &res_subhistos_mem_29432.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_28553,
                                                            7,
                                                            sizeof(testzihist_locks_mem_29502.mem),
                                                            &testzihist_locks_mem_29502.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_28553,
                                                            8,
                                                            sizeof(chk_i_29504),
                                                            &chk_i_29504));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziseghist_global_28553,
                                                            9,
                                                            sizeof(hist_H_chk_29505),
                                                            &hist_H_chk_29505));
                    if (1 * ((size_t) num_groups_28550 *
                             (size_t) seghist_group_sizze_28548) != 0) {
                        const size_t global_work_sizze_30281[1] =
                                     {(size_t) num_groups_28550 *
                                     (size_t) seghist_group_sizze_28548};
                        const size_t local_work_sizze_30285[1] =
                                     {seghist_group_sizze_28548};
                        int64_t time_start_30282 = 0, time_end_30283 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.seghist_global_28553");
                            fprintf(stderr, "%zu", global_work_sizze_30281[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_30285[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) 0);
                            time_start_30282 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testziseghist_global_28553,
                                                                        1, NULL,
                                                                        global_work_sizze_30281,
                                                                        local_work_sizze_30285,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testziseghist_global_28553_runs,
                                                                                                                  &ctx->testziseghist_global_28553_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_30283 = get_wall_time();
                            
                            long time_diff_30284 = time_end_30283 -
                                 time_start_30282;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.seghist_global_28553",
                                    time_diff_30284);
                        }
                    }
                }
            }
            if (num_subhistos_29431 == 1) {
                if (memblock_set_device(ctx, &mem_28974,
                                        &res_subhistos_mem_29432,
                                        "res_subhistos_mem_29432") != 0)
                    return 1;
            } else {
                if (slt64(num_subhistos_29431 * 2, seghist_group_sizze_28548)) {
                    int64_t segment_sizze_nonzzero_29518 = smax64(1,
                                                                  num_subhistos_29431);
                    int64_t num_threads_29519 = num_groups_28550 *
                            seghist_group_sizze_28548;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-small");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) res_26335, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) num_subhistos_29431, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segments_per_group",
                                (long long) squot64(seghist_group_sizze_28548,
                                                    segment_sizze_nonzzero_29518),
                                '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "required_groups",
                                (long long) sext_i64_i32(sdiv_up64(res_26335,
                                                                   squot64(seghist_group_sizze_28548,
                                                                           segment_sizze_nonzzero_29518))),
                                '\n');
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_29517,
                                                            1,
                                                            (int32_t) sizeof(int64_t) *
                                                            seghist_group_sizze_28548,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_29517,
                                                            2,
                                                            sizeof(res_26335),
                                                            &res_26335));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_29517,
                                                            3,
                                                            sizeof(num_groups_28550),
                                                            &num_groups_28550));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_29517,
                                                            4,
                                                            sizeof(mem_28974.mem),
                                                            &mem_28974.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_29517,
                                                            5,
                                                            sizeof(num_subhistos_29431),
                                                            &num_subhistos_29431));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_29517,
                                                            6,
                                                            sizeof(res_subhistos_mem_29432.mem),
                                                            &res_subhistos_mem_29432.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_29517,
                                                            7,
                                                            sizeof(segment_sizze_nonzzero_29518),
                                                            &segment_sizze_nonzzero_29518));
                    if (1 * ((size_t) num_groups_28550 *
                             (size_t) seghist_group_sizze_28548) != 0) {
                        const size_t global_work_sizze_30286[1] =
                                     {(size_t) num_groups_28550 *
                                     (size_t) seghist_group_sizze_28548};
                        const size_t local_work_sizze_30290[1] =
                                     {seghist_group_sizze_28548};
                        int64_t time_start_30287 = 0, time_end_30288 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.segred_small_29517");
                            fprintf(stderr, "%zu", global_work_sizze_30286[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_30290[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(int64_t) *
                                           seghist_group_sizze_28548));
                            time_start_30287 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testzisegred_small_29517,
                                                                        1, NULL,
                                                                        global_work_sizze_30286,
                                                                        local_work_sizze_30290,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testzisegred_small_29517_runs,
                                                                                                                  &ctx->testzisegred_small_29517_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_30288 = get_wall_time();
                            
                            long time_diff_30289 = time_end_30288 -
                                 time_start_30287;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.segred_small_29517", time_diff_30289);
                        }
                    }
                } else {
                    int64_t groups_per_segment_29539 =
                            sdiv_up64(num_groups_28550, smax64(1, res_26335));
                    int64_t elements_per_thread_29540 =
                            sdiv_up64(num_subhistos_29431,
                                      seghist_group_sizze_28548 *
                                      groups_per_segment_29539);
                    int64_t virt_num_groups_29541 = groups_per_segment_29539 *
                            res_26335;
                    int64_t num_threads_29542 = num_groups_28550 *
                            seghist_group_sizze_28548;
                    int64_t threads_per_segment_29543 =
                            groups_per_segment_29539 *
                            seghist_group_sizze_28548;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-large");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) res_26335, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) num_subhistos_29431, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                                (long long) virt_num_groups_29541, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_groups",
                                (long long) num_groups_28550, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "group_size",
                                (long long) seghist_group_sizze_28548, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                                (long long) elements_per_thread_29540, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                                (long long) groups_per_segment_29539, '\n');
                    
                    struct memblock_device group_res_arr_mem_29544;
                    
                    group_res_arr_mem_29544.references = NULL;
                    if (memblock_alloc_device(ctx, &group_res_arr_mem_29544,
                                              (int32_t) sizeof(int64_t) *
                                              (seghist_group_sizze_28548 *
                                               virt_num_groups_29541),
                                              "group_res_arr_mem_29544")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device testzicounter_mem_29546 =
                                           ctx->testzicounter_mem_29546;
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_29517,
                                                            1,
                                                            (int32_t) sizeof(bool),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_29517,
                                                            2,
                                                            (int32_t) sizeof(int64_t) *
                                                            seghist_group_sizze_28548,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_29517,
                                                            3,
                                                            sizeof(res_26335),
                                                            &res_26335));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_29517,
                                                            4,
                                                            sizeof(num_groups_28550),
                                                            &num_groups_28550));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_29517,
                                                            5,
                                                            sizeof(mem_28974.mem),
                                                            &mem_28974.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_29517,
                                                            6,
                                                            sizeof(num_subhistos_29431),
                                                            &num_subhistos_29431));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_29517,
                                                            7,
                                                            sizeof(res_subhistos_mem_29432.mem),
                                                            &res_subhistos_mem_29432.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_29517,
                                                            8,
                                                            sizeof(groups_per_segment_29539),
                                                            &groups_per_segment_29539));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_29517,
                                                            9,
                                                            sizeof(elements_per_thread_29540),
                                                            &elements_per_thread_29540));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_29517,
                                                            10,
                                                            sizeof(virt_num_groups_29541),
                                                            &virt_num_groups_29541));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_29517,
                                                            11,
                                                            sizeof(threads_per_segment_29543),
                                                            &threads_per_segment_29543));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_29517,
                                                            12,
                                                            sizeof(group_res_arr_mem_29544.mem),
                                                            &group_res_arr_mem_29544.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_29517,
                                                            13,
                                                            sizeof(testzicounter_mem_29546.mem),
                                                            &testzicounter_mem_29546.mem));
                    if (1 * ((size_t) num_groups_28550 *
                             (size_t) seghist_group_sizze_28548) != 0) {
                        const size_t global_work_sizze_30292[1] =
                                     {(size_t) num_groups_28550 *
                                     (size_t) seghist_group_sizze_28548};
                        const size_t local_work_sizze_30296[1] =
                                     {seghist_group_sizze_28548};
                        int64_t time_start_30293 = 0, time_end_30294 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.segred_large_29517");
                            fprintf(stderr, "%zu", global_work_sizze_30292[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_30296[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(bool) +
                                           (int32_t) sizeof(int64_t) *
                                           seghist_group_sizze_28548));
                            time_start_30293 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testzisegred_large_29517,
                                                                        1, NULL,
                                                                        global_work_sizze_30292,
                                                                        local_work_sizze_30296,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testzisegred_large_29517_runs,
                                                                                                                  &ctx->testzisegred_large_29517_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_30294 = get_wall_time();
                            
                            long time_diff_30295 = time_end_30294 -
                                 time_start_30293;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.segred_large_29517", time_diff_30295);
                        }
                    }
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29544,
                                              "group_res_arr_mem_29544") != 0)
                        return 1;
                }
            }
        }
        
        int64_t num_groups_28565;
        int32_t max_num_groups_29578;
        
        max_num_groups_29578 = ctx->sizes.testzisegscan_num_groups_28564;
        num_groups_28565 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_26335,
                                                                   sext_i32_i64(segscan_group_sizze_28563)),
                                                         sext_i32_i64(max_num_groups_29578))));
        
        struct memblock_device mem_28978;
        
        mem_28978.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28978, res_26335, "mem_28978")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28980;
        
        mem_28980.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28980, bytes_28973, "mem_28980")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_26335)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_29579;
            
            stage1_max_num_groups_29579 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_29580;
            
            stage1_num_groups_29580 = smin64(stage1_max_num_groups_29579,
                                             num_groups_28565);
            
            int32_t num_threads_29581;
            
            num_threads_29581 = sext_i64_i32(stage1_num_groups_29580 *
                segscan_group_sizze_28563);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28568,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_28563),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28568,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              segscan_group_sizze_28563),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28568,
                                                    3, sizeof(res_26335),
                                                    &res_26335));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28568,
                                                    4, sizeof(mem_28974.mem),
                                                    &mem_28974.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28568,
                                                    5, sizeof(mem_28978.mem),
                                                    &mem_28978.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28568,
                                                    6, sizeof(mem_28980.mem),
                                                    &mem_28980.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28568,
                                                    7,
                                                    sizeof(num_threads_29581),
                                                    &num_threads_29581));
            if (1 * ((size_t) stage1_num_groups_29580 *
                     (size_t) segscan_group_sizze_28563) != 0) {
                const size_t global_work_sizze_30297[1] =
                             {(size_t) stage1_num_groups_29580 *
                             (size_t) segscan_group_sizze_28563};
                const size_t local_work_sizze_30301[1] =
                             {segscan_group_sizze_28563};
                int64_t time_start_30298 = 0, time_end_30299 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage1_28568");
                    fprintf(stderr, "%zu", global_work_sizze_30297[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30301[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_28563) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          segscan_group_sizze_28563)));
                    time_start_30298 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage1_28568,
                                                                1, NULL,
                                                                global_work_sizze_30297,
                                                                local_work_sizze_30301,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage1_28568_runs,
                                                                                                          &ctx->testziscan_stage1_28568_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30299 = get_wall_time();
                    
                    long time_diff_30300 = time_end_30299 - time_start_30298;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage1_28568", time_diff_30300);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_28563 *
                                     sdiv_up64(res_26335,
                                               sext_i32_i64(num_threads_29581))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28568,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_29580),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28568,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              stage1_num_groups_29580),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28568,
                                                    3, sizeof(res_26335),
                                                    &res_26335));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28568,
                                                    4, sizeof(mem_28978.mem),
                                                    &mem_28978.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28568,
                                                    5, sizeof(mem_28980.mem),
                                                    &mem_28980.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28568,
                                                    6,
                                                    sizeof(stage1_num_groups_29580),
                                                    &stage1_num_groups_29580));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28568,
                                                    7,
                                                    sizeof(num_threads_29581),
                                                    &num_threads_29581));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_29580) != 0) {
                const size_t global_work_sizze_30302[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_29580};
                const size_t local_work_sizze_30306[1] =
                             {stage1_num_groups_29580};
                int64_t time_start_30303 = 0, time_end_30304 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage2_28568");
                    fprintf(stderr, "%zu", global_work_sizze_30302[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30306[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_29580) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          stage1_num_groups_29580)));
                    time_start_30303 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage2_28568,
                                                                1, NULL,
                                                                global_work_sizze_30302,
                                                                local_work_sizze_30306,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage2_28568_runs,
                                                                                                          &ctx->testziscan_stage2_28568_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30304 = get_wall_time();
                    
                    long time_diff_30305 = time_end_30304 - time_start_30303;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage2_28568", time_diff_30305);
                }
            }
            
            int32_t required_groups_29633;
            
            required_groups_29633 = sext_i64_i32(sdiv_up64(res_26335,
                                                           segscan_group_sizze_28563));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28568,
                                                    1, sizeof(res_26335),
                                                    &res_26335));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28568,
                                                    2, sizeof(num_groups_28565),
                                                    &num_groups_28565));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28568,
                                                    3, sizeof(mem_28978.mem),
                                                    &mem_28978.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28568,
                                                    4, sizeof(mem_28980.mem),
                                                    &mem_28980.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28568,
                                                    5,
                                                    sizeof(num_threads_29581),
                                                    &num_threads_29581));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28568,
                                                    6,
                                                    sizeof(required_groups_29633),
                                                    &required_groups_29633));
            if (1 * ((size_t) num_groups_28565 *
                     (size_t) segscan_group_sizze_28563) != 0) {
                const size_t global_work_sizze_30307[1] =
                             {(size_t) num_groups_28565 *
                             (size_t) segscan_group_sizze_28563};
                const size_t local_work_sizze_30311[1] =
                             {segscan_group_sizze_28563};
                int64_t time_start_30308 = 0, time_end_30309 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage3_28568");
                    fprintf(stderr, "%zu", global_work_sizze_30307[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30311[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_30308 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage3_28568,
                                                                1, NULL,
                                                                global_work_sizze_30307,
                                                                local_work_sizze_30311,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage3_28568_runs,
                                                                                                          &ctx->testziscan_stage3_28568_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30309 = get_wall_time();
                    
                    long time_diff_30310 = time_end_30309 - time_start_30308;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage3_28568", time_diff_30310);
                }
            }
        }
        if (memblock_unref_device(ctx, &mem_28974, "mem_28974") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28978, "mem_28978") != 0)
            return 1;
        
        int64_t num_groups_28573;
        int32_t max_num_groups_29645;
        
        max_num_groups_29645 = ctx->sizes.testzisegscan_num_groups_28572;
        num_groups_28573 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_26335,
                                                                   sext_i32_i64(segscan_group_sizze_28571)),
                                                         sext_i32_i64(max_num_groups_29645))));
        
        struct memblock_device mem_28983;
        
        mem_28983.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28983, res_26335, "mem_28983")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28985;
        
        mem_28985.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28985, bytes_28973, "mem_28985")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28987;
        
        mem_28987.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28987, res_26335, "mem_28987")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_26335)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_29646;
            
            stage1_max_num_groups_29646 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_29647;
            
            stage1_num_groups_29647 = smin64(stage1_max_num_groups_29646,
                                             num_groups_28573);
            
            int32_t num_threads_29648;
            
            num_threads_29648 = sext_i64_i32(stage1_num_groups_29647 *
                segscan_group_sizze_28571);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28576,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_28571),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28576,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              segscan_group_sizze_28571),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28576,
                                                    3, sizeof(res_26335),
                                                    &res_26335));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28576,
                                                    4, sizeof(mem_28980.mem),
                                                    &mem_28980.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28576,
                                                    5, sizeof(mem_28983.mem),
                                                    &mem_28983.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28576,
                                                    6, sizeof(mem_28985.mem),
                                                    &mem_28985.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28576,
                                                    7, sizeof(mem_28987.mem),
                                                    &mem_28987.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28576,
                                                    8,
                                                    sizeof(num_threads_29648),
                                                    &num_threads_29648));
            if (1 * ((size_t) stage1_num_groups_29647 *
                     (size_t) segscan_group_sizze_28571) != 0) {
                const size_t global_work_sizze_30312[1] =
                             {(size_t) stage1_num_groups_29647 *
                             (size_t) segscan_group_sizze_28571};
                const size_t local_work_sizze_30316[1] =
                             {segscan_group_sizze_28571};
                int64_t time_start_30313 = 0, time_end_30314 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage1_28576");
                    fprintf(stderr, "%zu", global_work_sizze_30312[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30316[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_28571) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          segscan_group_sizze_28571)));
                    time_start_30313 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage1_28576,
                                                                1, NULL,
                                                                global_work_sizze_30312,
                                                                local_work_sizze_30316,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage1_28576_runs,
                                                                                                          &ctx->testziscan_stage1_28576_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30314 = get_wall_time();
                    
                    long time_diff_30315 = time_end_30314 - time_start_30313;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage1_28576", time_diff_30315);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_28571 *
                                     sdiv_up64(res_26335,
                                               sext_i32_i64(num_threads_29648))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28576,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_29647),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28576,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              stage1_num_groups_29647),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28576,
                                                    3, sizeof(res_26335),
                                                    &res_26335));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28576,
                                                    4, sizeof(mem_28983.mem),
                                                    &mem_28983.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28576,
                                                    5, sizeof(mem_28985.mem),
                                                    &mem_28985.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28576,
                                                    6,
                                                    sizeof(stage1_num_groups_29647),
                                                    &stage1_num_groups_29647));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28576,
                                                    7,
                                                    sizeof(num_threads_29648),
                                                    &num_threads_29648));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_29647) != 0) {
                const size_t global_work_sizze_30317[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_29647};
                const size_t local_work_sizze_30321[1] =
                             {stage1_num_groups_29647};
                int64_t time_start_30318 = 0, time_end_30319 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage2_28576");
                    fprintf(stderr, "%zu", global_work_sizze_30317[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30321[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_29647) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          stage1_num_groups_29647)));
                    time_start_30318 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage2_28576,
                                                                1, NULL,
                                                                global_work_sizze_30317,
                                                                local_work_sizze_30321,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage2_28576_runs,
                                                                                                          &ctx->testziscan_stage2_28576_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30319 = get_wall_time();
                    
                    long time_diff_30320 = time_end_30319 - time_start_30318;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage2_28576", time_diff_30320);
                }
            }
            
            int32_t required_groups_29700;
            
            required_groups_29700 = sext_i64_i32(sdiv_up64(res_26335,
                                                           segscan_group_sizze_28571));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28576,
                                                    1, sizeof(res_26335),
                                                    &res_26335));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28576,
                                                    2, sizeof(num_groups_28573),
                                                    &num_groups_28573));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28576,
                                                    3, sizeof(mem_28983.mem),
                                                    &mem_28983.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28576,
                                                    4, sizeof(mem_28985.mem),
                                                    &mem_28985.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28576,
                                                    5,
                                                    sizeof(num_threads_29648),
                                                    &num_threads_29648));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28576,
                                                    6,
                                                    sizeof(required_groups_29700),
                                                    &required_groups_29700));
            if (1 * ((size_t) num_groups_28573 *
                     (size_t) segscan_group_sizze_28571) != 0) {
                const size_t global_work_sizze_30322[1] =
                             {(size_t) num_groups_28573 *
                             (size_t) segscan_group_sizze_28571};
                const size_t local_work_sizze_30326[1] =
                             {segscan_group_sizze_28571};
                int64_t time_start_30323 = 0, time_end_30324 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage3_28576");
                    fprintf(stderr, "%zu", global_work_sizze_30322[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30326[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_30323 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage3_28576,
                                                                1, NULL,
                                                                global_work_sizze_30322,
                                                                local_work_sizze_30326,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage3_28576_runs,
                                                                                                          &ctx->testziscan_stage3_28576_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30324 = get_wall_time();
                    
                    long time_diff_30325 = time_end_30324 - time_start_30323;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage3_28576", time_diff_30325);
                }
            }
        }
        if (memblock_unref_device(ctx, &mem_28983, "mem_28983") != 0)
            return 1;
        
        int64_t num_groups_28581;
        int32_t max_num_groups_29712;
        
        max_num_groups_29712 = ctx->sizes.testzisegscan_num_groups_28580;
        num_groups_28581 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_26335,
                                                                   sext_i32_i64(segscan_group_sizze_28579)),
                                                         sext_i32_i64(max_num_groups_29712))));
        
        struct memblock_device mem_28990;
        
        mem_28990.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28990, res_26335, "mem_28990")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t bytes_28991 = 4 * res_26335;
        struct memblock_device mem_28992;
        
        mem_28992.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28992, bytes_28991, "mem_28992")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_26335)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_29713;
            
            stage1_max_num_groups_29713 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_29714;
            
            stage1_num_groups_29714 = smin64(stage1_max_num_groups_29713,
                                             num_groups_28581);
            
            int32_t num_threads_29715;
            
            num_threads_29715 = sext_i64_i32(stage1_num_groups_29714 *
                segscan_group_sizze_28579);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    1,
                                                    sizeof(ctx->failure_is_an_option),
                                                    &ctx->failure_is_an_option));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    3, smax64(1,
                                                              (int32_t) sizeof(float) *
                                                              segscan_group_sizze_28579),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    4, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              segscan_group_sizze_28579),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    5, sizeof(paths_26135),
                                                    &paths_26135));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    6, sizeof(flat_dim_26302),
                                                    &flat_dim_26302));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    7, sizeof(res_26315),
                                                    &res_26315));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    8, sizeof(res_26335),
                                                    &res_26335));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    9, sizeof(i_28461),
                                                    &i_28461));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    10,
                                                    sizeof(res_mem_28933.mem),
                                                    &res_mem_28933.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    11,
                                                    sizeof(res_mem_28934.mem),
                                                    &res_mem_28934.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    12,
                                                    sizeof(res_mem_28935.mem),
                                                    &res_mem_28935.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    13,
                                                    sizeof(res_mem_28936.mem),
                                                    &res_mem_28936.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    14, sizeof(mem_28964.mem),
                                                    &mem_28964.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    15, sizeof(mem_28980.mem),
                                                    &mem_28980.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    16, sizeof(mem_28985.mem),
                                                    &mem_28985.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    17, sizeof(mem_28987.mem),
                                                    &mem_28987.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    18, sizeof(mem_28990.mem),
                                                    &mem_28990.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    19, sizeof(mem_28992.mem),
                                                    &mem_28992.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28584,
                                                    20,
                                                    sizeof(num_threads_29715),
                                                    &num_threads_29715));
            if (1 * ((size_t) stage1_num_groups_29714 *
                     (size_t) segscan_group_sizze_28579) != 0) {
                const size_t global_work_sizze_30327[1] =
                             {(size_t) stage1_num_groups_29714 *
                             (size_t) segscan_group_sizze_28579};
                const size_t local_work_sizze_30331[1] =
                             {segscan_group_sizze_28579};
                int64_t time_start_30328 = 0, time_end_30329 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage1_28584");
                    fprintf(stderr, "%zu", global_work_sizze_30327[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30331[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                              segscan_group_sizze_28579) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          segscan_group_sizze_28579)));
                    time_start_30328 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage1_28584,
                                                                1, NULL,
                                                                global_work_sizze_30327,
                                                                local_work_sizze_30331,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage1_28584_runs,
                                                                                                          &ctx->testziscan_stage1_28584_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30329 = get_wall_time();
                    
                    long time_diff_30330 = time_end_30329 - time_start_30328;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage1_28584", time_diff_30330);
                }
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_28579 *
                                     sdiv_up64(res_26335,
                                               sext_i32_i64(num_threads_29715))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28584,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(float) *
                                                              stage1_num_groups_29714),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28584,
                                                    2, smax64(1,
                                                              (int32_t) sizeof(bool) *
                                                              stage1_num_groups_29714),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28584,
                                                    3, sizeof(res_26335),
                                                    &res_26335));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28584,
                                                    4, sizeof(mem_28990.mem),
                                                    &mem_28990.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28584,
                                                    5, sizeof(mem_28992.mem),
                                                    &mem_28992.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28584,
                                                    6,
                                                    sizeof(stage1_num_groups_29714),
                                                    &stage1_num_groups_29714));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28584,
                                                    7,
                                                    sizeof(num_threads_29715),
                                                    &num_threads_29715));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_29714) != 0) {
                const size_t global_work_sizze_30332[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_29714};
                const size_t local_work_sizze_30336[1] =
                             {stage1_num_groups_29714};
                int64_t time_start_30333 = 0, time_end_30334 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage2_28584");
                    fprintf(stderr, "%zu", global_work_sizze_30332[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30336[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(float) *
                                              stage1_num_groups_29714) +
                                   smax64(1, (int32_t) sizeof(bool) *
                                          stage1_num_groups_29714)));
                    time_start_30333 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage2_28584,
                                                                1, NULL,
                                                                global_work_sizze_30332,
                                                                local_work_sizze_30336,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage2_28584_runs,
                                                                                                          &ctx->testziscan_stage2_28584_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30334 = get_wall_time();
                    
                    long time_diff_30335 = time_end_30334 - time_start_30333;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage2_28584", time_diff_30335);
                }
            }
            
            int32_t required_groups_29767;
            
            required_groups_29767 = sext_i64_i32(sdiv_up64(res_26335,
                                                           segscan_group_sizze_28579));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28584,
                                                    1, sizeof(res_26335),
                                                    &res_26335));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28584,
                                                    2, sizeof(num_groups_28581),
                                                    &num_groups_28581));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28584,
                                                    3, sizeof(mem_28990.mem),
                                                    &mem_28990.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28584,
                                                    4, sizeof(mem_28992.mem),
                                                    &mem_28992.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28584,
                                                    5,
                                                    sizeof(num_threads_29715),
                                                    &num_threads_29715));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28584,
                                                    6,
                                                    sizeof(required_groups_29767),
                                                    &required_groups_29767));
            if (1 * ((size_t) num_groups_28581 *
                     (size_t) segscan_group_sizze_28579) != 0) {
                const size_t global_work_sizze_30337[1] =
                             {(size_t) num_groups_28581 *
                             (size_t) segscan_group_sizze_28579};
                const size_t local_work_sizze_30341[1] =
                             {segscan_group_sizze_28579};
                int64_t time_start_30338 = 0, time_end_30339 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage3_28584");
                    fprintf(stderr, "%zu", global_work_sizze_30337[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30341[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_30338 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage3_28584,
                                                                1, NULL,
                                                                global_work_sizze_30337,
                                                                local_work_sizze_30341,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage3_28584_runs,
                                                                                                          &ctx->testziscan_stage3_28584_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30339 = get_wall_time();
                    
                    long time_diff_30340 = time_end_30339 - time_start_30338;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage3_28584", time_diff_30340);
                }
            }
        }
        if (memblock_unref_device(ctx, &mem_28980, "mem_28980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28985, "mem_28985") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28990, "mem_28990") != 0)
            return 1;
        
        int64_t num_groups_28633;
        int32_t max_num_groups_29779;
        
        max_num_groups_29779 = ctx->sizes.testzisegscan_num_groups_28632;
        num_groups_28633 = sext_i64_i32(smax64(1, smin64(sdiv_up64(res_26335,
                                                                   sext_i32_i64(segscan_group_sizze_28631)),
                                                         sext_i32_i64(max_num_groups_29779))));
        
        struct memblock_device mem_28995;
        
        mem_28995.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28995, bytes_28973, "mem_28995")) {
            err = 1;
            goto cleanup;
        }
        if (slt64(0, res_26335)) {
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegScan");
            
            int64_t stage1_max_num_groups_29780;
            
            stage1_max_num_groups_29780 = ctx->opencl.max_group_size;
            
            int64_t stage1_num_groups_29781;
            
            stage1_num_groups_29781 = smin64(stage1_max_num_groups_29780,
                                             num_groups_28633);
            
            int32_t num_threads_29782;
            
            num_threads_29782 = sext_i64_i32(stage1_num_groups_29781 *
                segscan_group_sizze_28631);
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28636,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              segscan_group_sizze_28631),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28636,
                                                    2, sizeof(res_26335),
                                                    &res_26335));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28636,
                                                    3, sizeof(mem_28987.mem),
                                                    &mem_28987.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28636,
                                                    4, sizeof(mem_28995.mem),
                                                    &mem_28995.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage1_28636,
                                                    5,
                                                    sizeof(num_threads_29782),
                                                    &num_threads_29782));
            if (1 * ((size_t) stage1_num_groups_29781 *
                     (size_t) segscan_group_sizze_28631) != 0) {
                const size_t global_work_sizze_30342[1] =
                             {(size_t) stage1_num_groups_29781 *
                             (size_t) segscan_group_sizze_28631};
                const size_t local_work_sizze_30346[1] =
                             {segscan_group_sizze_28631};
                int64_t time_start_30343 = 0, time_end_30344 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage1_28636");
                    fprintf(stderr, "%zu", global_work_sizze_30342[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30346[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              segscan_group_sizze_28631)));
                    time_start_30343 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage1_28636,
                                                                1, NULL,
                                                                global_work_sizze_30342,
                                                                local_work_sizze_30346,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage1_28636_runs,
                                                                                                          &ctx->testziscan_stage1_28636_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30344 = get_wall_time();
                    
                    long time_diff_30345 = time_end_30344 - time_start_30343;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage1_28636", time_diff_30345);
                }
            }
            if (ctx->debugging)
                fprintf(stderr, "%s: %llu%c", "elems_per_group",
                        (long long) (segscan_group_sizze_28631 *
                                     sdiv_up64(res_26335,
                                               sext_i32_i64(num_threads_29782))),
                        '\n');
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28636,
                                                    1, smax64(1,
                                                              (int32_t) sizeof(int64_t) *
                                                              stage1_num_groups_29781),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28636,
                                                    2, sizeof(res_26335),
                                                    &res_26335));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28636,
                                                    3, sizeof(mem_28995.mem),
                                                    &mem_28995.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28636,
                                                    4,
                                                    sizeof(stage1_num_groups_29781),
                                                    &stage1_num_groups_29781));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage2_28636,
                                                    5,
                                                    sizeof(num_threads_29782),
                                                    &num_threads_29782));
            if (1 * ((size_t) 1 * (size_t) stage1_num_groups_29781) != 0) {
                const size_t global_work_sizze_30347[1] = {(size_t) 1 *
                             (size_t) stage1_num_groups_29781};
                const size_t local_work_sizze_30351[1] =
                             {stage1_num_groups_29781};
                int64_t time_start_30348 = 0, time_end_30349 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage2_28636");
                    fprintf(stderr, "%zu", global_work_sizze_30347[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30351[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + smax64(1, (int32_t) sizeof(int64_t) *
                                              stage1_num_groups_29781)));
                    time_start_30348 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage2_28636,
                                                                1, NULL,
                                                                global_work_sizze_30347,
                                                                local_work_sizze_30351,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage2_28636_runs,
                                                                                                          &ctx->testziscan_stage2_28636_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30349 = get_wall_time();
                    
                    long time_diff_30350 = time_end_30349 - time_start_30348;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage2_28636", time_diff_30350);
                }
            }
            
            int32_t required_groups_29818;
            
            required_groups_29818 = sext_i64_i32(sdiv_up64(res_26335,
                                                           segscan_group_sizze_28631));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28636,
                                                    1, sizeof(res_26335),
                                                    &res_26335));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28636,
                                                    2, sizeof(num_groups_28633),
                                                    &num_groups_28633));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28636,
                                                    3, sizeof(mem_28995.mem),
                                                    &mem_28995.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28636,
                                                    4,
                                                    sizeof(num_threads_29782),
                                                    &num_threads_29782));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testziscan_stage3_28636,
                                                    5,
                                                    sizeof(required_groups_29818),
                                                    &required_groups_29818));
            if (1 * ((size_t) num_groups_28633 *
                     (size_t) segscan_group_sizze_28631) != 0) {
                const size_t global_work_sizze_30352[1] =
                             {(size_t) num_groups_28633 *
                             (size_t) segscan_group_sizze_28631};
                const size_t local_work_sizze_30356[1] =
                             {segscan_group_sizze_28631};
                int64_t time_start_30353 = 0, time_end_30354 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.scan_stage3_28636");
                    fprintf(stderr, "%zu", global_work_sizze_30352[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30356[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) 0);
                    time_start_30353 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testziscan_stage3_28636,
                                                                1, NULL,
                                                                global_work_sizze_30352,
                                                                local_work_sizze_30356,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testziscan_stage3_28636_runs,
                                                                                                          &ctx->testziscan_stage3_28636_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30354 = get_wall_time();
                    
                    long time_diff_30355 = time_end_30354 - time_start_30353;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.scan_stage3_28636", time_diff_30355);
                }
            }
        }
        
        bool cond_26521 = slt64(0, res_26335);
        int64_t num_segments_26522;
        
        if (cond_26521) {
            int64_t i_26523 = sub64(res_26335, 1);
            bool x_26524 = sle64(0, i_26523);
            bool y_26525 = slt64(i_26523, res_26335);
            bool bounds_check_26526 = x_26524 && y_26525;
            bool index_certs_26527;
            
            if (!bounds_check_26526) {
                ctx->error =
                    msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                              "Index [", i_26523,
                              "] out of bounds for array of shape [", res_26335,
                              "].",
                              "-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/segmented/segmented.fut:29:36-59\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #4  cva.fut:133:38-97\n   #5  /prelude/soacs.fut:56:19-23\n   #6  /prelude/soacs.fut:56:3-37\n   #7  cva.fut:126:44-136:50\n   #8  cva.fut:166:3-120\n   #9  cva.fut:165:1-166:128\n");
                if (memblock_unref_device(ctx, &mem_28995, "mem_28995") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28992, "mem_28992") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28990, "mem_28990") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28987, "mem_28987") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28985, "mem_28985") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28983, "mem_28983") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28980, "mem_28980") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28978, "mem_28978") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_subhistos_mem_29432,
                                          "res_subhistos_mem_29432") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28974, "mem_28974") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_29394,
                                          "group_res_arr_mem_29394") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28972, "mem_28972") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28969, "mem_28969") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28967, "mem_28967") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28949, "mem_28949") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28964, "mem_28964") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28946, "mem_28946") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28936,
                                          "res_mem_28936") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28935,
                                          "res_mem_28935") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28934,
                                          "res_mem_28934") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &res_mem_28933,
                                          "res_mem_28933") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &group_res_arr_mem_29210,
                                          "group_res_arr_mem_29210") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28886, "mem_28886") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28881, "mem_28881") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28879, "mem_28879") != 0)
                    return 1;
                return 1;
            }
            
            int64_t read_res_30357;
            
            OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                         mem_28995.mem,
                                                         ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                         i_26523 *
                                                         sizeof(int64_t),
                                                         sizeof(int64_t),
                                                         &read_res_30357, 0,
                                                         NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_scalar_from_dev_runs,
                                                                                                   &ctx->copy_scalar_from_dev_total_runtime)));
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
                return 1;
            
            int64_t res_26528 = read_res_30357;
            
            num_segments_26522 = res_26528;
        } else {
            num_segments_26522 = 0;
        }
        
        bool bounds_invalid_upwards_26529 = slt64(num_segments_26522, 0);
        bool valid_26530 = !bounds_invalid_upwards_26529;
        bool range_valid_c_26531;
        
        if (!valid_26530) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Range ", 0, "..", 1, "..<", num_segments_26522,
                          " is invalid.",
                          "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  lib/github.com/diku-dk/segmented/segmented.fut:33:17-41\n   #3  lib/github.com/diku-dk/segmented/segmented.fut:91:6-36\n   #4  lib/github.com/diku-dk/segmented/segmented.fut:103:6-37\n   #5  cva.fut:133:38-97\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  cva.fut:126:44-136:50\n   #9  cva.fut:166:3-120\n   #10 cva.fut:165:1-166:128\n");
            if (memblock_unref_device(ctx, &mem_28995, "mem_28995") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28992, "mem_28992") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28990, "mem_28990") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28987, "mem_28987") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28985, "mem_28985") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28983, "mem_28983") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28980, "mem_28980") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28978, "mem_28978") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_subhistos_mem_29432,
                                      "res_subhistos_mem_29432") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28974, "mem_28974") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29394,
                                      "group_res_arr_mem_29394") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28972, "mem_28972") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28969, "mem_28969") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28967, "mem_28967") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28949, "mem_28949") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28964, "mem_28964") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28946, "mem_28946") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28936, "res_mem_28936") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28935, "res_mem_28935") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28934, "res_mem_28934") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28933, "res_mem_28933") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29210,
                                      "group_res_arr_mem_29210") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28886, "mem_28886") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28881, "mem_28881") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28879, "mem_28879") != 0)
                return 1;
            return 1;
        }
        
        int64_t bytes_28996 = 4 * num_segments_26522;
        struct memblock_device mem_28997;
        
        mem_28997.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28997, bytes_28996, "mem_28997")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_f32(ctx, mem_28997, num_segments_26522,
                                          0.0F) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t segmap_group_sizze_28641;
        
        segmap_group_sizze_28641 = ctx->sizes.testzisegmap_group_sizze_28640;
        
        int64_t segmap_usable_groups_28642 = sdiv_up64(res_26335,
                                                       segmap_group_sizze_28641);
        
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28638, 1,
                                                sizeof(res_26335), &res_26335));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28638, 2,
                                                sizeof(num_segments_26522),
                                                &num_segments_26522));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28638, 3,
                                                sizeof(mem_28987.mem),
                                                &mem_28987.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28638, 4,
                                                sizeof(mem_28992.mem),
                                                &mem_28992.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28638, 5,
                                                sizeof(mem_28995.mem),
                                                &mem_28995.mem));
        OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28638, 6,
                                                sizeof(mem_28997.mem),
                                                &mem_28997.mem));
        if (1 * ((size_t) segmap_usable_groups_28642 *
                 (size_t) segmap_group_sizze_28641) != 0) {
            const size_t global_work_sizze_30358[1] =
                         {(size_t) segmap_usable_groups_28642 *
                         (size_t) segmap_group_sizze_28641};
            const size_t local_work_sizze_30362[1] = {segmap_group_sizze_28641};
            int64_t time_start_30359 = 0, time_end_30360 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with global work size [",
                        "test.segmap_28638");
                fprintf(stderr, "%zu", global_work_sizze_30358[0]);
                fprintf(stderr, "] and local work size [");
                fprintf(stderr, "%zu", local_work_sizze_30362[0]);
                fprintf(stderr, "]; local memory parameters sum to %d bytes.\n",
                        (int) 0);
                time_start_30359 = get_wall_time();
            }
            OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                            ctx->testzisegmap_28638,
                                                            1, NULL,
                                                            global_work_sizze_30358,
                                                            local_work_sizze_30362,
                                                            0, NULL,
                                                            ctx->profiling_paused ||
                                                            !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                      &ctx->testzisegmap_28638_runs,
                                                                                                      &ctx->testzisegmap_28638_total_runtime)));
            if (ctx->debugging) {
                OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                time_end_30360 = get_wall_time();
                
                long time_diff_30361 = time_end_30360 - time_start_30359;
                
                fprintf(stderr, "kernel %s runtime: %ldus\n",
                        "test.segmap_28638", time_diff_30361);
            }
        }
        if (memblock_unref_device(ctx, &mem_28987, "mem_28987") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28992, "mem_28992") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28995, "mem_28995") != 0)
            return 1;
        
        bool dim_match_26539 = flat_dim_26302 == num_segments_26522;
        bool empty_or_match_cert_26540;
        
        if (!dim_match_26539) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Value of (core language) shape (",
                                   num_segments_26522,
                                   ") cannot match shape of type `[",
                                   flat_dim_26302, "]b`.",
                                   "-> #0  lib/github.com/diku-dk/segmented/segmented.fut:103:6-45\n   #1  cva.fut:133:38-97\n   #2  /prelude/soacs.fut:56:19-23\n   #3  /prelude/soacs.fut:56:3-37\n   #4  cva.fut:126:44-136:50\n   #5  cva.fut:166:3-120\n   #6  cva.fut:165:1-166:128\n");
            if (memblock_unref_device(ctx, &mem_28997, "mem_28997") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28995, "mem_28995") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28992, "mem_28992") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28990, "mem_28990") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28987, "mem_28987") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28985, "mem_28985") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28983, "mem_28983") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28980, "mem_28980") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28978, "mem_28978") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_subhistos_mem_29432,
                                      "res_subhistos_mem_29432") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28974, "mem_28974") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29394,
                                      "group_res_arr_mem_29394") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28972, "mem_28972") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28969, "mem_28969") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28967, "mem_28967") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28949, "mem_28949") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28964, "mem_28964") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28946, "mem_28946") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28936, "res_mem_28936") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28935, "res_mem_28935") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28934, "res_mem_28934") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &res_mem_28933, "res_mem_28933") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29210,
                                      "group_res_arr_mem_29210") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28886, "mem_28886") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28881, "mem_28881") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28879, "mem_28879") != 0)
                return 1;
            return 1;
        }
        
        float res_26542;
        int32_t local_memory_capacity_29977;
        
        local_memory_capacity_29977 = ctx->opencl.max_local_memory;
        if (sle64((int32_t) sizeof(bool) + (int32_t) sizeof(float) *
                  segred_group_sizze_28656,
                  sext_i32_i64(local_memory_capacity_29977)) &&
            suff_outer_redomap_28644) {
            struct memblock_device mem_29001;
            
            mem_29001.references = NULL;
            if (memblock_alloc_device(ctx, &mem_29001, bytes_28999,
                                      "mem_29001")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_29001, 0,
                                                      mem_28997, 0, 1, 9,
                                                      paths_26135) != 0) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_29004;
            
            mem_29004.references = NULL;
            if (memblock_alloc_device(ctx, &mem_29004, 4, "mem_29004")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device testzicounter_mem_29844 =
                                   ctx->testzicounter_mem_29844;
            struct memblock_device group_res_arr_mem_29846;
            
            group_res_arr_mem_29846.references = NULL;
            if (memblock_alloc_device(ctx, &group_res_arr_mem_29846,
                                      (int32_t) sizeof(float) *
                                      (segred_group_sizze_28656 *
                                       num_groups_28657),
                                      "group_res_arr_mem_29846")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_29848;
            
            num_threads_29848 = num_groups_28657 * segred_group_sizze_28656;
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegRed");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28654,
                                                    1, (int32_t) sizeof(float) *
                                                    segred_group_sizze_28656,
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28654,
                                                    2, (int32_t) sizeof(bool),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28654,
                                                    3, sizeof(paths_26135),
                                                    &paths_26135));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28654,
                                                    4, sizeof(num_groups_28657),
                                                    &num_groups_28657));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28654,
                                                    5, sizeof(mem_29001.mem),
                                                    &mem_29001.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28654,
                                                    6, sizeof(mem_29004.mem),
                                                    &mem_29004.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28654,
                                                    7,
                                                    sizeof(testzicounter_mem_29844.mem),
                                                    &testzicounter_mem_29844.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28654,
                                                    8,
                                                    sizeof(group_res_arr_mem_29846.mem),
                                                    &group_res_arr_mem_29846.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28654,
                                                    9,
                                                    sizeof(num_threads_29848),
                                                    &num_threads_29848));
            if (1 * ((size_t) num_groups_28657 *
                     (size_t) segred_group_sizze_28656) != 0) {
                const size_t global_work_sizze_30364[1] =
                             {(size_t) num_groups_28657 *
                             (size_t) segred_group_sizze_28656};
                const size_t local_work_sizze_30368[1] =
                             {segred_group_sizze_28656};
                int64_t time_start_30365 = 0, time_end_30366 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.segred_nonseg_28654");
                    fprintf(stderr, "%zu", global_work_sizze_30364[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30368[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + (int32_t) sizeof(float) *
                                   segred_group_sizze_28656 +
                                   (int32_t) sizeof(bool)));
                    time_start_30365 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testzisegred_nonseg_28654,
                                                                1, NULL,
                                                                global_work_sizze_30364,
                                                                local_work_sizze_30368,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testzisegred_nonseg_28654_runs,
                                                                                                          &ctx->testzisegred_nonseg_28654_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30366 = get_wall_time();
                    
                    long time_diff_30367 = time_end_30366 - time_start_30365;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.segred_nonseg_28654", time_diff_30367);
                }
            }
            if (memblock_unref_device(ctx, &mem_29001, "mem_29001") != 0)
                return 1;
            
            float read_res_30369;
            
            OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                         mem_29004.mem,
                                                         ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                         0 * sizeof(float),
                                                         sizeof(float),
                                                         &read_res_30369, 0,
                                                         NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_scalar_from_dev_runs,
                                                                                                   &ctx->copy_scalar_from_dev_total_runtime)));
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
                return 1;
            
            float res_28670 = read_res_30369;
            
            if (memblock_unref_device(ctx, &mem_29004, "mem_29004") != 0)
                return 1;
            res_26542 = res_28670;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29846,
                                      "group_res_arr_mem_29846") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29004, "mem_29004") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29001, "mem_29001") != 0)
                return 1;
        } else {
            struct memblock_device res_map_acc_mem_29017;
            
            res_map_acc_mem_29017.references = NULL;
            
            int32_t local_memory_capacity_29946;
            
            local_memory_capacity_29946 = ctx->opencl.max_local_memory;
            if (sle64(0, sext_i32_i64(local_memory_capacity_29946)) &&
                suff_outer_par_28752) {
                struct memblock_device mem_29007;
                
                mem_29007.references = NULL;
                if (memblock_alloc_device(ctx, &mem_29007, bytes_28999,
                                          "mem_29007")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhgpu_map_transpose_f32(ctx, mem_29007, 0,
                                                          mem_28997, 0, 1, 9,
                                                          paths_26135) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_29010;
                
                mem_29010.references = NULL;
                if (memblock_alloc_device(ctx, &mem_29010, bytes_28938,
                                          "mem_29010")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28676,
                                                        1, sizeof(paths_26135),
                                                        &paths_26135));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28676,
                                                        2,
                                                        sizeof(mem_29007.mem),
                                                        &mem_29007.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28676,
                                                        3,
                                                        sizeof(mem_29010.mem),
                                                        &mem_29010.mem));
                if (1 * ((size_t) segmap_usable_groups_28756 *
                         (size_t) segmap_group_sizze_28755) != 0) {
                    const size_t global_work_sizze_30370[1] =
                                 {(size_t) segmap_usable_groups_28756 *
                                 (size_t) segmap_group_sizze_28755};
                    const size_t local_work_sizze_30374[1] =
                                 {segmap_group_sizze_28755};
                    int64_t time_start_30371 = 0, time_end_30372 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.segmap_28676");
                        fprintf(stderr, "%zu", global_work_sizze_30370[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_30374[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_30371 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testzisegmap_28676,
                                                                    1, NULL,
                                                                    global_work_sizze_30370,
                                                                    local_work_sizze_30374,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testzisegmap_28676_runs,
                                                                                                              &ctx->testzisegmap_28676_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_30372 = get_wall_time();
                        
                        long time_diff_30373 = time_end_30372 -
                             time_start_30371;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.segmap_28676", time_diff_30373);
                    }
                }
                if (memblock_unref_device(ctx, &mem_29007, "mem_29007") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_29017, &mem_29010,
                                        "mem_29010") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_29010, "mem_29010") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_29007, "mem_29007") != 0)
                    return 1;
            } else {
                struct memblock_device mem_29013;
                
                mem_29013.references = NULL;
                if (memblock_alloc_device(ctx, &mem_29013, bytes_28938,
                                          "mem_29013")) {
                    err = 1;
                    goto cleanup;
                }
                if (slt64(18, segred_group_sizze_28767)) {
                    int64_t segment_sizze_nonzzero_29881 = 9;
                    int64_t num_threads_29882 = num_groups_28768 *
                            segred_group_sizze_28767;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-small");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) paths_26135, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) 9, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segments_per_group",
                                (long long) squot64(segred_group_sizze_28767,
                                                    segment_sizze_nonzzero_29881),
                                '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "required_groups",
                                (long long) sext_i64_i32(sdiv_up64(paths_26135,
                                                                   squot64(segred_group_sizze_28767,
                                                                           segment_sizze_nonzzero_29881))),
                                '\n');
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28717,
                                                            1,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_28767,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28717,
                                                            2,
                                                            sizeof(paths_26135),
                                                            &paths_26135));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28717,
                                                            3,
                                                            sizeof(num_groups_28768),
                                                            &num_groups_28768));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28717,
                                                            4,
                                                            sizeof(mem_28997.mem),
                                                            &mem_28997.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28717,
                                                            5,
                                                            sizeof(mem_29013.mem),
                                                            &mem_29013.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_small_28717,
                                                            6,
                                                            sizeof(segment_sizze_nonzzero_29881),
                                                            &segment_sizze_nonzzero_29881));
                    if (1 * ((size_t) num_groups_28768 *
                             (size_t) segred_group_sizze_28767) != 0) {
                        const size_t global_work_sizze_30375[1] =
                                     {(size_t) num_groups_28768 *
                                     (size_t) segred_group_sizze_28767};
                        const size_t local_work_sizze_30379[1] =
                                     {segred_group_sizze_28767};
                        int64_t time_start_30376 = 0, time_end_30377 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.segred_small_28717");
                            fprintf(stderr, "%zu", global_work_sizze_30375[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_30379[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(float) *
                                           segred_group_sizze_28767));
                            time_start_30376 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testzisegred_small_28717,
                                                                        1, NULL,
                                                                        global_work_sizze_30375,
                                                                        local_work_sizze_30379,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testzisegred_small_28717_runs,
                                                                                                                  &ctx->testzisegred_small_28717_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_30377 = get_wall_time();
                            
                            long time_diff_30378 = time_end_30377 -
                                 time_start_30376;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.segred_small_28717", time_diff_30378);
                        }
                    }
                } else {
                    int64_t groups_per_segment_29902 =
                            sdiv_up64(num_groups_28768, smax64(1, paths_26135));
                    int64_t elements_per_thread_29903 = sdiv_up64(9,
                                                                  segred_group_sizze_28767 *
                                                                  groups_per_segment_29902);
                    int64_t virt_num_groups_29904 = groups_per_segment_29902 *
                            paths_26135;
                    int64_t num_threads_29905 = num_groups_28768 *
                            segred_group_sizze_28767;
                    int64_t threads_per_segment_29906 =
                            groups_per_segment_29902 * segred_group_sizze_28767;
                    
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegRed-large");
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_segments",
                                (long long) paths_26135, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "segment_size",
                                (long long) 9, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "virt_num_groups",
                                (long long) virt_num_groups_29904, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "num_groups",
                                (long long) num_groups_28768, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "group_size",
                                (long long) segred_group_sizze_28767, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "elems_per_thread",
                                (long long) elements_per_thread_29903, '\n');
                    if (ctx->debugging)
                        fprintf(stderr, "%s: %llu%c", "groups_per_segment",
                                (long long) groups_per_segment_29902, '\n');
                    
                    struct memblock_device group_res_arr_mem_29907;
                    
                    group_res_arr_mem_29907.references = NULL;
                    if (memblock_alloc_device(ctx, &group_res_arr_mem_29907,
                                              (int32_t) sizeof(float) *
                                              (segred_group_sizze_28767 *
                                               virt_num_groups_29904),
                                              "group_res_arr_mem_29907")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device testzicounter_mem_29909 =
                                           ctx->testzicounter_mem_29909;
                    
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28717,
                                                            1,
                                                            (int32_t) sizeof(bool),
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28717,
                                                            2,
                                                            (int32_t) sizeof(float) *
                                                            segred_group_sizze_28767,
                                                            NULL));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28717,
                                                            3,
                                                            sizeof(num_groups_28768),
                                                            &num_groups_28768));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28717,
                                                            4,
                                                            sizeof(mem_28997.mem),
                                                            &mem_28997.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28717,
                                                            5,
                                                            sizeof(mem_29013.mem),
                                                            &mem_29013.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28717,
                                                            6,
                                                            sizeof(groups_per_segment_29902),
                                                            &groups_per_segment_29902));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28717,
                                                            7,
                                                            sizeof(elements_per_thread_29903),
                                                            &elements_per_thread_29903));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28717,
                                                            8,
                                                            sizeof(virt_num_groups_29904),
                                                            &virt_num_groups_29904));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28717,
                                                            9,
                                                            sizeof(threads_per_segment_29906),
                                                            &threads_per_segment_29906));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28717,
                                                            10,
                                                            sizeof(group_res_arr_mem_29907.mem),
                                                            &group_res_arr_mem_29907.mem));
                    OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_large_28717,
                                                            11,
                                                            sizeof(testzicounter_mem_29909.mem),
                                                            &testzicounter_mem_29909.mem));
                    if (1 * ((size_t) num_groups_28768 *
                             (size_t) segred_group_sizze_28767) != 0) {
                        const size_t global_work_sizze_30381[1] =
                                     {(size_t) num_groups_28768 *
                                     (size_t) segred_group_sizze_28767};
                        const size_t local_work_sizze_30385[1] =
                                     {segred_group_sizze_28767};
                        int64_t time_start_30382 = 0, time_end_30383 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr,
                                    "Launching %s with global work size [",
                                    "test.segred_large_28717");
                            fprintf(stderr, "%zu", global_work_sizze_30381[0]);
                            fprintf(stderr, "] and local work size [");
                            fprintf(stderr, "%zu", local_work_sizze_30385[0]);
                            fprintf(stderr,
                                    "]; local memory parameters sum to %d bytes.\n",
                                    (int) (0 + (int32_t) sizeof(bool) +
                                           (int32_t) sizeof(float) *
                                           segred_group_sizze_28767));
                            time_start_30382 = get_wall_time();
                        }
                        OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                        ctx->testzisegred_large_28717,
                                                                        1, NULL,
                                                                        global_work_sizze_30381,
                                                                        local_work_sizze_30385,
                                                                        0, NULL,
                                                                        ctx->profiling_paused ||
                                                                        !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                                  &ctx->testzisegred_large_28717_runs,
                                                                                                                  &ctx->testzisegred_large_28717_total_runtime)));
                        if (ctx->debugging) {
                            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                            time_end_30383 = get_wall_time();
                            
                            long time_diff_30384 = time_end_30383 -
                                 time_start_30382;
                            
                            fprintf(stderr, "kernel %s runtime: %ldus\n",
                                    "test.segred_large_28717", time_diff_30384);
                        }
                    }
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29907,
                                              "group_res_arr_mem_29907") != 0)
                        return 1;
                }
                
                struct memblock_device mem_29016;
                
                mem_29016.references = NULL;
                if (memblock_alloc_device(ctx, &mem_29016, bytes_28938,
                                          "mem_29016")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28701,
                                                        1, sizeof(paths_26135),
                                                        &paths_26135));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28701,
                                                        2,
                                                        sizeof(mem_29013.mem),
                                                        &mem_29013.mem));
                OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegmap_28701,
                                                        3,
                                                        sizeof(mem_29016.mem),
                                                        &mem_29016.mem));
                if (1 * ((size_t) segmap_usable_groups_28778 *
                         (size_t) segmap_group_sizze_28777) != 0) {
                    const size_t global_work_sizze_30386[1] =
                                 {(size_t) segmap_usable_groups_28778 *
                                 (size_t) segmap_group_sizze_28777};
                    const size_t local_work_sizze_30390[1] =
                                 {segmap_group_sizze_28777};
                    int64_t time_start_30387 = 0, time_end_30388 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with global work size [",
                                "test.segmap_28701");
                        fprintf(stderr, "%zu", global_work_sizze_30386[0]);
                        fprintf(stderr, "] and local work size [");
                        fprintf(stderr, "%zu", local_work_sizze_30390[0]);
                        fprintf(stderr,
                                "]; local memory parameters sum to %d bytes.\n",
                                (int) 0);
                        time_start_30387 = get_wall_time();
                    }
                    OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                    ctx->testzisegmap_28701,
                                                                    1, NULL,
                                                                    global_work_sizze_30386,
                                                                    local_work_sizze_30390,
                                                                    0, NULL,
                                                                    ctx->profiling_paused ||
                                                                    !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                              &ctx->testzisegmap_28701_runs,
                                                                                                              &ctx->testzisegmap_28701_total_runtime)));
                    if (ctx->debugging) {
                        OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                        time_end_30388 = get_wall_time();
                        
                        long time_diff_30389 = time_end_30388 -
                             time_start_30387;
                        
                        fprintf(stderr, "kernel %s runtime: %ldus\n",
                                "test.segmap_28701", time_diff_30389);
                    }
                }
                if (memblock_unref_device(ctx, &mem_29013, "mem_29013") != 0)
                    return 1;
                if (memblock_set_device(ctx, &res_map_acc_mem_29017, &mem_29016,
                                        "mem_29016") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_29016, "mem_29016") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_29013, "mem_29013") != 0)
                    return 1;
            }
            
            struct memblock_device mem_29020;
            
            mem_29020.references = NULL;
            if (memblock_alloc_device(ctx, &mem_29020, 4, "mem_29020")) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device testzicounter_mem_29947 =
                                   ctx->testzicounter_mem_29947;
            struct memblock_device group_res_arr_mem_29949;
            
            group_res_arr_mem_29949.references = NULL;
            if (memblock_alloc_device(ctx, &group_res_arr_mem_29949,
                                      (int32_t) sizeof(float) *
                                      (segred_group_sizze_28784 *
                                       num_groups_28785),
                                      "group_res_arr_mem_29949")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_29951;
            
            num_threads_29951 = num_groups_28785 * segred_group_sizze_28784;
            if (ctx->debugging)
                fprintf(stderr, "%s\n", "\n# SegRed");
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28750,
                                                    1, (int32_t) sizeof(float) *
                                                    segred_group_sizze_28784,
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28750,
                                                    2, (int32_t) sizeof(bool),
                                                    NULL));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28750,
                                                    3, sizeof(paths_26135),
                                                    &paths_26135));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28750,
                                                    4, sizeof(num_groups_28785),
                                                    &num_groups_28785));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28750,
                                                    5,
                                                    sizeof(res_map_acc_mem_29017.mem),
                                                    &res_map_acc_mem_29017.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28750,
                                                    6, sizeof(mem_29020.mem),
                                                    &mem_29020.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28750,
                                                    7,
                                                    sizeof(testzicounter_mem_29947.mem),
                                                    &testzicounter_mem_29947.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28750,
                                                    8,
                                                    sizeof(group_res_arr_mem_29949.mem),
                                                    &group_res_arr_mem_29949.mem));
            OPENCL_SUCCEED_OR_RETURN(clSetKernelArg(ctx->testzisegred_nonseg_28750,
                                                    9,
                                                    sizeof(num_threads_29951),
                                                    &num_threads_29951));
            if (1 * ((size_t) num_groups_28785 *
                     (size_t) segred_group_sizze_28784) != 0) {
                const size_t global_work_sizze_30392[1] =
                             {(size_t) num_groups_28785 *
                             (size_t) segred_group_sizze_28784};
                const size_t local_work_sizze_30396[1] =
                             {segred_group_sizze_28784};
                int64_t time_start_30393 = 0, time_end_30394 = 0;
                
                if (ctx->debugging) {
                    fprintf(stderr, "Launching %s with global work size [",
                            "test.segred_nonseg_28750");
                    fprintf(stderr, "%zu", global_work_sizze_30392[0]);
                    fprintf(stderr, "] and local work size [");
                    fprintf(stderr, "%zu", local_work_sizze_30396[0]);
                    fprintf(stderr,
                            "]; local memory parameters sum to %d bytes.\n",
                            (int) (0 + (int32_t) sizeof(float) *
                                   segred_group_sizze_28784 +
                                   (int32_t) sizeof(bool)));
                    time_start_30393 = get_wall_time();
                }
                OPENCL_SUCCEED_OR_RETURN(clEnqueueNDRangeKernel(ctx->opencl.queue,
                                                                ctx->testzisegred_nonseg_28750,
                                                                1, NULL,
                                                                global_work_sizze_30392,
                                                                local_work_sizze_30396,
                                                                0, NULL,
                                                                ctx->profiling_paused ||
                                                                !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                          &ctx->testzisegred_nonseg_28750_runs,
                                                                                                          &ctx->testzisegred_nonseg_28750_total_runtime)));
                if (ctx->debugging) {
                    OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
                    time_end_30394 = get_wall_time();
                    
                    long time_diff_30395 = time_end_30394 - time_start_30393;
                    
                    fprintf(stderr, "kernel %s runtime: %ldus\n",
                            "test.segred_nonseg_28750", time_diff_30395);
                }
            }
            if (memblock_unref_device(ctx, &res_map_acc_mem_29017,
                                      "res_map_acc_mem_29017") != 0)
                return 1;
            
            float read_res_30397;
            
            OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                         mem_29020.mem,
                                                         ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                         0 * sizeof(float),
                                                         sizeof(float),
                                                         &read_res_30397, 0,
                                                         NULL,
                                                         ctx->profiling_paused ||
                                                         !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                   &ctx->copy_scalar_from_dev_runs,
                                                                                                   &ctx->copy_scalar_from_dev_total_runtime)));
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
                return 1;
            
            float res_28792 = read_res_30397;
            
            if (memblock_unref_device(ctx, &mem_29020, "mem_29020") != 0)
                return 1;
            res_26542 = res_28792;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29949,
                                      "group_res_arr_mem_29949") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29020, "mem_29020") != 0)
                return 1;
            if (memblock_unref_device(ctx, &res_map_acc_mem_29017,
                                      "res_map_acc_mem_29017") != 0)
                return 1;
        }
        if (memblock_unref_device(ctx, &mem_28997, "mem_28997") != 0)
            return 1;
        
        float res_26553 = res_26542 / res_26306;
        float negate_arg_26554 = 1.0e-2F * res_26315;
        float exp_arg_26555 = 0.0F - negate_arg_26554;
        float res_26556 = fpow32(2.7182817F, exp_arg_26555);
        float x_26557 = 1.0F - res_26556;
        float B_26558 = x_26557 / 1.0e-2F;
        float x_26559 = B_26558 - res_26315;
        float x_26560 = 4.4999997e-6F * x_26559;
        float A1_26561 = x_26560 / 1.0e-4F;
        float y_26562 = fpow32(B_26558, 2.0F);
        float x_26563 = 1.0000001e-6F * y_26562;
        float A2_26564 = x_26563 / 4.0e-2F;
        float exp_arg_26565 = A1_26561 - A2_26564;
        float res_26566 = fpow32(2.7182817F, exp_arg_26565);
        float negate_arg_26567 = 5.0e-2F * B_26558;
        float exp_arg_26568 = 0.0F - negate_arg_26567;
        float res_26569 = fpow32(2.7182817F, exp_arg_26568);
        float res_26570 = res_26566 * res_26569;
        float res_26571 = res_26553 * res_26570;
        float res_26311 = res_26571 + redout_28460;
        float redout_tmp_29341 = res_26311;
        
        redout_28460 = redout_tmp_29341;
        if (memblock_unref_device(ctx, &mem_28997, "mem_28997") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28995, "mem_28995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28992, "mem_28992") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28990, "mem_28990") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28987, "mem_28987") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28985, "mem_28985") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28983, "mem_28983") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28980, "mem_28980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28978, "mem_28978") != 0)
            return 1;
        if (memblock_unref_device(ctx, &res_subhistos_mem_29432,
                                  "res_subhistos_mem_29432") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28974, "mem_28974") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29394,
                                  "group_res_arr_mem_29394") != 0)
            return 1;
    }
    res_26308 = redout_28460;
    if (memblock_unref_device(ctx, &res_mem_28933, "res_mem_28933") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28934, "res_mem_28934") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28935, "res_mem_28935") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28936, "res_mem_28936") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28964, "mem_28964") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28967, "mem_28967") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28969, "mem_28969") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28972, "mem_28972") != 0)
        return 1;
    
    float CVA_26572 = 6.0e-3F * res_26308;
    
    scalar_out_29203 = CVA_26572;
    *out_scalar_out_30203 = scalar_out_29203;
    if (memblock_unref_device(ctx, &mem_28972, "mem_28972") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28969, "mem_28969") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28967, "mem_28967") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28949, "mem_28949") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28964, "mem_28964") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28946, "mem_28946") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28936, "res_mem_28936") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28935, "res_mem_28935") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28934, "res_mem_28934") != 0)
        return 1;
    if (memblock_unref_device(ctx, &res_mem_28933, "res_mem_28933") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_29210,
                              "group_res_arr_mem_29210") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28886, "mem_28886") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28883, "mem_28883") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28881, "mem_28881") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28879, "mem_28879") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
struct futhark_i64_1d {
    struct memblock_device mem;
    int64_t shape[1];
} ;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const
                                          int64_t *data, int64_t dim0)
{
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr =
                          (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(int64_t),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(int64_t) > 0)
        OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                      arr->mem.mem, CL_TRUE, 0,
                                                      (size_t) dim0 *
                                                      sizeof(int64_t), data + 0,
                                                      0, NULL,
                                                      ctx->profiling_paused ||
                                                      !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                &ctx->copy_dev_to_host_runs,
                                                                                                &ctx->copy_dev_to_host_total_runtime)));
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0)
{
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr =
                          (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(int64_t),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(int64_t) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue, data,
                                                     arr->mem.mem, offset, 0,
                                                     (size_t) dim0 *
                                                     sizeof(int64_t), 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx,
                          struct futhark_i64_1d *arr, int64_t *data)
{
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * sizeof(int64_t) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     arr->mem.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0, (size_t) arr->shape[0] *
                                                     sizeof(int64_t), data + 0,
                                                     0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_host_to_dev_runs,
                                                                                               &ctx->copy_host_to_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
    }
    lock_unlock(&ctx->lock);
    return 0;
}
cl_mem futhark_values_raw_i64_1d(struct futhark_context *ctx,
                                 struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx,
                                    struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_1d {
    struct memblock_device mem;
    int64_t shape[1];
} ;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const
                                          float *data, int64_t dim0)
{
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr =
                          (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(float),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(float) > 0)
        OPENCL_SUCCEED_OR_RETURN(clEnqueueWriteBuffer(ctx->opencl.queue,
                                                      arr->mem.mem, CL_TRUE, 0,
                                                      (size_t) dim0 *
                                                      sizeof(float), data + 0,
                                                      0, NULL,
                                                      ctx->profiling_paused ||
                                                      !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                                &ctx->copy_dev_to_host_runs,
                                                                                                &ctx->copy_dev_to_host_total_runtime)));
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, const
                                              cl_mem data, int offset,
                                              int64_t dim0)
{
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr =
                          (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(float),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueCopyBuffer(ctx->opencl.queue, data,
                                                     arr->mem.mem, offset, 0,
                                                     (size_t) dim0 *
                                                     sizeof(float), 0, NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_dev_to_dev_runs,
                                                                                               &ctx->copy_dev_to_dev_total_runtime)));
        if (ctx->debugging)
            OPENCL_SUCCEED_FATAL(clFinish(ctx->opencl.queue));
    }
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_1d(struct futhark_context *ctx,
                          struct futhark_f32_1d *arr, float *data)
{
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * sizeof(float) > 0) {
        OPENCL_SUCCEED_OR_RETURN(clEnqueueReadBuffer(ctx->opencl.queue,
                                                     arr->mem.mem,
                                                     ctx->failure_is_an_option ? CL_FALSE : CL_TRUE,
                                                     0, (size_t) arr->shape[0] *
                                                     sizeof(float), data + 0, 0,
                                                     NULL,
                                                     ctx->profiling_paused ||
                                                     !ctx->profiling ? NULL : opencl_get_event(&ctx->opencl,
                                                                                               &ctx->copy_host_to_dev_runs,
                                                                                               &ctx->copy_host_to_dev_total_runtime)));
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0)
            return 1;
    }
    lock_unlock(&ctx->lock);
    return 0;
}
cl_mem futhark_values_raw_f32_1d(struct futhark_context *ctx,
                                 struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx,
                                    struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
int futhark_entry_main(struct futhark_context *ctx, float *out0,
                       struct futhark_f32_1d **out1, const int64_t in0, const
                       int64_t in1, const struct futhark_f32_1d *in2, const
                       struct futhark_i64_1d *in3, const
                       struct futhark_f32_1d *in4, const float in5, const
                       float in6, const float in7, const float in8)
{
    struct memblock_device swap_term_mem_28878;
    
    swap_term_mem_28878.references = NULL;
    
    struct memblock_device payments_mem_28879;
    
    payments_mem_28879.references = NULL;
    
    struct memblock_device notional_mem_28880;
    
    notional_mem_28880.references = NULL;
    
    int64_t n_25418;
    int64_t n_25419;
    int64_t n_25420;
    int64_t paths_25421;
    int64_t steps_25422;
    float a_25426;
    float b_25427;
    float sigma_25428;
    float r0_25429;
    float scalar_out_29203;
    struct memblock_device out_mem_29204;
    
    out_mem_29204.references = NULL;
    
    int64_t out_arrsizze_29205;
    
    lock_lock(&ctx->lock);
    paths_25421 = in0;
    steps_25422 = in1;
    swap_term_mem_28878 = in2->mem;
    n_25418 = in2->shape[0];
    payments_mem_28879 = in3->mem;
    n_25419 = in3->shape[0];
    notional_mem_28880 = in4->mem;
    n_25420 = in4->shape[0];
    a_25426 = in5;
    b_25427 = in6;
    sigma_25428 = in7;
    r0_25429 = in8;
    
    int ret = futrts_main(ctx, &scalar_out_29203, &out_mem_29204,
                          &out_arrsizze_29205, swap_term_mem_28878,
                          payments_mem_28879, notional_mem_28880, n_25418,
                          n_25419, n_25420, paths_25421, steps_25422, a_25426,
                          b_25427, sigma_25428, r0_25429);
    
    if (ret == 0) {
        *out0 = scalar_out_29203;
        assert((*out1 =
                (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) !=
            NULL);
        (*out1)->mem = out_mem_29204;
        (*out1)->shape[0] = out_arrsizze_29205;
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_test(struct futhark_context *ctx, float *out0, const
                       int64_t in0, const int64_t in1)
{
    int64_t paths_26135;
    int64_t steps_26136;
    float scalar_out_29203;
    
    lock_lock(&ctx->lock);
    paths_26135 = in0;
    steps_26136 = in1;
    
    int ret = futrts_test(ctx, &scalar_out_29203, paths_26135, steps_26136);
    
    if (ret == 0) {
        *out0 = scalar_out_29203;
    }
    lock_unlock(&ctx->lock);
    return ret;
}
